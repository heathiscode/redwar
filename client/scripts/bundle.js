(function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a=typeof require=="function"&&require;if(!u&&a)return a(o,!0);if(i)return i(o,!0);var f=new Error("Cannot find module '"+o+"'");throw f.code="MODULE_NOT_FOUND",f}var l=n[o]={exports:{}};t[o][0].call(l.exports,function(e){var n=t[o][1][e];return s(n?n:e)},l,l.exports,e,t,n,r)}return n[o].exports}var i=typeof require=="function"&&require;for(var o=0;o<r.length;o++)s(r[o]);return s})({"./client/scripts/main.js":[function(require,module,exports){
'use strict';

var namespace = 'main';

var angular = require('angular');

var app = angular.module(namespace, [
    'ui.router',
    // inject:modules start
    require('./players')(namespace).name
    // inject:modules end
]);


app.config(['$stateProvider', '$urlRouterProvider', function($stateProvider, $urlRouterProvider) {
    $urlRouterProvider.otherwise('/');
    $stateProvider.state('home', {
        url : '/',
        template: require('./players/views/home.html') 
   });
}]);

module.exports = app;

},{"./players":"/home/ubuntu/workspace/client/scripts/players/index.js","./players/views/home.html":"/home/ubuntu/workspace/client/scripts/players/views/home.html","angular":"/home/ubuntu/workspace/bower_components/angular/angular.min.js"}],"/home/ubuntu/workspace/bower_components/angular-animate/angular-animate.min.js":[function(require,module,exports){
/*
 AngularJS v1.2.26
 (c) 2010-2014 Google, Inc. http://angularjs.org
 License: MIT
*/
(function(F,e,O){'use strict';e.module("ngAnimate",["ng"]).directive("ngAnimateChildren",function(){return function(G,s,g){g=g.ngAnimateChildren;e.isString(g)&&0===g.length?s.data("$$ngAnimateChildren",!0):G.$watch(g,function(e){s.data("$$ngAnimateChildren",!!e)})}}).factory("$$animateReflow",["$$rAF","$document",function(e,s){return function(g){return e(function(){g()})}}]).config(["$provide","$animateProvider",function(G,s){function g(e){for(var g=0;g<e.length;g++){var l=e[g];if(l.nodeType==aa)return l}}
function B(l){return e.element(g(l))}var m=e.noop,u=e.forEach,P=s.$$selectors,aa=1,l="$$ngAnimateState",V="$$ngAnimateChildren",J="ng-animate",n={running:!0};G.decorator("$animate",["$delegate","$injector","$sniffer","$rootElement","$$asyncCallback","$rootScope","$document",function(z,F,$,R,E,H,O){function K(a){var b=a.data(l)||{};b.running=!0;a.data(l,b)}function L(a){if(a){var b=[],c={};a=a.substr(1).split(".");($.transitions||$.animations)&&b.push(F.get(P[""]));for(var d=0;d<a.length;d++){var f=
a[d],e=P[f];e&&!c[f]&&(b.push(F.get(e)),c[f]=!0)}return b}}function G(a,b,c){function d(a,b){var c=a[b],d=a["before"+b.charAt(0).toUpperCase()+b.substr(1)];if(c||d)return"leave"==b&&(d=c,c=null),n.push({event:b,fn:c}),h.push({event:b,fn:d}),!0}function f(b,d,e){var f=[];u(b,function(a){a.fn&&f.push(a)});var g=0;u(f,function(b,l){var C=function(){a:{if(d){(d[l]||m)();if(++g<f.length)break a;d=null}e()}};switch(b.event){case "setClass":d.push(b.fn(a,A,k,C));break;case "addClass":d.push(b.fn(a,A||c,
C));break;case "removeClass":d.push(b.fn(a,k||c,C));break;default:d.push(b.fn(a,C))}});d&&0===d.length&&e()}var g=a[0];if(g){var l="setClass"==b,p=l||"addClass"==b||"removeClass"==b,A,k;e.isArray(c)&&(A=c[0],k=c[1],c=A+" "+k);var x=a.attr("class")+" "+c;if(M(x)){var t=m,w=[],h=[],q=m,y=[],n=[],x=(" "+x).replace(/\s+/g,".");u(L(x),function(a){!d(a,b)&&l&&(d(a,"addClass"),d(a,"removeClass"))});return{node:g,event:b,className:c,isClassBased:p,isSetClassOperation:l,before:function(a){t=a;f(h,w,function(){t=
m;a()})},after:function(a){q=a;f(n,y,function(){q=m;a()})},cancel:function(){w&&(u(w,function(a){(a||m)(!0)}),t(!0));y&&(u(y,function(a){(a||m)(!0)}),q(!0))}}}}}function r(a,b,c,d,f,g,n){function p(d){var e="$animate:"+d;q&&(q[e]&&0<q[e].length)&&E(function(){c.triggerHandler(e,{event:a,className:b})})}function A(){p("before")}function m(){p("after")}function x(){p("close");n&&E(function(){n()})}function t(){t.hasBeenRun||(t.hasBeenRun=!0,g())}function w(){if(!w.hasBeenRun){w.hasBeenRun=!0;var d=
c.data(l);d&&(h&&h.isClassBased?k(c,b):(E(function(){var d=c.data(l)||{};r==d.index&&k(c,b,a)}),c.data(l,d)));x()}}var h=G(c,a,b);if(h){b=h.className;var q=e.element._data(h.node),q=q&&q.events;d||(d=f?f.parent():c.parent());var y=c.data(l)||{};f=y.active||{};var z=y.totalActive||0,C=y.last,D;h.isClassBased&&(D=y.running||y.disabled||C&&!C.isClassBased);if(D||N(c,d))t(),A(),m(),w();else{d=!1;if(0<z){D=[];if(h.isClassBased)"setClass"==C.event?(D.push(C),k(c,b)):f[b]&&(v=f[b],v.event==a?d=!0:(D.push(v),
k(c,b)));else if("leave"==a&&f["ng-leave"])d=!0;else{for(var v in f)D.push(f[v]),k(c,v);f={};z=0}0<D.length&&u(D,function(a){a.cancel()})}!h.isClassBased||(h.isSetClassOperation||d)||(d="addClass"==a==c.hasClass(b));if(d)t(),A(),m(),x();else{if("leave"==a)c.one("$destroy",function(a){a=e.element(this);var b=a.data(l);b&&(b=b.active["ng-leave"])&&(b.cancel(),k(a,"ng-leave"))});c.addClass(J);var r=Y++;z++;f[b]=h;c.data(l,{last:h,active:f,index:r,totalActive:z});A();h.before(function(d){var e=c.data(l);
d=d||!e||!e.active[b]||h.isClassBased&&e.active[b].event!=a;t();!0===d?w():(m(),h.after(w))})}}}else t(),A(),m(),w()}function T(a){if(a=g(a))a=e.isFunction(a.getElementsByClassName)?a.getElementsByClassName(J):a.querySelectorAll("."+J),u(a,function(a){a=e.element(a);(a=a.data(l))&&a.active&&u(a.active,function(a){a.cancel()})})}function k(a,b){if(g(a)==g(R))n.disabled||(n.running=!1,n.structural=!1);else if(b){var c=a.data(l)||{},d=!0===b;!d&&(c.active&&c.active[b])&&(c.totalActive--,delete c.active[b]);
if(d||!c.totalActive)a.removeClass(J),a.removeData(l)}}function N(a,b){if(n.disabled)return!0;if(g(a)==g(R))return n.running;var c,d,f;do{if(0===b.length)break;var m=g(b)==g(R),k=m?n:b.data(l)||{};if(k.disabled)return!0;m&&(f=!0);!1!==c&&(m=b.data(V),e.isDefined(m)&&(c=m));d=d||k.running||k.last&&!k.last.isClassBased}while(b=b.parent());return!f||!c&&d}var Y=0;R.data(l,n);H.$$postDigest(function(){H.$$postDigest(function(){n.running=!1})});var Q=s.classNameFilter(),M=Q?function(a){return Q.test(a)}:
function(){return!0};return{enter:function(a,b,c,d){a=e.element(a);b=b&&e.element(b);c=c&&e.element(c);K(a);z.enter(a,b,c);H.$$postDigest(function(){a=B(a);r("enter","ng-enter",a,b,c,m,d)})},leave:function(a,b){a=e.element(a);T(a);K(a);H.$$postDigest(function(){r("leave","ng-leave",B(a),null,null,function(){z.leave(a)},b)})},move:function(a,b,c,d){a=e.element(a);b=b&&e.element(b);c=c&&e.element(c);T(a);K(a);z.move(a,b,c);H.$$postDigest(function(){a=B(a);r("move","ng-move",a,b,c,m,d)})},addClass:function(a,
b,c){a=e.element(a);a=B(a);r("addClass",b,a,null,null,function(){z.addClass(a,b)},c)},removeClass:function(a,b,c){a=e.element(a);a=B(a);r("removeClass",b,a,null,null,function(){z.removeClass(a,b)},c)},setClass:function(a,b,c,d){a=e.element(a);a=B(a);r("setClass",[b,c],a,null,null,function(){z.setClass(a,b,c)},d)},enabled:function(a,b){switch(arguments.length){case 2:if(a)k(b);else{var c=b.data(l)||{};c.disabled=!0;b.data(l,c)}break;case 1:n.disabled=!a;break;default:a=!n.disabled}return!!a}}}]);s.register("",
["$window","$sniffer","$timeout","$$animateReflow",function(l,n,s,B){function E(a,U){S&&S();W.push(U);S=B(function(){u(W,function(a){a()});W=[];S=null;v={}})}function H(a,U){var b=g(a);a=e.element(b);Z.push(a);b=Date.now()+U;b<=da||(s.cancel(ca),da=b,ca=s(function(){G(Z);Z=[]},U,!1))}function G(a){u(a,function(a){(a=a.data(q))&&(a.closeAnimationFn||m)()})}function K(a,b){var c=b?v[b]:null;if(!c){var d=0,e=0,f=0,g=0,m,k,h,q;u(a,function(a){if(a.nodeType==aa){a=l.getComputedStyle(a)||{};h=a[I+P];d=
Math.max(L(h),d);q=a[I+x];m=a[I+t];e=Math.max(L(m),e);k=a[p+t];g=Math.max(L(k),g);var b=L(a[p+P]);0<b&&(b*=parseInt(a[p+w],10)||1);f=Math.max(b,f)}});c={total:0,transitionPropertyStyle:q,transitionDurationStyle:h,transitionDelayStyle:m,transitionDelay:e,transitionDuration:d,animationDelayStyle:k,animationDelay:g,animationDuration:f};b&&(v[b]=c)}return c}function L(a){var b=0;a=e.isString(a)?a.split(/\s*,\s*/):[];u(a,function(a){b=Math.max(parseFloat(a)||0,b)});return b}function J(a){var b=a.parent(),
c=b.data(h);c||(b.data(h,++ba),c=ba);return c+"-"+g(a).getAttribute("class")}function r(a,b,c,d){var e=J(b),f=e+" "+c,l=v[f]?++v[f].total:0,k={};if(0<l){var h=c+"-stagger",k=e+" "+h;(e=!v[k])&&b.addClass(h);k=K(b,k);e&&b.removeClass(h)}d=d||function(a){return a()};b.addClass(c);var h=b.data(q)||{},n=d(function(){return K(b,f)});d=n.transitionDuration;e=n.animationDuration;if(0===d&&0===e)return b.removeClass(c),!1;b.data(q,{running:h.running||0,itemIndex:l,stagger:k,timings:n,closeAnimationFn:m});
a=0<h.running||"setClass"==a;0<d&&T(b,c,a);0<e&&(0<k.animationDelay&&0===k.animationDuration)&&(g(b).style[p]="none 0s");return!0}function T(a,b,c){"ng-enter"!=b&&("ng-move"!=b&&"ng-leave"!=b)&&c?a.addClass(y):g(a).style[I+x]="none"}function k(a,b){var c=I+x,d=g(a);d.style[c]&&0<d.style[c].length&&(d.style[c]="");a.removeClass(y)}function N(a){var b=p;a=g(a);a.style[b]&&0<a.style[b].length&&(a.style[b]="")}function Y(a,b,d,e){function k(a){b.off(x,l);b.removeClass(m);c(b,d);a=g(b);for(var e in s)a.style.removeProperty(s[e])}
function l(a){a.stopPropagation();var b=a.originalEvent||a;a=b.$manualTimeStamp||b.timeStamp||Date.now();b=parseFloat(b.elapsedTime.toFixed(V));Math.max(a-z,0)>=y&&b>=v&&e()}var h=g(b);a=b.data(q);if(-1!=h.getAttribute("class").indexOf(d)&&a){var m="";u(d.split(" "),function(a,b){m+=(0<b?" ":"")+a+"-active"});var n=a.stagger,p=a.timings,t=a.itemIndex,v=Math.max(p.transitionDuration,p.animationDuration),w=Math.max(p.transitionDelay,p.animationDelay),y=w*D,z=Date.now(),x=A+" "+X,r="",s=[];if(0<p.transitionDuration){var B=
p.transitionPropertyStyle;-1==B.indexOf("all")&&(r+=f+"transition-property: "+B+";",r+=f+"transition-duration: "+p.transitionDurationStyle+";",s.push(f+"transition-property"),s.push(f+"transition-duration"))}0<t&&(0<n.transitionDelay&&0===n.transitionDuration&&(r+=f+"transition-delay: "+Q(p.transitionDelayStyle,n.transitionDelay,t)+"; ",s.push(f+"transition-delay")),0<n.animationDelay&&0===n.animationDuration&&(r+=f+"animation-delay: "+Q(p.animationDelayStyle,n.animationDelay,t)+"; ",s.push(f+"animation-delay")));
0<s.length&&(p=h.getAttribute("style")||"",h.setAttribute("style",p+"; "+r));b.on(x,l);b.addClass(m);a.closeAnimationFn=function(){k();e()};h=(t*(Math.max(n.animationDelay,n.transitionDelay)||0)+(w+v)*C)*D;a.running++;H(b,h);return k}e()}function Q(a,b,c){var d="";u(a.split(","),function(a,e){d+=(0<e?",":"")+(c*b+parseInt(a,10))+"s"});return d}function M(a,b,d,e){if(r(a,b,d,e))return function(a){a&&c(b,d)}}function a(a,b,d,e){if(b.data(q))return Y(a,b,d,e);c(b,d);e()}function b(b,c,d,e){var f=M(b,
c,d);if(f){var g=f;E(c,function(){k(c,d);N(c);g=a(b,c,d,e)});return function(a){(g||m)(a)}}e()}function c(a,b){a.removeClass(b);var c=a.data(q);c&&(c.running&&c.running--,c.running&&0!==c.running||a.removeData(q))}function d(a,b){var c="";a=e.isArray(a)?a:a.split(/\s+/);u(a,function(a,d){a&&0<a.length&&(c+=(0<d?" ":"")+a+b)});return c}var f="",I,X,p,A;F.ontransitionend===O&&F.onwebkittransitionend!==O?(f="-webkit-",I="WebkitTransition",X="webkitTransitionEnd transitionend"):(I="transition",X="transitionend");
F.onanimationend===O&&F.onwebkitanimationend!==O?(f="-webkit-",p="WebkitAnimation",A="webkitAnimationEnd animationend"):(p="animation",A="animationend");var P="Duration",x="Property",t="Delay",w="IterationCount",h="$$ngAnimateKey",q="$$ngAnimateCSS3Data",y="ng-animate-block-transitions",V=3,C=1.5,D=1E3,v={},ba=0,W=[],S,ca=null,da=0,Z=[];return{enter:function(a,c){return b("enter",a,"ng-enter",c)},leave:function(a,c){return b("leave",a,"ng-leave",c)},move:function(a,c){return b("move",a,"ng-move",
c)},beforeSetClass:function(a,b,c,e){var f=d(c,"-remove")+" "+d(b,"-add"),g=M("setClass",a,f,function(d){var e=a.attr("class");a.removeClass(c);a.addClass(b);d=d();a.attr("class",e);return d});if(g)return E(a,function(){k(a,f);N(a);e()}),g;e()},beforeAddClass:function(a,b,c){var e=M("addClass",a,d(b,"-add"),function(c){a.addClass(b);c=c();a.removeClass(b);return c});if(e)return E(a,function(){k(a,b);N(a);c()}),e;c()},setClass:function(b,c,e,f){e=d(e,"-remove");c=d(c,"-add");return a("setClass",b,
e+" "+c,f)},addClass:function(b,c,e){return a("addClass",b,d(c,"-add"),e)},beforeRemoveClass:function(a,b,c){var e=M("removeClass",a,d(b,"-remove"),function(c){var d=a.attr("class");a.removeClass(b);c=c();a.attr("class",d);return c});if(e)return E(a,function(){k(a,b);N(a);c()}),e;c()},removeClass:function(b,c,e){return a("removeClass",b,d(c,"-remove"),e)}}}])}])})(window,window.angular);
//# sourceMappingURL=angular-animate.min.js.map

},{}],"/home/ubuntu/workspace/bower_components/angular-sanitize/angular-sanitize.min.js":[function(require,module,exports){
/*
 AngularJS v1.2.26
 (c) 2010-2014 Google, Inc. http://angularjs.org
 License: MIT
*/
(function(q,g,r){'use strict';function F(a){var d=[];t(d,g.noop).chars(a);return d.join("")}function m(a){var d={};a=a.split(",");var c;for(c=0;c<a.length;c++)d[a[c]]=!0;return d}function G(a,d){function c(a,b,c,h){b=g.lowercase(b);if(u[b])for(;f.last()&&v[f.last()];)e("",f.last());w[b]&&f.last()==b&&e("",b);(h=x[b]||!!h)||f.push(b);var n={};c.replace(H,function(a,b,d,c,e){n[b]=s(d||c||e||"")});d.start&&d.start(b,n,h)}function e(a,b){var c=0,e;if(b=g.lowercase(b))for(c=f.length-1;0<=c&&f[c]!=b;c--);
if(0<=c){for(e=f.length-1;e>=c;e--)d.end&&d.end(f[e]);f.length=c}}"string"!==typeof a&&(a=null===a||"undefined"===typeof a?"":""+a);var b,l,f=[],n=a,h;for(f.last=function(){return f[f.length-1]};a;){h="";l=!0;if(f.last()&&y[f.last()])a=a.replace(RegExp("(.*)<\\s*\\/\\s*"+f.last()+"[^>]*>","i"),function(a,b){b=b.replace(I,"$1").replace(J,"$1");d.chars&&d.chars(s(b));return""}),e("",f.last());else{if(0===a.indexOf("\x3c!--"))b=a.indexOf("--",4),0<=b&&a.lastIndexOf("--\x3e",b)===b&&(d.comment&&d.comment(a.substring(4,
b)),a=a.substring(b+3),l=!1);else if(z.test(a)){if(b=a.match(z))a=a.replace(b[0],""),l=!1}else if(K.test(a)){if(b=a.match(A))a=a.substring(b[0].length),b[0].replace(A,e),l=!1}else L.test(a)&&((b=a.match(B))?(b[4]&&(a=a.substring(b[0].length),b[0].replace(B,c)),l=!1):(h+="<",a=a.substring(1)));l&&(b=a.indexOf("<"),h+=0>b?a:a.substring(0,b),a=0>b?"":a.substring(b),d.chars&&d.chars(s(h)))}if(a==n)throw M("badparse",a);n=a}e()}function s(a){if(!a)return"";var d=N.exec(a);a=d[1];var c=d[3];if(d=d[2])p.innerHTML=
d.replace(/</g,"&lt;"),d="textContent"in p?p.textContent:p.innerText;return a+d+c}function C(a){return a.replace(/&/g,"&amp;").replace(O,function(a){var c=a.charCodeAt(0);a=a.charCodeAt(1);return"&#"+(1024*(c-55296)+(a-56320)+65536)+";"}).replace(P,function(a){return"&#"+a.charCodeAt(0)+";"}).replace(/</g,"&lt;").replace(/>/g,"&gt;")}function t(a,d){var c=!1,e=g.bind(a,a.push);return{start:function(a,l,f){a=g.lowercase(a);!c&&y[a]&&(c=a);c||!0!==D[a]||(e("<"),e(a),g.forEach(l,function(c,f){var k=
g.lowercase(f),l="img"===a&&"src"===k||"background"===k;!0!==Q[k]||!0===E[k]&&!d(c,l)||(e(" "),e(f),e('="'),e(C(c)),e('"'))}),e(f?"/>":">"))},end:function(a){a=g.lowercase(a);c||!0!==D[a]||(e("</"),e(a),e(">"));a==c&&(c=!1)},chars:function(a){c||e(C(a))}}}var M=g.$$minErr("$sanitize"),B=/^<((?:[a-zA-Z])[\w:-]*)((?:\s+[\w:-]+(?:\s*=\s*(?:(?:"[^"]*")|(?:'[^']*')|[^>\s]+))?)*)\s*(\/?)\s*(>?)/,A=/^<\/\s*([\w:-]+)[^>]*>/,H=/([\w:-]+)(?:\s*=\s*(?:(?:"((?:[^"])*)")|(?:'((?:[^'])*)')|([^>\s]+)))?/g,L=/^</,
K=/^<\//,I=/\x3c!--(.*?)--\x3e/g,z=/<!DOCTYPE([^>]*?)>/i,J=/<!\[CDATA\[(.*?)]]\x3e/g,O=/[\uD800-\uDBFF][\uDC00-\uDFFF]/g,P=/([^\#-~| |!])/g,x=m("area,br,col,hr,img,wbr");q=m("colgroup,dd,dt,li,p,tbody,td,tfoot,th,thead,tr");r=m("rp,rt");var w=g.extend({},r,q),u=g.extend({},q,m("address,article,aside,blockquote,caption,center,del,dir,div,dl,figure,figcaption,footer,h1,h2,h3,h4,h5,h6,header,hgroup,hr,ins,map,menu,nav,ol,pre,script,section,table,ul")),v=g.extend({},r,m("a,abbr,acronym,b,bdi,bdo,big,br,cite,code,del,dfn,em,font,i,img,ins,kbd,label,map,mark,q,ruby,rp,rt,s,samp,small,span,strike,strong,sub,sup,time,tt,u,var")),
y=m("script,style"),D=g.extend({},x,u,v,w),E=m("background,cite,href,longdesc,src,usemap"),Q=g.extend({},E,m("abbr,align,alt,axis,bgcolor,border,cellpadding,cellspacing,class,clear,color,cols,colspan,compact,coords,dir,face,headers,height,hreflang,hspace,ismap,lang,language,nohref,nowrap,rel,rev,rows,rowspan,rules,scope,scrolling,shape,size,span,start,summary,target,title,type,valign,value,vspace,width")),p=document.createElement("pre"),N=/^(\s*)([\s\S]*?)(\s*)$/;g.module("ngSanitize",[]).provider("$sanitize",
function(){this.$get=["$$sanitizeUri",function(a){return function(d){var c=[];G(d,t(c,function(c,b){return!/^unsafe/.test(a(c,b))}));return c.join("")}}]});g.module("ngSanitize").filter("linky",["$sanitize",function(a){var d=/((ftp|https?):\/\/|(mailto:)?[A-Za-z0-9._%+-]+@)\S*[^\s.;,(){}<>"]/,c=/^mailto:/;return function(e,b){function l(a){a&&k.push(F(a))}function f(a,c){k.push("<a ");g.isDefined(b)&&(k.push('target="'),k.push(b),k.push('" '));k.push('href="');k.push(a);k.push('">');l(c);k.push("</a>")}
if(!e)return e;for(var n,h=e,k=[],m,p;n=h.match(d);)m=n[0],n[2]==n[3]&&(m="mailto:"+m),p=n.index,l(h.substr(0,p)),f(m,n[0].replace(c,"")),h=h.substring(p+n[0].length);l(h);return a(k.join(""))}}])})(window,window.angular);
//# sourceMappingURL=angular-sanitize.min.js.map

},{}],"/home/ubuntu/workspace/bower_components/angular-ui-router/release/angular-ui-router.min.js":[function(require,module,exports){
(function (global){

; require("/home/ubuntu/workspace/bower_components/angular/angular.min.js");
;__browserify_shim_require__=require;(function browserifyShim(module, define, require) {
/**
 * State-based routing for AngularJS
 * @version v0.2.10
 * @link http://angular-ui.github.com/
 * @license MIT License, http://www.opensource.org/licenses/MIT
 */
"undefined"!=typeof module&&"undefined"!=typeof exports&&module.exports===exports&&(module.exports="ui.router"),function(a,b,c){"use strict";function d(a,b){return I(new(I(function(){},{prototype:a})),b)}function e(a){return H(arguments,function(b){b!==a&&H(b,function(b,c){a.hasOwnProperty(c)||(a[c]=b)})}),a}function f(a,b){var c=[];for(var d in a.path){if(a.path[d]!==b.path[d])break;c.push(a.path[d])}return c}function g(a,b){if(Array.prototype.indexOf)return a.indexOf(b,Number(arguments[2])||0);var c=a.length>>>0,d=Number(arguments[2])||0;for(d=0>d?Math.ceil(d):Math.floor(d),0>d&&(d+=c);c>d;d++)if(d in a&&a[d]===b)return d;return-1}function h(a,b,c,d){var e,h=f(c,d),i={},j=[];for(var k in h)if(h[k].params&&h[k].params.length){e=h[k].params;for(var l in e)g(j,e[l])>=0||(j.push(e[l]),i[e[l]]=a[e[l]])}return I({},i,b)}function i(a,b){var c={};return H(a,function(a){var d=b[a];c[a]=null!=d?String(d):null}),c}function j(a,b,c){if(!c){c=[];for(var d in a)c.push(d)}for(var e=0;e<c.length;e++){var f=c[e];if(a[f]!=b[f])return!1}return!0}function k(a,b){var c={};return H(a,function(a){c[a]=b[a]}),c}function l(a,b){var d=1,f=2,g={},h=[],i=g,j=I(a.when(g),{$$promises:g,$$values:g});this.study=function(g){function k(a,c){if(o[c]!==f){if(n.push(c),o[c]===d)throw n.splice(0,n.indexOf(c)),new Error("Cyclic dependency: "+n.join(" -> "));if(o[c]=d,E(a))m.push(c,[function(){return b.get(a)}],h);else{var e=b.annotate(a);H(e,function(a){a!==c&&g.hasOwnProperty(a)&&k(g[a],a)}),m.push(c,a,e)}n.pop(),o[c]=f}}function l(a){return F(a)&&a.then&&a.$$promises}if(!F(g))throw new Error("'invocables' must be an object");var m=[],n=[],o={};return H(g,k),g=n=o=null,function(d,f,g){function h(){--s||(t||e(r,f.$$values),p.$$values=r,p.$$promises=!0,o.resolve(r))}function k(a){p.$$failure=a,o.reject(a)}function n(c,e,f){function i(a){l.reject(a),k(a)}function j(){if(!C(p.$$failure))try{l.resolve(b.invoke(e,g,r)),l.promise.then(function(a){r[c]=a,h()},i)}catch(a){i(a)}}var l=a.defer(),m=0;H(f,function(a){q.hasOwnProperty(a)&&!d.hasOwnProperty(a)&&(m++,q[a].then(function(b){r[a]=b,--m||j()},i))}),m||j(),q[c]=l.promise}if(l(d)&&g===c&&(g=f,f=d,d=null),d){if(!F(d))throw new Error("'locals' must be an object")}else d=i;if(f){if(!l(f))throw new Error("'parent' must be a promise returned by $resolve.resolve()")}else f=j;var o=a.defer(),p=o.promise,q=p.$$promises={},r=I({},d),s=1+m.length/3,t=!1;if(C(f.$$failure))return k(f.$$failure),p;f.$$values?(t=e(r,f.$$values),h()):(I(q,f.$$promises),f.then(h,k));for(var u=0,v=m.length;v>u;u+=3)d.hasOwnProperty(m[u])?h():n(m[u],m[u+1],m[u+2]);return p}},this.resolve=function(a,b,c,d){return this.study(a)(b,c,d)}}function m(a,b,c){this.fromConfig=function(a,b,c){return C(a.template)?this.fromString(a.template,b):C(a.templateUrl)?this.fromUrl(a.templateUrl,b):C(a.templateProvider)?this.fromProvider(a.templateProvider,b,c):null},this.fromString=function(a,b){return D(a)?a(b):a},this.fromUrl=function(c,d){return D(c)&&(c=c(d)),null==c?null:a.get(c,{cache:b}).then(function(a){return a.data})},this.fromProvider=function(a,b,d){return c.invoke(a,null,d||{params:b})}}function n(a){function b(b){if(!/^\w+(-+\w+)*$/.test(b))throw new Error("Invalid parameter name '"+b+"' in pattern '"+a+"'");if(f[b])throw new Error("Duplicate parameter name '"+b+"' in pattern '"+a+"'");f[b]=!0,j.push(b)}function c(a){return a.replace(/[\\\[\]\^$*+?.()|{}]/g,"\\$&")}var d,e=/([:*])(\w+)|\{(\w+)(?:\:((?:[^{}\\]+|\\.|\{(?:[^{}\\]+|\\.)*\})+))?\}/g,f={},g="^",h=0,i=this.segments=[],j=this.params=[];this.source=a;for(var k,l,m;(d=e.exec(a))&&(k=d[2]||d[3],l=d[4]||("*"==d[1]?".*":"[^/]*"),m=a.substring(h,d.index),!(m.indexOf("?")>=0));)g+=c(m)+"("+l+")",b(k),i.push(m),h=e.lastIndex;m=a.substring(h);var n=m.indexOf("?");if(n>=0){var o=this.sourceSearch=m.substring(n);m=m.substring(0,n),this.sourcePath=a.substring(0,h+n),H(o.substring(1).split(/[&?]/),b)}else this.sourcePath=a,this.sourceSearch="";g+=c(m)+"$",i.push(m),this.regexp=new RegExp(g),this.prefix=i[0]}function o(){this.compile=function(a){return new n(a)},this.isMatcher=function(a){return F(a)&&D(a.exec)&&D(a.format)&&D(a.concat)},this.$get=function(){return this}}function p(a){function b(a){var b=/^\^((?:\\[^a-zA-Z0-9]|[^\\\[\]\^$*+?.()|{}]+)*)/.exec(a.source);return null!=b?b[1].replace(/\\(.)/g,"$1"):""}function c(a,b){return a.replace(/\$(\$|\d{1,2})/,function(a,c){return b["$"===c?0:Number(c)]})}function d(a,b,c){if(!c)return!1;var d=a.invoke(b,b,{$match:c});return C(d)?d:!0}var e=[],f=null;this.rule=function(a){if(!D(a))throw new Error("'rule' must be a function");return e.push(a),this},this.otherwise=function(a){if(E(a)){var b=a;a=function(){return b}}else if(!D(a))throw new Error("'rule' must be a function");return f=a,this},this.when=function(e,f){var g,h=E(f);if(E(e)&&(e=a.compile(e)),!h&&!D(f)&&!G(f))throw new Error("invalid 'handler' in when()");var i={matcher:function(b,c){return h&&(g=a.compile(c),c=["$match",function(a){return g.format(a)}]),I(function(a,e){return d(a,c,b.exec(e.path(),e.search()))},{prefix:E(b.prefix)?b.prefix:""})},regex:function(a,e){if(a.global||a.sticky)throw new Error("when() RegExp must not be global or sticky");return h&&(g=e,e=["$match",function(a){return c(g,a)}]),I(function(b,c){return d(b,e,a.exec(c.path()))},{prefix:b(a)})}},j={matcher:a.isMatcher(e),regex:e instanceof RegExp};for(var k in j)if(j[k])return this.rule(i[k](e,f));throw new Error("invalid 'what' in when()")},this.$get=["$location","$rootScope","$injector",function(a,b,c){function d(b){function d(b){var d=b(c,a);return d?(E(d)&&a.replace().url(d),!0):!1}if(!b||!b.defaultPrevented){var g,h=e.length;for(g=0;h>g;g++)if(d(e[g]))return;f&&d(f)}}return b.$on("$locationChangeSuccess",d),{sync:function(){d()}}}]}function q(a,e,f){function g(a){return 0===a.indexOf(".")||0===a.indexOf("^")}function l(a,b){var d=E(a),e=d?a:a.name,f=g(e);if(f){if(!b)throw new Error("No reference point given for path '"+e+"'");for(var h=e.split("."),i=0,j=h.length,k=b;j>i;i++)if(""!==h[i]||0!==i){if("^"!==h[i])break;if(!k.parent)throw new Error("Path '"+e+"' not valid for state '"+b.name+"'");k=k.parent}else k=b;h=h.slice(i).join("."),e=k.name+(k.name&&h?".":"")+h}var l=w[e];return!l||!d&&(d||l!==a&&l.self!==a)?c:l}function m(a,b){x[a]||(x[a]=[]),x[a].push(b)}function n(b){b=d(b,{self:b,resolve:b.resolve||{},toString:function(){return this.name}});var c=b.name;if(!E(c)||c.indexOf("@")>=0)throw new Error("State must have a valid name");if(w.hasOwnProperty(c))throw new Error("State '"+c+"'' is already defined");var e=-1!==c.indexOf(".")?c.substring(0,c.lastIndexOf(".")):E(b.parent)?b.parent:"";if(e&&!w[e])return m(e,b.self);for(var f in z)D(z[f])&&(b[f]=z[f](b,z.$delegates[f]));if(w[c]=b,!b[y]&&b.url&&a.when(b.url,["$match","$stateParams",function(a,c){v.$current.navigable==b&&j(a,c)||v.transitionTo(b,a,{location:!1})}]),x[c])for(var g=0;g<x[c].length;g++)n(x[c][g]);return b}function o(a){return a.indexOf("*")>-1}function p(a){var b=a.split("."),c=v.$current.name.split(".");if("**"===b[0]&&(c=c.slice(c.indexOf(b[1])),c.unshift("**")),"**"===b[b.length-1]&&(c.splice(c.indexOf(b[b.length-2])+1,Number.MAX_VALUE),c.push("**")),b.length!=c.length)return!1;for(var d=0,e=b.length;e>d;d++)"*"===b[d]&&(c[d]="*");return c.join("")===b.join("")}function q(a,b){return E(a)&&!C(b)?z[a]:D(b)&&E(a)?(z[a]&&!z.$delegates[a]&&(z.$delegates[a]=z[a]),z[a]=b,this):this}function r(a,b){return F(a)?b=a:b.name=a,n(b),this}function s(a,e,g,m,n,q,r,s,x){function z(){r.url()!==M&&(r.url(M),r.replace())}function A(a,c,d,f,h){var i=d?c:k(a.params,c),j={$stateParams:i};h.resolve=n.resolve(a.resolve,j,h.resolve,a);var l=[h.resolve.then(function(a){h.globals=a})];return f&&l.push(f),H(a.views,function(c,d){var e=c.resolve&&c.resolve!==a.resolve?c.resolve:{};e.$template=[function(){return g.load(d,{view:c,locals:j,params:i,notify:!1})||""}],l.push(n.resolve(e,j,h.resolve,a).then(function(f){if(D(c.controllerProvider)||G(c.controllerProvider)){var g=b.extend({},e,j);f.$$controller=m.invoke(c.controllerProvider,null,g)}else f.$$controller=c.controller;f.$$state=a,f.$$controllerAs=c.controllerAs,h[d]=f}))}),e.all(l).then(function(){return h})}var B=e.reject(new Error("transition superseded")),F=e.reject(new Error("transition prevented")),K=e.reject(new Error("transition aborted")),L=e.reject(new Error("transition failed")),M=r.url(),N=x.baseHref();return u.locals={resolve:null,globals:{$stateParams:{}}},v={params:{},current:u.self,$current:u,transition:null},v.reload=function(){v.transitionTo(v.current,q,{reload:!0,inherit:!1,notify:!1})},v.go=function(a,b,c){return this.transitionTo(a,b,I({inherit:!0,relative:v.$current},c))},v.transitionTo=function(b,c,f){c=c||{},f=I({location:!0,inherit:!1,relative:null,notify:!0,reload:!1,$retry:!1},f||{});var g,k=v.$current,n=v.params,o=k.path,p=l(b,f.relative);if(!C(p)){var s={to:b,toParams:c,options:f};if(g=a.$broadcast("$stateNotFound",s,k.self,n),g.defaultPrevented)return z(),K;if(g.retry){if(f.$retry)return z(),L;var w=v.transition=e.when(g.retry);return w.then(function(){return w!==v.transition?B:(s.options.$retry=!0,v.transitionTo(s.to,s.toParams,s.options))},function(){return K}),z(),w}if(b=s.to,c=s.toParams,f=s.options,p=l(b,f.relative),!C(p)){if(f.relative)throw new Error("Could not resolve '"+b+"' from state '"+f.relative+"'");throw new Error("No such state '"+b+"'")}}if(p[y])throw new Error("Cannot transition to abstract state '"+b+"'");f.inherit&&(c=h(q,c||{},v.$current,p)),b=p;var x,D,E=b.path,G=u.locals,H=[];for(x=0,D=E[x];D&&D===o[x]&&j(c,n,D.ownParams)&&!f.reload;x++,D=E[x])G=H[x]=D.locals;if(t(b,k,G,f))return b.self.reloadOnSearch!==!1&&z(),v.transition=null,e.when(v.current);if(c=i(b.params,c||{}),f.notify&&(g=a.$broadcast("$stateChangeStart",b.self,c,k.self,n),g.defaultPrevented))return z(),F;for(var N=e.when(G),O=x;O<E.length;O++,D=E[O])G=H[O]=d(G),N=A(D,c,D===b,N,G);var P=v.transition=N.then(function(){var d,e,g;if(v.transition!==P)return B;for(d=o.length-1;d>=x;d--)g=o[d],g.self.onExit&&m.invoke(g.self.onExit,g.self,g.locals.globals),g.locals=null;for(d=x;d<E.length;d++)e=E[d],e.locals=H[d],e.self.onEnter&&m.invoke(e.self.onEnter,e.self,e.locals.globals);if(v.transition!==P)return B;v.$current=b,v.current=b.self,v.params=c,J(v.params,q),v.transition=null;var h=b.navigable;return f.location&&h&&(r.url(h.url.format(h.locals.globals.$stateParams)),"replace"===f.location&&r.replace()),f.notify&&a.$broadcast("$stateChangeSuccess",b.self,c,k.self,n),M=r.url(),v.current},function(d){return v.transition!==P?B:(v.transition=null,a.$broadcast("$stateChangeError",b.self,c,k.self,n,d),z(),e.reject(d))});return P},v.is=function(a,d){var e=l(a);return C(e)?v.$current!==e?!1:C(d)&&null!==d?b.equals(q,d):!0:c},v.includes=function(a,d){if(E(a)&&o(a)){if(!p(a))return!1;a=v.$current.name}var e=l(a);if(!C(e))return c;if(!C(v.$current.includes[e.name]))return!1;var f=!0;return b.forEach(d,function(a,b){C(q[b])&&q[b]===a||(f=!1)}),f},v.href=function(a,b,c){c=I({lossy:!0,inherit:!1,absolute:!1,relative:v.$current},c||{});var d=l(a,c.relative);if(!C(d))return null;b=h(q,b||{},v.$current,d);var e=d&&c.lossy?d.navigable:d,g=e&&e.url?e.url.format(i(d.params,b||{})):null;return!f.html5Mode()&&g&&(g="#"+f.hashPrefix()+g),"/"!==N&&(f.html5Mode()?g=N.slice(0,-1)+g:c.absolute&&(g=N.slice(1)+g)),c.absolute&&g&&(g=r.protocol()+"://"+r.host()+(80==r.port()||443==r.port()?"":":"+r.port())+(!f.html5Mode()&&g?"/":"")+g),g},v.get=function(a,b){if(!C(a)){var c=[];return H(w,function(a){c.push(a.self)}),c}var d=l(a,b);return d&&d.self?d.self:null},v}function t(a,b,c,d){return a!==b||(c!==b.locals||d.reload)&&a.self.reloadOnSearch!==!1?void 0:!0}var u,v,w={},x={},y="abstract",z={parent:function(a){if(C(a.parent)&&a.parent)return l(a.parent);var b=/^(.+)\.[^.]+$/.exec(a.name);return b?l(b[1]):u},data:function(a){return a.parent&&a.parent.data&&(a.data=a.self.data=I({},a.parent.data,a.data)),a.data},url:function(a){var b=a.url;if(E(b))return"^"==b.charAt(0)?e.compile(b.substring(1)):(a.parent.navigable||u).url.concat(b);if(e.isMatcher(b)||null==b)return b;throw new Error("Invalid url '"+b+"' in state '"+a+"'")},navigable:function(a){return a.url?a:a.parent?a.parent.navigable:null},params:function(a){if(!a.params)return a.url?a.url.parameters():a.parent.params;if(!G(a.params))throw new Error("Invalid params in state '"+a+"'");if(a.url)throw new Error("Both params and url specicified in state '"+a+"'");return a.params},views:function(a){var b={};return H(C(a.views)?a.views:{"":a},function(c,d){d.indexOf("@")<0&&(d+="@"+a.parent.name),b[d]=c}),b},ownParams:function(a){if(!a.parent)return a.params;var b={};H(a.params,function(a){b[a]=!0}),H(a.parent.params,function(c){if(!b[c])throw new Error("Missing required parameter '"+c+"' in state '"+a.name+"'");b[c]=!1});var c=[];return H(b,function(a,b){a&&c.push(b)}),c},path:function(a){return a.parent?a.parent.path.concat(a):[]},includes:function(a){var b=a.parent?I({},a.parent.includes):{};return b[a.name]=!0,b},$delegates:{}};u=n({name:"",url:"^",views:null,"abstract":!0}),u.navigable=null,this.decorator=q,this.state=r,this.$get=s,s.$inject=["$rootScope","$q","$view","$injector","$resolve","$stateParams","$location","$urlRouter","$browser"]}function r(){function a(a,b){return{load:function(c,d){var e,f={template:null,controller:null,view:null,locals:null,notify:!0,async:!0,params:{}};return d=I(f,d),d.view&&(e=b.fromConfig(d.view,d.params,d.locals)),e&&d.notify&&a.$broadcast("$viewContentLoading",d),e}}}this.$get=a,a.$inject=["$rootScope","$templateFactory"]}function s(){var a=!1;this.useAnchorScroll=function(){a=!0},this.$get=["$anchorScroll","$timeout",function(b,c){return a?b:function(a){c(function(){a[0].scrollIntoView()},0,!1)}}]}function t(a,c,d){function e(){return c.has?function(a){return c.has(a)?c.get(a):null}:function(a){try{return c.get(a)}catch(b){return null}}}function f(a,b){var c=function(){return{enter:function(a,b,c){b.after(a),c()},leave:function(a,b){a.remove(),b()}}};if(i)return{enter:function(a,b,c){i.enter(a,null,b,c)},leave:function(a,b){i.leave(a,b)}};if(h){var d=h&&h(b,a);return{enter:function(a,b,c){d.enter(a,null,b),c()},leave:function(a,b){d.leave(a),b()}}}return c()}var g=e(),h=g("$animator"),i=g("$animate"),j={restrict:"ECA",terminal:!0,priority:400,transclude:"element",compile:function(c,e,g){return function(c,e,h){function i(){k&&(k.remove(),k=null),m&&(m.$destroy(),m=null),l&&(q.leave(l,function(){k=null}),k=l,l=null)}function j(f){var h=c.$new(),j=l&&l.data("$uiViewName"),k=j&&a.$current&&a.$current.locals[j];if(f||k!==n){var r=g(h,function(a){q.enter(a,e,function(){(b.isDefined(p)&&!p||c.$eval(p))&&d(a)}),i()});n=a.$current.locals[r.data("$uiViewName")],l=r,m=h,m.$emit("$viewContentLoaded"),m.$eval(o)}}var k,l,m,n,o=h.onload||"",p=h.autoscroll,q=f(h,c);c.$on("$stateChangeSuccess",function(){j(!1)}),c.$on("$viewContentLoading",function(){j(!1)}),j(!0)}}};return j}function u(a,b,c){return{restrict:"ECA",priority:-400,compile:function(d){var e=d.html();return function(d,f,g){var h=g.uiView||g.name||"",i=f.inheritedData("$uiView");h.indexOf("@")<0&&(h=h+"@"+(i?i.state.name:"")),f.data("$uiViewName",h);var j=c.$current,k=j&&j.locals[h];if(k){f.data("$uiView",{name:h,state:k.$$state}),f.html(k.$template?k.$template:e);var l=a(f.contents());if(k.$$controller){k.$scope=d;var m=b(k.$$controller,k);k.$$controllerAs&&(d[k.$$controllerAs]=m),f.data("$ngControllerController",m),f.children().data("$ngControllerController",m)}l(d)}}}}}function v(a){var b=a.replace(/\n/g," ").match(/^([^(]+?)\s*(\((.*)\))?$/);if(!b||4!==b.length)throw new Error("Invalid state ref '"+a+"'");return{state:b[1],paramExpr:b[3]||null}}function w(a){var b=a.parent().inheritedData("$uiView");return b&&b.state&&b.state.name?b.state:void 0}function x(a,c){var d=["location","inherit","reload"];return{restrict:"A",require:"?^uiSrefActive",link:function(e,f,g,h){var i=v(g.uiSref),j=null,k=w(f)||a.$current,l="FORM"===f[0].nodeName,m=l?"action":"href",n=!0,o={relative:k},p=e.$eval(g.uiSrefOpts)||{};b.forEach(d,function(a){a in p&&(o[a]=p[a])});var q=function(b){if(b&&(j=b),n){var c=a.href(i.state,j,o);return h&&h.$$setStateInfo(i.state,j),c?void(f[0][m]=c):(n=!1,!1)}};i.paramExpr&&(e.$watch(i.paramExpr,function(a){a!==j&&q(a)},!0),j=e.$eval(i.paramExpr)),q(),l||f.bind("click",function(b){var d=b.which||b.button;d>1||b.ctrlKey||b.metaKey||b.shiftKey||f.attr("target")||(c(function(){a.go(i.state,j,o)}),b.preventDefault())})}}}function y(a,b,c){return{restrict:"A",controller:["$scope","$element","$attrs",function(d,e,f){function g(){a.$current.self===i&&h()?e.addClass(l):e.removeClass(l)}function h(){return!k||j(k,b)}var i,k,l;l=c(f.uiSrefActive||"",!1)(d),this.$$setStateInfo=function(b,c){i=a.get(b,w(e)),k=c,g()},d.$on("$stateChangeSuccess",g)}]}}function z(a){return function(b){return a.is(b)}}function A(a){return function(b){return a.includes(b)}}function B(a,b){function e(a){this.locals=a.locals.globals,this.params=this.locals.$stateParams}function f(){this.locals=null,this.params=null}function g(c,g){if(null!=g.redirectTo){var h,j=g.redirectTo;if(E(j))h=j;else{if(!D(j))throw new Error("Invalid 'redirectTo' in when()");h=function(a,b){return j(a,b.path(),b.search())}}b.when(c,h)}else a.state(d(g,{parent:null,name:"route:"+encodeURIComponent(c),url:c,onEnter:e,onExit:f}));return i.push(g),this}function h(a,b,d){function e(a){return""!==a.name?a:c}var f={routes:i,params:d,current:c};return b.$on("$stateChangeStart",function(a,c,d,f){b.$broadcast("$routeChangeStart",e(c),e(f))}),b.$on("$stateChangeSuccess",function(a,c,d,g){f.current=e(c),b.$broadcast("$routeChangeSuccess",e(c),e(g)),J(d,f.params)}),b.$on("$stateChangeError",function(a,c,d,f,g,h){b.$broadcast("$routeChangeError",e(c),e(f),h)}),f}var i=[];e.$inject=["$$state"],this.when=g,this.$get=h,h.$inject=["$state","$rootScope","$routeParams"]}var C=b.isDefined,D=b.isFunction,E=b.isString,F=b.isObject,G=b.isArray,H=b.forEach,I=b.extend,J=b.copy;b.module("ui.router.util",["ng"]),b.module("ui.router.router",["ui.router.util"]),b.module("ui.router.state",["ui.router.router","ui.router.util"]),b.module("ui.router",["ui.router.state"]),b.module("ui.router.compat",["ui.router"]),l.$inject=["$q","$injector"],b.module("ui.router.util").service("$resolve",l),m.$inject=["$http","$templateCache","$injector"],b.module("ui.router.util").service("$templateFactory",m),n.prototype.concat=function(a){return new n(this.sourcePath+a+this.sourceSearch)},n.prototype.toString=function(){return this.source},n.prototype.exec=function(a,b){var c=this.regexp.exec(a);if(!c)return null;var d,e=this.params,f=e.length,g=this.segments.length-1,h={};if(g!==c.length-1)throw new Error("Unbalanced capture group in route '"+this.source+"'");for(d=0;g>d;d++)h[e[d]]=c[d+1];for(;f>d;d++)h[e[d]]=b[e[d]];return h},n.prototype.parameters=function(){return this.params},n.prototype.format=function(a){var b=this.segments,c=this.params;if(!a)return b.join("");var d,e,f,g=b.length-1,h=c.length,i=b[0];for(d=0;g>d;d++)f=a[c[d]],null!=f&&(i+=encodeURIComponent(f)),i+=b[d+1];for(;h>d;d++)f=a[c[d]],null!=f&&(i+=(e?"&":"?")+c[d]+"="+encodeURIComponent(f),e=!0);return i},b.module("ui.router.util").provider("$urlMatcherFactory",o),p.$inject=["$urlMatcherFactoryProvider"],b.module("ui.router.router").provider("$urlRouter",p),q.$inject=["$urlRouterProvider","$urlMatcherFactoryProvider","$locationProvider"],b.module("ui.router.state").value("$stateParams",{}).provider("$state",q),r.$inject=[],b.module("ui.router.state").provider("$view",r),b.module("ui.router.state").provider("$uiViewScroll",s),t.$inject=["$state","$injector","$uiViewScroll"],u.$inject=["$compile","$controller","$state"],b.module("ui.router.state").directive("uiView",t),b.module("ui.router.state").directive("uiView",u),x.$inject=["$state","$timeout"],y.$inject=["$state","$stateParams","$interpolate"],b.module("ui.router.state").directive("uiSref",x).directive("uiSrefActive",y),z.$inject=["$state"],A.$inject=["$state"],b.module("ui.router.state").filter("isState",z).filter("includedByState",A),B.$inject=["$stateProvider","$urlRouterProvider"],b.module("ui.router.compat").provider("$route",B).directive("ngView",t)}(window,window.angular);
}).call(global, module, undefined, undefined);

}).call(this,typeof global !== "undefined" ? global : typeof self !== "undefined" ? self : typeof window !== "undefined" ? window : {})
},{"/home/ubuntu/workspace/bower_components/angular/angular.min.js":"/home/ubuntu/workspace/bower_components/angular/angular.min.js"}],"/home/ubuntu/workspace/bower_components/angular/angular.min.js":[function(require,module,exports){
(function (global){
;__browserify_shim_require__=require;(function browserifyShim(module, exports, require, define, browserify_shim__define__module__export__) {
/*
 AngularJS v1.2.26
 (c) 2010-2014 Google, Inc. http://angularjs.org
 License: MIT
*/
(function(W,X,t){'use strict';function C(b){return function(){var a=arguments[0],c,a="["+(b?b+":":"")+a+"] http://errors.angularjs.org/1.2.26/"+(b?b+"/":"")+a;for(c=1;c<arguments.length;c++)a=a+(1==c?"?":"&")+"p"+(c-1)+"="+encodeURIComponent("function"==typeof arguments[c]?arguments[c].toString().replace(/ \{[\s\S]*$/,""):"undefined"==typeof arguments[c]?"undefined":"string"!=typeof arguments[c]?JSON.stringify(arguments[c]):arguments[c]);return Error(a)}}function Pa(b){if(null==b||Ga(b))return!1;
var a=b.length;return 1===b.nodeType&&a?!0:v(b)||J(b)||0===a||"number"===typeof a&&0<a&&a-1 in b}function r(b,a,c){var d;if(b)if(P(b))for(d in b)"prototype"==d||("length"==d||"name"==d||b.hasOwnProperty&&!b.hasOwnProperty(d))||a.call(c,b[d],d);else if(J(b)||Pa(b))for(d=0;d<b.length;d++)a.call(c,b[d],d);else if(b.forEach&&b.forEach!==r)b.forEach(a,c);else for(d in b)b.hasOwnProperty(d)&&a.call(c,b[d],d);return b}function Zb(b){var a=[],c;for(c in b)b.hasOwnProperty(c)&&a.push(c);return a.sort()}function Tc(b,
a,c){for(var d=Zb(b),e=0;e<d.length;e++)a.call(c,b[d[e]],d[e]);return d}function $b(b){return function(a,c){b(c,a)}}function hb(){for(var b=ma.length,a;b;){b--;a=ma[b].charCodeAt(0);if(57==a)return ma[b]="A",ma.join("");if(90==a)ma[b]="0";else return ma[b]=String.fromCharCode(a+1),ma.join("")}ma.unshift("0");return ma.join("")}function ac(b,a){a?b.$$hashKey=a:delete b.$$hashKey}function D(b){var a=b.$$hashKey;r(arguments,function(a){a!==b&&r(a,function(a,c){b[c]=a})});ac(b,a);return b}function U(b){return parseInt(b,
10)}function bc(b,a){return D(new (D(function(){},{prototype:b})),a)}function E(){}function Qa(b){return b}function ba(b){return function(){return b}}function x(b){return"undefined"===typeof b}function y(b){return"undefined"!==typeof b}function T(b){return null!=b&&"object"===typeof b}function v(b){return"string"===typeof b}function ib(b){return"number"===typeof b}function ta(b){return"[object Date]"===za.call(b)}function P(b){return"function"===typeof b}function jb(b){return"[object RegExp]"===za.call(b)}
function Ga(b){return b&&b.document&&b.location&&b.alert&&b.setInterval}function Uc(b){return!(!b||!(b.nodeName||b.prop&&b.attr&&b.find))}function Vc(b,a,c){var d=[];r(b,function(b,f,g){d.push(a.call(c,b,f,g))});return d}function Ra(b,a){if(b.indexOf)return b.indexOf(a);for(var c=0;c<b.length;c++)if(a===b[c])return c;return-1}function Sa(b,a){var c=Ra(b,a);0<=c&&b.splice(c,1);return a}function Ha(b,a,c,d){if(Ga(b)||b&&b.$evalAsync&&b.$watch)throw Ta("cpws");if(a){if(b===a)throw Ta("cpi");c=c||[];
d=d||[];if(T(b)){var e=Ra(c,b);if(-1!==e)return d[e];c.push(b);d.push(a)}if(J(b))for(var f=a.length=0;f<b.length;f++)e=Ha(b[f],null,c,d),T(b[f])&&(c.push(b[f]),d.push(e)),a.push(e);else{var g=a.$$hashKey;J(a)?a.length=0:r(a,function(b,c){delete a[c]});for(f in b)e=Ha(b[f],null,c,d),T(b[f])&&(c.push(b[f]),d.push(e)),a[f]=e;ac(a,g)}}else if(a=b)J(b)?a=Ha(b,[],c,d):ta(b)?a=new Date(b.getTime()):jb(b)?(a=RegExp(b.source,b.toString().match(/[^\/]*$/)[0]),a.lastIndex=b.lastIndex):T(b)&&(a=Ha(b,{},c,d));
return a}function ha(b,a){if(J(b)){a=a||[];for(var c=0;c<b.length;c++)a[c]=b[c]}else if(T(b))for(c in a=a||{},b)!kb.call(b,c)||"$"===c.charAt(0)&&"$"===c.charAt(1)||(a[c]=b[c]);return a||b}function Aa(b,a){if(b===a)return!0;if(null===b||null===a)return!1;if(b!==b&&a!==a)return!0;var c=typeof b,d;if(c==typeof a&&"object"==c)if(J(b)){if(!J(a))return!1;if((c=b.length)==a.length){for(d=0;d<c;d++)if(!Aa(b[d],a[d]))return!1;return!0}}else{if(ta(b))return ta(a)?isNaN(b.getTime())&&isNaN(a.getTime())||b.getTime()===
a.getTime():!1;if(jb(b)&&jb(a))return b.toString()==a.toString();if(b&&b.$evalAsync&&b.$watch||a&&a.$evalAsync&&a.$watch||Ga(b)||Ga(a)||J(a))return!1;c={};for(d in b)if("$"!==d.charAt(0)&&!P(b[d])){if(!Aa(b[d],a[d]))return!1;c[d]=!0}for(d in a)if(!c.hasOwnProperty(d)&&"$"!==d.charAt(0)&&a[d]!==t&&!P(a[d]))return!1;return!0}return!1}function Bb(b,a){var c=2<arguments.length?Ba.call(arguments,2):[];return!P(a)||a instanceof RegExp?a:c.length?function(){return arguments.length?a.apply(b,c.concat(Ba.call(arguments,
0))):a.apply(b,c)}:function(){return arguments.length?a.apply(b,arguments):a.call(b)}}function Wc(b,a){var c=a;"string"===typeof b&&"$"===b.charAt(0)?c=t:Ga(a)?c="$WINDOW":a&&X===a?c="$DOCUMENT":a&&(a.$evalAsync&&a.$watch)&&(c="$SCOPE");return c}function na(b,a){return"undefined"===typeof b?t:JSON.stringify(b,Wc,a?"  ":null)}function cc(b){return v(b)?JSON.parse(b):b}function Ua(b){"function"===typeof b?b=!0:b&&0!==b.length?(b=K(""+b),b=!("f"==b||"0"==b||"false"==b||"no"==b||"n"==b||"[]"==b)):b=!1;
return b}function ia(b){b=w(b).clone();try{b.empty()}catch(a){}var c=w("<div>").append(b).html();try{return 3===b[0].nodeType?K(c):c.match(/^(<[^>]+>)/)[1].replace(/^<([\w\-]+)/,function(a,b){return"<"+K(b)})}catch(d){return K(c)}}function dc(b){try{return decodeURIComponent(b)}catch(a){}}function ec(b){var a={},c,d;r((b||"").split("&"),function(b){b&&(c=b.replace(/\+/g,"%20").split("="),d=dc(c[0]),y(d)&&(b=y(c[1])?dc(c[1]):!0,kb.call(a,d)?J(a[d])?a[d].push(b):a[d]=[a[d],b]:a[d]=b))});return a}function Cb(b){var a=
[];r(b,function(b,d){J(b)?r(b,function(b){a.push(Ca(d,!0)+(!0===b?"":"="+Ca(b,!0)))}):a.push(Ca(d,!0)+(!0===b?"":"="+Ca(b,!0)))});return a.length?a.join("&"):""}function lb(b){return Ca(b,!0).replace(/%26/gi,"&").replace(/%3D/gi,"=").replace(/%2B/gi,"+")}function Ca(b,a){return encodeURIComponent(b).replace(/%40/gi,"@").replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",").replace(/%20/g,a?"%20":"+")}function Xc(b,a){function c(a){a&&d.push(a)}var d=[b],e,f,g=["ng:app","ng-app","x-ng-app",
"data-ng-app"],k=/\sng[:\-]app(:\s*([\w\d_]+);?)?\s/;r(g,function(a){g[a]=!0;c(X.getElementById(a));a=a.replace(":","\\:");b.querySelectorAll&&(r(b.querySelectorAll("."+a),c),r(b.querySelectorAll("."+a+"\\:"),c),r(b.querySelectorAll("["+a+"]"),c))});r(d,function(a){if(!e){var b=k.exec(" "+a.className+" ");b?(e=a,f=(b[2]||"").replace(/\s+/g,",")):r(a.attributes,function(b){!e&&g[b.name]&&(e=a,f=b.value)})}});e&&a(e,f?[f]:[])}function fc(b,a){var c=function(){b=w(b);if(b.injector()){var c=b[0]===X?
"document":ia(b);throw Ta("btstrpd",c.replace(/</,"&lt;").replace(/>/,"&gt;"));}a=a||[];a.unshift(["$provide",function(a){a.value("$rootElement",b)}]);a.unshift("ng");c=gc(a);c.invoke(["$rootScope","$rootElement","$compile","$injector","$animate",function(a,b,c,d,e){a.$apply(function(){b.data("$injector",d);c(b)(a)})}]);return c},d=/^NG_DEFER_BOOTSTRAP!/;if(W&&!d.test(W.name))return c();W.name=W.name.replace(d,"");Va.resumeBootstrap=function(b){r(b,function(b){a.push(b)});c()}}function mb(b,a){a=
a||"_";return b.replace(Yc,function(b,d){return(d?a:"")+b.toLowerCase()})}function Db(b,a,c){if(!b)throw Ta("areq",a||"?",c||"required");return b}function Wa(b,a,c){c&&J(b)&&(b=b[b.length-1]);Db(P(b),a,"not a function, got "+(b&&"object"===typeof b?b.constructor.name||"Object":typeof b));return b}function Da(b,a){if("hasOwnProperty"===b)throw Ta("badname",a);}function hc(b,a,c){if(!a)return b;a=a.split(".");for(var d,e=b,f=a.length,g=0;g<f;g++)d=a[g],b&&(b=(e=b)[d]);return!c&&P(b)?Bb(e,b):b}function Eb(b){var a=
b[0];b=b[b.length-1];if(a===b)return w(a);var c=[a];do{a=a.nextSibling;if(!a)break;c.push(a)}while(a!==b);return w(c)}function Zc(b){var a=C("$injector"),c=C("ng");b=b.angular||(b.angular={});b.$$minErr=b.$$minErr||C;return b.module||(b.module=function(){var b={};return function(e,f,g){if("hasOwnProperty"===e)throw c("badname","module");f&&b.hasOwnProperty(e)&&(b[e]=null);return b[e]||(b[e]=function(){function b(a,d,e){return function(){c[e||"push"]([a,d,arguments]);return n}}if(!f)throw a("nomod",
e);var c=[],d=[],l=b("$injector","invoke"),n={_invokeQueue:c,_runBlocks:d,requires:f,name:e,provider:b("$provide","provider"),factory:b("$provide","factory"),service:b("$provide","service"),value:b("$provide","value"),constant:b("$provide","constant","unshift"),animation:b("$animateProvider","register"),filter:b("$filterProvider","register"),controller:b("$controllerProvider","register"),directive:b("$compileProvider","directive"),config:l,run:function(a){d.push(a);return this}};g&&l(g);return n}())}}())}
function $c(b){D(b,{bootstrap:fc,copy:Ha,extend:D,equals:Aa,element:w,forEach:r,injector:gc,noop:E,bind:Bb,toJson:na,fromJson:cc,identity:Qa,isUndefined:x,isDefined:y,isString:v,isFunction:P,isObject:T,isNumber:ib,isElement:Uc,isArray:J,version:ad,isDate:ta,lowercase:K,uppercase:Ia,callbacks:{counter:0},$$minErr:C,$$csp:Xa});Ya=Zc(W);try{Ya("ngLocale")}catch(a){Ya("ngLocale",[]).provider("$locale",bd)}Ya("ng",["ngLocale"],["$provide",function(a){a.provider({$$sanitizeUri:cd});a.provider("$compile",
ic).directive({a:dd,input:jc,textarea:jc,form:ed,script:fd,select:gd,style:hd,option:id,ngBind:jd,ngBindHtml:kd,ngBindTemplate:ld,ngClass:md,ngClassEven:nd,ngClassOdd:od,ngCloak:pd,ngController:qd,ngForm:rd,ngHide:sd,ngIf:td,ngInclude:ud,ngInit:vd,ngNonBindable:wd,ngPluralize:xd,ngRepeat:yd,ngShow:zd,ngStyle:Ad,ngSwitch:Bd,ngSwitchWhen:Cd,ngSwitchDefault:Dd,ngOptions:Ed,ngTransclude:Fd,ngModel:Gd,ngList:Hd,ngChange:Id,required:kc,ngRequired:kc,ngValue:Jd}).directive({ngInclude:Kd}).directive(Fb).directive(lc);
a.provider({$anchorScroll:Ld,$animate:Md,$browser:Nd,$cacheFactory:Od,$controller:Pd,$document:Qd,$exceptionHandler:Rd,$filter:mc,$interpolate:Sd,$interval:Td,$http:Ud,$httpBackend:Vd,$location:Wd,$log:Xd,$parse:Yd,$rootScope:Zd,$q:$d,$sce:ae,$sceDelegate:be,$sniffer:ce,$templateCache:de,$timeout:ee,$window:fe,$$rAF:ge,$$asyncCallback:he})}])}function Za(b){return b.replace(ie,function(a,b,d,e){return e?d.toUpperCase():d}).replace(je,"Moz$1")}function Gb(b,a,c,d){function e(b){var e=c&&b?[this.filter(b)]:
[this],m=a,h,l,n,p,q,s;if(!d||null!=b)for(;e.length;)for(h=e.shift(),l=0,n=h.length;l<n;l++)for(p=w(h[l]),m?p.triggerHandler("$destroy"):m=!m,q=0,p=(s=p.children()).length;q<p;q++)e.push(Ea(s[q]));return f.apply(this,arguments)}var f=Ea.fn[b],f=f.$original||f;e.$original=f;Ea.fn[b]=e}function S(b){if(b instanceof S)return b;v(b)&&(b=aa(b));if(!(this instanceof S)){if(v(b)&&"<"!=b.charAt(0))throw Hb("nosel");return new S(b)}if(v(b)){var a=b;b=X;var c;if(c=ke.exec(a))b=[b.createElement(c[1])];else{var d=
b,e;b=d.createDocumentFragment();c=[];if(Ib.test(a)){d=b.appendChild(d.createElement("div"));e=(le.exec(a)||["",""])[1].toLowerCase();e=ea[e]||ea._default;d.innerHTML="<div>&#160;</div>"+e[1]+a.replace(me,"<$1></$2>")+e[2];d.removeChild(d.firstChild);for(a=e[0];a--;)d=d.lastChild;a=0;for(e=d.childNodes.length;a<e;++a)c.push(d.childNodes[a]);d=b.firstChild;d.textContent=""}else c.push(d.createTextNode(a));b.textContent="";b.innerHTML="";b=c}Jb(this,b);w(X.createDocumentFragment()).append(this)}else Jb(this,
b)}function Kb(b){return b.cloneNode(!0)}function Ja(b){Lb(b);var a=0;for(b=b.childNodes||[];a<b.length;a++)Ja(b[a])}function nc(b,a,c,d){if(y(d))throw Hb("offargs");var e=oa(b,"events");oa(b,"handle")&&(x(a)?r(e,function(a,c){$a(b,c,a);delete e[c]}):r(a.split(" "),function(a){x(c)?($a(b,a,e[a]),delete e[a]):Sa(e[a]||[],c)}))}function Lb(b,a){var c=b.ng339,d=ab[c];d&&(a?delete ab[c].data[a]:(d.handle&&(d.events.$destroy&&d.handle({},"$destroy"),nc(b)),delete ab[c],b.ng339=t))}function oa(b,a,c){var d=
b.ng339,d=ab[d||-1];if(y(c))d||(b.ng339=d=++ne,d=ab[d]={}),d[a]=c;else return d&&d[a]}function Mb(b,a,c){var d=oa(b,"data"),e=y(c),f=!e&&y(a),g=f&&!T(a);d||g||oa(b,"data",d={});if(e)d[a]=c;else if(f){if(g)return d&&d[a];D(d,a)}else return d}function Nb(b,a){return b.getAttribute?-1<(" "+(b.getAttribute("class")||"")+" ").replace(/[\n\t]/g," ").indexOf(" "+a+" "):!1}function nb(b,a){a&&b.setAttribute&&r(a.split(" "),function(a){b.setAttribute("class",aa((" "+(b.getAttribute("class")||"")+" ").replace(/[\n\t]/g,
" ").replace(" "+aa(a)+" "," ")))})}function ob(b,a){if(a&&b.setAttribute){var c=(" "+(b.getAttribute("class")||"")+" ").replace(/[\n\t]/g," ");r(a.split(" "),function(a){a=aa(a);-1===c.indexOf(" "+a+" ")&&(c+=a+" ")});b.setAttribute("class",aa(c))}}function Jb(b,a){if(a){a=a.nodeName||!y(a.length)||Ga(a)?[a]:a;for(var c=0;c<a.length;c++)b.push(a[c])}}function oc(b,a){return pb(b,"$"+(a||"ngController")+"Controller")}function pb(b,a,c){9==b.nodeType&&(b=b.documentElement);for(a=J(a)?a:[a];b;){for(var d=
0,e=a.length;d<e;d++)if((c=w.data(b,a[d]))!==t)return c;b=b.parentNode||11===b.nodeType&&b.host}}function pc(b){for(var a=0,c=b.childNodes;a<c.length;a++)Ja(c[a]);for(;b.firstChild;)b.removeChild(b.firstChild)}function qc(b,a){var c=qb[a.toLowerCase()];return c&&rc[b.nodeName]&&c}function oe(b,a){var c=function(c,e){c.preventDefault||(c.preventDefault=function(){c.returnValue=!1});c.stopPropagation||(c.stopPropagation=function(){c.cancelBubble=!0});c.target||(c.target=c.srcElement||X);if(x(c.defaultPrevented)){var f=
c.preventDefault;c.preventDefault=function(){c.defaultPrevented=!0;f.call(c)};c.defaultPrevented=!1}c.isDefaultPrevented=function(){return c.defaultPrevented||!1===c.returnValue};var g=ha(a[e||c.type]||[]);r(g,function(a){a.call(b,c)});8>=Q?(c.preventDefault=null,c.stopPropagation=null,c.isDefaultPrevented=null):(delete c.preventDefault,delete c.stopPropagation,delete c.isDefaultPrevented)};c.elem=b;return c}function Ka(b,a){var c=typeof b,d;"function"==c||"object"==c&&null!==b?"function"==typeof(d=
b.$$hashKey)?d=b.$$hashKey():d===t&&(d=b.$$hashKey=(a||hb)()):d=b;return c+":"+d}function bb(b,a){if(a){var c=0;this.nextUid=function(){return++c}}r(b,this.put,this)}function sc(b){var a,c;"function"===typeof b?(a=b.$inject)||(a=[],b.length&&(c=b.toString().replace(pe,""),c=c.match(qe),r(c[1].split(re),function(b){b.replace(se,function(b,c,d){a.push(d)})})),b.$inject=a):J(b)?(c=b.length-1,Wa(b[c],"fn"),a=b.slice(0,c)):Wa(b,"fn",!0);return a}function gc(b){function a(a){return function(b,c){if(T(b))r(b,
$b(a));else return a(b,c)}}function c(a,b){Da(a,"service");if(P(b)||J(b))b=n.instantiate(b);if(!b.$get)throw cb("pget",a);return l[a+k]=b}function d(a,b){return c(a,{$get:b})}function e(a){var b=[],c,d,f,k;r(a,function(a){if(!h.get(a)){h.put(a,!0);try{if(v(a))for(c=Ya(a),b=b.concat(e(c.requires)).concat(c._runBlocks),d=c._invokeQueue,f=0,k=d.length;f<k;f++){var g=d[f],m=n.get(g[0]);m[g[1]].apply(m,g[2])}else P(a)?b.push(n.invoke(a)):J(a)?b.push(n.invoke(a)):Wa(a,"module")}catch(l){throw J(a)&&(a=
a[a.length-1]),l.message&&(l.stack&&-1==l.stack.indexOf(l.message))&&(l=l.message+"\n"+l.stack),cb("modulerr",a,l.stack||l.message||l);}}});return b}function f(a,b){function c(d){if(a.hasOwnProperty(d)){if(a[d]===g)throw cb("cdep",d+" <- "+m.join(" <- "));return a[d]}try{return m.unshift(d),a[d]=g,a[d]=b(d)}catch(e){throw a[d]===g&&delete a[d],e;}finally{m.shift()}}function d(a,b,e){var f=[],k=sc(a),g,m,h;m=0;for(g=k.length;m<g;m++){h=k[m];if("string"!==typeof h)throw cb("itkn",h);f.push(e&&e.hasOwnProperty(h)?
e[h]:c(h))}J(a)&&(a=a[g]);return a.apply(b,f)}return{invoke:d,instantiate:function(a,b){var c=function(){},e;c.prototype=(J(a)?a[a.length-1]:a).prototype;c=new c;e=d(a,c,b);return T(e)||P(e)?e:c},get:c,annotate:sc,has:function(b){return l.hasOwnProperty(b+k)||a.hasOwnProperty(b)}}}var g={},k="Provider",m=[],h=new bb([],!0),l={$provide:{provider:a(c),factory:a(d),service:a(function(a,b){return d(a,["$injector",function(a){return a.instantiate(b)}])}),value:a(function(a,b){return d(a,ba(b))}),constant:a(function(a,
b){Da(a,"constant");l[a]=b;p[a]=b}),decorator:function(a,b){var c=n.get(a+k),d=c.$get;c.$get=function(){var a=q.invoke(d,c);return q.invoke(b,null,{$delegate:a})}}}},n=l.$injector=f(l,function(){throw cb("unpr",m.join(" <- "));}),p={},q=p.$injector=f(p,function(a){a=n.get(a+k);return q.invoke(a.$get,a)});r(e(b),function(a){q.invoke(a||E)});return q}function Ld(){var b=!0;this.disableAutoScrolling=function(){b=!1};this.$get=["$window","$location","$rootScope",function(a,c,d){function e(a){var b=null;
r(a,function(a){b||"a"!==K(a.nodeName)||(b=a)});return b}function f(){var b=c.hash(),d;b?(d=g.getElementById(b))?d.scrollIntoView():(d=e(g.getElementsByName(b)))?d.scrollIntoView():"top"===b&&a.scrollTo(0,0):a.scrollTo(0,0)}var g=a.document;b&&d.$watch(function(){return c.hash()},function(){d.$evalAsync(f)});return f}]}function he(){this.$get=["$$rAF","$timeout",function(b,a){return b.supported?function(a){return b(a)}:function(b){return a(b,0,!1)}}]}function te(b,a,c,d){function e(a){try{a.apply(null,
Ba.call(arguments,1))}finally{if(s--,0===s)for(;F.length;)try{F.pop()()}catch(b){c.error(b)}}}function f(a,b){(function fa(){r(u,function(a){a()});A=b(fa,a)})()}function g(){z=null;N!=k.url()&&(N=k.url(),r(ca,function(a){a(k.url())}))}var k=this,m=a[0],h=b.location,l=b.history,n=b.setTimeout,p=b.clearTimeout,q={};k.isMock=!1;var s=0,F=[];k.$$completeOutstandingRequest=e;k.$$incOutstandingRequestCount=function(){s++};k.notifyWhenNoOutstandingRequests=function(a){r(u,function(a){a()});0===s?a():F.push(a)};
var u=[],A;k.addPollFn=function(a){x(A)&&f(100,n);u.push(a);return a};var N=h.href,R=a.find("base"),z=null;k.url=function(a,c){h!==b.location&&(h=b.location);l!==b.history&&(l=b.history);if(a){if(N!=a)return N=a,d.history?c?l.replaceState(null,"",a):(l.pushState(null,"",a),R.attr("href",R.attr("href"))):(z=a,c?h.replace(a):h.href=a),k}else return z||h.href.replace(/%27/g,"'")};var ca=[],L=!1;k.onUrlChange=function(a){if(!L){if(d.history)w(b).on("popstate",g);if(d.hashchange)w(b).on("hashchange",g);
else k.addPollFn(g);L=!0}ca.push(a);return a};k.$$checkUrlChange=g;k.baseHref=function(){var a=R.attr("href");return a?a.replace(/^(https?\:)?\/\/[^\/]*/,""):""};var O={},da="",B=k.baseHref();k.cookies=function(a,b){var d,e,f,k;if(a)b===t?m.cookie=escape(a)+"=;path="+B+";expires=Thu, 01 Jan 1970 00:00:00 GMT":v(b)&&(d=(m.cookie=escape(a)+"="+escape(b)+";path="+B).length+1,4096<d&&c.warn("Cookie '"+a+"' possibly not set or overflowed because it was too large ("+d+" > 4096 bytes)!"));else{if(m.cookie!==
da)for(da=m.cookie,d=da.split("; "),O={},f=0;f<d.length;f++)e=d[f],k=e.indexOf("="),0<k&&(a=unescape(e.substring(0,k)),O[a]===t&&(O[a]=unescape(e.substring(k+1))));return O}};k.defer=function(a,b){var c;s++;c=n(function(){delete q[c];e(a)},b||0);q[c]=!0;return c};k.defer.cancel=function(a){return q[a]?(delete q[a],p(a),e(E),!0):!1}}function Nd(){this.$get=["$window","$log","$sniffer","$document",function(b,a,c,d){return new te(b,d,a,c)}]}function Od(){this.$get=function(){function b(b,d){function e(a){a!=
n&&(p?p==a&&(p=a.n):p=a,f(a.n,a.p),f(a,n),n=a,n.n=null)}function f(a,b){a!=b&&(a&&(a.p=b),b&&(b.n=a))}if(b in a)throw C("$cacheFactory")("iid",b);var g=0,k=D({},d,{id:b}),m={},h=d&&d.capacity||Number.MAX_VALUE,l={},n=null,p=null;return a[b]={put:function(a,b){if(h<Number.MAX_VALUE){var c=l[a]||(l[a]={key:a});e(c)}if(!x(b))return a in m||g++,m[a]=b,g>h&&this.remove(p.key),b},get:function(a){if(h<Number.MAX_VALUE){var b=l[a];if(!b)return;e(b)}return m[a]},remove:function(a){if(h<Number.MAX_VALUE){var b=
l[a];if(!b)return;b==n&&(n=b.p);b==p&&(p=b.n);f(b.n,b.p);delete l[a]}delete m[a];g--},removeAll:function(){m={};g=0;l={};n=p=null},destroy:function(){l=k=m=null;delete a[b]},info:function(){return D({},k,{size:g})}}}var a={};b.info=function(){var b={};r(a,function(a,e){b[e]=a.info()});return b};b.get=function(b){return a[b]};return b}}function de(){this.$get=["$cacheFactory",function(b){return b("templates")}]}function ic(b,a){var c={},d="Directive",e=/^\s*directive\:\s*([\d\w_\-]+)\s+(.*)$/,f=/(([\d\w_\-]+)(?:\:([^;]+))?;?)/,
g=/^(on[a-z]+|formaction)$/;this.directive=function m(a,e){Da(a,"directive");v(a)?(Db(e,"directiveFactory"),c.hasOwnProperty(a)||(c[a]=[],b.factory(a+d,["$injector","$exceptionHandler",function(b,d){var e=[];r(c[a],function(c,f){try{var g=b.invoke(c);P(g)?g={compile:ba(g)}:!g.compile&&g.link&&(g.compile=ba(g.link));g.priority=g.priority||0;g.index=f;g.name=g.name||a;g.require=g.require||g.controller&&g.name;g.restrict=g.restrict||"A";e.push(g)}catch(m){d(m)}});return e}])),c[a].push(e)):r(a,$b(m));
return this};this.aHrefSanitizationWhitelist=function(b){return y(b)?(a.aHrefSanitizationWhitelist(b),this):a.aHrefSanitizationWhitelist()};this.imgSrcSanitizationWhitelist=function(b){return y(b)?(a.imgSrcSanitizationWhitelist(b),this):a.imgSrcSanitizationWhitelist()};this.$get=["$injector","$interpolate","$exceptionHandler","$http","$templateCache","$parse","$controller","$rootScope","$document","$sce","$animate","$$sanitizeUri",function(a,b,l,n,p,q,s,F,u,A,N,R){function z(a,b,c,d,e){a instanceof
w||(a=w(a));r(a,function(b,c){3==b.nodeType&&b.nodeValue.match(/\S+/)&&(a[c]=w(b).wrap("<span></span>").parent()[0])});var f=L(a,b,a,c,d,e);ca(a,"ng-scope");return function(b,c,d,e){Db(b,"scope");var g=c?La.clone.call(a):a;r(d,function(a,b){g.data("$"+b+"Controller",a)});d=0;for(var m=g.length;d<m;d++){var h=g[d].nodeType;1!==h&&9!==h||g.eq(d).data("$scope",b)}c&&c(g,b);f&&f(b,g,g,e);return g}}function ca(a,b){try{a.addClass(b)}catch(c){}}function L(a,b,c,d,e,f){function g(a,c,d,e){var f,h,l,q,n,
p,s;f=c.length;var M=Array(f);for(q=0;q<f;q++)M[q]=c[q];p=q=0;for(n=m.length;q<n;p++)h=M[p],c=m[q++],f=m[q++],c?(c.scope?(l=a.$new(),w.data(h,"$scope",l)):l=a,s=c.transcludeOnThisElement?O(a,c.transclude,e):!c.templateOnThisElement&&e?e:!e&&b?O(a,b):null,c(f,l,h,d,s)):f&&f(a,h.childNodes,t,e)}for(var m=[],h,l,q,n,p=0;p<a.length;p++)h=new Ob,l=da(a[p],[],h,0===p?d:t,e),(f=l.length?H(l,a[p],h,b,c,null,[],[],f):null)&&f.scope&&ca(h.$$element,"ng-scope"),h=f&&f.terminal||!(q=a[p].childNodes)||!q.length?
null:L(q,f?(f.transcludeOnThisElement||!f.templateOnThisElement)&&f.transclude:b),m.push(f,h),n=n||f||h,f=null;return n?g:null}function O(a,b,c){return function(d,e,f){var g=!1;d||(d=a.$new(),g=d.$$transcluded=!0);e=b(d,e,f,c);if(g)e.on("$destroy",function(){d.$destroy()});return e}}function da(a,b,c,d,g){var m=c.$attr,h;switch(a.nodeType){case 1:fa(b,pa(Ma(a).toLowerCase()),"E",d,g);for(var l,q,n,p=a.attributes,s=0,F=p&&p.length;s<F;s++){var A=!1,N=!1;l=p[s];if(!Q||8<=Q||l.specified){h=l.name;q=
aa(l.value);l=pa(h);if(n=U.test(l))h=mb(l.substr(6),"-");var u=l.replace(/(Start|End)$/,"");l===u+"Start"&&(A=h,N=h.substr(0,h.length-5)+"end",h=h.substr(0,h.length-6));l=pa(h.toLowerCase());m[l]=h;if(n||!c.hasOwnProperty(l))c[l]=q,qc(a,l)&&(c[l]=!0);S(a,b,q,l);fa(b,l,"A",d,g,A,N)}}a=a.className;if(v(a)&&""!==a)for(;h=f.exec(a);)l=pa(h[2]),fa(b,l,"C",d,g)&&(c[l]=aa(h[3])),a=a.substr(h.index+h[0].length);break;case 3:K(b,a.nodeValue);break;case 8:try{if(h=e.exec(a.nodeValue))l=pa(h[1]),fa(b,l,"M",
d,g)&&(c[l]=aa(h[2]))}catch(z){}}b.sort(x);return b}function B(a,b,c){var d=[],e=0;if(b&&a.hasAttribute&&a.hasAttribute(b)){do{if(!a)throw ja("uterdir",b,c);1==a.nodeType&&(a.hasAttribute(b)&&e++,a.hasAttribute(c)&&e--);d.push(a);a=a.nextSibling}while(0<e)}else d.push(a);return w(d)}function I(a,b,c){return function(d,e,f,g,h){e=B(e[0],b,c);return a(d,e,f,g,h)}}function H(a,c,d,e,f,g,m,n,p){function F(a,b,c,d){if(a){c&&(a=I(a,c,d));a.require=G.require;a.directiveName=C;if(L===G||G.$$isolateScope)a=
tc(a,{isolateScope:!0});m.push(a)}if(b){c&&(b=I(b,c,d));b.require=G.require;b.directiveName=C;if(L===G||G.$$isolateScope)b=tc(b,{isolateScope:!0});n.push(b)}}function A(a,b,c,d){var e,f="data",g=!1;if(v(b)){for(;"^"==(e=b.charAt(0))||"?"==e;)b=b.substr(1),"^"==e&&(f="inheritedData"),g=g||"?"==e;e=null;d&&"data"===f&&(e=d[b]);e=e||c[f]("$"+b+"Controller");if(!e&&!g)throw ja("ctreq",b,a);}else J(b)&&(e=[],r(b,function(b){e.push(A(a,b,c,d))}));return e}function N(a,e,f,g,p){function F(a,b){var c;2>arguments.length&&
(b=a,a=t);K&&(c=da);return p(a,b,c)}var u,M,z,O,I,B,da={},rb;u=c===f?d:ha(d,new Ob(w(f),d.$attr));M=u.$$element;if(L){var Na=/^\s*([@=&])(\??)\s*(\w*)\s*$/;B=e.$new(!0);!H||H!==L&&H!==L.$$originalDirective?M.data("$isolateScopeNoTemplate",B):M.data("$isolateScope",B);ca(M,"ng-isolate-scope");r(L.scope,function(a,c){var d=a.match(Na)||[],f=d[3]||c,g="?"==d[2],d=d[1],m,l,n,p;B.$$isolateBindings[c]=d+f;switch(d){case "@":u.$observe(f,function(a){B[c]=a});u.$$observers[f].$$scope=e;u[f]&&(B[c]=b(u[f])(e));
break;case "=":if(g&&!u[f])break;l=q(u[f]);p=l.literal?Aa:function(a,b){return a===b||a!==a&&b!==b};n=l.assign||function(){m=B[c]=l(e);throw ja("nonassign",u[f],L.name);};m=B[c]=l(e);B.$watch(function(){var a=l(e);p(a,B[c])||(p(a,m)?n(e,a=B[c]):B[c]=a);return m=a},null,l.literal);break;case "&":l=q(u[f]);B[c]=function(a){return l(e,a)};break;default:throw ja("iscp",L.name,c,a);}})}rb=p&&F;R&&r(R,function(a){var b={$scope:a===L||a.$$isolateScope?B:e,$element:M,$attrs:u,$transclude:rb},c;I=a.controller;
"@"==I&&(I=u[a.name]);c=s(I,b);da[a.name]=c;K||M.data("$"+a.name+"Controller",c);a.controllerAs&&(b.$scope[a.controllerAs]=c)});g=0;for(z=m.length;g<z;g++)try{O=m[g],O(O.isolateScope?B:e,M,u,O.require&&A(O.directiveName,O.require,M,da),rb)}catch(G){l(G,ia(M))}g=e;L&&(L.template||null===L.templateUrl)&&(g=B);a&&a(g,f.childNodes,t,p);for(g=n.length-1;0<=g;g--)try{O=n[g],O(O.isolateScope?B:e,M,u,O.require&&A(O.directiveName,O.require,M,da),rb)}catch(y){l(y,ia(M))}}p=p||{};for(var u=-Number.MAX_VALUE,
O,R=p.controllerDirectives,L=p.newIsolateScopeDirective,H=p.templateDirective,fa=p.nonTlbTranscludeDirective,x=!1,D=!1,K=p.hasElementTranscludeDirective,Z=d.$$element=w(c),G,C,V,S=e,Q,Fa=0,qa=a.length;Fa<qa;Fa++){G=a[Fa];var U=G.$$start,Y=G.$$end;U&&(Z=B(c,U,Y));V=t;if(u>G.priority)break;if(V=G.scope)O=O||G,G.templateUrl||(db("new/isolated scope",L,G,Z),T(V)&&(L=G));C=G.name;!G.templateUrl&&G.controller&&(V=G.controller,R=R||{},db("'"+C+"' controller",R[C],G,Z),R[C]=G);if(V=G.transclude)x=!0,G.$$tlb||
(db("transclusion",fa,G,Z),fa=G),"element"==V?(K=!0,u=G.priority,V=Z,Z=d.$$element=w(X.createComment(" "+C+": "+d[C]+" ")),c=Z[0],Na(f,Ba.call(V,0),c),S=z(V,e,u,g&&g.name,{nonTlbTranscludeDirective:fa})):(V=w(Kb(c)).contents(),Z.empty(),S=z(V,e));if(G.template)if(D=!0,db("template",H,G,Z),H=G,V=P(G.template)?G.template(Z,d):G.template,V=W(V),G.replace){g=G;V=Ib.test(V)?w(aa(V)):[];c=V[0];if(1!=V.length||1!==c.nodeType)throw ja("tplrt",C,"");Na(f,Z,c);qa={$attr:{}};V=da(c,[],qa);var $=a.splice(Fa+
1,a.length-(Fa+1));L&&y(V);a=a.concat(V).concat($);E(d,qa);qa=a.length}else Z.html(V);if(G.templateUrl)D=!0,db("template",H,G,Z),H=G,G.replace&&(g=G),N=ue(a.splice(Fa,a.length-Fa),Z,d,f,x&&S,m,n,{controllerDirectives:R,newIsolateScopeDirective:L,templateDirective:H,nonTlbTranscludeDirective:fa}),qa=a.length;else if(G.compile)try{Q=G.compile(Z,d,S),P(Q)?F(null,Q,U,Y):Q&&F(Q.pre,Q.post,U,Y)}catch(ve){l(ve,ia(Z))}G.terminal&&(N.terminal=!0,u=Math.max(u,G.priority))}N.scope=O&&!0===O.scope;N.transcludeOnThisElement=
x;N.templateOnThisElement=D;N.transclude=S;p.hasElementTranscludeDirective=K;return N}function y(a){for(var b=0,c=a.length;b<c;b++)a[b]=bc(a[b],{$$isolateScope:!0})}function fa(b,e,f,g,h,q,n){if(e===h)return null;h=null;if(c.hasOwnProperty(e)){var p;e=a.get(e+d);for(var s=0,u=e.length;s<u;s++)try{p=e[s],(g===t||g>p.priority)&&-1!=p.restrict.indexOf(f)&&(q&&(p=bc(p,{$$start:q,$$end:n})),b.push(p),h=p)}catch(F){l(F)}}return h}function E(a,b){var c=b.$attr,d=a.$attr,e=a.$$element;r(a,function(d,e){"$"!=
e.charAt(0)&&(b[e]&&b[e]!==d&&(d+=("style"===e?";":" ")+b[e]),a.$set(e,d,!0,c[e]))});r(b,function(b,f){"class"==f?(ca(e,b),a["class"]=(a["class"]?a["class"]+" ":"")+b):"style"==f?(e.attr("style",e.attr("style")+";"+b),a.style=(a.style?a.style+";":"")+b):"$"==f.charAt(0)||a.hasOwnProperty(f)||(a[f]=b,d[f]=c[f])})}function ue(a,b,c,d,e,f,g,h){var m=[],l,q,s=b[0],u=a.shift(),F=D({},u,{templateUrl:null,transclude:null,replace:null,$$originalDirective:u}),N=P(u.templateUrl)?u.templateUrl(b,c):u.templateUrl;
b.empty();n.get(A.getTrustedResourceUrl(N),{cache:p}).success(function(n){var p,A;n=W(n);if(u.replace){n=Ib.test(n)?w(aa(n)):[];p=n[0];if(1!=n.length||1!==p.nodeType)throw ja("tplrt",u.name,N);n={$attr:{}};Na(d,b,p);var z=da(p,[],n);T(u.scope)&&y(z);a=z.concat(a);E(c,n)}else p=s,b.html(n);a.unshift(F);l=H(a,p,c,e,b,u,f,g,h);r(d,function(a,c){a==p&&(d[c]=b[0])});for(q=L(b[0].childNodes,e);m.length;){n=m.shift();A=m.shift();var R=m.shift(),I=m.shift(),z=b[0];if(A!==s){var B=A.className;h.hasElementTranscludeDirective&&
u.replace||(z=Kb(p));Na(R,w(A),z);ca(w(z),B)}A=l.transcludeOnThisElement?O(n,l.transclude,I):I;l(q,n,z,d,A)}m=null}).error(function(a,b,c,d){throw ja("tpload",d.url);});return function(a,b,c,d,e){a=e;m?(m.push(b),m.push(c),m.push(d),m.push(a)):(l.transcludeOnThisElement&&(a=O(b,l.transclude,e)),l(q,b,c,d,a))}}function x(a,b){var c=b.priority-a.priority;return 0!==c?c:a.name!==b.name?a.name<b.name?-1:1:a.index-b.index}function db(a,b,c,d){if(b)throw ja("multidir",b.name,c.name,a,ia(d));}function K(a,
c){var d=b(c,!0);d&&a.push({priority:0,compile:function(a){var b=a.parent().length;b&&ca(a.parent(),"ng-binding");return function(a,c){var e=c.parent(),f=e.data("$binding")||[];f.push(d);e.data("$binding",f);b||ca(e,"ng-binding");a.$watch(d,function(a){c[0].nodeValue=a})}}})}function C(a,b){if("srcdoc"==b)return A.HTML;var c=Ma(a);if("xlinkHref"==b||"FORM"==c&&"action"==b||"IMG"!=c&&("src"==b||"ngSrc"==b))return A.RESOURCE_URL}function S(a,c,d,e){var f=b(d,!0);if(f){if("multiple"===e&&"SELECT"===
Ma(a))throw ja("selmulti",ia(a));c.push({priority:100,compile:function(){return{pre:function(c,d,m){d=m.$$observers||(m.$$observers={});if(g.test(e))throw ja("nodomevents");if(f=b(m[e],!0,C(a,e)))m[e]=f(c),(d[e]||(d[e]=[])).$$inter=!0,(m.$$observers&&m.$$observers[e].$$scope||c).$watch(f,function(a,b){"class"===e&&a!=b?m.$updateClass(a,b):m.$set(e,a)})}}}})}}function Na(a,b,c){var d=b[0],e=b.length,f=d.parentNode,g,m;if(a)for(g=0,m=a.length;g<m;g++)if(a[g]==d){a[g++]=c;m=g+e-1;for(var h=a.length;g<
h;g++,m++)m<h?a[g]=a[m]:delete a[g];a.length-=e-1;break}f&&f.replaceChild(c,d);a=X.createDocumentFragment();a.appendChild(d);c[w.expando]=d[w.expando];d=1;for(e=b.length;d<e;d++)f=b[d],w(f).remove(),a.appendChild(f),delete b[d];b[0]=c;b.length=1}function tc(a,b){return D(function(){return a.apply(null,arguments)},a,b)}var Ob=function(a,b){this.$$element=a;this.$attr=b||{}};Ob.prototype={$normalize:pa,$addClass:function(a){a&&0<a.length&&N.addClass(this.$$element,a)},$removeClass:function(a){a&&0<
a.length&&N.removeClass(this.$$element,a)},$updateClass:function(a,b){var c=uc(a,b),d=uc(b,a);0===c.length?N.removeClass(this.$$element,d):0===d.length?N.addClass(this.$$element,c):N.setClass(this.$$element,c,d)},$set:function(a,b,c,d){var e=qc(this.$$element[0],a);e&&(this.$$element.prop(a,b),d=e);this[a]=b;d?this.$attr[a]=d:(d=this.$attr[a])||(this.$attr[a]=d=mb(a,"-"));e=Ma(this.$$element);if("A"===e&&"href"===a||"IMG"===e&&"src"===a)this[a]=b=R(b,"src"===a);!1!==c&&(null===b||b===t?this.$$element.removeAttr(d):
this.$$element.attr(d,b));(c=this.$$observers)&&r(c[a],function(a){try{a(b)}catch(c){l(c)}})},$observe:function(a,b){var c=this,d=c.$$observers||(c.$$observers={}),e=d[a]||(d[a]=[]);e.push(b);F.$evalAsync(function(){e.$$inter||b(c[a])});return b}};var qa=b.startSymbol(),Z=b.endSymbol(),W="{{"==qa||"}}"==Z?Qa:function(a){return a.replace(/\{\{/g,qa).replace(/}}/g,Z)},U=/^ngAttr[A-Z]/;return z}]}function pa(b){return Za(b.replace(we,""))}function uc(b,a){var c="",d=b.split(/\s+/),e=a.split(/\s+/),f=
0;a:for(;f<d.length;f++){for(var g=d[f],k=0;k<e.length;k++)if(g==e[k])continue a;c+=(0<c.length?" ":"")+g}return c}function Pd(){var b={},a=/^(\S+)(\s+as\s+(\w+))?$/;this.register=function(a,d){Da(a,"controller");T(a)?D(b,a):b[a]=d};this.$get=["$injector","$window",function(c,d){return function(e,f){var g,k,m;v(e)&&(g=e.match(a),k=g[1],m=g[3],e=b.hasOwnProperty(k)?b[k]:hc(f.$scope,k,!0)||hc(d,k,!0),Wa(e,k,!0));g=c.instantiate(e,f);if(m){if(!f||"object"!==typeof f.$scope)throw C("$controller")("noscp",
k||e.name,m);f.$scope[m]=g}return g}}]}function Qd(){this.$get=["$window",function(b){return w(b.document)}]}function Rd(){this.$get=["$log",function(b){return function(a,c){b.error.apply(b,arguments)}}]}function vc(b){var a={},c,d,e;if(!b)return a;r(b.split("\n"),function(b){e=b.indexOf(":");c=K(aa(b.substr(0,e)));d=aa(b.substr(e+1));c&&(a[c]=a[c]?a[c]+", "+d:d)});return a}function wc(b){var a=T(b)?b:t;return function(c){a||(a=vc(b));return c?a[K(c)]||null:a}}function xc(b,a,c){if(P(c))return c(b,
a);r(c,function(c){b=c(b,a)});return b}function Ud(){var b=/^\s*(\[|\{[^\{])/,a=/[\}\]]\s*$/,c=/^\)\]\}',?\n/,d={"Content-Type":"application/json;charset=utf-8"},e=this.defaults={transformResponse:[function(d){v(d)&&(d=d.replace(c,""),b.test(d)&&a.test(d)&&(d=cc(d)));return d}],transformRequest:[function(a){return T(a)&&"[object File]"!==za.call(a)&&"[object Blob]"!==za.call(a)?na(a):a}],headers:{common:{Accept:"application/json, text/plain, */*"},post:ha(d),put:ha(d),patch:ha(d)},xsrfCookieName:"XSRF-TOKEN",
xsrfHeaderName:"X-XSRF-TOKEN"},f=this.interceptors=[],g=this.responseInterceptors=[];this.$get=["$httpBackend","$browser","$cacheFactory","$rootScope","$q","$injector",function(a,b,c,d,n,p){function q(a){function b(a){var d=D({},a,{data:xc(a.data,a.headers,c.transformResponse)});return 200<=a.status&&300>a.status?d:n.reject(d)}var c={method:"get",transformRequest:e.transformRequest,transformResponse:e.transformResponse},d=function(a){var b=e.headers,c=D({},a.headers),d,f,b=D({},b.common,b[K(a.method)]);
a:for(d in b){a=K(d);for(f in c)if(K(f)===a)continue a;c[d]=b[d]}(function(a){var b;r(a,function(c,d){P(c)&&(b=c(),null!=b?a[d]=b:delete a[d])})})(c);return c}(a);D(c,a);c.headers=d;c.method=Ia(c.method);var f=[function(a){d=a.headers;var c=xc(a.data,wc(d),a.transformRequest);x(c)&&r(d,function(a,b){"content-type"===K(b)&&delete d[b]});x(a.withCredentials)&&!x(e.withCredentials)&&(a.withCredentials=e.withCredentials);return s(a,c,d).then(b,b)},t],g=n.when(c);for(r(A,function(a){(a.request||a.requestError)&&
f.unshift(a.request,a.requestError);(a.response||a.responseError)&&f.push(a.response,a.responseError)});f.length;){a=f.shift();var m=f.shift(),g=g.then(a,m)}g.success=function(a){g.then(function(b){a(b.data,b.status,b.headers,c)});return g};g.error=function(a){g.then(null,function(b){a(b.data,b.status,b.headers,c)});return g};return g}function s(c,f,g){function h(a,b,c,e){I&&(200<=a&&300>a?I.put(w,[a,b,vc(c),e]):I.remove(w));p(b,a,c,e);d.$$phase||d.$apply()}function p(a,b,d,e){b=Math.max(b,0);(200<=
b&&300>b?A.resolve:A.reject)({data:a,status:b,headers:wc(d),config:c,statusText:e})}function s(){var a=Ra(q.pendingRequests,c);-1!==a&&q.pendingRequests.splice(a,1)}var A=n.defer(),r=A.promise,I,H,w=F(c.url,c.params);q.pendingRequests.push(c);r.then(s,s);!c.cache&&!e.cache||(!1===c.cache||"GET"!==c.method&&"JSONP"!==c.method)||(I=T(c.cache)?c.cache:T(e.cache)?e.cache:u);if(I)if(H=I.get(w),y(H)){if(H&&P(H.then))return H.then(s,s),H;J(H)?p(H[1],H[0],ha(H[2]),H[3]):p(H,200,{},"OK")}else I.put(w,r);x(H)&&
((H=Pb(c.url)?b.cookies()[c.xsrfCookieName||e.xsrfCookieName]:t)&&(g[c.xsrfHeaderName||e.xsrfHeaderName]=H),a(c.method,w,f,h,g,c.timeout,c.withCredentials,c.responseType));return r}function F(a,b){if(!b)return a;var c=[];Tc(b,function(a,b){null===a||x(a)||(J(a)||(a=[a]),r(a,function(a){T(a)&&(a=ta(a)?a.toISOString():na(a));c.push(Ca(b)+"="+Ca(a))}))});0<c.length&&(a+=(-1==a.indexOf("?")?"?":"&")+c.join("&"));return a}var u=c("$http"),A=[];r(f,function(a){A.unshift(v(a)?p.get(a):p.invoke(a))});r(g,
function(a,b){var c=v(a)?p.get(a):p.invoke(a);A.splice(b,0,{response:function(a){return c(n.when(a))},responseError:function(a){return c(n.reject(a))}})});q.pendingRequests=[];(function(a){r(arguments,function(a){q[a]=function(b,c){return q(D(c||{},{method:a,url:b}))}})})("get","delete","head","jsonp");(function(a){r(arguments,function(a){q[a]=function(b,c,d){return q(D(d||{},{method:a,url:b,data:c}))}})})("post","put");q.defaults=e;return q}]}function xe(b){if(8>=Q&&(!b.match(/^(get|post|head|put|delete|options)$/i)||
!W.XMLHttpRequest))return new W.ActiveXObject("Microsoft.XMLHTTP");if(W.XMLHttpRequest)return new W.XMLHttpRequest;throw C("$httpBackend")("noxhr");}function Vd(){this.$get=["$browser","$window","$document",function(b,a,c){return ye(b,xe,b.defer,a.angular.callbacks,c[0])}]}function ye(b,a,c,d,e){function f(a,b,c){var f=e.createElement("script"),g=null;f.type="text/javascript";f.src=a;f.async=!0;g=function(a){$a(f,"load",g);$a(f,"error",g);e.body.removeChild(f);f=null;var k=-1,s="unknown";a&&("load"!==
a.type||d[b].called||(a={type:"error"}),s=a.type,k="error"===a.type?404:200);c&&c(k,s)};sb(f,"load",g);sb(f,"error",g);8>=Q&&(f.onreadystatechange=function(){v(f.readyState)&&/loaded|complete/.test(f.readyState)&&(f.onreadystatechange=null,g({type:"load"}))});e.body.appendChild(f);return g}var g=-1;return function(e,m,h,l,n,p,q,s){function F(){A=g;R&&R();z&&z.abort()}function u(a,d,e,f,g){L&&c.cancel(L);R=z=null;0===d&&(d=e?200:"file"==ua(m).protocol?404:0);a(1223===d?204:d,e,f,g||"");b.$$completeOutstandingRequest(E)}
var A;b.$$incOutstandingRequestCount();m=m||b.url();if("jsonp"==K(e)){var N="_"+(d.counter++).toString(36);d[N]=function(a){d[N].data=a;d[N].called=!0};var R=f(m.replace("JSON_CALLBACK","angular.callbacks."+N),N,function(a,b){u(l,a,d[N].data,"",b);d[N]=E})}else{var z=a(e);z.open(e,m,!0);r(n,function(a,b){y(a)&&z.setRequestHeader(b,a)});z.onreadystatechange=function(){if(z&&4==z.readyState){var a=null,b=null,c="";A!==g&&(a=z.getAllResponseHeaders(),b="response"in z?z.response:z.responseText);A===g&&
10>Q||(c=z.statusText);u(l,A||z.status,b,a,c)}};q&&(z.withCredentials=!0);if(s)try{z.responseType=s}catch(ca){if("json"!==s)throw ca;}z.send(h||null)}if(0<p)var L=c(F,p);else p&&P(p.then)&&p.then(F)}}function Sd(){var b="{{",a="}}";this.startSymbol=function(a){return a?(b=a,this):b};this.endSymbol=function(b){return b?(a=b,this):a};this.$get=["$parse","$exceptionHandler","$sce",function(c,d,e){function f(f,h,l){for(var n,p,q=0,s=[],F=f.length,u=!1,A=[];q<F;)-1!=(n=f.indexOf(b,q))&&-1!=(p=f.indexOf(a,
n+g))?(q!=n&&s.push(f.substring(q,n)),s.push(q=c(u=f.substring(n+g,p))),q.exp=u,q=p+k,u=!0):(q!=F&&s.push(f.substring(q)),q=F);(F=s.length)||(s.push(""),F=1);if(l&&1<s.length)throw yc("noconcat",f);if(!h||u)return A.length=F,q=function(a){try{for(var b=0,c=F,g;b<c;b++){if("function"==typeof(g=s[b]))if(g=g(a),g=l?e.getTrusted(l,g):e.valueOf(g),null==g)g="";else switch(typeof g){case "string":break;case "number":g=""+g;break;default:g=na(g)}A[b]=g}return A.join("")}catch(k){a=yc("interr",f,k.toString()),
d(a)}},q.exp=f,q.parts=s,q}var g=b.length,k=a.length;f.startSymbol=function(){return b};f.endSymbol=function(){return a};return f}]}function Td(){this.$get=["$rootScope","$window","$q",function(b,a,c){function d(d,g,k,m){var h=a.setInterval,l=a.clearInterval,n=c.defer(),p=n.promise,q=0,s=y(m)&&!m;k=y(k)?k:0;p.then(null,null,d);p.$$intervalId=h(function(){n.notify(q++);0<k&&q>=k&&(n.resolve(q),l(p.$$intervalId),delete e[p.$$intervalId]);s||b.$apply()},g);e[p.$$intervalId]=n;return p}var e={};d.cancel=
function(b){return b&&b.$$intervalId in e?(e[b.$$intervalId].reject("canceled"),a.clearInterval(b.$$intervalId),delete e[b.$$intervalId],!0):!1};return d}]}function bd(){this.$get=function(){return{id:"en-us",NUMBER_FORMATS:{DECIMAL_SEP:".",GROUP_SEP:",",PATTERNS:[{minInt:1,minFrac:0,maxFrac:3,posPre:"",posSuf:"",negPre:"-",negSuf:"",gSize:3,lgSize:3},{minInt:1,minFrac:2,maxFrac:2,posPre:"\u00a4",posSuf:"",negPre:"(\u00a4",negSuf:")",gSize:3,lgSize:3}],CURRENCY_SYM:"$"},DATETIME_FORMATS:{MONTH:"January February March April May June July August September October November December".split(" "),
SHORTMONTH:"Jan Feb Mar Apr May Jun Jul Aug Sep Oct Nov Dec".split(" "),DAY:"Sunday Monday Tuesday Wednesday Thursday Friday Saturday".split(" "),SHORTDAY:"Sun Mon Tue Wed Thu Fri Sat".split(" "),AMPMS:["AM","PM"],medium:"MMM d, y h:mm:ss a","short":"M/d/yy h:mm a",fullDate:"EEEE, MMMM d, y",longDate:"MMMM d, y",mediumDate:"MMM d, y",shortDate:"M/d/yy",mediumTime:"h:mm:ss a",shortTime:"h:mm a"},pluralCat:function(b){return 1===b?"one":"other"}}}}function Qb(b){b=b.split("/");for(var a=b.length;a--;)b[a]=
lb(b[a]);return b.join("/")}function zc(b,a,c){b=ua(b,c);a.$$protocol=b.protocol;a.$$host=b.hostname;a.$$port=U(b.port)||ze[b.protocol]||null}function Ac(b,a,c){var d="/"!==b.charAt(0);d&&(b="/"+b);b=ua(b,c);a.$$path=decodeURIComponent(d&&"/"===b.pathname.charAt(0)?b.pathname.substring(1):b.pathname);a.$$search=ec(b.search);a.$$hash=decodeURIComponent(b.hash);a.$$path&&"/"!=a.$$path.charAt(0)&&(a.$$path="/"+a.$$path)}function ra(b,a){if(0===a.indexOf(b))return a.substr(b.length)}function eb(b){var a=
b.indexOf("#");return-1==a?b:b.substr(0,a)}function Rb(b){return b.substr(0,eb(b).lastIndexOf("/")+1)}function Bc(b,a){this.$$html5=!0;a=a||"";var c=Rb(b);zc(b,this,b);this.$$parse=function(a){var e=ra(c,a);if(!v(e))throw Sb("ipthprfx",a,c);Ac(e,this,b);this.$$path||(this.$$path="/");this.$$compose()};this.$$compose=function(){var a=Cb(this.$$search),b=this.$$hash?"#"+lb(this.$$hash):"";this.$$url=Qb(this.$$path)+(a?"?"+a:"")+b;this.$$absUrl=c+this.$$url.substr(1)};this.$$rewrite=function(d){var e;
if((e=ra(b,d))!==t)return d=e,(e=ra(a,e))!==t?c+(ra("/",e)||e):b+d;if((e=ra(c,d))!==t)return c+e;if(c==d+"/")return c}}function Tb(b,a){var c=Rb(b);zc(b,this,b);this.$$parse=function(d){var e=ra(b,d)||ra(c,d),e="#"==e.charAt(0)?ra(a,e):this.$$html5?e:"";if(!v(e))throw Sb("ihshprfx",d,a);Ac(e,this,b);d=this.$$path;var f=/^\/[A-Z]:(\/.*)/;0===e.indexOf(b)&&(e=e.replace(b,""));f.exec(e)||(d=(e=f.exec(d))?e[1]:d);this.$$path=d;this.$$compose()};this.$$compose=function(){var c=Cb(this.$$search),e=this.$$hash?
"#"+lb(this.$$hash):"";this.$$url=Qb(this.$$path)+(c?"?"+c:"")+e;this.$$absUrl=b+(this.$$url?a+this.$$url:"")};this.$$rewrite=function(a){if(eb(b)==eb(a))return a}}function Ub(b,a){this.$$html5=!0;Tb.apply(this,arguments);var c=Rb(b);this.$$rewrite=function(d){var e;if(b==eb(d))return d;if(e=ra(c,d))return b+a+e;if(c===d+"/")return c};this.$$compose=function(){var c=Cb(this.$$search),e=this.$$hash?"#"+lb(this.$$hash):"";this.$$url=Qb(this.$$path)+(c?"?"+c:"")+e;this.$$absUrl=b+a+this.$$url}}function tb(b){return function(){return this[b]}}
function Cc(b,a){return function(c){if(x(c))return this[b];this[b]=a(c);this.$$compose();return this}}function Wd(){var b="",a=!1;this.hashPrefix=function(a){return y(a)?(b=a,this):b};this.html5Mode=function(b){return y(b)?(a=b,this):a};this.$get=["$rootScope","$browser","$sniffer","$rootElement",function(c,d,e,f){function g(a){c.$broadcast("$locationChangeSuccess",k.absUrl(),a)}var k,m,h=d.baseHref(),l=d.url(),n;a?(n=l.substring(0,l.indexOf("/",l.indexOf("//")+2))+(h||"/"),m=e.history?Bc:Ub):(n=
eb(l),m=Tb);k=new m(n,"#"+b);k.$$parse(k.$$rewrite(l));var p=/^\s*(javascript|mailto):/i;f.on("click",function(a){if(!a.ctrlKey&&!a.metaKey&&2!=a.which){for(var e=w(a.target);"a"!==K(e[0].nodeName);)if(e[0]===f[0]||!(e=e.parent())[0])return;var g=e.prop("href");T(g)&&"[object SVGAnimatedString]"===g.toString()&&(g=ua(g.animVal).href);if(!p.test(g)){if(m===Ub){var h=e.attr("href")||e.attr("xlink:href");if(h&&0>h.indexOf("://"))if(g="#"+b,"/"==h[0])g=n+g+h;else if("#"==h[0])g=n+g+(k.path()||"/")+h;
else{var l=k.path().split("/"),h=h.split("/");2!==l.length||l[1]||(l.length=1);for(var q=0;q<h.length;q++)"."!=h[q]&&(".."==h[q]?l.pop():h[q].length&&l.push(h[q]));g=n+g+l.join("/")}}l=k.$$rewrite(g);g&&(!e.attr("target")&&l&&!a.isDefaultPrevented())&&(a.preventDefault(),l!=d.url()&&(k.$$parse(l),c.$apply(),W.angular["ff-684208-preventDefault"]=!0))}}});k.absUrl()!=l&&d.url(k.absUrl(),!0);d.onUrlChange(function(a){k.absUrl()!=a&&(c.$evalAsync(function(){var b=k.absUrl();k.$$parse(a);c.$broadcast("$locationChangeStart",
a,b).defaultPrevented?(k.$$parse(b),d.url(b)):g(b)}),c.$$phase||c.$digest())});var q=0;c.$watch(function(){var a=d.url(),b=k.$$replace;q&&a==k.absUrl()||(q++,c.$evalAsync(function(){c.$broadcast("$locationChangeStart",k.absUrl(),a).defaultPrevented?k.$$parse(a):(d.url(k.absUrl(),b),g(a))}));k.$$replace=!1;return q});return k}]}function Xd(){var b=!0,a=this;this.debugEnabled=function(a){return y(a)?(b=a,this):b};this.$get=["$window",function(c){function d(a){a instanceof Error&&(a.stack?a=a.message&&
-1===a.stack.indexOf(a.message)?"Error: "+a.message+"\n"+a.stack:a.stack:a.sourceURL&&(a=a.message+"\n"+a.sourceURL+":"+a.line));return a}function e(a){var b=c.console||{},e=b[a]||b.log||E;a=!1;try{a=!!e.apply}catch(m){}return a?function(){var a=[];r(arguments,function(b){a.push(d(b))});return e.apply(b,a)}:function(a,b){e(a,null==b?"":b)}}return{log:e("log"),info:e("info"),warn:e("warn"),error:e("error"),debug:function(){var c=e("debug");return function(){b&&c.apply(a,arguments)}}()}}]}function ka(b,
a){if("__defineGetter__"===b||"__defineSetter__"===b||"__lookupGetter__"===b||"__lookupSetter__"===b||"__proto__"===b)throw la("isecfld",a);return b}function va(b,a){if(b){if(b.constructor===b)throw la("isecfn",a);if(b.document&&b.location&&b.alert&&b.setInterval)throw la("isecwindow",a);if(b.children&&(b.nodeName||b.prop&&b.attr&&b.find))throw la("isecdom",a);if(b===Object)throw la("isecobj",a);}return b}function ub(b,a,c,d,e){va(b,d);e=e||{};a=a.split(".");for(var f,g=0;1<a.length;g++){f=ka(a.shift(),
d);var k=va(b[f],d);k||(k={},b[f]=k);b=k;b.then&&e.unwrapPromises&&(wa(d),"$$v"in b||function(a){a.then(function(b){a.$$v=b})}(b),b.$$v===t&&(b.$$v={}),b=b.$$v)}f=ka(a.shift(),d);va(b[f],d);return b[f]=c}function Dc(b,a,c,d,e,f,g){ka(b,f);ka(a,f);ka(c,f);ka(d,f);ka(e,f);return g.unwrapPromises?function(g,m){var h=m&&m.hasOwnProperty(b)?m:g,l;if(null==h)return h;(h=h[b])&&h.then&&(wa(f),"$$v"in h||(l=h,l.$$v=t,l.then(function(a){l.$$v=a})),h=h.$$v);if(!a)return h;if(null==h)return t;(h=h[a])&&h.then&&
(wa(f),"$$v"in h||(l=h,l.$$v=t,l.then(function(a){l.$$v=a})),h=h.$$v);if(!c)return h;if(null==h)return t;(h=h[c])&&h.then&&(wa(f),"$$v"in h||(l=h,l.$$v=t,l.then(function(a){l.$$v=a})),h=h.$$v);if(!d)return h;if(null==h)return t;(h=h[d])&&h.then&&(wa(f),"$$v"in h||(l=h,l.$$v=t,l.then(function(a){l.$$v=a})),h=h.$$v);if(!e)return h;if(null==h)return t;(h=h[e])&&h.then&&(wa(f),"$$v"in h||(l=h,l.$$v=t,l.then(function(a){l.$$v=a})),h=h.$$v);return h}:function(f,g){var h=g&&g.hasOwnProperty(b)?g:f;if(null==
h)return h;h=h[b];if(!a)return h;if(null==h)return t;h=h[a];if(!c)return h;if(null==h)return t;h=h[c];if(!d)return h;if(null==h)return t;h=h[d];return e?null==h?t:h=h[e]:h}}function Ec(b,a,c){if(Vb.hasOwnProperty(b))return Vb[b];var d=b.split("."),e=d.length,f;if(a.csp)f=6>e?Dc(d[0],d[1],d[2],d[3],d[4],c,a):function(b,f){var g=0,k;do k=Dc(d[g++],d[g++],d[g++],d[g++],d[g++],c,a)(b,f),f=t,b=k;while(g<e);return k};else{var g="var p;\n";r(d,function(b,d){ka(b,c);g+="if(s == null) return undefined;\ns="+
(d?"s":'((k&&k.hasOwnProperty("'+b+'"))?k:s)')+'["'+b+'"];\n'+(a.unwrapPromises?'if (s && s.then) {\n pw("'+c.replace(/(["\r\n])/g,"\\$1")+'");\n if (!("$$v" in s)) {\n p=s;\n p.$$v = undefined;\n p.then(function(v) {p.$$v=v;});\n}\n s=s.$$v\n}\n':"")});var g=g+"return s;",k=new Function("s","k","pw",g);k.toString=ba(g);f=a.unwrapPromises?function(a,b){return k(a,b,wa)}:k}"hasOwnProperty"!==b&&(Vb[b]=f);return f}function Yd(){var b={},a={csp:!1,unwrapPromises:!1,logPromiseWarnings:!0};this.unwrapPromises=
function(b){return y(b)?(a.unwrapPromises=!!b,this):a.unwrapPromises};this.logPromiseWarnings=function(b){return y(b)?(a.logPromiseWarnings=b,this):a.logPromiseWarnings};this.$get=["$filter","$sniffer","$log",function(c,d,e){a.csp=d.csp;wa=function(b){a.logPromiseWarnings&&!Fc.hasOwnProperty(b)&&(Fc[b]=!0,e.warn("[$parse] Promise found in the expression `"+b+"`. Automatic unwrapping of promises in Angular expressions is deprecated."))};return function(d){var e;switch(typeof d){case "string":if(b.hasOwnProperty(d))return b[d];
e=new Wb(a);e=(new fb(e,c,a)).parse(d);"hasOwnProperty"!==d&&(b[d]=e);return e;case "function":return d;default:return E}}}]}function $d(){this.$get=["$rootScope","$exceptionHandler",function(b,a){return Ae(function(a){b.$evalAsync(a)},a)}]}function Ae(b,a){function c(a){return a}function d(a){return g(a)}var e=function(){var g=[],h,l;return l={resolve:function(a){if(g){var c=g;g=t;h=f(a);c.length&&b(function(){for(var a,b=0,d=c.length;b<d;b++)a=c[b],h.then(a[0],a[1],a[2])})}},reject:function(a){l.resolve(k(a))},
notify:function(a){if(g){var c=g;g.length&&b(function(){for(var b,d=0,e=c.length;d<e;d++)b=c[d],b[2](a)})}},promise:{then:function(b,f,k){var l=e(),F=function(d){try{l.resolve((P(b)?b:c)(d))}catch(e){l.reject(e),a(e)}},u=function(b){try{l.resolve((P(f)?f:d)(b))}catch(c){l.reject(c),a(c)}},A=function(b){try{l.notify((P(k)?k:c)(b))}catch(d){a(d)}};g?g.push([F,u,A]):h.then(F,u,A);return l.promise},"catch":function(a){return this.then(null,a)},"finally":function(a){function b(a,c){var d=e();c?d.resolve(a):
d.reject(a);return d.promise}function d(e,f){var g=null;try{g=(a||c)()}catch(k){return b(k,!1)}return g&&P(g.then)?g.then(function(){return b(e,f)},function(a){return b(a,!1)}):b(e,f)}return this.then(function(a){return d(a,!0)},function(a){return d(a,!1)})}}}},f=function(a){return a&&P(a.then)?a:{then:function(c){var d=e();b(function(){d.resolve(c(a))});return d.promise}}},g=function(a){var b=e();b.reject(a);return b.promise},k=function(c){return{then:function(f,g){var k=e();b(function(){try{k.resolve((P(g)?
g:d)(c))}catch(b){k.reject(b),a(b)}});return k.promise}}};return{defer:e,reject:g,when:function(k,h,l,n){var p=e(),q,s=function(b){try{return(P(h)?h:c)(b)}catch(d){return a(d),g(d)}},F=function(b){try{return(P(l)?l:d)(b)}catch(c){return a(c),g(c)}},u=function(b){try{return(P(n)?n:c)(b)}catch(d){a(d)}};b(function(){f(k).then(function(a){q||(q=!0,p.resolve(f(a).then(s,F,u)))},function(a){q||(q=!0,p.resolve(F(a)))},function(a){q||p.notify(u(a))})});return p.promise},all:function(a){var b=e(),c=0,d=J(a)?
[]:{};r(a,function(a,e){c++;f(a).then(function(a){d.hasOwnProperty(e)||(d[e]=a,--c||b.resolve(d))},function(a){d.hasOwnProperty(e)||b.reject(a)})});0===c&&b.resolve(d);return b.promise}}}function ge(){this.$get=["$window","$timeout",function(b,a){var c=b.requestAnimationFrame||b.webkitRequestAnimationFrame||b.mozRequestAnimationFrame,d=b.cancelAnimationFrame||b.webkitCancelAnimationFrame||b.mozCancelAnimationFrame||b.webkitCancelRequestAnimationFrame,e=!!c,f=e?function(a){var b=c(a);return function(){d(b)}}:
function(b){var c=a(b,16.66,!1);return function(){a.cancel(c)}};f.supported=e;return f}]}function Zd(){var b=10,a=C("$rootScope"),c=null;this.digestTtl=function(a){arguments.length&&(b=a);return b};this.$get=["$injector","$exceptionHandler","$parse","$browser",function(d,e,f,g){function k(){this.$id=hb();this.$$phase=this.$parent=this.$$watchers=this.$$nextSibling=this.$$prevSibling=this.$$childHead=this.$$childTail=null;this["this"]=this.$root=this;this.$$destroyed=!1;this.$$asyncQueue=[];this.$$postDigestQueue=
[];this.$$listeners={};this.$$listenerCount={};this.$$isolateBindings={}}function m(b){if(p.$$phase)throw a("inprog",p.$$phase);p.$$phase=b}function h(a,b){var c=f(a);Wa(c,b);return c}function l(a,b,c){do a.$$listenerCount[c]-=b,0===a.$$listenerCount[c]&&delete a.$$listenerCount[c];while(a=a.$parent)}function n(){}k.prototype={constructor:k,$new:function(a){a?(a=new k,a.$root=this.$root,a.$$asyncQueue=this.$$asyncQueue,a.$$postDigestQueue=this.$$postDigestQueue):(this.$$childScopeClass||(this.$$childScopeClass=
function(){this.$$watchers=this.$$nextSibling=this.$$childHead=this.$$childTail=null;this.$$listeners={};this.$$listenerCount={};this.$id=hb();this.$$childScopeClass=null},this.$$childScopeClass.prototype=this),a=new this.$$childScopeClass);a["this"]=a;a.$parent=this;a.$$prevSibling=this.$$childTail;this.$$childHead?this.$$childTail=this.$$childTail.$$nextSibling=a:this.$$childHead=this.$$childTail=a;return a},$watch:function(a,b,d){var e=h(a,"watch"),f=this.$$watchers,g={fn:b,last:n,get:e,exp:a,
eq:!!d};c=null;if(!P(b)){var k=h(b||E,"listener");g.fn=function(a,b,c){k(c)}}if("string"==typeof a&&e.constant){var l=g.fn;g.fn=function(a,b,c){l.call(this,a,b,c);Sa(f,g)}}f||(f=this.$$watchers=[]);f.unshift(g);return function(){Sa(f,g);c=null}},$watchCollection:function(a,b){var c=this,d,e,g,k=1<b.length,h=0,l=f(a),m=[],p={},n=!0,r=0;return this.$watch(function(){d=l(c);var a,b,f;if(T(d))if(Pa(d))for(e!==m&&(e=m,r=e.length=0,h++),a=d.length,r!==a&&(h++,e.length=r=a),b=0;b<a;b++)f=e[b]!==e[b]&&d[b]!==
d[b],f||e[b]===d[b]||(h++,e[b]=d[b]);else{e!==p&&(e=p={},r=0,h++);a=0;for(b in d)d.hasOwnProperty(b)&&(a++,e.hasOwnProperty(b)?(f=e[b]!==e[b]&&d[b]!==d[b],f||e[b]===d[b]||(h++,e[b]=d[b])):(r++,e[b]=d[b],h++));if(r>a)for(b in h++,e)e.hasOwnProperty(b)&&!d.hasOwnProperty(b)&&(r--,delete e[b])}else e!==d&&(e=d,h++);return h},function(){n?(n=!1,b(d,d,c)):b(d,g,c);if(k)if(T(d))if(Pa(d)){g=Array(d.length);for(var a=0;a<d.length;a++)g[a]=d[a]}else for(a in g={},d)kb.call(d,a)&&(g[a]=d[a]);else g=d})},$digest:function(){var d,
f,k,h,l=this.$$asyncQueue,r=this.$$postDigestQueue,R,z,t=b,L,O=[],w,B,I;m("$digest");g.$$checkUrlChange();c=null;do{z=!1;for(L=this;l.length;){try{I=l.shift(),I.scope.$eval(I.expression)}catch(H){p.$$phase=null,e(H)}c=null}a:do{if(h=L.$$watchers)for(R=h.length;R--;)try{if(d=h[R])if((f=d.get(L))!==(k=d.last)&&!(d.eq?Aa(f,k):"number"===typeof f&&"number"===typeof k&&isNaN(f)&&isNaN(k)))z=!0,c=d,d.last=d.eq?Ha(f,null):f,d.fn(f,k===n?f:k,L),5>t&&(w=4-t,O[w]||(O[w]=[]),B=P(d.exp)?"fn: "+(d.exp.name||d.exp.toString()):
d.exp,B+="; newVal: "+na(f)+"; oldVal: "+na(k),O[w].push(B));else if(d===c){z=!1;break a}}catch(y){p.$$phase=null,e(y)}if(!(h=L.$$childHead||L!==this&&L.$$nextSibling))for(;L!==this&&!(h=L.$$nextSibling);)L=L.$parent}while(L=h);if((z||l.length)&&!t--)throw p.$$phase=null,a("infdig",b,na(O));}while(z||l.length);for(p.$$phase=null;r.length;)try{r.shift()()}catch(v){e(v)}},$destroy:function(){if(!this.$$destroyed){var a=this.$parent;this.$broadcast("$destroy");this.$$destroyed=!0;this!==p&&(r(this.$$listenerCount,
Bb(null,l,this)),a.$$childHead==this&&(a.$$childHead=this.$$nextSibling),a.$$childTail==this&&(a.$$childTail=this.$$prevSibling),this.$$prevSibling&&(this.$$prevSibling.$$nextSibling=this.$$nextSibling),this.$$nextSibling&&(this.$$nextSibling.$$prevSibling=this.$$prevSibling),this.$parent=this.$$nextSibling=this.$$prevSibling=this.$$childHead=this.$$childTail=this.$root=null,this.$$listeners={},this.$$watchers=this.$$asyncQueue=this.$$postDigestQueue=[],this.$destroy=this.$digest=this.$apply=E,this.$on=
this.$watch=function(){return E})}},$eval:function(a,b){return f(a)(this,b)},$evalAsync:function(a){p.$$phase||p.$$asyncQueue.length||g.defer(function(){p.$$asyncQueue.length&&p.$digest()});this.$$asyncQueue.push({scope:this,expression:a})},$$postDigest:function(a){this.$$postDigestQueue.push(a)},$apply:function(a){try{return m("$apply"),this.$eval(a)}catch(b){e(b)}finally{p.$$phase=null;try{p.$digest()}catch(c){throw e(c),c;}}},$on:function(a,b){var c=this.$$listeners[a];c||(this.$$listeners[a]=
c=[]);c.push(b);var d=this;do d.$$listenerCount[a]||(d.$$listenerCount[a]=0),d.$$listenerCount[a]++;while(d=d.$parent);var e=this;return function(){c[Ra(c,b)]=null;l(e,1,a)}},$emit:function(a,b){var c=[],d,f=this,g=!1,k={name:a,targetScope:f,stopPropagation:function(){g=!0},preventDefault:function(){k.defaultPrevented=!0},defaultPrevented:!1},h=[k].concat(Ba.call(arguments,1)),l,m;do{d=f.$$listeners[a]||c;k.currentScope=f;l=0;for(m=d.length;l<m;l++)if(d[l])try{d[l].apply(null,h)}catch(p){e(p)}else d.splice(l,
1),l--,m--;if(g)break;f=f.$parent}while(f);return k},$broadcast:function(a,b){for(var c=this,d=this,f={name:a,targetScope:this,preventDefault:function(){f.defaultPrevented=!0},defaultPrevented:!1},g=[f].concat(Ba.call(arguments,1)),k,h;c=d;){f.currentScope=c;d=c.$$listeners[a]||[];k=0;for(h=d.length;k<h;k++)if(d[k])try{d[k].apply(null,g)}catch(l){e(l)}else d.splice(k,1),k--,h--;if(!(d=c.$$listenerCount[a]&&c.$$childHead||c!==this&&c.$$nextSibling))for(;c!==this&&!(d=c.$$nextSibling);)c=c.$parent}return f}};
var p=new k;return p}]}function cd(){var b=/^\s*(https?|ftp|mailto|tel|file):/,a=/^\s*((https?|ftp|file):|data:image\/)/;this.aHrefSanitizationWhitelist=function(a){return y(a)?(b=a,this):b};this.imgSrcSanitizationWhitelist=function(b){return y(b)?(a=b,this):a};this.$get=function(){return function(c,d){var e=d?a:b,f;if(!Q||8<=Q)if(f=ua(c).href,""!==f&&!f.match(e))return"unsafe:"+f;return c}}}function Be(b){if("self"===b)return b;if(v(b)){if(-1<b.indexOf("***"))throw xa("iwcard",b);b=b.replace(/([-()\[\]{}+?*.$\^|,:#<!\\])/g,
"\\$1").replace(/\x08/g,"\\x08").replace("\\*\\*",".*").replace("\\*","[^:/.?&;]*");return RegExp("^"+b+"$")}if(jb(b))return RegExp("^"+b.source+"$");throw xa("imatcher");}function Gc(b){var a=[];y(b)&&r(b,function(b){a.push(Be(b))});return a}function be(){this.SCE_CONTEXTS=ga;var b=["self"],a=[];this.resourceUrlWhitelist=function(a){arguments.length&&(b=Gc(a));return b};this.resourceUrlBlacklist=function(b){arguments.length&&(a=Gc(b));return a};this.$get=["$injector",function(c){function d(a){var b=
function(a){this.$$unwrapTrustedValue=function(){return a}};a&&(b.prototype=new a);b.prototype.valueOf=function(){return this.$$unwrapTrustedValue()};b.prototype.toString=function(){return this.$$unwrapTrustedValue().toString()};return b}var e=function(a){throw xa("unsafe");};c.has("$sanitize")&&(e=c.get("$sanitize"));var f=d(),g={};g[ga.HTML]=d(f);g[ga.CSS]=d(f);g[ga.URL]=d(f);g[ga.JS]=d(f);g[ga.RESOURCE_URL]=d(g[ga.URL]);return{trustAs:function(a,b){var c=g.hasOwnProperty(a)?g[a]:null;if(!c)throw xa("icontext",
a,b);if(null===b||b===t||""===b)return b;if("string"!==typeof b)throw xa("itype",a);return new c(b)},getTrusted:function(c,d){if(null===d||d===t||""===d)return d;var f=g.hasOwnProperty(c)?g[c]:null;if(f&&d instanceof f)return d.$$unwrapTrustedValue();if(c===ga.RESOURCE_URL){var f=ua(d.toString()),l,n,p=!1;l=0;for(n=b.length;l<n;l++)if("self"===b[l]?Pb(f):b[l].exec(f.href)){p=!0;break}if(p)for(l=0,n=a.length;l<n;l++)if("self"===a[l]?Pb(f):a[l].exec(f.href)){p=!1;break}if(p)return d;throw xa("insecurl",
d.toString());}if(c===ga.HTML)return e(d);throw xa("unsafe");},valueOf:function(a){return a instanceof f?a.$$unwrapTrustedValue():a}}}]}function ae(){var b=!0;this.enabled=function(a){arguments.length&&(b=!!a);return b};this.$get=["$parse","$sniffer","$sceDelegate",function(a,c,d){if(b&&c.msie&&8>c.msieDocumentMode)throw xa("iequirks");var e=ha(ga);e.isEnabled=function(){return b};e.trustAs=d.trustAs;e.getTrusted=d.getTrusted;e.valueOf=d.valueOf;b||(e.trustAs=e.getTrusted=function(a,b){return b},
e.valueOf=Qa);e.parseAs=function(b,c){var d=a(c);return d.literal&&d.constant?d:function(a,c){return e.getTrusted(b,d(a,c))}};var f=e.parseAs,g=e.getTrusted,k=e.trustAs;r(ga,function(a,b){var c=K(b);e[Za("parse_as_"+c)]=function(b){return f(a,b)};e[Za("get_trusted_"+c)]=function(b){return g(a,b)};e[Za("trust_as_"+c)]=function(b){return k(a,b)}});return e}]}function ce(){this.$get=["$window","$document",function(b,a){var c={},d=U((/android (\d+)/.exec(K((b.navigator||{}).userAgent))||[])[1]),e=/Boxee/i.test((b.navigator||
{}).userAgent),f=a[0]||{},g=f.documentMode,k,m=/^(Moz|webkit|O|ms)(?=[A-Z])/,h=f.body&&f.body.style,l=!1,n=!1;if(h){for(var p in h)if(l=m.exec(p)){k=l[0];k=k.substr(0,1).toUpperCase()+k.substr(1);break}k||(k="WebkitOpacity"in h&&"webkit");l=!!("transition"in h||k+"Transition"in h);n=!!("animation"in h||k+"Animation"in h);!d||l&&n||(l=v(f.body.style.webkitTransition),n=v(f.body.style.webkitAnimation))}return{history:!(!b.history||!b.history.pushState||4>d||e),hashchange:"onhashchange"in b&&(!g||7<
g),hasEvent:function(a){if("input"==a&&9==Q)return!1;if(x(c[a])){var b=f.createElement("div");c[a]="on"+a in b}return c[a]},csp:Xa(),vendorPrefix:k,transitions:l,animations:n,android:d,msie:Q,msieDocumentMode:g}}]}function ee(){this.$get=["$rootScope","$browser","$q","$exceptionHandler",function(b,a,c,d){function e(e,k,m){var h=c.defer(),l=h.promise,n=y(m)&&!m;k=a.defer(function(){try{h.resolve(e())}catch(a){h.reject(a),d(a)}finally{delete f[l.$$timeoutId]}n||b.$apply()},k);l.$$timeoutId=k;f[k]=h;
return l}var f={};e.cancel=function(b){return b&&b.$$timeoutId in f?(f[b.$$timeoutId].reject("canceled"),delete f[b.$$timeoutId],a.defer.cancel(b.$$timeoutId)):!1};return e}]}function ua(b,a){var c=b;Q&&(Y.setAttribute("href",c),c=Y.href);Y.setAttribute("href",c);return{href:Y.href,protocol:Y.protocol?Y.protocol.replace(/:$/,""):"",host:Y.host,search:Y.search?Y.search.replace(/^\?/,""):"",hash:Y.hash?Y.hash.replace(/^#/,""):"",hostname:Y.hostname,port:Y.port,pathname:"/"===Y.pathname.charAt(0)?Y.pathname:
"/"+Y.pathname}}function Pb(b){b=v(b)?ua(b):b;return b.protocol===Hc.protocol&&b.host===Hc.host}function fe(){this.$get=ba(W)}function mc(b){function a(d,e){if(T(d)){var f={};r(d,function(b,c){f[c]=a(c,b)});return f}return b.factory(d+c,e)}var c="Filter";this.register=a;this.$get=["$injector",function(a){return function(b){return a.get(b+c)}}];a("currency",Ic);a("date",Jc);a("filter",Ce);a("json",De);a("limitTo",Ee);a("lowercase",Fe);a("number",Kc);a("orderBy",Lc);a("uppercase",Ge)}function Ce(){return function(b,
a,c){if(!J(b))return b;var d=typeof c,e=[];e.check=function(a){for(var b=0;b<e.length;b++)if(!e[b](a))return!1;return!0};"function"!==d&&(c="boolean"===d&&c?function(a,b){return Va.equals(a,b)}:function(a,b){if(a&&b&&"object"===typeof a&&"object"===typeof b){for(var d in a)if("$"!==d.charAt(0)&&kb.call(a,d)&&c(a[d],b[d]))return!0;return!1}b=(""+b).toLowerCase();return-1<(""+a).toLowerCase().indexOf(b)});var f=function(a,b){if("string"==typeof b&&"!"===b.charAt(0))return!f(a,b.substr(1));switch(typeof a){case "boolean":case "number":case "string":return c(a,
b);case "object":switch(typeof b){case "object":return c(a,b);default:for(var d in a)if("$"!==d.charAt(0)&&f(a[d],b))return!0}return!1;case "array":for(d=0;d<a.length;d++)if(f(a[d],b))return!0;return!1;default:return!1}};switch(typeof a){case "boolean":case "number":case "string":a={$:a};case "object":for(var g in a)(function(b){"undefined"!==typeof a[b]&&e.push(function(c){return f("$"==b?c:c&&c[b],a[b])})})(g);break;case "function":e.push(a);break;default:return b}d=[];for(g=0;g<b.length;g++){var k=
b[g];e.check(k)&&d.push(k)}return d}}function Ic(b){var a=b.NUMBER_FORMATS;return function(b,d){x(d)&&(d=a.CURRENCY_SYM);return Mc(b,a.PATTERNS[1],a.GROUP_SEP,a.DECIMAL_SEP,2).replace(/\u00A4/g,d)}}function Kc(b){var a=b.NUMBER_FORMATS;return function(b,d){return Mc(b,a.PATTERNS[0],a.GROUP_SEP,a.DECIMAL_SEP,d)}}function Mc(b,a,c,d,e){if(null==b||!isFinite(b)||T(b))return"";var f=0>b;b=Math.abs(b);var g=b+"",k="",m=[],h=!1;if(-1!==g.indexOf("e")){var l=g.match(/([\d\.]+)e(-?)(\d+)/);l&&"-"==l[2]&&
l[3]>e+1?(g="0",b=0):(k=g,h=!0)}if(h)0<e&&(-1<b&&1>b)&&(k=b.toFixed(e));else{g=(g.split(Nc)[1]||"").length;x(e)&&(e=Math.min(Math.max(a.minFrac,g),a.maxFrac));b=+(Math.round(+(b.toString()+"e"+e)).toString()+"e"+-e);0===b&&(f=!1);b=(""+b).split(Nc);g=b[0];b=b[1]||"";var l=0,n=a.lgSize,p=a.gSize;if(g.length>=n+p)for(l=g.length-n,h=0;h<l;h++)0===(l-h)%p&&0!==h&&(k+=c),k+=g.charAt(h);for(h=l;h<g.length;h++)0===(g.length-h)%n&&0!==h&&(k+=c),k+=g.charAt(h);for(;b.length<e;)b+="0";e&&"0"!==e&&(k+=d+b.substr(0,
e))}m.push(f?a.negPre:a.posPre);m.push(k);m.push(f?a.negSuf:a.posSuf);return m.join("")}function Xb(b,a,c){var d="";0>b&&(d="-",b=-b);for(b=""+b;b.length<a;)b="0"+b;c&&(b=b.substr(b.length-a));return d+b}function $(b,a,c,d){c=c||0;return function(e){e=e["get"+b]();if(0<c||e>-c)e+=c;0===e&&-12==c&&(e=12);return Xb(e,a,d)}}function vb(b,a){return function(c,d){var e=c["get"+b](),f=Ia(a?"SHORT"+b:b);return d[f][e]}}function Jc(b){function a(a){var b;if(b=a.match(c)){a=new Date(0);var f=0,g=0,k=b[8]?
a.setUTCFullYear:a.setFullYear,m=b[8]?a.setUTCHours:a.setHours;b[9]&&(f=U(b[9]+b[10]),g=U(b[9]+b[11]));k.call(a,U(b[1]),U(b[2])-1,U(b[3]));f=U(b[4]||0)-f;g=U(b[5]||0)-g;k=U(b[6]||0);b=Math.round(1E3*parseFloat("0."+(b[7]||0)));m.call(a,f,g,k,b)}return a}var c=/^(\d{4})-?(\d\d)-?(\d\d)(?:T(\d\d)(?::?(\d\d)(?::?(\d\d)(?:\.(\d+))?)?)?(Z|([+-])(\d\d):?(\d\d))?)?$/;return function(c,e){var f="",g=[],k,m;e=e||"mediumDate";e=b.DATETIME_FORMATS[e]||e;v(c)&&(c=He.test(c)?U(c):a(c));ib(c)&&(c=new Date(c));
if(!ta(c))return c;for(;e;)(m=Ie.exec(e))?(g=g.concat(Ba.call(m,1)),e=g.pop()):(g.push(e),e=null);r(g,function(a){k=Je[a];f+=k?k(c,b.DATETIME_FORMATS):a.replace(/(^'|'$)/g,"").replace(/''/g,"'")});return f}}function De(){return function(b){return na(b,!0)}}function Ee(){return function(b,a){if(!J(b)&&!v(b))return b;a=Infinity===Math.abs(Number(a))?Number(a):U(a);if(v(b))return a?0<=a?b.slice(0,a):b.slice(a,b.length):"";var c=[],d,e;a>b.length?a=b.length:a<-b.length&&(a=-b.length);0<a?(d=0,e=a):(d=
b.length+a,e=b.length);for(;d<e;d++)c.push(b[d]);return c}}function Lc(b){return function(a,c,d){function e(a,b){return Ua(b)?function(b,c){return a(c,b)}:a}function f(a,b){var c=typeof a,d=typeof b;return c==d?(ta(a)&&ta(b)&&(a=a.valueOf(),b=b.valueOf()),"string"==c&&(a=a.toLowerCase(),b=b.toLowerCase()),a===b?0:a<b?-1:1):c<d?-1:1}if(!Pa(a)||!c)return a;c=J(c)?c:[c];c=Vc(c,function(a){var c=!1,d=a||Qa;if(v(a)){if("+"==a.charAt(0)||"-"==a.charAt(0))c="-"==a.charAt(0),a=a.substring(1);d=b(a);if(d.constant){var g=
d();return e(function(a,b){return f(a[g],b[g])},c)}}return e(function(a,b){return f(d(a),d(b))},c)});for(var g=[],k=0;k<a.length;k++)g.push(a[k]);return g.sort(e(function(a,b){for(var d=0;d<c.length;d++){var e=c[d](a,b);if(0!==e)return e}return 0},d))}}function ya(b){P(b)&&(b={link:b});b.restrict=b.restrict||"AC";return ba(b)}function Oc(b,a,c,d){function e(a,c){c=c?"-"+mb(c,"-"):"";d.setClass(b,(a?wb:xb)+c,(a?xb:wb)+c)}var f=this,g=b.parent().controller("form")||yb,k=0,m=f.$error={},h=[];f.$name=
a.name||a.ngForm;f.$dirty=!1;f.$pristine=!0;f.$valid=!0;f.$invalid=!1;g.$addControl(f);b.addClass(Oa);e(!0);f.$addControl=function(a){Da(a.$name,"input");h.push(a);a.$name&&(f[a.$name]=a)};f.$removeControl=function(a){a.$name&&f[a.$name]===a&&delete f[a.$name];r(m,function(b,c){f.$setValidity(c,!0,a)});Sa(h,a)};f.$setValidity=function(a,b,c){var d=m[a];if(b)d&&(Sa(d,c),d.length||(k--,k||(e(b),f.$valid=!0,f.$invalid=!1),m[a]=!1,e(!0,a),g.$setValidity(a,!0,f)));else{k||e(b);if(d){if(-1!=Ra(d,c))return}else m[a]=
d=[],k++,e(!1,a),g.$setValidity(a,!1,f);d.push(c);f.$valid=!1;f.$invalid=!0}};f.$setDirty=function(){d.removeClass(b,Oa);d.addClass(b,zb);f.$dirty=!0;f.$pristine=!1;g.$setDirty()};f.$setPristine=function(){d.removeClass(b,zb);d.addClass(b,Oa);f.$dirty=!1;f.$pristine=!0;r(h,function(a){a.$setPristine()})}}function sa(b,a,c,d){b.$setValidity(a,c);return c?d:t}function Pc(b,a){var c,d;if(a)for(c=0;c<a.length;++c)if(d=a[c],b[d])return!0;return!1}function Ke(b,a,c,d,e){T(e)&&(b.$$hasNativeValidators=!0,
b.$parsers.push(function(f){if(b.$error[a]||Pc(e,d)||!Pc(e,c))return f;b.$setValidity(a,!1)}))}function Ab(b,a,c,d,e,f){var g=a.prop(Le),k=a[0].placeholder,m={},h=K(a[0].type);d.$$validityState=g;if(!e.android){var l=!1;a.on("compositionstart",function(a){l=!0});a.on("compositionend",function(){l=!1;n()})}var n=function(e){if(!l){var f=a.val();if(Q&&"input"===(e||m).type&&a[0].placeholder!==k)k=a[0].placeholder;else if("password"!==h&&Ua(c.ngTrim||"T")&&(f=aa(f)),e=g&&d.$$hasNativeValidators,d.$viewValue!==
f||""===f&&e)b.$root.$$phase?d.$setViewValue(f):b.$apply(function(){d.$setViewValue(f)})}};if(e.hasEvent("input"))a.on("input",n);else{var p,q=function(){p||(p=f.defer(function(){n();p=null}))};a.on("keydown",function(a){a=a.keyCode;91===a||(15<a&&19>a||37<=a&&40>=a)||q()});if(e.hasEvent("paste"))a.on("paste cut",q)}a.on("change",n);d.$render=function(){a.val(d.$isEmpty(d.$viewValue)?"":d.$viewValue)};var s=c.ngPattern;s&&((e=s.match(/^\/(.*)\/([gim]*)$/))?(s=RegExp(e[1],e[2]),e=function(a){return sa(d,
"pattern",d.$isEmpty(a)||s.test(a),a)}):e=function(c){var e=b.$eval(s);if(!e||!e.test)throw C("ngPattern")("noregexp",s,e,ia(a));return sa(d,"pattern",d.$isEmpty(c)||e.test(c),c)},d.$formatters.push(e),d.$parsers.push(e));if(c.ngMinlength){var r=U(c.ngMinlength);e=function(a){return sa(d,"minlength",d.$isEmpty(a)||a.length>=r,a)};d.$parsers.push(e);d.$formatters.push(e)}if(c.ngMaxlength){var u=U(c.ngMaxlength);e=function(a){return sa(d,"maxlength",d.$isEmpty(a)||a.length<=u,a)};d.$parsers.push(e);
d.$formatters.push(e)}}function Yb(b,a){b="ngClass"+b;return["$animate",function(c){function d(a,b){var c=[],d=0;a:for(;d<a.length;d++){for(var e=a[d],l=0;l<b.length;l++)if(e==b[l])continue a;c.push(e)}return c}function e(a){if(!J(a)){if(v(a))return a.split(" ");if(T(a)){var b=[];r(a,function(a,c){a&&(b=b.concat(c.split(" ")))});return b}}return a}return{restrict:"AC",link:function(f,g,k){function m(a,b){var c=g.data("$classCounts")||{},d=[];r(a,function(a){if(0<b||c[a])c[a]=(c[a]||0)+b,c[a]===+(0<
b)&&d.push(a)});g.data("$classCounts",c);return d.join(" ")}function h(b){if(!0===a||f.$index%2===a){var h=e(b||[]);if(!l){var q=m(h,1);k.$addClass(q)}else if(!Aa(b,l)){var s=e(l),q=d(h,s),h=d(s,h),h=m(h,-1),q=m(q,1);0===q.length?c.removeClass(g,h):0===h.length?c.addClass(g,q):c.setClass(g,q,h)}}l=ha(b)}var l;f.$watch(k[b],h,!0);k.$observe("class",function(a){h(f.$eval(k[b]))});"ngClass"!==b&&f.$watch("$index",function(c,d){var g=c&1;if(g!==(d&1)){var h=e(f.$eval(k[b]));g===a?(g=m(h,1),k.$addClass(g)):
(g=m(h,-1),k.$removeClass(g))}})}}}]}var Le="validity",K=function(b){return v(b)?b.toLowerCase():b},kb=Object.prototype.hasOwnProperty,Ia=function(b){return v(b)?b.toUpperCase():b},Q,w,Ea,Ba=[].slice,Me=[].push,za=Object.prototype.toString,Ta=C("ng"),Va=W.angular||(W.angular={}),Ya,Ma,ma=["0","0","0"];Q=U((/msie (\d+)/.exec(K(navigator.userAgent))||[])[1]);isNaN(Q)&&(Q=U((/trident\/.*; rv:(\d+)/.exec(K(navigator.userAgent))||[])[1]));E.$inject=[];Qa.$inject=[];var J=function(){return P(Array.isArray)?
Array.isArray:function(b){return"[object Array]"===za.call(b)}}(),aa=function(){return String.prototype.trim?function(b){return v(b)?b.trim():b}:function(b){return v(b)?b.replace(/^\s\s*/,"").replace(/\s\s*$/,""):b}}();Ma=9>Q?function(b){b=b.nodeName?b:b[0];return b.scopeName&&"HTML"!=b.scopeName?Ia(b.scopeName+":"+b.nodeName):b.nodeName}:function(b){return b.nodeName?b.nodeName:b[0].nodeName};var Xa=function(){if(y(Xa.isActive_))return Xa.isActive_;var b=!(!X.querySelector("[ng-csp]")&&!X.querySelector("[data-ng-csp]"));
if(!b)try{new Function("")}catch(a){b=!0}return Xa.isActive_=b},Yc=/[A-Z]/g,ad={full:"1.2.26",major:1,minor:2,dot:26,codeName:"captivating-disinterest"};S.expando="ng339";var ab=S.cache={},ne=1,sb=W.document.addEventListener?function(b,a,c){b.addEventListener(a,c,!1)}:function(b,a,c){b.attachEvent("on"+a,c)},$a=W.document.removeEventListener?function(b,a,c){b.removeEventListener(a,c,!1)}:function(b,a,c){b.detachEvent("on"+a,c)};S._data=function(b){return this.cache[b[this.expando]]||{}};var ie=/([\:\-\_]+(.))/g,
je=/^moz([A-Z])/,Hb=C("jqLite"),ke=/^<(\w+)\s*\/?>(?:<\/\1>|)$/,Ib=/<|&#?\w+;/,le=/<([\w:]+)/,me=/<(?!area|br|col|embed|hr|img|input|link|meta|param)(([\w:]+)[^>]*)\/>/gi,ea={option:[1,'<select multiple="multiple">',"</select>"],thead:[1,"<table>","</table>"],col:[2,"<table><colgroup>","</colgroup></table>"],tr:[2,"<table><tbody>","</tbody></table>"],td:[3,"<table><tbody><tr>","</tr></tbody></table>"],_default:[0,"",""]};ea.optgroup=ea.option;ea.tbody=ea.tfoot=ea.colgroup=ea.caption=ea.thead;ea.th=
ea.td;var La=S.prototype={ready:function(b){function a(){c||(c=!0,b())}var c=!1;"complete"===X.readyState?setTimeout(a):(this.on("DOMContentLoaded",a),S(W).on("load",a))},toString:function(){var b=[];r(this,function(a){b.push(""+a)});return"["+b.join(", ")+"]"},eq:function(b){return 0<=b?w(this[b]):w(this[this.length+b])},length:0,push:Me,sort:[].sort,splice:[].splice},qb={};r("multiple selected checked disabled readOnly required open".split(" "),function(b){qb[K(b)]=b});var rc={};r("input select option textarea button form details".split(" "),
function(b){rc[Ia(b)]=!0});r({data:Mb,removeData:Lb},function(b,a){S[a]=b});r({data:Mb,inheritedData:pb,scope:function(b){return w.data(b,"$scope")||pb(b.parentNode||b,["$isolateScope","$scope"])},isolateScope:function(b){return w.data(b,"$isolateScope")||w.data(b,"$isolateScopeNoTemplate")},controller:oc,injector:function(b){return pb(b,"$injector")},removeAttr:function(b,a){b.removeAttribute(a)},hasClass:Nb,css:function(b,a,c){a=Za(a);if(y(c))b.style[a]=c;else{var d;8>=Q&&(d=b.currentStyle&&b.currentStyle[a],
""===d&&(d="auto"));d=d||b.style[a];8>=Q&&(d=""===d?t:d);return d}},attr:function(b,a,c){var d=K(a);if(qb[d])if(y(c))c?(b[a]=!0,b.setAttribute(a,d)):(b[a]=!1,b.removeAttribute(d));else return b[a]||(b.attributes.getNamedItem(a)||E).specified?d:t;else if(y(c))b.setAttribute(a,c);else if(b.getAttribute)return b=b.getAttribute(a,2),null===b?t:b},prop:function(b,a,c){if(y(c))b[a]=c;else return b[a]},text:function(){function b(b,d){var e=a[b.nodeType];if(x(d))return e?b[e]:"";b[e]=d}var a=[];9>Q?(a[1]=
"innerText",a[3]="nodeValue"):a[1]=a[3]="textContent";b.$dv="";return b}(),val:function(b,a){if(x(a)){if("SELECT"===Ma(b)&&b.multiple){var c=[];r(b.options,function(a){a.selected&&c.push(a.value||a.text)});return 0===c.length?null:c}return b.value}b.value=a},html:function(b,a){if(x(a))return b.innerHTML;for(var c=0,d=b.childNodes;c<d.length;c++)Ja(d[c]);b.innerHTML=a},empty:pc},function(b,a){S.prototype[a]=function(a,d){var e,f,g=this.length;if(b!==pc&&(2==b.length&&b!==Nb&&b!==oc?a:d)===t){if(T(a)){for(e=
0;e<g;e++)if(b===Mb)b(this[e],a);else for(f in a)b(this[e],f,a[f]);return this}e=b.$dv;g=e===t?Math.min(g,1):g;for(f=0;f<g;f++){var k=b(this[f],a,d);e=e?e+k:k}return e}for(e=0;e<g;e++)b(this[e],a,d);return this}});r({removeData:Lb,dealoc:Ja,on:function a(c,d,e,f){if(y(f))throw Hb("onargs");var g=oa(c,"events"),k=oa(c,"handle");g||oa(c,"events",g={});k||oa(c,"handle",k=oe(c,g));r(d.split(" "),function(d){var f=g[d];if(!f){if("mouseenter"==d||"mouseleave"==d){var l=X.body.contains||X.body.compareDocumentPosition?
function(a,c){var d=9===a.nodeType?a.documentElement:a,e=c&&c.parentNode;return a===e||!!(e&&1===e.nodeType&&(d.contains?d.contains(e):a.compareDocumentPosition&&a.compareDocumentPosition(e)&16))}:function(a,c){if(c)for(;c=c.parentNode;)if(c===a)return!0;return!1};g[d]=[];a(c,{mouseleave:"mouseout",mouseenter:"mouseover"}[d],function(a){var c=a.relatedTarget;c&&(c===this||l(this,c))||k(a,d)})}else sb(c,d,k),g[d]=[];f=g[d]}f.push(e)})},off:nc,one:function(a,c,d){a=w(a);a.on(c,function f(){a.off(c,
d);a.off(c,f)});a.on(c,d)},replaceWith:function(a,c){var d,e=a.parentNode;Ja(a);r(new S(c),function(c){d?e.insertBefore(c,d.nextSibling):e.replaceChild(c,a);d=c})},children:function(a){var c=[];r(a.childNodes,function(a){1===a.nodeType&&c.push(a)});return c},contents:function(a){return a.contentDocument||a.childNodes||[]},append:function(a,c){r(new S(c),function(c){1!==a.nodeType&&11!==a.nodeType||a.appendChild(c)})},prepend:function(a,c){if(1===a.nodeType){var d=a.firstChild;r(new S(c),function(c){a.insertBefore(c,
d)})}},wrap:function(a,c){c=w(c)[0];var d=a.parentNode;d&&d.replaceChild(c,a);c.appendChild(a)},remove:function(a){Ja(a);var c=a.parentNode;c&&c.removeChild(a)},after:function(a,c){var d=a,e=a.parentNode;r(new S(c),function(a){e.insertBefore(a,d.nextSibling);d=a})},addClass:ob,removeClass:nb,toggleClass:function(a,c,d){c&&r(c.split(" "),function(c){var f=d;x(f)&&(f=!Nb(a,c));(f?ob:nb)(a,c)})},parent:function(a){return(a=a.parentNode)&&11!==a.nodeType?a:null},next:function(a){if(a.nextElementSibling)return a.nextElementSibling;
for(a=a.nextSibling;null!=a&&1!==a.nodeType;)a=a.nextSibling;return a},find:function(a,c){return a.getElementsByTagName?a.getElementsByTagName(c):[]},clone:Kb,triggerHandler:function(a,c,d){var e,f;e=c.type||c;var g=(oa(a,"events")||{})[e];g&&(e={preventDefault:function(){this.defaultPrevented=!0},isDefaultPrevented:function(){return!0===this.defaultPrevented},stopPropagation:E,type:e,target:a},c.type&&(e=D(e,c)),c=ha(g),f=d?[e].concat(d):[e],r(c,function(c){c.apply(a,f)}))}},function(a,c){S.prototype[c]=
function(c,e,f){for(var g,k=0;k<this.length;k++)x(g)?(g=a(this[k],c,e,f),y(g)&&(g=w(g))):Jb(g,a(this[k],c,e,f));return y(g)?g:this};S.prototype.bind=S.prototype.on;S.prototype.unbind=S.prototype.off});bb.prototype={put:function(a,c){this[Ka(a,this.nextUid)]=c},get:function(a){return this[Ka(a,this.nextUid)]},remove:function(a){var c=this[a=Ka(a,this.nextUid)];delete this[a];return c}};var qe=/^function\s*[^\(]*\(\s*([^\)]*)\)/m,re=/,/,se=/^\s*(_?)(\S+?)\1\s*$/,pe=/((\/\/.*$)|(\/\*[\s\S]*?\*\/))/mg,
cb=C("$injector"),Ne=C("$animate"),Md=["$provide",function(a){this.$$selectors={};this.register=function(c,d){var e=c+"-animation";if(c&&"."!=c.charAt(0))throw Ne("notcsel",c);this.$$selectors[c.substr(1)]=e;a.factory(e,d)};this.classNameFilter=function(a){1===arguments.length&&(this.$$classNameFilter=a instanceof RegExp?a:null);return this.$$classNameFilter};this.$get=["$timeout","$$asyncCallback",function(a,d){return{enter:function(a,c,g,k){g?g.after(a):(c&&c[0]||(c=g.parent()),c.append(a));k&&
d(k)},leave:function(a,c){a.remove();c&&d(c)},move:function(a,c,d,k){this.enter(a,c,d,k)},addClass:function(a,c,g){c=v(c)?c:J(c)?c.join(" "):"";r(a,function(a){ob(a,c)});g&&d(g)},removeClass:function(a,c,g){c=v(c)?c:J(c)?c.join(" "):"";r(a,function(a){nb(a,c)});g&&d(g)},setClass:function(a,c,g,k){r(a,function(a){ob(a,c);nb(a,g)});k&&d(k)},enabled:E}}]}],ja=C("$compile");ic.$inject=["$provide","$$sanitizeUriProvider"];var we=/^(x[\:\-_]|data[\:\-_])/i,yc=C("$interpolate"),Oe=/^([^\?#]*)(\?([^#]*))?(#(.*))?$/,
ze={http:80,https:443,ftp:21},Sb=C("$location");Ub.prototype=Tb.prototype=Bc.prototype={$$html5:!1,$$replace:!1,absUrl:tb("$$absUrl"),url:function(a){if(x(a))return this.$$url;a=Oe.exec(a);a[1]&&this.path(decodeURIComponent(a[1]));(a[2]||a[1])&&this.search(a[3]||"");this.hash(a[5]||"");return this},protocol:tb("$$protocol"),host:tb("$$host"),port:tb("$$port"),path:Cc("$$path",function(a){a=a?a.toString():"";return"/"==a.charAt(0)?a:"/"+a}),search:function(a,c){switch(arguments.length){case 0:return this.$$search;
case 1:if(v(a)||ib(a))a=a.toString(),this.$$search=ec(a);else if(T(a))r(a,function(c,e){null==c&&delete a[e]}),this.$$search=a;else throw Sb("isrcharg");break;default:x(c)||null===c?delete this.$$search[a]:this.$$search[a]=c}this.$$compose();return this},hash:Cc("$$hash",function(a){return a?a.toString():""}),replace:function(){this.$$replace=!0;return this}};var la=C("$parse"),Fc={},wa,Pe=Function.prototype.call,Qe=Function.prototype.apply,Qc=Function.prototype.bind,gb={"null":function(){return null},
"true":function(){return!0},"false":function(){return!1},undefined:E,"+":function(a,c,d,e){d=d(a,c);e=e(a,c);return y(d)?y(e)?d+e:d:y(e)?e:t},"-":function(a,c,d,e){d=d(a,c);e=e(a,c);return(y(d)?d:0)-(y(e)?e:0)},"*":function(a,c,d,e){return d(a,c)*e(a,c)},"/":function(a,c,d,e){return d(a,c)/e(a,c)},"%":function(a,c,d,e){return d(a,c)%e(a,c)},"^":function(a,c,d,e){return d(a,c)^e(a,c)},"=":E,"===":function(a,c,d,e){return d(a,c)===e(a,c)},"!==":function(a,c,d,e){return d(a,c)!==e(a,c)},"==":function(a,
c,d,e){return d(a,c)==e(a,c)},"!=":function(a,c,d,e){return d(a,c)!=e(a,c)},"<":function(a,c,d,e){return d(a,c)<e(a,c)},">":function(a,c,d,e){return d(a,c)>e(a,c)},"<=":function(a,c,d,e){return d(a,c)<=e(a,c)},">=":function(a,c,d,e){return d(a,c)>=e(a,c)},"&&":function(a,c,d,e){return d(a,c)&&e(a,c)},"||":function(a,c,d,e){return d(a,c)||e(a,c)},"&":function(a,c,d,e){return d(a,c)&e(a,c)},"|":function(a,c,d,e){return e(a,c)(a,c,d(a,c))},"!":function(a,c,d){return!d(a,c)}},Re={n:"\n",f:"\f",r:"\r",
t:"\t",v:"\v","'":"'",'"':'"'},Wb=function(a){this.options=a};Wb.prototype={constructor:Wb,lex:function(a){this.text=a;this.index=0;this.ch=t;this.lastCh=":";for(this.tokens=[];this.index<this.text.length;){this.ch=this.text.charAt(this.index);if(this.is("\"'"))this.readString(this.ch);else if(this.isNumber(this.ch)||this.is(".")&&this.isNumber(this.peek()))this.readNumber();else if(this.isIdent(this.ch))this.readIdent();else if(this.is("(){}[].,;:?"))this.tokens.push({index:this.index,text:this.ch}),
this.index++;else if(this.isWhitespace(this.ch)){this.index++;continue}else{a=this.ch+this.peek();var c=a+this.peek(2),d=gb[this.ch],e=gb[a],f=gb[c];f?(this.tokens.push({index:this.index,text:c,fn:f}),this.index+=3):e?(this.tokens.push({index:this.index,text:a,fn:e}),this.index+=2):d?(this.tokens.push({index:this.index,text:this.ch,fn:d}),this.index+=1):this.throwError("Unexpected next character ",this.index,this.index+1)}this.lastCh=this.ch}return this.tokens},is:function(a){return-1!==a.indexOf(this.ch)},
was:function(a){return-1!==a.indexOf(this.lastCh)},peek:function(a){a=a||1;return this.index+a<this.text.length?this.text.charAt(this.index+a):!1},isNumber:function(a){return"0"<=a&&"9">=a},isWhitespace:function(a){return" "===a||"\r"===a||"\t"===a||"\n"===a||"\v"===a||"\u00a0"===a},isIdent:function(a){return"a"<=a&&"z">=a||"A"<=a&&"Z">=a||"_"===a||"$"===a},isExpOperator:function(a){return"-"===a||"+"===a||this.isNumber(a)},throwError:function(a,c,d){d=d||this.index;c=y(c)?"s "+c+"-"+this.index+" ["+
this.text.substring(c,d)+"]":" "+d;throw la("lexerr",a,c,this.text);},readNumber:function(){for(var a="",c=this.index;this.index<this.text.length;){var d=K(this.text.charAt(this.index));if("."==d||this.isNumber(d))a+=d;else{var e=this.peek();if("e"==d&&this.isExpOperator(e))a+=d;else if(this.isExpOperator(d)&&e&&this.isNumber(e)&&"e"==a.charAt(a.length-1))a+=d;else if(!this.isExpOperator(d)||e&&this.isNumber(e)||"e"!=a.charAt(a.length-1))break;else this.throwError("Invalid exponent")}this.index++}a*=
1;this.tokens.push({index:c,text:a,literal:!0,constant:!0,fn:function(){return a}})},readIdent:function(){for(var a=this,c="",d=this.index,e,f,g,k;this.index<this.text.length;){k=this.text.charAt(this.index);if("."===k||this.isIdent(k)||this.isNumber(k))"."===k&&(e=this.index),c+=k;else break;this.index++}if(e)for(f=this.index;f<this.text.length;){k=this.text.charAt(f);if("("===k){g=c.substr(e-d+1);c=c.substr(0,e-d);this.index=f;break}if(this.isWhitespace(k))f++;else break}d={index:d,text:c};if(gb.hasOwnProperty(c))d.fn=
gb[c],d.literal=!0,d.constant=!0;else{var m=Ec(c,this.options,this.text);d.fn=D(function(a,c){return m(a,c)},{assign:function(d,e){return ub(d,c,e,a.text,a.options)}})}this.tokens.push(d);g&&(this.tokens.push({index:e,text:"."}),this.tokens.push({index:e+1,text:g}))},readString:function(a){var c=this.index;this.index++;for(var d="",e=a,f=!1;this.index<this.text.length;){var g=this.text.charAt(this.index),e=e+g;if(f)"u"===g?(f=this.text.substring(this.index+1,this.index+5),f.match(/[\da-f]{4}/i)||
this.throwError("Invalid unicode escape [\\u"+f+"]"),this.index+=4,d+=String.fromCharCode(parseInt(f,16))):d+=Re[g]||g,f=!1;else if("\\"===g)f=!0;else{if(g===a){this.index++;this.tokens.push({index:c,text:e,string:d,literal:!0,constant:!0,fn:function(){return d}});return}d+=g}this.index++}this.throwError("Unterminated quote",c)}};var fb=function(a,c,d){this.lexer=a;this.$filter=c;this.options=d};fb.ZERO=D(function(){return 0},{constant:!0});fb.prototype={constructor:fb,parse:function(a){this.text=
a;this.tokens=this.lexer.lex(a);a=this.statements();0!==this.tokens.length&&this.throwError("is an unexpected token",this.tokens[0]);a.literal=!!a.literal;a.constant=!!a.constant;return a},primary:function(){var a;if(this.expect("("))a=this.filterChain(),this.consume(")");else if(this.expect("["))a=this.arrayDeclaration();else if(this.expect("{"))a=this.object();else{var c=this.expect();(a=c.fn)||this.throwError("not a primary expression",c);a.literal=!!c.literal;a.constant=!!c.constant}for(var d;c=
this.expect("(","[",".");)"("===c.text?(a=this.functionCall(a,d),d=null):"["===c.text?(d=a,a=this.objectIndex(a)):"."===c.text?(d=a,a=this.fieldAccess(a)):this.throwError("IMPOSSIBLE");return a},throwError:function(a,c){throw la("syntax",c.text,a,c.index+1,this.text,this.text.substring(c.index));},peekToken:function(){if(0===this.tokens.length)throw la("ueoe",this.text);return this.tokens[0]},peek:function(a,c,d,e){if(0<this.tokens.length){var f=this.tokens[0],g=f.text;if(g===a||g===c||g===d||g===
e||!(a||c||d||e))return f}return!1},expect:function(a,c,d,e){return(a=this.peek(a,c,d,e))?(this.tokens.shift(),a):!1},consume:function(a){this.expect(a)||this.throwError("is unexpected, expecting ["+a+"]",this.peek())},unaryFn:function(a,c){return D(function(d,e){return a(d,e,c)},{constant:c.constant})},ternaryFn:function(a,c,d){return D(function(e,f){return a(e,f)?c(e,f):d(e,f)},{constant:a.constant&&c.constant&&d.constant})},binaryFn:function(a,c,d){return D(function(e,f){return c(e,f,a,d)},{constant:a.constant&&
d.constant})},statements:function(){for(var a=[];;)if(0<this.tokens.length&&!this.peek("}",")",";","]")&&a.push(this.filterChain()),!this.expect(";"))return 1===a.length?a[0]:function(c,d){for(var e,f=0;f<a.length;f++){var g=a[f];g&&(e=g(c,d))}return e}},filterChain:function(){for(var a=this.expression(),c;;)if(c=this.expect("|"))a=this.binaryFn(a,c.fn,this.filter());else return a},filter:function(){for(var a=this.expect(),c=this.$filter(a.text),d=[];;)if(a=this.expect(":"))d.push(this.expression());
else{var e=function(a,e,k){k=[k];for(var m=0;m<d.length;m++)k.push(d[m](a,e));return c.apply(a,k)};return function(){return e}}},expression:function(){return this.assignment()},assignment:function(){var a=this.ternary(),c,d;return(d=this.expect("="))?(a.assign||this.throwError("implies assignment but ["+this.text.substring(0,d.index)+"] can not be assigned to",d),c=this.ternary(),function(d,f){return a.assign(d,c(d,f),f)}):a},ternary:function(){var a=this.logicalOR(),c,d;if(this.expect("?")){c=this.assignment();
if(d=this.expect(":"))return this.ternaryFn(a,c,this.assignment());this.throwError("expected :",d)}else return a},logicalOR:function(){for(var a=this.logicalAND(),c;;)if(c=this.expect("||"))a=this.binaryFn(a,c.fn,this.logicalAND());else return a},logicalAND:function(){var a=this.equality(),c;if(c=this.expect("&&"))a=this.binaryFn(a,c.fn,this.logicalAND());return a},equality:function(){var a=this.relational(),c;if(c=this.expect("==","!=","===","!=="))a=this.binaryFn(a,c.fn,this.equality());return a},
relational:function(){var a=this.additive(),c;if(c=this.expect("<",">","<=",">="))a=this.binaryFn(a,c.fn,this.relational());return a},additive:function(){for(var a=this.multiplicative(),c;c=this.expect("+","-");)a=this.binaryFn(a,c.fn,this.multiplicative());return a},multiplicative:function(){for(var a=this.unary(),c;c=this.expect("*","/","%");)a=this.binaryFn(a,c.fn,this.unary());return a},unary:function(){var a;return this.expect("+")?this.primary():(a=this.expect("-"))?this.binaryFn(fb.ZERO,a.fn,
this.unary()):(a=this.expect("!"))?this.unaryFn(a.fn,this.unary()):this.primary()},fieldAccess:function(a){var c=this,d=this.expect().text,e=Ec(d,this.options,this.text);return D(function(c,d,k){return e(k||a(c,d))},{assign:function(e,g,k){(k=a(e,k))||a.assign(e,k={});return ub(k,d,g,c.text,c.options)}})},objectIndex:function(a){var c=this,d=this.expression();this.consume("]");return D(function(e,f){var g=a(e,f),k=d(e,f),m;ka(k,c.text);if(!g)return t;(g=va(g[k],c.text))&&(g.then&&c.options.unwrapPromises)&&
(m=g,"$$v"in g||(m.$$v=t,m.then(function(a){m.$$v=a})),g=g.$$v);return g},{assign:function(e,f,g){var k=ka(d(e,g),c.text);(g=va(a(e,g),c.text))||a.assign(e,g={});return g[k]=f}})},functionCall:function(a,c){var d=[];if(")"!==this.peekToken().text){do d.push(this.expression());while(this.expect(","))}this.consume(")");var e=this;return function(f,g){for(var k=[],m=c?c(f,g):f,h=0;h<d.length;h++)k.push(va(d[h](f,g),e.text));h=a(f,g,m)||E;va(m,e.text);var l=e.text;if(h){if(h.constructor===h)throw la("isecfn",
l);if(h===Pe||h===Qe||Qc&&h===Qc)throw la("isecff",l);}k=h.apply?h.apply(m,k):h(k[0],k[1],k[2],k[3],k[4]);return va(k,e.text)}},arrayDeclaration:function(){var a=[],c=!0;if("]"!==this.peekToken().text){do{if(this.peek("]"))break;var d=this.expression();a.push(d);d.constant||(c=!1)}while(this.expect(","))}this.consume("]");return D(function(c,d){for(var g=[],k=0;k<a.length;k++)g.push(a[k](c,d));return g},{literal:!0,constant:c})},object:function(){var a=[],c=!0;if("}"!==this.peekToken().text){do{if(this.peek("}"))break;
var d=this.expect(),d=d.string||d.text;this.consume(":");var e=this.expression();a.push({key:d,value:e});e.constant||(c=!1)}while(this.expect(","))}this.consume("}");return D(function(c,d){for(var e={},m=0;m<a.length;m++){var h=a[m];e[h.key]=h.value(c,d)}return e},{literal:!0,constant:c})}};var Vb={},xa=C("$sce"),ga={HTML:"html",CSS:"css",URL:"url",RESOURCE_URL:"resourceUrl",JS:"js"},Y=X.createElement("a"),Hc=ua(W.location.href,!0);mc.$inject=["$provide"];Ic.$inject=["$locale"];Kc.$inject=["$locale"];
var Nc=".",Je={yyyy:$("FullYear",4),yy:$("FullYear",2,0,!0),y:$("FullYear",1),MMMM:vb("Month"),MMM:vb("Month",!0),MM:$("Month",2,1),M:$("Month",1,1),dd:$("Date",2),d:$("Date",1),HH:$("Hours",2),H:$("Hours",1),hh:$("Hours",2,-12),h:$("Hours",1,-12),mm:$("Minutes",2),m:$("Minutes",1),ss:$("Seconds",2),s:$("Seconds",1),sss:$("Milliseconds",3),EEEE:vb("Day"),EEE:vb("Day",!0),a:function(a,c){return 12>a.getHours()?c.AMPMS[0]:c.AMPMS[1]},Z:function(a){a=-1*a.getTimezoneOffset();return a=(0<=a?"+":"")+(Xb(Math[0<
a?"floor":"ceil"](a/60),2)+Xb(Math.abs(a%60),2))}},Ie=/((?:[^yMdHhmsaZE']+)|(?:'(?:[^']|'')*')|(?:E+|y+|M+|d+|H+|h+|m+|s+|a|Z))(.*)/,He=/^\-?\d+$/;Jc.$inject=["$locale"];var Fe=ba(K),Ge=ba(Ia);Lc.$inject=["$parse"];var dd=ba({restrict:"E",compile:function(a,c){8>=Q&&(c.href||c.name||c.$set("href",""),a.append(X.createComment("IE fix")));if(!c.href&&!c.xlinkHref&&!c.name)return function(a,c){var f="[object SVGAnimatedString]"===za.call(c.prop("href"))?"xlink:href":"href";c.on("click",function(a){c.attr(f)||
a.preventDefault()})}}}),Fb={};r(qb,function(a,c){if("multiple"!=a){var d=pa("ng-"+c);Fb[d]=function(){return{priority:100,link:function(a,f,g){a.$watch(g[d],function(a){g.$set(c,!!a)})}}}}});r(["src","srcset","href"],function(a){var c=pa("ng-"+a);Fb[c]=function(){return{priority:99,link:function(d,e,f){var g=a,k=a;"href"===a&&"[object SVGAnimatedString]"===za.call(e.prop("href"))&&(k="xlinkHref",f.$attr[k]="xlink:href",g=null);f.$observe(c,function(c){c?(f.$set(k,c),Q&&g&&e.prop(g,f[k])):"href"===
a&&f.$set(k,null)})}}}});var yb={$addControl:E,$removeControl:E,$setValidity:E,$setDirty:E,$setPristine:E};Oc.$inject=["$element","$attrs","$scope","$animate"];var Rc=function(a){return["$timeout",function(c){return{name:"form",restrict:a?"EAC":"E",controller:Oc,compile:function(){return{pre:function(a,e,f,g){if(!f.action){var k=function(a){a.preventDefault?a.preventDefault():a.returnValue=!1};sb(e[0],"submit",k);e.on("$destroy",function(){c(function(){$a(e[0],"submit",k)},0,!1)})}var m=e.parent().controller("form"),
h=f.name||f.ngForm;h&&ub(a,h,g,h);if(m)e.on("$destroy",function(){m.$removeControl(g);h&&ub(a,h,t,h);D(g,yb)})}}}}}]},ed=Rc(),rd=Rc(!0),Se=/^(ftp|http|https):\/\/(\w+:{0,1}\w*@)?(\S+)(:[0-9]+)?(\/|\/([\w#!:.?+=&%@!\-\/]))?$/,Te=/^[a-z0-9!#$%&'*+\/=?^_`{|}~.-]+@[a-z0-9]([a-z0-9-]*[a-z0-9])?(\.[a-z0-9]([a-z0-9-]*[a-z0-9])?)*$/i,Ue=/^\s*(\-|\+)?(\d+|(\d*(\.\d*)))\s*$/,Sc={text:Ab,number:function(a,c,d,e,f,g){Ab(a,c,d,e,f,g);e.$parsers.push(function(a){var c=e.$isEmpty(a);if(c||Ue.test(a))return e.$setValidity("number",
!0),""===a?null:c?a:parseFloat(a);e.$setValidity("number",!1);return t});Ke(e,"number",Ve,null,e.$$validityState);e.$formatters.push(function(a){return e.$isEmpty(a)?"":""+a});d.min&&(a=function(a){var c=parseFloat(d.min);return sa(e,"min",e.$isEmpty(a)||a>=c,a)},e.$parsers.push(a),e.$formatters.push(a));d.max&&(a=function(a){var c=parseFloat(d.max);return sa(e,"max",e.$isEmpty(a)||a<=c,a)},e.$parsers.push(a),e.$formatters.push(a));e.$formatters.push(function(a){return sa(e,"number",e.$isEmpty(a)||
ib(a),a)})},url:function(a,c,d,e,f,g){Ab(a,c,d,e,f,g);a=function(a){return sa(e,"url",e.$isEmpty(a)||Se.test(a),a)};e.$formatters.push(a);e.$parsers.push(a)},email:function(a,c,d,e,f,g){Ab(a,c,d,e,f,g);a=function(a){return sa(e,"email",e.$isEmpty(a)||Te.test(a),a)};e.$formatters.push(a);e.$parsers.push(a)},radio:function(a,c,d,e){x(d.name)&&c.attr("name",hb());c.on("click",function(){c[0].checked&&a.$apply(function(){e.$setViewValue(d.value)})});e.$render=function(){c[0].checked=d.value==e.$viewValue};
d.$observe("value",e.$render)},checkbox:function(a,c,d,e){var f=d.ngTrueValue,g=d.ngFalseValue;v(f)||(f=!0);v(g)||(g=!1);c.on("click",function(){a.$apply(function(){e.$setViewValue(c[0].checked)})});e.$render=function(){c[0].checked=e.$viewValue};e.$isEmpty=function(a){return a!==f};e.$formatters.push(function(a){return a===f});e.$parsers.push(function(a){return a?f:g})},hidden:E,button:E,submit:E,reset:E,file:E},Ve=["badInput"],jc=["$browser","$sniffer",function(a,c){return{restrict:"E",require:"?ngModel",
link:function(d,e,f,g){g&&(Sc[K(f.type)]||Sc.text)(d,e,f,g,c,a)}}}],wb="ng-valid",xb="ng-invalid",Oa="ng-pristine",zb="ng-dirty",We=["$scope","$exceptionHandler","$attrs","$element","$parse","$animate",function(a,c,d,e,f,g){function k(a,c){c=c?"-"+mb(c,"-"):"";g.removeClass(e,(a?xb:wb)+c);g.addClass(e,(a?wb:xb)+c)}this.$modelValue=this.$viewValue=Number.NaN;this.$parsers=[];this.$formatters=[];this.$viewChangeListeners=[];this.$pristine=!0;this.$dirty=!1;this.$valid=!0;this.$invalid=!1;this.$name=
d.name;var m=f(d.ngModel),h=m.assign;if(!h)throw C("ngModel")("nonassign",d.ngModel,ia(e));this.$render=E;this.$isEmpty=function(a){return x(a)||""===a||null===a||a!==a};var l=e.inheritedData("$formController")||yb,n=0,p=this.$error={};e.addClass(Oa);k(!0);this.$setValidity=function(a,c){p[a]!==!c&&(c?(p[a]&&n--,n||(k(!0),this.$valid=!0,this.$invalid=!1)):(k(!1),this.$invalid=!0,this.$valid=!1,n++),p[a]=!c,k(c,a),l.$setValidity(a,c,this))};this.$setPristine=function(){this.$dirty=!1;this.$pristine=
!0;g.removeClass(e,zb);g.addClass(e,Oa)};this.$setViewValue=function(d){this.$viewValue=d;this.$pristine&&(this.$dirty=!0,this.$pristine=!1,g.removeClass(e,Oa),g.addClass(e,zb),l.$setDirty());r(this.$parsers,function(a){d=a(d)});this.$modelValue!==d&&(this.$modelValue=d,h(a,d),r(this.$viewChangeListeners,function(a){try{a()}catch(d){c(d)}}))};var q=this;a.$watch(function(){var c=m(a);if(q.$modelValue!==c){var d=q.$formatters,e=d.length;for(q.$modelValue=c;e--;)c=d[e](c);q.$viewValue!==c&&(q.$viewValue=
c,q.$render())}return c})}],Gd=function(){return{require:["ngModel","^?form"],controller:We,link:function(a,c,d,e){var f=e[0],g=e[1]||yb;g.$addControl(f);a.$on("$destroy",function(){g.$removeControl(f)})}}},Id=ba({require:"ngModel",link:function(a,c,d,e){e.$viewChangeListeners.push(function(){a.$eval(d.ngChange)})}}),kc=function(){return{require:"?ngModel",link:function(a,c,d,e){if(e){d.required=!0;var f=function(a){if(d.required&&e.$isEmpty(a))e.$setValidity("required",!1);else return e.$setValidity("required",
!0),a};e.$formatters.push(f);e.$parsers.unshift(f);d.$observe("required",function(){f(e.$viewValue)})}}}},Hd=function(){return{require:"ngModel",link:function(a,c,d,e){var f=(a=/\/(.*)\//.exec(d.ngList))&&RegExp(a[1])||d.ngList||",";e.$parsers.push(function(a){if(!x(a)){var c=[];a&&r(a.split(f),function(a){a&&c.push(aa(a))});return c}});e.$formatters.push(function(a){return J(a)?a.join(", "):t});e.$isEmpty=function(a){return!a||!a.length}}}},Xe=/^(true|false|\d+)$/,Jd=function(){return{priority:100,
compile:function(a,c){return Xe.test(c.ngValue)?function(a,c,f){f.$set("value",a.$eval(f.ngValue))}:function(a,c,f){a.$watch(f.ngValue,function(a){f.$set("value",a)})}}}},jd=ya({compile:function(a){a.addClass("ng-binding");return function(a,d,e){d.data("$binding",e.ngBind);a.$watch(e.ngBind,function(a){d.text(a==t?"":a)})}}}),ld=["$interpolate",function(a){return function(c,d,e){c=a(d.attr(e.$attr.ngBindTemplate));d.addClass("ng-binding").data("$binding",c);e.$observe("ngBindTemplate",function(a){d.text(a)})}}],
kd=["$sce","$parse",function(a,c){return{compile:function(d){d.addClass("ng-binding");return function(d,f,g){f.data("$binding",g.ngBindHtml);var k=c(g.ngBindHtml);d.$watch(function(){return(k(d)||"").toString()},function(c){f.html(a.getTrustedHtml(k(d))||"")})}}}}],md=Yb("",!0),od=Yb("Odd",0),nd=Yb("Even",1),pd=ya({compile:function(a,c){c.$set("ngCloak",t);a.removeClass("ng-cloak")}}),qd=[function(){return{scope:!0,controller:"@",priority:500}}],lc={},Ye={blur:!0,focus:!0};r("click dblclick mousedown mouseup mouseover mouseout mousemove mouseenter mouseleave keydown keyup keypress submit focus blur copy cut paste".split(" "),
function(a){var c=pa("ng-"+a);lc[c]=["$parse","$rootScope",function(d,e){return{compile:function(f,g){var k=d(g[c]);return function(c,d){d.on(a,function(d){var f=function(){k(c,{$event:d})};Ye[a]&&e.$$phase?c.$evalAsync(f):c.$apply(f)})}}}}]});var td=["$animate",function(a){return{transclude:"element",priority:600,terminal:!0,restrict:"A",$$tlb:!0,link:function(c,d,e,f,g){var k,m,h;c.$watch(e.ngIf,function(f){Ua(f)?m||(m=c.$new(),g(m,function(c){c[c.length++]=X.createComment(" end ngIf: "+e.ngIf+
" ");k={clone:c};a.enter(c,d.parent(),d)})):(h&&(h.remove(),h=null),m&&(m.$destroy(),m=null),k&&(h=Eb(k.clone),a.leave(h,function(){h=null}),k=null))})}}}],ud=["$http","$templateCache","$anchorScroll","$animate","$sce",function(a,c,d,e,f){return{restrict:"ECA",priority:400,terminal:!0,transclude:"element",controller:Va.noop,compile:function(g,k){var m=k.ngInclude||k.src,h=k.onload||"",l=k.autoscroll;return function(g,k,q,r,F){var u=0,t,w,R,z=function(){w&&(w.remove(),w=null);t&&(t.$destroy(),t=null);
R&&(e.leave(R,function(){w=null}),w=R,R=null)};g.$watch(f.parseAsResourceUrl(m),function(f){var m=function(){!y(l)||l&&!g.$eval(l)||d()},q=++u;f?(a.get(f,{cache:c}).success(function(a){if(q===u){var c=g.$new();r.template=a;a=F(c,function(a){z();e.enter(a,null,k,m)});t=c;R=a;t.$emit("$includeContentLoaded");g.$eval(h)}}).error(function(){q===u&&z()}),g.$emit("$includeContentRequested")):(z(),r.template=null)})}}}}],Kd=["$compile",function(a){return{restrict:"ECA",priority:-400,require:"ngInclude",
link:function(c,d,e,f){d.html(f.template);a(d.contents())(c)}}}],vd=ya({priority:450,compile:function(){return{pre:function(a,c,d){a.$eval(d.ngInit)}}}}),wd=ya({terminal:!0,priority:1E3}),xd=["$locale","$interpolate",function(a,c){var d=/{}/g;return{restrict:"EA",link:function(e,f,g){var k=g.count,m=g.$attr.when&&f.attr(g.$attr.when),h=g.offset||0,l=e.$eval(m)||{},n={},p=c.startSymbol(),q=c.endSymbol(),s=/^when(Minus)?(.+)$/;r(g,function(a,c){s.test(c)&&(l[K(c.replace("when","").replace("Minus","-"))]=
f.attr(g.$attr[c]))});r(l,function(a,e){n[e]=c(a.replace(d,p+k+"-"+h+q))});e.$watch(function(){var c=parseFloat(e.$eval(k));if(isNaN(c))return"";c in l||(c=a.pluralCat(c-h));return n[c](e,f,!0)},function(a){f.text(a)})}}}],yd=["$parse","$animate",function(a,c){var d=C("ngRepeat");return{transclude:"element",priority:1E3,terminal:!0,$$tlb:!0,link:function(e,f,g,k,m){var h=g.ngRepeat,l=h.match(/^\s*([\s\S]+?)\s+in\s+([\s\S]+?)(?:\s+track\s+by\s+([\s\S]+?))?\s*$/),n,p,q,s,t,u,A={$id:Ka};if(!l)throw d("iexp",
h);g=l[1];k=l[2];(l=l[3])?(n=a(l),p=function(a,c,d){u&&(A[u]=a);A[t]=c;A.$index=d;return n(e,A)}):(q=function(a,c){return Ka(c)},s=function(a){return a});l=g.match(/^(?:([\$\w]+)|\(([\$\w]+)\s*,\s*([\$\w]+)\))$/);if(!l)throw d("iidexp",g);t=l[3]||l[1];u=l[2];var y={};e.$watchCollection(k,function(a){var g,k,l=f[0],n,A={},B,I,H,v,E,C,x,J=[];if(Pa(a))C=a,E=p||q;else{E=p||s;C=[];for(H in a)a.hasOwnProperty(H)&&"$"!=H.charAt(0)&&C.push(H);C.sort()}B=C.length;k=J.length=C.length;for(g=0;g<k;g++)if(H=a===
C?g:C[g],v=a[H],n=E(H,v,g),Da(n,"`track by` id"),y.hasOwnProperty(n))x=y[n],delete y[n],A[n]=x,J[g]=x;else{if(A.hasOwnProperty(n))throw r(J,function(a){a&&a.scope&&(y[a.id]=a)}),d("dupes",h,n,na(v));J[g]={id:n};A[n]=!1}for(H in y)y.hasOwnProperty(H)&&(x=y[H],g=Eb(x.clone),c.leave(g),r(g,function(a){a.$$NG_REMOVED=!0}),x.scope.$destroy());g=0;for(k=C.length;g<k;g++){H=a===C?g:C[g];v=a[H];x=J[g];J[g-1]&&(l=J[g-1].clone[J[g-1].clone.length-1]);if(x.scope){I=x.scope;n=l;do n=n.nextSibling;while(n&&n.$$NG_REMOVED);
x.clone[0]!=n&&c.move(Eb(x.clone),null,w(l));l=x.clone[x.clone.length-1]}else I=e.$new();I[t]=v;u&&(I[u]=H);I.$index=g;I.$first=0===g;I.$last=g===B-1;I.$middle=!(I.$first||I.$last);I.$odd=!(I.$even=0===(g&1));x.scope||m(I,function(a){a[a.length++]=X.createComment(" end ngRepeat: "+h+" ");c.enter(a,null,w(l));l=a;x.scope=I;x.clone=a;A[x.id]=x})}y=A})}}}],zd=["$animate",function(a){return function(c,d,e){c.$watch(e.ngShow,function(c){a[Ua(c)?"removeClass":"addClass"](d,"ng-hide")})}}],sd=["$animate",
function(a){return function(c,d,e){c.$watch(e.ngHide,function(c){a[Ua(c)?"addClass":"removeClass"](d,"ng-hide")})}}],Ad=ya(function(a,c,d){a.$watch(d.ngStyle,function(a,d){d&&a!==d&&r(d,function(a,d){c.css(d,"")});a&&c.css(a)},!0)}),Bd=["$animate",function(a){return{restrict:"EA",require:"ngSwitch",controller:["$scope",function(){this.cases={}}],link:function(c,d,e,f){var g=[],k=[],m=[],h=[];c.$watch(e.ngSwitch||e.on,function(d){var n,p;n=0;for(p=m.length;n<p;++n)m[n].remove();n=m.length=0;for(p=
h.length;n<p;++n){var q=k[n];h[n].$destroy();m[n]=q;a.leave(q,function(){m.splice(n,1)})}k.length=0;h.length=0;if(g=f.cases["!"+d]||f.cases["?"])c.$eval(e.change),r(g,function(d){var e=c.$new();h.push(e);d.transclude(e,function(c){var e=d.element;k.push(c);a.enter(c,e.parent(),e)})})})}}}],Cd=ya({transclude:"element",priority:800,require:"^ngSwitch",link:function(a,c,d,e,f){e.cases["!"+d.ngSwitchWhen]=e.cases["!"+d.ngSwitchWhen]||[];e.cases["!"+d.ngSwitchWhen].push({transclude:f,element:c})}}),Dd=
ya({transclude:"element",priority:800,require:"^ngSwitch",link:function(a,c,d,e,f){e.cases["?"]=e.cases["?"]||[];e.cases["?"].push({transclude:f,element:c})}}),Fd=ya({link:function(a,c,d,e,f){if(!f)throw C("ngTransclude")("orphan",ia(c));f(function(a){c.empty();c.append(a)})}}),fd=["$templateCache",function(a){return{restrict:"E",terminal:!0,compile:function(c,d){"text/ng-template"==d.type&&a.put(d.id,c[0].text)}}}],Ze=C("ngOptions"),Ed=ba({terminal:!0}),gd=["$compile","$parse",function(a,c){var d=
/^\s*([\s\S]+?)(?:\s+as\s+([\s\S]+?))?(?:\s+group\s+by\s+([\s\S]+?))?\s+for\s+(?:([\$\w][\$\w]*)|(?:\(\s*([\$\w][\$\w]*)\s*,\s*([\$\w][\$\w]*)\s*\)))\s+in\s+([\s\S]+?)(?:\s+track\s+by\s+([\s\S]+?))?$/,e={$setViewValue:E};return{restrict:"E",require:["select","?ngModel"],controller:["$element","$scope","$attrs",function(a,c,d){var m=this,h={},l=e,n;m.databound=d.ngModel;m.init=function(a,c,d){l=a;n=d};m.addOption=function(c){Da(c,'"option value"');h[c]=!0;l.$viewValue==c&&(a.val(c),n.parent()&&n.remove())};
m.removeOption=function(a){this.hasOption(a)&&(delete h[a],l.$viewValue==a&&this.renderUnknownOption(a))};m.renderUnknownOption=function(c){c="? "+Ka(c)+" ?";n.val(c);a.prepend(n);a.val(c);n.prop("selected",!0)};m.hasOption=function(a){return h.hasOwnProperty(a)};c.$on("$destroy",function(){m.renderUnknownOption=E})}],link:function(e,g,k,m){function h(a,c,d,e){d.$render=function(){var a=d.$viewValue;e.hasOption(a)?(v.parent()&&v.remove(),c.val(a),""===a&&u.prop("selected",!0)):x(a)&&u?c.val(""):e.renderUnknownOption(a)};
c.on("change",function(){a.$apply(function(){v.parent()&&v.remove();d.$setViewValue(c.val())})})}function l(a,c,d){var e;d.$render=function(){var a=new bb(d.$viewValue);r(c.find("option"),function(c){c.selected=y(a.get(c.value))})};a.$watch(function(){Aa(e,d.$viewValue)||(e=ha(d.$viewValue),d.$render())});c.on("change",function(){a.$apply(function(){var a=[];r(c.find("option"),function(c){c.selected&&a.push(c.value)});d.$setViewValue(a)})})}function n(e,f,g){function k(){var a={"":[]},c=[""],d,h,
s,t,v;s=g.$modelValue;t=w(e)||[];var E=n?Zb(t):t,I,M,B;M={};B=!1;if(q)if(h=g.$modelValue,x&&J(h))for(B=new bb([]),d={},v=0;v<h.length;v++)d[m]=h[v],B.put(x(e,d),h[v]);else B=new bb(h);v=B;var D,K;for(B=0;I=E.length,B<I;B++){h=B;if(n){h=E[B];if("$"===h.charAt(0))continue;M[n]=h}M[m]=t[h];d=r(e,M)||"";(h=a[d])||(h=a[d]=[],c.push(d));q?d=y(v.remove(x?x(e,M):u(e,M))):(x?(d={},d[m]=s,d=x(e,d)===x(e,M)):d=s===u(e,M),v=v||d);D=l(e,M);D=y(D)?D:"";h.push({id:x?x(e,M):n?E[B]:B,label:D,selected:d})}q||(F||null===
s?a[""].unshift({id:"",label:"",selected:!v}):v||a[""].unshift({id:"?",label:"",selected:!0}));M=0;for(E=c.length;M<E;M++){d=c[M];h=a[d];z.length<=M?(s={element:C.clone().attr("label",d),label:h.label},t=[s],z.push(t),f.append(s.element)):(t=z[M],s=t[0],s.label!=d&&s.element.attr("label",s.label=d));D=null;B=0;for(I=h.length;B<I;B++)d=h[B],(v=t[B+1])?(D=v.element,v.label!==d.label&&D.text(v.label=d.label),v.id!==d.id&&D.val(v.id=d.id),D[0].selected!==d.selected&&(D.prop("selected",v.selected=d.selected),
Q&&D.prop("selected",v.selected))):(""===d.id&&F?K=F:(K=A.clone()).val(d.id).prop("selected",d.selected).attr("selected",d.selected).text(d.label),t.push({element:K,label:d.label,id:d.id,selected:d.selected}),p.addOption(d.label,K),D?D.after(K):s.element.append(K),D=K);for(B++;t.length>B;)d=t.pop(),p.removeOption(d.label),d.element.remove()}for(;z.length>M;)z.pop()[0].element.remove()}var h;if(!(h=s.match(d)))throw Ze("iexp",s,ia(f));var l=c(h[2]||h[1]),m=h[4]||h[6],n=h[5],r=c(h[3]||""),u=c(h[2]?
h[1]:m),w=c(h[7]),x=h[8]?c(h[8]):null,z=[[{element:f,label:""}]];F&&(a(F)(e),F.removeClass("ng-scope"),F.remove());f.empty();f.on("change",function(){e.$apply(function(){var a,c=w(e)||[],d={},h,l,p,r,s,v,y;if(q)for(l=[],r=0,v=z.length;r<v;r++)for(a=z[r],p=1,s=a.length;p<s;p++){if((h=a[p].element)[0].selected){h=h.val();n&&(d[n]=h);if(x)for(y=0;y<c.length&&(d[m]=c[y],x(e,d)!=h);y++);else d[m]=c[h];l.push(u(e,d))}}else if(h=f.val(),"?"==h)l=t;else if(""===h)l=null;else if(x)for(y=0;y<c.length;y++){if(d[m]=
c[y],x(e,d)==h){l=u(e,d);break}}else d[m]=c[h],n&&(d[n]=h),l=u(e,d);g.$setViewValue(l);k()})});g.$render=k;e.$watchCollection(w,k);e.$watchCollection(function(){var a={},c=w(e);if(c){for(var d=Array(c.length),f=0,g=c.length;f<g;f++)a[m]=c[f],d[f]=l(e,a);return d}},k);q&&e.$watchCollection(function(){return g.$modelValue},k)}if(m[1]){var p=m[0];m=m[1];var q=k.multiple,s=k.ngOptions,F=!1,u,A=w(X.createElement("option")),C=w(X.createElement("optgroup")),v=A.clone();k=0;for(var z=g.children(),E=z.length;k<
E;k++)if(""===z[k].value){u=F=z.eq(k);break}p.init(m,F,v);q&&(m.$isEmpty=function(a){return!a||0===a.length});s?n(e,g,m):q?l(e,g,m):h(e,g,m,p)}}}}],id=["$interpolate",function(a){var c={addOption:E,removeOption:E};return{restrict:"E",priority:100,compile:function(d,e){if(x(e.value)){var f=a(d.text(),!0);f||e.$set("value",d.text())}return function(a,d,e){var h=d.parent(),l=h.data("$selectController")||h.parent().data("$selectController");l&&l.databound?d.prop("selected",!1):l=c;f?a.$watch(f,function(a,
c){e.$set("value",a);a!==c&&l.removeOption(c);l.addOption(a)}):l.addOption(e.value);d.on("$destroy",function(){l.removeOption(e.value)})}}}}],hd=ba({restrict:"E",terminal:!0});W.angular.bootstrap?console.log("WARNING: Tried to load angular more than once."):((Ea=W.jQuery)&&Ea.fn.on?(w=Ea,D(Ea.fn,{scope:La.scope,isolateScope:La.isolateScope,controller:La.controller,injector:La.injector,inheritedData:La.inheritedData}),Gb("remove",!0,!0,!1),Gb("empty",!1,!1,!1),Gb("html",!1,!1,!0)):w=S,Va.element=w,
$c(Va),w(X).ready(function(){Xc(X,fc)}))})(window,document);!window.angular.$$csp()&&window.angular.element(document).find("head").prepend('<style type="text/css">@charset "UTF-8";[ng\\:cloak],[ng-cloak],[data-ng-cloak],[x-ng-cloak],.ng-cloak,.x-ng-cloak,.ng-hide{display:none !important;}ng\\:form{display:block;}.ng-animate-block-transitions{transition:0s all!important;-webkit-transition:0s all!important;}.ng-hide-add-active,.ng-hide-remove{display:block!important;}</style>');
//# sourceMappingURL=angular.min.js.map

; browserify_shim__define__module__export__(typeof angular != "undefined" ? angular : window.angular);

}).call(global, undefined, undefined, undefined, undefined, function defineExport(ex) { module.exports = ex; });

}).call(this,typeof global !== "undefined" ? global : typeof self !== "undefined" ? self : typeof window !== "undefined" ? window : {})
},{}],"/home/ubuntu/workspace/bower_components/famous-angular/dist/famous-angular.min.js":[function(require,module,exports){
(function (global){

; require("famous-polyfills");
require("/home/ubuntu/workspace/bower_components/famous/dist/famous-global.min.js");
require("/home/ubuntu/workspace/bower_components/angular/angular.min.js");
require("/home/ubuntu/workspace/bower_components/angular-animate/angular-animate.min.js");
require("/home/ubuntu/workspace/bower_components/angular-sanitize/angular-sanitize.min.js");
require("/home/ubuntu/workspace/bower_components/angular-ui-router/release/angular-ui-router.min.js");
;__browserify_shim_require__=require;(function browserifyShim(module, define, require) {
/**
 * famous-angular - Bring structure to your Famo.us apps with the power of AngularJS. Famo.us/Angular integrates seamlessly with existing Angular and Famo.us apps.
 * @version v0.5.0
 * @link https://github.com/Famous/famous-angular
 * @license MPL v2.0
 */
"use strict";var ngFameApp=angular.module("famous.angular",[]);ngFameApp.provider("$famous",function(){var e={"famous/core/Context":famous.core.Context,"famous/core/ElementAllocator":famous.core.ElementAllocator,"famous/core/Engine":famous.core.Engine,"famous/core/Entity":famous.core.Entity,"famous/core/EventEmitter":famous.core.EventEmitter,"famous/core/EventHandler":famous.core.EventHandler,"famous/core/Group":famous.core.Group,"famous/core/Modifier":famous.core.Modifier,"famous/core/OptionsManager":famous.core.OptionsManager,"famous/core/RenderNode":famous.core.RenderNode,"famous/core/Scene":famous.core.Scene,"famous/core/SpecParser":famous.core.SpecParser,"famous/core/Surface":famous.core.Surface,"famous/core/Transform":famous.core.Transform,"famous/core/View":famous.core.View,"famous/core/ViewSequence":famous.core.ViewSequence,"famous/events/EventArbiter":famous.events.EventArbiter,"famous/events/EventFilter":famous.events.EventFilter,"famous/events/EventMapper":famous.events.EventMapper,"famous/inputs/FastClick":famous.inputs.FastClick,"famous/inputs/GenericSync":famous.inputs.GenericSync,"famous/inputs/MouseSync":famous.inputs.MouseSync,"famous/inputs/PinchSync":famous.inputs.PinchSync,"famous/inputs/RotateSync":famous.inputs.RotateSync,"famous/inputs/ScaleSync":famous.inputs.ScaleSync,"famous/inputs/ScrollSync":famous.inputs.ScrollSync,"famous/inputs/TouchSync":famous.inputs.TouchSync,"famous/inputs/TouchTracker":famous.inputs.TouchTracker,"famous/inputs/TwoFingerSync":famous.inputs.TwoFingerSync,"famous/math/Matrix":famous.math.Matrix,"famous/math/Quaternion":famous.math.Quaternion,"famous/math/Random":famous.math.Random,"famous/math/Utilities":famous.math.Utilities,"famous/math/Vector":famous.math.Vector,"famous/modifiers/Draggable":famous.modifiers.Draggable,"famous/modifiers/Fader":famous.modifiers.Fader,"famous/modifiers/ModifierChain":famous.modifiers.ModifierChain,"famous/modifiers/StateModifier":famous.modifiers.StateModifier,"famous/surfaces/CanvasSurface":famous.surfaces.CanvasSurface,"famous/surfaces/ContainerSurface":famous.surfaces.ContainerSurface,"famous/surfaces/FormContainerSurface":famous.surfaces.FormContainerSurface,"famous/surfaces/ImageSurface":famous.surfaces.ImageSurface,"famous/surfaces/InputSurface":famous.surfaces.InputSurface,"famous/surfaces/SubmitInputSurface":famous.surfaces.SubmitInputSurface,"famous/surfaces/TextareaSurface":famous.surfaces.TextareaSurface,"famous/surfaces/VideoSurface":famous.surfaces.VideoSurface,"famous/transitions/CachedMap":famous.transitions.CachedMap,"famous/transitions/Easing":famous.transitions.Easing,"famous/transitions/MultipleTransition":famous.transitions.MultipleTransition,"famous/transitions/SnapTransition":famous.transitions.SnapTransition,"famous/transitions/SpringTransition":famous.transitions.SpringTransition,"famous/transitions/Transitionable":famous.transitions.Transitionable,"famous/transitions/TransitionableTransform":famous.transitions.TransitionableTransform,"famous/transitions/TweenTransition":famous.transitions.TweenTransition,"famous/transitions/WallTransition":famous.transitions.WallTransition,"famous/utilities/KeyCodes":famous.utilities.KeyCodes,"famous/utilities/Timer":famous.utilities.Timer,"famous/utilities/Utility":famous.utilities.Utility,"famous/views/Deck":famous.views.Deck,"famous/views/EdgeSwapper":famous.views.EdgeSwapper,"famous/views/FlexibleLayout":famous.views.FlexibleLayout,"famous/views/Flipper":famous.views.Flipper,"famous/views/GridLayout":famous.views.GridLayout,"famous/views/HeaderFooterLayout":famous.views.HeaderFooterLayout,"famous/views/Lightbox":famous.views.Lightbox,"famous/views/RenderController":famous.views.RenderController,"famous/views/ScrollContainer":famous.views.ScrollContainer,"famous/views/Scroller":famous.views.Scroller,"famous/views/Scrollview":famous.views.Scrollview,"famous/views/SequentialLayout":famous.views.SequentialLayout,"famous/widgets/NavigationBar":famous.widgets.NavigationBar,"famous/widgets/Slider":famous.widgets.Slider,"famous/widgets/TabBar":famous.widgets.TabBar,"famous/widgets/ToggleButton":famous.widgets.ToggleButton,"famous/physics/PhysicsEngine":famous.physics.PhysicsEngine,"famous/physics/bodies/Body":famous.physics.bodies.Body,"famous/physics/bodies/Circle":famous.physics.bodies.Circle,"famous/physics/bodies/Particle":famous.physics.bodies.Particle,"famous/physics/bodies/Rectangle":famous.physics.bodies.Rectangle,"famous/physics/constraints/Collision":famous.physics.constraints.Collision,"famous/physics/constraints/Constraint":famous.physics.constraints.Constraint,"famous/physics/constraints/Curve":famous.physics.constraints.Curve,"famous/physics/constraints/Distance":famous.physics.constraints.Distance,"famous/physics/constraints/Snap":famous.physics.constraints.Snap,"famous/physics/constraints/Surface":famous.physics.constraints.Surface,"famous/physics/constraints/Wall":famous.physics.constraints.Wall,"famous/physics/constraints/Walls":famous.physics.constraints.Walls,"famous/physics/forces/Drag":famous.physics.forces.Drag,"famous/physics/forces/Force":famous.physics.forces.Force,"famous/physics/forces/Repulsion":famous.physics.forces.Repulsion,"famous/physics/forces/RotationalDrag":famous.physics.forces.RotationalDrag,"famous/physics/forces/RotationalSpring":famous.physics.forces.RotationalSpring,"famous/physics/forces/Spring":famous.physics.forces.Spring,"famous/physics/forces/VectorField":famous.physics.forces.VectorField,"famous/physics/integrators/SymplecticEuler":famous.physics.integrators.SymplecticEuler};this.registerModule=function(n,r){e[n]=r},e.getIsolate=function(e){return e&&"isolate"in e?e.isolate[e.$id]:{}},e.find=function(n){var r=angular.element(window.document.querySelectorAll(n)),a=function(e){var n=[];return angular.forEach(e,function(e,r){n[r]=angular.element(e).scope()}),n}(r),o=function(n){var r=[];return angular.forEach(n,function(n,a){r[a]=e.getIsolate(n)}),r}(a);return o};var n=/([\:\-\_]+(.))/g,r=/^moz([A-Z])/,a=/^(x[\:\-_]|data[\:\-_])/i,o=/^FA\-.*SURFACE/,t=/^FA\-.*/;window.$famousUtil=e.util={isASurface:function(e){return o.test(e[0].tagName)},isFaElement:function(e){if(t.test(e[0].tagName))return!0;var n=!1;return angular.forEach(e[0].attributes,function(e){n=n||t.test(e)}),n},camelCase:function(e){return e.replace(n,function(e,n,r,a){return a?r.toUpperCase():r}).replace(r,"Moz$1")},directiveNormalize:function(n){return e.util.camelCase(n.replace(a,""))}},this.$get=function(){return e}}),angular.module("famous.angular").config(["$provide",function(e){e.decorator("$animate",["$delegate","$rootScope","$famous","$parse","$famousDecorator",function(e,n,r,a,o){var t=r["famous/utilities/Timer"],i="$$faAnimationActive",s={},u=function(e){var n=r.getIsolate(e);return!n&&e&&(n=o.$$getIsolateById(s[e.$id])),n},c={enabled:e.enabled};return angular.forEach(["addClass","removeClass"],function(n){var a=angular.element.prototype[n];angular.element.prototype[n]=function(e){return a.apply(this,arguments),r.util.isASurface(this)&&"string"==typeof e&&""!==e.trim()&&u(this.scope()).renderNode[n](e),this},c[n]=function(a,o,t){if(e[n](a,o,t),r.util.isFaElement(a)){var i=u(a.scope());if(r.util.isASurface(a)){var s=i.renderNode;angular.forEach(o.split(" "),function(e){"ng-hide"===e?"addClass"===n?i.hide():"removeClass"===n&&i.show():s[n](e)})}else angular.forEach(o.split(" "),function(e){"ng-hide"===e&&("addClass"===n?i.hide():"removeClass"===n&&i.show())})}}}),c.setClass=function(n,a,o,t){if(e.setClass(n,a,o,t),r.util.isASurface(n)){var i=u(n.scope()).renderNode;angular.forEach(a.split(" "),function(e){i.addClass(e)}),angular.forEach(o.split(" "),function(e){i.removeClass(e)})}},angular.forEach(["enter","leave","move"],function(a){var o=a[0].toUpperCase()+a.slice(1);c[a]=function(c){var f=this,l=arguments,d="enter"===a,m=c.scope();m&&m.$parent&&(s[m.$id]=m.$parent.$id);var p=u(m);d===!0&&e[a].apply(this,arguments),c.data(i)===!0&&p&&p.$$animateHaltHandler&&p.$$animateHaltHandler(c.scope()),c.data(i,!0);var v=function(){m&&m.$id;if("leave"===a&&r.util.isFaElement(c)){var n=u(m);n&&n.id&&n.hide()}c.data(i)!==!1&&(c.data(i,!1),d===!1&&e[a].apply(f,l))};n.$$postDigest(function(){var e,n=c.scope(),r=u(n);if(r&&(e=r["$$animate"+o+"Handler"]),void 0===e)return void v();var a=e(n,{$done:v});"number"==typeof a&&t.setTimeout(v,a)})}}),c}])}]),angular.module("famous.angular").factory("$famousDecorator",["$famous",function(e){var n={child:{},parent:{},renderable:function(n){var r=e["famous/core/RenderNode"];n.renderGate=new r,n.emptyNode=new r,n.show=function(){n.renderGate&&n.renderGate.set(n.renderNode)},n.hide=function(){n.renderGate.set(n.emptyNode)}}},r={};return{addRole:function(e,r){n[e](r)},ensureIsolate:function(e,n){if(n){var a=["fa-edge-swapper","fa-render-controller","fa-deck","fa-light-box"],o=!1;angular.forEach(a,function(e){return e.toUpperCase()===n[0].tagName?void(o=!0):void 0!==n[0].attributes[e]?void(o=!0):void 0}),o&&(e=e.$parent)}e.isolate=e.isolate||{},e.isolate[e.$id]=e.isolate[e.$id]||{};var t=e.isolate[e.$id];t.id=e.$id;var i=e.$eval("$index");return i&&"$index"!==i&&!t.index&&(t.index=i),r[t.id]=t,t},$$getIsolateById:function(e){return r[e]},registerChild:function(e,n,r,a){e.$emit("registerChild",r),n.one("$destroy",function(){"removeMethod"in r&&r.removeMethod(r.id),r&&r.hide&&r.hide(),a&&a()})},sequenceWith:function(n,r,a,o){n.$on("registerChild",function(t,i){if(t.targetScope.$id!==n.$id){var s=e.getIsolate(n);i.$parent=s,s.$children=s.$children||[],s.$children.push(i),r(i),t.stopPropagation(),a&&(i.removeMethod=a),o&&(i.updateMethod=o)}})}}}]),angular.module("famous.angular").service("$famousPipe",function(){function e(e,n,r){e instanceof Array||(e=[e]),n instanceof Array||(n=[n]);for(var a=0;a<e.length;a++)for(var o=0;o<n.length;o++)void 0!==n[o]&&void 0!==e[a]&&n[o][r](e[a])}this.unpipesFromTargets=function(n,r){e(n,r,"unpipe")},this.pipesToTargets=function(n,r){e(n,r,"pipe")}}),angular.module("famous.angular").factory("$timeline",function(){var e=function(e,n){return"number"==typeof e?e+n:e.map(function(e,r){return e+n[r]})},n=function(e,n){return"number"==typeof e?e-n:e.map(function(e,r){return e-n[r]})},r=function(e,n){return"number"==typeof e?e*n:e.map(function(e){return e*n})},a=function(a,o,t,i,s){return function(u){var c=i,f=-o,l=1/(t-o),d=n(s,i);return e(r(d,a(l*(u+f))),c)}};return function(e){var n=function(e){return e};return function(r){if(r<e[0][0])return e[0][1];for(var o=0;o<e.length-1;o++)if(e[o][0]<=r&&r<e[o+1][0]){var t=a(e[o][2]||n,e[o][0],e[o+1][0],e[o][1],e[o+1][1]);return t(r)}return e[e.length-1][1]}}}),angular.module("famous.angular").directive("faAnimateEnter",["$parse","$famousDecorator",function(e,n){return{restrict:"A",scope:!1,priority:16,compile:function(){return{post:function(r,a,o){var t=n.ensureIsolate(r);t.$$animateEnterHandler=e(o.faAnimateEnter),o.$observe("faAnimateEnter",function(){t.$$animateEnterHandler=e(o.faAnimateEnter)})}}}}}]),angular.module("famous.angular").directive("faAnimateHalt",["$parse","$famousDecorator",function(e,n){return{restrict:"A",scope:!1,priority:16,compile:function(){return{post:function(r,a,o){var t=n.ensureIsolate(r);t.$$animateHaltHandler=e(o.faAnimateHalt),o.$observe("faAnimateHalt",function(){t.$$animateHaltHandler=e(o.faAnimateHalt)})}}}}}]),angular.module("famous.angular").directive("faAnimateLeave",["$parse","$famousDecorator",function(e,n){return{restrict:"A",scope:!1,priority:16,compile:function(){return{post:function(r,a,o){var t=n.ensureIsolate(r);t.$$animateLeaveHandler=e(o.faAnimateLeave),o.$observe("faAnimateLeave",function(){t.$$animateLeaveHandler=e(o.faAnimateLeave)})}}}}}]),angular.module("famous.angular").directive("faAnimateMove",["$parse","$famousDecorator",function(e,n){return{restrict:"A",scope:!1,priority:16,compile:function(){return{post:function(r,a,o){var t=n.ensureIsolate(r);t.$$animateMoveHandler=e(o.faAnimateMove),o.$observe("faAnimateMove",function(){t.$$animateMoveHandler=e(o.faAnimateMove)})}}}}}]),angular.module("famous.angular").directive("faAnimation",["$famous","$famousDecorator",function(e,n){return{restrict:"EA",scope:!0,compile:function(){var r=e["famous/core/Transform"],a=e["famous/transitions/Transitionable"],o=e["famous/transitions/Easing"];return{pre:function(e){n.ensureIsolate(e)},post:function(e,t,i){var s=n.ensureIsolate(e);setTimeout(function(){s.timeline=e.$eval(i.timeline),s._trans=new a(0),s.play=function(n){var r={duration:e.$eval(i.duration),curve:e.$eval(i.curve)||"linear"};s._trans.set(1,r,function(){n&&n(),i.loop&&setTimeout(function(){s.replay(n)},0)})},s.reset=function(){s._trans.set(0)},s.replay=function(e){s.reset(),s.play(e)};var n=null;i.event&&(n&&n(),n=e.$on(i.event,function(e,n){var r=n&&n.callback?n.callback:void 0;s.replay(r)}));i.id;if(void 0===s.timeline&&(s.timeline=s._trans.get.bind(s._trans),i.autoplay&&s.play()),!s.timeline instanceof Function)throw new Error("timeline must be a reference to a function or duration must be provided");for(var u=t[0].querySelectorAll("animate"),c={},f=0;f<u.length;f++)!function(){var n=u[f];if(n.attributes.targetmodselector){var a=angular.element(t[0].parentNode)[0].querySelectorAll(n.attributes.targetmodselector.value);angular.forEach(a,function(a){var t=angular.element(a).scope(),i=t.isolate[t.$id].modifier,u=t.isolate[t.$id].getTransform,f=n.attributes.curve&&"linear"!==n.attributes.curve.value?o[n.attributes.curve.value]:function(e){return e};if(n.attributes.field){var l=n.attributes.field.value,d=n.attributes.timelinelowerbound?parseFloat(n.attributes.timelinelowerbound.value):0,m=n.attributes.timelineupperbound?parseFloat(n.attributes.timelineupperbound.value):1;if(!n.attributes.startvalue)throw new Error("you must provide a start value for the animation");var p=e.$eval(n.attributes.startvalue.value);if(!n.attributes.endvalue)throw new Error("you must provide an end value for the animation");var v=e.$eval(n.attributes.endValue.value),g=c[t.$id]=c[t.$id]||{},h=g[l]=g[l]||[];h.push({field:l,lowerBound:d,upperBound:m,startValue:p,endValue:v,curve:f}),h.sort(function(e,n){return e.lowerBound-n.lowerBound});for(var $=1;$<h.length;$++)for(var y=h[$].lowerBound,w=0;$>w;w++)if(y<h[w].upperBound)throw new Error("Animate segments have overlappingdomains for the same field ("+l+").At any point in the timeline, only one <animate>can affect a given field on the same modifier.");var S=function(){for(var e=s.timeline()||0,n=0,r=h[n],a=0;a<h.length;a++){if(e>=h[a].lowerBound&&e<=h[a].upperBound){r=h[a];break}if(a===h.length-1){r=h[a];break}if(e>=h[a].upperBound&&e<h[a+1].lowerBound){r=h[a];break}}if(e<=r.lowerBound)return r.startValue;if(e>=r.upperBound)return r.endValue;var o=r.upperBound-r.lowerBound,t=(e-r.lowerBound)/o;if(Array.isArray(r.startValue)){for(var i=[],u=0;u<r.startValue.length;u++)i.push(r.startValue[u]+r.curve(t)*(r.endValue[u]-r.startValue[u]));return i}return r.startValue+r.curve(t)*(r.endValue-r.startValue)},b=g.transformComponents=g.transformComponents||[];"opacity"===l?i.opacityFrom(function(){return S()}):"origin"===l?i.originFrom(function(){return S()}):"size"===l?i.sizeFrom(function(){return S()}):(b.push({field:l,fn:S}),i.transformFrom(function(){for(var e={},n=u&&u()?[u()]:[],a=0;a<b.length;a++)!function(){var o=b[a].field;if(!e[o]){var t=b[a].fn();n.push(Array.isArray(t)?r[o].apply(this,t):r[o](t)),e[o]=!0}}();return 1===n.length?n[0]:r.multiply.apply(this,n)}))}})}}()},1)}}}}}]),angular.module("famous.angular").directive("faApp",["$famous","$famousDecorator",function(e,n){return{template:'<div style="display: none;"><div></div></div>',transclude:!0,scope:!0,restrict:"EA",compile:function(r,a,o){return{pre:function(r,a,o){function t(){s.apply(this,arguments)}{var i=n.ensureIsolate(r),s=e["famous/core/View"],u=e["famous/core/Engine"];e["famous/core/Transform"]}a.append('<div class="famous-angular-clipping-container"><div class="famous-angular-container"></div></div>'),i.context=u.createContext(a[0].querySelector(".famous-angular-container")),window.context=i.context;var c=function(){var e=parseInt(o.faPerspective);e&&i.context.setPerspective(e)};o.$observe("faPerspective",c),c(),t.prototype=Object.create(s.prototype),t.prototype.constructor=t;i.view=new t,i.context.add(i.view),r.$on("$destroy",function(){i.context.update=angular.noop}),r.$on("registerChild",function(e,n){i.view.add(n.renderNode),e.stopPropagation()})},post:function(e,r){var a=n.ensureIsolate(e);o(e,function(e){angular.element(r[0].querySelectorAll("div div")[0]).append(e)}),a.readyToRender=!0}}}}}]),angular.module("famous.angular").directive("faCanvasSurface",["$famous","$famousDecorator","$interpolate","$controller","$compile",function(e,n){return{scope:!0,transclude:!0,template:'<canvas class="fa-canvas-surface"></canvas>',restrict:"EA",compile:function(r,a,o){return{pre:function(r,a,o){{var t=n.ensureIsolate(r),i=e["famous/surfaces/CanvasSurface"];e["famous/core/Transform"],e["famous/core/EventHandler"]}t.renderNode=new i({size:r.$eval(o.faSize)}),n.addRole("renderable",t),t.show(),o.class&&t.renderNode.setClasses(o["class"].split(" ")),n.sequenceWith(r,function(){throw new Error("Surfaces are leaf nodes of the Famo.us render tree and cannot accept rendernode children.  To include additional Famo.us content inside of a fa-surface, that content must be enclosed in an additional fa-app.")})},post:function(e,r){var a=n.ensureIsolate(e),t=function(){a.renderNode.setContent(r[0].querySelector("canvas.fa-canvas-surface"))};t(),o(e,function(e){angular.element(r[0].querySelectorAll("canvas.fa-canvas-surface")).append(e)}),n.registerChild(e,r,a,function(){})}}}}}]),angular.module("famous.angular").directive("faClick",["$parse","$famousDecorator",function(e,n){return{restrict:"A",compile:function(){return{post:function(r,a,o){var t=n.ensureIsolate(r);if(o.faClick){var i=t.renderNode._eventInput||t.renderNode;i.on("click",function(n){var a=e(o.faClick);a(r,{$event:n}),r.$$phase||r.$apply()})}}}}}}]),angular.module("famous.angular").directive("faContainerSurface",["$famous","$famousDecorator",function(e,n){return{template:"<div></div>",restrict:"E",transclude:!0,scope:!0,compile:function(r,a,o){return{pre:function(r,a,o){var t=n.ensureIsolate(r),i=e["famous/surfaces/ContainerSurface"],s=r.$eval(o.faOptions)||{};t.renderNode=new i(s),n.addRole("renderable",t),t.show(),n.sequenceWith(r,function(e){t.renderNode.add(e.renderGate)})},post:function(e,r){var a=n.ensureIsolate(e);o(e,function(e){r.find("div").append(e)}),n.registerChild(e,r,a)}}}}}]),angular.module("famous.angular").directive("faDraggable",["$famous","$famousDecorator","$parse","$rootScope",function(e,n,r,a){return{template:"<div></div>",transclude:!0,restrict:"EA",priority:2,scope:!0,compile:function(r,o,t){return{post:function(r,o,i){var s=n.ensureIsolate(r),u=e["famous/core/RenderNode"],c=e["famous/modifiers/Draggable"],f=r.$eval(i.faOptions)||{};r.$watch(function(){return r.$eval(i.faOptions)},function(e){e=e||{},s.modifier.setOptions(e)},!0),s.modifier=new c(f),s.renderNode=(new u).add(s.modifier),n.addRole("renderable",s),s.show(),n.sequenceWith(r,function(e){s.renderNode.add(e.renderGate)}),t(r,function(e){o.find("div").append(e)}),n.registerChild(r,o,s,function(){s.modifier.deactivate()}),r.$$phase||a.$$phase||r.$apply()}}}}}]),angular.module("famous.angular").directive("faEdgeSwapper",["$famous","$famousDecorator",function(e,n){return{scope:!0,restrict:"A",priority:512,compile:function(){var r=e["famous/views/EdgeSwapper"];return{pre:function(e,a,o){var t,i=n.ensureIsolate(e);i.$$animateEnterHandler=function(e,n){i.renderNode.show(t,function(){i.$$leaveDoneCallback&&i.$$leaveDoneCallback(),n.$done()})},i.$$animateLeaveHandler=function(e,n){i.$$leaveDoneCallback=n.$done};var s=e.$eval(o.faOptions);i.renderNode=new r(s),n.addRole("renderable",i),i.show(),n.sequenceWith(e,function(e){t=e.renderGate})},post:function(e,r){var a=n.ensureIsolate(e);n.registerChild(e,r,a)}}}}}]),angular.module("famous.angular").directive("faFlexibleLayout",["$famous","$famousDecorator",function(e,n){return{template:"<div></div>",restrict:"E",transclude:!0,scope:!0,compile:function(r,a,o){return{pre:function(r,a,o){var t=n.ensureIsolate(r),i=e["famous/views/FlexibleLayout"],s=(e["famous/core/ViewSequence"],e["famous/core/RenderNode"],[]),u=r.$eval(o.faOptions)||{};t.renderNode=new i(u),n.addRole("renderable",t),t.show();var c=function(){s.sort(function(e,n){return e.index-n.index}),t.renderNode.sequenceFrom(function(e){var n=[];return angular.forEach(e,function(e,r){n[r]=e.renderGate}),n}(s))};n.sequenceWith(r,function(e){s.push(e),c()},function(e){s=function(n){var r=[];return angular.forEach(n,function(n){n.id!==e&&r.push(n)}),r}(s),c()})},post:function(e,r){var a=n.ensureIsolate(e);o(e,function(e){r.find("div").append(e)}),e.$emit("registerChild",a)}}}}}]),angular.module("famous.angular").directive("faFlipper",["$famous","$famousDecorator",function(e,n){return{template:"<div></div>",restrict:"E",transclude:!0,scope:!0,compile:function(r,a,o){return{pre:function(r,a,o){var t=n.ensureIsolate(r),i=e["famous/views/Flipper"],s=r.$eval(o.faOptions)||{};t.renderNode=new i(s),n.addRole("renderable",t),t.show(),t.children=[],t.flip=function(e){t.renderNode.flip(e||r.$eval(o.faOptions))},n.sequenceWith(r,function(e){var n=t.children.length;if(0===n)t.renderNode.setFront(e.renderGate);else{if(1!==n)throw new Error("fa-flipper accepts only two child elements; more than two have been provided");t.renderNode.setBack(e.renderGate)}t.children.push(e.renderGate)},function(){t.children.splice(t.children.length-1,1)})},post:function(e,r){var a=n.ensureIsolate(e);o(e,function(e){r.find("div").append(e)}),n.registerChild(e,r,a)}}}}}]),angular.module("famous.angular").directive("faGridLayout",["$famous","$famousDecorator",function(e,n){return{template:"<div></div>",restrict:"E",transclude:!0,scope:!0,compile:function(r,a,o){return{pre:function(r,a,o){var t=n.ensureIsolate(r),i=e["famous/views/GridLayout"],s=(e["famous/core/ViewSequence"],[]),u=r.$eval(o.faOptions)||{};t.renderNode=new i(u),n.addRole("renderable",t),t.show();var c=function(){r.$$postDigest(function(){s.sort(function(e,n){return e.index-n.index}),t.renderNode.sequenceFrom(function(e){var n=[];return angular.forEach(e,function(e,r){n[r]=e.renderGate}),n}(s))})};n.sequenceWith(r,function(e){s.push(e),c()},function(e){s=function(n){var r=[];return angular.forEach(n,function(n){n.id!==e&&r.push(n)}),r}(s),c()},c)},post:function(e,r){var a=n.ensureIsolate(e);o(e,function(e){r.find("div").append(e)}),n.registerChild(e,r,a)}}}}}]),angular.module("famous.angular").directive("faHeaderFooterLayout",["$famous","$famousDecorator",function(e,n){return{template:"<div></div>",restrict:"E",transclude:!0,scope:!0,compile:function(r,a,o){var t=e["famous/views/HeaderFooterLayout"],i=e["famous/core/RenderNode"];return{pre:function(e,r,a){var o=n.ensureIsolate(e),s=(new i,new i,new i,e.$eval(a.faOptions)||{});o.renderNode=new t(s),n.addRole("renderable",o),o.show();var u=0;n.sequenceWith(e,function(e){if(u++,1===u)o.renderNode.header.add(e.renderGate);else if(2===u)o.renderNode.content.add(e.renderGate);else{if(3!==u)throw new Error("fa-header-footer-layout can accept no more than 3 children");o.renderNode.footer.add(e.renderGate)}},function(){1===u?o.renderNode.header.set({}):2===u?o.renderNode.content.set({}):3===u&&o.renderNode.footer.set({}),u--})},post:function(e,r){var a=n.ensureIsolate(e);o(e,function(e){r.find("div").append(e)}),n.registerChild(e,r,a)}}}}}]),angular.module("famous.angular").directive("faImageSurface",["$famous","$famousDecorator",function(e,n){return{scope:!0,template:'<div class="fa-image-surface"></div>',restrict:"EA",compile:function(){return{pre:function(r,a,o){{var t=n.ensureIsolate(r),i=e["famous/surfaces/ImageSurface"];e["famous/core/Transform"],e["famous/core/EventHandler"]}r.$watch(function(){return t.getProperties()},function(){t.renderNode&&t.renderNode.setProperties(t.getProperties())},!0);var s=function(e){return"fa"+e.charAt(0).toUpperCase()+e.slice(1)};t.getProperties=function(){for(var e=r.$eval(o.faProperties)||{},n=["backgroundColor","color"],a=0;a<n.length;a++){var t=n[a],i=s(t);o[i]&&(e[t]=r.$eval(o[i]))}return e},t.renderNode=new i({size:r.$eval(o.faSize),"class":r.$eval(o.class),properties:t.getProperties()}),n.addRole("renderable",t),t.show(),o.class&&t.renderNode.setClasses(o["class"].split(" "))},post:function(e,r,a){var o=n.ensureIsolate(e),t=function(){o.renderNode.setContent(a.faImageUrl)};t(),a.$observe("faImageUrl",t),n.registerChild(e,r,o)}}}}}]),angular.module("famous.angular").directive("faIndex",["$parse","$famousDecorator",function(e,n){return{restrict:"A",scope:!1,priority:16,compile:function(){return{post:function(e,r,a){var o=n.ensureIsolate(e,r);o.index=e.$eval(a.faIndex),e.$watch(function(){return e.$eval(a.faIndex)},function(){o.index=e.$eval(a.faIndex),o.updateMethod&&o.updateMethod()})}}}}}]),angular.module("famous.angular").config(["$provide",function(e){e.decorator("ngClickDirective",["$delegate","$famousDecorator","$parse","$rootElement","$famous","$timeout",function(e,n,r,a,o,t){function i(e,n,r,a){return Math.abs(e-r)<$&&Math.abs(n-a)<$}function s(e,n,r){for(var a=0;a<e.length;a+=2)if(i(e[a],e[a+1],n,r))return e.splice(a,a+2),!0;return!1}function u(e){if(!(Date.now()-l>h)){var n=e.touches&&e.touches.length?e.touches:[e],r=n[0].clientX,a=n[0].clientY;s(d,r,a)||(e.stopPropagation(),e.preventDefault(),e.target&&e.target.blur())}}function c(e){var n=e.touches&&e.touches.length?e.touches:[e],r=n[0].clientX,a=n[0].clientY;d.push(r,a),t(function(){for(var e=0;e<d.length;e+=2)if(d[e]===r&&d[e+1]===a)return void d.splice(e,e+2)},h,!1)}function f(e,n){d||(a[0].addEventListener("click",u,!0),a[0].addEventListener("touchstart",c,!0),d=[]),l=Date.now(),s(d,e,n)}{var l,d,m=e[0],p=m.compile,v=750,g=12,h=2500,$=25,y="ng-click-active";o["famous/core/Engine"]}return m.compile=function(e,n,a){return o.util.isFaElement(e)?o.util.isASurface(e)?{post:function(e,n,a){function t(){d=!1,p.removeClass(y)}var i,s,u,c,l=r(a.ngClick),d=!1,m=o.getIsolate(e),p=m.renderNode;p.on("touchstart",function(e){d=!0,i=e.target?e.target:e.srcElement,3===i.nodeType&&(i=i.parentNode),p.addClass(y),s=Date.now();var n=e.touches&&e.touches.length?e.touches:[e],r=n[0].originalEvent||n[0];u=r.clientX,c=r.clientY}),p.on("touchmove",function(){t()}),p.on("touchcancel",function(){t()}),p.on("touchend",function(e){var n=Date.now()-s,r=e.changedTouches&&e.changedTouches.length?e.changedTouches:e.touches&&e.touches.length?e.touches:[e],o=r[0].originalEvent||r[0],i=o.clientX,l=o.clientY,m=Math.sqrt(Math.pow(i-u,2)+Math.pow(l-c,2));d&&v>n&&g>m&&(f(i,l),angular.isDefined(a.disabled)&&"false"!==a.disabled||p.emit("click",[e])),t()}),p.on("click",function(n,r){e.$apply(function(){l(e,{$event:r||n})})}),p.on("mousedown",function(){p.addClass(y)}),p.on("mousemove mouseup",function(){p.removeClass(y)})}}:void 0:p(e,n,a)},e}]),angular.forEach("dblclick mousedown mouseup mouseover mouseout mousemove mouseenter mouseleave keydown keyup keypress submit focus blur copy cut paste".split(" "),function(n){var r=window.$famousUtil.directiveNormalize("ng-"+n);e.decorator(r+"Directive",["$delegate","$famousDecorator","$parse","$famous",function(e,a,o,t){var i=e[0],s=i.compile;return i.compile=function(e,i,u){return t.util.isFaElement(e)?{post:function(e,t,i){var s=a.ensureIsolate(e);if(i[r]){var u=s.renderNode._eventInput||s.renderNode;u.on(n,function(n){var a=o(i[r]);a(e,{$event:n}),e.$$phase||e.$apply()})}}}:s(e,i,u)},e}])})}]),angular.module("famous.angular").directive("faModifier",["$famous","$famousDecorator","$parse","$rootScope",function(e,n,r,a){return{template:"<div></div>",transclude:!0,restrict:"EA",priority:2,scope:!0,compile:function(o,t,i){return{post:function(o,t,s){var u=n.ensureIsolate(o),c=e["famous/core/RenderNode"],f=e["famous/core/Modifier"],l=e["famous/core/Transform"],d=e["famous/physics/bodies/Particle"],m=function(e){return e.getPosition()},p=["aboutOrigin","perspective","rotate","rotateAxis","rotateX","rotateY","rotateZ","scale","skew","translate"];s.$observe("faTransformOrder",function(){var e=o.$eval(s.faTransformOrder);void 0!==e&&(p=e)});var v={};angular.forEach(p,function(n){var a=e.util.directiveNormalize("fa-"+n);s.$observe(a,function(){v[n]=r(s[a])})});var g=angular.noop;s.$observe("faTransform",function(){g=r(s.faTransform)}),u.getTransform=function(){var e=g(o);if(void 0!==e)return e instanceof Function?e():e instanceof Object&&void 0!==e.get?e.get():e;var n=[];return angular.forEach(p,function(e){var r=v[e]?v[e](o):void 0;void 0!==r&&(r instanceof Function&&(r=r()),n.push(r instanceof Array?l[e].apply(this,r):r instanceof d?l[e].apply(this,m(r)):l[e].call(this,r)))}),n.length?1===n.length?n[0]:l.multiply.apply(this,n):void 0};var h=angular.noop;s.$observe("faAlign",function(){h=r(s.faAlign)}),u.getAlign=function(){var e=h(o);return e instanceof Function?e():e instanceof Object&&void 0!==e.get?e.get():e instanceof d?m(e):e};var $=angular.noop;s.$observe("faOpacity",function(){$=r(s.faOpacity)}),u.getOpacity=function(){var e=$(o);return void 0===e?1:e instanceof Function?e():e instanceof Object&&void 0!==e.get?e.get():e instanceof d?m(e):e};var y=angular.noop;s.$observe("faSize",function(){y=r(s.faSize)}),u.getSize=function(){var e=y(o);return e instanceof Function?e():e instanceof Object&&void 0!==e.get?e.get():e instanceof d?m(e):e};var w=angular.noop;s.$observe("faOrigin",function(){w=r(s.faOrigin)}),u.getOrigin=function(){var e=w(o);return e instanceof Function?e():e instanceof Object&&void 0!==e.get?e.get():e instanceof d?m(e):e},u.modifier=new f({transform:u.getTransform,size:u.getSize,opacity:u.getOpacity,origin:u.getOrigin,align:u.getAlign}),u.renderNode=(new c).add(u.modifier),n.addRole("renderable",u),u.show(),n.sequenceWith(o,function(e){u.renderNode.add(e.renderGate)}),i(o,function(e){t.find("div").append(e)}),n.registerChild(o,t,u,function(){u.modifier.setOpacity(0)}),o.$$phase||a.$$phase||o.$apply()}}}}}]),angular.module("famous.angular").directive("faMouseover",["$parse","$famousDecorator",function(e,n){return{restrict:"A",scope:!1,compile:function(){return{post:function(r,a,o){var t=n.ensureIsolate(r);if(o.faMouseover){var i=t.renderNode._eventInput||t.renderNode;i.on("mouseover",function(n){var a=e(o.faMouseover);a(r,{$event:n}),r.$$phase||r.$apply()})}}}}}}]),angular.module("famous.angular").directive("faOptions",["$parse","$famousDecorator",function(e,n){return{restrict:"A",scope:!1,priority:-16,compile:function(){return{post:function(e,r,a){var o=n.ensureIsolate(e,r);e.$watch(function(){return e.$eval(a.faOptions)},function(){o.renderNode.setOptions(e.$eval(a.faOptions))},!0)}}}}}]),angular.module("famous.angular").directive("faPipeFrom",["$famous","$famousDecorator","$famousPipe",function(e,n,r){return{restrict:"A",scope:!1,priority:16,compile:function(){var a=e["famous/core/Engine"];return{post:function(e,o,t){var i=n.ensureIsolate(e);e.$watch(function(){return e.$eval(t.faPipeFrom)},function(e,n){var o;o=i.renderNode&&i.renderNode._isModifier?i.renderNode._object:i.renderNode?i.renderNode._eventInput||i.renderNode:a,r.unpipesFromTargets(o,n),r.pipesToTargets(o,e)}),e.$on("$destroy",function(){r.unpipesFromTargets(i.renderNode||a,e.$eval(t.faPipeFrom))})}}}}}]),angular.module("famous.angular").directive("faPipeTo",["$famous","$famousDecorator","$famousPipe",function(e,n,r){return{restrict:"A",scope:!1,priority:16,compile:function(){var a=e["famous/core/Engine"];return{post:function(e,o,t){var i=n.ensureIsolate(e);e.$watch(function(){return e.$eval(t.faPipeTo)},function(e,n){var o;o=i.renderNode&&i.renderNode._isModifier?i.renderNode._object:i.renderNode?i.renderNode._eventOutput||i.renderNode:a,r.unpipesFromTargets(n,o),r.pipesToTargets(e,o)}),e.$on("$destroy",function(){r.unpipesFromTargets(e.$eval(t.faPipeTo),i.renderNode||a)})}}}}}]),angular.module("famous.angular").directive("faRenderNode",["$famous","$famousDecorator",function(e,n){return{template:"<div></div>",transclude:!0,scope:!0,restrict:"EA",compile:function(r,a,o){return{pre:function(r,a,o){{var t=n.ensureIsolate(r),i=e["famous/core/Engine"];
e["famous/core/RenderNode"]}t.children=[],o.$observe("faPipeTo",function(e){var n=r.$eval(e);n&&i.pipe(n)}),t.renderNode=r.$eval(o.faNode),n.addRole("renderable",t),t.show(),n.sequenceWith(r,function(e){t.renderNode.add(e.renderGate),t.children.push(e)})},post:function(e,r){var a=n.ensureIsolate(e);o(e,function(e){r.find("div").append(e)}),n.registerChild(e,r,a)}}}}}]),angular.module("famous.angular").directive("faScrollView",["$famous","$famousDecorator",function(e,n){return{template:"<div></div>",restrict:"E",transclude:!0,scope:!0,compile:function(r,a,o){return{pre:function(r,a,o){var t=n.ensureIsolate(r),i=e["famous/views/Scrollview"],s=e["famous/core/ViewSequence"],u=(e["famous/core/Surface"],[]),c=r.$eval(o.faOptions)||{};t.renderNode=new i(c),n.addRole("renderable",t),t.show();var f=function(e){r.$$postDigest(function(){u.sort(function(e,n){return e.index-n.index});var n={array:function(e){var n=[];return angular.forEach(e,function(e,r){n[r]=e.renderGate}),n}(u)};e&&(n.index=r.$eval(o.faStartIndex));var a=new s(n);t.renderNode.sequenceFrom(a)})};n.sequenceWith(r,function(e){u.push(e),f(!0)},function(e){u=function(n){var r=[];return angular.forEach(n,function(n){n.id!==e&&r.push(n)}),r}(u),f()},f)},post:function(e,r){var a=n.ensureIsolate(e);o(e,function(e){r.find("div").append(e)}),n.registerChild(e,r,a)}}}}}]),angular.module("famous.angular").directive("faSequentialLayout",["$famous","$famousDecorator",function(e,n){return{template:"<div></div>",restrict:"E",transclude:!0,scope:!0,compile:function(r,a,o){return window.$f=e,{pre:function(r,a,o){var t=n.ensureIsolate(r),i=e["famous/views/SequentialLayout"],s=[],u=r.$eval(o.faOptions)||{};t.renderNode=new i(u),n.addRole("renderable",t),t.show();var c=function(){s.sort(function(e,n){return e.index-n.index}),t.renderNode.sequenceFrom(function(e){var n=[];return angular.forEach(e,function(e,r){n[r]=e.renderGate}),n}(s))};n.sequenceWith(r,function(e){s.push(e),c()},function(e){s=function(n){var r=[];return angular.forEach(n,function(n){n.id!==e&&r.push(n)}),r}(s),c()})},post:function(e,r){var a=n.ensureIsolate(e);o(e,function(e){r.find("div").append(e)}),n.registerChild(e,r,a)}}}}}]),angular.module("famous.angular").directive("faSurface",["$famous","$famousDecorator","$interpolate","$controller","$compile",function(e,n){return{scope:!0,transclude:!0,template:'<div class="fa-surface"></div>',restrict:"EA",compile:function(r,a,o){return{pre:function(r,a,o){{var t=n.ensureIsolate(r),i=e["famous/core/Surface"];e["famous/core/Transform"],e["famous/core/EventHandler"]}r.$watch(function(){return t.getProperties()},function(){t.renderNode&&t.renderNode.setProperties(t.getProperties())},!0);var s=function(e){return"fa"+e.charAt(0).toUpperCase()+e.slice(1)};t.getProperties=function(){for(var e=r.$eval(o.faProperties)||{},n=["backgroundColor","margin","padding","color","pointerEvents","zIndex"],a=0;a<n.length;a++){var t=n[a],i=s(t);o[i]&&(e[t]=r.$eval(o[i]))}return e};var u=[];o.$observe("faSize",function(){t.renderNode.setSize(r.$eval(o.faSize)),u.push(new Date),u.length>5&&(u[4]-u[0]<=1e3&&console.warn("Using fa-size on fa-surface to animate is significantly non-performant, prefer to use fa-size on an fa-modifier surrounding a fa-surface"),u.shift())}),t.renderNode=new i({size:r.$eval(o.faSize),properties:t.getProperties()}),n.addRole("renderable",t),t.show(),o.class&&t.renderNode.setClasses(o["class"].split(" ")),n.sequenceWith(r,function(){throw new Error("Surfaces are leaf nodes of the Famo.us render tree and cannot accept rendernode children.  To include additional Famo.us content inside of a fa-surface, that content must be enclosed in an additional fa-app.")})},post:function(e,r){var a=n.ensureIsolate(e),t=function(){a.renderNode.setContent(r[0].querySelector("div.fa-surface"))};t(),o(e,function(e){angular.element(r[0].querySelectorAll("div.fa-surface")).append(e)}),n.registerChild(e,r,a,function(){})}}}}}]),angular.module("famous.angular").directive("faTap",["$parse","$famousDecorator",function(e,n){return{restrict:"A",compile:function(){return{post:function(r,a,o){var t=n.ensureIsolate(r);if(o.faTap){var i=t.renderNode._eventInput||t.renderNode,s=!1;i.on("touchmove",function(e){return s=!0,e}),i.on("tap",function(n){if(!s){var a=e(o.faTap);a(r,{$event:n}),r.$$phase||r.$apply()}s=!1})}}}}}}]),angular.module("famous.angular").directive("faTouchend",["$parse","$famousDecorator",function(e,n){return{restrict:"A",scope:!1,compile:function(){return{post:function(r,a,o){var t=n.ensureIsolate(r);if(o.faTouchend){var i=t.renderNode._eventInput||t.renderNode;i.on("touchend",function(n){var a=e(o.faTouchend);a(r,{$event:n}),r.$$phase||r.$apply()})}}}}}}]),angular.module("famous.angular").directive("faTouchmove",["$parse","$famousDecorator",function(e,n){return{restrict:"A",scope:!1,compile:function(){return{post:function(r,a,o){var t=n.ensureIsolate(r);if(o.faTouchmove){var i=t.renderNode._eventInput||t.renderNode;i.on("touchmove",function(n){var a=e(o.faTouchmove);a(r,{$event:n}),r.$$phase||r.$apply()})}}}}}}]),angular.module("famous.angular").directive("faTouchstart",["$parse","$famousDecorator",function(e,n){return{restrict:"A",scope:!1,compile:function(){return{post:function(r,a,o){var t=n.ensureIsolate(r);if(o.faTouchstart){var i=t.renderNode._eventInput||t.renderNode;i.on("touchstart",function(n){var a=e(o.faTouchstart);a(r,{$event:n}),r.$$phase||r.$apply()})}}}}}}]),angular.module("famous.angular").directive("faVideoSurface",["$famous","$famousDecorator",function(e,n){return{scope:!0,transclude:!0,template:'<div class="fa-video-surface"></div>',restrict:"EA",compile:function(){return{pre:function(r,a,o){var t=n.ensureIsolate(r),i=e["famous/surfaces/VideoSurface"];r.$watch(function(){return r.$eval(o.faOptions)},function(e,n){t.renderNode.setOptions(n)},!0),t.renderNode=new i({"class":r.$eval(o.class)}),n.addRole("renderable",t),t.show(),o.class&&t.renderNode.setClasses(o["class"].split(" ")),n.sequenceWith(r,function(){throw new Error("Surfaces are leaf nodes of the Famo.us render tree and cannot accept rendernode children.  To include additional Famo.us content inside of a fa-surface, that content must be enclosed in an additional fa-app.")})},post:function(e,r,a){var o=n.ensureIsolate(e),t=function(){o.renderNode.setContent(a.faVideoUrl)};t(),a.$observe("faVideoUrl",t),n.registerChild(e,r,o)}}}}}]),angular.module("famous.angular").directive("faView",["$famous","$famousDecorator",function(e,n){return{template:"<div></div>",transclude:!0,scope:!0,restrict:"EA",compile:function(r,a,o){var t=e["famous/core/View"];return{pre:function(e,r,a){var o=n.ensureIsolate(e);o.children=[],o.renderNode=new t({size:e.$eval(a.faSize)||[void 0,void 0]}),n.addRole("renderable",o),o.show(),n.sequenceWith(e,function(e){o.renderNode.add(e.renderGate),o.children.push(e)})},post:function(e,r){var a=n.ensureIsolate(e);o(e,function(e){r.find("div").append(e)}),n.registerChild(e,r,a)}}}}}]);
}).call(global, module, undefined, undefined);

}).call(this,typeof global !== "undefined" ? global : typeof self !== "undefined" ? self : typeof window !== "undefined" ? window : {})
},{"/home/ubuntu/workspace/bower_components/angular-animate/angular-animate.min.js":"/home/ubuntu/workspace/bower_components/angular-animate/angular-animate.min.js","/home/ubuntu/workspace/bower_components/angular-sanitize/angular-sanitize.min.js":"/home/ubuntu/workspace/bower_components/angular-sanitize/angular-sanitize.min.js","/home/ubuntu/workspace/bower_components/angular-ui-router/release/angular-ui-router.min.js":"/home/ubuntu/workspace/bower_components/angular-ui-router/release/angular-ui-router.min.js","/home/ubuntu/workspace/bower_components/angular/angular.min.js":"/home/ubuntu/workspace/bower_components/angular/angular.min.js","/home/ubuntu/workspace/bower_components/famous/dist/famous-global.min.js":"/home/ubuntu/workspace/bower_components/famous/dist/famous-global.min.js","famous-polyfills":"/home/ubuntu/workspace/node_modules/famous-polyfills/index.js"}],"/home/ubuntu/workspace/bower_components/famous/dist/famous-global.min.js":[function(require,module,exports){
(function (global){
;__browserify_shim_require__=require;(function browserifyShim(module, exports, require, define, browserify_shim__define__module__export__) {
/* This Source Code Form is subject to the terms of the Mozilla Public
 * License, v. 2.0. If a copy of the MPL was not distributed with this
 * file, You can obtain one at http://mozilla.org/MPL/2.0/.
 *
 * @copyright Famous Industries, Inc. 2014
 */
!function(t){if("object"==typeof exports&&"undefined"!=typeof module)module.exports=t();else if("function"==typeof define&&define.amd)define([],t);else{var i;"undefined"!=typeof window?i=window:"undefined"!=typeof global?i=global:"undefined"!=typeof self&&(i=self),i.famous=t()}}(function(){return function t(i,e,n){function o(r,a){if(!e[r]){if(!i[r]){var h="function"==typeof require&&require;if(!a&&h)return h(r,!0);if(s)return s(r,!0);var c=new Error("Cannot find module '"+r+"'");throw c.code="MODULE_NOT_FOUND",c}var p=e[r]={exports:{}};i[r][0].call(p.exports,function(t){var e=i[r][1][t];return o(e?e:t)},p,p.exports,t,i,e,n)}return e[r].exports}for(var s="function"==typeof require&&require,r=0;r<n.length;r++)o(n[r]);return o}({1:[function(t,i){function e(t){return[t.clientWidth,t.clientHeight]}function n(t){this.container=t,this._allocator=new r(t),this._node=new o,this._eventOutput=new s,this._size=e(this.container),this._perspectiveState=new h(0),this._perspective=void 0,this._nodeContext={allocator:this._allocator,transform:a.identity,opacity:1,origin:c,align:c,size:this._size},this._eventOutput.on("resize",function(){this.setSize(e(this.container))}.bind(this))}var o=t("./RenderNode"),s=t("./EventHandler"),r=t("./ElementAllocator"),a=t("./Transform"),h=t("../transitions/Transitionable"),c=[0,0],p=!("perspective"in document.documentElement.style),u=p?function(t,i){t.style.webkitPerspective=i?i.toFixed()+"px":""}:function(t,i){t.style.perspective=i?i.toFixed()+"px":""};n.prototype.getAllocator=function(){return this._allocator},n.prototype.add=function(t){return this._node.add(t)},n.prototype.migrate=function(t){t!==this.container&&(this.container=t,this._allocator.migrate(t))},n.prototype.getSize=function(){return this._size},n.prototype.setSize=function(t){t||(t=e(this.container)),this._size[0]=t[0],this._size[1]=t[1]},n.prototype.update=function(t){t&&(t.transform&&(this._nodeContext.transform=t.transform),t.opacity&&(this._nodeContext.opacity=t.opacity),t.origin&&(this._nodeContext.origin=t.origin),t.align&&(this._nodeContext.align=t.align),t.size&&(this._nodeContext.size=t.size));var i=this._perspectiveState.get();i!==this._perspective&&(u(this.container,i),this._perspective=i),this._node.commit(this._nodeContext)},n.prototype.getPerspective=function(){return this._perspectiveState.get()},n.prototype.setPerspective=function(t,i,e){return this._perspectiveState.set(t,i,e)},n.prototype.emit=function(t,i){return this._eventOutput.emit(t,i)},n.prototype.on=function(t,i){return this._eventOutput.on(t,i)},n.prototype.removeListener=function(t,i){return this._eventOutput.removeListener(t,i)},n.prototype.pipe=function(t){return this._eventOutput.pipe(t)},n.prototype.unpipe=function(t){return this._eventOutput.unpipe(t)},i.exports=n},{"../transitions/Transitionable":88,"./ElementAllocator":2,"./EventHandler":7,"./RenderNode":11,"./Transform":15}],2:[function(t,i){function e(t){t||(t=document.createDocumentFragment()),this.container=t,this.detachedNodes={},this.nodeCount=0}e.prototype.migrate=function(t){var i=this.container;if(t!==i){if(i instanceof DocumentFragment)t.appendChild(i);else for(;i.hasChildNodes();)t.appendChild(i.removeChild(i.firstChild));this.container=t}},e.prototype.allocate=function(t){t=t.toLowerCase(),t in this.detachedNodes||(this.detachedNodes[t]=[]);var i,e=this.detachedNodes[t];return e.length>0?i=e.pop():(i=document.createElement(t),this.container.appendChild(i)),this.nodeCount++,i},e.prototype.deallocate=function(t){var i=t.nodeName.toLowerCase(),e=this.detachedNodes[i];e.push(t),this.nodeCount--},e.prototype.getNodeCount=function(){return this.nodeCount},i.exports=e},{}],3:[function(t,i){function e(t){this._matrix=null,this._opacity=1,this._origin=null,this._size=null,this._eventOutput=new c,this._eventOutput.bindThis(this),this.eventForwarder=function(t){this._eventOutput.emit(t.type,t)}.bind(this),this.id=h.register(this),this._element=null,this._sizeDirty=!1,this._originDirty=!1,this._transformDirty=!1,this._invisible=!1,t&&this.attach(t)}function n(t){for(var i in this._eventOutput.listeners)t.addEventListener(i,this.eventForwarder)}function o(t){for(var i in this._eventOutput.listeners)t.removeEventListener(i,this.eventForwarder)}function s(t){t[12]=Math.round(t[12]*l)/l,t[13]=Math.round(t[13]*l)/l;for(var i="matrix3d(",e=0;15>e;e++)i+=t[e]<1e-6&&t[e]>-1e-6?"0,":t[e]+",";return i+=t[15]+")"}function r(t){return 100*t[0]+"% "+100*t[1]+"%"}function a(t,i){return t&&i?t[0]!==i[0]||t[1]!==i[1]:t!==i}var h=t("./Entity"),c=t("./EventHandler"),p=t("./Transform"),u=!("transform"in document.documentElement.style),l=window.devicePixelRatio||1;e.prototype.on=function(t,i){this._element&&this._element.addEventListener(t,this.eventForwarder),this._eventOutput.on(t,i)},e.prototype.removeListener=function(t,i){this._eventOutput.removeListener(t,i)},e.prototype.emit=function(t,i){i&&!i.origin&&(i.origin=this);var e=this._eventOutput.emit(t,i);return e&&i&&i.stopPropagation&&i.stopPropagation(),e},e.prototype.pipe=function(t){return this._eventOutput.pipe(t)},e.prototype.unpipe=function(t){return this._eventOutput.unpipe(t)},e.prototype.render=function(){return this.id};var f;f=navigator.userAgent.toLowerCase().indexOf("firefox")>-1?function(t,i){t.style.zIndex=1e6*i[14]|0,t.style.transform=s(i)}:u?function(t,i){t.style.webkitTransform=s(i)}:function(t,i){t.style.transform=s(i)};var d=u?function(t,i){t.style.webkitTransformOrigin=r(i)}:function(t,i){t.style.transformOrigin=r(i)},_=u?function(t){t.style.webkitTransform="scale3d(0.0001,0.0001,0.0001)",t.style.opacity=0}:function(t){t.style.transform="scale3d(0.0001,0.0001,0.0001)",t.style.opacity=0};e.prototype.commit=function(t){var i=this._element;if(i){{var e=t.transform,n=t.opacity,o=t.origin;t.size}if(!e&&this._matrix)return this._matrix=null,this._opacity=0,void _(i);if(a(this._origin,o)&&(this._originDirty=!0),p.notEquals(this._matrix,e)&&(this._transformDirty=!0),this._invisible&&(this._invisible=!1,this._element.style.display=""),this._opacity!==n&&(this._opacity=n,i.style.opacity=n>=1?"0.999999":n),this._transformDirty||this._originDirty||this._sizeDirty){this._sizeDirty&&(this._sizeDirty=!1),this._originDirty&&(o?(this._origin||(this._origin=[0,0]),this._origin[0]=o[0],this._origin[1]=o[1]):this._origin=null,d(i,this._origin),this._originDirty=!1),e||(e=p.identity),this._matrix=e;var s=this._size?p.thenMove(e,[-this._size[0]*o[0],-this._size[1]*o[1],0]):e;f(i,s),this._transformDirty=!1}}},e.prototype.cleanup=function(){this._element&&(this._invisible=!0,this._element.style.display="none")},e.prototype.attach=function(t){this._element=t,n.call(this,t)},e.prototype.detach=function(){var t=this._element;return t&&(o.call(this,t),this._invisible&&(this._invisible=!1,this._element.style.display="")),this._element=null,t},i.exports=e},{"./Entity":5,"./EventHandler":7,"./Transform":15}],4:[function(t,i){function e(){v.runLoop?(p.step(),window.requestAnimationFrame(e)):_=!1}function n(){for(var t=0;t<u.length;t++)u[t].emit("resize");g.emit("resize")}function o(){window.addEventListener("touchmove",function(t){t.preventDefault()},!0),document.body.classList.add("famous-root"),document.documentElement.classList.add("famous-root")}var s,r,a=t("./Context"),h=t("./EventHandler"),c=t("./OptionsManager"),p={},u=[],l=[],f=[],d=Date.now(),_=!0,y={},g=new h,v={containerType:"div",containerClass:"famous-container",fpsCap:void 0,runLoop:!0,appMode:!0},m=new c(v),O=10;p.step=function(){var t=Date.now();if(!(r&&r>t-d)){var i=0;for(s=t-d,d=t,g.emit("prerender"),i=0;i<l.length;i++)l[i].call(this);for(l.splice(0);f.length&&Date.now()-t<O;)f.shift().call(this);for(i=0;i<u.length;i++)u[i].update();g.emit("postrender")}},window.requestAnimationFrame(e),window.addEventListener("resize",n,!1),n();var S=!1;p.pipe=function(t){return t.subscribe instanceof Function?t.subscribe(p):g.pipe(t)},p.unpipe=function(t){return t.unsubscribe instanceof Function?t.unsubscribe(p):g.unpipe(t)},p.on=function(t,i){return t in y||(y[t]=g.emit.bind(g,t),document.body?document.body.addEventListener(t,y[t]):p.nextTick(function(t,i){document.body.addEventListener(t,i)}.bind(this,t,y[t]))),g.on(t,i)},p.emit=function(t,i){return g.emit(t,i)},p.removeListener=function(t,i){return g.removeListener(t,i)},p.getFPS=function(){return 1e3/s},p.setFPSCap=function(t){r=Math.floor(1e3/t)},p.getOptions=function(t){return m.getOptions(t)},p.setOptions=function(){return m.setOptions.apply(m,arguments)},p.createContext=function(t){!S&&v.appMode&&p.nextTick(o);var i=!1;t||(t=document.createElement(v.containerType),t.classList.add(v.containerClass),i=!0);var e=new a(t);return p.registerContext(e),i&&p.nextTick(function(t,i){document.body.appendChild(i),t.emit("resize")}.bind(this,e,t)),e},p.registerContext=function(t){return u.push(t),t},p.getContexts=function(){return u},p.deregisterContext=function(t){var i=u.indexOf(t);i>=0&&u.splice(i,1)},p.nextTick=function(t){l.push(t)},p.defer=function(t){f.push(t)},m.on("change",function(t){"fpsCap"===t.id?p.setFPSCap(t.value):"runLoop"===t.id&&!_&&t.value&&(_=!0,window.requestAnimationFrame(e))}),i.exports=p},{"./Context":1,"./EventHandler":7,"./OptionsManager":10}],5:[function(t,i){function e(t){return r[t]}function n(t,i){r[t]=i}function o(t){var i=r.length;return n(i,t),i}function s(t){n(t,null)}var r=[];i.exports={register:o,unregister:s,get:e,set:n}},{}],6:[function(t,i){function e(){this.listeners={},this._owner=this}e.prototype.emit=function(t,i){var e=this.listeners[t];if(e)for(var n=0;n<e.length;n++)e[n].call(this._owner,i);return this},e.prototype.on=function(t,i){t in this.listeners||(this.listeners[t]=[]);var e=this.listeners[t].indexOf(i);return 0>e&&this.listeners[t].push(i),this},e.prototype.addListener=e.prototype.on,e.prototype.removeListener=function(t,i){var e=this.listeners[t];if(void 0!==e){var n=e.indexOf(i);n>=0&&e.splice(n,1)}return this},e.prototype.bindThis=function(t){this._owner=t},i.exports=e},{}],7:[function(t,i){function e(){n.apply(this,arguments),this.downstream=[],this.downstreamFn=[],this.upstream=[],this.upstreamListeners={}}var n=t("./EventEmitter");e.prototype=Object.create(n.prototype),e.prototype.constructor=e,e.setInputHandler=function(t,i){t.trigger=i.trigger.bind(i),i.subscribe&&i.unsubscribe&&(t.subscribe=i.subscribe.bind(i),t.unsubscribe=i.unsubscribe.bind(i))},e.setOutputHandler=function(t,i){i instanceof e&&i.bindThis(t),t.pipe=i.pipe.bind(i),t.unpipe=i.unpipe.bind(i),t.on=i.on.bind(i),t.addListener=t.on,t.removeListener=i.removeListener.bind(i)},e.prototype.emit=function(t,i){n.prototype.emit.apply(this,arguments);var e=0;for(e=0;e<this.downstream.length;e++)this.downstream[e].trigger&&this.downstream[e].trigger(t,i);for(e=0;e<this.downstreamFn.length;e++)this.downstreamFn[e](t,i);return this},e.prototype.trigger=e.prototype.emit,e.prototype.pipe=function(t){if(t.subscribe instanceof Function)return t.subscribe(this);var i=t instanceof Function?this.downstreamFn:this.downstream,e=i.indexOf(t);return 0>e&&i.push(t),t instanceof Function?t("pipe",null):t.trigger&&t.trigger("pipe",null),t},e.prototype.unpipe=function(t){if(t.unsubscribe instanceof Function)return t.unsubscribe(this);var i=t instanceof Function?this.downstreamFn:this.downstream,e=i.indexOf(t);return e>=0?(i.splice(e,1),t instanceof Function?t("unpipe",null):t.trigger&&t.trigger("unpipe",null),t):!1},e.prototype.on=function(t){if(n.prototype.on.apply(this,arguments),!(t in this.upstreamListeners)){var i=this.trigger.bind(this,t);this.upstreamListeners[t]=i;for(var e=0;e<this.upstream.length;e++)this.upstream[e].on(t,i)}return this},e.prototype.addListener=e.prototype.on,e.prototype.subscribe=function(t){var i=this.upstream.indexOf(t);if(0>i){this.upstream.push(t);for(var e in this.upstreamListeners)t.on(e,this.upstreamListeners[e])}return this},e.prototype.unsubscribe=function(t){var i=this.upstream.indexOf(t);if(i>=0){this.upstream.splice(i,1);for(var e in this.upstreamListeners)t.removeListener(e,this.upstreamListeners[e])}return this},i.exports=e},{"./EventEmitter":6}],8:[function(t,i){function e(t){s.call(this,t),this._shouldRecalculateSize=!1,this._container=document.createDocumentFragment(),this.context=new n(this._container),this.setContent(this._container),this._groupSize=[void 0,void 0]}var n=t("./Context"),o=t("./Transform"),s=t("./Surface");e.SIZE_ZERO=[0,0],e.prototype=Object.create(s.prototype),e.prototype.elementType="div",e.prototype.elementClass="famous-group",e.prototype.add=function(){return this.context.add.apply(this.context,arguments)},e.prototype.render=function(){return s.prototype.render.call(this)},e.prototype.deploy=function(t){this.context.migrate(t)},e.prototype.recall=function(){this._container=document.createDocumentFragment(),this.context.migrate(this._container)},e.prototype.commit=function(t){var i=t.transform,n=t.origin,r=t.opacity,a=t.size,h=s.prototype.commit.call(this,{allocator:t.allocator,transform:o.thenMove(i,[-n[0]*a[0],-n[1]*a[1],0]),opacity:r,origin:n,size:e.SIZE_ZERO});return(a[0]!==this._groupSize[0]||a[1]!==this._groupSize[1])&&(this._groupSize[0]=a[0],this._groupSize[1]=a[1],this.context.setSize(a)),this.context.update({transform:o.translate(-n[0]*a[0],-n[1]*a[1],0),origin:n,size:a}),h},i.exports=e},{"./Context":1,"./Surface":14,"./Transform":15}],9:[function(t,i){function e(t){this._transformGetter=null,this._opacityGetter=null,this._originGetter=null,this._alignGetter=null,this._sizeGetter=null,this._proportionGetter=null,this._legacyStates={},this._output={transform:o.identity,opacity:1,origin:null,align:null,size:null,proportions:null,target:null},t&&(t.transform&&this.transformFrom(t.transform),void 0!==t.opacity&&this.opacityFrom(t.opacity),t.origin&&this.originFrom(t.origin),t.align&&this.alignFrom(t.align),t.size&&this.sizeFrom(t.size),t.proportions&&this.proportionsFrom(t.proportions))}function n(){this._transformGetter&&(this._output.transform=this._transformGetter()),this._opacityGetter&&(this._output.opacity=this._opacityGetter()),this._originGetter&&(this._output.origin=this._originGetter()),this._alignGetter&&(this._output.align=this._alignGetter()),this._sizeGetter&&(this._output.size=this._sizeGetter()),this._proportionGetter&&(this._output.proportions=this._proportionGetter())}var o=t("./Transform"),s=t("../transitions/Transitionable"),r=t("../transitions/TransitionableTransform");e.prototype.transformFrom=function(t){return t instanceof Function?this._transformGetter=t:t instanceof Object&&t.get?this._transformGetter=t.get.bind(t):(this._transformGetter=null,this._output.transform=t),this},e.prototype.opacityFrom=function(t){return t instanceof Function?this._opacityGetter=t:t instanceof Object&&t.get?this._opacityGetter=t.get.bind(t):(this._opacityGetter=null,this._output.opacity=t),this},e.prototype.originFrom=function(t){return t instanceof Function?this._originGetter=t:t instanceof Object&&t.get?this._originGetter=t.get.bind(t):(this._originGetter=null,this._output.origin=t),this},e.prototype.alignFrom=function(t){return t instanceof Function?this._alignGetter=t:t instanceof Object&&t.get?this._alignGetter=t.get.bind(t):(this._alignGetter=null,this._output.align=t),this},e.prototype.sizeFrom=function(t){return t instanceof Function?this._sizeGetter=t:t instanceof Object&&t.get?this._sizeGetter=t.get.bind(t):(this._sizeGetter=null,this._output.size=t),this},e.prototype.proportionsFrom=function(t){return t instanceof Function?this._proportionGetter=t:t instanceof Object&&t.get?this._proportionGetter=t.get.bind(t):(this._proportionGetter=null,this._output.proportions=t),this},e.prototype.setTransform=function(t,i,e){return i||this._legacyStates.transform?(this._legacyStates.transform||(this._legacyStates.transform=new r(this._output.transform)),this._transformGetter||this.transformFrom(this._legacyStates.transform),this._legacyStates.transform.set(t,i,e),this):this.transformFrom(t)},e.prototype.setOpacity=function(t,i,e){return i||this._legacyStates.opacity?(this._legacyStates.opacity||(this._legacyStates.opacity=new s(this._output.opacity)),this._opacityGetter||this.opacityFrom(this._legacyStates.opacity),this._legacyStates.opacity.set(t,i,e)):this.opacityFrom(t)},e.prototype.setOrigin=function(t,i,e){return i||this._legacyStates.origin?(this._legacyStates.origin||(this._legacyStates.origin=new s(this._output.origin||[0,0])),this._originGetter||this.originFrom(this._legacyStates.origin),this._legacyStates.origin.set(t,i,e),this):this.originFrom(t)},e.prototype.setAlign=function(t,i,e){return i||this._legacyStates.align?(this._legacyStates.align||(this._legacyStates.align=new s(this._output.align||[0,0])),this._alignGetter||this.alignFrom(this._legacyStates.align),this._legacyStates.align.set(t,i,e),this):this.alignFrom(t)},e.prototype.setSize=function(t,i,e){return t&&(i||this._legacyStates.size)?(this._legacyStates.size||(this._legacyStates.size=new s(this._output.size||[0,0])),this._sizeGetter||this.sizeFrom(this._legacyStates.size),this._legacyStates.size.set(t,i,e),this):this.sizeFrom(t)},e.prototype.setProportions=function(t,i,e){return t&&(i||this._legacyStates.proportions)?(this._legacyStates.proportions||(this._legacyStates.proportions=new s(this._output.proportions||[0,0])),this._proportionGetter||this.proportionsFrom(this._legacyStates.proportions),this._legacyStates.proportions.set(t,i,e),this):this.proportionsFrom(t)},e.prototype.halt=function(){this._legacyStates.transform&&this._legacyStates.transform.halt(),this._legacyStates.opacity&&this._legacyStates.opacity.halt(),this._legacyStates.origin&&this._legacyStates.origin.halt(),this._legacyStates.align&&this._legacyStates.align.halt(),this._legacyStates.size&&this._legacyStates.size.halt(),this._legacyStates.proportions&&this._legacyStates.proportions.halt(),this._transformGetter=null,this._opacityGetter=null,this._originGetter=null,this._alignGetter=null,this._sizeGetter=null,this._proportionGetter=null},e.prototype.getTransform=function(){return this._transformGetter()},e.prototype.getFinalTransform=function(){return this._legacyStates.transform?this._legacyStates.transform.getFinal():this._output.transform},e.prototype.getOpacity=function(){return this._opacityGetter()},e.prototype.getOrigin=function(){return this._originGetter()},e.prototype.getAlign=function(){return this._alignGetter()},e.prototype.getSize=function(){return this._sizeGetter?this._sizeGetter():this._output.size},e.prototype.getProportions=function(){return this._proportionGetter?this._proportionGetter():this._output.proportions},e.prototype.modify=function(t){return n.call(this),this._output.target=t,this._output},i.exports=e},{"../transitions/Transitionable":88,"../transitions/TransitionableTransform":89,"./Transform":15}],10:[function(t,i){function e(t){this._value=t,this.eventOutput=null}function n(){this.eventOutput=new o,this.eventOutput.bindThis(this),o.setOutputHandler(this,this.eventOutput)}var o=t("./EventHandler");e.patch=function(t){for(var i=new e(t),n=1;n<arguments.length;n++)i.patch(arguments[n]);return t},e.prototype.patch=function(){for(var t=this._value,i=0;i<arguments.length;i++){var e=arguments[i];for(var n in e)n in t&&e[n]&&e[n].constructor===Object&&t[n]&&t[n].constructor===Object?(t.hasOwnProperty(n)||(t[n]=Object.create(t[n])),this.key(n).patch(e[n]),this.eventOutput&&this.eventOutput.emit("change",{id:n,value:this.key(n).value()})):this.set(n,e[n])}return this},e.prototype.setOptions=e.prototype.patch,e.prototype.key=function(t){var i=new e(this._value[t]);return(!(i._value instanceof Object)||i._value instanceof Array)&&(i._value={}),i},e.prototype.get=function(t){return t?this._value[t]:this._value},e.prototype.getOptions=e.prototype.get,e.prototype.set=function(t,i){var e=this.get(t);return this._value[t]=i,this.eventOutput&&i!==e&&this.eventOutput.emit("change",{id:t,value:i}),this},e.prototype.on=function(){return n.call(this),this.on.apply(this,arguments)},e.prototype.removeListener=function(){return n.call(this),this.removeListener.apply(this,arguments)},e.prototype.pipe=function(){return n.call(this),this.pipe.apply(this,arguments)},e.prototype.unpipe=function(){return n.call(this),this.unpipe.apply(this,arguments)},i.exports=e},{"./EventHandler":7}],11:[function(t,i){function e(t){this._object=null,this._child=null,this._hasMultipleChildren=!1,this._isRenderable=!1,this._isModifier=!1,this._resultCache={},this._prevResults={},this._childResult=null,t&&this.set(t)}function n(t,i,e){for(var r=s.parse(t,i),a=Object.keys(r),h=0;h<a.length;h++){var c=a[h],p=o.get(c),u=r[c];u.allocator=i.allocator;var l=p.commit(u);l?n(l,i,e):e[c]=u}}var o=t("./Entity"),s=t("./SpecParser");e.prototype.add=function(t){var i=t instanceof e?t:new e(t);return this._child instanceof Array?this._child.push(i):this._child?(this._child=[this._child,i],this._hasMultipleChildren=!0,this._childResult=[]):this._child=i,i},e.prototype.get=function(){return this._object||(this._hasMultipleChildren?null:this._child?this._child.get():null)},e.prototype.set=function(t){return this._childResult=null,this._hasMultipleChildren=!1,this._isRenderable=t.render?!0:!1,this._isModifier=t.modify?!0:!1,this._object=t,this._child=null,t instanceof e?t:this},e.prototype.getSize=function(){var t=null,i=this.get();return i&&i.getSize&&(t=i.getSize()),!t&&this._child&&this._child.getSize&&(t=this._child.getSize()),t},e.prototype.commit=function(t){for(var i=Object.keys(this._prevResults),e=0;e<i.length;e++){var s=i[e];if(void 0===this._resultCache[s]){var r=o.get(s);r.cleanup&&r.cleanup(t.allocator)}}this._prevResults=this._resultCache,this._resultCache={},n(this.render(),t,this._resultCache)},e.prototype.render=function(){if(this._isRenderable)return this._object.render();var t=null;if(this._hasMultipleChildren){t=this._childResult;for(var i=this._child,e=0;e<i.length;e++)t[e]=i[e].render()}else this._child&&(t=this._child.render());return this._isModifier?this._object.modify(t):t},i.exports=e},{"./Entity":5,"./SpecParser":13}],12:[function(t,i){function e(t){this.id=null,this._objects=null,this.node=new c,this._definition=null,t&&this.load(t)}function n(t){for(var i in p)if(i in t){var e=t[i];return e instanceof Array||(e=[e]),p[i].apply(this,e)}}function o(t){var i=t.transform,e=t.opacity,o=t.origin,s=t.align,r=t.size,c=a.identity;if(i instanceof Array)if(16===i.length&&"number"==typeof i[0])c=i;else for(var p=0;p<i.length;p++)c=a.multiply(c,n(i[p]));else i instanceof Function?c=i:i instanceof Object&&(c=n(i));var u=new h({transform:c,opacity:e,origin:o,align:s,size:r});return u}function s(t){for(var i=new c,e=0;e<t.length;e++){var n=r.call(this,t[e]);n&&i.add(n)}return i}function r(t){var i,e;if(t instanceof Array)i=s.call(this,t);else if(e=this._objects.length,t.render&&t.render instanceof Function)i=t;else if(t.target){var n=r.call(this,t.target),a=o.call(this,t);i=new c(a),i.add(n),t.id&&(this.id[t.id]=a)}else t.id&&(i=new c,this.id[t.id]=i);return this._objects[e]=i,i}var a=t("./Transform"),h=t("./Modifier"),c=t("./RenderNode"),p={translate:a.translate,rotate:a.rotate,rotateX:a.rotateX,rotateY:a.rotateY,rotateZ:a.rotateZ,rotateAxis:a.rotateAxis,scale:a.scale,skew:a.skew,matrix3d:function(){return arguments}};e.prototype.create=function(){return new e(this._definition)},e.prototype.load=function(t){this._definition=t,this.id={},this._objects=[],this.node.set(r.call(this,t))},e.prototype.add=function(){return this.node.add.apply(this.node,arguments)},e.prototype.render=function(){return this.node.render.apply(this.node,arguments)},i.exports=e},{"./Modifier":9,"./RenderNode":11,"./Transform":15}],13:[function(t,i){function e(){this.result={}}function n(t,i){return[t[0]*i[0]+t[1]*i[4]+t[2]*i[8],t[0]*i[1]+t[1]*i[5]+t[2]*i[9],t[0]*i[2]+t[1]*i[6]+t[2]*i[10]]}var o=t("./Transform");e._instance=new e,e.parse=function(t,i){return e._instance.parse(t,i)},e.prototype.parse=function(t,i){return this.reset(),this._parseSpec(t,i,o.identity),this.result},e.prototype.reset=function(){this.result={}};var s=[0,0];e.prototype._parseSpec=function(t,i,e){var r,a,h,c,p,u,l;if("number"==typeof t){if(r=t,h=i.transform,u=i.align||s,i.size&&u&&(u[0]||u[1])){var f=[u[0]*i.size[0],u[1]*i.size[1],0];h=o.thenMove(h,n(f,e))}this.result[r]={transform:h,opacity:i.opacity,origin:i.origin||s,align:i.align||s,size:i.size}}else{if(!t)return;if(t instanceof Array)for(var d=0;d<t.length;d++)this._parseSpec(t[d],i,e);else{a=t.target,h=i.transform,c=i.opacity,p=i.origin,u=i.align,l=i.size;var _=e;if(void 0!==t.opacity&&(c=i.opacity*t.opacity),t.transform&&(h=o.multiply(i.transform,t.transform)),t.origin&&(p=t.origin,_=i.transform),t.align&&(u=t.align),t.size||t.proportions){var y=l;l=[l[0],l[1]],t.size&&(void 0!==t.size[0]&&(l[0]=t.size[0]),void 0!==t.size[1]&&(l[1]=t.size[1])),t.proportions&&(void 0!==t.proportions[0]&&(l[0]=l[0]*t.proportions[0]),void 0!==t.proportions[1]&&(l[1]=l[1]*t.proportions[1])),y&&(u&&(u[0]||u[1])&&(h=o.thenMove(h,n([u[0]*y[0],u[1]*y[1],0],e))),p&&(p[0]||p[1])&&(h=o.moveThen([-p[0]*l[0],-p[1]*l[1],0],h))),_=i.transform,p=null,u=null}this._parseSpec(a,{transform:h,opacity:c,origin:p,align:u,size:l},_)}}},i.exports=e},{"./Transform":15}],14:[function(t,i){function e(t){c.call(this),this.options={},this.properties={},this.attributes={},this.content="",this.classList=[],this.size=null,this._classesDirty=!0,this._stylesDirty=!0,this._attributesDirty=!0,this._sizeDirty=!0,this._contentDirty=!0,this._trueSizeCheck=!0,this._dirtyClasses=[],t&&this.setOptions(t),this._currentTarget=null}function n(t){for(var i=0;i<this._dirtyClasses.length;i++)t.classList.remove(this._dirtyClasses[i]);this._dirtyClasses=[]}function o(t){for(var i in this.properties)t.style[i]=this.properties[i]}function s(t){for(var i in this.properties)t.style[i]=""}function r(t){for(var i in this.attributes)t.setAttribute(i,this.attributes[i])}function a(t){for(var i in this.attributes)t.removeAttribute(i)}function h(t,i){return t&&i?t[0]!==i[0]||t[1]!==i[1]:t!==i}var c=t("./ElementOutput");e.prototype=Object.create(c.prototype),e.prototype.constructor=e,e.prototype.elementType="div",e.prototype.elementClass="famous-surface",e.prototype.setAttributes=function(t){for(var i in t){if("style"===i)throw new Error('Cannot set styles via "setAttributes" as it will break Famo.us.  Use "setProperties" instead.');this.attributes[i]=t[i]}this._attributesDirty=!0},e.prototype.getAttributes=function(){return this.attributes},e.prototype.setProperties=function(t){for(var i in t)this.properties[i]=t[i];return this._stylesDirty=!0,this},e.prototype.getProperties=function(){return this.properties},e.prototype.addClass=function(t){return this.classList.indexOf(t)<0&&(this.classList.push(t),this._classesDirty=!0),this},e.prototype.removeClass=function(t){var i=this.classList.indexOf(t);return i>=0&&(this._dirtyClasses.push(this.classList.splice(i,1)[0]),this._classesDirty=!0),this},e.prototype.toggleClass=function(t){var i=this.classList.indexOf(t);return i>=0?this.removeClass(t):this.addClass(t),this},e.prototype.setClasses=function(t){var i=0,e=[];for(i=0;i<this.classList.length;i++)t.indexOf(this.classList[i])<0&&e.push(this.classList[i]);for(i=0;i<e.length;i++)this.removeClass(e[i]);for(i=0;i<t.length;i++)this.addClass(t[i]);return this},e.prototype.getClassList=function(){return this.classList},e.prototype.setContent=function(t){return this.content!==t&&(this.content=t,this._contentDirty=!0),this},e.prototype.getContent=function(){return this.content},e.prototype.setOptions=function(t){return t.size&&this.setSize(t.size),t.classes&&this.setClasses(t.classes),t.properties&&this.setProperties(t.properties),t.attributes&&this.setAttributes(t.attributes),t.content&&this.setContent(t.content),this},e.prototype.setup=function(t){var i=t.allocate(this.elementType);if(this.elementClass)if(this.elementClass instanceof Array)for(var e=0;e<this.elementClass.length;e++)i.classList.add(this.elementClass[e]);else i.classList.add(this.elementClass);i.style.display="",this.attach(i),this._opacity=null,this._currentTarget=i,this._stylesDirty=!0,this._classesDirty=!0,this._attributesDirty=!0,this._sizeDirty=!0,this._contentDirty=!0,this._originDirty=!0,this._transformDirty=!0},e.prototype.commit=function(t){this._currentTarget||this.setup(t.allocator);var i=this._currentTarget,e=t.size;if(this._classesDirty){n.call(this,i);for(var s=this.getClassList(),a=0;a<s.length;a++)i.classList.add(s[a]);this._classesDirty=!1,this._trueSizeCheck=!0}if(this._stylesDirty&&(o.call(this,i),this._stylesDirty=!1,this._trueSizeCheck=!0),this._attributesDirty&&(r.call(this,i),this._attributesDirty=!1,this._trueSizeCheck=!0),this.size){var p=t.size;if(e=[this.size[0],this.size[1]],void 0===e[0]&&(e[0]=p[0]),void 0===e[1]&&(e[1]=p[1]),e[0]===!0||e[1]===!0){if(e[0]!==!0||!this._trueSizeCheck&&0!==this._size[0])this._size&&(e[0]=this._size[0]);else{var u=i.offsetWidth;this._size&&this._size[0]!==u&&(this._size[0]=u,this._sizeDirty=!0),e[0]=u}if(e[1]!==!0||!this._trueSizeCheck&&0!==this._size[1])this._size&&(e[1]=this._size[1]);else{var l=i.offsetHeight;this._size&&this._size[1]!==l&&(this._size[1]=l,this._sizeDirty=!0),e[1]=l}this._trueSizeCheck=!1}}h(this._size,e)&&(this._size||(this._size=[0,0]),this._size[0]=e[0],this._size[1]=e[1],this._sizeDirty=!0),this._sizeDirty&&(this._size&&(i.style.width=this.size&&this.size[0]===!0?"":this._size[0]+"px",i.style.height=this.size&&this.size[1]===!0?"":this._size[1]+"px"),this._eventOutput.emit("resize")),this._contentDirty&&(this.deploy(i),this._eventOutput.emit("deploy"),this._contentDirty=!1,this._trueSizeCheck=!0),c.prototype.commit.call(this,t)},e.prototype.cleanup=function(t){var i=0,e=this._currentTarget;this._eventOutput.emit("recall"),this.recall(e),e.style.display="none",e.style.opacity="",e.style.width="",e.style.height="",s.call(this,e),a.call(this,e);var o=this.getClassList();for(n.call(this,e),i=0;i<o.length;i++)e.classList.remove(o[i]);if(this.elementClass)if(this.elementClass instanceof Array)for(i=0;i<this.elementClass.length;i++)e.classList.remove(this.elementClass[i]);else e.classList.remove(this.elementClass);this.detach(e),this._currentTarget=null,t.deallocate(e)},e.prototype.deploy=function(t){var i=this.getContent();if(i instanceof Node){for(;t.hasChildNodes();)t.removeChild(t.firstChild);t.appendChild(i)}else t.innerHTML=i},e.prototype.recall=function(t){for(var i=document.createDocumentFragment();t.hasChildNodes();)i.appendChild(t.firstChild);this.setContent(i)},e.prototype.getSize=function(){return this._size?this._size:this.size},e.prototype.setSize=function(t){return this.size=t?[t[0],t[1]]:null,this._sizeDirty=!0,this},i.exports=e},{"./ElementOutput":3}],15:[function(t,i){function e(t){return 2===t.length?t[0]*t[0]+t[1]*t[1]:t[0]*t[0]+t[1]*t[1]+t[2]*t[2]}function n(t){return Math.sqrt(e(t))}function o(t){return 0>t?-1:1}var s={};s.precision=1e-6,s.identity=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],s.multiply4x4=function(t,i){return[t[0]*i[0]+t[4]*i[1]+t[8]*i[2]+t[12]*i[3],t[1]*i[0]+t[5]*i[1]+t[9]*i[2]+t[13]*i[3],t[2]*i[0]+t[6]*i[1]+t[10]*i[2]+t[14]*i[3],t[3]*i[0]+t[7]*i[1]+t[11]*i[2]+t[15]*i[3],t[0]*i[4]+t[4]*i[5]+t[8]*i[6]+t[12]*i[7],t[1]*i[4]+t[5]*i[5]+t[9]*i[6]+t[13]*i[7],t[2]*i[4]+t[6]*i[5]+t[10]*i[6]+t[14]*i[7],t[3]*i[4]+t[7]*i[5]+t[11]*i[6]+t[15]*i[7],t[0]*i[8]+t[4]*i[9]+t[8]*i[10]+t[12]*i[11],t[1]*i[8]+t[5]*i[9]+t[9]*i[10]+t[13]*i[11],t[2]*i[8]+t[6]*i[9]+t[10]*i[10]+t[14]*i[11],t[3]*i[8]+t[7]*i[9]+t[11]*i[10]+t[15]*i[11],t[0]*i[12]+t[4]*i[13]+t[8]*i[14]+t[12]*i[15],t[1]*i[12]+t[5]*i[13]+t[9]*i[14]+t[13]*i[15],t[2]*i[12]+t[6]*i[13]+t[10]*i[14]+t[14]*i[15],t[3]*i[12]+t[7]*i[13]+t[11]*i[14]+t[15]*i[15]]},s.multiply=function(t,i){return[t[0]*i[0]+t[4]*i[1]+t[8]*i[2],t[1]*i[0]+t[5]*i[1]+t[9]*i[2],t[2]*i[0]+t[6]*i[1]+t[10]*i[2],0,t[0]*i[4]+t[4]*i[5]+t[8]*i[6],t[1]*i[4]+t[5]*i[5]+t[9]*i[6],t[2]*i[4]+t[6]*i[5]+t[10]*i[6],0,t[0]*i[8]+t[4]*i[9]+t[8]*i[10],t[1]*i[8]+t[5]*i[9]+t[9]*i[10],t[2]*i[8]+t[6]*i[9]+t[10]*i[10],0,t[0]*i[12]+t[4]*i[13]+t[8]*i[14]+t[12],t[1]*i[12]+t[5]*i[13]+t[9]*i[14]+t[13],t[2]*i[12]+t[6]*i[13]+t[10]*i[14]+t[14],1]
},s.thenMove=function(t,i){return i[2]||(i[2]=0),[t[0],t[1],t[2],0,t[4],t[5],t[6],0,t[8],t[9],t[10],0,t[12]+i[0],t[13]+i[1],t[14]+i[2],1]},s.moveThen=function(t,i){t[2]||(t[2]=0);var e=t[0]*i[0]+t[1]*i[4]+t[2]*i[8],n=t[0]*i[1]+t[1]*i[5]+t[2]*i[9],o=t[0]*i[2]+t[1]*i[6]+t[2]*i[10];return s.thenMove(i,[e,n,o])},s.translate=function(t,i,e){return void 0===e&&(e=0),[1,0,0,0,0,1,0,0,0,0,1,0,t,i,e,1]},s.thenScale=function(t,i){return[i[0]*t[0],i[1]*t[1],i[2]*t[2],0,i[0]*t[4],i[1]*t[5],i[2]*t[6],0,i[0]*t[8],i[1]*t[9],i[2]*t[10],0,i[0]*t[12],i[1]*t[13],i[2]*t[14],1]},s.scale=function(t,i,e){return void 0===e&&(e=1),void 0===i&&(i=t),[t,0,0,0,0,i,0,0,0,0,e,0,0,0,0,1]},s.rotateX=function(t){var i=Math.cos(t),e=Math.sin(t);return[1,0,0,0,0,i,e,0,0,-e,i,0,0,0,0,1]},s.rotateY=function(t){var i=Math.cos(t),e=Math.sin(t);return[i,0,-e,0,0,1,0,0,e,0,i,0,0,0,0,1]},s.rotateZ=function(t){var i=Math.cos(t),e=Math.sin(t);return[i,e,0,0,-e,i,0,0,0,0,1,0,0,0,0,1]},s.rotate=function(t,i,e){var n=Math.cos(t),o=Math.sin(t),s=Math.cos(i),r=Math.sin(i),a=Math.cos(e),h=Math.sin(e),c=[s*a,n*h+o*r*a,o*h-n*r*a,0,-s*h,n*a-o*r*h,o*a+n*r*h,0,r,-o*s,n*s,0,0,0,0,1];return c},s.rotateAxis=function(t,i){var e=Math.sin(i),n=Math.cos(i),o=1-n,s=t[0]*t[0]*o,r=t[0]*t[1]*o,a=t[0]*t[2]*o,h=t[1]*t[1]*o,c=t[1]*t[2]*o,p=t[2]*t[2]*o,u=t[0]*e,l=t[1]*e,f=t[2]*e,d=[s+n,r+f,a-l,0,r-f,h+n,c+u,0,a+l,c-u,p+n,0,0,0,0,1];return d},s.aboutOrigin=function(t,i){var e=t[0]-(t[0]*i[0]+t[1]*i[4]+t[2]*i[8]),n=t[1]-(t[0]*i[1]+t[1]*i[5]+t[2]*i[9]),o=t[2]-(t[0]*i[2]+t[1]*i[6]+t[2]*i[10]);return s.thenMove(i,[e,n,o])},s.skew=function(t,i,e){return[1,Math.tan(i),0,0,Math.tan(e),1,0,0,0,Math.tan(t),1,0,0,0,0,1]},s.skewX=function(t){return[1,0,0,0,Math.tan(t),1,0,0,0,0,1,0,0,0,0,1]},s.skewY=function(t){return[1,Math.tan(t),0,0,0,1,0,0,0,0,1,0,0,0,0,1]},s.perspective=function(t){return[1,0,0,0,0,1,0,0,0,0,1,-1/t,0,0,0,1]},s.getTranslate=function(t){return[t[12],t[13],t[14]]},s.inverse=function(t){var i=t[5]*t[10]-t[6]*t[9],e=t[4]*t[10]-t[6]*t[8],n=t[4]*t[9]-t[5]*t[8],o=t[1]*t[10]-t[2]*t[9],s=t[0]*t[10]-t[2]*t[8],r=t[0]*t[9]-t[1]*t[8],a=t[1]*t[6]-t[2]*t[5],h=t[0]*t[6]-t[2]*t[4],c=t[0]*t[5]-t[1]*t[4],p=t[0]*i-t[1]*e+t[2]*n,u=1/p,l=[u*i,-u*o,u*a,0,-u*e,u*s,-u*h,0,u*n,-u*r,u*c,0,0,0,0,1];return l[12]=-t[12]*l[0]-t[13]*l[4]-t[14]*l[8],l[13]=-t[12]*l[1]-t[13]*l[5]-t[14]*l[9],l[14]=-t[12]*l[2]-t[13]*l[6]-t[14]*l[10],l},s.transpose=function(t){return[t[0],t[4],t[8],t[12],t[1],t[5],t[9],t[13],t[2],t[6],t[10],t[14],t[3],t[7],t[11],t[15]]},s.interpret=function(t){var i=[t[0],t[1],t[2]],r=o(i[0]),a=n(i),h=[i[0]+r*a,i[1],i[2]],c=2/e(h);if(c>=1/0)return{translate:s.getTranslate(t),rotate:[0,0,0],scale:[0,0,0],skew:[0,0,0]};var p=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1];p[0]=1-c*h[0]*h[0],p[5]=1-c*h[1]*h[1],p[10]=1-c*h[2]*h[2],p[1]=-c*h[0]*h[1],p[2]=-c*h[0]*h[2],p[6]=-c*h[1]*h[2],p[4]=p[1],p[8]=p[2],p[9]=p[6];var u=s.multiply(p,t),l=[u[5],u[6]],f=o(l[0]),d=n(l),_=[l[0]+f*d,l[1]],y=2/e(_),g=[1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1];g[5]=1-y*_[0]*_[0],g[10]=1-y*_[1]*_[1],g[6]=-y*_[0]*_[1],g[9]=g[6];var v=s.multiply(g,p),m=s.multiply(v,t),O=s.scale(m[0]<0?-1:1,m[5]<0?-1:1,m[10]<0?-1:1);m=s.multiply(m,O),v=s.multiply(O,v);var S={};return S.translate=s.getTranslate(t),S.rotate=[Math.atan2(-v[6],v[10]),Math.asin(v[2]),Math.atan2(-v[1],v[0])],S.rotate[0]||(S.rotate[0]=0,S.rotate[2]=Math.atan2(v[4],v[5])),S.scale=[m[0],m[5],m[10]],S.skew=[Math.atan2(m[9],S.scale[2]),Math.atan2(m[8],S.scale[2]),Math.atan2(m[4],S.scale[0])],Math.abs(S.rotate[0])+Math.abs(S.rotate[2])>1.5*Math.PI&&(S.rotate[1]=Math.PI-S.rotate[1],S.rotate[1]>Math.PI&&(S.rotate[1]-=2*Math.PI),S.rotate[1]<-Math.PI&&(S.rotate[1]+=2*Math.PI),S.rotate[0]<0?S.rotate[0]+=Math.PI:S.rotate[0]-=Math.PI,S.rotate[2]<0?S.rotate[2]+=Math.PI:S.rotate[2]-=Math.PI),S},s.average=function(t,i,e){e=void 0===e?.5:e;for(var n=s.interpret(t),o=s.interpret(i),r={translate:[0,0,0],rotate:[0,0,0],scale:[0,0,0],skew:[0,0,0]},a=0;3>a;a++)r.translate[a]=(1-e)*n.translate[a]+e*o.translate[a],r.rotate[a]=(1-e)*n.rotate[a]+e*o.rotate[a],r.scale[a]=(1-e)*n.scale[a]+e*o.scale[a],r.skew[a]=(1-e)*n.skew[a]+e*o.skew[a];return s.build(r)},s.build=function(t){var i=s.scale(t.scale[0],t.scale[1],t.scale[2]),e=s.skew(t.skew[0],t.skew[1],t.skew[2]),n=s.rotate(t.rotate[0],t.rotate[1],t.rotate[2]);return s.thenMove(s.multiply(s.multiply(n,e),i),t.translate)},s.equals=function(t,i){return!s.notEquals(t,i)},s.notEquals=function(t,i){return t===i?!1:!(t&&i)||t[12]!==i[12]||t[13]!==i[13]||t[14]!==i[14]||t[0]!==i[0]||t[1]!==i[1]||t[2]!==i[2]||t[4]!==i[4]||t[5]!==i[5]||t[6]!==i[6]||t[8]!==i[8]||t[9]!==i[9]||t[10]!==i[10]},s.normalizeRotation=function(t){var i=t.slice(0);for((i[0]===.5*Math.PI||i[0]===.5*-Math.PI)&&(i[0]=-i[0],i[1]=Math.PI-i[1],i[2]-=Math.PI),i[0]>.5*Math.PI&&(i[0]=i[0]-Math.PI,i[1]=Math.PI-i[1],i[2]-=Math.PI),i[0]<.5*-Math.PI&&(i[0]=i[0]+Math.PI,i[1]=-Math.PI-i[1],i[2]-=Math.PI);i[1]<-Math.PI;)i[1]+=2*Math.PI;for(;i[1]>=Math.PI;)i[1]-=2*Math.PI;for(;i[2]<-Math.PI;)i[2]+=2*Math.PI;for(;i[2]>=Math.PI;)i[2]-=2*Math.PI;return i},s.inFront=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,.001,1],s.behind=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,-.001,1],i.exports=s},{}],16:[function(t,i){function e(t){this._node=new s,this._eventInput=new n,this._eventOutput=new n,n.setInputHandler(this,this._eventInput),n.setOutputHandler(this,this._eventOutput),this.options=r.clone(this.constructor.DEFAULT_OPTIONS||e.DEFAULT_OPTIONS),this._optionsManager=new o(this.options),t&&this.setOptions(t)}var n=t("./EventHandler"),o=t("./OptionsManager"),s=t("./RenderNode"),r=t("../utilities/Utility");e.DEFAULT_OPTIONS={},e.prototype.getOptions=function(t){return this._optionsManager.getOptions(t)},e.prototype.setOptions=function(t){this._optionsManager.patch(t)},e.prototype.add=function(){return this._node.add.apply(this._node,arguments)},e.prototype._add=e.prototype.add,e.prototype.render=function(){return this._node.render()},e.prototype.getSize=function(){return this._node&&this._node.getSize?this._node.getSize.apply(this._node,arguments)||this.options.size:this.options.size},i.exports=e},{"../utilities/Utility":95,"./EventHandler":7,"./OptionsManager":10,"./RenderNode":11}],17:[function(t,i){function e(t){t||(t=[]),t instanceof Array&&(t={array:t}),this._=null,this.index=t.index||0,t.array?this._=new this.constructor.Backing(t.array):t._&&(this._=t._),this.index===this._.firstIndex&&(this._.firstNode=this),this.index===this._.firstIndex+this._.array.length-1&&(this._.lastNode=this),void 0!==t.loop&&(this._.loop=t.loop),void 0!==t.trackSize&&(this._.trackSize=t.trackSize),this._previousNode=null,this._nextNode=null}e.Backing=function(t){this.array=t,this.firstIndex=0,this.loop=!1,this.firstNode=null,this.lastNode=null,this.cumulativeSizes=[[0,0]],this.sizeDirty=!0,this.trackSize=!1},e.Backing.prototype.getValue=function(t){var i=t-this.firstIndex;return 0>i||i>=this.array.length?null:this.array[i]},e.Backing.prototype.setValue=function(t,i){this.array[t-this.firstIndex]=i},e.Backing.prototype.getSize=function(t){return this.cumulativeSizes[t]},e.Backing.prototype.calculateSize=function(t){t=t||this.array.length;for(var i=[0,0],e=0;t>e;e++){var n=this.array[e].getSize();if(!n)return void 0;void 0!==i[0]&&(void 0===n[0]?i[0]=void 0:i[0]+=n[0]),void 0!==i[1]&&(void 0===n[1]?i[1]=void 0:i[1]+=n[1]),this.cumulativeSizes[e+1]=i.slice()}return this.sizeDirty=!1,i},e.Backing.prototype.reindex=function(t,i,e){if(this.array[0]){for(var n=0,o=this.firstIndex,s=e-i,r=this.firstNode;t-1>o;)r=r.getNext(),o++;var a=r;for(n=0;i>n;n++)r=r.getNext(),r&&(r._previousNode=a);var h=r?r.getNext():null;for(a._nextNode=null,r=a,n=0;e>n;n++)r=r.getNext();if(o+=e,r!==h&&(r._nextNode=h,h&&(h._previousNode=r)),h)for(r=h,o++;r&&o<this.array.length+this.firstIndex;)r._nextNode?r.index+=s:r.index=o,r=r.getNext(),o++;this.trackSize&&(this.sizeDirty=!0)}},e.prototype.getPrevious=function(){var t=this._.array.length;return t?this.index===this._.firstIndex?this._.loop?(this._previousNode=this._.lastNode||new this.constructor({_:this._,index:this._.firstIndex+t-1}),this._previousNode._nextNode=this):this._previousNode=null:this._previousNode||(this._previousNode=new this.constructor({_:this._,index:this.index-1}),this._previousNode._nextNode=this):this._previousNode=null,this._previousNode},e.prototype.getNext=function(){var t=this._.array.length;return t?this.index===this._.firstIndex+t-1?this._.loop?(this._nextNode=this._.firstNode||new this.constructor({_:this._,index:this._.firstIndex}),this._nextNode._previousNode=this):this._nextNode=null:this._nextNode||(this._nextNode=new this.constructor({_:this._,index:this.index+1}),this._nextNode._previousNode=this):this._nextNode=null,this._nextNode},e.prototype.indexOf=function(t){return this._.array.indexOf(t)},e.prototype.getIndex=function(){return this.index},e.prototype.toString=function(){return""+this.index},e.prototype.unshift=function(){this._.array.unshift.apply(this._.array,arguments),this._.firstIndex-=arguments.length,this._.trackSize&&(this._.sizeDirty=!0)},e.prototype.push=function(){this._.array.push.apply(this._.array,arguments),this._.trackSize&&(this._.sizeDirty=!0)},e.prototype.splice=function(t,i){var e=Array.prototype.slice.call(arguments,2);this._.array.splice.apply(this._.array,[t-this._.firstIndex,i].concat(e)),this._.reindex(t,i,e.length)},e.prototype.swap=function(t){var i=t.get(),e=this.get();this._.setValue(this.index,i),this._.setValue(t.index,e);var n=this._previousNode,o=this._nextNode,s=this.index,r=t._previousNode,a=t._nextNode,h=t.index;this.index=h,this._previousNode=r===this?t:r,this._previousNode&&(this._previousNode._nextNode=this),this._nextNode=a===this?t:a,this._nextNode&&(this._nextNode._previousNode=this),t.index=s,t._previousNode=n===t?this:n,t._previousNode&&(t._previousNode._nextNode=t),t._nextNode=o===t?this:o,t._nextNode&&(t._nextNode._previousNode=t),this.index===this._.firstIndex?this._.firstNode=this:this.index===this._.firstIndex+this._.array.length-1&&(this._.lastNode=this),t.index===this._.firstIndex?this._.firstNode=t:t.index===this._.firstIndex+this._.array.length-1&&(this._.lastNode=t),this._.trackSize&&(this._.sizeDirty=!0)},e.prototype.get=function(){return this._.getValue(this.index)},e.prototype.getSize=function(){var t=this.get();return t?t.getSize():null},e.prototype.render=function(){this._.trackSize&&this._.sizeDirty&&this._.calculateSize();var t=this.get();return t?t.render.apply(t,arguments):null},i.exports=e},{}],18:[function(t,i){i.exports={Context:t("./Context"),ElementAllocator:t("./ElementAllocator"),ElementOutput:t("./ElementOutput"),Engine:t("./Engine"),Entity:t("./Entity"),EventEmitter:t("./EventEmitter"),EventHandler:t("./EventHandler"),Group:t("./Group"),Modifier:t("./Modifier"),OptionsManager:t("./OptionsManager"),RenderNode:t("./RenderNode"),Scene:t("./Scene"),SpecParser:t("./SpecParser"),Surface:t("./Surface"),Transform:t("./Transform"),View:t("./View"),ViewSequence:t("./ViewSequence")}},{"./Context":1,"./ElementAllocator":2,"./ElementOutput":3,"./Engine":4,"./Entity":5,"./EventEmitter":6,"./EventHandler":7,"./Group":8,"./Modifier":9,"./OptionsManager":10,"./RenderNode":11,"./Scene":12,"./SpecParser":13,"./Surface":14,"./Transform":15,"./View":16,"./ViewSequence":17}],19:[function(t,i){function e(t){this.dispatchers={},this.currMode=void 0,this.setMode(t)}var n=t("../core/EventHandler");e.prototype.setMode=function(t){if(t!==this.currMode){var i=this.currMode;this.dispatchers[this.currMode]&&this.dispatchers[this.currMode].trigger("unpipe"),this.currMode=t,this.dispatchers[t]&&this.dispatchers[t].emit("pipe"),this.emit("change",{from:i,to:t})}},e.prototype.forMode=function(t){return this.dispatchers[t]||(this.dispatchers[t]=new n),this.dispatchers[t]},e.prototype.emit=function(t,i){if(void 0===this.currMode)return!1;i||(i={});var e=this.dispatchers[this.currMode];return e?e.trigger(t,i):void 0},i.exports=e},{"../core/EventHandler":7}],20:[function(t,i){function e(t){n.call(this),this._condition=t}var n=t("../core/EventHandler");e.prototype=Object.create(n.prototype),e.prototype.constructor=e,e.prototype.emit=function(t,i){return this._condition(t,i)?n.prototype.emit.apply(this,arguments):void 0},e.prototype.trigger=e.prototype.emit,i.exports=e},{"../core/EventHandler":7}],21:[function(t,i){function e(t){n.call(this),this._mappingFunction=t}var n=t("../core/EventHandler");e.prototype=Object.create(n.prototype),e.prototype.constructor=e,e.prototype.subscribe=null,e.prototype.unsubscribe=null,e.prototype.emit=function(t,i){var e=this._mappingFunction.apply(this,arguments);e&&e.emit instanceof Function&&e.emit(t,i)},e.prototype.trigger=e.prototype.emit,i.exports=e},{"../core/EventHandler":7}],22:[function(t,i){i.exports={EventArbiter:t("./EventArbiter"),EventFilter:t("./EventFilter"),EventMapper:t("./EventMapper")}},{"./EventArbiter":19,"./EventFilter":20,"./EventMapper":21}],23:[function(t,i){i.exports={events:t("./events"),core:t("./core"),math:t("./math"),inputs:t("./inputs"),physics:t("./physics"),modifiers:t("./modifiers"),surfaces:t("./surfaces"),transitions:t("./transitions"),utilities:t("./utilities"),views:t("./views"),widgets:t("./widgets")}},{"./core":18,"./events":22,"./inputs":36,"./math":42,"./modifiers":47,"./physics":71,"./surfaces":82,"./transitions":92,"./utilities":96,"./views":111,"./widgets":116}],24:[function(t,i){function e(t,i){void 0===i&&(i="update"),this._state=t&&t.get&&t.set?t:new s(t||0),this._eventInput=new o,o.setInputHandler(this,this._eventInput),this._eventInput.on(i,n.bind(this))}function n(t){var i=t.delta,e=this.get();if(i.constructor===e.constructor){var n=i instanceof Array?[e[0]+i[0],e[1]+i[1]]:e+i;this.set(n)}}var o=t("../core/EventHandler"),s=t("../transitions/Transitionable");e.prototype.get=function(){return this._state.get()},e.prototype.set=function(t){this._state.set(t)},i.exports=e},{"../core/EventHandler":7,"../transitions/Transitionable":88}],25:[function(){function t(t){window.addEventListener(t,function(t){return t.stopPropagation(),!1},!0)}var i="ontouchstart"in window;i&&(t("mousedown"),t("mousemove"),t("mouseup"),t("mouseleave"))},{}],26:[function(){!function(){if(window.CustomEvent){var t=300,i=500,e={},n={},o=Date.now;window.addEventListener("touchstart",function(t){for(var i=o(),n=0;n<t.changedTouches.length;n++){var s=t.changedTouches[n];e[s.identifier]=i}}),window.addEventListener("touchmove",function(t){for(var i=0;i<t.changedTouches.length;i++){var n=t.changedTouches[i];delete e[n.identifier]}}),window.addEventListener("touchend",function(i){for(var s=o(),r=0;r<i.changedTouches.length;r++){var a=i.changedTouches[r],h=e[a.identifier];if(h&&t>s-h){var c=new window.CustomEvent("click",{bubbles:!0,detail:a});n[s]=i,i.target.dispatchEvent(c)}delete e[a.identifier]}}),window.addEventListener("click",function(t){var e=o();for(var s in n){var r=n[s];i>e-s?t instanceof window.MouseEvent&&t.target===r.target&&t.stopPropagation():delete n[s]}},!0)}}()},{}],27:[function(t,i){function e(t,i){this._eventInput=new o,this._eventOutput=new o,o.setInputHandler(this,this._eventInput),o.setOutputHandler(this,this._eventOutput),this._syncs={},t&&this.addSync(t),i&&this.setOptions(i)}function n(t,i){s[t]&&(this._syncs[t]=new s[t](i),this.pipeSync(t))}var o=t("../core/EventHandler");e.DIRECTION_X=0,e.DIRECTION_Y=1,e.DIRECTION_Z=2;var s={};e.register=function(t){for(var i in t){if(s[i]){if(s[i]===t[i])return;throw new Error("this key is registered to a different sync class")}s[i]=t[i]}},e.prototype.setOptions=function(t){for(var i in this._syncs)this._syncs[i].setOptions(t)},e.prototype.pipeSync=function(t){var i=this._syncs[t];this._eventInput.pipe(i),i.pipe(this._eventOutput)},e.prototype.unpipeSync=function(t){var i=this._syncs[t];this._eventInput.unpipe(i),i.unpipe(this._eventOutput)},e.prototype.addSync=function(t){if(t instanceof Array)for(var i=0;i<t.length;i++)n.call(this,t[i]);else if(t instanceof Object)for(var e in t)n.call(this,e,t[e])},i.exports=e},{"../core/EventHandler":7}],28:[function(t,i){function e(t){this.options=Object.create(e.DEFAULT_OPTIONS),this._optionsManager=new h(this.options),t&&this.setOptions(t),this._eventInput=new a,this._eventOutput=new a,a.setInputHandler(this,this._eventInput),a.setOutputHandler(this,this._eventOutput),this._eventInput.on("mousedown",n.bind(this)),this._eventInput.on("mousemove",o.bind(this)),this._eventInput.on("mouseup",s.bind(this)),this.options.propogate?this._eventInput.on("mouseleave",r.bind(this)):this._eventInput.on("mouseleave",s.bind(this)),this._payload={delta:null,position:null,velocity:null,clientX:0,clientY:0,offsetX:0,offsetY:0},this._positionHistory=[],this._position=null,this._prevCoord=void 0,this._prevTime=void 0,this._down=!1,this._moved=!1,this._documentActive=!1}function n(t){var i,e;this.options.preventDefault&&t.preventDefault();var n=t.clientX,o=t.clientY;this._prevCoord=[n,o],this._prevTime=Date.now(),this._down=!0,this._move=!1,void 0!==this.options.direction?(this._position=0,i=0,e=0):(this._position=[0,0],i=[0,0],e=[0,0]);var s=this._payload;s.delta=i,s.position=this._position,s.velocity=e,s.clientX=n,s.clientY=o,s.offsetX=t.offsetX,s.offsetY=t.offsetY,this._positionHistory.push({position:s.position.slice?s.position.slice(0):s.position,time:this._prevTime}),this._eventOutput.emit("start",s),this._documentActive=!1}function o(t){if(this._prevCoord){var i=this._prevCoord,n=(this._prevTime,t.clientX),o=t.clientY,s=Date.now(),r=n-i[0],a=o-i[1];this.options.rails&&(Math.abs(r)>Math.abs(a)?a=0:r=0);var h,p,u=Math.max(s-this._positionHistory[0].time,c),l=this.options.scale;this.options.direction===e.DIRECTION_X?(p=l*r,this._position+=p,h=l*(this._position-this._positionHistory[0].position)/u):this.options.direction===e.DIRECTION_Y?(p=l*a,this._position+=p,h=l*(this._position-this._positionHistory[0].position)/u):(p=[l*r,l*a],h=[l*(this._position[0]-this._positionHistory[0].position[0])/u,l*(this._position[1]-this._positionHistory[0].position[1])/u],this._position[0]+=p[0],this._position[1]+=p[1]);var f=this._payload;f.delta=p,f.position=this._position,f.velocity=h,f.clientX=n,f.clientY=o,f.offsetX=t.offsetX,f.offsetY=t.offsetY,this._positionHistory.length===this.options.velocitySampleLength&&this._positionHistory.shift(),this._positionHistory.push({position:f.position.slice?f.position.slice(0):f.position,time:s}),this._eventOutput.emit("update",f),this._prevCoord=[n,o],this._prevTime=s,this._move=!0}}function s(){this._down&&(this._eventOutput.emit("end",this._payload),this._prevCoord=void 0,this._prevTime=void 0,this._down=!1,this._move=!1,this._positionHistory=[])}function r(t){if(this._down&&this._move&&!this._documentActive){var i=o.bind(this),e=function(t){s.call(this,t),document.removeEventListener("mousemove",i),document.removeEventListener("mouseup",e)}.bind(this,t);document.addEventListener("mousemove",i),document.addEventListener("mouseup",e),this._documentActive=!0}}var a=t("../core/EventHandler"),h=t("../core/OptionsManager");e.DEFAULT_OPTIONS={direction:void 0,rails:!1,scale:1,propogate:!0,velocitySampleLength:10,preventDefault:!0},e.DIRECTION_X=0,e.DIRECTION_Y=1;var c=8;e.prototype.getOptions=function(){return this.options},e.prototype.setOptions=function(t){return this._optionsManager.setOptions(t)},i.exports=e},{"../core/EventHandler":7,"../core/OptionsManager":10}],29:[function(t,i){function e(t){n.call(this),this.options=Object.create(e.DEFAULT_OPTIONS),this._optionsManager=new o(this.options),t&&this.setOptions(t),this._displacement=0,this._previousDistance=0}var n=t("./TwoFingerSync"),o=t("../core/OptionsManager");e.prototype=Object.create(n.prototype),e.prototype.constructor=e,e.DEFAULT_OPTIONS={scale:1},e.prototype._startUpdate=function(t){this._previousDistance=n.calculateDistance(this.posA,this.posB),this._displacement=0,this._eventOutput.emit("start",{count:t.touches.length,touches:[this.touchAId,this.touchBId],distance:this._dist,center:n.calculateCenter(this.posA,this.posB)})},e.prototype._moveUpdate=function(t){var i=n.calculateDistance(this.posA,this.posB),e=n.calculateCenter(this.posA,this.posB),o=this.options.scale,s=o*(i-this._previousDistance),r=s/t;this._previousDistance=i,this._displacement+=s,this._eventOutput.emit("update",{delta:s,velocity:r,distance:i,displacement:this._displacement,center:e,touches:[this.touchAId,this.touchBId]})},e.prototype.getOptions=function(){return this.options},e.prototype.setOptions=function(t){return this._optionsManager.setOptions(t)},i.exports=e},{"../core/OptionsManager":10,"./TwoFingerSync":35}],30:[function(t,i){function e(t){n.call(this),this.options=Object.create(e.DEFAULT_OPTIONS),this._optionsManager=new o(this.options),t&&this.setOptions(t),this._angle=0,this._previousAngle=0}var n=t("./TwoFingerSync"),o=t("../core/OptionsManager");e.prototype=Object.create(n.prototype),e.prototype.constructor=e,e.DEFAULT_OPTIONS={scale:1},e.prototype._startUpdate=function(t){this._angle=0,this._previousAngle=n.calculateAngle(this.posA,this.posB);var i=n.calculateCenter(this.posA,this.posB);this._eventOutput.emit("start",{count:t.touches.length,angle:this._angle,center:i,touches:[this.touchAId,this.touchBId]})},e.prototype._moveUpdate=function(t){var i=this.options.scale,e=n.calculateAngle(this.posA,this.posB),o=n.calculateCenter(this.posA,this.posB),s=i*(e-this._previousAngle),r=s/t;this._angle+=s,this._eventOutput.emit("update",{delta:s,velocity:r,angle:this._angle,center:o,touches:[this.touchAId,this.touchBId]}),this._previousAngle=e},e.prototype.getOptions=function(){return this.options},e.prototype.setOptions=function(t){return this._optionsManager.setOptions(t)},i.exports=e},{"../core/OptionsManager":10,"./TwoFingerSync":35}],31:[function(t,i){function e(t){o.call(this),this.options=Object.create(e.DEFAULT_OPTIONS),this._optionsManager=new s(this.options),t&&this.setOptions(t),this._scaleFactor=1,this._startDist=0,this._eventInput.on("pipe",n.bind(this))}function n(){this.touchAId=void 0,this.touchBId=void 0}var o=t("./TwoFingerSync"),s=t("../core/OptionsManager");e.prototype=Object.create(o.prototype),e.prototype.constructor=e,e.DEFAULT_OPTIONS={scale:1},e.prototype._startUpdate=function(t){this._scaleFactor=1,this._startDist=o.calculateDistance(this.posA,this.posB),this._eventOutput.emit("start",{count:t.touches.length,touches:[this.touchAId,this.touchBId],distance:this._startDist,center:o.calculateCenter(this.posA,this.posB)})},e.prototype._moveUpdate=function(t){var i=this.options.scale,e=o.calculateDistance(this.posA,this.posB),n=o.calculateCenter(this.posA,this.posB),s=(e-this._startDist)/this._startDist,r=Math.max(1+i*s,0),a=(r-this._scaleFactor)/t;this._eventOutput.emit("update",{delta:s,scale:r,velocity:a,distance:e,center:n,touches:[this.touchAId,this.touchBId]}),this._scaleFactor=r},e.prototype.getOptions=function(){return this.options},e.prototype.setOptions=function(t){return this._optionsManager.setOptions(t)},i.exports=e},{"../core/OptionsManager":10,"./TwoFingerSync":35}],32:[function(t,i){function e(t){this.options=Object.create(e.DEFAULT_OPTIONS),this._optionsManager=new a(this.options),t&&this.setOptions(t),this._payload={delta:null,position:null,velocity:null,slip:!0},this._eventInput=new s,this._eventOutput=new s,s.setInputHandler(this,this._eventInput),s.setOutputHandler(this,this._eventOutput),this._position=void 0===this.options.direction?[0,0]:0,this._prevTime=void 0,this._prevVel=void 0,this._eventInput.on("mousewheel",o.bind(this)),this._eventInput.on("wheel",o.bind(this)),this._inProgress=!1,this._loopBound=!1}function n(){if(this._inProgress&&c()-this._prevTime>this.options.stallTime){this._inProgress=!1;var t=Math.abs(this._prevVel)>=this.options.minimumEndSpeed?this._prevVel:0,i=this._payload;i.position=this._position,i.velocity=t,i.slip=!0,this._eventOutput.emit("end",i)}}function o(t){this.options.preventDefault&&t.preventDefault(),this._inProgress||(this._inProgress=!0,this._position=void 0===this.options.direction?[0,0]:0,y=this._payload,y.slip=!0,y.position=this._position,y.clientX=t.clientX,y.clientY=t.clientY,y.offsetX=t.offsetX,y.offsetY=t.offsetY,this._eventOutput.emit("start",y),this._loopBound||(r.on("prerender",n.bind(this)),this._loopBound=!0));var i=c(),o=this._prevTime||i,s=void 0!==t.wheelDeltaX?t.wheelDeltaX:-t.deltaX,a=void 0!==t.wheelDeltaY?t.wheelDeltaY:-t.deltaY;1===t.deltaMode&&(s*=this.options.lineHeight,a*=this.options.lineHeight),this.options.rails&&(Math.abs(s)>Math.abs(a)?a=0:s=0);var p,u,l=Math.max(i-o,h),f=s/l,d=a/l,_=this.options.scale;this.options.direction===e.DIRECTION_X?(u=_*s,p=_*f,this._position+=u):this.options.direction===e.DIRECTION_Y?(u=_*a,p=_*d,this._position+=u):(u=[_*s,_*a],p=[_*f,_*d],this._position[0]+=u[0],this._position[1]+=u[1]);var y=this._payload;y.delta=u,y.velocity=p,y.position=this._position,y.slip=!0,this._eventOutput.emit("update",y),this._prevTime=i,this._prevVel=p}var s=t("../core/EventHandler"),r=t("../core/Engine"),a=t("../core/OptionsManager");e.DEFAULT_OPTIONS={direction:void 0,minimumEndSpeed:1/0,rails:!1,scale:1,stallTime:50,lineHeight:40,preventDefault:!0},e.DIRECTION_X=0,e.DIRECTION_Y=1;var h=8,c=Date.now;e.prototype.getOptions=function(){return this.options},e.prototype.setOptions=function(t){return this._optionsManager.setOptions(t)},i.exports=e},{"../core/Engine":4,"../core/EventHandler":7,"../core/OptionsManager":10}],33:[function(t,i){function e(t){this.options=Object.create(e.DEFAULT_OPTIONS),this._optionsManager=new h(this.options),t&&this.setOptions(t),this._eventOutput=new a,this._touchTracker=new r({touchLimit:this.options.touchLimit}),a.setOutputHandler(this,this._eventOutput),a.setInputHandler(this,this._touchTracker),this._touchTracker.on("trackstart",n.bind(this)),this._touchTracker.on("trackmove",o.bind(this)),this._touchTracker.on("trackend",s.bind(this)),this._payload={delta:null,position:null,velocity:null,clientX:void 0,clientY:void 0,count:0,touch:void 0},this._position=null}function n(t){var i,e;void 0!==this.options.direction?(this._position=0,i=0,e=0):(this._position=[0,0],i=[0,0],e=[0,0]);var n=this._payload;n.delta=e,n.position=this._position,n.velocity=i,n.clientX=t.x,n.clientY=t.y,n.count=t.count,n.touch=t.identifier,this._eventOutput.emit("start",n)}function o(t){var i=t.history,n=i[i.length-1],o=i[i.length-2],s=i[i.length-this.options.velocitySampleLength]?i[i.length-this.options.velocitySampleLength]:i[i.length-2],r=s.timestamp,a=n.timestamp,h=n.x-o.x,p=n.y-o.y,u=n.x-s.x,l=n.y-s.y;this.options.rails&&(Math.abs(h)>Math.abs(p)?p=0:h=0,Math.abs(u)>Math.abs(l)?l=0:u=0);var f,d,_=Math.max(a-r,c),y=u/_,g=l/_,v=this.options.scale;this.options.direction===e.DIRECTION_X?(d=v*h,f=v*y,this._position+=d):this.options.direction===e.DIRECTION_Y?(d=v*p,f=v*g,this._position+=d):(d=[v*h,v*p],f=[v*y,v*g],this._position[0]+=d[0],this._position[1]+=d[1]);var m=this._payload;m.delta=d,m.velocity=f,m.position=this._position,m.clientX=t.x,m.clientY=t.y,m.count=t.count,m.touch=t.identifier,this._eventOutput.emit("update",m)}function s(t){this._payload.count=t.count,this._eventOutput.emit("end",this._payload)}var r=t("./TouchTracker"),a=t("../core/EventHandler"),h=t("../core/OptionsManager");e.DEFAULT_OPTIONS={direction:void 0,rails:!1,touchLimit:1,velocitySampleLength:10,scale:1},e.DIRECTION_X=0,e.DIRECTION_Y=1;var c=8;e.prototype.setOptions=function(t){return this._optionsManager.setOptions(t)},e.prototype.getOptions=function(){return this.options},i.exports=e},{"../core/EventHandler":7,"../core/OptionsManager":10,"./TouchTracker":34}],34:[function(t,i){function e(t,i,e){return{x:t.clientX,y:t.clientY,identifier:t.identifier,origin:i.origin,timestamp:c(),count:i.touches.length,history:e}}function n(t){if(!(t.touches.length>this.touchLimit)){this.isTouched=!0;for(var i=0;i<t.changedTouches.length;i++){var n=t.changedTouches[i],o=e(n,t,null);this.eventOutput.emit("trackstart",o),this.selective||this.touchHistory[n.identifier]||this.track(o)}}}function o(t){if(!(t.touches.length>this.touchLimit))for(var i=0;i<t.changedTouches.length;i++){var n=t.changedTouches[i],o=this.touchHistory[n.identifier];if(o){var s=e(n,t,o);this.touchHistory[n.identifier].push(s),this.eventOutput.emit("trackmove",s)}}}function s(t){if(this.isTouched){for(var i=0;i<t.changedTouches.length;i++){var n=t.changedTouches[i],o=this.touchHistory[n.identifier];if(o){var s=e(n,t,o);this.eventOutput.emit("trackend",s),delete this.touchHistory[n.identifier]}}this.isTouched=!1}}function r(){for(var t in this.touchHistory){var i=this.touchHistory[t];this.eventOutput.emit("trackend",{touch:i[i.length-1].touch,timestamp:Date.now(),count:0,history:i}),delete this.touchHistory[t]}}function a(t){this.selective=t.selective,this.touchLimit=t.touchLimit||1,this.touchHistory={},this.eventInput=new h,this.eventOutput=new h,h.setInputHandler(this,this.eventInput),h.setOutputHandler(this,this.eventOutput),this.eventInput.on("touchstart",n.bind(this)),this.eventInput.on("touchmove",o.bind(this)),this.eventInput.on("touchend",s.bind(this)),this.eventInput.on("touchcancel",s.bind(this)),this.eventInput.on("unpipe",r.bind(this)),this.isTouched=!1}var h=t("../core/EventHandler"),c=Date.now;a.prototype.track=function(t){this.touchHistory[t.identifier]=[t]},i.exports=a},{"../core/EventHandler":7}],35:[function(t,i){function e(){this._eventInput=new n,this._eventOutput=new n,n.setInputHandler(this,this._eventInput),n.setOutputHandler(this,this._eventOutput),this.touchAEnabled=!1,this.touchAId=0,this.posA=null,this.timestampA=0,this.touchBEnabled=!1,this.touchBId=0,this.posB=null,this.timestampB=0,this._eventInput.on("touchstart",this.handleStart.bind(this)),this._eventInput.on("touchmove",this.handleMove.bind(this)),this._eventInput.on("touchend",this.handleEnd.bind(this)),this._eventInput.on("touchcancel",this.handleEnd.bind(this))}var n=t("../core/EventHandler");e.calculateAngle=function(t,i){var e=i[0]-t[0],n=i[1]-t[1];return Math.atan2(n,e)},e.calculateDistance=function(t,i){var e=i[0]-t[0],n=i[1]-t[1];return Math.sqrt(e*e+n*n)},e.calculateCenter=function(t,i){return[(t[0]+i[0])/2,(t[1]+i[1])/2]};var o=Date.now;e.prototype.handleStart=function(t){for(var i=0;i<t.changedTouches.length;i++){var e=t.changedTouches[i];this.touchAEnabled?this.touchBEnabled||(this.touchBId=e.identifier,this.touchBEnabled=!0,this.posB=[e.pageX,e.pageY],this.timestampB=o(),this._startUpdate(t)):(this.touchAId=e.identifier,this.touchAEnabled=!0,this.posA=[e.pageX,e.pageY],this.timestampA=o())}},e.prototype.handleMove=function(t){if(this.touchAEnabled&&this.touchBEnabled){for(var i,e=this.timestampA,n=this.timestampB,s=0;s<t.changedTouches.length;s++){var r=t.changedTouches[s];r.identifier===this.touchAId?(this.posA=[r.pageX,r.pageY],this.timestampA=o(),i=this.timestampA-e):r.identifier===this.touchBId&&(this.posB=[r.pageX,r.pageY],this.timestampB=o(),i=this.timestampB-n)}i&&this._moveUpdate(i)}},e.prototype.handleEnd=function(t){for(var i=0;i<t.changedTouches.length;i++){var e=t.changedTouches[i];(e.identifier===this.touchAId||e.identifier===this.touchBId)&&(this.touchAEnabled&&this.touchBEnabled&&this._eventOutput.emit("end",{touches:[this.touchAId,this.touchBId],angle:this._angle}),this.touchAEnabled=!1,this.touchAId=0,this.touchBEnabled=!1,this.touchBId=0)}},i.exports=e},{"../core/EventHandler":7}],36:[function(t,i){i.exports={Accumulator:t("./Accumulator"),DesktopEmulationMode:t("./DesktopEmulationMode"),FastClick:t("./FastClick"),GenericSync:t("./GenericSync"),MouseSync:t("./MouseSync"),PinchSync:t("./PinchSync"),RotateSync:t("./RotateSync"),ScaleSync:t("./ScaleSync"),ScrollSync:t("./ScrollSync"),TouchSync:t("./TouchSync"),TouchTracker:t("./TouchTracker"),TwoFingerSync:t("./TwoFingerSync")}},{"./Accumulator":24,"./DesktopEmulationMode":25,"./FastClick":26,"./GenericSync":27,"./MouseSync":28,"./PinchSync":29,"./RotateSync":30,"./ScaleSync":31,"./ScrollSync":32,"./TouchSync":33,"./TouchTracker":34,"./TwoFingerSync":35}],37:[function(t,i){function e(t){return this.values=t||[[1,0,0],[0,1,0],[0,0,1]],this}var n=t("./Vector"),o=new e,s=new n;
e.prototype.get=function(){return this.values},e.prototype.set=function(t){this.values=t},e.prototype.vectorMultiply=function(t){var i=this.get(),e=t.x,n=t.y,o=t.z,r=i[0],a=i[1],h=i[2],c=r[0],p=r[1],u=r[2],l=a[0],f=a[1],d=a[2],_=h[0],y=h[1],g=h[2];return s.setXYZ(c*e+p*n+u*o,l*e+f*n+d*o,_*e+y*n+g*o)},e.prototype.multiply=function(t){for(var i=this.get(),e=[[]],n=0;3>n;n++){e[n]=[];for(var s=0;3>s;s++){for(var r=0,a=0;3>a;a++)r+=i[n][a]*t[a][s];e[n][s]=r}}return o.set(e)},e.prototype.transpose=function(){for(var t=[],i=this.get(),e=0;3>e;e++)for(var n=0;3>n;n++)t[e][n]=i[n][e];return o.set(t)},e.prototype.clone=function(){for(var t=this.get(),i=[],n=0;3>n;n++)i[n]=t[n].slice();return new e(i)},i.exports=e},{"./Vector":41}],38:[function(t,i){function e(t,i,e,n){return 1===arguments.length?this.set(t):(this.w=void 0!==t?t:1,this.x=void 0!==i?i:0,this.y=void 0!==e?e:0,this.z=void 0!==n?n:0),this}var n=t("./Matrix"),o=new e(1,0,0,0);e.prototype.add=function(t){return o.setWXYZ(this.w+t.w,this.x+t.x,this.y+t.y,this.z+t.z)},e.prototype.sub=function(t){return o.setWXYZ(this.w-t.w,this.x-t.x,this.y-t.y,this.z-t.z)},e.prototype.scalarDivide=function(t){return this.scalarMultiply(1/t)},e.prototype.scalarMultiply=function(t){return o.setWXYZ(this.w*t,this.x*t,this.y*t,this.z*t)},e.prototype.multiply=function(t){var i=this.x,e=this.y,n=this.z,s=this.w,r=t.x,a=t.y,h=t.z,c=t.w||0;return o.setWXYZ(s*c-i*r-e*a-n*h,i*c+r*s+a*n-e*h,e*c+a*s+i*h-r*n,n*c+h*s+r*e-i*a)};var s=new e(1,0,0,0);e.prototype.rotateVector=function(t){return s.set(this.conj()),o.set(this.multiply(t).multiply(s))},e.prototype.inverse=function(){return o.set(this.conj().scalarDivide(this.normSquared()))},e.prototype.negate=function(){return this.scalarMultiply(-1)},e.prototype.conj=function(){return o.setWXYZ(this.w,-this.x,-this.y,-this.z)},e.prototype.normalize=function(t){return t=void 0===t?1:t,this.scalarDivide(t*this.norm())},e.prototype.makeFromAngleAndAxis=function(t,i){var e=i.normalize(),n=.5*t,o=-Math.sin(n);return this.x=o*e.x,this.y=o*e.y,this.z=o*e.z,this.w=Math.cos(n),this},e.prototype.setWXYZ=function(t,i,e,n){return o.clear(),this.w=t,this.x=i,this.y=e,this.z=n,this},e.prototype.set=function(t){return t instanceof Array?(this.w=0,this.x=t[0],this.y=t[1],this.z=t[2]):(this.w=t.w,this.x=t.x,this.y=t.y,this.z=t.z),this!==o&&o.clear(),this},e.prototype.put=function(t){t.set(o)},e.prototype.clone=function(){return new e(this)},e.prototype.clear=function(){return this.w=1,this.x=0,this.y=0,this.z=0,this},e.prototype.isEqual=function(t){return t.w===this.w&&t.x===this.x&&t.y===this.y&&t.z===this.z},e.prototype.dot=function(t){return this.w*t.w+this.x*t.x+this.y*t.y+this.z*t.z},e.prototype.normSquared=function(){return this.dot(this)},e.prototype.norm=function(){return Math.sqrt(this.normSquared())},e.prototype.isZero=function(){return!(this.x||this.y||this.z)},e.prototype.getTransform=function(){var t=this.normalize(1),i=t.x,e=t.y,n=t.z,o=t.w;return[1-2*e*e-2*n*n,2*i*e-2*n*o,2*i*n+2*e*o,0,2*i*e+2*n*o,1-2*i*i-2*n*n,2*e*n-2*i*o,0,2*i*n-2*e*o,2*e*n+2*i*o,1-2*i*i-2*e*e,0,0,0,0,1]};var r=new n;e.prototype.getMatrix=function(){var t=this.normalize(1),i=t.x,e=t.y,n=t.z,o=t.w;return r.set([[1-2*e*e-2*n*n,2*i*e+2*n*o,2*i*n-2*e*o],[2*i*e-2*n*o,1-2*i*i-2*n*n,2*e*n+2*i*o],[2*i*n+2*e*o,2*e*n-2*i*o,1-2*i*i-2*e*e]])};var a=1e-5;e.prototype.slerp=function(t,i){var e,n,s,r,h;return n=this.dot(t),1-n>a?(e=Math.acos(n),s=Math.sin(e),r=Math.sin((1-i)*e)/s,h=Math.sin(i*e)/s):(r=1-i,h=i),o.set(this.scalarMultiply(r/h).add(t).multiply(h))},i.exports=e},{"./Matrix":37}],39:[function(t,i){function e(t,i){return t+o()*(i-t)}function n(t,i){return t+o()*(i-t+1)>>0}var o=Math.random,s={};s.integer=function(t,i,e){if(t=void 0!==t?t:0,i=void 0!==i?i:1,void 0!==e){for(var o=[],s=0;e>s;s++)o.push(n(t,i));return o}return n(t,i)},s.range=function(t,i,n){if(t=void 0!==t?t:0,i=void 0!==i?i:1,void 0!==n){for(var o=[],s=0;n>s;s++)o.push(e(t,i));return o}return e(t,i)},s.sign=function(t){return t=void 0!==t?t:.5,o()<t?1:-1},s.bool=function(t){return t=void 0!==t?t:.5,o()<t},i.exports=s},{}],40:[function(t,i){var e={};e.clamp=function(t,i){return Math.max(Math.min(t,i[1]),i[0])},e.length=function(t){for(var i=0,e=0;e<t.length;e++)i+=t[e]*t[e];return Math.sqrt(i)},i.exports=e},{}],41:[function(t,i){function e(t,i,e){return 1===arguments.length&&void 0!==t?this.set(t):(this.x=t||0,this.y=i||0,this.z=e||0),this}function n(t,i,e){return this.x=t,this.y=i,this.z=e,this}function o(t){return n.call(this,t[0],t[1],t[2]||0)}function s(t){return n.call(this,t.x,t.y,t.z)}function r(t){return n.call(this,t,0,0)}var a=new e(0,0,0);e.prototype.add=function(t){return n.call(a,this.x+t.x,this.y+t.y,this.z+t.z)},e.prototype.sub=function(t){return n.call(a,this.x-t.x,this.y-t.y,this.z-t.z)},e.prototype.mult=function(t){return n.call(a,t*this.x,t*this.y,t*this.z)},e.prototype.div=function(t){return this.mult(1/t)},e.prototype.cross=function(t){var i=this.x,e=this.y,o=this.z,s=t.x,r=t.y,h=t.z;return n.call(a,o*r-e*h,i*h-o*s,e*s-i*r)},e.prototype.equals=function(t){return t.x===this.x&&t.y===this.y&&t.z===this.z},e.prototype.rotateX=function(t){var i=this.x,e=this.y,o=this.z,s=Math.cos(t),r=Math.sin(t);return n.call(a,i,e*s-o*r,e*r+o*s)},e.prototype.rotateY=function(t){var i=this.x,e=this.y,o=this.z,s=Math.cos(t),r=Math.sin(t);return n.call(a,o*r+i*s,e,o*s-i*r)},e.prototype.rotateZ=function(t){var i=this.x,e=this.y,o=this.z,s=Math.cos(t),r=Math.sin(t);return n.call(a,i*s-e*r,i*r+e*s,o)},e.prototype.dot=function(t){return this.x*t.x+this.y*t.y+this.z*t.z},e.prototype.normSquared=function(){return this.dot(this)},e.prototype.norm=function(){return Math.sqrt(this.normSquared())},e.prototype.normalize=function(t){0===arguments.length&&(t=1);var i=this.norm();return i>1e-7?s.call(a,this.mult(t/i)):n.call(a,t,0,0)},e.prototype.clone=function(){return new e(this)},e.prototype.isZero=function(){return!(this.x||this.y||this.z)},e.prototype.set=function(t){return t instanceof Array?o.call(this,t):"number"==typeof t?r.call(this,t):s.call(this,t)},e.prototype.setXYZ=function(){return n.apply(this,arguments)},e.prototype.set1D=function(t){return r.call(this,t)},e.prototype.put=function(t){this===a?s.call(t,a):s.call(t,this)},e.prototype.clear=function(){return n.call(this,0,0,0)},e.prototype.cap=function h(h){if(1/0===h)return s.call(a,this);var t=this.norm();return t>h?s.call(a,this.mult(h/t)):s.call(a,this)},e.prototype.project=function(t){return t.mult(this.dot(t))},e.prototype.reflectAcross=function(t){return t.normalize().put(t),s(a,this.sub(this.project(t).mult(2)))},e.prototype.get=function(){return[this.x,this.y,this.z]},e.prototype.get1D=function(){return this.x},i.exports=e},{}],42:[function(t,i){i.exports={Matrix:t("./Matrix"),Quaternion:t("./Quaternion"),Random:t("./Random"),Utilities:t("./Utilities"),Vector:t("./Vector")}},{"./Matrix":37,"./Quaternion":38,"./Random":39,"./Utilities":40,"./Vector":41}],43:[function(t,i){function e(t){this.options=Object.create(e.DEFAULT_OPTIONS),t&&this.setOptions(t),this._positionState=new c([0,0]),this._differential=[0,0],this._active=!0,this.sync=new l(["mouse","touch"],{scale:this.options.scale}),this.eventOutput=new p,p.setInputHandler(this,this.sync),p.setOutputHandler(this,this.eventOutput),a.call(this)}function n(t){var i=this.options,e=i.projection,n=i.snapX,o=i.snapY,s=e&_.x?t[0]:0,r=e&_.y?t[1]:0;return n>0&&(s-=s%n),o>0&&(r-=r%o),[s,r]}function o(){this._active&&(this._positionState.isActive()&&this._positionState.halt(),this.eventOutput.emit("start",{position:this.getPosition()}))}function s(t){if(this._active){var i=this.options;this._differential=t.position;var e=n.call(this,this._differential);this._differential[0]-=e[0],this._differential[1]-=e[1];var o=this.getPosition();if(o[0]+=e[0],o[1]+=e[1],i.xRange){var s=[i.xRange[0]+.5*i.snapX,i.xRange[1]-.5*i.snapX];o[0]=y(o[0],s)}if(i.yRange){var r=[i.yRange[0]+.5*i.snapY,i.yRange[1]-.5*i.snapY];o[1]=y(o[1],r)}this.eventOutput.emit("update",{position:o})}}function r(){this._active&&this.eventOutput.emit("end",{position:this.getPosition()})}function a(){this.sync.on("start",o.bind(this)),this.sync.on("update",s.bind(this)),this.sync.on("end",r.bind(this))}var h=t("../core/Transform"),c=t("../transitions/Transitionable"),p=t("../core/EventHandler"),u=t("../math/Utilities"),l=t("../inputs/GenericSync"),f=t("../inputs/MouseSync"),d=t("../inputs/TouchSync");l.register({mouse:f,touch:d});var _={x:1,y:2};e.DIRECTION_X=_.x,e.DIRECTION_Y=_.y;var y=u.clamp;e.DEFAULT_OPTIONS={projection:_.x|_.y,scale:1,xRange:null,yRange:null,snapX:0,snapY:0,transition:{duration:0}},e.prototype.setOptions=function(t){var i=this.options;if(void 0!==t.projection){var e=t.projection;this.options.projection=0,["x","y"].forEach(function(t){-1!==e.indexOf(t)&&(i.projection|=_[t])})}void 0!==t.scale&&(i.scale=t.scale,this.sync.setOptions({scale:t.scale})),void 0!==t.xRange&&(i.xRange=t.xRange),void 0!==t.yRange&&(i.yRange=t.yRange),void 0!==t.snapX&&(i.snapX=t.snapX),void 0!==t.snapY&&(i.snapY=t.snapY)},e.prototype.getPosition=function(){return this._positionState.get()},e.prototype.setRelativePosition=function(t,i,e){var n=this.getPosition(),o=[n[0]+t[0],n[1]+t[1]];this.setPosition(o,i,e)},e.prototype.setPosition=function(t,i,e){this._positionState.isActive()&&this._positionState.halt(),this._positionState.set(t,i,e)},e.prototype.activate=function(){this._active=!0},e.prototype.deactivate=function(){this._active=!1},e.prototype.toggle=function(){this._active=!this._active},e.prototype.modify=function(t){var i=this.getPosition();return{transform:h.translate(i[0],i[1]),target:t}},i.exports=e},{"../core/EventHandler":7,"../core/Transform":15,"../inputs/GenericSync":27,"../inputs/MouseSync":28,"../inputs/TouchSync":33,"../math/Utilities":40,"../transitions/Transitionable":88}],44:[function(t,i){function e(t,i){this.options=Object.create(e.DEFAULT_OPTIONS),this._optionsManager=new o(this.options),t&&this.setOptions(t),i||(i=0),this.transitionHelper=new n(i)}var n=t("../transitions/Transitionable"),o=t("../core/OptionsManager");e.DEFAULT_OPTIONS={cull:!1,transition:!0,pulseInTransition:!0,pulseOutTransition:!0},e.prototype.setOptions=function(t){return this._optionsManager.setOptions(t)},e.prototype.show=function(t,i){t=t||this.options.transition,this.set(1,t,i)},e.prototype.hide=function(t,i){t=t||this.options.transition,this.set(0,t,i)},e.prototype.set=function(t,i,e){this.halt(),this.transitionHelper.set(t,i,e)},e.prototype.halt=function(){this.transitionHelper.halt()},e.prototype.isVisible=function(){return this.transitionHelper.get()>0},e.prototype.modify=function(t){var i=this.transitionHelper.get();return this.options.cull&&!i?void 0:{opacity:i,target:t}},i.exports=e},{"../core/OptionsManager":10,"../transitions/Transitionable":88}],45:[function(t,i){function e(){this._chain=[],arguments.length&&this.addModifier.apply(this,arguments)}e.prototype.addModifier=function(){Array.prototype.push.apply(this._chain,arguments)},e.prototype.removeModifier=function(t){var i=this._chain.indexOf(t);0>i||this._chain.splice(i,1)},e.prototype.modify=function(t){for(var i=this._chain,e=t,n=0;n<i.length;n++)e=i[n].modify(e);return e},i.exports=e},{}],46:[function(t,i){function e(t){this._transformState=new r(o.identity),this._opacityState=new s(1),this._originState=new s([0,0]),this._alignState=new s([0,0]),this._sizeState=new s([0,0]),this._proportionsState=new s([0,0]),this._modifier=new n({transform:this._transformState,opacity:this._opacityState,origin:null,align:null,size:null,proportions:null}),this._hasOrigin=!1,this._hasAlign=!1,this._hasSize=!1,this._hasProportions=!1,t&&(t.transform&&this.setTransform(t.transform),void 0!==t.opacity&&this.setOpacity(t.opacity),t.origin&&this.setOrigin(t.origin),t.align&&this.setAlign(t.align),t.size&&this.setSize(t.size),t.proportions&&this.setProportions(t.proportions))}var n=t("../core/Modifier"),o=t("../core/Transform"),s=t("../transitions/Transitionable"),r=t("../transitions/TransitionableTransform");e.prototype.setTransform=function(t,i,e){return this._transformState.set(t,i,e),this},e.prototype.setOpacity=function(t,i,e){return this._opacityState.set(t,i,e),this},e.prototype.setOrigin=function(t,i,e){return null===t?(this._hasOrigin&&(this._modifier.originFrom(null),this._hasOrigin=!1),this):(this._hasOrigin||(this._hasOrigin=!0,this._modifier.originFrom(this._originState)),this._originState.set(t,i,e),this)},e.prototype.setAlign=function(t,i,e){return null===t?(this._hasAlign&&(this._modifier.alignFrom(null),this._hasAlign=!1),this):(this._hasAlign||(this._hasAlign=!0,this._modifier.alignFrom(this._alignState)),this._alignState.set(t,i,e),this)},e.prototype.setSize=function(t,i,e){return null===t?(this._hasSize&&(this._modifier.sizeFrom(null),this._hasSize=!1),this):(this._hasSize||(this._hasSize=!0,this._modifier.sizeFrom(this._sizeState)),this._sizeState.set(t,i,e),this)},e.prototype.setProportions=function(t,i,e){return null===t?(this._hasProportions&&(this._modifier.proportionsFrom(null),this._hasProportions=!1),this):(this._hasProportions||(this._hasProportions=!0,this._modifier.proportionsFrom(this._proportionsState)),this._proportionsState.set(t,i,e),this)},e.prototype.halt=function(){this._transformState.halt(),this._opacityState.halt(),this._originState.halt(),this._alignState.halt(),this._sizeState.halt(),this._proportionsState.halt()},e.prototype.getTransform=function(){return this._transformState.get()},e.prototype.getFinalTransform=function(){return this._transformState.getFinal()},e.prototype.getOpacity=function(){return this._opacityState.get()},e.prototype.getOrigin=function(){return this._hasOrigin?this._originState.get():null},e.prototype.getAlign=function(){return this._hasAlign?this._alignState.get():null},e.prototype.getSize=function(){return this._hasSize?this._sizeState.get():null},e.prototype.getProportions=function(){return this._hasProportions?this._proportionsState.get():null},e.prototype.modify=function(t){return this._modifier.modify(t)},i.exports=e},{"../core/Modifier":9,"../core/Transform":15,"../transitions/Transitionable":88,"../transitions/TransitionableTransform":89}],47:[function(t,i){i.exports={Draggable:t("./Draggable"),Fader:t("./Fader"),ModifierChain:t("./ModifierChain"),StateModifier:t("./StateModifier")}},{"./Draggable":43,"./Fader":44,"./ModifierChain":45,"./StateModifier":46}],48:[function(t,i){function e(t){this.options=Object.create(e.DEFAULT_OPTIONS),t&&this.setOptions(t),this._particles=[],this._bodies=[],this._agentData={},this._forces=[],this._constraints=[],this._buffer=0,this._prevTime=S(),this._isSleeping=!1,this._eventHandler=null,this._currAgentId=0,this._hasBodies=!1,this._eventHandler=null}function n(t){return t.applyForce?this._forces:t.applyConstraint?this._constraints:void 0}function o(t,i,e){return void 0===i&&(i=this.getParticlesAndBodies()),i instanceof Array||(i=[i]),t.on("change",this.wake.bind(this)),this._agentData[this._currAgentId]={agent:t,id:this._currAgentId,targets:i,source:e},n.call(this,t).push(this._currAgentId),this._currAgentId++}function s(t){return this._agentData[t]}function r(t){var i=s.call(this,this._forces[t]);i.agent.applyForce(i.targets,i.source)}function a(){for(var t=this._forces.length-1;t>-1;t--)r.call(this,t)}function h(t,i){var e=this._agentData[this._constraints[t]];return e.agent.applyConstraint(e.targets,e.source,i)}function c(t){for(var i=0;i<this.options.constraintSteps;){for(var e=this._constraints.length-1;e>-1;e--)h.call(this,e,t);i++}}function p(t,i){t.integrateVelocity(i),this.options.velocityCap&&t.velocity.cap(this.options.velocityCap).put(t.velocity)}function u(t,i){t.integrateAngularMomentum(i),t.updateAngularVelocity(),this.options.angularVelocityCap&&t.angularVelocity.cap(this.options.angularVelocityCap).put(t.angularVelocity)}function l(t,i){t.integrateOrientation(i)}function f(t,i){t.integratePosition(i),t.emit(T.update,t)}function d(t){a.call(this,t),this.forEach(p,t),this.forEachBody(u,t),c.call(this,t),this.forEachBody(l,t),this.forEach(f,t)}function _(){var t=0,i=0;return this.forEach(function(e){i=e.getEnergy(),t+=i}),t}function y(){var t=0;for(var i in this._agentData)t+=this.getAgentEnergy(i);return t}var g=t("../core/EventHandler"),v=17,m=1e3/120,O=17,S=Date.now,T={start:"start",update:"update",end:"end"};e.DEFAULT_OPTIONS={constraintSteps:1,sleepTolerance:1e-7,velocityCap:void 0,angularVelocityCap:void 0},e.prototype.setOptions=function(t){for(var i in t)this.options[i]&&(this.options[i]=t[i])},e.prototype.addBody=function(t){return t._engine=this,t.isBody?(this._bodies.push(t),this._hasBodies=!0):this._particles.push(t),t.on("start",this.wake.bind(this)),t},e.prototype.removeBody=function(t){var i=t.isBody?this._bodies:this._particles,e=i.indexOf(t);if(e>-1){for(var n in this._agentData)this.detachFrom(n.id,t);i.splice(e,1)}0===this.getBodies().length&&(this._hasBodies=!1)},e.prototype.attach=function(t,i,e){if(this.wake(),t instanceof Array){for(var n=[],s=0;s<t.length;s++)n[s]=o.call(this,t[s],i,e);return n}return o.call(this,t,i,e)},e.prototype.attachTo=function(t,i){s.call(this,t).targets.push(i)},e.prototype.detach=function(t){var i=this.getAgent(t),e=n.call(this,i),o=e.indexOf(t);e.splice(o,1),delete this._agentData[t]},e.prototype.detachFrom=function(t,i){var e=s.call(this,t);if(e.source===i)this.detach(t);else{var n=e.targets,o=n.indexOf(i);o>-1&&n.splice(o,1)}},e.prototype.detachAll=function(){this._agentData={},this._forces=[],this._constraints=[],this._currAgentId=0},e.prototype.getAgent=function(t){return s.call(this,t).agent},e.prototype.getParticles=function(){return this._particles},e.prototype.getBodies=function(){return this._bodies},e.prototype.getParticlesAndBodies=function(){return this.getParticles().concat(this.getBodies())},e.prototype.forEachParticle=function(t,i){for(var e=this.getParticles(),n=0,o=e.length;o>n;n++)t.call(this,e[n],i)},e.prototype.forEachBody=function(t,i){if(this._hasBodies)for(var e=this.getBodies(),n=0,o=e.length;o>n;n++)t.call(this,e[n],i)},e.prototype.forEach=function(t,i){this.forEachParticle(t,i),this.forEachBody(t,i)},e.prototype.getAgentEnergy=function(t){var i=s.call(this,t);return i.agent.getEnergy(i.targets,i.source)},e.prototype.getEnergy=function(){return _.call(this)+y.call(this)},e.prototype.step=function(){if(!this.isSleeping()){var t=S(),i=t-this._prevTime;this._prevTime=t,m>i||(i>O&&(i=O),d.call(this,v),this.emit(T.update,this),this.getEnergy()<this.options.sleepTolerance&&this.sleep())}},e.prototype.isSleeping=function(){return this._isSleeping},e.prototype.isActive=function(){return!this._isSleeping},e.prototype.sleep=function(){this._isSleeping||(this.forEach(function(t){t.sleep()}),this.emit(T.end,this),this._isSleeping=!0)},e.prototype.wake=function(){this._isSleeping&&(this._prevTime=S(),this.emit(T.start,this),this._isSleeping=!1)},e.prototype.emit=function(t,i){null!==this._eventHandler&&this._eventHandler.emit(t,i)},e.prototype.on=function(t,i){null===this._eventHandler&&(this._eventHandler=new g),this._eventHandler.on(t,i)},i.exports=e},{"../core/EventHandler":7}],49:[function(t,i){function e(t){n.call(this,t),t=t||{},this.orientation=new r,this.angularVelocity=new s,this.angularMomentum=new s,this.torque=new s,t.orientation&&this.orientation.set(t.orientation),t.angularVelocity&&this.angularVelocity.set(t.angularVelocity),t.angularMomentum&&this.angularMomentum.set(t.angularMomentum),t.torque&&this.torque.set(t.torque),this.angularVelocity.w=0,this.setMomentsOfInertia(),this.pWorld=new s}var n=t("./Particle"),o=t("../../core/Transform"),s=t("../../math/Vector"),r=t("../../math/Quaternion"),a=t("../../math/Matrix"),h=t("../integrators/SymplecticEuler");e.DEFAULT_OPTIONS=n.DEFAULT_OPTIONS,e.DEFAULT_OPTIONS.orientation=[0,0,0,1],e.DEFAULT_OPTIONS.angularVelocity=[0,0,0],e.prototype=Object.create(n.prototype),e.prototype.constructor=e,e.prototype.isBody=!0,e.prototype.setMass=function(){n.prototype.setMass.apply(this,arguments),this.setMomentsOfInertia()},e.prototype.setMomentsOfInertia=function(){this.inertia=new a,this.inverseInertia=new a},e.prototype.updateAngularVelocity=function(){this.angularVelocity.set(this.inverseInertia.vectorMultiply(this.angularMomentum))},e.prototype.toWorldCoordinates=function(t){return this.pWorld.set(this.orientation.rotateVector(t))},e.prototype.getEnergy=function(){return n.prototype.getEnergy.call(this)+.5*this.inertia.vectorMultiply(this.angularVelocity).dot(this.angularVelocity)},e.prototype.reset=function(t,i,e,o){n.prototype.reset.call(this,t,i),this.angularVelocity.clear(),this.setOrientation(e||[1,0,0,0]),this.setAngularMomentum(o||[0,0,0])},e.prototype.setOrientation=function(t){this.orientation.set(t)},e.prototype.setAngularVelocity=function(t){this.wake(),this.angularVelocity.set(t)},e.prototype.setAngularMomentum=function(t){this.wake(),this.angularMomentum.set(t)},e.prototype.applyForce=function(t,i){n.prototype.applyForce.call(this,t),void 0!==i&&this.applyTorque(i.cross(t))},e.prototype.applyTorque=function(t){this.wake(),this.torque.set(this.torque.add(t))},e.prototype.getTransform=function(){return o.thenMove(this.orientation.getTransform(),o.getTranslate(n.prototype.getTransform.call(this)))},e.prototype._integrate=function(t){n.prototype._integrate.call(this,t),this.integrateAngularMomentum(t),this.updateAngularVelocity(t),this.integrateOrientation(t)},e.prototype.integrateAngularMomentum=function(t){h.integrateAngularMomentum(this,t)},e.prototype.integrateOrientation=function(t){h.integrateOrientation(this,t)},i.exports=e},{"../../core/Transform":15,"../../math/Matrix":37,"../../math/Quaternion":38,"../../math/Vector":41,"../integrators/SymplecticEuler":72,"./Particle":51}],50:[function(t,i){function e(t){t=t||{},this.setRadius(t.radius||0),n.call(this,t)}var n=t("./Body"),o=t("../../math/Matrix");e.prototype=Object.create(n.prototype),e.prototype.constructor=e,e.prototype.setRadius=function(t){this.radius=t,this.size=[2*this.radius,2*this.radius],this.setMomentsOfInertia()},e.prototype.setMomentsOfInertia=function(){var t=this.mass,i=this.radius;this.inertia=new o([[.25*t*i*i,0,0],[0,.25*t*i*i,0],[0,0,.5*t*i*i]]),this.inverseInertia=new o([[4/(t*i*i),0,0],[0,4/(t*i*i),0],[0,0,2/(t*i*i)]])},i.exports=e},{"../../math/Matrix":37,"./Body":49}],51:[function(t,i){function e(t){t=t||{};var i=e.DEFAULT_OPTIONS;this.position=new o,this.velocity=new o,this.force=new o,this._engine=null,this._isSleeping=!0,this._eventOutput=null,this.mass=void 0!==t.mass?t.mass:i.mass,this.inverseMass=1/this.mass,this.setPosition(t.position||i.position),this.setVelocity(t.velocity||i.velocity),this.force.set(t.force||[0,0,0]),this.transform=s.identity.slice(),this._spec={size:[!0,!0],target:{transform:this.transform,origin:[.5,.5],target:null}}}function n(){this._eventOutput=new r,this._eventOutput.bindThis(this),r.setOutputHandler(this,this._eventOutput)}var o=t("../../math/Vector"),s=t("../../core/Transform"),r=t("../../core/EventHandler"),a=t("../integrators/SymplecticEuler");e.DEFAULT_OPTIONS={position:[0,0,0],velocity:[0,0,0],mass:1};var h={start:"start",update:"update",end:"end"},c=Date.now;e.prototype.isBody=!1,e.prototype.isActive=function(){return!this._isSleeping},e.prototype.sleep=function(){this._isSleeping||(this.emit(h.end,this),this._isSleeping=!0)},e.prototype.wake=function(){this._isSleeping&&(this.emit(h.start,this),this._isSleeping=!1,this._prevTime=c(),this._engine&&this._engine.wake())},e.prototype.setPosition=function(t){this.position.set(t)},e.prototype.setPosition1D=function(t){this.position.x=t},e.prototype.getPosition=function(){return this._engine.step(),this.position.get()},e.prototype.getPosition1D=function(){return this._engine.step(),this.position.x},e.prototype.setVelocity=function(t){this.velocity.set(t),(0!==t[0]||0!==t[1]||0!==t[2])&&this.wake()},e.prototype.setVelocity1D=function(t){this.velocity.x=t,0!==t&&this.wake()},e.prototype.getVelocity=function(){return this.velocity.get()},e.prototype.setForce=function(t){this.force.set(t),this.wake()},e.prototype.getVelocity1D=function(){return this.velocity.x},e.prototype.setMass=function(t){this.mass=t,this.inverseMass=1/t},e.prototype.getMass=function(){return this.mass},e.prototype.reset=function(t,i){this.setPosition(t||[0,0,0]),this.setVelocity(i||[0,0,0])},e.prototype.applyForce=function(t){t.isZero()||(this.force.add(t).put(this.force),this.wake())},e.prototype.applyImpulse=function(t){if(!t.isZero()){var i=this.velocity;i.add(t.mult(this.inverseMass)).put(i)}},e.prototype.integrateVelocity=function(t){a.integrateVelocity(this,t)},e.prototype.integratePosition=function(t){a.integratePosition(this,t)},e.prototype._integrate=function(t){this.integrateVelocity(t),this.integratePosition(t)},e.prototype.getEnergy=function(){return.5*this.mass*this.velocity.normSquared()},e.prototype.getTransform=function(){this._engine.step();var t=this.position,i=this.transform;return i[12]=t.x,i[13]=t.y,i[14]=t.z,i},e.prototype.modify=function(t){var i=this._spec.target;return i.transform=this.getTransform(),i.target=t,this._spec},e.prototype.emit=function(t,i){this._eventOutput&&this._eventOutput.emit(t,i)},e.prototype.on=function(){return n.call(this),this.on.apply(this,arguments)},e.prototype.removeListener=function(){return n.call(this),this.removeListener.apply(this,arguments)},e.prototype.pipe=function(){return n.call(this),this.pipe.apply(this,arguments)},e.prototype.unpipe=function(){return n.call(this),this.unpipe.apply(this,arguments)},i.exports=e},{"../../core/EventHandler":7,"../../core/Transform":15,"../../math/Vector":41,"../integrators/SymplecticEuler":72}],52:[function(t,i){function e(t){t=t||{},this.size=t.size||[0,0],n.call(this,t)}var n=t("./Body"),o=t("../../math/Matrix");e.prototype=Object.create(n.prototype),e.prototype.constructor=e,e.prototype.setSize=function(t){this.size=t,this.setMomentsOfInertia()},e.prototype.setMomentsOfInertia=function(){var t=this.mass,i=this.size[0],e=this.size[1];this.inertia=new o([[t*e*e/12,0,0],[0,t*i*i/12,0],[0,0,t*(i*i+e*e)/12]]),this.inverseInertia=new o([[12/(t*e*e),0,0],[0,12/(t*i*i),0],[0,0,12/(t*(i*i+e*e))]])},i.exports=e},{"../../math/Matrix":37,"./Body":49}],53:[function(t,i){i.exports={Body:t("./Body"),Circle:t("./Circle"),Particle:t("./Particle"),Rectangle:t("./Rectangle")}},{"./Body":49,"./Circle":50,"./Particle":51,"./Rectangle":52}],54:[function(t,i){function e(t){this.options=Object.create(e.DEFAULT_OPTIONS),t&&this.setOptions(t),this.normal=new o,this.pDiff=new o,this.vDiff=new o,this.impulse1=new o,this.impulse2=new o,n.call(this)}var n=t("./Constraint"),o=t("../../math/Vector");e.prototype=Object.create(n.prototype),e.prototype.constructor=e,e.DEFAULT_OPTIONS={restitution:.5,drift:.5,slop:0},e.prototype.setOptions=function(t){for(var i in t)this.options[i]=t[i]},e.prototype.applyConstraint=function(t,i,e){if(void 0!==i)for(var n=i.velocity,o=i.position,s=i.inverseMass,r=i.radius,a=this.options,h=a.drift,c=-a.slop,p=a.restitution,u=this.normal,l=this.pDiff,f=this.vDiff,d=this.impulse1,_=this.impulse2,y=0;y<t.length;y++){var g=t[y];if(g!==i){var v=g.velocity,m=g.position,O=g.inverseMass,S=g.radius;l.set(m.sub(o)),f.set(v.sub(n));var T=l.norm(),w=T-(r+S),b=1/(s+O),E=0;if(0>w){if(u.set(l.normalize()),this._eventOutput){var I={target:g,source:i,overlap:w,normal:u};this._eventOutput.emit("preCollision",I),this._eventOutput.emit("collision",I)}var x=c>=w?((1+p)*u.dot(f)+h/e*(w-c))/(E+e/b):(1+p)*u.dot(f)/(E+e/b);u.mult(e*x).put(d),d.mult(-1).put(_),i.applyImpulse(d),g.applyImpulse(_),this._eventOutput&&this._eventOutput.emit("postCollision",I)}}}},i.exports=e},{"../../math/Vector":41,"./Constraint":55}],55:[function(t,i){function e(){this.options=this.options||{},this._eventOutput=new n,n.setOutputHandler(this,this._eventOutput)}var n=t("../../core/EventHandler");e.prototype.setOptions=function(t){this._eventOutput.emit("change",t)},e.prototype.applyConstraint=function(){},e.prototype.getEnergy=function(){return 0},i.exports=e},{"../../core/EventHandler":7}],56:[function(t,i){function e(t){this.options=Object.create(e.DEFAULT_OPTIONS),t&&this.setOptions(t),this.J=new o,this.impulse=new o,n.call(this)}var n=t("./Constraint"),o=t("../../math/Vector");e.prototype=Object.create(n.prototype),e.prototype.constructor=e;var s=1e-7,r=Math.PI;e.DEFAULT_OPTIONS={equation:function(){return 0},plane:function(t,i,e){return e},period:0,dampingRatio:0},e.prototype.setOptions=function(t){for(var i in t)this.options[i]=t[i]},e.prototype.applyConstraint=function(t,i,e){for(var n=this.options,o=this.impulse,a=this.J,h=n.equation,c=n.plane,p=n.dampingRatio,u=n.period,l=0;l<t.length;l++){var f,d,_=t[l],y=_.velocity,g=_.position,v=_.mass;if(0===u)f=0,d=1;else{var m=4*v*r*p/u,O=4*v*r*r/(u*u);f=1/(m+e*O),d=e*O/(m+e*O)}var S=g.x,T=g.y,w=g.z,b=h(S,T,w),E=(h(S+s,g,g)-b)/s,I=(h(S,T+s,g)-b)/s,x=(h(S,T,g+s)-b)/s,M=c(S,T,w),z=(c(S+s,T,w)-M)/s,C=(c(S,T+s,w)-M)/s,P=(c(S,T,w+s)-M)/s;a.setXYZ(E+z,I+C,x+P);var F=d/e*(b+M),D=-(a.dot(y)+F)/(f+e*a.normSquared()/v);o.set(a.mult(e*D)),_.applyImpulse(o)}},i.exports=e},{"../../math/Vector":41,"./Constraint":55}],57:[function(t,i){function e(t){this.options=Object.create(this.constructor.DEFAULT_OPTIONS),t&&this.setOptions(t),this.impulse=new o,this.normal=new o,this.diffP=new o,this.diffV=new o,n.call(this)}var n=t("./Constraint"),o=t("../../math/Vector");e.prototype=Object.create(n.prototype),e.prototype.constructor=e,e.DEFAULT_OPTIONS={anchor:null,length:0,minLength:0,period:0,dampingRatio:0};var s=Math.PI;e.prototype.setOptions=function(t){t.anchor&&(t.anchor.position instanceof o&&(this.options.anchor=t.anchor.position),t.anchor instanceof o&&(this.options.anchor=t.anchor),t.anchor instanceof Array&&(this.options.anchor=new o(t.anchor))),void 0!==t.length&&(this.options.length=t.length),void 0!==t.dampingRatio&&(this.options.dampingRatio=t.dampingRatio),void 0!==t.period&&(this.options.period=t.period),void 0!==t.minLength&&(this.options.minLength=t.minLength)},e.prototype.setAnchor=function(t){this.options.anchor||(this.options.anchor=new o),this.options.anchor.set(t)},e.prototype.applyConstraint=function(t,i,e){var n,o,r=this.normal,a=this.diffP,h=this.diffV,c=this.impulse,p=this.options,u=p.dampingRatio,l=p.period,f=p.minLength;if(i){var d=i.velocity;n=i.position,o=i.inverseMass}else n=this.options.anchor,o=0;for(var _=this.options.length,y=0;y<t.length;y++){var g=t[y],v=g.velocity,m=g.position,O=g.inverseMass;a.set(m.sub(n)),r.set(a.normalize());var S=a.norm()-_;if(Math.abs(S)<f)return;h.set(i?v.sub(d):v);var T,w,b=1/(O+o);if(0===l)T=0,w=1;else{var E=4*b*s*u/l,I=4*b*s*s/(l*l);T=1/(E+e*I),w=e*I/(E+e*I)}var x=w/e*S,M=-(r.dot(h)+x)/(T+e/b);c.set(r.mult(e*M)),g.applyImpulse(c),i&&i.applyImpulse(c.mult(-1))}},i.exports=e},{"../../math/Vector":41,"./Constraint":55}],58:[function(t,i){function e(t){n.call(this),this.options=Object.create(this.constructor.DEFAULT_OPTIONS),t&&this.setOptions(t),this.pDiff=new o,this.vDiff=new o,this.impulse1=new o,this.impulse2=new o}var n=t("./Constraint"),o=t("../../math/Vector");e.prototype=Object.create(n.prototype),e.prototype.constructor=e,e.DEFAULT_OPTIONS={period:300,dampingRatio:.1,length:0,anchor:void 0};var s=Math.PI;e.prototype.setOptions=function(t){void 0!==t.anchor&&(t.anchor instanceof o&&(this.options.anchor=t.anchor),t.anchor.position instanceof o&&(this.options.anchor=t.anchor.position),t.anchor instanceof Array&&(this.options.anchor=new o(t.anchor))),void 0!==t.length&&(this.options.length=t.length),void 0!==t.dampingRatio&&(this.options.dampingRatio=t.dampingRatio),void 0!==t.period&&(this.options.period=t.period),n.prototype.setOptions.call(this,t)},e.prototype.getEnergy=function(t,i){for(var e=this.options,n=e.length,o=e.anchor||i.position,r=Math.pow(2*s/e.period,2),a=0,h=0;h<t.length;h++){var c=t[h],p=o.sub(c.position).norm()-n;a+=.5*r*p*p}return a},e.prototype.applyConstraint=function(t,i,e){for(var n=this.options,o=this.pDiff,r=this.vDiff,a=this.impulse1,h=this.impulse2,c=n.length,p=n.anchor||i.position,u=n.period,l=n.dampingRatio,f=0;f<t.length;f++){var d=t[f],_=d.position,y=d.velocity,g=d.mass,v=d.inverseMass;
o.set(_.sub(p));var m,O=o.norm()-c;if(i){var S=i.inverseMass,T=i.velocity;r.set(y.sub(T)),m=1/(v+S)}else r.set(y),m=g;var w,b;if(0===this.options.period)w=0,b=1;else{var E=4*m*s*s/(u*u),I=4*m*s*l/u;b=e*E/(I+e*E),w=1/(I+e*E)}var x=b/e*O;o.normalize(-x).sub(r).mult(e/(w+e/m)).put(a),d.applyImpulse(a),i&&(a.mult(-1).put(h),i.applyImpulse(h))}},i.exports=e},{"../../math/Vector":41,"./Constraint":55}],59:[function(t,i){function e(t){this.options=Object.create(e.DEFAULT_OPTIONS),t&&this.setOptions(t),this.J=new o,this.impulse=new o,n.call(this)}var n=t("./Constraint"),o=t("../../math/Vector");e.prototype=Object.create(n.prototype),e.prototype.constructor=e,e.DEFAULT_OPTIONS={equation:void 0,period:0,dampingRatio:0};var s=1e-7,r=Math.PI;e.prototype.setOptions=function(t){for(var i in t)this.options[i]=t[i]},e.prototype.applyConstraint=function(t,i,e){for(var n=this.impulse,o=this.J,a=this.options,h=a.equation,c=a.dampingRatio,p=a.period,u=0;u<t.length;u++){var l,f,d=t[u],_=d.velocity,y=d.position,g=d.mass;if(0===p)l=0,f=1;else{var v=4*g*r*c/p,m=4*g*r*r/(p*p);l=1/(v+e*m),f=e*m/(v+e*m)}var O=y.x,S=y.y,T=y.z,w=h(O,S,T),b=(h(O+s,y,y)-w)/s,E=(h(O,S+s,y)-w)/s,I=(h(O,S,y+s)-w)/s;o.setXYZ(b,E,I);var x=f/e*w,M=-(o.dot(_)+x)/(l+e*o.normSquared()/g);n.set(o.mult(e*M)),d.applyImpulse(n)}},i.exports=e},{"../../math/Vector":41,"./Constraint":55}],60:[function(t,i){function e(t){this.options=Object.create(e.DEFAULT_OPTIONS),t&&this.setOptions(t),this.diff=new h,this.impulse=new h,a.call(this)}function n(t,i){return i.dot(t)}function o(t){var i=this.options.normal,e=this.options.distance;return t.dot(i)+e}function s(t,i,n){var o=t.position,s=t.velocity,r=t.mass,a=this.options.normal,h=this.options.onContact,c=this.options.restitution,p=this.impulse,u=this.options.drift,l=-this.options.slop,f=0;if(this._eventOutput){var d={particle:t,wall:this,overlap:i,normal:a};this._eventOutput.emit("preCollision",d),this._eventOutput.emit("collision",d)}switch(h){case e.ON_CONTACT.REFLECT:var _=l>i?-((1+c)*a.dot(s)+u/n*(i-l))/(r*n+f):-((1+c)*a.dot(s))/(r*n+f);p.set(a.mult(n*_)),t.applyImpulse(p),t.setPosition(o.add(a.mult(-i)))}this._eventOutput&&this._eventOutput.emit("postCollision",d)}function r(t,i){var n=this.options.onContact,o=t.position,s=this.options.normal;n===e.ON_CONTACT.REFLECT&&t.setPosition(o.add(s.mult(-i)))}var a=t("./Constraint"),h=t("../../math/Vector");e.prototype=Object.create(a.prototype),e.prototype.constructor=e,e.ON_CONTACT={REFLECT:0,SILENT:1},e.DEFAULT_OPTIONS={restitution:.5,drift:.5,slop:0,normal:[1,0,0],distance:0,onContact:e.ON_CONTACT.REFLECT},e.prototype.setOptions=function(t){void 0!==t.normal&&(t.normal instanceof h&&(this.options.normal=t.normal.clone()),t.normal instanceof Array&&(this.options.normal=new h(t.normal))),void 0!==t.restitution&&(this.options.restitution=t.restitution),void 0!==t.drift&&(this.options.drift=t.drift),void 0!==t.slop&&(this.options.slop=t.slop),void 0!==t.distance&&(this.options.distance=t.distance),void 0!==t.onContact&&(this.options.onContact=t.onContact)},e.prototype.applyConstraint=function(t,i,e){for(var a=this.options.normal,h=0;h<t.length;h++){var c=t[h],p=c.position,u=c.velocity,l=c.radius||0,f=o.call(this,p.add(a.mult(-l))),d=n.call(this,a,u);0>=f&&(0>d?s.call(this,c,f,e):r.call(this,c,f,e))}},i.exports=e},{"../../math/Vector":41,"./Constraint":55}],61:[function(t,i){function e(t){this.options=Object.create(e.DEFAULT_OPTIONS),t&&this.setOptions(t),o.call(this,t.sides||this.options.sides),r.call(this)}function n(t,i,n){var o,s=e.SIDES;switch(parseInt(t)){case s.LEFT:o=i[0]*n[0];break;case s.TOP:o=i[1]*n[1];break;case s.FRONT:o=i[2]*n[2];break;case s.RIGHT:o=i[0]*(1-n[0]);break;case s.BOTTOM:o=i[1]*(1-n[1]);break;case s.BACK:o=i[2]*(1-n[2])}return o}function o(t){this.components={};for(var i=this.components,e=0;e<t.length;e++){var o=t[e];i[e]=new a({normal:c[o].clone(),distance:n(o,this.options.size,this.options.origin)})}}function s(t){this.forEach(function(i){i.setOptions(t)});for(var i in t)this.options[i]=t[i]}var r=t("./Constraint"),a=t("./Wall"),h=t("../../math/Vector");e.prototype=Object.create(r.prototype),e.prototype.constructor=e,e.ON_CONTACT=a.ON_CONTACT,e.SIDES={LEFT:0,RIGHT:1,TOP:2,BOTTOM:3,FRONT:4,BACK:5,TWO_DIMENSIONAL:[0,1,2,3],THREE_DIMENSIONAL:[0,1,2,3,4,5]},e.DEFAULT_OPTIONS={sides:e.SIDES.TWO_DIMENSIONAL,size:[window.innerWidth,window.innerHeight,0],origin:[.5,.5,.5],drift:.5,slop:0,restitution:.5,onContact:e.ON_CONTACT.REFLECT};var c={0:new h(1,0,0),1:new h(-1,0,0),2:new h(0,1,0),3:new h(0,-1,0),4:new h(0,0,1),5:new h(0,0,-1)};e.prototype.setOptions=function(t){var i=!1;void 0!==t.restitution&&s.call(this,{restitution:t.restitution}),void 0!==t.drift&&s.call(this,{drift:t.drift}),void 0!==t.slop&&s.call(this,{slop:t.slop}),void 0!==t.onContact&&s.call(this,{onContact:t.onContact}),void 0!==t.size&&(i=!0),void 0!==t.sides&&(this.options.sides=t.sides),void 0!==t.origin&&(i=!0),i&&this.setSize(t.size,t.origin)},e.prototype.setSize=function(t,i){i=i||this.options.origin,i.length<3&&(i[2]=.5),this.forEach(function(e,o){var s=n(o,t,i);e.setOptions({distance:s})}),this.options.size=t,this.options.origin=i},e.prototype.applyConstraint=function(t,i,e){this.forEach(function(n){n.applyConstraint(t,i,e)})},e.prototype.forEach=function(t){var i=this.options.sides;for(var e in this.sides)t(i[e],e)},e.prototype.rotateZ=function(t){this.forEach(function(i){var e=i.options.normal;e.rotateZ(t).put(e)})},e.prototype.rotateX=function(t){this.forEach(function(i){var e=i.options.normal;e.rotateX(t).put(e)})},e.prototype.rotateY=function(t){this.forEach(function(i){var e=i.options.normal;e.rotateY(t).put(e)})},i.exports=e},{"../../math/Vector":41,"./Constraint":55,"./Wall":60}],62:[function(t,i){i.exports={Collision:t("./Collision"),Constraint:t("./Constraint"),Curve:t("./Curve"),Distance:t("./Distance"),Snap:t("./Snap"),Surface:t("./Surface"),Wall:t("./Wall"),Walls:t("./Walls")}},{"./Collision":54,"./Constraint":55,"./Curve":56,"./Distance":57,"./Snap":58,"./Surface":59,"./Wall":60,"./Walls":61}],63:[function(t,i){function e(t){this.options=Object.create(this.constructor.DEFAULT_OPTIONS),t&&this.setOptions(t),n.call(this)}var n=t("./Force");e.prototype=Object.create(n.prototype),e.prototype.constructor=e,e.FORCE_FUNCTIONS={LINEAR:function(t){return t},QUADRATIC:function(t){return t.mult(t.norm())}},e.DEFAULT_OPTIONS={strength:.01,forceFunction:e.FORCE_FUNCTIONS.LINEAR},e.prototype.applyForce=function(t){var i,e,n=this.options.strength,o=this.options.forceFunction,s=this.force;for(i=0;i<t.length;i++)e=t[i],o(e.velocity).mult(-n).put(s),e.applyForce(s)},e.prototype.setOptions=function(t){for(var i in t)this.options[i]=t[i]},i.exports=e},{"./Force":64}],64:[function(t,i){function e(t){this.force=new n(t),this._eventOutput=new o,o.setOutputHandler(this,this._eventOutput)}var n=t("../../math/Vector"),o=t("../../core/EventHandler");e.prototype.setOptions=function(t){this._eventOutput.emit("change",t)},e.prototype.applyForce=function(t){for(var i=t.length;i--;)t[i].applyForce(this.force)},e.prototype.getEnergy=function(){return 0},i.exports=e},{"../../core/EventHandler":7,"../../math/Vector":41}],65:[function(t,i){function e(t){this.options=Object.create(e.DEFAULT_OPTIONS),t&&this.setOptions(t),this.disp=new o,n.call(this)}var n=t("./Force"),o=t("../../math/Vector");e.prototype=Object.create(n.prototype),e.prototype.constructor=e,e.DECAY_FUNCTIONS={LINEAR:function(t,i){return Math.max(1-1/i*t,0)},MORSE:function(t,i){var e=0===i?100:i,n=t+e*(1-Math.log(2));return Math.max(1-Math.pow(1-Math.exp(n/e-1),2),0)},INVERSE:function(t,i){return 1/(1-i+t)},GRAVITY:function(t,i){return 1/(1-i+t*t)}},e.DEFAULT_OPTIONS={strength:1,anchor:void 0,range:[0,1/0],cutoff:0,cap:1/0,decayFunction:e.DECAY_FUNCTIONS.GRAVITY},e.prototype.setOptions=function(t){void 0!==t.anchor&&(t.anchor.position instanceof o&&(this.options.anchor=t.anchor.position),t.anchor instanceof Array&&(this.options.anchor=new o(t.anchor)),delete t.anchor);for(var i in t)this.options[i]=t[i]},e.prototype.applyForce=function(t,i){var e=this.options,n=this.force,o=this.disp,s=e.strength,r=e.anchor||i.position,a=e.cap,h=e.cutoff,c=e.range[0],p=e.range[1],u=e.decayFunction;if(0!==s)for(var l,f,d,_,y=t.length;y--;)l=t[y],l!==i&&(f=l.mass,d=l.position,o.set(d.sub(r)),_=o.norm(),p>_&&_>c&&(n.set(o.normalize(s*f*u(_,h)).cap(a)),l.applyForce(n)))},i.exports=e},{"../../math/Vector":41,"./Force":64}],66:[function(t,i){function e(t){n.call(this,t)}var n=t("./Drag");e.prototype=Object.create(n.prototype),e.prototype.constructor=e,e.DEFAULT_OPTIONS=n.DEFAULT_OPTIONS,e.FORCE_FUNCTIONS=n.FORCE_FUNCTIONS,e.FORCE_FUNCTIONS={LINEAR:function(t){return t},QUADRATIC:function(t){return t.mult(t.norm())}},e.prototype.applyForce=function(t){var i,e,n=this.options.strength,o=this.options.forceFunction,s=this.force;for(i=0;i<t.length;i++)e=t[i],o(e.angularVelocity).mult(-100*n).put(s),e.applyTorque(s)},e.prototype.setOptions=function(t){for(var i in t)this.options[i]=t[i]},i.exports=e},{"./Drag":63}],67:[function(t,i){function e(t){a.call(this,t)}function n(){var t=this.options;t.stiffness=Math.pow(2*c/t.period,2)}function o(){var t=this.options;t.damping=4*c*t.dampingRatio/t.period}function s(){n.call(this),o.call(this)}var r=t("./Force"),a=t("./Spring"),h=t("../../math/Quaternion");e.prototype=Object.create(a.prototype),e.prototype.constructor=e,e.DEFAULT_OPTIONS=a.DEFAULT_OPTIONS,e.FORCE_FUNCTIONS=a.FORCE_FUNCTIONS;var c=Math.PI;e.prototype.setOptions=function(t){void 0!==t.anchor&&(t.anchor instanceof h&&(this.options.anchor=t.anchor),t.anchor instanceof Array&&(this.options.anchor=new h(t.anchor))),void 0!==t.period&&(this.options.period=t.period),void 0!==t.dampingRatio&&(this.options.dampingRatio=t.dampingRatio),void 0!==t.length&&(this.options.length=t.length),void 0!==t.forceFunction&&(this.options.forceFunction=t.forceFunction),void 0!==t.maxLength&&(this.options.maxLength=t.maxLength),s.call(this),r.prototype.setOptions.call(this,t)},e.prototype.applyForce=function(t){var i,e,n,o,s=this.force,r=this.options,a=this.disp,h=r.stiffness,c=r.damping,p=r.length,u=r.anchor,l=r.forceFunction,f=r.maxLength;for(i=0;i<t.length;i++){if(e=t[i],a.set(u.sub(e.orientation)),n=a.norm()-p,0===n)return;o=e.mass,h*=o,c*=o,s.set(a.normalize(h*l(n,f))),c&&s.add(e.angularVelocity.mult(-c)).put(s),e.applyTorque(s)}},e.prototype.getEnergy=function(t){for(var i=this.options,e=i.length,n=i.anchor,o=i.stiffness,s=0,r=0;r<t.length;r++){var a=t[r],h=n.sub(a.orientation).norm()-e;s+=.5*o*h*h}return s},i.exports=e},{"../../math/Quaternion":38,"./Force":64,"./Spring":68}],68:[function(t,i){function e(t){r.call(this),this.options=Object.create(this.constructor.DEFAULT_OPTIONS),t&&this.setOptions(t),this.disp=new a(0,0,0),s.call(this)}function n(){var t=this.options;t.stiffness=Math.pow(2*h/t.period,2)}function o(){var t=this.options;t.damping=4*h*t.dampingRatio/t.period}function s(){n.call(this),o.call(this)}var r=t("./Force"),a=t("../../math/Vector");e.prototype=Object.create(r.prototype),e.prototype.constructor=e;var h=Math.PI,c=150;e.FORCE_FUNCTIONS={FENE:function(t,i){var e=.99*i,n=Math.max(Math.min(t,e),-e);return n/(1-n*n/(i*i))},HOOK:function(t){return t}},e.DEFAULT_OPTIONS={period:300,dampingRatio:.1,length:0,maxLength:1/0,anchor:void 0,forceFunction:e.FORCE_FUNCTIONS.HOOK},e.prototype.setOptions=function(t){void 0!==t.anchor&&(t.anchor.position instanceof a&&(this.options.anchor=t.anchor.position),t.anchor instanceof a&&(this.options.anchor=t.anchor),t.anchor instanceof Array&&(this.options.anchor=new a(t.anchor))),void 0!==t.period&&(t.period<c&&(t.period=c,console.warn("The period of a SpringTransition is capped at "+c+" ms. Use a SnapTransition for faster transitions")),this.options.period=t.period),void 0!==t.dampingRatio&&(this.options.dampingRatio=t.dampingRatio),void 0!==t.length&&(this.options.length=t.length),void 0!==t.forceFunction&&(this.options.forceFunction=t.forceFunction),void 0!==t.maxLength&&(this.options.maxLength=t.maxLength),s.call(this),r.prototype.setOptions.call(this,t)},e.prototype.applyForce=function(t,i){var e,n,o,s,r,a,h=this.force,c=this.disp,p=this.options,u=p.stiffness,l=p.damping,f=p.length,d=p.maxLength,_=p.anchor||i.position,y=p.forceFunction;for(e=0;e<t.length;e++){if(n=t[e],o=n.position,s=n.velocity,_.sub(o).put(c),r=c.norm()-f,0===r)return;a=n.mass,u*=a,l*=a,c.normalize(u*y(r,d)).put(h),l&&(i?h.add(s.sub(i.velocity).mult(-l)).put(h):h.add(s.mult(-l)).put(h)),n.applyForce(h),i&&i.applyForce(h.mult(-1))}},e.prototype.getEnergy=function(t,i){for(var e=this.options,n=e.length,o=i?i.position:e.anchor,s=e.stiffness,r=0,a=0;a<t.length;a++){var h=t[a],c=o.sub(h.position).norm()-n;r+=.5*s*c*c}return r},i.exports=e},{"../../math/Vector":41,"./Force":64}],69:[function(t,i){function e(t){o.call(this),this.options=Object.create(e.DEFAULT_OPTIONS),t&&this.setOptions(t),this.evaluation=new s}function n(t){var i=e.FIELDS;switch(t){case i.CONSTANT:this.options.direction?this.options.direction instanceof Array&&(this.options.direction=new s(this.options.direction)):this.options.direction=new s(0,1,0);break;case i.POINT_ATTRACTOR:this.options.position?this.options.position instanceof Array&&(this.options.position=new s(this.options.position)):this.options.position=new s(0,0,0)}}var o=t("./Force"),s=t("../../math/Vector");e.prototype=Object.create(o.prototype),e.prototype.constructor=e,e.FIELDS={CONSTANT:function(t,i){i.direction.put(this.evaluation)},LINEAR:function(t){t.put(this.evaluation)},RADIAL:function(t){t.mult(-1).put(this.evaluation)},POINT_ATTRACTOR:function(t,i){i.position.sub(t).put(this.evaluation)}},e.DEFAULT_OPTIONS={strength:.01,field:e.FIELDS.CONSTANT},e.prototype.setOptions=function(t){void 0!==t.strength&&(this.options.strength=t.strength),void 0!==t.field&&(this.options.field=t.field,n.call(this,this.options.field))},e.prototype.applyForce=function(t){var i,e,n=this.force,o=this.options.strength,s=this.options.field;for(i=0;i<t.length;i++)e=t[i],s.call(this,e.position,this.options),this.evaluation.mult(e.mass*o).put(n),e.applyForce(n)},e.prototype.getEnergy=function(t){var i,n,o=this.options.field,s=e.FIELDS,r=0;switch(o){case s.CONSTANT:r=t.length*this.options.direction.norm();break;case s.RADIAL:for(i=0;i<t.length;i++)n=t[i],r+=n.position.norm();break;case s.POINT_ATTRACTOR:for(i=0;i<t.length;i++)n=t[i],r+=n.position.sub(this.options.position).norm()}return r*=this.options.strength},i.exports=e},{"../../math/Vector":41,"./Force":64}],70:[function(t,i){i.exports={Drag:t("./Drag"),Force:t("./Force"),Repulsion:t("./Repulsion"),RotationalDrag:t("./RotationalDrag"),RotationalSpring:t("./RotationalSpring"),Spring:t("./Spring"),VectorField:t("./VectorField")}},{"./Drag":63,"./Force":64,"./Repulsion":65,"./RotationalDrag":66,"./RotationalSpring":67,"./Spring":68,"./VectorField":69}],71:[function(t,i){i.exports={PhysicsEngine:t("./PhysicsEngine"),bodies:t("./bodies"),constraints:t("./constraints"),forces:t("./forces"),integrators:t("./integrators")}},{"./PhysicsEngine":48,"./bodies":53,"./constraints":62,"./forces":70,"./integrators":73}],72:[function(t,i){var e={};e.integrateVelocity=function(t,i){var e=t.velocity,n=t.inverseMass,o=t.force;o.isZero()||(e.add(o.mult(i*n)).put(e),o.clear())},e.integratePosition=function(t,i){var e=t.position,n=t.velocity;e.add(n.mult(i)).put(e)},e.integrateAngularMomentum=function(t,i){var e=t.angularMomentum,n=t.torque;n.isZero()||(e.add(n.mult(i)).put(e),n.clear())},e.integrateOrientation=function(t,i){var e=t.orientation,n=t.angularVelocity;n.isZero()||e.add(e.multiply(n).scalarMultiply(.5*i)).put(e)},i.exports=e},{}],73:[function(t,i){i.exports={SymplecticEuler:t("./SymplecticEuler")}},{"./SymplecticEuler":72}],74:[function(t,i){function e(t){t&&t.canvasSize&&(this._canvasSize=t.canvasSize),n.apply(this,arguments),this._canvasSize||(this._canvasSize=this.getSize()),this._backBuffer=document.createElement("canvas"),this._canvasSize&&(this._backBuffer.width=this._canvasSize[0],this._backBuffer.height=this._canvasSize[1]),this._contextId=void 0}var n=t("../core/Surface");e.prototype=Object.create(n.prototype),e.prototype.constructor=e,e.prototype.elementType="canvas",e.prototype.elementClass="famous-surface",e.prototype.setContent=function(){},e.prototype.deploy=function(t){this._canvasSize&&(t.width=this._canvasSize[0],t.height=this._canvasSize[1]),"2d"===this._contextId&&(t.getContext(this._contextId).drawImage(this._backBuffer,0,0),this._backBuffer.width=0,this._backBuffer.height=0)},e.prototype.recall=function(t){this.getSize();this._backBuffer.width=t.width,this._backBuffer.height=t.height,"2d"===this._contextId&&(this._backBuffer.getContext(this._contextId).drawImage(t,0,0),t.width=0,t.height=0)},e.prototype.getContext=function(t){return this._contextId=t,this._currentTarget?this._currentTarget.getContext(t):this._backBuffer.getContext(t)},e.prototype.setSize=function(t,i){n.prototype.setSize.apply(this,arguments),i&&(this._canvasSize=[i[0],i[1]]),this._currentTarget&&(this._currentTarget.width=this._canvasSize[0],this._currentTarget.height=this._canvasSize[1])},i.exports=e},{"../core/Surface":14}],75:[function(t,i){function e(t){n.call(this,t),this._container=document.createElement("div"),this._container.classList.add("famous-group"),this._container.classList.add("famous-container-group"),this._shouldRecalculateSize=!1,this.context=new o(this._container),this.setContent(this._container)}var n=t("../core/Surface"),o=t("../core/Context");e.prototype=Object.create(n.prototype),e.prototype.constructor=e,e.prototype.elementType="div",e.prototype.elementClass="famous-surface",e.prototype.add=function(){return this.context.add.apply(this.context,arguments)},e.prototype.render=function(){return this._sizeDirty&&(this._shouldRecalculateSize=!0),n.prototype.render.apply(this,arguments)},e.prototype.deploy=function(){return this._shouldRecalculateSize=!0,n.prototype.deploy.apply(this,arguments)},e.prototype.commit=function(){var t=this._size?[this._size[0],this._size[1]]:null,i=n.prototype.commit.apply(this,arguments);return(this._shouldRecalculateSize||t&&(this._size[0]!==t[0]||this._size[1]!==t[1]))&&(this.context.setSize(),this._shouldRecalculateSize=!1),this.context.update(),i},i.exports=e},{"../core/Context":1,"../core/Surface":14}],76:[function(t,i){function e(t){t&&(this._method=t.method||""),n.apply(this,arguments)}var n=t("./ContainerSurface");e.prototype=Object.create(n.prototype),e.prototype.constructor=e,e.prototype.elementType="form",e.prototype.deploy=function(t){return this._method&&(t.method=this._method),n.prototype.deploy.apply(this,arguments)},i.exports=e},{"./ContainerSurface":75}],77:[function(t,i){function e(){this._imageUrl=void 0,n.apply(this,arguments)}var n=t("../core/Surface"),o=[],s=[],r=[],a=!0;e.enableCache=function(){a=!0},e.disableCache=function(){a=!1},e.clearCache=function(){o=[],s=[],r=[]},e.getCache=function(){return{urlCache:o,countCache:s,nodeCache:s}},e.prototype=Object.create(n.prototype),e.prototype.constructor=e,e.prototype.elementType="img",e.prototype.elementClass="famous-surface",e.prototype.setContent=function(t){var i=o.indexOf(this._imageUrl);-1!==i&&(1===s[i]?(o.splice(i,1),s.splice(i,1),r.splice(i,1)):s[i]--),i=o.indexOf(t),-1===i?(o.push(t),s.push(1)):s[i]++,this._imageUrl=t,this._contentDirty=!0},e.prototype.deploy=function(t){var i=o.indexOf(this._imageUrl);if(void 0===r[i]&&a){var e=new Image;e.src=this._imageUrl||"",r[i]=e}t.src=this._imageUrl||""},e.prototype.recall=function(t){t.src=""},i.exports=e},{"../core/Surface":14}],78:[function(t,i){function e(t){this._placeholder=t.placeholder||"",this._value=t.value||"",this._type=t.type||"text",this._name=t.name||"",n.apply(this,arguments),this.on("click",this.focus.bind(this)),window.addEventListener("click",function(t){t.target!==this._currentTarget&&this.blur()}.bind(this))}var n=t("../core/Surface");e.prototype=Object.create(n.prototype),e.prototype.constructor=e,e.prototype.elementType="input",e.prototype.elementClass="famous-surface",e.prototype.setPlaceholder=function(t){return this._placeholder=t,this._contentDirty=!0,this},e.prototype.focus=function(){return this._currentTarget&&this._currentTarget.focus(),this},e.prototype.blur=function(){return this._currentTarget&&this._currentTarget.blur(),this},e.prototype.setValue=function(t){return this._value=t,this._contentDirty=!0,this},e.prototype.setType=function(t){return this._type=t,this._contentDirty=!0,this},e.prototype.getValue=function(){return this._currentTarget?this._currentTarget.value:this._value},e.prototype.setName=function(t){return this._name=t,this._contentDirty=!0,this},e.prototype.getName=function(){return this._name},e.prototype.deploy=function(t){""!==this._placeholder&&(t.placeholder=this._placeholder),t.value=this._value,t.type=this._type,t.name=this._name},i.exports=e},{"../core/Surface":14}],79:[function(t,i){function e(t){n.apply(this,arguments),this._type="submit",t&&t.onClick&&this.setOnClick(t.onClick)}var n=t("./InputSurface");e.prototype=Object.create(n.prototype),e.prototype.constructor=e,e.prototype.setOnClick=function(t){this.onClick=t},e.prototype.deploy=function(t){this.onclick&&(t.onClick=this.onClick),n.prototype.deploy.apply(this,arguments)},i.exports=e},{"./InputSurface":78}],80:[function(t,i){function e(t){this._placeholder=t.placeholder||"",this._value=t.value||"",this._name=t.name||"",this._wrap=t.wrap||"",this._cols=t.cols||"",this._rows=t.rows||"",n.apply(this,arguments),this.on("click",this.focus.bind(this))}var n=t("../core/Surface");e.prototype=Object.create(n.prototype),e.prototype.constructor=e,e.prototype.elementType="textarea",e.prototype.elementClass="famous-surface",e.prototype.setPlaceholder=function(t){return this._placeholder=t,this._contentDirty=!0,this},e.prototype.focus=function(){return this._currentTarget&&this._currentTarget.focus(),this},e.prototype.blur=function(){return this._currentTarget&&this._currentTarget.blur(),this},e.prototype.setValue=function(t){return this._value=t,this._contentDirty=!0,this},e.prototype.getValue=function(){return this._currentTarget?this._currentTarget.value:this._value},e.prototype.setName=function(t){return this._name=t,this._contentDirty=!0,this},e.prototype.getName=function(){return this._name},e.prototype.setWrap=function(t){return this._wrap=t,this._contentDirty=!0,this},e.prototype.setColumns=function(t){return this._cols=t,this._contentDirty=!0,this},e.prototype.setRows=function(t){return this._rows=t,this._contentDirty=!0,this},e.prototype.deploy=function(t){""!==this._placeholder&&(t.placeholder=this._placeholder),""!==this._value&&(t.value=this._value),""!==this._name&&(t.name=this._name),""!==this._wrap&&(t.wrap=this._wrap),""!==this._cols&&(t.cols=this._cols),""!==this._rows&&(t.rows=this._rows)},i.exports=e},{"../core/Surface":14}],81:[function(t,i){function e(t){n.apply(this,arguments),this._videoUrl=void 0,this.options=Object.create(e.DEFAULT_OPTIONS),t&&this.setOptions(t)}var n=t("../core/Surface");e.prototype=Object.create(n.prototype),e.prototype.constructor=e,e.DEFAULT_OPTIONS={autoplay:!1},e.prototype.elementType="video",e.prototype.elementClass="famous-surface",e.prototype.setOptions=function(t){t.size&&this.setSize(t.size),t.classes&&this.setClasses(t.classes),t.properties&&this.setProperties(t.properties),t.autoplay&&(this.options.autoplay=t.autoplay),t.src&&(this._videoUrl=t.src,this._contentDirty=!0)},e.prototype.setContent=function(t){this._videoUrl=t,this._contentDirty=!0},e.prototype.deploy=function(t){t.src=this._videoUrl,t.autoplay=this.options.autoplay},e.prototype.recall=function(t){t.src=""},i.exports=e},{"../core/Surface":14}],82:[function(t,i){i.exports={CanvasSurface:t("./CanvasSurface"),ContainerSurface:t("./ContainerSurface"),FormContainerSurface:t("./FormContainerSurface"),ImageSurface:t("./ImageSurface"),InputSurface:t("./InputSurface"),SubmitInputSurface:t("./SubmitInputSurface"),TextareaSurface:t("./TextareaSurface"),VideoSurface:t("./VideoSurface")}},{"./CanvasSurface":74,"./ContainerSurface":75,"./FormContainerSurface":76,"./ImageSurface":77,"./InputSurface":78,"./SubmitInputSurface":79,"./TextareaSurface":80,"./VideoSurface":81}],83:[function(t,i){function e(t){this._map=t||null,this._cachedOutput=null,this._cachedInput=Number.NaN}e.create=function(t){var i=new e(t);return i.get.bind(i)},e.prototype.get=function(t){return t!==this._cachedInput&&(this._cachedInput=t,this._cachedOutput=this._map(t)),this._cachedOutput},i.exports=e},{}],84:[function(t,i){var e={inQuad:function(t){return t*t},outQuad:function(t){return-(t-=1)*t+1},inOutQuad:function(t){return(t/=.5)<1?.5*t*t:-.5*(--t*(t-2)-1)},inCubic:function(t){return t*t*t},outCubic:function(t){return--t*t*t+1},inOutCubic:function(t){return(t/=.5)<1?.5*t*t*t:.5*((t-=2)*t*t+2)},inQuart:function(t){return t*t*t*t},outQuart:function(t){return-(--t*t*t*t-1)},inOutQuart:function(t){return(t/=.5)<1?.5*t*t*t*t:-.5*((t-=2)*t*t*t-2)},inQuint:function(t){return t*t*t*t*t},outQuint:function(t){return--t*t*t*t*t+1},inOutQuint:function(t){return(t/=.5)<1?.5*t*t*t*t*t:.5*((t-=2)*t*t*t*t+2)},inSine:function(t){return-1*Math.cos(t*(Math.PI/2))+1},outSine:function(t){return Math.sin(t*(Math.PI/2))},inOutSine:function(t){return-.5*(Math.cos(Math.PI*t)-1)},inExpo:function(t){return 0===t?0:Math.pow(2,10*(t-1))},outExpo:function(t){return 1===t?1:-Math.pow(2,-10*t)+1},inOutExpo:function(t){return 0===t?0:1===t?1:(t/=.5)<1?.5*Math.pow(2,10*(t-1)):.5*(-Math.pow(2,-10*--t)+2)},inCirc:function(t){return-(Math.sqrt(1-t*t)-1)},outCirc:function(t){return Math.sqrt(1- --t*t)},inOutCirc:function(t){return(t/=.5)<1?-.5*(Math.sqrt(1-t*t)-1):.5*(Math.sqrt(1-(t-=2)*t)+1)},inElastic:function(t){var i=1.70158,e=0,n=1;return 0===t?0:1===t?1:(e||(e=.3),i=e/(2*Math.PI)*Math.asin(1/n),-(n*Math.pow(2,10*(t-=1))*Math.sin(2*(t-i)*Math.PI/e)))},outElastic:function(t){var i=1.70158,e=0,n=1;return 0===t?0:1===t?1:(e||(e=.3),i=e/(2*Math.PI)*Math.asin(1/n),n*Math.pow(2,-10*t)*Math.sin(2*(t-i)*Math.PI/e)+1)},inOutElastic:function(t){var i=1.70158,e=0,n=1;return 0===t?0:2===(t/=.5)?1:(e||(e=.3*1.5),i=e/(2*Math.PI)*Math.asin(1/n),1>t?-.5*n*Math.pow(2,10*(t-=1))*Math.sin(2*(t-i)*Math.PI/e):n*Math.pow(2,-10*(t-=1))*Math.sin(2*(t-i)*Math.PI/e)*.5+1)},inBack:function(t,i){return void 0===i&&(i=1.70158),t*t*((i+1)*t-i)},outBack:function(t,i){return void 0===i&&(i=1.70158),--t*t*((i+1)*t+i)+1},inOutBack:function(t,i){return void 0===i&&(i=1.70158),(t/=.5)<1?.5*t*t*(((i*=1.525)+1)*t-i):.5*((t-=2)*t*(((i*=1.525)+1)*t+i)+2)},inBounce:function(t){return 1-e.outBounce(1-t)},outBounce:function(t){return 1/2.75>t?7.5625*t*t:2/2.75>t?7.5625*(t-=1.5/2.75)*t+.75:2.5/2.75>t?7.5625*(t-=2.25/2.75)*t+.9375:7.5625*(t-=2.625/2.75)*t+.984375},inOutBounce:function(t){return.5>t?.5*e.inBounce(2*t):.5*e.outBounce(2*t-1)+.5}};i.exports=e},{}],85:[function(t,i){function e(t){this.method=t,this._instances=[],this.state=[]}var n=t("../utilities/Utility");e.SUPPORTS_MULTIPLE=!0,e.prototype.get=function(){for(var t=0;t<this._instances.length;t++)this.state[t]=this._instances[t].get();return this.state},e.prototype.set=function(t,i,e){for(var o=n.after(t.length,e),s=0;s<t.length;s++)this._instances[s]||(this._instances[s]=new this.method),this._instances[s].set(t[s],i,o)},e.prototype.reset=function(t){for(var i=0;i<t.length;i++)this._instances[i]||(this._instances[i]=new this.method),this._instances[i].reset(t[i])},i.exports=e},{"../utilities/Utility":95}],86:[function(t,i){function e(t){t=t||0,this.endState=new v(t),this.initState=new v,this._dimensions=1,this._restTolerance=1e-10,this._absRestTolerance=this._restTolerance,this._callback=void 0,this.PE=new _,this.particle=new y,this.spring=new g({anchor:this.endState}),this.PE.addBody(this.particle),this.PE.attach(this.spring,this.particle)}function n(){return this.particle.getEnergy()+this.spring.getEnergy([this.particle])}function o(){var t=this.endState.sub(this.initState).normSquared();this._absRestTolerance=0===t?this._restTolerance:this._restTolerance*t}function s(t){this.endState.set(t),o.call(this)}function r(){this.PE.wake()}function a(){this.PE.sleep()}function h(t){this.particle.position.set(t)}function c(t){this.particle.velocity.set(t)}function p(){return 0===this._dimensions?this.particle.getPosition1D():this.particle.getPosition()}function u(){return 0===this._dimensions?this.particle.getVelocity1D():this.particle.getVelocity()}function l(t){this._callback=t}function f(t){var i=e.DEFAULT_OPTIONS;void 0===t.period&&(t.period=i.period),void 0===t.dampingRatio&&(t.dampingRatio=i.dampingRatio),void 0===t.velocity&&(t.velocity=i.velocity),this.spring.setOptions({period:t.period,dampingRatio:t.dampingRatio}),c.call(this,t.velocity)}function d(){if(this.PE.isSleeping()){if(this._callback){var t=this._callback;this._callback=void 0,t()}}else n.call(this)<this._absRestTolerance&&(h.call(this,this.endState),c.call(this,[0,0,0]),a.call(this))}var _=t("../physics/PhysicsEngine"),y=t("../physics/bodies/Particle"),g=t("../physics/constraints/Snap"),v=t("../math/Vector");e.SUPPORTS_MULTIPLE=3,e.DEFAULT_OPTIONS={period:100,dampingRatio:.2,velocity:0},e.prototype.reset=function(t,i){this._dimensions=t instanceof Array?t.length:0,this.initState.set(t),h.call(this,t),s.call(this,t),i&&c.call(this,i),l.call(this,void 0)},e.prototype.getVelocity=function(){return u.call(this)},e.prototype.setVelocity=function(t){this.call(this,c(t))},e.prototype.isActive=function(){return!this.PE.isSleeping()},e.prototype.halt=function(){this.set(this.get())},e.prototype.get=function(){return d.call(this),p.call(this)},e.prototype.set=function(t,i,e){return i?(this._dimensions=t instanceof Array?t.length:0,r.call(this),f.call(this,i),s.call(this,t),void l.call(this,e)):(this.reset(t),void(e&&e()))},i.exports=e},{"../math/Vector":41,"../physics/PhysicsEngine":48,"../physics/bodies/Particle":51,"../physics/constraints/Snap":58}],87:[function(t,i){function e(t){t=t||0,this.endState=new v(t),this.initState=new v,this._dimensions=void 0,this._restTolerance=1e-10,this._absRestTolerance=this._restTolerance,this._callback=void 0,this.PE=new _,this.spring=new g({anchor:this.endState}),this.particle=new y,this.PE.addBody(this.particle),this.PE.attach(this.spring,this.particle)}function n(){return this.particle.getEnergy()+this.spring.getEnergy([this.particle])}function o(t){this.particle.setPosition(t)}function s(t){this.particle.setVelocity(t)}function r(){return 0===this._dimensions?this.particle.getPosition1D():this.particle.getPosition()}function a(){return 0===this._dimensions?this.particle.getVelocity1D():this.particle.getVelocity()}function h(t){this._callback=t}function c(){this.PE.wake()}function p(){this.PE.sleep()}function u(){if(this.PE.isSleeping()){if(this._callback){var t=this._callback;this._callback=void 0,t()}}else n.call(this)<this._absRestTolerance&&(o.call(this,this.endState),s.call(this,[0,0,0]),p.call(this))}function l(t){var i=e.DEFAULT_OPTIONS;void 0===t.period&&(t.period=i.period),void 0===t.dampingRatio&&(t.dampingRatio=i.dampingRatio),void 0===t.velocity&&(t.velocity=i.velocity),t.period<150&&(t.period=150,console.warn("The period of a SpringTransition is capped at 150 ms. Use a SnapTransition for faster transitions")),this.spring.setOptions({period:t.period,dampingRatio:t.dampingRatio}),s.call(this,t.velocity)}function f(){var t=this.endState.sub(this.initState).normSquared();this._absRestTolerance=0===t?this._restTolerance:this._restTolerance*t}function d(t){this.endState.set(t),f.call(this)}var _=t("../physics/PhysicsEngine"),y=t("../physics/bodies/Particle"),g=t("../physics/forces/Spring"),v=t("../math/Vector");e.SUPPORTS_MULTIPLE=3,e.DEFAULT_OPTIONS={period:300,dampingRatio:.5,velocity:0},e.prototype.reset=function(t,i){this._dimensions=t instanceof Array?t.length:0,this.initState.set(t),o.call(this,t),d.call(this,t),i&&s.call(this,i),h.call(this,void 0)},e.prototype.getVelocity=function(){return a.call(this)},e.prototype.setVelocity=function(t){this.call(this,s(t))},e.prototype.isActive=function(){return!this.PE.isSleeping()
},e.prototype.halt=function(){this.set(this.get())},e.prototype.get=function(){return u.call(this),r.call(this)},e.prototype.set=function(t,i,e){return i?(this._dimensions=t instanceof Array?t.length:0,c.call(this),l.call(this,i),d.call(this,t),void h.call(this,e)):(this.reset(t),void(e&&e()))},i.exports=e},{"../math/Vector":41,"../physics/PhysicsEngine":48,"../physics/bodies/Particle":51,"../physics/forces/Spring":68}],88:[function(t,i){function e(t){this.currentAction=null,this.actionQueue=[],this.callbackQueue=[],this.state=0,this.velocity=void 0,this._callback=void 0,this._engineInstance=null,this._currentMethod=null,this.set(t)}function n(){if(this._callback){var t=this._callback;this._callback=void 0,t()}if(this.actionQueue.length<=0)return void this.set(this.get());this.currentAction=this.actionQueue.shift(),this._callback=this.callbackQueue.shift();var i=null,e=this.currentAction[0],a=this.currentAction[1];a instanceof Object&&a.method?(i=a.method,"string"==typeof i&&(i=r[i])):i=s,this._currentMethod!==i&&(this._engineInstance=!(e instanceof Object)||i.SUPPORTS_MULTIPLE===!0||e.length<=i.SUPPORTS_MULTIPLE?new i:new o(i),this._currentMethod=i),this._engineInstance.reset(this.state,this.velocity),void 0!==this.velocity&&(a.velocity=this.velocity),this._engineInstance.set(e,a,n.bind(this))}var o=t("./MultipleTransition"),s=t("./TweenTransition"),r={};e.register=function(t){var i=!0;for(var n in t)e.registerMethod(n,t[n])||(i=!1);return i},e.registerMethod=function(t,i){return t in r?!1:(r[t]=i,!0)},e.unregisterMethod=function(t){return t in r?(delete r[t],!0):!1},e.prototype.set=function(t,i,e){if(!i)return this.reset(t),e&&e(),this;var o=[t,i];return this.actionQueue.push(o),this.callbackQueue.push(e),this.currentAction||n.call(this),this},e.prototype.reset=function(t,i){this._currentMethod=null,this._engineInstance=null,this._callback=void 0,this.state=t,this.velocity=i,this.currentAction=null,this.actionQueue=[],this.callbackQueue=[]},e.prototype.delay=function(t,i){this.set(this.get(),{duration:t,curve:function(){return 0}},i)},e.prototype.get=function(t){return this._engineInstance&&(this._engineInstance.getVelocity&&(this.velocity=this._engineInstance.getVelocity()),this.state=this._engineInstance.get(t)),this.state},e.prototype.isActive=function(){return!!this.currentAction},e.prototype.halt=function(){return this.set(this.get())},i.exports=e},{"./MultipleTransition":85,"./TweenTransition":90}],89:[function(t,i){function e(t){this._final=r.identity.slice(),this._finalTranslate=[0,0,0],this._finalRotate=[0,0,0],this._finalSkew=[0,0,0],this._finalScale=[1,1,1],this.translate=new s(this._finalTranslate),this.rotate=new s(this._finalRotate),this.skew=new s(this._finalSkew),this.scale=new s(this._finalScale),t&&this.set(t)}function n(){return r.build({translate:this.translate.get(),rotate:this.rotate.get(),skew:this.skew.get(),scale:this.scale.get()})}function o(){return r.build({translate:this._finalTranslate,rotate:this._finalRotate,skew:this._finalSkew,scale:this._finalScale})}var s=t("./Transitionable"),r=t("../core/Transform"),a=t("../utilities/Utility");e.prototype.setTranslate=function(t,i,e){return this._finalTranslate=t,this._final=o.call(this),this.translate.set(t,i,e),this},e.prototype.setScale=function(t,i,e){return this._finalScale=t,this._final=o.call(this),this.scale.set(t,i,e),this},e.prototype.setRotate=function(t,i,e){return this._finalRotate=t,this._final=o.call(this),this.rotate.set(t,i,e),this},e.prototype.setSkew=function(t,i,e){return this._finalSkew=t,this._final=o.call(this),this.skew.set(t,i,e),this},e.prototype.set=function(t,i,e){var n=r.interpret(t);this._finalTranslate=n.translate,this._finalRotate=n.rotate,this._finalSkew=n.skew,this._finalScale=n.scale,this._final=t;var o=e?a.after(4,e):null;return this.translate.set(n.translate,i,o),this.rotate.set(n.rotate,i,o),this.skew.set(n.skew,i,o),this.scale.set(n.scale,i,o),this},e.prototype.setDefaultTransition=function(t){this.translate.setDefault(t),this.rotate.setDefault(t),this.skew.setDefault(t),this.scale.setDefault(t)},e.prototype.get=function(){return this.isActive()?n.call(this):this._final},e.prototype.getFinal=function(){return this._final},e.prototype.isActive=function(){return this.translate.isActive()||this.rotate.isActive()||this.scale.isActive()||this.skew.isActive()},e.prototype.halt=function(){return this.translate.halt(),this.rotate.halt(),this.skew.halt(),this.scale.halt(),this._final=this.get(),this._finalTranslate=this.translate.get(),this._finalRotate=this.rotate.get(),this._finalSkew=this.skew.get(),this._finalScale=this.scale.get(),this},i.exports=e},{"../core/Transform":15,"../utilities/Utility":95,"./Transitionable":88}],90:[function(t,i){function e(t){this.options=Object.create(e.DEFAULT_OPTIONS),t&&this.setOptions(t),this._startTime=0,this._startValue=0,this._updateTime=0,this._endValue=0,this._curve=void 0,this._duration=0,this._active=!1,this._callback=void 0,this.state=0,this.velocity=void 0}function n(t,i,e){return(1-e)*t+e*i}function o(t){return t instanceof Object?t instanceof Array?t.slice(0):Object.create(t):t}function s(t,i){var n={curve:i.curve};return i.duration&&(n.duration=i.duration),i.speed&&(n.speed=i.speed),t instanceof Object&&(void 0!==t.duration&&(n.duration=t.duration),t.curve&&(n.curve=t.curve),t.speed&&(n.speed=t.speed)),"string"==typeof n.curve&&(n.curve=e.getCurve(n.curve)),n}function r(t,i,e,n,o){var s,r=1e-7,a=(e(o)-e(o-r))/r;if(t instanceof Array){s=[];for(var h=0;h<t.length;h++)s[h]="number"==typeof t[h]?a*(t[h]-i[h])/n:0}else s=a*(t-i)/n;return s}function a(t,i,e){var o;if(t instanceof Array){o=[];for(var s=0;s<t.length;s++)o[s]="number"==typeof t[s]?n(t[s],i[s],e):t[s]}else o=n(t,i,e);return o}e.Curves={linear:function(t){return t},easeIn:function(t){return t*t},easeOut:function(t){return t*(2-t)},easeInOut:function(t){return.5>=t?2*t*t:-2*t*t+4*t-1},easeOutBounce:function(t){return t*(3-2*t)},spring:function(t){return(1-t)*Math.sin(6*Math.PI*t)+t}},e.SUPPORTS_MULTIPLE=!0,e.DEFAULT_OPTIONS={curve:e.Curves.linear,duration:500,speed:0};var h={};e.registerCurve=function(t,i){return h[t]?!1:(h[t]=i,!0)},e.unregisterCurve=function(t){return h[t]?(delete h[t],!0):!1},e.getCurve=function(t){var i=h[t];if(void 0!==i)return i;throw new Error("curve not registered")},e.getCurves=function(){return h},e.prototype.setOptions=function(t){void 0!==t.curve&&(this.options.curve=t.curve),void 0!==t.duration&&(this.options.duration=t.duration),void 0!==t.speed&&(this.options.speed=t.speed)},e.prototype.set=function(t,i,e){if(!i)return this.reset(t),void(e&&e());if(this._startValue=o(this.get()),i=s(i,this.options),i.speed){var n=this._startValue;if(n instanceof Object){var r=0;for(var a in n)r+=(t[a]-n[a])*(t[a]-n[a]);i.duration=Math.sqrt(r)/i.speed}else i.duration=Math.abs(t-n)/i.speed}this._startTime=Date.now(),this._endValue=o(t),this._startVelocity=o(i.velocity),this._duration=i.duration,this._curve=i.curve,this._active=!0,this._callback=e},e.prototype.reset=function(t,i){if(this._callback){var e=this._callback;this._callback=void 0,e()}this.state=o(t),this.velocity=o(i),this._startTime=0,this._duration=0,this._updateTime=0,this._startValue=this.state,this._startVelocity=this.velocity,this._endValue=this.state,this._active=!1},e.prototype.getVelocity=function(){return this.velocity},e.prototype.get=function(t){return this.update(t),this.state},e.prototype.update=function(t){if(this._active){if(t||(t=Date.now()),!(this._updateTime>=t)){this._updateTime=t;var i=t-this._startTime;if(i>=this._duration)this.state=this._endValue,this.velocity=r(this.state,this._startValue,this._curve,this._duration,1),this._active=!1;else if(0>i)this.state=this._startValue,this.velocity=this._startVelocity;else{var e=i/this._duration;this.state=a(this._startValue,this._endValue,this._curve(e)),this.velocity=r(this.state,this._startValue,this._curve,this._duration,e)}}}else if(this._callback){var n=this._callback;this._callback=void 0,n()}},e.prototype.isActive=function(){return this._active},e.prototype.halt=function(){this.reset(this.get())},e.registerCurve("linear",e.Curves.linear),e.registerCurve("easeIn",e.Curves.easeIn),e.registerCurve("easeOut",e.Curves.easeOut),e.registerCurve("easeInOut",e.Curves.easeInOut),e.registerCurve("easeOutBounce",e.Curves.easeOutBounce),e.registerCurve("spring",e.Curves.spring),e.customCurve=function(t,i){return t=t||0,i=i||0,function(e){return t*e+(-2*t-i+3)*e*e+(t+i-2)*e*e*e}},i.exports=e},{}],91:[function(t,i){function e(t){t=t||0,this.endState=new m(t),this.initState=new m,this.spring=new g({anchor:this.endState}),this.wall=new v,this._restTolerance=1e-10,this._dimensions=1,this._absRestTolerance=this._restTolerance,this._callback=void 0,this.PE=new _,this.particle=new y,this.PE.addBody(this.particle),this.PE.attach([this.wall,this.spring],this.particle)}function n(){return this.particle.getEnergy()+this.spring.getEnergy([this.particle])}function o(){var t=this.endState.sub(this.initState).normSquared();this._absRestTolerance=0===t?this._restTolerance:this._restTolerance*t}function s(){this.PE.wake()}function r(){this.PE.sleep()}function a(t){this.endState.set(t);var i=this.endState.sub(this.initState).norm();this.wall.setOptions({distance:this.endState.norm(),normal:0===i?this.particle.velocity.normalize(-1):this.endState.sub(this.initState).normalize(-1)}),o.call(this)}function h(t){this.particle.position.set(t)}function c(t){this.particle.velocity.set(t)}function p(){return 0===this._dimensions?this.particle.getPosition1D():this.particle.getPosition()}function u(){return 0===this._dimensions?this.particle.getVelocity1D():this.particle.getVelocity()}function l(t){this._callback=t}function f(){if(this.PE.isSleeping()){if(this._callback){var t=this._callback;this._callback=void 0,t()}}else{var i=n.call(this);i<this._absRestTolerance&&(r.call(this),h.call(this,this.endState),c.call(this,[0,0,0]))}}function d(t){var i=e.DEFAULT_OPTIONS;void 0===t.period&&(t.period=i.period),void 0===t.dampingRatio&&(t.dampingRatio=i.dampingRatio),void 0===t.velocity&&(t.velocity=i.velocity),void 0===t.restitution&&(t.restitution=i.restitution),this.spring.setOptions({period:t.period,dampingRatio:t.dampingRatio}),this.wall.setOptions({restitution:t.restitution}),c.call(this,t.velocity)}var _=t("../physics/PhysicsEngine"),y=t("../physics/bodies/Particle"),g=t("../physics/forces/Spring"),v=t("../physics/constraints/Wall"),m=t("../math/Vector");e.SUPPORTS_MULTIPLE=3,e.DEFAULT_OPTIONS={period:300,dampingRatio:.5,velocity:0,restitution:.5},e.prototype.reset=function(t,i){this._dimensions=t instanceof Array?t.length:0,this.initState.set(t),h.call(this,t),i&&c.call(this,i),a.call(this,t),l.call(this,void 0)},e.prototype.getVelocity=function(){return u.call(this)},e.prototype.setVelocity=function(t){this.call(this,c(t))},e.prototype.isActive=function(){return!this.PE.isSleeping()},e.prototype.halt=function(){this.set(this.get())},e.prototype.get=function(){return f.call(this),p.call(this)},e.prototype.set=function(t,i,e){return i?(this._dimensions=t instanceof Array?t.length:0,s.call(this),d.call(this,i),a.call(this,t),void l.call(this,e)):(this.reset(t),void(e&&e()))},i.exports=e},{"../math/Vector":41,"../physics/PhysicsEngine":48,"../physics/bodies/Particle":51,"../physics/constraints/Wall":60,"../physics/forces/Spring":68}],92:[function(t,i){i.exports={CachedMap:t("./CachedMap"),Easing:t("./Easing"),MultipleTransition:t("./MultipleTransition"),SnapTransition:t("./SnapTransition"),SpringTransition:t("./SpringTransition"),Transitionable:t("./Transitionable"),TransitionableTransform:t("./TransitionableTransform"),TweenTransition:t("./TweenTransition"),WallTransition:t("./WallTransition")}},{"./CachedMap":83,"./Easing":84,"./MultipleTransition":85,"./SnapTransition":86,"./SpringTransition":87,"./Transitionable":88,"./TransitionableTransform":89,"./TweenTransition":90,"./WallTransition":91}],93:[function(t,i){var e={0:48,1:49,2:50,3:51,4:52,5:53,6:54,7:55,8:56,9:57,a:97,b:98,c:99,d:100,e:101,f:102,g:103,h:104,i:105,j:106,k:107,l:108,m:109,n:110,o:111,p:112,q:113,r:114,s:115,t:116,u:117,v:118,w:119,x:120,y:121,z:122,A:65,B:66,C:67,D:68,E:69,F:70,G:71,H:72,I:73,J:74,K:75,L:76,M:77,N:78,O:79,P:80,Q:81,R:82,S:83,T:84,U:85,V:86,W:87,X:88,Y:89,Z:90,ENTER:13,LEFT_ARROW:37,RIGHT_ARROW:39,UP_ARROW:38,DOWN_ARROW:40,SPACE:32,SHIFT:16,TAB:9};i.exports=e},{}],94:[function(t,i){function e(t){return c.on(p,t),t}function n(t,i){var n=u(),o=function(){var e=u();e-n>=i&&(t.apply(this,arguments),c.removeListener(p,o))};return e(o)}function o(t,i){var n=u(),o=function(){var e=u();e-n>=i&&(t.apply(this,arguments),n=u())};return e(o)}function s(t,i){if(void 0===i)return void 0;var n=function(){i--,0>=i&&(t.apply(this,arguments),a(n))};return e(n)}function r(t,i){i=i||1;var n=i,o=function(){i--,0>=i&&(t.apply(this,arguments),i=n)};return e(o)}function a(t){c.removeListener(p,t)}function h(t,i){var e,o,s,r,h;return function(){o=this,h=arguments,s=u();var c=function(){var a=u-s;i>a?e=n(c,i-a):(e=null,r=t.apply(o,h))};return a(e),e=n(c,i),r}}var c=t("../core/Engine"),p="prerender",u=window.performance&&window.performance.now?function(){return window.performance.now()}:function(){return Date.now()};i.exports={setTimeout:n,setInterval:o,debounce:h,after:s,every:r,clear:a}},{"../core/Engine":4}],95:[function(t,i){var e={};e.Direction={X:0,Y:1,Z:2},e.after=function(t,i){var e=t;return function(){e--,0===e&&i.apply(this,arguments)}},e.loadURL=function(t,i){var e=new XMLHttpRequest;e.onreadystatechange=function(){4===this.readyState&&i&&i(this.responseText)},e.open("GET",t),e.send()},e.createDocumentFragmentFromHTML=function(t){var i=document.createElement("div");i.innerHTML=t;for(var e=document.createDocumentFragment();i.hasChildNodes();)e.appendChild(i.firstChild);return e},e.clone=function(t){var i;if("object"==typeof t){i=t instanceof Array?[]:{};for(var n in t)if("object"==typeof t[n]&&null!==t[n])if(t[n]instanceof Array){i[n]=new Array(t[n].length);for(var o=0;o<t[n].length;o++)i[n][o]=e.clone(t[n][o])}else i[n]=e.clone(t[n]);else i[n]=t[n]}else i=t;return i},i.exports=e},{}],96:[function(t,i){i.exports={KeyCodes:t("./KeyCodes"),Timer:t("./Timer"),Utility:t("./Utility")}},{"./KeyCodes":93,"./Timer":94,"./Utility":95}],97:[function(t,i){function e(t){this.options=Object.create(this.constructor.DEFAULT_OPTIONS||e.DEFAULT_OPTIONS),this._optionsManager=new s(this.options),t&&this.setOptions(t),this._eventInput=new o,this._eventOutput=new o,o.setInputHandler(this,this._eventInput),o.setOutputHandler(this,this._eventOutput),this._id=n.register(this)}var n=t("../core/Entity"),o=(t("../core/Transform"),t("../core/EventHandler")),s=t("../core/OptionsManager");e.DEFAULT_OPTIONS={},e.prototype.setOptions=function(t){return this._optionsManager.setOptions(t)},e.prototype.getOptions=function(t){return this._optionsManager.getOptions(t)},e.prototype.render=function(){return this._id},e.prototype.commit=function(){},i.exports=e},{"../core/Entity":5,"../core/EventHandler":7,"../core/OptionsManager":10,"../core/Transform":15}],98:[function(t,i){function e(){c.apply(this,arguments),this.state=new a(0),this._isOpen=!1,this.setOutputFunction(function(t,i,e){var o=n.call(this),r=this.options.direction===h.Direction.X?s.translate(o*i,0,.001*(o-1)*i):s.translate(0,o*i,.001*(o-1)*i),a=t.render();if(this.options.stackRotation){var c=this.options.stackRotation*e*(1-o);a={transform:s.rotateZ(c),origin:[.5,.5],target:a}}return{transform:r,size:t.getSize(),target:a}})}function n(t){return t?this._isOpen?1:0:this.state.get()}function o(t,i,e){this.state.halt(),this.state.set(t,i,e)}var s=t("../core/Transform"),r=t("../core/OptionsManager"),a=t("../transitions/Transitionable"),h=t("../utilities/Utility"),c=t("./SequentialLayout");e.prototype=Object.create(c.prototype),e.prototype.constructor=e,e.DEFAULT_OPTIONS=r.patch(c.DEFAULT_OPTIONS,{transition:{curve:"easeOutBounce",duration:500},stackRotation:0}),e.prototype.getSize=function(){var t=c.prototype.getSize.apply(this,arguments),i=this._items?this._items.get().getSize():[0,0];i||(i=[0,0]);var e=n.call(this),o=1-e;return[i[0]*o+t[0]*e,i[1]*o+t[1]*e]},e.prototype.isOpen=function(){return this._isOpen},e.prototype.open=function(t){this._isOpen=!0,o.call(this,1,this.options.transition,t)},e.prototype.close=function(t){this._isOpen=!1,o.call(this,0,this.options.transition,t)},e.prototype.toggle=function(t){this._isOpen?this.close(t):this.open(t)},i.exports=e},{"../core/OptionsManager":10,"../core/Transform":15,"../transitions/Transitionable":88,"../utilities/Utility":95,"./SequentialLayout":110}],99:[function(t,i){function e(t){this.options=Object.create(e.DEFAULT_OPTIONS),this._optionsManager=new p(this.options),t&&this.setOptions(t),this._position=new u(0),this._direction=n(this.options.side),this._orientation=o(this.options.side),this._isOpen=!1,this._cachedLength=0,this.drawer=new h,this.content=new h,this._eventInput=new l,this._eventOutput=new l,l.setInputHandler(this,this._eventInput),l.setOutputHandler(this,this._eventOutput),this._eventInput.on("update",r.bind(this)),this._eventInput.on("end",a.bind(this))}function n(t){var i=e.SIDES;return t===i.LEFT||t===i.RIGHT?f:d}function o(t){var i=e.SIDES;return t===i.LEFT||t===i.TOP?1:-1}function s(t){var i,e=this.options;if(e.drawerLength)i=e.drawerLength;else{var n=t.getSize();i=n?n[this._direction]:e.drawerLength}return this._orientation*i}function r(t){var i,e,n=this.getPosition()+t.delta;this._cachedLength=s.call(this,this.drawer),1===this._orientation?(i=0,e=this._cachedLength):(i=this._cachedLength,e=0),n>e?n=e:i>n&&(n=i),this.setPosition(n)}function a(t){var i=t.velocity,e=this._orientation*this.getPosition(),n=this.options,o=this._orientation*this._cachedLength,s=n.positionThreshold||o/2,r=n.velocityThreshold;if(n.transition instanceof Object&&(n.transition.velocity=t.velocity),0===e)return void(this._isOpen=!1);if(e===o)return void(this._isOpen=!0);var a=Math.abs(i)>r||!this._isOpen&&e>s||this._isOpen&&s>e;a?this.toggle():this.reset()}var h=t("../core/RenderNode"),c=t("../core/Transform"),p=t("../core/OptionsManager"),u=t("../transitions/Transitionable"),l=t("../core/EventHandler"),f=0,d=1;e.SIDES={LEFT:0,TOP:1,RIGHT:2,BOTTOM:3},e.DEFAULT_OPTIONS={side:e.SIDES.LEFT,drawerLength:0,velocityThreshold:0,positionThreshold:0,transition:!0},e.prototype.setOptions=function(t){this._optionsManager.setOptions(t),void 0!==t.side&&(this._direction=n(t.side),this._orientation=o(t.side))},e.prototype.open=function(t,i){t instanceof Function&&(i=t),void 0===t&&(t=this.options.transition),this._cachedLength=s.call(this,this.drawer),this.setPosition(this._cachedLength,t,i),this._isOpen||(this._isOpen=!0,this._eventOutput.emit("open"))},e.prototype.close=function(t,i){t instanceof Function&&(i=t),void 0===t&&(t=this.options.transition),this.setPosition(0,t,i),this._isOpen&&(this._isOpen=!1,this._eventOutput.emit("close"))},e.prototype.setPosition=function(t,i,e){this._position.isActive()&&this._position.halt(),this._position.set(t,i,e)},e.prototype.getPosition=function(){return this._position.get()},e.prototype.setProgress=function(t,i,e){return this._position.set(t*this._cachedLength,i,e)},e.prototype.getProgress=function(){return this._position.get()/this._cachedLength},e.prototype.toggle=function(t){this._isOpen?this.close(t):this.open(t)},e.prototype.reset=function(t){this._isOpen?this.open(t):this.close(t)},e.prototype.isOpen=function(){return this._isOpen},e.prototype.render=function(){var t=this.getPosition();(!this._isOpen&&0>t&&1===this._orientation||t>0&&-1===this._orientation)&&(t=0,this.setPosition(t));var i=this._direction===f?c.translate(t,0,0):c.translate(0,t,0);return[{transform:c.behind,target:this.drawer.render()},{transform:i,target:this.content.render()}]},i.exports=e},{"../core/EventHandler":7,"../core/OptionsManager":10,"../core/RenderNode":11,"../core/Transform":15,"../transitions/Transitionable":88}],100:[function(t,i){function e(t){this._currentTarget=null,this._size=[void 0,void 0],this._controller=new h(t),this._controller.inTransformFrom(o.create(n.bind(this,1e-4))),this._controller.outTransformFrom(o.create(n.bind(this,-1e-4))),this._eventInput=new r,r.setInputHandler(this,this._eventInput),this._entityId=s.register(this),t&&this.setOptions(t)}function n(t,i){return a.translate(this._size[0]*(1-i),0,t*(1-i))}var o=t("../transitions/CachedMap"),s=t("../core/Entity"),r=t("../core/EventHandler"),a=t("../core/Transform"),h=t("./RenderController");e.prototype.show=function(t){this._currentTarget&&this._eventInput.unpipe(this._currentTarget),this._currentTarget=t,this._currentTarget&&this._currentTarget.trigger&&this._eventInput.pipe(this._currentTarget),this._controller.show.apply(this._controller,arguments)},e.prototype.setOptions=function(t){this._controller.setOptions(t)},e.prototype.render=function(){return this._entityId},e.prototype.commit=function(t){return this._size[0]=t.size[0],this._size[1]=t.size[1],{transform:t.transform,opacity:t.opacity,origin:t.origin,size:t.size,target:this._controller.render()}},i.exports=e},{"../core/Entity":5,"../core/EventHandler":7,"../core/Transform":15,"../transitions/CachedMap":83,"./RenderController":106}],101:[function(t,i){function e(t){this.options=Object.create(e.DEFAULT_OPTIONS),this.optionsManager=new a(this.options),t&&this.setOptions(t),this.id=s.register(this),this._ratios=new c(this.options.ratios),this._nodes=[],this._size=[0,0],this._cachedDirection=null,this._cachedLengths=[],this._cachedTransforms=null,this._ratiosDirty=!1,this._eventOutput=new h,h.setOutputHandler(this,this._eventOutput)}function n(t,i,n){var o,s,a,h,c=0,p=i,u=0;for(this._cachedLengths=[],this._cachedTransforms=[],h=0;h<t.length;h++)s=t[h],a=this._nodes[h],"number"!=typeof s?p-=a.getSize()[n]||0:u+=s;for(h=0;h<t.length;h++)a=this._nodes[h],s=t[h],i="number"==typeof s?p*s/u:a.getSize()[n],o=n===e.DIRECTION_X?r.translate(c,0,0):r.translate(0,c,0),this._cachedTransforms.push(o),this._cachedLengths.push(i),c+=i}function o(t,i){for(var e=0;e<t.length;e++)if("number"!=typeof t[e]&&this._nodes[e].getSize()[i]!==this._cachedLengths[e])return!0;return!1}var s=t("../core/Entity"),r=t("../core/Transform"),a=t("../core/OptionsManager"),h=t("../core/EventHandler"),c=t("../transitions/Transitionable");e.DIRECTION_X=0,e.DIRECTION_Y=1,e.DEFAULT_OPTIONS={direction:e.DIRECTION_X,transition:!1,ratios:[]},e.prototype.render=function(){return this.id},e.prototype.setOptions=function(t){this.optionsManager.setOptions(t)},e.prototype.sequenceFrom=function(t){if(this._nodes=t,0===this._ratios.get().length){for(var i=[],e=0;e<this._nodes.length;e++)i.push(1);this.setRatios(i)}},e.prototype.setRatios=function(t,i,e){void 0===i&&(i=this.options.transition);var n=this._ratios;0===n.get().length&&(i=void 0),n.isActive()&&n.halt(),n.set(t,i,e),this._ratiosDirty=!0},e.prototype.getSize=function(){return this._size},e.prototype.commit=function(t){var i,e=t.size,s=t.transform,a=t.origin,h=t.opacity,c=this._ratios.get(),p=this.options.direction,u=e[p];(u!==this._size[p]||this._ratiosDirty||this._ratios.isActive()||p!==this._cachedDirection||o.call(this,c,p))&&(n.call(this,c,u,p),u!==this._size[p]&&(this._size[0]=e[0],this._size[1]=e[1]),p!==this._cachedDirection&&(this._cachedDirection=p),this._ratiosDirty&&(this._ratiosDirty=!1));for(var l=[],f=0;f<c.length;f++)i=[void 0,void 0],u=this._cachedLengths[f],i[p]=u,l.push({transform:this._cachedTransforms[f],size:i,target:this._nodes[f].render()});return e&&0!==a[0]&&0!==a[1]&&(s=r.moveThen([-e[0]*a[0],-e[1]*a[1],0],s)),{transform:s,size:e,opacity:h,target:l}},i.exports=e},{"../core/Entity":5,"../core/EventHandler":7,"../core/OptionsManager":10,"../core/Transform":15,"../transitions/Transitionable":88}],102:[function(t,i){function e(t){this.options=Object.create(e.DEFAULT_OPTIONS),this._optionsManager=new s(this.options),t&&this.setOptions(t),this.angle=new o(0),this.frontNode=void 0,this.backNode=void 0,this.flipped=!1}var n=t("../core/Transform"),o=t("../transitions/Transitionable"),s=(t("../core/RenderNode"),t("../core/OptionsManager"));e.DIRECTION_X=0,e.DIRECTION_Y=1;var r=1;e.DEFAULT_OPTIONS={transition:!0,direction:e.DIRECTION_X},e.prototype.flip=function(t,i){var e=this.flipped?0:Math.PI;this.setAngle(e,t,i),this.flipped=!this.flipped},e.prototype.setAngle=function(t,i,e){void 0===i&&(i=this.options.transition),this.angle.isActive()&&this.angle.halt(),this.angle.set(t,i,e)},e.prototype.setOptions=function(t){return this._optionsManager.setOptions(t)},e.prototype.setFront=function(t){this.frontNode=t},e.prototype.setBack=function(t){this.backNode=t},e.prototype.render=function(){var t,i,o=this.angle.get();this.options.direction===e.DIRECTION_X?(t=n.rotateY(o),i=n.rotateY(o+Math.PI)):(t=n.rotateX(o),i=n.rotateX(o+Math.PI));var s=[];return this.frontNode&&s.push({transform:t,target:this.frontNode.render()}),this.backNode&&s.push({transform:n.moveThen([0,0,r],i),target:this.backNode.render()}),s},i.exports=e},{"../core/OptionsManager":10,"../core/RenderNode":11,"../core/Transform":15,"../transitions/Transitionable":88}],103:[function(t,i){function e(t){this.options=Object.create(e.DEFAULT_OPTIONS),this.optionsManager=new u(this.options),t&&this.setOptions(t),this.id=r.register(this),this._modifiers=[],this._states=[],this._contextSizeCache=[0,0],this._dimensionsCache=[0,0],this._activeCount=0,this._eventOutput=new c,c.setOutputHandler(this,this._eventOutput)}function n(t,i,e){var n=[t[0],t[1]];n[0]-=this.options.gutterSize[0]*(i-1),n[1]-=this.options.gutterSize[1]*(e-1);for(var r,a=Math.round(n[1]/e),h=Math.round(n[0]/i),c=0,p=0,u=0;e>u;u++){r=0;for(var l=0;i>l;l++)void 0===this._modifiers[p]?o.call(this,p,[h,a],[r,c,0],1):s.call(this,p,[h,a],[r,c,0],1),p++,r+=h+this.options.gutterSize[0];c+=a+this.options.gutterSize[1]}for(this._dimensionsCache=[this.options.dimensions[0],this.options.dimensions[1]],this._contextSizeCache=[t[0],t[1]],this._activeCount=e*i,u=this._activeCount;u<this._modifiers.length;u++)s.call(this,u,[Math.round(h),Math.round(a)],[0,0],0);this._eventOutput.emit("reflow")}function o(t,i,e,n){var o={transform:new f(a.translate.apply(null,e)),opacity:new l(n),size:new l(i)},s=new p({transform:o.transform,opacity:o.opacity,size:o.size});this._states[t]=o,this._modifiers[t]=s}function s(t,i,e,n){var o=this._states[t],s=o.size,r=o.opacity,a=o.transform,h=this.options.transition;a.halt(),r.halt(),s.halt(),a.setTranslate(e,h),s.set(i,h),r.set(n,h)}var r=t("../core/Entity"),a=(t("../core/RenderNode"),t("../core/Transform")),h=t("../core/ViewSequence"),c=t("../core/EventHandler"),p=t("../core/Modifier"),u=t("../core/OptionsManager"),l=t("../transitions/Transitionable"),f=t("../transitions/TransitionableTransform");e.DEFAULT_OPTIONS={dimensions:[1,1],transition:!1,gutterSize:[0,0]},e.prototype.render=function(){return this.id},e.prototype.setOptions=function(t){return this.optionsManager.setOptions(t)},e.prototype.sequenceFrom=function(t){t instanceof Array&&(t=new h(t)),this.sequence=t},e.prototype.commit=function(t){var i=t.transform,e=t.opacity,o=t.origin,s=t.size,r=this.options.dimensions[0],h=this.options.dimensions[1];(s[0]!==this._contextSizeCache[0]||s[1]!==this._contextSizeCache[1]||r!==this._dimensionsCache[0]||h!==this._dimensionsCache[1])&&n.call(this,s,r,h);for(var c=this.sequence,p=[],u=0;c&&u<this._modifiers.length;){var l=c.get(),f=this._modifiers[u];u>=this._activeCount&&this._states[u].opacity.isActive()&&(this._modifiers.splice(u,1),this._states.splice(u,1)),l&&p.push(f.modify({origin:o,target:l.render()})),c=c.getNext(),u++}return s&&(i=a.moveThen([-s[0]*o[0],-s[1]*o[1],0],i)),{transform:i,opacity:e,size:s,target:p}},i.exports=e},{"../core/Entity":5,"../core/EventHandler":7,"../core/Modifier":9,"../core/OptionsManager":10,"../core/RenderNode":11,"../core/Transform":15,"../core/ViewSequence":17,"../transitions/Transitionable":88,"../transitions/TransitionableTransform":89}],104:[function(t,i){function e(t){this.options=Object.create(e.DEFAULT_OPTIONS),this._optionsManager=new c(this.options),t&&this.setOptions(t),this._entityId=r.register(this),this.header=new a,this.footer=new a,this.content=new a}function n(t,i){var e=t.getSize();return e?e[this.options.direction]:i}function o(t){return this.options.direction===e.DIRECTION_X?h.translate(t,0,0):h.translate(0,t,0)}function s(t,i){return this.options.direction===e.DIRECTION_X?[t,i[1]]:[i[0],t]}var r=t("../core/Entity"),a=t("../core/RenderNode"),h=t("../core/Transform"),c=t("../core/OptionsManager");e.DIRECTION_X=0,e.DIRECTION_Y=1,e.DEFAULT_OPTIONS={direction:e.DIRECTION_Y,headerSize:void 0,footerSize:void 0,defaultHeaderSize:0,defaultFooterSize:0},e.prototype.render=function(){return this._entityId},e.prototype.setOptions=function(t){return this._optionsManager.setOptions(t)},e.prototype.commit=function(t){var i=t.transform,e=t.origin,r=t.size,a=t.opacity,c=void 0!==this.options.headerSize?this.options.headerSize:n.call(this,this.header,this.options.defaultHeaderSize),p=void 0!==this.options.footerSize?this.options.footerSize:n.call(this,this.footer,this.options.defaultFooterSize),u=r[this.options.direction]-c-p;r&&(i=h.moveThen([-r[0]*e[0],-r[1]*e[1],0],i));var l=[{size:s.call(this,c,r),target:this.header.render()},{transform:o.call(this,c),size:s.call(this,u,r),target:this.content.render()},{transform:o.call(this,c+u),size:s.call(this,p,r),target:this.footer.render()}];return{transform:i,opacity:a,size:r,target:l}},i.exports=e},{"../core/Entity":5,"../core/OptionsManager":10,"../core/RenderNode":11,"../core/Transform":15}],105:[function(t,i){function e(t){this.options=Object.create(e.DEFAULT_OPTIONS),this._optionsManager=new a(this.options),t&&this.setOptions(t),this._showing=!1,this.nodes=[],this.transforms=[],this.states=[]}var n=t("../core/Transform"),o=t("../core/Modifier"),s=t("../core/RenderNode"),r=t("../utilities/Utility"),a=t("../core/OptionsManager"),h=t("../transitions/Transitionable"),c=t("../transitions/TransitionableTransform");e.DEFAULT_OPTIONS={inTransform:n.scale(.001,.001,.001),inOpacity:0,inOrigin:[.5,.5],inAlign:[.5,.5],outTransform:n.scale(.001,.001,.001),outOpacity:0,outOrigin:[.5,.5],outAlign:[.5,.5],showTransform:n.identity,showOpacity:1,showOrigin:[.5,.5],showAlign:[.5,.5],inTransition:!0,outTransition:!0,overlap:!1},e.prototype.setOptions=function(t){return this._optionsManager.setOptions(t)},e.prototype.show=function(t,i,e){if(!t)return this.hide(e);if(i instanceof Function&&(e=i,i=void 0),this._showing){if(!this.options.overlap)return this.hide(this.show.bind(this,t,i,e));this.hide()}this._showing=!0;var n={transform:new c(this.options.inTransform),origin:new h(this.options.inOrigin),align:new h(this.options.inAlign),opacity:new h(this.options.inOpacity)},a=new o({transform:n.transform,opacity:n.opacity,origin:n.origin,align:n.align}),p=new s;p.add(a).add(t),this.nodes.push(p),this.states.push(n),this.transforms.push(a);var u=e?r.after(3,e):void 0;i||(i=this.options.inTransition),n.transform.set(this.options.showTransform,i,u),n.opacity.set(this.options.showOpacity,i,u),n.origin.set(this.options.showOrigin,i,u),n.align.set(this.options.showAlign,i,u)},e.prototype.hide=function(t,i){if(this._showing){this._showing=!1,t instanceof Function&&(i=t,t=void 0);var e=this.nodes[this.nodes.length-1],n=this.transforms[this.transforms.length-1],o=this.states[this.states.length-1],s=r.after(3,function(){this.nodes.splice(this.nodes.indexOf(e),1),this.states.splice(this.states.indexOf(o),1),this.transforms.splice(this.transforms.indexOf(n),1),i&&i.call(this)}.bind(this));t||(t=this.options.outTransition),o.transform.set(this.options.outTransform,t,s),o.opacity.set(this.options.outOpacity,t,s),o.origin.set(this.options.outOrigin,t,s),o.align.set(this.options.outAlign,t,s)}},e.prototype.render=function(){for(var t=[],i=0;i<this.nodes.length;i++)t.push(this.nodes[i].render());return t},i.exports=e},{"../core/Modifier":9,"../core/OptionsManager":10,"../core/RenderNode":11,"../core/Transform":15,"../transitions/Transitionable":88,"../transitions/TransitionableTransform":89,"../utilities/Utility":95}],106:[function(t,i){function e(){h.apply(this,arguments),this._showing=-1,this._outgoingRenderables=[],this._nextRenderable=null,this._renderables=[],this._nodes=[],this._modifiers=[],this._states=[],this.inTransformMap=e.DefaultMap.transform,this.inOpacityMap=e.DefaultMap.opacity,this.inOriginMap=e.DefaultMap.origin,this.outTransformMap=e.DefaultMap.transform,this.outOpacityMap=e.DefaultMap.opacity,this.outOriginMap=e.DefaultMap.origin,this._output=[]
}function n(t,i){return t(i.get())}var o=t("../core/Modifier"),s=t("../core/RenderNode"),r=t("../core/Transform"),a=t("../transitions/Transitionable"),h=t("../core/View");e.prototype=Object.create(h.prototype),e.prototype.constructor=e,e.DEFAULT_OPTIONS={inTransition:!0,outTransition:!0,overlap:!0},e.DefaultMap={transform:function(){return r.identity},opacity:function(t){return t},origin:null},e.prototype.inTransformFrom=function(t){if(t instanceof Function)this.inTransformMap=t;else{if(!t||!t.get)throw new Error("inTransformFrom takes only function or getter object");this.inTransformMap=t.get.bind(t)}return this},e.prototype.inOpacityFrom=function(t){if(t instanceof Function)this.inOpacityMap=t;else{if(!t||!t.get)throw new Error("inOpacityFrom takes only function or getter object");this.inOpacityMap=t.get.bind(t)}return this},e.prototype.inOriginFrom=function(t){if(t instanceof Function)this.inOriginMap=t;else{if(!t||!t.get)throw new Error("inOriginFrom takes only function or getter object");this.inOriginMap=t.get.bind(t)}return this},e.prototype.outTransformFrom=function(t){if(t instanceof Function)this.outTransformMap=t;else{if(!t||!t.get)throw new Error("outTransformFrom takes only function or getter object");this.outTransformMap=t.get.bind(t)}return this},e.prototype.outOpacityFrom=function(t){if(t instanceof Function)this.outOpacityMap=t;else{if(!t||!t.get)throw new Error("outOpacityFrom takes only function or getter object");this.outOpacityMap=t.get.bind(t)}return this},e.prototype.outOriginFrom=function(t){if(t instanceof Function)this.outOriginMap=t;else{if(!t||!t.get)throw new Error("outOriginFrom takes only function or getter object");this.outOriginMap=t.get.bind(t)}return this},e.prototype.show=function(t,i,e){if(!t)return this.hide(e);if(i instanceof Function&&(e=i,i=null),this._showing>=0){if(!this.options.overlap)return void(this._nextRenderable?this._nextRenderable=t:(this._nextRenderable=t,this.hide(function(){this._nextRenderable===t&&this.show(this._nextRenderable,e),this._nextRenderable=null})));this.hide()}var r=null,h=this._renderables.indexOf(t);if(h>=0){this._showing=h,r=this._states[h],r.halt();var c=this._outgoingRenderables.indexOf(t);c>=0&&this._outgoingRenderables.splice(c,1)}else{r=new a(0);var p=new o({transform:this.inTransformMap?n.bind(this,this.inTransformMap,r):null,opacity:this.inOpacityMap?n.bind(this,this.inOpacityMap,r):null,origin:this.inOriginMap?n.bind(this,this.inOriginMap,r):null}),u=new s;u.add(p).add(t),this._showing=this._nodes.length,this._nodes.push(u),this._modifiers.push(p),this._states.push(r),this._renderables.push(t)}i||(i=this.options.inTransition),r.set(1,i,e)},e.prototype.hide=function(t,i){if(!(this._showing<0)){var e=this._showing;this._showing=-1,t instanceof Function&&(i=t,t=void 0);var o=this._nodes[e],s=this._modifiers[e],r=this._states[e],a=this._renderables[e];s.transformFrom(this.outTransformMap?n.bind(this,this.outTransformMap,r):null),s.opacityFrom(this.outOpacityMap?n.bind(this,this.outOpacityMap,r):null),s.originFrom(this.outOriginMap?n.bind(this,this.outOriginMap,r):null),this._outgoingRenderables.indexOf(a)<0&&this._outgoingRenderables.push(a),t||(t=this.options.outTransition),r.halt(),r.set(0,t,function(t,e,n,o){if(this._outgoingRenderables.indexOf(o)>=0){var s=this._nodes.indexOf(t);this._nodes.splice(s,1),this._modifiers.splice(s,1),this._states.splice(s,1),this._renderables.splice(s,1),this._outgoingRenderables.splice(this._outgoingRenderables.indexOf(o),1),this._showing>=s&&this._showing--}i&&i.call(this)}.bind(this,o,s,r,a))}},e.prototype.render=function(){var t=this._output;t.length>this._nodes.length&&t.splice(this._nodes.length);for(var i=0;i<this._nodes.length;i++)t[i]=this._nodes[i].render();return t},i.exports=e},{"../core/Modifier":9,"../core/RenderNode":11,"../core/Transform":15,"../core/View":16,"../transitions/Transitionable":88}],107:[function(t,i){function e(t){this.options=Object.create(e.DEFAULT_OPTIONS),this._optionsManager=new r(this.options),t&&this.setOptions(t),this.container=new n(this.options.container),this.scrollview=new s(this.options.scrollview),this.container.add(this.scrollview),this._eventInput=new o,o.setInputHandler(this,this._eventInput),this._eventInput.pipe(this.scrollview),this._eventOutput=new o,o.setOutputHandler(this,this._eventOutput),this.container.pipe(this._eventOutput),this.scrollview.pipe(this._eventOutput)}var n=t("../surfaces/ContainerSurface"),o=t("../core/EventHandler"),s=t("./Scrollview"),r=(t("../utilities/Utility"),t("../core/OptionsManager"));e.DEFAULT_OPTIONS={container:{properties:{overflow:"hidden"}},scrollview:{}},e.prototype.setOptions=function(t){return this._optionsManager.setOptions(t)},e.prototype.sequenceFrom=function(){return this.scrollview.sequenceFrom.apply(this.scrollview,arguments)},e.prototype.getSize=function(){return this.container.getSize.apply(this.container,arguments)},e.prototype.render=function(){return this.container.render()},i.exports=e},{"../core/EventHandler":7,"../core/OptionsManager":10,"../surfaces/ContainerSurface":75,"../utilities/Utility":95,"./Scrollview":109}],108:[function(t,i){function e(t){this.options=Object.create(this.constructor.DEFAULT_OPTIONS),this._optionsManager=new c(this.options),t&&this._optionsManager.setOptions(t),this._node=null,this._position=0,this._positionOffset=0,this._positionGetter=null,this._outputFunction=null,this._masterOutputFunction=null,this.outputFrom(),this._onEdge=0,this.group=new h,this.group.add({render:r.bind(this)}),this._entityId=a.register(this),this._size=[void 0,void 0],this._contextSize=[void 0,void 0],this._eventInput=new f,this._eventOutput=new f,f.setInputHandler(this,this._eventInput),f.setOutputHandler(this,this._eventOutput)}function n(t){t||(t=this._contextSize);var i=this.options.direction;return void 0===t[i]?this._contextSize[i]:t[i]}function o(t,i,e){var o=t.getSize?t.getSize():this._contextSize,s=this._outputFunction(i);return e.push({transform:s,target:t.render()}),n.call(this,o)}function s(){return void 0!==this.options.clipSize?this.options.clipSize:this._contextSize[this.options.direction]>this.getCumulativeSize()[this.options.direction]?n.call(this,this.getCumulativeSize()):n.call(this,this._contextSize)}function r(){for(var t=null,i=this._position,e=[],r=-this._positionOffset,a=s.call(this),h=this._node;h&&r-i<a+this.options.margin;)r+=o.call(this,h,r,e),h=h.getNext?h.getNext():null;var c=this._node,p=n.call(this,c.getSize());if(a>r){for(;c&&a>p;)c=c.getPrevious(),c&&(p+=n.call(this,c.getSize()));for(c=this._node;c&&a>p;)c=c.getNext(),c&&(p+=n.call(this,c.getSize()))}for(!h&&a-d>r-i?1!==this._onEdge&&(this._onEdge=1,this._eventOutput.emit("onEdge",{position:r-a})):!this._node.getPrevious()&&-d>i?-1!==this._onEdge&&(this._onEdge=-1,this._eventOutput.emit("onEdge",{position:0})):0!==this._onEdge&&(this._onEdge=0,this._eventOutput.emit("offEdge")),h=this._node&&this._node.getPrevious?this._node.getPrevious():null,r=-this._positionOffset,h&&(t=h.getSize?h.getSize():this._contextSize,r-=n.call(this,t));h&&r-i>-(a+this.options.margin);)o.call(this,h,r,e),h=h.getPrevious?h.getPrevious():null,h&&(t=h.getSize?h.getSize():this._contextSize,r-=n.call(this,t));return e}var a=t("../core/Entity"),h=t("../core/Group"),c=t("../core/OptionsManager"),p=t("../core/Transform"),u=t("../utilities/Utility"),l=t("../core/ViewSequence"),f=t("../core/EventHandler");e.DEFAULT_OPTIONS={direction:u.Direction.Y,margin:0,clipSize:void 0,groupScroll:!1};var d=0;e.prototype.getCumulativeSize=function(t){return void 0===t&&(t=this._node._.cumulativeSizes.length-1),this._node._.getSize(t)},e.prototype.setOptions=function(t){t.groupScroll!==this.options.groupScroll&&(t.groupScroll?this.group.pipe(this._eventOutput):this.group.unpipe(this._eventOutput)),this._optionsManager.setOptions(t)},e.prototype.onEdge=function(){return this._onEdge},e.prototype.outputFrom=function(t,i){t||(t=function(t){return this.options.direction===u.Direction.X?p.translate(t,0):p.translate(0,t)}.bind(this),i||(i=t)),this._outputFunction=t,this._masterOutputFunction=i?i:function(i){return p.inverse(t(-i))}},e.prototype.positionFrom=function(t){t instanceof Function?this._positionGetter=t:t&&t.get?this._positionGetter=t.get.bind(t):(this._positionGetter=null,this._position=t),this._positionGetter&&(this._position=this._positionGetter.call(this))},e.prototype.sequenceFrom=function(t){t instanceof Array&&(t=new l({array:t})),this._node=t,this._positionOffset=0},e.prototype.getSize=function(t){return t?this._contextSize:this._size},e.prototype.render=function(){return this._node?(this._positionGetter&&(this._position=this._positionGetter.call(this)),this._entityId):null},e.prototype.commit=function(t){var i=t.transform,e=t.opacity,n=t.origin,o=t.size;this.options.clipSize||o[0]===this._contextSize[0]&&o[1]===this._contextSize[1]||(this._onEdge=0,this._contextSize[0]=o[0],this._contextSize[1]=o[1],this.options.direction===u.Direction.X?(this._size[0]=s.call(this),this._size[1]=void 0):(this._size[0]=void 0,this._size[1]=s.call(this)));var r=this._masterOutputFunction(-this._position);return{transform:p.multiply(i,r),size:o,opacity:e,origin:n,target:this.group.render()}},i.exports=e},{"../core/Entity":5,"../core/EventHandler":7,"../core/Group":8,"../core/OptionsManager":10,"../core/Transform":15,"../core/ViewSequence":17,"../utilities/Utility":95}],109:[function(t,i){function e(t){this.options=Object.create(e.DEFAULT_OPTIONS),this._optionsManager=new O(this.options),this._scroller=new T(this.options),this.sync=new b(["scroll","touch"],{direction:this.options.direction,scale:this.options.syncScale,rails:this.options.rails,preventDefault:void 0!==this.options.preventDefault?this.options.preventDefault:this.options.direction!==w.Direction.Y}),this._physicsEngine=new _,this._particle=new y,this._physicsEngine.addBody(this._particle),this.spring=new v({anchor:[0,0,0],period:this.options.edgePeriod,dampingRatio:this.options.edgeDamp}),this.drag=new g({forceFunction:g.FORCE_FUNCTIONS.QUADRATIC,strength:this.options.drag}),this.friction=new g({forceFunction:g.FORCE_FUNCTIONS.LINEAR,strength:this.options.friction}),this._node=null,this._touchCount=0,this._springState=x.NONE,this._onEdge=M.NONE,this._pageSpringPosition=0,this._edgeSpringPosition=0,this._touchVelocity=0,this._earlyEnd=!1,this._needsPaginationCheck=!1,this._displacement=0,this._totalShift=0,this._cachedIndex=0,this._scroller.positionFrom(this.getPosition.bind(this)),this._eventInput=new m,this._eventOutput=new m,this._eventInput.pipe(this.sync),this.sync.pipe(this._eventInput),m.setInputHandler(this,this._eventInput),m.setOutputHandler(this,this._eventOutput),r.call(this),t&&this.setOptions(t)}function n(t){this._touchCount=t.count,void 0===t.count&&(this._touchCount=1),h.call(this),this.setVelocity(0),this._touchVelocity=0,this._earlyEnd=!1}function o(t){var i=-t.velocity,e=-t.delta;if(this._onEdge!==M.NONE&&t.slip&&(0>i&&this._onEdge===M.TOP||i>0&&this._onEdge===M.BOTTOM?this._earlyEnd||(s.call(this,t),this._earlyEnd=!0):this._earlyEnd&&Math.abs(i)>Math.abs(this.getVelocity())&&n.call(this,t)),!this._earlyEnd){if(this._touchVelocity=i,t.slip){var o=this.options.speedLimit;-o>i?i=-o:i>o&&(i=o),this.setVelocity(i);var r=16*o;e>r?e=r:-r>e&&(e=-r)}this.setPosition(this.getPosition()+e),this._displacement+=e,this._springState===x.NONE&&f.call(this)}}function s(t){if(this._touchCount=t.count||0,!this._touchCount){h.call(this),this._onEdge!==M.NONE&&l.call(this,this._edgeSpringPosition,x.EDGE),a.call(this);var i=-t.velocity,e=this.options.speedLimit;t.slip&&(e*=this.options.edgeGrip),-e>i?i=-e:i>e&&(i=e),this.setVelocity(i),this._touchVelocity=0,this._needsPaginationCheck=!0}}function r(){this._eventInput.bindThis(this),this._eventInput.on("start",n),this._eventInput.on("update",o),this._eventInput.on("end",s),this._eventInput.on("resize",function(){this._node._.calculateSize()}.bind(this)),this._scroller.on("onEdge",function(t){this._edgeSpringPosition=t.position,p.call(this,this._scroller.onEdge()),this._eventOutput.emit("onEdge")}.bind(this)),this._scroller.on("offEdge",function(){this.sync.setOptions({scale:this.options.syncScale}),this._onEdge=this._scroller.onEdge(),this._eventOutput.emit("offEdge")}.bind(this)),this._particle.on("update",function(t){this._springState===x.NONE&&f.call(this),this._displacement=t.position.x-this._totalShift}.bind(this)),this._particle.on("end",function(){(!this.options.paginated||this.options.paginated&&this._springState!==x.NONE)&&this._eventOutput.emit("settle")}.bind(this))}function a(){this._springState?this._physicsEngine.attach([this.spring],this._particle):this._physicsEngine.attach([this.drag,this.friction],this._particle)}function h(){this._springState=x.NONE,this._physicsEngine.detachAll()}function c(t){var i=this.options.direction,e=t.getSize();return e?e[i]:this._scroller.getSize()[i]}function p(t){this.sync.setOptions({scale:this.options.edgeGrip}),this._onEdge=t,this._touchCount||this._springState===x.EDGE||l.call(this,this._edgeSpringPosition,x.EDGE),this._springState&&Math.abs(this.getVelocity())<.001&&(h.call(this),a.call(this))}function u(){if(!this._touchCount&&this._springState!==x.EDGE){var t=this.getVelocity();if(!(Math.abs(t)>=this.options.pageStopSpeed)){var i=this.getPosition(),e=Math.abs(t)>this.options.pageSwitchSpeed,n=c.call(this,this._node),o=i>.5*n,s=t>0,r=0>t;this._needsPaginationCheck=!1,o&&!e||e&&s?this.goToNextPage():e&&r?this.goToPreviousPage():l.call(this,0,x.PAGE)}}}function l(t,i){var e;i===x.EDGE?(this._edgeSpringPosition=t,e={anchor:[this._edgeSpringPosition,0,0],period:this.options.edgePeriod,dampingRatio:this.options.edgeDamp}):i===x.PAGE&&(this._pageSpringPosition=t,e={anchor:[this._pageSpringPosition,0,0],period:this.options.pagePeriod,dampingRatio:this.options.pageDamp}),this.spring.setOptions(e),i&&!this._springState&&(h.call(this),this._springState=i,a.call(this)),this._springState=i}function f(){var t=0,i=this.getPosition();i+=(0>i?-.5:.5)>>0;for(var e=c.call(this,this._node),n=this._node.getNext();t+i>=e&&n;)t-=e,this._scroller.sequenceFrom(n),this._node=n,n=this._node.getNext(),e=c.call(this,this._node);for(var o,s=this._node.getPrevious();0>=t+i&&s;)o=c.call(this,s),this._scroller.sequenceFrom(s),this._node=s,t+=o,s=this._node.getPrevious();t&&d.call(this,t),this._node&&(this._node.index!==this._cachedIndex?this.getPosition()<.5*e&&(this._cachedIndex=this._node.index,this._eventOutput.emit("pageChange",{direction:-1,index:this._cachedIndex})):this.getPosition()>.5*e&&(this._cachedIndex=this._node.index+1,this._eventOutput.emit("pageChange",{direction:1,index:this._cachedIndex})))}function d(t){this._edgeSpringPosition+=t,this._pageSpringPosition+=t,this.setPosition(this.getPosition()+t),this._totalShift+=t,this._springState===x.EDGE?this.spring.setOptions({anchor:[this._edgeSpringPosition,0,0]}):this._springState===x.PAGE&&this.spring.setOptions({anchor:[this._pageSpringPosition,0,0]})}var _=t("../physics/PhysicsEngine"),y=t("../physics/bodies/Particle"),g=t("../physics/forces/Drag"),v=t("../physics/forces/Spring"),m=t("../core/EventHandler"),O=t("../core/OptionsManager"),S=t("../core/ViewSequence"),T=t("../views/Scroller"),w=t("../utilities/Utility"),b=t("../inputs/GenericSync"),E=t("../inputs/ScrollSync"),I=t("../inputs/TouchSync");b.register({scroll:E,touch:I});var x={NONE:0,EDGE:1,PAGE:2},M={TOP:-1,NONE:0,BOTTOM:1};e.DEFAULT_OPTIONS={direction:w.Direction.Y,rails:!0,friction:.005,drag:1e-4,edgeGrip:.2,edgePeriod:300,edgeDamp:1,margin:1e3,paginated:!1,pagePeriod:500,pageDamp:.8,pageStopSpeed:10,pageSwitchSpeed:.5,speedLimit:5,groupScroll:!1,syncScale:1},e.prototype.getCurrentIndex=function(){return this._node.index},e.prototype.goToPreviousPage=function(){if(!this._node||this._onEdge===M.TOP)return null;if(this.getPosition()>1&&this._springState===x.NONE)return l.call(this,0,x.PAGE),this._node;var t=this._node.getPrevious();if(t){var i=c.call(this,t);this._scroller.sequenceFrom(t),this._node=t,d.call(this,i),l.call(this,0,x.PAGE)}return t},e.prototype.goToNextPage=function(){if(!this._node||this._onEdge===M.BOTTOM)return null;var t=this._node.getNext();if(t){var i=c.call(this,this._node);this._scroller.sequenceFrom(t),this._node=t,d.call(this,-i),l.call(this,0,x.PAGE)}return t},e.prototype.goToPage=function(t){var i,e=this.getCurrentIndex();if(e>t)for(i=0;e-t>i;i++)this.goToPreviousPage();if(t>e)for(i=0;t-e>i;i++)this.goToNextPage()},e.prototype.outputFrom=function(){return this._scroller.outputFrom.apply(this._scroller,arguments)},e.prototype.getPosition=function(){return this._particle.getPosition1D()},e.prototype.getAbsolutePosition=function(){return this._scroller.getCumulativeSize(this.getCurrentIndex())[this.options.direction]+this.getPosition()},e.prototype.getOffset=e.prototype.getPosition,e.prototype.setPosition=function(t){this._particle.setPosition1D(t)},e.prototype.setOffset=e.prototype.setPosition,e.prototype.getVelocity=function(){return this._touchCount?this._touchVelocity:this._particle.getVelocity1D()},e.prototype.setVelocity=function(t){this._particle.setVelocity1D(t)},e.prototype.setOptions=function(t){void 0!==t.direction&&("x"===t.direction?t.direction=w.Direction.X:"y"===t.direction&&(t.direction=w.Direction.Y)),t.groupScroll!==this.options.groupScroll&&(t.groupScroll?this.subscribe(this._scroller):this.unsubscribe(this._scroller)),this._optionsManager.setOptions(t),this._scroller.setOptions(t),void 0!==t.drag&&this.drag.setOptions({strength:this.options.drag}),void 0!==t.friction&&this.friction.setOptions({strength:this.options.friction}),(void 0!==t.edgePeriod||void 0!==t.edgeDamp)&&this.spring.setOptions({period:this.options.edgePeriod,dampingRatio:this.options.edgeDamp}),(t.rails||void 0!==t.direction||void 0!==t.syncScale||t.preventDefault)&&this.sync.setOptions({rails:this.options.rails,direction:this.options.direction===w.Direction.X?b.DIRECTION_X:b.DIRECTION_Y,scale:this.options.syncScale,preventDefault:this.options.preventDefault})},e.prototype.sequenceFrom=function(t){return t instanceof Array&&(t=new S({array:t,trackSize:!0})),this._node=t,this._scroller.sequenceFrom(t)},e.prototype.getSize=function(){return this._scroller.getSize.apply(this._scroller,arguments)},e.prototype.render=function(){return this.options.paginated&&this._needsPaginationCheck&&u.call(this),this._scroller.render()},i.exports=e},{"../core/EventHandler":7,"../core/OptionsManager":10,"../core/ViewSequence":17,"../inputs/GenericSync":27,"../inputs/ScrollSync":32,"../inputs/TouchSync":33,"../physics/PhysicsEngine":48,"../physics/bodies/Particle":51,"../physics/forces/Drag":63,"../physics/forces/Spring":68,"../utilities/Utility":95,"../views/Scroller":108}],110:[function(t,i){function e(t){this._items=null,this._size=null,this._outputFunction=e.DEFAULT_OUTPUT_FUNCTION,this.options=r.clone(this.constructor.DEFAULT_OPTIONS||e.DEFAULT_OPTIONS),this.optionsManager=new n(this.options),t&&this.setOptions(t)}var n=t("../core/OptionsManager"),o=t("../core/Transform"),s=t("../core/ViewSequence"),r=t("../utilities/Utility");e.DEFAULT_OPTIONS={direction:r.Direction.Y,itemSpacing:0},e.DEFAULT_OUTPUT_FUNCTION=function(t,i){var e=this.options.direction===r.Direction.X?o.translate(i,0):o.translate(0,i);return{transform:e,target:t.render()}},e.prototype.getSize=function(){return this._size||this.render(),this._size},e.prototype.sequenceFrom=function(t){return t instanceof Array&&(t=new s(t)),this._items=t,this},e.prototype.setOptions=function(){return this.optionsManager.setOptions.apply(this.optionsManager,arguments),this},e.prototype.setOutputFunction=function(t){return this._outputFunction=t,this},e.prototype.render=function(){var t=0,i=1^this.options.direction,e=this._items,n=null,o=[],s={},r=[],a=0;for(this._size=[0,0];e&&(n=e.get());)n.getSize&&(o=n.getSize()),s=this._outputFunction.call(this,n,t,a++),r.push(s),o&&(o[this.options.direction]&&(t+=o[this.options.direction]),o[i]>this._size[i]&&(this._size[i]=o[i])),e=e.getNext(),this.options.itemSpacing&&e&&(t+=this.options.itemSpacing);return this._size[this.options.direction]=t,r},i.exports=e},{"../core/OptionsManager":10,"../core/Transform":15,"../core/ViewSequence":17,"../utilities/Utility":95}],111:[function(t,i){i.exports={ContextualView:t("./ContextualView"),Deck:t("./Deck"),EdgeSwapper:t("./EdgeSwapper"),DrawerLayout:t("./DrawerLayout"),FlexibleLayout:t("./FlexibleLayout"),Flipper:t("./Flipper"),GridLayout:t("./GridLayout"),HeaderFooterLayout:t("./HeaderFooterLayout"),Lightbox:t("./Lightbox"),RenderController:t("./RenderController"),ScrollContainer:t("./ScrollContainer"),Scroller:t("./Scroller"),Scrollview:t("./Scrollview"),SequentialLayout:t("./SequentialLayout")}},{"./ContextualView":97,"./Deck":98,"./DrawerLayout":99,"./EdgeSwapper":100,"./FlexibleLayout":101,"./Flipper":102,"./GridLayout":103,"./HeaderFooterLayout":104,"./Lightbox":105,"./RenderController":106,"./ScrollContainer":107,"./Scroller":108,"./Scrollview":109,"./SequentialLayout":110}],112:[function(t,i){function e(){r.apply(this,arguments),this.title=new o({classes:this.options.classes,content:this.options.content}),this.back=new o({size:[this.options.size[1],this.options.size[1]],classes:this.options.classes,content:this.options.backContent}),this.back.on("click",function(){this._eventOutput.emit("back",{})}.bind(this)),this.more=new o({size:[this.options.size[1],this.options.size[1]],classes:this.options.classes,content:this.options.moreContent}),this.more.on("click",function(){this._eventOutput.emit("more",{})}.bind(this)),this.layout=new n({id:"master",size:this.options.size,target:[{transform:s.inFront,origin:[0,.5],target:this.back},{origin:[.5,.5],target:this.title},{transform:s.inFront,origin:[1,.5],target:this.more}]}),this._add(this.layout),this._optionsManager.on("change",function(t){var i=t.id,e=t.value;"size"===i?(this.layout.id.master.setSize(e),this.title.setSize(e),this.back.setSize([e[1],e[1]]),this.more.setSize([e[1],e[1]])):"backClasses"===i?this.back.setOptions({classes:this.options.classes.concat(this.options.backClasses)}):"backContent"===i?this.back.setContent(this.options.backContent):"classes"===i?(this.title.setOptions({classes:this.options.classes}),this.back.setOptions({classes:this.options.classes.concat(this.options.backClasses)}),this.more.setOptions({classes:this.options.classes.concat(this.options.moreClasses)})):"content"===i?this.setContent(this.options.content):"moreClasses"===i?this.more.setOptions({classes:this.options.classes.concat(this.options.moreClasses)}):"moreContent"===i&&this.more.setContent(this.options.content)}.bind(this))}var n=t("../core/Scene"),o=t("../core/Surface"),s=t("../core/Transform"),r=t("../core/View");e.prototype=Object.create(r.prototype),e.prototype.constructor=e,e.DEFAULT_OPTIONS={size:[void 0,50],backClasses:["back"],backContent:"&#x25c0;",classes:["navigation"],content:"",moreClasses:["more"],moreContent:"&#x271a;"},e.prototype.setContent=function(t){return this.title.setContent(t)},i.exports=e},{"../core/Scene":12,"../core/Surface":14,"../core/Transform":15,"../core/View":16}],113:[function(t,i){function e(t){this.options=Object.create(e.DEFAULT_OPTIONS),this.optionsManager=new c(this.options),t&&this.setOptions(t),this.indicator=new s({size:this.options.indicatorSize,classes:["slider-back"]}),this.label=new o({size:this.options.labelSize,content:this.options.label,properties:{pointerEvents:"none"},classes:["slider-label"]}),this.eventOutput=new a,this.eventInput=new a,a.setInputHandler(this,this.eventInput),a.setOutputHandler(this,this.eventOutput);var i=(this.options.range[1]-this.options.range[0])/this.options.indicatorSize[0];this.sync=new l(["mouse","touch"],{scale:i,direction:l.DIRECTION_X}),this.indicator.pipe(this.sync),this.sync.pipe(this),this.eventInput.on("update",function(t){this.set(t.position)}.bind(this)),this._drawPos=0,n.call(this)}function n(){this.label.setContent(this.options.label+'<span style="float: right">'+this.get().toFixed(this.options.precision)+"</span>")}var o=t("../core/Surface"),s=t("../surfaces/CanvasSurface"),r=t("../core/Transform"),a=t("../core/EventHandler"),h=t("../math/Utilities"),c=t("../core/OptionsManager"),p=t("../inputs/MouseSync"),u=t("../inputs/TouchSync"),l=t("../inputs/GenericSync");l.register({mouse:p,touch:u}),e.DEFAULT_OPTIONS={size:[200,60],indicatorSize:[200,30],labelSize:[200,30],range:[0,1],precision:2,value:0,label:"",fillColor:"rgba(170, 170, 170, 1)"},e.prototype.setOptions=function(t){return this.optionsManager.setOptions(t)},e.prototype.get=function(){return this.options.value},e.prototype.set=function(t){t!==this.options.value&&(this.options.value=h.clamp(t,this.options.range),n.call(this),this.eventOutput.emit("change",{value:t}))},e.prototype.getSize=function(){return this.options.size},e.prototype.render=function(){var t=this.options.range,i=Math.floor((this.get()-t[0])/(t[1]-t[0])*this.options.indicatorSize[0]);if(i<this._drawPos)this.indicator.getContext("2d").clearRect(i,0,this._drawPos-i+1,this.options.indicatorSize[1]);else if(i>this._drawPos){var e=this.indicator.getContext("2d");e.fillStyle=this.options.fillColor,e.fillRect(this._drawPos-1,0,i-this._drawPos+1,this.options.indicatorSize[1])}return this._drawPos=i,{size:this.options.size,target:[{origin:[0,0],target:this.indicator.render()},{transform:r.translate(0,0,1),origin:[0,0],target:this.label.render()}]}},i.exports=e},{"../core/EventHandler":7,"../core/OptionsManager":10,"../core/Surface":14,"../core/Transform":15,"../inputs/GenericSync":27,"../inputs/MouseSync":28,"../inputs/TouchSync":33,"../math/Utilities":40,"../surfaces/CanvasSurface":74}],114:[function(t,i){function e(){r.apply(this,arguments),this.layout=new a,this.buttons=[],this._buttonIds={},this._buttonCallbacks={},this.layout.sequenceFrom(this.buttons),this._add(this.layout),this._optionsManager.on("change",n.bind(this))}function n(t){var i=t.id,e=t.value;if("direction"===i)this.layout.setOptions({dimensions:o.call(this.buttons.length,this.options.direction)});else if("buttons"===i)for(var n in this.buttons)this.buttons[n].setOptions(e);else if("sections"===i)for(var s in this.options.sections)this.defineSection(s,this.options.sections[s])}function o(t,i){return i===s.Direction.X?[t,1]:[1,t]}var s=t("../utilities/Utility"),r=t("../core/View"),a=t("../views/GridLayout"),h=t("./ToggleButton");e.prototype=Object.create(r.prototype),e.prototype.constructor=e,e.DEFAULT_OPTIONS={sections:[],widget:h,size:[void 0,50],direction:s.Direction.X,buttons:{toggleMode:h.ON}},e.prototype.defineSection=function(t,i){var e,n=this._buttonIds[t];if(void 0===n){n=this.buttons.length,this._buttonIds[t]=n;var s=this.options.widget;e=new s,this.buttons[n]=e,this.layout.setOptions({dimensions:o(this.buttons.length,this.options.direction)})}else e=this.buttons[n],e.unbind("select",this._buttonCallbacks[t]);this.options.buttons&&e.setOptions(this.options.buttons),e.setOptions(i),this._buttonCallbacks[t]=this.select.bind(this,t),e.on("select",this._buttonCallbacks[t])},e.prototype.select=function(t){var i=this._buttonIds[t];this.buttons[i]&&this.buttons[i].isSelected()?this._eventOutput.emit("select",{id:t}):this.buttons[i]&&this.buttons[i].select();for(var e=0;e<this.buttons.length;e++)e!==i&&this.buttons[e].deselect()},i.exports=e},{"../core/View":16,"../utilities/Utility":95,"../views/GridLayout":103,"./ToggleButton":115}],115:[function(t,i){function e(t){this.options={content:"",offClasses:["off"],onClasses:["on"],size:void 0,outTransition:{curve:"easeInOut",duration:300},inTransition:{curve:"easeInOut",duration:300},toggleMode:e.TOGGLE,crossfade:!0},this._eventOutput=new o,o.setOutputHandler(this,this._eventOutput),this.offSurface=new n,this.offSurface.on("click",function(){this.options.toggleMode!==e.OFF&&this.select()}.bind(this)),this.offSurface.pipe(this._eventOutput),this.onSurface=new n,this.onSurface.on("click",function(){this.options.toggleMode!==e.ON&&this.deselect()}.bind(this)),this.onSurface.pipe(this._eventOutput),this.arbiter=new s({overlap:this.options.crossfade}),this.deselect(),t&&this.setOptions(t)}var n=t("../core/Surface"),o=t("../core/EventHandler"),s=t("../views/RenderController");e.OFF=0,e.ON=1,e.TOGGLE=2,e.prototype.select=function(){this.selected=!0,this.arbiter.show(this.onSurface,this.options.inTransition),this._eventOutput.emit("select")},e.prototype.deselect=function(){this.selected=!1,this.arbiter.show(this.offSurface,this.options.outTransition),this._eventOutput.emit("deselect")},e.prototype.isSelected=function(){return this.selected},e.prototype.setOptions=function(t){void 0!==t.content&&(this.options.content=t.content,this.offSurface.setContent(this.options.content),this.onSurface.setContent(this.options.content)),t.offClasses&&(this.options.offClasses=t.offClasses,this.offSurface.setClasses(this.options.offClasses)),t.onClasses&&(this.options.onClasses=t.onClasses,this.onSurface.setClasses(this.options.onClasses)),void 0!==t.size&&(this.options.size=t.size,this.onSurface.setSize(this.options.size),this.offSurface.setSize(this.options.size)),void 0!==t.toggleMode&&(this.options.toggleMode=t.toggleMode),void 0!==t.outTransition&&(this.options.outTransition=t.outTransition),void 0!==t.inTransition&&(this.options.inTransition=t.inTransition),void 0!==t.crossfade&&(this.options.crossfade=t.crossfade,this.arbiter.setOptions({overlap:this.options.crossfade}))},e.prototype.getSize=function(){return this.options.size},e.prototype.render=function(){return this.arbiter.render()},i.exports=e},{"../core/EventHandler":7,"../core/Surface":14,"../views/RenderController":106}],116:[function(t,i){i.exports={NavigationBar:t("./NavigationBar"),Slider:t("./Slider"),TabBar:t("./TabBar"),ToggleButton:t("./ToggleButton")}},{"./NavigationBar":112,"./Slider":113,"./TabBar":114,"./ToggleButton":115}]},{},[23])(23)});
; browserify_shim__define__module__export__(typeof famous != "undefined" ? famous : window.famous);

}).call(global, undefined, undefined, undefined, undefined, function defineExport(ex) { module.exports = ex; });

}).call(this,typeof global !== "undefined" ? global : typeof self !== "undefined" ? self : typeof window !== "undefined" ? window : {})
},{}],"/home/ubuntu/workspace/bower_components/ionic/release/js/ionic-angular.min.js":[function(require,module,exports){
(function (global){

; require("/home/ubuntu/workspace/bower_components/ionic/release/js/ionic.min.js");
require("/home/ubuntu/workspace/bower_components/angular/angular.min.js");
require("/home/ubuntu/workspace/bower_components/angular-animate/angular-animate.min.js");
require("/home/ubuntu/workspace/bower_components/angular-sanitize/angular-sanitize.min.js");
require("/home/ubuntu/workspace/bower_components/angular-ui-router/release/angular-ui-router.min.js");
;__browserify_shim_require__=require;(function browserifyShim(module, exports, require, define, browserify_shim__define__module__export__) {
/*!
 * Copyright 2014 Drifty Co.
 * http://drifty.com/
 *
 * Ionic, v1.0.0-beta.13
 * A powerful HTML5 mobile app framework.
 * http://ionicframework.com/
 *
 * By @maxlynch, @benjsperry, @adamdbradley <3
 *
 * Licensed under the MIT license. Please see LICENSE for more information.
 *
 */

!function(){function e(e){if(e.$root!==e){var t=e.$parent;e.$$disconnected=!0,t.$$childHead===e&&(t.$$childHead=e.$$nextSibling),t.$$childTail===e&&(t.$$childTail=e.$$prevSibling),e.$$prevSibling&&(e.$$prevSibling.$$nextSibling=e.$$nextSibling),e.$$nextSibling&&(e.$$nextSibling.$$prevSibling=e.$$prevSibling),e.$$nextSibling=e.$$prevSibling=null}}function t(e){if(e.$root!==e&&e.$$disconnected){var t=e.$parent;e.$$disconnected=!1,e.$$prevSibling=t.$$childTail,t.$$childHead?(t.$$childTail.$$nextSibling=e,t.$$childTail=e):t.$$childHead=t.$$childTail=e}}function n(e){return["$log",function(t){function n(e){this.handle=e}var i=this,o=this._instances=[];this._registerInstance=function(e,t){return e.$$delegateHandle=t,o.push(e),function(){var t=o.indexOf(e);-1!==t&&o.splice(t,1)}},this.$getByHandle=function(e){return e?new n(e):i},e.forEach(function(e){n.prototype[e]=function(){var n,i,r=this.handle,a=arguments,s=0;return o.forEach(function(t){t.$$delegateHandle===r&&(s++,i=t[e].apply(t,a),1===s&&(n=i))}),s?n:t.warn('Delegate for handle "'+this.handle+'" could not find a corresponding element with delegate-handle="'+this.handle+'"! '+e+"() was not called!\nPossible cause: If you are calling "+e+'() immediately, and your element with delegate-handle="'+this.handle+'" is a child of your controller, then your element may not be compiled yet. Put a $timeout around your call to '+e+"() and try again.")},i[e]=function(){var t,n,i=arguments;return o.forEach(function(o,r){n=o[e].apply(o,i),0===r&&(t=n)}),t}})}]}function i(e,t){return[function(){return{priority:"99",link:function(n,i,o){o.$observe(e,function(e){e||i[0].removeAttribute(t)})}}}]}function o(e){return["$ionicGesture","$parse",function(t,n){var i=e.substr(2).toLowerCase();return function(o,r,a){var s=n(a[e]),c=function(e){o.$apply(function(){s(o,{$event:e})})},l=t.on(i,c,r);o.$on("$destroy",function(){t.off(l,i,c)})}}]}function r(){return["$ionicScrollDelegate",function(e){return{restrict:"E",link:function(t,n,i){function o(t){for(var i=3,o=t.target;i--&&o;){if(o.classList.contains("button")||o.tagName.match(/input|textarea|select/i)||o.isContentEditable)return;o=o.parentNode}var r=t.gesture&&t.gesture.touches[0]||t.detail.touches[0],a=n[0].getBoundingClientRect();ionic.DomUtil.rectContains(r.pageX,r.pageY,a.left,a.top-20,a.left+a.width,a.top+a.height)&&e.scrollTop(!0)}"true"!=i.noTapScroll&&(ionic.on("tap",o,n[0]),t.$on("$destroy",function(){ionic.off("tap",o,n[0])}))}}}]}function a(e){return[function(){return{restrict:"E",compile:function(t){function n(t,n,i){var o=(new ionic.views.HeaderBar({el:n[0],alignTitle:i.alignTitle||"center"}),n[0]);e?(t.$watch(function(){return o.className},function(e){var n=-1===e.indexOf("ng-hide"),i=-1!==e.indexOf("bar-subheader");t.$hasHeader=n&&!i,t.$hasSubheader=n&&i}),t.$on("$destroy",function(){delete t.$hasHeader,delete t.$hasSubheader})):(t.$watch(function(){return o.className},function(e){var n=-1===e.indexOf("ng-hide"),i=-1!==e.indexOf("bar-subfooter");t.$hasFooter=n&&!i,t.$hasSubfooter=n&&i}),t.$on("$destroy",function(){delete t.$hasFooter,delete t.$hasSubfooter}),t.$watch("$hasTabs",function(e){n.toggleClass("has-tabs",!!e)}))}t.addClass(e?"bar bar-header":"bar bar-footer");var i=t[0].parentNode;return i.querySelector(".tabs-top")&&t.addClass("has-tabs-top"),{pre:n}}}}]}function s(e){return e.clientHeight}function c(e){e.stopPropagation()}var l={method:function(e,t,n){var i=!1;return function(){return i||(i=!0,t(e)),n.apply(this,arguments)}},field:function(e,t,n,i,o){var r=!1,a=function(){return r||(r=!0,t(e)),o},s=function(n){return r||(r=!0,t(e)),o=n,n};Object.defineProperty(n,i,{get:a,set:s,enumerable:!0})}},u=angular.module("ionic",["ngAnimate","ngSanitize","ui.router"]),d=angular.extend,f=angular.forEach,h=angular.isDefined,p=angular.isString,v=angular.element;u.factory("$ionicActionSheet",["$rootScope","$compile","$animate","$timeout","$ionicTemplateLoader","$ionicPlatform","$ionicBody",function(e,t,n,i,o,r,a){function s(o){var s=e.$new(!0);angular.extend(s,{cancel:angular.noop,destructiveButtonClicked:angular.noop,buttonClicked:angular.noop,$deregisterBackButton:angular.noop,buttons:[],cancelOnStateChange:!0},o||{});var c=s.element=t('<ion-action-sheet buttons="buttons"></ion-action-sheet>')(s),l=v(c[0].querySelector(".action-sheet-wrapper")),u=s.cancelOnStateChange?e.$on("$stateChangeSuccess",function(){s.cancel()}):angular.noop;return s.removeSheet=function(e){s.removed||(s.removed=!0,l.removeClass("action-sheet-up"),i(function(){a.removeClass("action-sheet-open")},400),s.$deregisterBackButton(),u(),n.removeClass(c,"active",function(){s.$destroy(),c.remove(),s.cancel.$scope=null,(e||angular.noop)()}))},s.showSheet=function(e){s.removed||(a.append(c).addClass("action-sheet-open"),n.addClass(c,"active",function(){s.removed||(e||angular.noop)()}),i(function(){s.removed||l.addClass("action-sheet-up")},20,!1))},s.$deregisterBackButton=r.registerBackButtonAction(function(){i(s.cancel)},C),s.cancel=function(){s.removeSheet(o.cancel)},s.buttonClicked=function(e){o.buttonClicked(e,o.buttons[e])===!0&&s.removeSheet()},s.destructiveButtonClicked=function(){o.destructiveButtonClicked()===!0&&s.removeSheet()},s.showSheet(),s.cancel.$scope=s,s.cancel}return{show:s}}]),v.prototype.addClass=function(e){var t,n,i,o,r,a;if(e&&"ng-scope"!=e&&"ng-isolate-scope"!=e)for(t=0;t<this.length;t++)if(o=this[t],o.setAttribute)if(e.indexOf(" ")<0&&o.classList.add)o.classList.add(e);else{for(a=(" "+(o.getAttribute("class")||"")+" ").replace(/[\n\t]/g," "),r=e.split(" "),n=0;n<r.length;n++)i=r[n].trim(),-1===a.indexOf(" "+i+" ")&&(a+=i+" ");o.setAttribute("class",a.trim())}return this},v.prototype.removeClass=function(e){var t,n,i,o,r;if(e)for(t=0;t<this.length;t++)if(r=this[t],r.getAttribute)if(e.indexOf(" ")<0&&r.classList.remove)r.classList.remove(e);else for(i=e.split(" "),n=0;n<i.length;n++)o=i[n],r.setAttribute("class",(" "+(r.getAttribute("class")||"")+" ").replace(/[\n\t]/g," ").replace(" "+o.trim()+" "," ").trim());return this},u.factory("$ionicBackdrop",["$document","$timeout",function(e,t){function n(){1===++a&&(r.addClass("visible"),ionic.requestAnimationFrame(function(){a&&r.addClass("active")}))}function i(){0===--a&&(r.removeClass("active"),t(function(){!a&&r.removeClass("visible")},400,!1))}function o(){return r}var r=v('<div class="backdrop">'),a=0;return e[0].body.appendChild(r[0]),{retain:n,release:i,getElement:o,_element:r}}]),u.factory("$ionicBind",["$parse","$interpolate",function(e,t){var n=/^\s*([@=&])(\??)\s*(\w*)\s*$/;return function(i,o,r){f(r||{},function(r,a){var s,c,l=r.match(n)||[],u=l[3]||a,d=l[1];switch(d){case"@":if(!o[u])return;o.$observe(u,function(e){i[a]=e}),o[u]&&(i[a]=t(o[u])(i));break;case"=":if(!o[u])return;c=i.$watch(o[u],function(e){i[a]=e}),i.$on("$destroy",c);break;case"&":if(o[u]&&o[u].match(RegExp(a+"(.*?)")))throw new Error('& expression binding "'+a+'" looks like it will recursively call "'+o[u]+'" and cause a stack overflow! Please choose a different scopeName.');s=e(o[u]),i[a]=function(e){return s(i,e)}}})}}]),u.factory("$ionicBody",["$document",function(e){return{addClass:function(){for(var t=0;t<arguments.length;t++)e[0].body.classList.add(arguments[t]);return this},removeClass:function(){for(var t=0;t<arguments.length;t++)e[0].body.classList.remove(arguments[t]);return this},enableClass:function(e){var t=Array.prototype.slice.call(arguments).slice(1);return e?this.addClass.apply(this,t):this.removeClass.apply(this,t),this},append:function(t){return e[0].body.appendChild(t.length?t[0]:t),this},get:function(){return e[0].body}}}]),u.factory("$ionicClickBlock",["$document","$ionicBody","$timeout",function(e,t,n){var i=e[0].createElement("div");return i.className="click-block",{show:function(){i.parentElement?i.classList.remove("hide"):t.append(i),n(function(){i.classList.add("hide")},500)},hide:function(){i.classList.add("hide")}}}]),u.factory("$collectionDataSource",["$cacheFactory","$parse","$rootScope",function(n,i,o){function r(e){e.css(ionic.CSS.TRANSFORM,"translate3d(-2000px,-2000px,0)")}function a(e){this.scope=e.scope,this.transcludeFn=e.transcludeFn,this.transcludeParent=e.transcludeParent,this.element=e.element,this.keyExpr=e.keyExpr,this.listExpr=e.listExpr,this.trackByExpr=e.trackByExpr,this.heightGetter=e.heightGetter,this.widthGetter=e.widthGetter,this.dimensions=[],this.data=[],this.attachedItems={},this.BACKUP_ITEMS_LENGTH=20,this.backupItemsArray=[]}return a.prototype={setup:function(){if(!this.isSetup){this.isSetup=!0;for(var e=0;e<this.BACKUP_ITEMS_LENGTH;e++)this.detachItem(this.createItem())}},destroy:function(){this.dimensions.length=0,this.data=null,this.backupItemsArray.length=0,this.attachedItems={}},calculateDataDimensions:function(){var e={};this.dimensions=this.data.map(function(t,n){return e[this.keyExpr]=t,e.$index=n,{width:this.widthGetter(this.scope,e),height:this.heightGetter(this.scope,e)}},this),this.dimensions=this.beforeSiblings.concat(this.dimensions).concat(this.afterSiblings),this.dataStartIndex=this.beforeSiblings.length},createItem:function(){var e={};return e.scope=this.scope.$new(),this.transcludeFn(e.scope,function(t){t.css("position","absolute"),e.element=t}),this.transcludeParent.append(e.element),e},getItem:function(e){return(item=this.attachedItems[e])||((item=this.backupItemsArray.pop())?t(item.scope):item=this.createItem()),item},attachItemAtIndex:function(e){if(e<this.dataStartIndex)return this.beforeSiblings[e];if(e-=this.dataStartIndex,e>this.data.length-1)return this.afterSiblings[e-this.dataStartIndex];var t=this.getItem(e),n=this.data[e];return(t.index!==e||t.scope[this.keyExpr]!==n)&&(t.index=t.scope.$index=e,t.scope[this.keyExpr]=n,t.scope.$first=0===e,t.scope.$last=e===this.getLength()-1,t.scope.$middle=!(t.scope.$first||t.scope.$last),t.scope.$odd=!(t.scope.$even=0===(1&e)),o.$$phase||t.scope.$digest()),this.attachedItems[e]=t,t},destroyItem:function(e){e.element.remove(),e.scope.$destroy(),e.scope=null,e.element=null},detachItem:function(t){delete this.attachedItems[t.index],t.isOutside?r(t.element):this.backupItemsArray.length>=this.BACKUP_ITEMS_LENGTH?this.destroyItem(t):(this.backupItemsArray.push(t),r(t.element),e(t.scope))},getLength:function(){return this.dimensions&&this.dimensions.length||0},setData:function(e,t,n){this.data=e||[],this.beforeSiblings=t||[],this.afterSiblings=n||[],this.calculateDataDimensions(),this.afterSiblings.forEach(function(e){e.element.css({position:"absolute",top:"0",left:"0"}),r(e.element)})}},a}]),u.factory("$collectionRepeatManager",["$rootScope","$timeout",function(){function e(e){function t(){return n.viewportSize}var n=this;this.dataSource=e.dataSource,this.element=e.element,this.scrollView=e.scrollView,this.isVertical=!!this.scrollView.options.scrollingY,this.renderedItems={},this.dimensions=[],this.setCurrentIndex(0),this.scrollView.__$callback=this.scrollView.__callback,this.scrollView.__callback=angular.bind(this,this.renderScroll),this.isVertical?(this.scrollView.options.getContentHeight=t,this.scrollValue=function(){return this.scrollView.__scrollTop},this.scrollMaxValue=function(){return this.scrollView.__maxScrollTop},this.scrollSize=function(){return this.scrollView.__clientHeight},this.secondaryScrollSize=function(){return this.scrollView.__clientWidth},this.transformString=function(e,t){return"translate3d("+t+"px,"+e+"px,0)"},this.primaryDimension=function(e){return e.height},this.secondaryDimension=function(e){return e.width}):(this.scrollView.options.getContentWidth=t,this.scrollValue=function(){return this.scrollView.__scrollLeft},this.scrollMaxValue=function(){return this.scrollView.__maxScrollLeft},this.scrollSize=function(){return this.scrollView.__clientWidth},this.secondaryScrollSize=function(){return this.scrollView.__clientHeight},this.transformString=function(e,t){return"translate3d("+e+"px,"+t+"px,0)"},this.primaryDimension=function(e){return e.width},this.secondaryDimension=function(e){return e.height})}return e.prototype={destroy:function(){this.renderedItems={},this.render=angular.noop,this.calculateDimensions=angular.noop,this.dimensions=[]},calculateDimensions:function(){function e(e){var r={primarySize:this.primaryDimension(e),secondarySize:Math.min(this.secondaryDimension(e),o)};return t&&(i+=t.secondarySize,t.primaryPos===n&&i+r.secondarySize>o&&(i=0,n+=t.primarySize)),r.primaryPos=n,r.secondaryPos=i,t=r,r}var t,n=0,i=0,o=this.secondaryScrollSize();this.dataSource.beforeSiblings&&this.dataSource.beforeSiblings.forEach(e,this);var r=n+(t?t.primarySize:0);n=i=0,t=null;var a=this.dataSource.dimensions.map(e,this),s=n+(t?t.primarySize:0);return{beforeSize:r,totalSize:s,dimensions:a}},resize:function(){var e=this.calculateDimensions();this.dimensions=e.dimensions,this.viewportSize=e.totalSize,this.beforeSize=e.beforeSize,this.setCurrentIndex(0),this.render(!0),this.dataSource.setup()},setCurrentIndex:function(e){var t=(this.dimensions[e]||{}).primaryPos||0;this.currentIndex=e,this.hasPrevIndex=e>0,this.hasPrevIndex&&(this.previousPos=Math.max(t-this.dimensions[e-1].primarySize,this.dimensions[e-1].primaryPos)),this.hasNextIndex=e+1<this.dataSource.getLength(),this.hasNextIndex&&(this.nextPos=Math.min(t+this.dimensions[e+1].primarySize,this.dimensions[e+1].primaryPos))},renderScroll:ionic.animationFrameThrottle(function(e,t,n,i){return this.renderIfNeeded(this.isVertical?t:e),this.scrollView.__$callback(e,t,n,i)}),renderIfNeeded:function(e){(this.hasNextIndex&&e>=this.nextPos||this.hasPrevIndex&&e<this.previousPos)&&this.render()},getIndexForScrollValue:function(e,t){var n;if(t<=this.dimensions[e].primaryPos)for(;(n=this.dimensions[e-1])&&n.primaryPos>t;)e--;else for(;(n=this.dimensions[e+1])&&n.primaryPos<t;)e++;return e},render:function(e){function t(e,t){e<i.dataSource.dataStartIndex||i.renderItem(e,t.primaryPos-i.beforeSize,t.secondaryPos)}var n,i=this,o=this.currentIndex>=this.dataSource.getLength();if(o||e){for(n in this.renderedItems)this.removeItem(n);if(o)return}for(var r,a=this.scrollValue(),s=this.scrollSize(),c=s+a,l=this.getIndexForScrollValue(this.currentIndex,a),u=Math.max(l-1,0);u>0&&(r=this.dimensions[u])&&r.primaryPos===this.dimensions[l-1].primaryPos;)u--;for(n=u;(r=this.dimensions[n])&&r.primaryPos-r.primarySize<c;)t(n,r),n++;i.dimensions[n]&&(t(n,i.dimensions[n]),n++),i.dimensions[n]&&t(n,i.dimensions[n]);var d=n;for(var f in this.renderedItems)(u>f||f>d)&&this.removeItem(f);this.setCurrentIndex(l)},renderItem:function(e,t,n){var i=this.dataSource.attachItemAtIndex(e);i&&i.element?((i.primaryPos!==t||i.secondaryPos!==n)&&(i.element.css(ionic.CSS.TRANSFORM,this.transformString(t,n)),i.primaryPos=t,i.secondaryPos=n),this.renderedItems[e]=i):delete this.renderedItems[e]},removeItem:function(e){var t=this.renderedItems[e];t&&(t.primaryPos=t.secondaryPos=null,this.dataSource.detachItem(t),delete this.renderedItems[e])}},e}]),u.factory("$ionicGesture",[function(){return{on:function(e,t,n,i){return window.ionic.onGesture(e,t,n[0],i)},off:function(e,t,n){return window.ionic.offGesture(e,t,n)}}}]),u.provider("$ionicConfig",function(){var e={prefetchTemplates:!0};this.prefetchTemplates=function(t){return arguments.length&&(e.prefetchTemplates=t),e.prefetchTemplates},this.$get=function(){return e}});var g='<div class="loading-container"><div class="loading"></div></div>',m="$ionicLoading instance.hide() has been deprecated. Use $ionicLoading.hide().",$="$ionicLoading instance.show() has been deprecated. Use $ionicLoading.show().",w="$ionicLoading instance.setContent() has been deprecated. Use $ionicLoading.show({ template: 'my content' }).";u.constant("$ionicLoadingConfig",{template:'<i class="icon ion-loading-d"></i>'}).factory("$ionicLoading",["$ionicLoadingConfig","$ionicBody","$ionicTemplateLoader","$ionicBackdrop","$timeout","$q","$log","$compile","$ionicPlatform",function(e,t,n,i,o,r,a,s,c){function u(){return p||(p=n.compile({template:g,appendTo:t.get()}).then(function(e){var a=e;return e.show=function(e){var c=e.templateUrl?n.load(e.templateUrl):r.when(e.template||e.content||"");this.isShown||(this.hasBackdrop=!e.noBackdrop&&e.showBackdrop!==!1,this.hasBackdrop&&(i.retain(),i.getElement().addClass("backdrop-loading"))),e.duration&&(o.cancel(this.durationTimeout),this.durationTimeout=o(angular.bind(this,this.hide),+e.duration)),c.then(function(e){if(e){var n=a.element.children();n.html(e),s(n.contents())(a.scope)}a.isShown&&(a.element.addClass("visible"),ionic.requestAnimationFrame(function(){a.isShown&&(a.element.addClass("active"),t.addClass("loading-active"))}))}),this.isShown=!0},e.hide=function(){this.isShown&&(this.hasBackdrop&&(i.release(),i.getElement().removeClass("backdrop-loading")),a.element.removeClass("active"),t.removeClass("loading-active"),setTimeout(function(){!a.isShown&&a.element.removeClass("visible")},200)),o.cancel(this.durationTimeout),this.isShown=!1},e})),p}function f(t){t=d(e||{},t||{});var n=t.delay||t.showDelay||0;return b&&o.cancel(b),b=o(angular.noop,n),b.then(u).then(function(e){return v(),v=c.registerBackButtonAction(angular.noop,T),e.show(t)}),{hide:l.method(m,a.error,h),show:l.method($,a.error,function(){f(t)}),setContent:l.method(w,a.error,function(e){u().then(function(t){t.show({template:e})})})}}function h(){v(),o.cancel(b),u().then(function(e){e.hide()})}var p,v=angular.noop,b=r.when();return{show:f,hide:h,_getLoader:u}}]),u.factory("$ionicModal",["$rootScope","$ionicBody","$compile","$timeout","$ionicPlatform","$ionicTemplateLoader","$q","$log",function(e,t,n,i,o,r,a,s){var c=ionic.views.Modal.inherit({initialize:function(e){ionic.views.Modal.prototype.initialize.call(this,e),this.animation=e.animation||"slide-in-up"},show:function(e){var n=this;if(n.scope.$$destroyed)return void s.error("Cannot call "+n.viewType+".show() after remove(). Please create a new "+n.viewType+" instance.");var r=v(n.modalEl);return n.el.classList.remove("hide"),i(function(){t.addClass(n.viewType+"-open")},400),n.el.parentElement||(r.addClass(n.animation),t.append(n.el)),e&&n.positionView&&n.positionView(e,r),r.addClass("ng-enter active").removeClass("ng-leave ng-leave-active"),n._isShown=!0,n._deregisterBackButton=o.registerBackButtonAction(n.hardwareBackButtonClose?angular.bind(n,n.hide):angular.noop,S),n._isOpenPromise=a.defer(),ionic.views.Modal.prototype.show.call(n),i(function(){r.addClass("ng-enter-active"),ionic.trigger("resize"),n.scope.$parent&&n.scope.$parent.$broadcast(n.viewType+".shown",n),n.el.classList.add("active")},20),i(function(){n.$el.on("click",function(e){n.backdropClickToClose&&e.target===n.el&&n.hide()})},400)},hide:function(){var e=this,n=v(e.modalEl);return e.el.classList.remove("active"),n.addClass("ng-leave"),i(function(){n.addClass("ng-leave-active").removeClass("ng-enter ng-enter-active active")},20),e.$el.off("click"),e._isShown=!1,e.scope.$parent&&e.scope.$parent.$broadcast(e.viewType+".hidden",e),e._deregisterBackButton&&e._deregisterBackButton(),ionic.views.Modal.prototype.hide.call(e),i(function(){t.removeClass(e.viewType+"-open"),e.el.classList.add("hide")},e.hideDelay||320)},remove:function(){var e=this;return e.scope.$parent&&e.scope.$parent.$broadcast(e.viewType+".removed",e),e.hide().then(function(){e.scope.$destroy(),e.$el.remove()})},isShown:function(){return!!this._isShown}}),l=function(t,i){var o=i.scope&&i.scope.$new()||e.$new(!0);i.viewType=i.viewType||"modal",d(o,{$hasHeader:!1,$hasSubheader:!1,$hasFooter:!1,$hasSubfooter:!1,$hasTabs:!1,$hasTabsTop:!1});var r=n("<ion-"+i.viewType+">"+t+"</ion-"+i.viewType+">")(o);i.$el=r,i.el=r[0],i.modalEl=i.el.querySelector("."+i.viewType);var a=new c(i);return a.scope=o,i.scope||(o[i.viewType]=a),a};return{fromTemplate:function(e,t){var n=l(e,t||{});return n},fromTemplateUrl:function(e,t,n){var i;return angular.isFunction(t)&&(i=t,t=n),r.load(e).then(function(e){var n=l(e,t||{});return i&&i(n),n})}}}]),u.service("$ionicNavBarDelegate",n(["back","align","showBackButton","showBar","setTitle","changeTitle","getTitle","getPreviousTitle"]));var b=100,y=150,S=200,C=300,k=400,T=500;u.constant("$ionicPlatformDefaults",{ios:{$ionicNavBarConfig:{transition:"nav-title-slide-ios",alignTitle:"center",backButtonIcon:"ion-ios7-arrow-back"},$ionicNavViewConfig:{transition:"slide-ios"},$ionicTabsConfig:{type:"",position:""}},android:{$ionicNavBarConfig:{transition:"nav-title-slide-full",alignTitle:"center",backButtonIcon:"ion-ios7-arrow-back"},$ionicNavViewConfig:{transition:"slide-full"},$ionicTabsConfig:{type:"tabs-striped",position:""}}}),u.config(["$ionicPlatformDefaults","$injector",function(e,t){var n=ionic.Platform.platform(),i=function(e){f(e,function(e,n){d(t.get(n),e)})};switch(n){case"ios":i(e.ios);break;case"android":i(e.android)}}]),u.provider("$ionicPlatform",function(){return{$get:["$q","$rootScope",function(e){var t={onHardwareBackButton:function(e){ionic.Platform.ready(function(){document.addEventListener("backbutton",e,!1)})},offHardwareBackButton:function(e){ionic.Platform.ready(function(){document.removeEventListener("backbutton",e)})},$backButtonActions:{},registerBackButtonAction:function(e,n,i){t._hasBackButtonHandler||(t.$backButtonActions={},t.onHardwareBackButton(t.hardwareBackButtonClick),t._hasBackButtonHandler=!0);var o={id:i?i:ionic.Utils.nextUid(),priority:n?n:0,fn:e};return t.$backButtonActions[o.id]=o,function(){delete t.$backButtonActions[o.id]}},hardwareBackButtonClick:function(e){var n,i;for(i in t.$backButtonActions)(!n||t.$backButtonActions[i].priority>=n.priority)&&(n=t.$backButtonActions[i]);return n?(n.fn(e),n):void 0},is:function(e){return ionic.Platform.is(e)},on:function(e,t){return ionic.Platform.ready(function(){document.addEventListener(e,t,!1)}),function(){ionic.Platform.ready(function(){document.removeEventListener(e,t)})}},ready:function(t){var n=e.defer();return ionic.Platform.ready(function(){n.resolve(),t&&t()}),n.promise}};return t}]}}),u.factory("$ionicPopover",["$ionicModal","$ionicPosition","$document","$window",function(e,t,n,i){function o(e,o){var a=angular.element(e.target||e),s=t.offset(a),c=o.prop("offsetWidth"),l=o.prop("offsetHeight"),u=n[0].body.clientWidth,d=i.innerHeight,f={left:s.left+s.width/2-c/2},h=v(o[0].querySelector(".popover-arrow"));f.left<r?f.left=r:f.left+c+r>u&&(f.left=u-c-r),s.top+s.height+l>d?(f.top=s.top-l,o.addClass("popover-bottom")):(f.top=s.top+s.height,o.removeClass("popover-bottom")),h.css({left:s.left+s.width/2-h.prop("offsetWidth")/2-f.left+"px"}),o.css({top:f.top+"px",left:f.left+"px",marginLeft:"0",opacity:"1"})}var r=6,a={viewType:"popover",hideDelay:1,animation:"none",positionView:o};return{fromTemplate:function(t,n){return e.fromTemplate(t,ionic.Utils.extend(n||{},a))},fromTemplateUrl:function(t,n){return e.fromTemplateUrl(t,n,ionic.Utils.extend(n||{},a))}}}]);var I='<div class="popup-container"><div class="popup"><div class="popup-head"><h3 class="popup-title" ng-bind-html="title"></h3><h5 class="popup-sub-title" ng-bind-html="subTitle" ng-if="subTitle"></h5></div><div class="popup-body"></div><div class="popup-buttons"><button ng-repeat="button in buttons" ng-click="$buttonTapped(button, $event)" class="button" ng-class="button.type || \'button-default\'" ng-bind-html="button.text"></button></div></div></div>';u.factory("$ionicPopup",["$ionicTemplateLoader","$ionicBackdrop","$q","$timeout","$rootScope","$ionicBody","$compile","$ionicPlatform",function(e,t,n,i,o,r,a,s){function c(t){t=d({scope:null,title:"",buttons:[]},t||{});var o=e.compile({template:I,scope:t.scope&&t.scope.$new(),appendTo:r.get()}),s=t.templateUrl?e.load(t.templateUrl):n.when(t.template||t.content||"");return n.all([o,s]).then(function(e){var o=e[0],r=e[1],s=n.defer();o.responseDeferred=s;var c=v(o.element[0].querySelector(".popup-body"));return r?(c.html(r),a(c.contents())(o.scope)):c.remove(),d(o.scope,{title:t.title,buttons:t.buttons,subTitle:t.subTitle,$buttonTapped:function(e,t){var n=(e.onTap||angular.noop)(t);t=t.originalEvent||t,t.defaultPrevented||s.resolve(n)}}),o.show=function(){o.isShown||(o.isShown=!0,ionic.requestAnimationFrame(function(){o.isShown&&(o.element.removeClass("popup-hidden"),o.element.addClass("popup-showing active"),f(o.element))}))},o.hide=function(e){return e=e||angular.noop,o.isShown?(o.isShown=!1,o.element.removeClass("active"),o.element.addClass("popup-hidden"),void i(e,250)):e()},o.remove=function(){o.removed||(o.hide(function(){o.element.remove(),o.scope.$destroy()}),o.removed=!0)},o})}function l(){$[0]&&$[0].responseDeferred.resolve()}function u(e){function n(e){o.then(function(t){t.removed||t.responseDeferred.resolve(e)})}var o=w._createPopup(e),a=$[0];a&&a.hide();var c=i(angular.noop,a?m.stackPushDelay:0).then(function(){return o}).then(function(e){return a||(r.addClass("popup-open"),t.retain(),w._backButtonActionDone=s.registerBackButtonAction(l,k)),$.unshift(e),e.show(),e.responseDeferred.notify({close:c.close}),e.responseDeferred.promise.then(function(n){var o=$.indexOf(e);-1!==o&&$.splice(o,1),e.remove();var a=$[0];return a?a.show():(i(function(){r.removeClass("popup-open")},400),t.release(),(w._backButtonActionDone||angular.noop)()),n})});return c.close=n,c}function f(e){var t=e[0].querySelector("[autofocus]");t&&t.focus()}function h(e){return u(d({buttons:[{text:e.okText||"OK",type:e.okType||"button-positive",onTap:function(){return!0}}]},e||{}))}function p(e){return u(d({buttons:[{text:e.cancelText||"Cancel",type:e.cancelType||"button-default",onTap:function(){return!1}},{text:e.okText||"OK",type:e.okType||"button-positive",onTap:function(){return!0}}]},e||{}))}function g(e){var t=o.$new(!0);t.data={};var n="";return e.template&&/<[a-z][\s\S]*>/i.test(e.template)===!1&&(n="<span>"+e.template+"</span>",delete e.template),u(d({template:n+'<input ng-model="data.response" type="'+(e.inputType||"text")+'" placeholder="'+(e.inputPlaceholder||"")+'">',scope:t,buttons:[{text:e.cancelText||"Cancel",type:e.cancelType||"button-default",onTap:function(){}},{text:e.okText||"OK",type:e.okType||"button-positive",onTap:function(){return t.data.response||""}}]},e||{}))}var m={stackPushDelay:75},$=[],w={show:u,alert:h,confirm:p,prompt:g,_createPopup:c,_popupStack:$};return w}]),u.factory("$ionicPosition",["$document","$window",function(e,t){function n(e,n){return e.currentStyle?e.currentStyle[n]:t.getComputedStyle?t.getComputedStyle(e)[n]:e.style[n]}function i(e){return"static"===(n(e,"position")||"static")}var o=function(t){for(var n=e[0],o=t.offsetParent||n;o&&o!==n&&i(o);)o=o.offsetParent;return o||n};return{position:function(t){var n=this.offset(t),i={top:0,left:0},r=o(t[0]);r!=e[0]&&(i=this.offset(angular.element(r)),i.top+=r.clientTop-r.scrollTop,i.left+=r.clientLeft-r.scrollLeft);var a=t[0].getBoundingClientRect();return{width:a.width||t.prop("offsetWidth"),height:a.height||t.prop("offsetHeight"),top:n.top-i.top,left:n.left-i.left}},offset:function(n){var i=n[0].getBoundingClientRect();return{width:i.width||n.prop("offsetWidth"),height:i.height||n.prop("offsetHeight"),top:i.top+(t.pageYOffset||e[0].documentElement.scrollTop),left:i.left+(t.pageXOffset||e[0].documentElement.scrollLeft)}}}}]),u.service("$ionicScrollDelegate",n(["resize","scrollTop","scrollBottom","scrollTo","scrollBy","zoomTo","zoomBy","getScrollPosition","anchorScroll","getScrollView","rememberScrollPosition","forgetScrollPosition","scrollToRememberedPosition"])),u.service("$ionicSideMenuDelegate",n(["toggleLeft","toggleRight","getOpenRatio","isOpen","isOpenLeft","isOpenRight","canDragContent","edgeDragThreshold"])),u.service("$ionicSlideBoxDelegate",n(["update","slide","enableSlide","previous","next","stop","start","currentIndex","slidesCount"])),u.service("$ionicTabsDelegate",n(["select","selectedIndex"])),function(){var e=[];u.factory("$ionicTemplateCache",["$http","$templateCache","$timeout","$ionicConfig",function(t,n,i,o){function r(e){return a.length>500?!1:"undefined"==typeof e?c():(p(e)&&(e=[e]),f(e,function(e){a.push(e)}),void(s&&c()))}var a=e,s=!1,c=function(){if(o.prefetchTemplates!==!1&&(r._runCount++,s=!0,0!==a.length)){for(var e=0;5>e&&(template=a.pop());)p(template)&&t.get(template,{cache:n}),e++;a.length&&i(function(){c()},1e3)}};return r._runCount=0,r}]).config(["$stateProvider","$ionicConfigProvider",function(t,n){var i=t.state;t.state=function(o,r){if("object"==typeof r&&n.prefetchTemplates()!==!1){var a=r.prefetchTemplate!==!1;if(a&&p(r.templateUrl)&&e.push(r.templateUrl),angular.isObject(r.views))for(var s in r.views)a=r.views[s].prefetchTemplate!==!1,a&&p(r.views[s].templateUrl)&&e.push(r.views[s].templateUrl)}return i.call(t,o,r)}}]).run(["$ionicTemplateCache",function(e){e()}])}(),u.factory("$ionicTemplateLoader",["$compile","$controller","$http","$q","$rootScope","$templateCache",function(e,t,n,i,o,r){function a(e){return n.get(e,{cache:r}).then(function(e){return e.data&&e.data.trim()})}function s(n){n=d({template:"",templateUrl:"",scope:null,controller:null,locals:{},appendTo:null},n||{});var r=n.templateUrl?this.load(n.templateUrl):i.when(n.template);return r.then(function(i){var r,a=n.scope||o.$new(),s=v("<div>").html(i).contents();return n.controller&&(r=t(n.controller,d(n.locals,{$scope:a})),s.children().data("$ngControllerController",r)),n.appendTo&&v(n.appendTo).append(s),e(s)(a),{element:s,scope:a}})}return{load:a,compile:s}}]),u.run(["$rootScope","$state","$location","$document","$animate","$ionicPlatform","$ionicViewService",function(e,t,n,i,o,r,a){function s(t){return e.$viewHistory.backView?e.$viewHistory.backView.go():ionic.Platform.exitApp(),t.preventDefault(),!1}e.$viewHistory={histories:{root:{historyId:"root",parentHistoryId:null,stack:[],cursor:-1}},views:{},backView:null,forwardView:null,currentView:null,disabledRegistrableTagNames:[]},a.disableRegisterByTagName&&(a.disableRegisterByTagName("ion-tabs"),a.disableRegisterByTagName("ion-side-menus")),e.$on("$stateChangeStart",function(){ionic.keyboard.hide()}),e.$on("viewState.changeHistory",function(i,o){if(o){var r=o.historyId?e.$viewHistory.histories[o.historyId]:null;if(r&&r.cursor>-1&&r.cursor<r.stack.length){var a=r.stack[r.cursor];return a.go(o)}!o.url&&o.uiSref&&(o.url=t.href(o.uiSref)),o.url&&(0===o.url.indexOf("#")&&(o.url=o.url.replace("#","")),o.url!==n.url()&&n.url(o.url))}}),e.$on("viewState.viewEnter",function(e,t){t&&t.title&&(i[0].title=t.title)}),r.registerBackButtonAction(s,b)}]).factory("$ionicViewService",["$rootScope","$state","$location","$window","$injector","$animate","$ionicNavViewConfig","$ionicClickBlock",function(e,t,n,i,o,r,a,s){function c(){return ionic.Utils.nextUid()}var l=function(){};return l.prototype.initialize=function(e){if(e){for(var t in e)this[t]=e[t];return this}return null},l.prototype.go=function(){return this.stateName?t.go(this.stateName,this.stateParams):this.url&&this.url!==n.url()?e.$viewHistory.backView===this?i.history.go(-1):e.$viewHistory.forwardView===this?i.history.go(1):void n.url(this.url):null},l.prototype.destroy=function(){this.scope&&(this.scope.$destroy&&this.scope.$destroy(),this.scope=null)},{register:function(t,i){var o=e.$viewHistory,r=this.getCurrentStateId(),a=this._getHistory(t),s=o.currentView,l=o.backView,u=o.forwardView,d=this.nextViewOptions(),f={viewId:null,navAction:null,navDirection:null,historyId:a.historyId};if(i&&!this.isTagNameRegistrable(i))return f.navAction="disabledByTagName",f;if(s&&s.stateId===r&&s.historyId===a.historyId)return f.navAction="noChange",f;if(o.forcedNav)ionic.Utils.extend(f,o.forcedNav),e.$viewHistory.forcedNav=null;else if(l&&l.stateId===r)f.viewId=l.viewId,f.navAction="moveBack",f.viewId=l.viewId,l.historyId===s.historyId&&(f.navDirection="back");else if(u&&u.stateId===r){f.viewId=u.viewId,f.navAction="moveForward",u.historyId===s.historyId&&(f.navDirection="forward");var h=this._getParentHistoryObj(t);u.historyId&&h.scope&&(h.scope.$historyId=u.historyId,f.historyId=u.historyId)}else if(s&&s.historyId!==a.historyId&&a.cursor>-1&&a.stack.length>0&&a.cursor<a.stack.length&&a.stack[a.cursor].stateId===r){var p=a.stack[a.cursor];f.viewId=p.viewId,f.navAction="moveBack";var v=this._getViewById(p.backViewId);
v&&p.historyId!==v.historyId&&(a.stack[a.cursor].backViewId=s.viewId)}else{if(f.viewId=c(r),s){if(s.forwardViewId=f.viewId,a.historyId===s.historyId&&(f.navDirection="forward"),f.navAction="newView",u&&s.stateId!==u.stateId&&s.historyId===u.historyId){var g=this._getHistoryById(u.historyId);if(g)for(var m=g.stack.length-1;m>=u.index;m--)g.stack[m].destroy(),g.stack.splice(m)}}else f.navAction="initialView";o.views[f.viewId]=this.createView({viewId:f.viewId,index:a.stack.length,historyId:a.historyId,backViewId:s&&s.viewId?s.viewId:null,forwardViewId:null,stateId:r,stateName:this.getCurrentStateName(),stateParams:this.getCurrentStateParams(),url:n.url()}),"moveBack"==f.navAction&&e.$emit("$viewHistory.viewBack",s.viewId,f.viewId),a.stack.push(o.views[f.viewId])}return d&&(d.disableAnimate&&(f.navDirection=null),d.disableBack&&(o.views[f.viewId].backViewId=null),this.nextViewOptions(null)),this.setNavViews(f.viewId),a.cursor=o.currentView.index,f},setNavViews:function(t){var n=e.$viewHistory;n.currentView=this._getViewById(t),n.backView=this._getBackView(n.currentView),n.forwardView=this._getForwardView(n.currentView),e.$broadcast("$viewHistory.historyChange",{showBack:n.backView&&n.backView.historyId===n.currentView.historyId})},registerHistory:function(e){e.$historyId=ionic.Utils.nextUid()},createView:function(e){var t=new l;return t.initialize(e)},getCurrentView:function(){return e.$viewHistory.currentView},getBackView:function(){return e.$viewHistory.backView},getForwardView:function(){return e.$viewHistory.forwardView},getNavDirection:function(){return e.$viewHistory.navDirection},getCurrentStateName:function(){return t&&t.current?t.current.name:null},isCurrentStateNavView:function(e){return t&&t.current&&t.current.views&&t.current.views[e]?!0:!1},getCurrentStateParams:function(){var e;if(t&&t.params)for(var n in t.params)t.params.hasOwnProperty(n)&&(e=e||{},e[n]=t.params[n]);return e},getCurrentStateId:function(){var e;if(t&&t.current&&t.current.name){if(e=t.current.name,t.params)for(var n in t.params)t.params.hasOwnProperty(n)&&t.params[n]&&(e+="_"+n+"="+t.params[n]);return e}return ionic.Utils.nextUid()},goToHistoryRoot:function(t){if(t){var n=e.$viewHistory.histories[t];if(n&&n.stack.length){if(e.$viewHistory.currentView&&e.$viewHistory.currentView.viewId===n.stack[0].viewId)return;e.$viewHistory.forcedNav={viewId:n.stack[0].viewId,navAction:"moveBack",navDirection:"back"},n.stack[0].go()}}},_getViewById:function(t){return t?e.$viewHistory.views[t]:null},_getBackView:function(e){return e?this._getViewById(e.backViewId):null},_getForwardView:function(e){return e?this._getViewById(e.forwardViewId):null},_getHistoryById:function(t){return t?e.$viewHistory.histories[t]:null},_getHistory:function(t){var n=this._getParentHistoryObj(t);return e.$viewHistory.histories[n.historyId]||(e.$viewHistory.histories[n.historyId]={historyId:n.historyId,parentHistoryId:this._getParentHistoryObj(n.scope.$parent).historyId,stack:[],cursor:-1}),e.$viewHistory.histories[n.historyId]},_getParentHistoryObj:function(t){for(var n=t;n;){if(n.hasOwnProperty("$historyId"))return{historyId:n.$historyId,scope:n};n=n.$parent}return{historyId:"root",scope:e}},nextViewOptions:function(e){return arguments.length?void(this._nextOpts=e):this._nextOpts},getRenderer:function(e,t,n){function i(e){for(var t="";!t&&e;)t=e.getAttribute("animation"),e=e.parentElement;return t?t:a.transition}function o(){d&&e[0].classList.add(d),"back"===c.navDirection?e[0].classList.add("reverse"):e[0].classList.remove("reverse")}var c,l,u=this,d=i(e[0]);return function(t){return{enter:function(n){return l&&t?(o(),n.addClass("ng-enter"),s.show(),void r.enter(n,e,null,function(){s.hide(),d&&e[0].classList.remove(d)})):(l||s.hide(),void e.append(n))},leave:function(){var n=e.contents();return l&&t?(o(),void r.leave(n,function(){n.remove()})):void n.remove()},register:function(e){return c=u.register(n,e),l=null!==d&&null!==c.navDirection,c}}}},disableRegisterByTagName:function(t){e.$viewHistory.disabledRegistrableTagNames.push(t.toUpperCase())},isTagNameRegistrable:function(t){var n,i,o=e.$viewHistory.disabledRegistrableTagNames;for(n=0;n<t.length;n++)if(1===t[n].nodeType)for(i=0;i<o.length;i++)if(t[n].tagName===o[i])return!1;return!0},clearHistory:function(){var t=e.$viewHistory.histories,n=e.$viewHistory.currentView;if(t)for(var i in t)t[i].stack&&(t[i].stack=[],t[i].cursor=-1),n&&n.historyId===i?(n.backViewId=null,n.forwardViewId=null,t[i].stack.push(n)):t[i].destroy&&t[i].destroy();for(var o in e.$viewHistory.views)o!==n.viewId&&delete e.$viewHistory.views[o];n&&this.setNavViews(n.viewId)}}}]),u.config(["$provide",function(e){function t(e,t){return e.__hash=e.hash,e.hash=function(n){return angular.isDefined(n)&&t(function(){var e=document.querySelector(".scroll-content");e&&(e.scrollTop=0)},0,!1),e.__hash(n)},e}e.decorator("$location",["$delegate","$timeout",t])}]),u.service("$ionicListDelegate",n(["showReorder","showDelete","canSwipeItems","closeOptionButtons"])).controller("$ionicList",["$scope","$attrs","$parse","$ionicListDelegate",function(e,t,n,i){var o=!0,r=!1,a=!1,s=i._registerInstance(this,t.delegateHandle);e.$on("$destroy",s),this.showReorder=function(e){return arguments.length&&(r=!!e),r},this.showDelete=function(e){return arguments.length&&(a=!!e),a},this.canSwipeItems=function(e){return arguments.length&&(o=!!e),o},this.closeOptionButtons=function(){this.listView&&this.listView.clearDragEffects()}}]),u.controller("$ionicNavBar",["$scope","$element","$attrs","$ionicViewService","$animate","$compile","$ionicNavBarDelegate",function(e,t,n,i,o,r,a){t.parent().data("$ionNavBarController",this);var s=a._registerInstance(this,n.delegateHandle);e.$on("$destroy",s),e.$on("$viewHistory.historyChange",function(e,t){backIsShown=!!t.showBack});var c=this;this.leftButtonsElement=v(t[0].querySelector(".buttons.left-buttons")),this.rightButtonsElement=v(t[0].querySelector(".buttons.right-buttons")),this.back=function(){var e=i.getBackView();return e&&e.go(),!1},this.align=function(e){this._headerBarView.align(e)},this.showBackButton=function(t){return arguments.length&&(e.backButtonShown=!!t),!(!e.hasBackButton||!e.backButtonShown)},this.showBar=function(t){return arguments.length&&(e.isInvisible=!t,e.$parent.$hasHeader=!!t),!e.isInvisible},this.setTitle=function(t){e.title!==t&&(e.oldTitle=e.title,e.title=t||"")},this.changeTitle=function(n,i){return e.title===n?("undefined"!=typeof backIsShown&&!backIsShown&&e.backButtonShown&&v(t[0].querySelector(".back-button")).addClass("ng-hide"),!1):(this.setTitle(n),e.isReverse="back"==i,e.shouldAnimate=!!i,e.shouldAnimate?this._animateTitles():this._headerBarView.align(),!0)},this.getTitle=function(){return e.title||""},this.getPreviousTitle=function(){return e.oldTitle||""},this._animateTitles=function(){var n,i,a;a=t[0].querySelectorAll(".title"),a.length&&(n=r('<h1 class="title" ng-bind-html="oldTitle"></h1>')(e),v(a[a.length-1]).replaceWith(n)),i=r('<h1 class="title invisible" ng-bind-html="title"></h1>')(e),ionic.requestAnimationFrame(function(){n&&o.leave(v(n));var r=n&&v(n)||null;o.enter(i,t,r,function(){c._headerBarView.align()}),f(a,function(e){e&&e.parentNode&&v(e).remove()}),e.$digest(),ionic.requestAnimationFrame(function(){i[0].classList.remove("invisible")})})}}]),u.factory("$$scrollValueCache",function(){return{}}).controller("$ionicScroll",["$scope","scrollViewOptions","$timeout","$window","$$scrollValueCache","$location","$rootScope","$document","$ionicScrollDelegate",function(e,t,n,i,o,r,a,s,c){var l=this;this.__timeout=n,this._scrollViewOptions=t;var u=this.element=t.el,d=this.$element=v(u),f=this.scrollView=new ionic.views.Scroll(t);(d.parent().length?d.parent():d).data("$$ionicScrollController",this);var h=c._registerInstance(this,t.delegateHandle);angular.isDefined(t.bouncing)||ionic.Platform.ready(function(){f.options.bouncing=!0,ionic.Platform.isAndroid()&&(f.options.bouncing=!1,f.options.deceleration=.95)});var p=angular.bind(f,f.resize);ionic.on("resize",p,i);var g=angular.noop,m=angular.noop,$=function(t){var n=(t.originalEvent||t).detail||{};e.$onScroll&&e.$onScroll({event:t,scrollTop:n.scrollTop||0,scrollLeft:n.scrollLeft||0})};d.on("scroll",$),e.$on("$destroy",function(){h(),f.__cleanup(),ionic.off("resize",p,i),i.removeEventListener("resize",p),m(),g(),l._rememberScrollId&&(o[l._rememberScrollId]=f.getValues()),t=null,l._scrollViewOptions=null,l.element=null,d.off("scroll",$),d=null,l.$element=null,l.scrollView=null,f=null}),m=e.$on("$viewContentLoaded",function(t,i){if(!t.defaultPrevented){t.preventDefault();var o=i&&i.viewId||e.$historyId;o&&n(function(){l.rememberScrollPosition(o),l.scrollToRememberedPosition(),g=a.$on("$viewHistory.viewBack",function(e,t){o===t&&l.forgetScrollPosition()})},0,!1)}}),n(function(){f&&f.run&&f.run()}),this._rememberScrollId=null,this.getScrollView=function(){return this.scrollView},this.getScrollPosition=function(){return this.scrollView.getValues()},this.resize=function(){return n(p).then(function(){d&&d.triggerHandler("scroll.resize")})},this.scrollTop=function(e){this.resize().then(function(){f.scrollTo(0,0,!!e)})},this.scrollBottom=function(e){this.resize().then(function(){var t=f.getScrollMax();f.scrollTo(t.left,t.top,!!e)})},this.scrollTo=function(e,t,n){this.resize().then(function(){f.scrollTo(e,t,!!n)})},this.zoomTo=function(e,t,n,i){this.resize().then(function(){f.zoomTo(e,!!t,n,i)})},this.zoomBy=function(e,t,n,i){this.resize().then(function(){f.zoomBy(e,!!t,n,i)})},this.scrollBy=function(e,t,n){this.resize().then(function(){f.scrollBy(e,t,!!n)})},this.anchorScroll=function(e){this.resize().then(function(){var t=r.hash(),n=t&&s[0].getElementById(t);if(!t||!n)return void f.scrollTo(0,0,!!e);var i=n,o=0,a=0,c=0;do null!==i&&(o+=i.offsetLeft),null!==i&&(a+=i.offsetTop),i=i.offsetParent,c++;while(i.attributes!=l.element.attributes&&i.offsetParent);f.scrollTo(o,a,!!e)})},this.rememberScrollPosition=function(e){if(!e)throw new Error("Must supply an id to remember the scroll by!");this._rememberScrollId=e},this.forgetScrollPosition=function(){delete o[this._rememberScrollId],this._rememberScrollId=null},this.scrollToRememberedPosition=function(e){var t=o[this._rememberScrollId];t&&this.resize().then(function(){f&&f.scrollTo&&f.scrollTo(+t.left,+t.top,e)})},this._setRefresher=function(e,t){var i=this.refresher=t,o=l.refresher.clientHeight||60;f.activatePullToRefresh(o,function(){i.classList.add("active"),e.$onPulling()},function(){n(function(){i.classList.remove("active"),i.classList.remove("refreshing"),i.classList.remove("refreshing-tail"),i.classList.add("invisible")},300)},function(){i.classList.add("refreshing"),e.$onRefresh()},function(){i.classList.remove("invisible")},function(){i.classList.add("invisible")},function(){i.classList.add("refreshing-tail")})}}]),u.controller("$ionicSideMenus",["$scope","$attrs","$ionicSideMenuDelegate","$ionicPlatform","$ionicBody",function(e,t,n,i,o){var r,a,s,c,l,u,d,f=this;f.$scope=e,f.initialize=function(e){f.left=e.left,f.right=e.right,f.setContent(e.content),f.dragThresholdX=e.dragThresholdX||10},f.setContent=function(e){e&&(f.content=e,f.content.onDrag=function(e){f._handleDrag(e)},f.content.endDrag=function(e){f._endDrag(e)})},f.isOpenLeft=function(){return f.getOpenAmount()>0},f.isOpenRight=function(){return f.getOpenAmount()<0},f.toggleLeft=function(e){if(!d&&f.left.isEnabled){var t=f.getOpenAmount();0===arguments.length&&(e=0>=t),f.content.enableAnimation(),f.openPercentage(e?100:0)}},f.toggleRight=function(e){if(!d&&f.right.isEnabled){var t=f.getOpenAmount();0===arguments.length&&(e=t>=0),f.content.enableAnimation(),f.openPercentage(e?-100:0)}},f.close=function(){f.openPercentage(0)},f.getOpenAmount=function(){return f.content&&f.content.getTranslateX()||0},f.getOpenRatio=function(){var e=f.getOpenAmount();return e>=0?e/f.left.width:e/f.right.width},f.isOpen=function(){return 0!==f.getOpenAmount()},f.getOpenPercentage=function(){return 100*f.getOpenRatio()},f.openPercentage=function(e){var t=e/100;if(f.left&&e>=0)f.openAmount(f.left.width*t);else if(f.right&&0>e){{f.right.width}f.openAmount(f.right.width*t)}o.enableClass(0!==e,"menu-open")},f.openAmount=function(e){var t=f.left&&f.left.width||0,n=f.right&&f.right.width||0;return(f.left&&f.left.isEnabled||!(e>0))&&(f.right&&f.right.isEnabled||!(0>e))?a&&e>t?void f.content.setTranslateX(t):r&&-n>e?void f.content.setTranslateX(-n):(f.content.setTranslateX(e),void(e>=0?(a=!0,r=!1,e>0&&(f.right&&f.right.pushDown&&f.right.pushDown(),f.left&&f.left.bringUp&&f.left.bringUp())):(r=!0,a=!1,f.right&&f.right.bringUp&&f.right.bringUp(),f.left&&f.left.pushDown&&f.left.pushDown()))):void f.content.setTranslateX(0)},f.snapToRest=function(e){f.content.enableAnimation(),s=!1;var t=f.getOpenRatio();if(0===t)return void f.openPercentage(0);var n=.3,i=e.gesture.velocityX,o=e.gesture.direction;f.openPercentage(t>0&&.5>t&&"right"==o&&n>i?0:t>.5&&"left"==o&&n>i?100:0>t&&t>-.5&&"left"==o&&n>i?0:.5>t&&"right"==o&&n>i?-100:"right"==o&&t>=0&&(t>=.5||i>n)?100:"left"==o&&0>=t&&(-.5>=t||i>n)?-100:0)},f.isAsideExposed=function(){return!!d},f.exposeAside=function(e){f.left&&f.left.isEnabled&&(f.close(),d=e,f.content.setMarginLeft(d?f.left.width:0),f.$scope.$emit("$ionicExposeAside",d))},f.activeAsideResizing=function(e){o.enableClass(e,"aside-resizing")},f._endDrag=function(e){d||(s&&f.snapToRest(e),c=null,l=null,u=null)},f._handleDrag=function(e){d||(c?l=e.gesture.touches[0].pageX:(c=e.gesture.touches[0].pageX,l=c),!s&&Math.abs(l-c)>f.dragThresholdX&&(c=l,s=!0,f.content.disableAnimation(),u=f.getOpenAmount()),s&&f.openAmount(u+(l-c)))},f.canDragContent=function(t){return arguments.length&&(e.dragContent=!!t),e.dragContent},f.edgeThreshold=25,f.edgeThresholdEnabled=!1,f.edgeDragThreshold=function(e){return arguments.length&&(angular.isNumber(e)&&e>0?(f.edgeThreshold=e,f.edgeThresholdEnabled=!0):f.edgeThresholdEnabled=!!e),f.edgeThresholdEnabled},f.isDraggableTarget=function(t){var n=f.edgeThresholdEnabled&&!f.isOpen(),i=t.gesture.startEvent&&t.gesture.startEvent.center&&t.gesture.startEvent.center.pageX,o=!n||i<=f.edgeThreshold||i>=f.content.element.offsetWidth-f.edgeThreshold;return(e.dragContent||f.isOpen())&&o&&!t.gesture.srcEvent.defaultPrevented&&!t.target.tagName.match(/input|textarea|select|object|embed/i)&&!t.target.isContentEditable&&!(t.target.dataset?t.target.dataset.preventScroll:"true"==t.target.getAttribute("data-prevent-scroll"))},e.sideMenuContentTranslateX=0;var h=angular.noop,p=angular.bind(f,f.close);e.$watch(function(){return 0!==f.getOpenAmount()},function(e){h(),e&&(h=i.registerBackButtonAction(p,y))});var v=n._registerInstance(f,t.delegateHandle);e.$on("$destroy",function(){v(),h()}),f.initialize({left:{width:275},right:{width:275}})}]),u.controller("$ionicTab",["$scope","$ionicViewService","$attrs","$location","$state",function(e,t,n,i,o){this.$scope=e,this.hrefMatchesState=function(){return n.href&&0===i.path().indexOf(n.href.replace(/^#/,"").replace(/\/$/,""))},this.srefMatchesState=function(){return n.uiSref&&o.includes(n.uiSref.split("(")[0])},this.navNameMatchesState=function(){return this.navViewName&&t.isCurrentStateNavView(this.navViewName)},this.tabMatchesState=function(){return this.hrefMatchesState()||this.srefMatchesState()||this.navNameMatchesState()}}]),u.controller("$ionicTabs",["$scope","$ionicViewService","$element",function(e,t){var n=null,i=this;i.tabs=[],i.selectedIndex=function(){return i.tabs.indexOf(n)},i.selectedTab=function(){return n},i.add=function(e){t.registerHistory(e),i.tabs.push(e),1===i.tabs.length&&i.select(e)},i.remove=function(e){var t=i.tabs.indexOf(e);if(-1!==t){if(e.$tabSelected)if(i.deselect(e),1===i.tabs.length);else{var n=t===i.tabs.length-1?t-1:t+1;i.select(i.tabs[n])}i.tabs.splice(t,1)}},i.deselect=function(e){e.$tabSelected&&(n=null,e.$tabSelected=!1,(e.onDeselect||angular.noop)())},i.select=function(o,r){var a;if(angular.isNumber(o)?(a=o,o=i.tabs[a]):a=i.tabs.indexOf(o),1===arguments.length&&(r=!(!o.navViewName&&!o.uiSref)),n&&n.$historyId==o.$historyId)r&&t.goToHistoryRoot(o.$historyId);else if(f(i.tabs,function(e){i.deselect(e)}),n=o,o.$tabSelected=!0,(o.onSelect||angular.noop)(),r){var s={type:"tab",tabIndex:a,historyId:o.$historyId,navViewName:o.navViewName,hasNavView:!!o.navViewName,title:o.title,url:o.href,uiSref:o.uiSref};e.$emit("viewState.changeHistory",s)}}}]),u.directive("ionActionSheet",["$document",function(e){return{restrict:"E",scope:!0,replace:!0,link:function(t,n){var i=function(e){27==e.which&&(t.cancel(),t.$apply())},o=function(e){e.target==n[0]&&(t.cancel(),t.$apply())};t.$on("$destroy",function(){n.remove(),e.unbind("keyup",i)}),e.bind("keyup",i),n.bind("click",o)},template:'<div class="action-sheet-backdrop"><div class="action-sheet-wrapper"><div class="action-sheet"><div class="action-sheet-group"><div class="action-sheet-title" ng-if="titleText" ng-bind-html="titleText"></div><button class="button" ng-click="buttonClicked($index)" ng-repeat="button in buttons" ng-bind-html="button.text"></button></div><div class="action-sheet-group" ng-if="destructiveText"><button class="button destructive" ng-click="destructiveButtonClicked()" ng-bind-html="destructiveText"></button></div><div class="action-sheet-group" ng-if="cancelText"><button class="button" ng-click="cancel()" ng-bind-html="cancelText"></button></div></div></div></div>'}}]),u.directive("ionCheckbox",function(){return{restrict:"E",replace:!0,require:"?ngModel",transclude:!0,template:'<label class="item item-checkbox"><div class="checkbox checkbox-input-hidden disable-pointer-events"><input type="checkbox"><i class="checkbox-icon"></i></div><div class="item-content disable-pointer-events" ng-transclude></div></label>',compile:function(e,t){var n=e.find("input");f({name:t.name,"ng-value":t.ngValue,"ng-model":t.ngModel,"ng-checked":t.ngChecked,"ng-disabled":t.ngDisabled,"ng-true-value":t.ngTrueValue,"ng-false-value":t.ngFalseValue,"ng-change":t.ngChange},function(e,t){h(e)&&n.attr(t,e)})}}});var x="Cannot create a collection-repeat within a scrollView that is scrollable on both x and y axis.  Choose either x direction or y direction.",B="collection-repeat expected attribute collection-item-height to be a an expression that returns a number (in pixels) or percentage.",V="collection-repeat expected attribute collection-item-width to be a an expression that returns a number (in pixels) or percentage.",E="collection-repeat expected expression in form of '_item_ in _collection_[ track by _id_]' but got '%'";u.directive("collectionRepeat",["$collectionRepeatManager","$collectionDataSource","$parse",function(e,t,n){return{priority:1e3,transclude:"element",terminal:!0,$$tlb:!0,require:"^$ionicScroll",controller:[function(){}],link:function(i,o,r,a,s){function c(e){var t=[],n=[],i=!0;f(I.children,function(e){if(ionic.DomUtil.elementIsDescendant(o[0],e,I))i=!1;else{if(e.hasAttribute("collection-repeat-ignore"))return;var r=e.offsetWidth,a=e.offsetHeight;if(r&&a){var s=v(e);(i?t:n).push({width:e.offsetWidth,height:e.offsetHeight,element:s,scope:s.isolateScope()||s.scope(),isOutside:!0})}}}),d.resize(),k.setData(e,t,n),T.resize()}function l(){c(i.$eval(S))}var u=v('<div style="position:relative;">');o.parent()[0].insertBefore(u[0],o[0]),u.append(o);var d=a.scrollView;if(d.options.scrollingX&&d.options.scrollingY)throw new Error(x);var h=!!d.options.scrollingY;if(h&&!r.collectionItemHeight)throw new Error(B);if(!h&&!r.collectionItemWidth)throw new Error(V);var g=n(r.collectionItemHeight||'"100%"'),m=n(r.collectionItemWidth||'"100%"'),$=function(e,t){var n=g(e,t);return p(n)&&n.indexOf("%")>-1?Math.floor(parseInt(n,10)/100*d.__clientHeight):n},w=function(e,t){var n=m(e,t);return p(n)&&n.indexOf("%")>-1?Math.floor(parseInt(n,10)/100*d.__clientWidth):n},b=r.collectionRepeat.match(/^\s*([\s\S]+?)\s+in\s+([\s\S]+?)(?:\s+track\s+by\s+([\s\S]+?))?\s*$/);if(!b)throw new Error(E.replace("%",r.collectionRepeat));var y=b[1],S=b[2],C=b[3],k=new t({scope:i,transcludeFn:s,transcludeParent:o.parent(),keyExpr:y,listExpr:S,trackByExpr:C,heightGetter:$,widthGetter:w}),T=new e({dataSource:k,element:a.$element,scrollView:a.scrollView});i.$watchCollection(S,function(e){if(e&&!angular.isArray(e))throw new Error("collection-repeat expects an array to repeat over, but instead got '"+typeof e+"'.");c(e)});var I=a.scrollView.__content;a.$element.on("scroll.resize",l),ionic.on("resize",l,window),i.$on("$destroy",function(){T.destroy(),k.destroy(),ionic.off("resize",l,window)})}}}]).directive({ngSrc:i("ngSrc","src"),ngSrcset:i("ngSrcset","srcset"),ngHref:i("ngHref","href")}),u.directive("ionContent",["$timeout","$controller","$ionicBind",function(e,t,n){return{restrict:"E",require:"^?ionNavView",scope:!0,priority:800,compile:function(e,i){function o(e,o,a){var s=e.$parent;if(e.$watch(function(){return(s.$hasHeader?" has-header":"")+(s.$hasSubheader?" has-subheader":"")+(s.$hasFooter?" has-footer":"")+(s.$hasSubfooter?" has-subfooter":"")+(s.$hasTabs?" has-tabs":"")+(s.$hasTabsTop?" has-tabs-top":"")},function(e,t){o.removeClass(t),o.addClass(e)}),e.$hasHeader=e.$hasSubheader=e.$hasFooter=e.$hasSubfooter=e.$hasTabs=e.$hasTabsTop=!1,n(e,a,{$onScroll:"&onScroll",$onScrollComplete:"&onScrollComplete",hasBouncing:"@",padding:"@",direction:"@",scrollbarX:"@",scrollbarY:"@",startX:"@",startY:"@",scrollEventInterval:"@"}),e.direction=e.direction||"y",angular.isDefined(a.padding)&&e.$watch(a.padding,function(e){(r||o).toggleClass("padding",!!e)}),"false"===a.scroll);else if("true"===i.overflowScroll)o.addClass("overflow-scroll");else{var c={el:o[0],delegateHandle:i.delegateHandle,locking:"true"===(i.locking||"true"),bouncing:e.$eval(e.hasBouncing),startX:e.$eval(e.startX)||0,startY:e.$eval(e.startY)||0,scrollbarX:e.$eval(e.scrollbarX)!==!1,scrollbarY:e.$eval(e.scrollbarY)!==!1,scrollingX:e.direction.indexOf("x")>=0,scrollingY:e.direction.indexOf("y")>=0,scrollEventInterval:parseInt(e.scrollEventInterval,10)||10,scrollingComplete:function(){e.$onScrollComplete({scrollTop:this.__scrollTop,scrollLeft:this.__scrollLeft})}};t("$ionicScroll",{$scope:e,scrollViewOptions:c}),e.$on("$destroy",function(){c.scrollingComplete=angular.noop,delete c.el,r=null,o=null,i.$$element=null})}}var r;return e.addClass("scroll-content ionic-scroll"),"false"!=i.scroll?(r=v('<div class="scroll"></div>'),r.append(e.contents()),e.append(r)):e.addClass("scroll-content-false"),{pre:o}}}}]),u.directive("exposeAsideWhen",["$window",function(e){return{restrict:"A",require:"^ionSideMenus",link:function(t,n,i,o){function r(){var t="large"==i.exposeAsideWhen?"(min-width:768px)":i.exposeAsideWhen;o.exposeAside(e.matchMedia(t).matches),o.activeAsideResizing(!1)}function a(){o.activeAsideResizing(!0),s()}var s=ionic.debounce(function(){t.$apply(function(){r()})},300,!1);r(),ionic.on("resize",a,e),t.$on("$destroy",function(){ionic.off("resize",a,e)})}}}]);var _="onHold onTap onTouch onRelease onDrag onDragUp onDragRight onDragDown onDragLeft onSwipe onSwipeUp onSwipeRight onSwipeDown onSwipeLeft".split(" ");_.forEach(function(e){u.directive(e,o(e))}),u.directive("ionNavBar",r()).directive("ionHeaderBar",r()).directive("ionHeaderBar",a(!0)).directive("ionFooterBar",a(!1)),u.directive("ionInfiniteScroll",["$timeout",function(e){function t(e,t,n){return n?t*(1-parseFloat(e,10)/100):t-parseFloat(e,10)}return{restrict:"E",require:["^$ionicScroll","ionInfiniteScroll"],template:'<i class="icon {{icon()}} icon-refreshing"></i>',scope:!0,controller:["$scope","$attrs",function(e,n){this.isLoading=!1,this.scrollView=null,this.getMaxScroll=function(){var e=(n.distance||"2.5%").trim(),i=-1!==e.indexOf("%"),o=this.scrollView.getScrollMax();return{left:this.scrollView.options.scrollingX?t(e,o.left,i):-1,top:this.scrollView.options.scrollingY?t(e,o.top,i):-1}}}],link:function(t,n,i,o){function r(){if(!s.isLoading){var e=c.getValues(),t=s.getMaxScroll();(-1!==t.left&&e.left>=t.left||-1!==t.top&&e.top>=t.top)&&l()}}var a=o[0],s=o[1],c=s.scrollView=a.scrollView;t.icon=function(){return angular.isDefined(i.icon)?i.icon:"ion-loading-d"};var l=function(){n[0].classList.add("active"),s.isLoading=!0,t.$parent&&t.$parent.$apply(i.onInfinite||"")},u=function(){n[0].classList.remove("active"),e(function(){c.resize(),d()},0,!1),s.isLoading=!1};t.$on("scroll.infiniteScrollComplete",function(){u()}),t.$on("$destroy",function(){a&&a.$element&&a.$element.off("scroll",d)});var d=ionic.animationFrameThrottle(r);setTimeout(d),a.$element.on("scroll",d)}}}]);var A='<a class="item-content" ng-href="{{$href()}}" target="{{$target()}}"></a>',P='<div class="item-content"></div>';u.directive("ionItem",["$animate","$compile",function(){return{restrict:"E",controller:["$scope","$element",function(e,t){this.$scope=e,this.$element=t}],scope:!0,compile:function(e,t){var n=angular.isDefined(t.href)||angular.isDefined(t.ngHref)||angular.isDefined(t.uiSref),i=n||/ion-(delete|option|reorder)-button/i.test(e.html());if(i){var o=v(n?A:P);o.append(e.contents()),e.append(o),e.addClass("item item-complex")}else e.addClass("item");return function(e,t,n){e.$href=function(){return n.href||n.ngHref},e.$target=function(){return n.target||"_self"}}}}}]);var D='<div class="item-left-edit item-delete enable-pointer-events"></div>';u.directive("ionDeleteButton",["$animate",function(){return{restrict:"E",require:["^ionItem","^?ionList"],priority:Number.MAX_VALUE,compile:function(e,t){return t.$set("class",(t["class"]||"")+" button icon button-icon",!0),function(e,t,n,i){var o=i[0],r=i[1],a=v(D);a.append(t),o.$element.append(a).addClass("item-left-editable"),r&&r.showDelete()&&a.addClass("visible active")}}}}]),u.directive("itemFloatingLabel",function(){return{restrict:"C",link:function(e,t){var n=t[0],i=n.querySelector("input, textarea"),o=n.querySelector(".input-label");if(i&&o){var r=function(){i.value?o.classList.add("has-input"):o.classList.remove("has-input")};i.addEventListener("input",r);var a=angular.element(i).controller("ngModel");a&&(a.$render=function(){i.value=a.$viewValue||"",r()}),e.$on("$destroy",function(){i.removeEventListener("input",r)})}}}});var H='<div class="item-options invisible"></div>';u.directive("ionOptionButton",["$compile",function(){function e(e){e.stopPropagation()}return{restrict:"E",require:"^ionItem",priority:Number.MAX_VALUE,compile:function(t,n){return n.$set("class",(n["class"]||"")+" button",!0),function(t,n,i,o){o.optionsContainer||(o.optionsContainer=v(H),o.$element.append(o.optionsContainer)),o.optionsContainer.append(n),n.on("click",e)}}}}]);var L='<div data-prevent-scroll="true" class="item-right-edit item-reorder enable-pointer-events"></div>';u.directive("ionReorderButton",["$animate","$parse",function(e,t){return{restrict:"E",require:["^ionItem","^?ionList"],priority:Number.MAX_VALUE,compile:function(e,n){return n.$set("class",(n["class"]||"")+" button icon button-icon",!0),e[0].setAttribute("data-prevent-scroll",!0),function(e,n,i,o){var r=o[0],a=o[1],s=t(i.onReorder);e.$onReorder=function(t,n){s(e,{$fromIndex:t,$toIndex:n})},i.ngClick||i.onClick||i.onclick||(n[0].onclick=function(e){return e.stopPropagation(),!1});var c=v(L);c.append(n),r.$element.append(c).addClass("item-right-editable"),a&&a.showReorder()&&c.addClass("visible active")}}}}]),u.directive("keyboardAttach",function(){return function(e,t){function n(e){if(!ionic.Platform.isAndroid()||ionic.Platform.isFullScreen){var n=e.keyboardHeight||e.detail.keyboardHeight;t.css("bottom",n+"px"),o=t.controller("$ionicScroll"),o&&(o.scrollView.__container.style.bottom=n+s(t[0])+"px")}}function i(){(!ionic.Platform.isAndroid()||ionic.Platform.isFullScreen)&&(t.css("bottom",""),o&&(o.scrollView.__container.style.bottom=""))}ionic.on("native.keyboardshow",n,window),ionic.on("native.keyboardhide",i,window),ionic.on("native.showkeyboard",n,window),ionic.on("native.hidekeyboard",i,window);var o;e.$on("$destroy",function(){ionic.off("native.keyboardshow",n,window),ionic.off("native.keyboardhide",i,window),ionic.off("native.showkeyboard",n,window),ionic.off("native.hidekeyboard",i,window)})}}),u.directive("ionList",["$animate","$timeout",function(e,t){return{restrict:"E",require:["ionList","^?$ionicScroll"],controller:"$ionicList",compile:function(e,n){var i=v('<div class="list">').append(e.contents()).addClass(n.type);return e.append(i),function(e,i,o,r){function a(){function o(e,t){t()&&e.addClass("visible")||e.removeClass("active"),ionic.requestAnimationFrame(function(){t()&&e.addClass("active")||e.removeClass("visible")})}s.listView=new ionic.views.ListView({el:i[0],listEl:i.children()[0],scrollEl:c&&c.element,scrollView:c&&c.scrollView,onReorder:function(e,n,i){var o=v(e).scope();o&&o.$onReorder&&t(function(){o.$onReorder(n,i)})},canSwipe:function(){return s.canSwipeItems()}});h(n.canSwipe)&&e.$watch("!!("+n.canSwipe+")",function(e){s.canSwipeItems(e)}),h(n.showDelete)&&e.$watch("!!("+n.showDelete+")",function(e){s.showDelete(e)}),h(n.showReorder)&&e.$watch("!!("+n.showReorder+")",function(e){s.showReorder(e)}),e.$watch(function(){return s.showDelete()},function(e,t){if(e||t){e&&s.closeOptionButtons(),s.canSwipeItems(!e),i.children().toggleClass("list-left-editing",e),i.toggleClass("disable-pointer-events",e);var n=v(i[0].getElementsByClassName("item-delete"));o(n,s.showDelete)}}),e.$watch(function(){return s.showReorder()},function(e,t){if(e||t){e&&s.closeOptionButtons(),s.canSwipeItems(!e),i.children().toggleClass("list-right-editing",e),i.toggleClass("disable-pointer-events",e);var n=v(i[0].getElementsByClassName("item-reorder"));o(n,s.showReorder)}})}var s=r[0],c=r[1];t(a)}}}}]),u.directive("menuClose",["$ionicViewService",function(){return{restrict:"AC",require:"^ionSideMenus",link:function(e,t,n,i){t.bind("click",function(){i.close()})}}}]),u.directive("menuToggle",["$ionicViewService",function(){return{restrict:"AC",require:"^ionSideMenus",link:function(e,t,n,i){var o=n.menuToggle||"left";t.bind("click",function(){"left"===o?i.toggleLeft():"right"===o&&i.toggleRight()})}}}]),u.directive("ionModal",[function(){return{restrict:"E",transclude:!0,replace:!0,controller:[function(){}],template:'<div class="modal-backdrop"><div class="modal-wrapper" ng-transclude></div></div>'}}]),u.directive("ionModalView",function(){return{restrict:"E",compile:function(e){e.addClass("modal")}}}),u.directive("ionNavBackButton",["$animate","$rootScope","$sanitize","$ionicNavBarConfig","$ionicNgClick",function(e,t,n,i,o){var r=!1;return t.$on("$viewHistory.historyChange",function(e,t){r=!!t.showBack}),{restrict:"E",require:"^ionNavBar",compile:function(t){t.addClass("button back-button ng-hide");var a=!!(t.html()||"").match(/class=.*?ion-/);return function(t,s,c,l){a||-1!==s[0].className.indexOf("ion-")||s.addClass(i.backButtonIcon),h(c.ngClick)||o(t,s,l.back),t.$watch(function(){return h(c.fromTitle)&&(s[0].innerHTML='<span class="back-button-title">'+n(t.oldTitle)+"</span>"),!(!r||!t.backButtonShown)},ionic.animationFrameThrottle(function(t){t?e.removeClass(s,"ng-hide"):e.addClass(s,"ng-hide")}))}}}}]),u.constant("$ionicNavBarConfig",{transition:"nav-title-slide-ios7",alignTitle:"center",backButtonIcon:"ion-ios7-arrow-back"}),u.directive("ionNavBar",["$ionicViewService","$rootScope","$animate","$compile","$ionicNavBarConfig",function(e,t,n,i,o){return{restrict:"E",controller:"$ionicNavBar",scope:!0,compile:function(e,t){function n(e,t,n,i){i._headerBarView=new ionic.views.HeaderBar({el:t[0],alignTitle:n.alignTitle||o.alignTitle||"center"}),e.backButtonShown=!1,e.shouldAnimate=!0,e.isReverse=!1,e.isInvisible=!0,e.$on("$destroy",function(){e.$parent.$hasHeader=!1}),e.$watch(function(){return(e.isReverse?" reverse":"")+(e.isInvisible?" invisible":"")+(e.shouldAnimate?"":" no-animation")},function(e,n){t.removeClass(n),t.addClass(e)})}return e.addClass("bar bar-header nav-bar").append('<div class="buttons left-buttons"> </div><h1 ng-bind-html="title" class="title"></h1><div class="buttons right-buttons"> </div>'),e.addClass(h(t.animation)?t.animation:o.transition),{pre:n}}}}]),u.directive("ionNavButtons",["$compile","$animate",function(e,t){return{require:"^ionNavBar",restrict:"E",compile:function(n){var i=n.contents().remove();
return function(n,o,r,a){var s="right"===r.side?a.rightButtonsElement:a.leftButtonsElement,c=v("<span>").append(i);o.append(c),e(c)(n),ionic.requestAnimationFrame(function(){n.$$destroyed||t.enter(c,s)}),n.$on("$destroy",function(){t.leave(c)}),o.css("display","none")}}}}]),u.directive("navClear",["$ionicViewService","$state","$location","$window","$rootScope",function(e,t,n,i,o){return o.$on("$stateChangeError",function(){e.nextViewOptions(null)}),{priority:100,restrict:"AC",compile:function(){function t(t,n){function o(){r=t.$on("$stateChangeStart",function(){e.nextViewOptions({disableAnimate:!0,disableBack:!0}),r()}),i.setTimeout(r,300)}var r;n.on("click",o)}return{pre:t}}}}]),u.constant("$ionicNavViewConfig",{transition:"slide-left-right-ios7"}),u.directive("ionNavView",["$ionicViewService","$state","$compile","$controller","$animate",function(e,t,n,i,o){var r=!1,a={restrict:"E",terminal:!0,priority:2e3,transclude:!0,controller:function(){},compile:function(s,c,l){return function(s,c,u){function d(r){o.enabled()===!1&&(r=!1);var a=t.$current&&t.$current.locals[p];if(a!==h){var l=e.getRenderer(c,u,s);if(f&&(f.$destroy(),f=null),!a)return h=null,w.state=null,c.append(m);var d=v("<div></div>").html(a.$template).contents(),$=l().register(d);l(r).leave(),h=a,w.state=a.$$state,l(r).enter(d);var b=n(d);if(f=s.$new(),f.$navDirection=$.navDirection,a.$$controller){a.$scope=f;var y=i(a.$$controller,a);c.children().data("$ngControllerController",y)}b(f);var S=e._getViewById($.viewId)||{};f.$broadcast("$viewContentLoaded",S),g&&f.$eval(g),d=null}}var f,h,p=u[a.name]||u.name||"",g=u.onload||"",m=l(s);c.append(m);var $=c.parent().inheritedData("$uiView");p.indexOf("@")<0&&(p=p+"@"+($&&$.state?$.state.name:""));var w={name:p,state:null};c.data("$uiView",w);var b=function(){if(!r){r=!0;try{d(!0)}catch(e){throw r=!1,e}r=!1}};s.$on("$stateChangeSuccess",b),d(!1)}}};return a}]),u.config(["$provide",function(e){e.decorator("ngClickDirective",["$delegate",function(e){return e.shift(),e}])}]).factory("$ionicNgClick",["$parse",function(e){return function(t,n,i){var o=angular.isFunction(i)?i:e(i);n.on("click",function(e){t.$apply(function(){o(t,{$event:e})})}),n.onclick=function(){}}}]).directive("ngClick",["$ionicNgClick",function(e){return function(t,n,i){e(t,n,i.ngClick)}}]).directive("ionStopEvent",function(){return{restrict:"A",link:function(e,t,n){t.bind(n.ionStopEvent,c)}}}),u.directive("ionPane",function(){return{restrict:"E",link:function(e,t){t.addClass("pane")}}}),u.directive("ionPopover",[function(){return{restrict:"E",transclude:!0,replace:!0,controller:[function(){}],template:'<div class="popover-backdrop"><div class="popover-wrapper" ng-transclude></div></div>'}}]),u.directive("ionPopoverView",function(){return{restrict:"E",compile:function(e){e.append(angular.element('<div class="popover-arrow"></div>')),e.addClass("popover")}}}),u.directive("ionRadio",function(){return{restrict:"E",replace:!0,require:"?ngModel",transclude:!0,template:'<label class="item item-radio"><input type="radio" name="radio-group"><div class="item-content disable-pointer-events" ng-transclude></div><i class="radio-icon disable-pointer-events icon ion-checkmark"></i></label>',compile:function(e,t){t.icon&&e.children().eq(2).removeClass("ion-checkmark").addClass(t.icon);var n=e.find("input");return f({name:t.name,value:t.value,disabled:t.disabled,"ng-value":t.ngValue,"ng-model":t.ngModel,"ng-disabled":t.ngDisabled,"ng-change":t.ngChange},function(e,t){h(e)&&n.attr(t,e)}),function(e,t,n){e.getValue=function(){return e.ngValue||n.value}}}}}),u.directive("ionRefresher",["$ionicBind",function(e){return{restrict:"E",replace:!0,require:"^$ionicScroll",template:'<div class="scroll-refresher" collection-repeat-ignore><div class="ionic-refresher-content" ng-class="{\'ionic-refresher-with-text\': pullingText || refreshingText}"><div class="icon-pulling" ng-class="{\'pulling-rotation-disabled\':disablePullingRotation}"><i class="icon {{pullingIcon}}"></i></div><div class="text-pulling" ng-bind-html="pullingText"></div><i class="icon {{refreshingIcon}} icon-refreshing"></i><div class="text-refreshing" ng-bind-html="refreshingText"></div></div></div>',compile:function(t,n){return angular.isUndefined(n.pullingIcon)&&n.$set("pullingIcon","ion-ios7-arrow-down"),angular.isUndefined(n.refreshingIcon)&&n.$set("refreshingIcon","ion-loading-d"),function(t,n,i,o){e(t,i,{pullingIcon:"@",pullingText:"@",refreshingIcon:"@",refreshingText:"@",disablePullingRotation:"@",$onRefresh:"&onRefresh",$onPulling:"&onPulling"}),o._setRefresher(t,n[0]),t.$on("scroll.refreshComplete",function(){t.$evalAsync(function(){o.scrollView.finishPullToRefresh()})})}}}}]),u.directive("ionScroll",["$timeout","$controller","$ionicBind",function(e,t,n){return{restrict:"E",scope:!0,controller:function(){},compile:function(e){function i(e,i,r){var a,s;n(e,r,{direction:"@",paging:"@",$onScroll:"&onScroll",scroll:"@",scrollbarX:"@",scrollbarY:"@",zooming:"@",minZoom:"@",maxZoom:"@"}),e.direction=e.direction||"y",angular.isDefined(r.padding)&&e.$watch(r.padding,function(e){o.toggleClass("padding",!!e)}),e.$eval(e.paging)===!0&&o.addClass("scroll-paging"),e.direction||(e.direction="y");var c=e.$eval(e.paging)===!0,l={el:i[0],delegateHandle:r.delegateHandle,locking:"true"===(r.locking||"true"),bouncing:e.$eval(r.hasBouncing),paging:c,scrollbarX:e.$eval(e.scrollbarX)!==!1,scrollbarY:e.$eval(e.scrollbarY)!==!1,scrollingX:e.direction.indexOf("x")>=0,scrollingY:e.direction.indexOf("y")>=0,zooming:e.$eval(e.zooming)===!0,maxZoom:e.$eval(e.maxZoom)||3,minZoom:e.$eval(e.minZoom)||.5};c&&(l.speedMultiplier=.8,l.bouncing=!1),s=t("$ionicScroll",{$scope:e,scrollViewOptions:l}),a=e.$parent.scrollView=s.scrollView}e.addClass("scroll-view ionic-scroll");var o=v('<div class="scroll"></div>');return o.append(e.contents()),e.append(o),{pre:i}}}}]),u.directive("ionSideMenu",function(){return{restrict:"E",require:"^ionSideMenus",scope:!0,compile:function(e,t){return angular.isUndefined(t.isEnabled)&&t.$set("isEnabled","true"),angular.isUndefined(t.width)&&t.$set("width","275"),e.addClass("menu menu-"+t.side),function(e,n,i,o){e.side=i.side||"left";var r=o[e.side]=new ionic.views.SideMenu({width:t.width,el:n[0],isEnabled:!0});e.$watch(i.width,function(e){var t=+e;t&&t==e&&r.setWidth(+e)}),e.$watch(i.isEnabled,function(e){r.setIsEnabled(!!e)})}}}}),u.directive("ionSideMenuContent",["$timeout","$ionicGesture","$window",function(e,t,n){return{restrict:"EA",require:"^ionSideMenus",scope:!0,compile:function(i,o){function r(r,a,s,c){function l(e){0!==c.getOpenAmount()?(c.close(),e.gesture.srcEvent.preventDefault(),v=null,g=null):v||(v=ionic.tap.pointerCoord(e.gesture.srcEvent))}function u(e){c.isDraggableTarget(e)&&"x"==p(e)&&(c._handleDrag(e),e.gesture.srcEvent.preventDefault())}function d(e){"x"==p(e)&&e.gesture.srcEvent.preventDefault()}function f(e){c._endDrag(e),v=null,g=null}function p(e){if(g)return g;if(e&&e.gesture){if(v){var t=ionic.tap.pointerCoord(e.gesture.srcEvent),n=Math.abs(t.x-v.x),i=Math.abs(t.y-v.y),o=i>n?"y":"x";return Math.max(n,i)>30&&(g=o),o}v=ionic.tap.pointerCoord(e.gesture.srcEvent)}return"x"}var v=null,g=null;a.addClass("menu-content pane"),h(o.dragContent)?r.$watch(o.dragContent,function(e){c.canDragContent(e)}):c.canDragContent(!0),h(o.edgeDragThreshold)&&r.$watch(o.edgeDragThreshold,function(e){c.edgeDragThreshold(e)});var m={element:i[0],onDrag:function(){},endDrag:function(){},getTranslateX:function(){return r.sideMenuContentTranslateX||0},setTranslateX:ionic.animationFrameThrottle(function(t){var n=m.offsetX+t;a[0].style[ionic.CSS.TRANSFORM]="translate3d("+n+"px,0,0)",e(function(){r.sideMenuContentTranslateX=t})}),setMarginLeft:ionic.animationFrameThrottle(function(e){e?(e=parseInt(e,10),a[0].style[ionic.CSS.TRANSFORM]="translate3d("+e+"px,0,0)",a[0].style.width=n.innerWidth-e+"px",m.offsetX=e):(a[0].style[ionic.CSS.TRANSFORM]="translate3d(0,0,0)",a[0].style.width="",m.offsetX=0)}),enableAnimation:function(){r.animationEnabled=!0,a[0].classList.add("menu-animated")},disableAnimation:function(){r.animationEnabled=!1,a[0].classList.remove("menu-animated")},offsetX:0};c.setContent(m);var $={stop_browser_behavior:!1},w=t.on("tap",l,a,$),b=t.on("dragright",u,a,$),y=t.on("dragleft",u,a,$),S=t.on("dragup",d,a,$),C=t.on("dragdown",d,a,$),k=t.on("release",f,a,$);r.$on("$destroy",function(){t.off(y,"dragleft",u),t.off(b,"dragright",u),t.off(S,"dragup",d),t.off(C,"dragdown",d),t.off(k,"release",f),t.off(w,"tap",l)})}return{pre:r}}}}]),u.directive("ionSideMenus",["$ionicBody",function(e){return{restrict:"ECA",controller:"$ionicSideMenus",compile:function(t,n){function i(t){t.$on("$ionicExposeAside",function(n,i){t.$exposeAside||(t.$exposeAside={}),t.$exposeAside.active=i,e.enableClass(i,"aside-open")}),t.$on("$destroy",function(){e.removeClass("menu-open","aside-open")})}return n.$set("class",(n["class"]||"")+" view"),{pre:i}}}}]),u.directive("ionSlideBox",["$timeout","$compile","$ionicSlideBoxDelegate",function(e,t,n){return{restrict:"E",replace:!0,transclude:!0,scope:{autoPlay:"=",doesContinue:"@",slideInterval:"@",showPager:"@",pagerClick:"&",disableScroll:"@",onSlideChanged:"&",activeSlide:"=?"},controller:["$scope","$element","$attrs",function(t,i,o){var r=t.$eval(t.doesContinue)===!0,a=h(o.autoPlay)?!!t.autoPlay:!1,s=a?t.$eval(t.slideInterval)||4e3:0,c=new ionic.views.Slider({el:i[0],auto:s,continuous:r,startSlide:t.activeSlide,slidesChanged:function(){t.currentSlide=c.currentIndex(),e(function(){})},callback:function(n){t.currentSlide=n,t.onSlideChanged({index:t.currentSlide,$index:t.currentSlide}),t.$parent.$broadcast("slideBox.slideChanged",n),t.activeSlide=n,e(function(){})}});c.enableSlide(t.$eval(o.disableScroll)!==!0),t.$watch("activeSlide",function(e){angular.isDefined(e)&&c.slide(e)}),t.$on("slideBox.nextSlide",function(){c.next()}),t.$on("slideBox.prevSlide",function(){c.prev()}),t.$on("slideBox.setSlide",function(e,t){c.slide(t)}),this.__slider=c;var l=n._registerInstance(c,o.delegateHandle);t.$on("$destroy",l),this.slidesCount=function(){return c.slidesCount()},this.onPagerClick=function(e){t.pagerClick({index:e})},e(function(){c.load()})}],template:'<div class="slider"><div class="slider-slides" ng-transclude></div></div>',link:function(e,n){if(e.$eval(e.showPager)!==!1){var i=e.$new(),o=v("<ion-pager></ion-pager>");n.append(o),t(o)(i)}}}}]).directive("ionSlide",function(){return{restrict:"E",require:"^ionSlideBox",compile:function(e){return e.addClass("slider-slide"),function(){}}}}).directive("ionPager",function(){return{restrict:"E",replace:!0,require:"^ionSlideBox",template:'<div class="slider-pager"><span class="slider-pager-page" ng-repeat="slide in numSlides() track by $index" ng-class="{active: $index == currentSlide}" ng-click="pagerClick($index)"><i class="icon ion-record"></i></span></div>',link:function(e,t,n,i){var o=function(e){for(var n=t[0].children,i=n.length,o=0;i>o;o++)o==e?n[o].classList.add("active"):n[o].classList.remove("active")};e.pagerClick=function(e){i.onPagerClick(e)},e.numSlides=function(){return new Array(i.slidesCount())},e.$watch("currentSlide",function(e){o(e)})}}}),u.constant("$ionicTabConfig",{type:""}),u.directive("ionTab",["$rootScope","$animate","$ionicBind","$compile",function(e,t,n,i){function o(e,t){return angular.isDefined(t)?" "+e+'="'+t+'"':""}return{restrict:"E",require:["^ionTabs","ionTab"],replace:!0,controller:"$ionicTab",scope:!0,compile:function(e,r){var a="<ion-tab-nav"+o("ng-click",r.ngClick)+o("title",r.title)+o("icon",r.icon)+o("icon-on",r.iconOn)+o("icon-off",r.iconOff)+o("badge",r.badge)+o("badge-style",r.badgeStyle)+o("hidden",r.hidden)+o("class",r["class"])+"></ion-tab-nav>",s=v('<div class="pane">').append(e.contents().remove());return function(e,o,r,c){function l(){h.tabMatchesState()&&f.select(e,!1)}var u,d,f=c[0],h=c[1],p=s[0].querySelector("ion-nav-view")||s[0].querySelector("data-ion-nav-view"),g=p&&p.getAttribute("name");n(e,r,{animate:"=",onSelect:"&",onDeselect:"&",title:"@",uiSref:"@",href:"@"}),f.add(e),e.$on("$destroy",function(){e.$tabsDestroy||f.remove(e),m.isolateScope().$destroy(),m.remove()}),o[0].removeAttribute("title"),g&&(h.navViewName=e.navViewName=g),e.$on("$stateChangeSuccess",l),l();var m=v(a);m.data("$ionTabsController",f),m.data("$ionTabController",h),f.$tabsElement.append(i(m)(e)),e.$watch("$tabSelected",function(n){u&&u.$destroy(),u=null,d&&t.leave(d),d=null,n&&(u=e.$new(),d=s.clone(),t.enter(d,f.$element),i(d)(u))})}}}}]),u.directive("ionTabNav",[function(){return{restrict:"E",replace:!0,require:["^ionTabs","^ionTab"],template:'<a ng-class="{\'tab-item-active\': isTabActive(), \'has-badge\':badge, \'tab-hidden\':isHidden()}"  class="tab-item"><span class="badge {{badgeStyle}}" ng-if="badge">{{badge}}</span><i class="icon {{getIconOn()}}" ng-if="getIconOn() && isTabActive()"></i><i class="icon {{getIconOff()}}" ng-if="getIconOff() && !isTabActive()"></i><span class="tab-title" ng-bind-html="title"></span></a>',scope:{title:"@",icon:"@",iconOn:"@",iconOff:"@",badge:"=",hidden:"@",badgeStyle:"@","class":"@"},compile:function(){return function(e,t,n,i){var o=i[0],r=i[1];t[0].removeAttribute("title"),e.selectTab=function(e){e.preventDefault(),o.select(r.$scope,!0)},n.ngClick||t.on("click",function(t){e.$apply(function(){e.selectTab(t)})}),e.isHidden=function(){return"true"===n.hidden||n.hidden===!0?!0:!1},e.getIconOn=function(){return e.iconOn||e.icon},e.getIconOff=function(){return e.iconOff||e.icon},e.isTabActive=function(){return o.selectedTab()===r.$scope}}}}}]),u.constant("$ionicTabsConfig",{position:"",type:""}),u.directive("ionTabs",["$ionicViewService","$ionicTabsDelegate","$ionicTabsConfig",function(e,t,n){return{restrict:"E",scope:!0,controller:"$ionicTabs",compile:function(e){function i(e,n,i,o){var r=t._registerInstance(o,i.delegateHandle);e.$on("$destroy",function(){e.$tabsDestroy=!0,r()}),o.$scope=e,o.$element=n,o.$tabsElement=v(n[0].querySelector(".tabs"));var a=n[0];e.$watch(function(){return a.className},function(t){var n=-1!==t.indexOf("tabs-top"),i=-1!==t.indexOf("tabs-item-hide");e.$hasTabs=!n&&!i,e.$hasTabsTop=n&&!i}),e.$on("$destroy",function(){delete e.$hasTabs,delete e.$hasTabsTop})}e.addClass("view");var o=v('<div class="tabs"></div>');return o.append(e.contents()),e.append(o),e.addClass(n.position),e.addClass(n.type),{pre:i}}}}]),u.directive("ionToggle",["$ionicGesture","$timeout",function(){return{restrict:"E",replace:!0,require:"?ngModel",transclude:!0,template:'<div class="item item-toggle"><div ng-transclude></div><label class="toggle"><input type="checkbox"><div class="track"><div class="handle"></div></div></label></div>',compile:function(e,t){var n=e.find("input");return f({name:t.name,"ng-value":t.ngValue,"ng-model":t.ngModel,"ng-checked":t.ngChecked,"ng-disabled":t.ngDisabled,"ng-true-value":t.ngTrueValue,"ng-false-value":t.ngFalseValue,"ng-change":t.ngChange},function(e,t){h(e)&&n.attr(t,e)}),t.toggleClass&&e[0].getElementsByTagName("label")[0].classList.add(t.toggleClass),function(e,t){var n,i,o,r;n=t[0].getElementsByTagName("label")[0],i=n.children[0],o=n.children[1],r=o.children[0];var a=v(i).controller("ngModel");e.toggle=new ionic.views.Toggle({el:n,track:o,checkbox:i,handle:r,onChange:function(){a.$setViewValue(i.checked?!0:!1),e.$apply()}}),e.$on("$destroy",function(){e.toggle.destroy()})}}}}]),u.directive("ionView",["$ionicViewService","$rootScope","$animate",function(){return{restrict:"EA",priority:1e3,require:["^?ionNavBar","^?ionModal"],compile:function(e){return e.addClass("pane"),e[0].removeAttribute("title"),function(e,t,n,i){var o=i[0],r=i[1];if(o&&!r){if(angular.isDefined(n.title)){var a=n.title;o.changeTitle(a,e.$navDirection),n.$observe("title",function(e){o.setTitle(e)})}var s=angular.isDefined(n.hideBackButton)?n.hideBackButton:"false";e.$watch(s,function(e){o.showBackButton(!e)});var c=angular.isDefined(n.hideNavBar)?n.hideNavBar:"false";e.$watch(c,function(e){o.showBar(!e)})}}}}}])}();
; browserify_shim__define__module__export__(typeof ionic != "undefined" ? ionic : window.ionic);

}).call(global, undefined, undefined, undefined, undefined, function defineExport(ex) { module.exports = ex; });

}).call(this,typeof global !== "undefined" ? global : typeof self !== "undefined" ? self : typeof window !== "undefined" ? window : {})
},{"/home/ubuntu/workspace/bower_components/angular-animate/angular-animate.min.js":"/home/ubuntu/workspace/bower_components/angular-animate/angular-animate.min.js","/home/ubuntu/workspace/bower_components/angular-sanitize/angular-sanitize.min.js":"/home/ubuntu/workspace/bower_components/angular-sanitize/angular-sanitize.min.js","/home/ubuntu/workspace/bower_components/angular-ui-router/release/angular-ui-router.min.js":"/home/ubuntu/workspace/bower_components/angular-ui-router/release/angular-ui-router.min.js","/home/ubuntu/workspace/bower_components/angular/angular.min.js":"/home/ubuntu/workspace/bower_components/angular/angular.min.js","/home/ubuntu/workspace/bower_components/ionic/release/js/ionic.min.js":"/home/ubuntu/workspace/bower_components/ionic/release/js/ionic.min.js"}],"/home/ubuntu/workspace/bower_components/ionic/release/js/ionic.min.js":[function(require,module,exports){
/*!
 * Copyright 2014 Drifty Co.
 * http://drifty.com/
 *
 * Ionic, v1.0.0-beta.13
 * A powerful HTML5 mobile app framework.
 * http://ionicframework.com/
 *
 * By @maxlynch, @benjsperry, @adamdbradley <3
 *
 * Licensed under the MIT license. Please see LICENSE for more information.
 *
 */

!function(){function e(e,t,n){t!==!1?k.addEventListener(e,j[e],n):k.removeEventListener(e,j[e])}function t(e){var t=T(e.target),i=E(t);if(ionic.tap.requiresNativeClick(i)||z)return!1;var r=ionic.tap.pointerCoord(e);n("click",i,r.x,r.y),_(i)}function n(e,t,n,i){var r=document.createEvent("MouseEvents");r.initMouseEvent(e,!0,!0,window,1,0,0,n,i,!1,!1,!1,!1,0,null),r.isIonicTap=!0,t.dispatchEvent(r)}function i(e){return("submit"!=e.target.type||0!==e.detail)&&(ionic.scroll.isScrolling&&ionic.tap.containsOrIsTextInput(e.target)||!e.isIonicTap&&!ionic.tap.requiresNativeClick(e.target))?(e.stopPropagation(),ionic.tap.isLabelWithTextInput(e.target)||e.preventDefault(),!1):void 0}function r(t){if(!t.isIonicTap&&!d(t)){if(X)return t.stopPropagation(),ionic.tap.isTextInput(t.target)&&q===t.target||/^(select|option)$/i.test(t.target.tagName)||t.preventDefault(),!1;z=!1,F=ionic.tap.pointerCoord(t),e("mousemove"),ionic.activator.start(t)}}function o(n){return X?(n.stopPropagation(),n.preventDefault(),!1):d(n)||/^(select|option)$/i.test(n.target.tagName)?!1:(v(n)||t(n),e("mousemove",!1),ionic.activator.end(),void(z=!1))}function s(t){return v(t)?(e("mousemove",!1),ionic.activator.end(),z=!0,!1):void 0}function a(t){if(!d(t)&&(z=!1,h(),F=ionic.tap.pointerCoord(t),e(U),ionic.activator.start(t),ionic.Platform.isIOS()&&ionic.tap.isLabelWithTextInput(t.target))){var n=E(T(t.target));n!==Y&&t.preventDefault()}}function l(e){d(e)||(h(),v(e)||(t(e),/^(select|option)$/i.test(e.target.tagName)&&e.preventDefault()),q=e.target,u())}function c(t){return v(t)?(z=!0,e(U,!1),ionic.activator.end(),!1):void 0}function u(){e(U,!1),ionic.activator.end(),z=!1}function h(){X=!0,clearTimeout(H),H=setTimeout(function(){X=!1},2e3)}function d(e){return e.isTapHandled?!0:(e.isTapHandled=!0,ionic.scroll.isScrolling&&ionic.tap.containsOrIsTextInput(e.target)?(e.preventDefault(),!0):void 0)}function _(e){W=null;var t=!1;"SELECT"==e.tagName?(n("mousedown",e,0,0),e.focus&&e.focus(),t=!0):g()===e?t=!0:/^(input|textarea)$/i.test(e.tagName)||e.isContentEditable?(t=!0,e.focus&&e.focus(),e.value=e.value,X&&(W=e)):f(),t&&(g(e),ionic.trigger("ionic.focusin",{target:e},!0))}function f(){var e=g();e&&(/^(input|textarea|select)$/i.test(e.tagName)||e.isContentEditable)&&e.blur(),g(null)}function p(e){X&&ionic.tap.isTextInput(g())&&ionic.tap.isTextInput(W)&&W!==e.target&&(W.focus(),W=null),ionic.scroll.isScrolling=!1}function m(){g(null)}function g(e){return arguments.length&&(Y=e),Y||document.activeElement}function v(e){if(!e||1!==e.target.nodeType||!F||0===F.x&&0===F.y)return!1;var t=ionic.tap.pointerCoord(e),n=!(!e.target.classList||!e.target.classList.contains),i=n&e.target.classList.contains("button")?Z:B;return Math.abs(F.x-t.x)>i||Math.abs(F.y-t.y)>i}function T(e,t){for(var n=e,i=0;6>i&&n;i++){if("LABEL"===n.tagName)return n;n=n.parentElement}return t!==!1?e:void 0}function E(e){if(e&&"LABEL"===e.tagName){if(e.control)return e.control;if(e.querySelector){var t=e.querySelector("input,textarea,select");if(t)return t}}return e}function S(){A()?(window.addEventListener("native.keyboardshow",w),window.addEventListener("native.keyboardhide",L),window.addEventListener("native.showkeyboard",w),window.addEventListener("native.hidekeyboard",L)):document.body.addEventListener("focusout",L),document.body.addEventListener("ionic.focusin",b),document.body.addEventListener("focusin",b),document.body.addEventListener("orientationchange",G),window.navigator.msPointerEnabled?document.removeEventListener("MSPointerDown",S):document.removeEventListener("touchstart",S)}function w(e){clearTimeout(K),ionic.keyboard.height=e.keyboardHeight}function b(e){e.target&&ionic.tap.isTextInput(e.target)&&!ionic.tap.isDateInput(e.target)&&P(e.target)&&(document.addEventListener("keydown",M,!1),document.body.scrollTop=0,document.body.querySelector(".scroll-content").scrollTop=0,$=e.target,y(e))}function y(e){clearTimeout(J),clearTimeout(K),J=setTimeout(function(){if(!(tt+350>Date.now())){tt=Date.now();var t,n=$.getBoundingClientRect(),i=0;Q=setInterval(function(){t=I(),i>10&&(clearInterval(Q),t=275),t&&(clearInterval(Q),D(e.target,n.top,n.bottom,et,t)),i++},100)}},32)}function D(e,t,n,i,r){var o={target:e,elementTop:Math.round(t),elementBottom:Math.round(n),keyboardHeight:r,viewportHeight:i};return o.hasPlugin=A(),o.contentHeight=i-r,o.isElementUnderKeyboard=o.elementBottom>o.contentHeight,ionic.keyboard.isOpen=!0,$=e,ionic.trigger("scrollChildIntoView",o,!0),ionic.requestAnimationFrame(function(){document.body.classList.add(nt)}),window.navigator.msPointerEnabled?document.addEventListener("MSPointerMove",N,!1):document.addEventListener("touchmove",N,!1),o}function L(){clearTimeout(K),K=setTimeout(ionic.keyboard.hide,350)}function x(){C()>et&&(et=C())}function M(e){ionic.scroll.isScrolling&&N(e)}function N(e){"TEXTAREA"!==e.target.tagName&&e.preventDefault()}function G(){var e=C();if(e===et)var t=0,n=setInterval(function(){t>10&&clearInterval(n),e=C(),e!==et&&(ionic.keyboard.landscape=et>e?!0:!1,et=e,clearInterval(n)),t++},50);else et=e}function I(){return ionic.keyboard.height?ionic.keyboard.height:ionic.Platform.isAndroid()?ionic.Platform.isFullScreen?275:C()<et?et-C():0:ionic.Platform.isIOS()?ionic.keyboard.landscape?206:ionic.Platform.isWebView()?260:216:275}function C(){return window.innerHeight||screen.height}function P(e){for(;e;){if(e.classList.contains(it))return!0;e=e.parentElement}return!1}function A(){return!!(window.cordova&&cordova.plugins&&cordova.plugins.Keyboard)}function O(){var e;for(e=0;e<document.head.children.length;e++)if("viewport"==document.head.children[e].name){rt=document.head.children[e];break}if(rt){var t,n=rt.content.toLowerCase().replace(/\s+/g,"").split(",");for(e=0;e<n.length;e++)n[e]&&(t=n[e].split("="),ot[t[0]]=t.length>1?t[1]:"_");R()}}function R(){var e=ot.width,t=ot.height,n=ionic.Platform,i=n.version(),r="device-width",o="device-height",s=ionic.viewport.orientation();delete ot.height,ot.width=r,n.isIPad()?i>7?delete ot.width:n.isWebView()?90==s?ot.height="0":7==i&&(ot.height=o):7>i&&(ot.height="0"):n.isIOS()&&(n.isWebView()?i>7?delete ot.width:7>i?t&&(ot.height="0"):7==i&&(ot.height=o):7>i&&t&&(ot.height="0")),(e!==ot.width||t!==ot.height)&&V()}function V(){var e,t=[];for(e in ot)ot[e]&&t.push(e+("_"==ot[e]?"":"="+ot[e]));rt.content=t.join(", ")}window.ionic=window.ionic||{},window.ionic.views={},window.ionic.version="1.0.0-beta.13",function(e,t,n){function i(){o=!0;for(var e=0;e<r.length;e++)n.requestAnimationFrame(r[e]);r=[],t.removeEventListener("DOMContentLoaded",i)}var r=[],o="complete"===t.readyState||"interactive"===t.readyState;o||t.addEventListener("DOMContentLoaded",i),e._rAF=function(){return e.requestAnimationFrame||e.webkitRequestAnimationFrame||e.mozRequestAnimationFrame||function(t){e.setTimeout(t,16)}}();var s=e.cancelAnimationFrame||e.webkitCancelAnimationFrame||e.mozCancelAnimationFrame||e.webkitCancelRequestAnimationFrame;n.DomUtil={requestAnimationFrame:function(t){return e._rAF(t)},cancelAnimationFrame:function(e){s(e)},animationFrameThrottle:function(e){var t,i,r;return function(){t=arguments,r=this,i||(i=!0,n.requestAnimationFrame(function(){e.apply(r,t),i=!1}))}},getPositionInParent:function(e){return{left:e.offsetLeft,top:e.offsetTop}},ready:function(e){o?n.requestAnimationFrame(e):r.push(e)},getTextBounds:function(n){if(t.createRange){var i=t.createRange();if(i.selectNodeContents(n),i.getBoundingClientRect){var r=i.getBoundingClientRect();if(r){var o=e.scrollX,s=e.scrollY;return{top:r.top+s,left:r.left+o,right:r.left+o+r.width,bottom:r.top+s+r.height,width:r.width,height:r.height}}}}return null},getChildIndex:function(e,t){if(t)for(var n,i=e.parentNode.children,r=0,o=0,s=i.length;s>r;r++)if(n=i[r],n.nodeName&&n.nodeName.toLowerCase()==t){if(n==e)return o;o++}return Array.prototype.slice.call(e.parentNode.children).indexOf(e)},swapNodes:function(e,t){t.parentNode.insertBefore(e,t)},elementIsDescendant:function(e,t,n){var i=e;do{if(i===t)return!0;i=i.parentNode}while(i&&i!==n);return!1},getParentWithClass:function(e,t,n){for(n=n||10;e.parentNode&&n--;){if(e.parentNode.classList&&e.parentNode.classList.contains(t))return e.parentNode;e=e.parentNode}return null},getParentOrSelfWithClass:function(e,t,n){for(n=n||10;e&&n--;){if(e.classList&&e.classList.contains(t))return e;e=e.parentNode}return null},rectContains:function(e,t,n,i,r,o){return n>e||e>r?!1:i>t||t>o?!1:!0}},n.requestAnimationFrame=n.DomUtil.requestAnimationFrame,n.cancelAnimationFrame=n.DomUtil.cancelAnimationFrame,n.animationFrameThrottle=n.DomUtil.animationFrameThrottle}(window,document,ionic),function(e){e.CustomEvent=function(){if("function"==typeof window.CustomEvent)return CustomEvent;var e=function(e,t){var n;t=t||{bubbles:!1,cancelable:!1,detail:void 0};try{n=document.createEvent("CustomEvent"),n.initCustomEvent(e,t.bubbles,t.cancelable,t.detail)}catch(i){n=document.createEvent("Event");for(var r in t)n[r]=t[r];n.initEvent(e,t.bubbles,t.cancelable)}return n};return e.prototype=window.Event.prototype,e}(),e.EventController={VIRTUALIZED_EVENTS:["tap","swipe","swiperight","swipeleft","drag","hold","release"],trigger:function(t,n,i,r){var o=new e.CustomEvent(t,{detail:n,bubbles:!!i,cancelable:!!r});n&&n.target&&n.target.dispatchEvent&&n.target.dispatchEvent(o)||window.dispatchEvent(o)},on:function(t,n,i){for(var r=i||window,o=0,s=this.VIRTUALIZED_EVENTS.length;s>o;o++)if(t==this.VIRTUALIZED_EVENTS[o]){var a=new e.Gesture(i);return a.on(t,n),a}r.addEventListener(t,n)},off:function(e,t,n){n.removeEventListener(e,t)},onGesture:function(t,n,i,r){var o=new e.Gesture(i,r);return o.on(t,n),o},offGesture:function(e,t,n){e.off(t,n)},handlePopState:function(){}},e.on=function(){e.EventController.on.apply(e.EventController,arguments)},e.off=function(){e.EventController.off.apply(e.EventController,arguments)},e.trigger=e.EventController.trigger,e.onGesture=function(){return e.EventController.onGesture.apply(e.EventController.onGesture,arguments)},e.offGesture=function(){return e.EventController.offGesture.apply(e.EventController.offGesture,arguments)}}(window.ionic),function(e){function t(){if(!e.Gestures.READY){e.Gestures.event.determineEventTypes();for(var t in e.Gestures.gestures)e.Gestures.gestures.hasOwnProperty(t)&&e.Gestures.detection.register(e.Gestures.gestures[t]);e.Gestures.event.onTouch(e.Gestures.DOCUMENT,e.Gestures.EVENT_MOVE,e.Gestures.detection.detect),e.Gestures.event.onTouch(e.Gestures.DOCUMENT,e.Gestures.EVENT_END,e.Gestures.detection.detect),e.Gestures.READY=!0}}e.Gesture=function(t,n){return new e.Gestures.Instance(t,n||{})},e.Gestures={},e.Gestures.defaults={stop_browser_behavior:"disable-user-behavior"},e.Gestures.HAS_POINTEREVENTS=window.navigator.pointerEnabled||window.navigator.msPointerEnabled,e.Gestures.HAS_TOUCHEVENTS="ontouchstart"in window,e.Gestures.MOBILE_REGEX=/mobile|tablet|ip(ad|hone|od)|android|silk/i,e.Gestures.NO_MOUSEEVENTS=e.Gestures.HAS_TOUCHEVENTS&&window.navigator.userAgent.match(e.Gestures.MOBILE_REGEX),e.Gestures.EVENT_TYPES={},e.Gestures.DIRECTION_DOWN="down",e.Gestures.DIRECTION_LEFT="left",e.Gestures.DIRECTION_UP="up",e.Gestures.DIRECTION_RIGHT="right",e.Gestures.POINTER_MOUSE="mouse",e.Gestures.POINTER_TOUCH="touch",e.Gestures.POINTER_PEN="pen",e.Gestures.EVENT_START="start",e.Gestures.EVENT_MOVE="move",e.Gestures.EVENT_END="end",e.Gestures.DOCUMENT=window.document,e.Gestures.plugins={},e.Gestures.READY=!1,e.Gestures.Instance=function(n,i){var r=this;if(null!==n)return t(),this.element=n,this.enabled=!0,this.options=e.Gestures.utils.extend(e.Gestures.utils.extend({},e.Gestures.defaults),i||{}),this.options.stop_browser_behavior&&e.Gestures.utils.stopDefaultBrowserBehavior(this.element,this.options.stop_browser_behavior),e.Gestures.event.onTouch(n,e.Gestures.EVENT_START,function(t){r.enabled&&e.Gestures.detection.startDetect(r,t)}),this},e.Gestures.Instance.prototype={on:function(e,t){for(var n=e.split(" "),i=0;i<n.length;i++)this.element.addEventListener(n[i],t,!1);return this},off:function(e,t){for(var n=e.split(" "),i=0;i<n.length;i++)this.element.removeEventListener(n[i],t,!1);return this},trigger:function(t,n){var i=e.Gestures.DOCUMENT.createEvent("Event");i.initEvent(t,!0,!0),i.gesture=n;var r=this.element;return e.Gestures.utils.hasParent(n.target,r)&&(r=n.target),r.dispatchEvent(i),this},enable:function(e){return this.enabled=e,this}};var n=null,i=!1,r=!1;e.Gestures.event={bindDom:function(e,t,n){for(var i=t.split(" "),r=0;r<i.length;r++)e.addEventListener(i[r],n,!1)},onTouch:function(t,o,s){var a=this;this.bindDom(t,e.Gestures.EVENT_TYPES[o],function(l){var c=l.type.toLowerCase();if(!c.match(/mouse/)||!r){c.match(/touch/)||c.match(/pointerdown/)||c.match(/mouse/)&&1===l.which?i=!0:c.match(/mouse/)&&1!==l.which&&(i=!1),c.match(/touch|pointer/)&&(r=!0);var u=0;i&&(e.Gestures.HAS_POINTEREVENTS&&o!=e.Gestures.EVENT_END?u=e.Gestures.PointerEvent.updatePointer(o,l):c.match(/touch/)?u=l.touches.length:r||(u=c.match(/up/)?0:1),u>0&&o==e.Gestures.EVENT_END?o=e.Gestures.EVENT_MOVE:u||(o=e.Gestures.EVENT_END),(u||null===n)&&(n=l),s.call(e.Gestures.detection,a.collectEventData(t,o,a.getTouchList(n,o),l)),e.Gestures.HAS_POINTEREVENTS&&o==e.Gestures.EVENT_END&&(u=e.Gestures.PointerEvent.updatePointer(o,l))),u||(n=null,i=!1,r=!1,e.Gestures.PointerEvent.reset())}})},determineEventTypes:function(){var t;t=e.Gestures.HAS_POINTEREVENTS?e.Gestures.PointerEvent.getEvents():e.Gestures.NO_MOUSEEVENTS?["touchstart","touchmove","touchend touchcancel"]:["touchstart mousedown","touchmove mousemove","touchend touchcancel mouseup"],e.Gestures.EVENT_TYPES[e.Gestures.EVENT_START]=t[0],e.Gestures.EVENT_TYPES[e.Gestures.EVENT_MOVE]=t[1],e.Gestures.EVENT_TYPES[e.Gestures.EVENT_END]=t[2]},getTouchList:function(t){return e.Gestures.HAS_POINTEREVENTS?e.Gestures.PointerEvent.getTouchList():t.touches?t.touches:(t.identifier=1,[t])},collectEventData:function(t,n,i,r){var o=e.Gestures.POINTER_TOUCH;return(r.type.match(/mouse/)||e.Gestures.PointerEvent.matchType(e.Gestures.POINTER_MOUSE,r))&&(o=e.Gestures.POINTER_MOUSE),{center:e.Gestures.utils.getCenter(i),timeStamp:(new Date).getTime(),target:r.target,touches:i,eventType:n,pointerType:o,srcEvent:r,preventDefault:function(){this.srcEvent.preventManipulation&&this.srcEvent.preventManipulation(),this.srcEvent.preventDefault},stopPropagation:function(){this.srcEvent.stopPropagation()},stopDetect:function(){return e.Gestures.detection.stopDetect()}}}},e.Gestures.PointerEvent={pointers:{},getTouchList:function(){var e=this,t=[];return Object.keys(e.pointers).sort().forEach(function(n){t.push(e.pointers[n])}),t},updatePointer:function(t,n){return t==e.Gestures.EVENT_END?this.pointers={}:(n.identifier=n.pointerId,this.pointers[n.pointerId]=n),Object.keys(this.pointers).length},matchType:function(t,n){if(!n.pointerType)return!1;var i={};return i[e.Gestures.POINTER_MOUSE]=n.pointerType==n.MSPOINTER_TYPE_MOUSE||n.pointerType==e.Gestures.POINTER_MOUSE,i[e.Gestures.POINTER_TOUCH]=n.pointerType==n.MSPOINTER_TYPE_TOUCH||n.pointerType==e.Gestures.POINTER_TOUCH,i[e.Gestures.POINTER_PEN]=n.pointerType==n.MSPOINTER_TYPE_PEN||n.pointerType==e.Gestures.POINTER_PEN,i[t]},getEvents:function(){return["pointerdown MSPointerDown","pointermove MSPointerMove","pointerup pointercancel MSPointerUp MSPointerCancel"]},reset:function(){this.pointers={}}},e.Gestures.utils={extend:function(e,t,n){for(var i in t)void 0!==e[i]&&n||(e[i]=t[i]);return e},hasParent:function(e,t){for(;e;){if(e==t)return!0;e=e.parentNode}return!1},getCenter:function(e){for(var t=[],n=[],i=0,r=e.length;r>i;i++)t.push(e[i].pageX),n.push(e[i].pageY);return{pageX:(Math.min.apply(Math,t)+Math.max.apply(Math,t))/2,pageY:(Math.min.apply(Math,n)+Math.max.apply(Math,n))/2}},getVelocity:function(e,t,n){return{x:Math.abs(t/e)||0,y:Math.abs(n/e)||0}},getAngle:function(e,t){var n=t.pageY-e.pageY,i=t.pageX-e.pageX;return 180*Math.atan2(n,i)/Math.PI},getDirection:function(t,n){var i=Math.abs(t.pageX-n.pageX),r=Math.abs(t.pageY-n.pageY);return i>=r?t.pageX-n.pageX>0?e.Gestures.DIRECTION_LEFT:e.Gestures.DIRECTION_RIGHT:t.pageY-n.pageY>0?e.Gestures.DIRECTION_UP:e.Gestures.DIRECTION_DOWN},getDistance:function(e,t){var n=t.pageX-e.pageX,i=t.pageY-e.pageY;return Math.sqrt(n*n+i*i)},getScale:function(e,t){return e.length>=2&&t.length>=2?this.getDistance(t[0],t[1])/this.getDistance(e[0],e[1]):1},getRotation:function(e,t){return e.length>=2&&t.length>=2?this.getAngle(t[1],t[0])-this.getAngle(e[1],e[0]):0},isVertical:function(t){return t==e.Gestures.DIRECTION_UP||t==e.Gestures.DIRECTION_DOWN},stopDefaultBrowserBehavior:function(e,t){e&&e.classList&&(e.classList.add(t),e.onselectstart=function(){return!1})}},e.Gestures.detection={gestures:[],current:null,previous:null,stopped:!1,startDetect:function(t,n){this.current||(this.stopped=!1,this.current={inst:t,startEvent:e.Gestures.utils.extend({},n),lastEvent:!1,name:""},this.detect(n))},detect:function(t){if(this.current&&!this.stopped){t=this.extendEventData(t);for(var n=this.current.inst.options,i=0,r=this.gestures.length;r>i;i++){var o=this.gestures[i];if(!this.stopped&&n[o.name]!==!1&&o.handler.call(o,t,this.current.inst)===!1){this.stopDetect();break}}return this.current&&(this.current.lastEvent=t),t.eventType==e.Gestures.EVENT_END&&!t.touches.length-1&&this.stopDetect(),t}},stopDetect:function(){this.previous=e.Gestures.utils.extend({},this.current),this.current=null,this.stopped=!0},extendEventData:function(t){var n=this.current.startEvent;if(n&&(t.touches.length!=n.touches.length||t.touches===n.touches)){n.touches=[];for(var i=0,r=t.touches.length;r>i;i++)n.touches.push(e.Gestures.utils.extend({},t.touches[i]))}var o=t.timeStamp-n.timeStamp,s=t.center.pageX-n.center.pageX,a=t.center.pageY-n.center.pageY,l=e.Gestures.utils.getVelocity(o,s,a);return e.Gestures.utils.extend(t,{deltaTime:o,deltaX:s,deltaY:a,velocityX:l.x,velocityY:l.y,distance:e.Gestures.utils.getDistance(n.center,t.center),angle:e.Gestures.utils.getAngle(n.center,t.center),direction:e.Gestures.utils.getDirection(n.center,t.center),scale:e.Gestures.utils.getScale(n.touches,t.touches),rotation:e.Gestures.utils.getRotation(n.touches,t.touches),startEvent:n}),t},register:function(t){var n=t.defaults||{};return void 0===n[t.name]&&(n[t.name]=!0),e.Gestures.utils.extend(e.Gestures.defaults,n,!0),t.index=t.index||1e3,this.gestures.push(t),this.gestures.sort(function(e,t){return e.index<t.index?-1:e.index>t.index?1:0}),this.gestures}},e.Gestures.gestures=e.Gestures.gestures||{},e.Gestures.gestures.Hold={name:"hold",index:10,defaults:{hold_timeout:500,hold_threshold:1},timer:null,handler:function(t,n){switch(t.eventType){case e.Gestures.EVENT_START:clearTimeout(this.timer),e.Gestures.detection.current.name=this.name,this.timer=setTimeout(function(){"hold"==e.Gestures.detection.current.name&&(e.tap.cancelClick(),n.trigger("hold",t))},n.options.hold_timeout);break;case e.Gestures.EVENT_MOVE:t.distance>n.options.hold_threshold&&clearTimeout(this.timer);break;case e.Gestures.EVENT_END:clearTimeout(this.timer)}}},e.Gestures.gestures.Tap={name:"tap",index:100,defaults:{tap_max_touchtime:250,tap_max_distance:10,tap_always:!0,doubletap_distance:20,doubletap_interval:300},handler:function(t,n){if(t.eventType==e.Gestures.EVENT_END&&"touchcancel"!=t.srcEvent.type){var i=e.Gestures.detection.previous,r=!1;if(t.deltaTime>n.options.tap_max_touchtime||t.distance>n.options.tap_max_distance)return;i&&"tap"==i.name&&t.timeStamp-i.lastEvent.timeStamp<n.options.doubletap_interval&&t.distance<n.options.doubletap_distance&&(n.trigger("doubletap",t),r=!0),(!r||n.options.tap_always)&&(e.Gestures.detection.current.name="tap",n.trigger("tap",t))}}},e.Gestures.gestures.Swipe={name:"swipe",index:40,defaults:{swipe_max_touches:1,swipe_velocity:.7},handler:function(t,n){if(t.eventType==e.Gestures.EVENT_END){if(n.options.swipe_max_touches>0&&t.touches.length>n.options.swipe_max_touches)return;(t.velocityX>n.options.swipe_velocity||t.velocityY>n.options.swipe_velocity)&&(n.trigger(this.name,t),n.trigger(this.name+t.direction,t))}}},e.Gestures.gestures.Drag={name:"drag",index:50,defaults:{drag_min_distance:10,correct_for_drag_min_distance:!0,drag_max_touches:1,drag_block_horizontal:!0,drag_block_vertical:!0,drag_lock_to_axis:!1,drag_lock_min_distance:25},triggered:!1,handler:function(t,n){if(e.Gestures.detection.current.name!=this.name&&this.triggered)return n.trigger(this.name+"end",t),void(this.triggered=!1);if(!(n.options.drag_max_touches>0&&t.touches.length>n.options.drag_max_touches))switch(t.eventType){case e.Gestures.EVENT_START:this.triggered=!1;break;case e.Gestures.EVENT_MOVE:if(t.distance<n.options.drag_min_distance&&e.Gestures.detection.current.name!=this.name)return;if(e.Gestures.detection.current.name!=this.name&&(e.Gestures.detection.current.name=this.name,n.options.correct_for_drag_min_distance)){var i=Math.abs(n.options.drag_min_distance/t.distance);e.Gestures.detection.current.startEvent.center.pageX+=t.deltaX*i,e.Gestures.detection.current.startEvent.center.pageY+=t.deltaY*i,t=e.Gestures.detection.extendEventData(t)}(e.Gestures.detection.current.lastEvent.drag_locked_to_axis||n.options.drag_lock_to_axis&&n.options.drag_lock_min_distance<=t.distance)&&(t.drag_locked_to_axis=!0);var r=e.Gestures.detection.current.lastEvent.direction;t.drag_locked_to_axis&&r!==t.direction&&(t.direction=e.Gestures.utils.isVertical(r)?t.deltaY<0?e.Gestures.DIRECTION_UP:e.Gestures.DIRECTION_DOWN:t.deltaX<0?e.Gestures.DIRECTION_LEFT:e.Gestures.DIRECTION_RIGHT),this.triggered||(n.trigger(this.name+"start",t),this.triggered=!0),n.trigger(this.name,t),n.trigger(this.name+t.direction,t),(n.options.drag_block_vertical&&e.Gestures.utils.isVertical(t.direction)||n.options.drag_block_horizontal&&!e.Gestures.utils.isVertical(t.direction))&&t.preventDefault();break;case e.Gestures.EVENT_END:this.triggered&&n.trigger(this.name+"end",t),this.triggered=!1}}},e.Gestures.gestures.Transform={name:"transform",index:45,defaults:{transform_min_scale:.01,transform_min_rotation:1,transform_always_block:!1},triggered:!1,handler:function(t,n){if(e.Gestures.detection.current.name!=this.name&&this.triggered)return n.trigger(this.name+"end",t),void(this.triggered=!1);if(!(t.touches.length<2))switch(n.options.transform_always_block&&t.preventDefault(),t.eventType){case e.Gestures.EVENT_START:this.triggered=!1;break;case e.Gestures.EVENT_MOVE:var i=Math.abs(1-t.scale),r=Math.abs(t.rotation);if(i<n.options.transform_min_scale&&r<n.options.transform_min_rotation)return;e.Gestures.detection.current.name=this.name,this.triggered||(n.trigger(this.name+"start",t),this.triggered=!0),n.trigger(this.name,t),r>n.options.transform_min_rotation&&n.trigger("rotate",t),i>n.options.transform_min_scale&&(n.trigger("pinch",t),n.trigger("pinch"+(t.scale<1?"in":"out"),t));break;case e.Gestures.EVENT_END:this.triggered&&n.trigger(this.name+"end",t),this.triggered=!1}}},e.Gestures.gestures.Touch={name:"touch",index:-1/0,defaults:{prevent_default:!1,prevent_mouseevents:!1},handler:function(t,n){return n.options.prevent_mouseevents&&t.pointerType==e.Gestures.POINTER_MOUSE?void t.stopDetect():(n.options.prevent_default&&t.preventDefault(),void(t.eventType==e.Gestures.EVENT_START&&n.trigger(this.name,t)))}},e.Gestures.gestures.Release={name:"release",index:1/0,handler:function(t,n){t.eventType==e.Gestures.EVENT_END&&n.trigger(this.name,t)}}}(window.ionic),function(e,t,n){function i(){n.Platform.isWebView()?t.addEventListener("deviceready",r,!1):r(),l&&e.removeEventListener("load",i,!1)}function r(){n.Platform.isReady=!0,n.Platform.detect();for(var e=0;e<h.length;e++)h[e]();h=[],n.trigger("platformready",{target:t}),n.requestAnimationFrame(function(){t.body.classList.add("platform-ready")})}var o="ios",s="android",a="windowsphone";n.Platform={navigator:e.navigator,isReady:!1,isFullScreen:!1,platforms:null,grade:null,ua:navigator.userAgent,ready:function(e){this.isReady?e():h.push(e)},detect:function(){n.Platform._checkPlatforms(),n.requestAnimationFrame(function(){for(var e=0;e<n.Platform.platforms.length;e++)t.body.classList.add("platform-"+n.Platform.platforms[e])})},setGrade:function(e){var i=this.grade;this.grade=e,n.requestAnimationFrame(function(){i&&t.body.classList.remove("grade-"+i),t.body.classList.add("grade-"+e)})},device:function(){return e.device||{}},_checkPlatforms:function(){this.platforms=[];var e="a";this.isWebView()?(this.platforms.push("webview"),this.platforms.push("cordova")):this.platforms.push("browser"),this.isIPad()&&this.platforms.push("ipad");var t=this.platform();if(t){this.platforms.push(t);var n=this.version();if(n){var i=n.toString();i.indexOf(".")>0?i=i.replace(".","_"):i+="_0",this.platforms.push(t+i.split("_")[0]),this.platforms.push(t+i),this.isAndroid()&&4.4>n?e=4>n?"c":"b":this.isWindowsPhone()&&(e="b")}}this.setGrade(e)},isWebView:function(){return!(!e.cordova&&!e.PhoneGap&&!e.phonegap)},isIPad:function(){return/iPad/i.test(n.Platform.navigator.platform)?!0:/iPad/i.test(this.ua)},isIOS:function(){return this.is(o)},isAndroid:function(){return this.is(s)},isWindowsPhone:function(){return this.is(a)},platform:function(){return null===c&&this.setPlatform(this.device().platform),c},setPlatform:function(e){c="undefined"!=typeof e&&null!==e&&e.length?e.toLowerCase():this.ua.indexOf("Android")>0?s:this.ua.indexOf("iPhone")>-1||this.ua.indexOf("iPad")>-1||this.ua.indexOf("iPod")>-1?o:this.ua.indexOf("Windows Phone")>-1?a:n.Platform.navigator.platform&&navigator.platform.toLowerCase().split(" ")[0]||""},version:function(){return null===u&&this.setVersion(this.device().version),u},setVersion:function(e){if("undefined"!=typeof e&&null!==e&&(e=e.split("."),e=parseFloat(e[0]+"."+(e.length>1?e[1]:0)),!isNaN(e)))return void(u=e);u=0;var t=this.platform(),n={android:/Android (\d+).(\d+)?/,ios:/OS (\d+)_(\d+)?/,windowsphone:/Windows Phone (\d+).(\d+)?/};n[t]&&(e=this.ua.match(n[t]),e&&e.length>2&&(u=parseFloat(e[1]+"."+e[2])))},is:function(e){if(e=e.toLowerCase(),this.platforms)for(var t=0;t<this.platforms.length;t++)if(this.platforms[t]===e)return!0;var n=this.platform();return n?n===e.toLowerCase():this.ua.toLowerCase().indexOf(e)>=0},exitApp:function(){this.ready(function(){navigator.app&&navigator.app.exitApp&&navigator.app.exitApp()})},showStatusBar:function(i){this._showStatusBar=i,this.ready(function(){n.requestAnimationFrame(function(){n.Platform._showStatusBar?(e.StatusBar&&e.StatusBar.show(),t.body.classList.remove("status-bar-hide")):(e.StatusBar&&e.StatusBar.hide(),t.body.classList.add("status-bar-hide"))})})},fullScreen:function(e,i){this.isFullScreen=e!==!1,n.DomUtil.ready(function(){n.requestAnimationFrame(function(){panes=t.getElementsByClassName("pane");for(var e=0;e<panes.length;e++)panes[e].style.height=panes[e].offsetHeight+"px";n.Platform.isFullScreen?t.body.classList.add("fullscreen"):t.body.classList.remove("fullscreen")}),n.Platform.showStatusBar(i===!0)})}};var l,c=null,u=null,h=[];"complete"===t.readyState?i():(l=!0,e.addEventListener("load",i,!1)),e.addEventListener("load",i,!1)}(this,document,ionic),function(e,t){"use strict";t.CSS={},function(){var n,i=["webkitTransform","transform","-webkit-transform","webkit-transform","-moz-transform","moz-transform","MozTransform","mozTransform","msTransform"];for(n=0;n<i.length;n++)if(void 0!==e.documentElement.style[i[n]]){t.CSS.TRANSFORM=i[n];break}for(i=["webkitTransition","mozTransition","msTransition","transition"],n=0;n<i.length;n++)if(void 0!==e.documentElement.style[i[n]]){t.CSS.TRANSITION=i[n];break}}(),"classList"in e.documentElement||!Object.defineProperty||"undefined"==typeof HTMLElement||Object.defineProperty(HTMLElement.prototype,"classList",{get:function(){function e(e){return function(){var n,i=t.className.split(/\s+/);for(n=0;n<arguments.length;n++)e(i,i.indexOf(arguments[n]),arguments[n]);t.className=i.join(" ")}}var t=this;return{add:e(function(e,t,n){~t||e.push(n)}),remove:e(function(e,t){~t&&e.splice(t,1)}),toggle:e(function(e,t,n){~t?e.splice(t,1):e.push(n)}),contains:function(e){return!!~t.className.split(/\s+/).indexOf(e)},item:function(e){return t.className.split(/\s+/)[e]||null}}}})}(document,ionic);var k,Y,X,H,z,F,W,q,U="touchmove",B=6,Z=50,j={click:i,mousedown:r,mouseup:o,mousemove:s,touchstart:a,touchend:l,touchcancel:u,touchmove:c,pointerdown:a,pointerup:l,pointercancel:u,pointermove:c,MSPointerDown:a,MSPointerUp:l,MSPointerCancel:u,MSPointerMove:c,focusin:p,focusout:m};ionic.tap={register:function(t){return k=t,e("click",!0,!0),e("mouseup"),e("mousedown"),window.navigator.pointerEnabled?(e("pointerdown"),e("pointerup"),e("pointcancel"),U="pointermove"):window.navigator.msPointerEnabled?(e("MSPointerDown"),e("MSPointerUp"),e("MSPointerCancel"),U="MSPointerMove"):(e("touchstart"),e("touchend"),e("touchcancel")),e("focusin"),e("focusout"),function(){for(var t in j)e(t,!1);k=null,Y=null,X=!1,z=!1,F=null}},ignoreScrollStart:function(e){return e.defaultPrevented||/^(file|range)$/i.test(e.target.type)||"true"==(e.target.dataset?e.target.dataset.preventScroll:e.target.getAttribute("data-prevent-scroll"))||!!/^(object|embed)$/i.test(e.target.tagName)||ionic.tap.isElementTapDisabled(e.target)},isTextInput:function(e){return!!e&&("TEXTAREA"==e.tagName||"true"===e.contentEditable||"INPUT"==e.tagName&&!/^(radio|checkbox|range|file|submit|reset)$/i.test(e.type))},isDateInput:function(e){return!!e&&"INPUT"==e.tagName&&/^(date|time|datetime-local|month|week)$/i.test(e.type)},isLabelWithTextInput:function(e){var t=T(e,!1);return!!t&&ionic.tap.isTextInput(E(t))},containsOrIsTextInput:function(e){return ionic.tap.isTextInput(e)||ionic.tap.isLabelWithTextInput(e)},cloneFocusedInput:function(e){ionic.tap.hasCheckedClone||(ionic.tap.hasCheckedClone=!0,ionic.requestAnimationFrame(function(){var t=e.querySelector(":focus");if(ionic.tap.isTextInput(t)){var n=t.parentElement.querySelector(".cloned-text-input");n||(n=document.createElement(t.tagName),n.placeholder=t.placeholder,n.type=t.type,n.value=t.value,n.style=t.style,n.className=t.className,n.classList.add("cloned-text-input"),n.readOnly=!0,t.isContentEditable&&(n.contentEditable=t.contentEditable,n.innerHTML=t.innerHTML),t.parentElement.insertBefore(n,t),t.style.top=t.offsetTop,t.classList.add("previous-input-focus"))}}))},hasCheckedClone:!1,removeClonedInputs:function(e){ionic.tap.hasCheckedClone=!1,ionic.requestAnimationFrame(function(){var t,n=e.querySelectorAll(".cloned-text-input"),i=e.querySelectorAll(".previous-input-focus");for(t=0;t<n.length;t++)n[t].parentElement.removeChild(n[t]);for(t=0;t<i.length;t++)i[t].classList.remove("previous-input-focus"),i[t].style.top="",i[t].focus()})},requiresNativeClick:function(e){return!e||e.disabled||/^(file|range)$/i.test(e.type)||/^(object|video)$/i.test(e.tagName)||ionic.tap.isLabelContainingFileInput(e)?!0:ionic.tap.isElementTapDisabled(e)},isLabelContainingFileInput:function(e){var t=T(e);if("LABEL"!==t.tagName)return!1;var n=t.querySelector("input[type=file]");return n&&n.disabled===!1?!0:!1},isElementTapDisabled:function(e){if(e&&1===e.nodeType)for(var t=e;t;){if("true"==(t.dataset?t.dataset.tapDisabled:t.getAttribute("data-tap-disabled")))return!0;t=t.parentElement}return!1},setTolerance:function(e,t){B=e,Z=t},cancelClick:function(){z=!0},pointerCoord:function(e){var t={x:0,y:0};if(e){var n=e.touches&&e.touches.length?e.touches:[e],i=e.changedTouches&&e.changedTouches[0]||n[0];i&&(t.x=i.clientX||i.pageX||0,t.y=i.clientY||i.pageY||0)}return t}},ionic.DomUtil.ready(function(){var e="undefined"!=typeof angular?angular:null;(!e||e&&!e.scenario)&&ionic.tap.register(document)}),function(e,t){"use strict";function n(){o={},t.requestAnimationFrame(r)}function i(){for(var e in o)o[e]&&(o[e].classList.add(l),s[e]=o[e]);o={}}function r(){for(var e in s)s[e]&&(s[e].classList.remove(l),delete s[e])}var o={},s={},a=0,l="activated";t.activator={start:function(e){var n=this;t.requestAnimationFrame(function(){if(!t.tap.requiresNativeClick(e.target)){for(var r,s=e.target,l=0;6>l&&(s&&1===s.nodeType);l++){if(r&&s.classList.contains("item")){r=s;break}if("A"==s.tagName||"BUTTON"==s.tagName||s.hasAttribute("ng-click")){r=s;
break}if(s.classList.contains("button")){r=s;break}if(s.classList.contains("pane")||"BODY"==s.tagName||"ION-CONTENT"==s.tagName)break;s=s.parentElement}r&&(o[a]=r,"touchstart"===e.type?n._activateTimeout=setTimeout(i,80):t.requestAnimationFrame(i),a=a>19?0:a+1)}})},end:function(){clearTimeout(this._activateTimeout),setTimeout(n,200)}}}(document,ionic),function(e){var t=["0","0","0"];e.Utils={arrayMove:function(e,t,n){if(n>=e.length)for(var i=n-e.length;i--+1;)e.push(void 0);return e.splice(n,0,e.splice(t,1)[0]),e},proxy:function(e,t){var n=Array.prototype.slice.call(arguments,2);return function(){return e.apply(t,n.concat(Array.prototype.slice.call(arguments)))}},debounce:function(e,t,n){var i,r,o,s,a;return function(){o=this,r=arguments,s=new Date;var l=function(){var c=new Date-s;t>c?i=setTimeout(l,t-c):(i=null,n||(a=e.apply(o,r)))},c=n&&!i;return i||(i=setTimeout(l,t)),c&&(a=e.apply(o,r)),a}},throttle:function(e,t,n){var i,r,o,s=null,a=0;n||(n={});var l=function(){a=n.leading===!1?0:Date.now(),s=null,o=e.apply(i,r)};return function(){var c=Date.now();a||n.leading!==!1||(a=c);var u=t-(c-a);return i=this,r=arguments,0>=u?(clearTimeout(s),s=null,a=c,o=e.apply(i,r)):s||n.trailing===!1||(s=setTimeout(l,u)),o}},inherit:function(t,n){var i,r=this;i=t&&t.hasOwnProperty("constructor")?t.constructor:function(){return r.apply(this,arguments)},e.extend(i,r,n);var o=function(){this.constructor=i};return o.prototype=r.prototype,i.prototype=new o,t&&e.extend(i.prototype,t),i.__super__=r.prototype,i},extend:function(e){for(var t=Array.prototype.slice.call(arguments,1),n=0;n<t.length;n++){var i=t[n];if(i)for(var r in i)e[r]=i[r]}return e},nextUid:function(){for(var e,n=t.length;n;){if(n--,e=t[n].charCodeAt(0),57==e)return t[n]="A",t.join("");if(90!=e)return t[n]=String.fromCharCode(e+1),t.join("");t[n]="0"}return t.unshift("0"),t.join("")}},e.inherit=e.Utils.inherit,e.extend=e.Utils.extend,e.throttle=e.Utils.throttle,e.proxy=e.Utils.proxy,e.debounce=e.Utils.debounce}(window.ionic);var $,K,J,Q,et=C(),tt=0,nt="keyboard-open",it="scroll";ionic.keyboard={isOpen:!1,height:null,landscape:!1,hide:function(){clearTimeout(J),clearTimeout(K),clearTimeout(Q),ionic.keyboard.isOpen=!1,ionic.trigger("resetScrollView",{target:$},!0),ionic.requestAnimationFrame(function(){document.body.classList.remove(nt)}),window.navigator.msPointerEnabled?document.removeEventListener("MSPointerMove",N):document.removeEventListener("touchmove",N),document.removeEventListener("keydown",M),A()&&cordova.plugins.Keyboard.close()},show:function(){A()&&cordova.plugins.Keyboard.show()}},ionic.Platform.ready(function(){x(),setTimeout(x,999),window.navigator.msPointerEnabled?document.addEventListener("MSPointerDown",S,!1):document.addEventListener("touchstart",S,!1)});var rt,ot={};ionic.viewport={orientation:function(){return window.innerWidth>window.innerHeight?90:0}},ionic.Platform.ready(function(){O(),window.addEventListener("orientationchange",function(){setTimeout(R,1e3)},!1)}),function(e){"use strict";e.views.View=function(){this.initialize.apply(this,arguments)},e.views.View.inherit=e.inherit,e.extend(e.views.View.prototype,{initialize:function(){}})}(window.ionic);var st={effect:{}};!function(e){var t=Date.now||function(){return+new Date},n=60,i=1e3,r={},o=1;st.effect.Animate={requestAnimationFrame:function(){var t=e.requestAnimationFrame||e.webkitRequestAnimationFrame||e.mozRequestAnimationFrame||e.oRequestAnimationFrame,n=!!t;if(t&&!/requestAnimationFrame\(\)\s*\{\s*\[native code\]\s*\}/i.test(t.toString())&&(n=!1),n)return function(e,n){t(e,n)};var i=60,r={},o=0,s=1,a=null,l=+new Date;return function(e){var t=s++;return r[t]=e,o++,null===a&&(a=setInterval(function(){var e=+new Date,t=r;r={},o=0;for(var n in t)t.hasOwnProperty(n)&&(t[n](e),l=e);e-l>2500&&(clearInterval(a),a=null)},1e3/i)),t}}(),stop:function(e){var t=null!=r[e];return t&&(r[e]=null),t},isRunning:function(e){return null!=r[e]},start:function(e,s,a,l,c,u){var h=t(),d=h,_=0,f=0,p=o++;if(u||(u=document.body),p%20===0){var m={};for(var g in r)m[g]=!0;r=m}var v=function(o){var m=o!==!0,g=t();if(!r[p]||s&&!s(p))return r[p]=null,void(a&&a(n-f/((g-h)/i),p,!1));if(m)for(var T=Math.round((g-d)/(i/n))-1,E=0;E<Math.min(T,4);E++)v(!0),f++;l&&(_=(g-h)/l,_>1&&(_=1));var S=c?c(_):_;e(S,g,m)!==!1&&1!==_||!m?m&&(d=g,st.effect.Animate.requestAnimationFrame(v,u)):(r[p]=null,a&&a(n-f/((g-h)/i),p,1===_||null==l))};return r[p]=!0,st.effect.Animate.requestAnimationFrame(v,u),p}}}(this);!function(e){var t=function(){},n=function(e){return Math.pow(e-1,3)+1},i=function(e){return(e/=.5)<1?.5*Math.pow(e,3):.5*(Math.pow(e-2,3)+2)};e.views.Scroll=e.views.View.inherit({initialize:function(n){var i=this;this.__container=n.el,this.__content=n.el.firstElementChild,setTimeout(function(){i.__container&&i.__content&&(i.__container.scrollTop=0,i.__content.scrollTop=0)}),this.options={scrollingX:!1,scrollbarX:!0,scrollingY:!0,scrollbarY:!0,startX:0,startY:0,wheelDampen:6,minScrollbarSizeX:5,minScrollbarSizeY:5,scrollbarsFade:!0,scrollbarFadeDelay:300,scrollbarResizeFadeDelay:1e3,animating:!0,animationDuration:250,bouncing:!0,locking:!0,paging:!1,snapping:!1,zooming:!1,minZoom:.5,maxZoom:3,speedMultiplier:1,deceleration:.97,scrollingComplete:t,penetrationDeceleration:.03,penetrationAcceleration:.08,scrollEventInterval:10,getContentWidth:function(){return Math.max(i.__content.scrollWidth,i.__content.offsetWidth)},getContentHeight:function(){return Math.max(i.__content.scrollHeight,i.__content.offsetHeight+2*i.__content.offsetTop)}};for(var r in n)this.options[r]=n[r];this.hintResize=e.debounce(function(){i.resize()},1e3,!0),this.onScroll=function(){e.scroll.isScrolling?(clearTimeout(i.scrollTimer),i.scrollTimer=setTimeout(i.setScrollStop,80)):setTimeout(i.setScrollStart,50)},this.setScrollStart=function(){e.scroll.isScrolling=Math.abs(e.scroll.lastTop-i.__scrollTop)>1,clearTimeout(i.scrollTimer),i.scrollTimer=setTimeout(i.setScrollStop,80)},this.setScrollStop=function(){e.scroll.isScrolling=!1,e.scroll.lastTop=i.__scrollTop},this.triggerScrollEvent=e.throttle(function(){i.onScroll(),e.trigger("scroll",{scrollTop:i.__scrollTop,scrollLeft:i.__scrollLeft,target:i.__container})},this.options.scrollEventInterval),this.triggerScrollEndEvent=function(){e.trigger("scrollend",{scrollTop:i.__scrollTop,scrollLeft:i.__scrollLeft,target:i.__container})},this.__scrollLeft=this.options.startX,this.__scrollTop=this.options.startY,this.__callback=this.getRenderFn(),this.__initEventHandlers(),this.__createScrollbars()},run:function(){this.resize(),this.__fadeScrollbars("out",this.options.scrollbarResizeFadeDelay)},__isSingleTouch:!1,__isTracking:!1,__didDecelerationComplete:!1,__isGesturing:!1,__isDragging:!1,__isDecelerating:!1,__isAnimating:!1,__clientLeft:0,__clientTop:0,__clientWidth:0,__clientHeight:0,__contentWidth:0,__contentHeight:0,__snapWidth:100,__snapHeight:100,__refreshHeight:null,__refreshActive:!1,__refreshActivate:null,__refreshDeactivate:null,__refreshStart:null,__zoomLevel:1,__scrollLeft:0,__scrollTop:0,__maxScrollLeft:0,__maxScrollTop:0,__scheduledLeft:0,__scheduledTop:0,__scheduledZoom:0,__lastTouchLeft:null,__lastTouchTop:null,__lastTouchMove:null,__positions:null,__minDecelerationScrollLeft:null,__minDecelerationScrollTop:null,__maxDecelerationScrollLeft:null,__maxDecelerationScrollTop:null,__decelerationVelocityX:null,__decelerationVelocityY:null,__transformProperty:null,__perspectiveProperty:null,__indicatorX:null,__indicatorY:null,__scrollbarFadeTimeout:null,__didWaitForSize:null,__sizerTimeout:null,__initEventHandlers:function(){function t(e){return e.touches&&e.touches.length?e.touches:[{pageX:e.pageX,pageY:e.pageY}]}var n=this,i=this.__container;if(n.scrollChildIntoView=function(t){var r;if(!n.isScrolledIntoView){if(e.Platform.isIOS()||e.Platform.isFullScreen){r=i.getBoundingClientRect().bottom;var o=t.detail.viewportHeight-r,s=Math.max(0,t.detail.keyboardHeight-o);i.style.height=i.clientHeight-s+"px",i.style.overflow="visible",n.resize()}n.isScrolledIntoView=!0}if(t.detail.isElementUnderKeyboard){var a;a=e.Platform.isAndroid()&&!e.Platform.isFullScreen?e.Platform.version()<4.4?500:350:80,e.scroll.isScrolling=!0,setTimeout(function(){var o=.5*i.clientHeight;r=i.getBoundingClientRect().bottom;var s=t.detail.elementTop-r,a=s+o;a>0&&(e.tap.cloneFocusedInput(i,n),n.scrollBy(0,a,!0),n.onScroll())},a)}t.stopPropagation()},n.resetScrollView=function(){n.isScrolledIntoView&&(n.isScrolledIntoView=!1,i.style.height="",i.style.overflow="",n.resize(),e.scroll.isScrolling=!1)},i.addEventListener("scrollChildIntoView",n.scrollChildIntoView),i.addEventListener("resetScrollView",n.resetScrollView),n.touchStart=function(i){if(n.startCoordinates=e.tap.pointerCoord(i),!e.tap.ignoreScrollStart(i)){if(n.__isDown=!0,e.tap.containsOrIsTextInput(i.target)||"SELECT"===i.target.tagName)return void(n.__hasStarted=!1);n.__isSelectable=!0,n.__enableScrollY=!0,n.__hasStarted=!0,n.doTouchStart(t(i),i.timeStamp),i.preventDefault()}},n.touchMove=function(r){if(!(!n.__isDown||r.defaultPrevented||"TEXTAREA"===r.target.tagName&&r.target.parentElement.querySelector(":focus"))){if(!n.__hasStarted&&(e.tap.containsOrIsTextInput(r.target)||"SELECT"===r.target.tagName))return n.__hasStarted=!0,n.doTouchStart(t(r),r.timeStamp),void r.preventDefault();if(n.startCoordinates){var o=e.tap.pointerCoord(r);n.__isSelectable&&e.tap.isTextInput(r.target)&&Math.abs(n.startCoordinates.x-o.x)>20&&(n.__enableScrollY=!1,n.__isSelectable=!0),n.__enableScrollY&&Math.abs(n.startCoordinates.y-o.y)>10&&(n.__isSelectable=!1,e.tap.cloneFocusedInput(i,n))}n.doTouchMove(t(r),r.timeStamp,r.scale),n.__isDown=!0}},n.touchEnd=function(t){n.__isDown&&(n.doTouchEnd(t.timeStamp),n.__isDown=!1,n.__hasStarted=!1,n.__isSelectable=!0,n.__enableScrollY=!0,n.__isDragging||n.__isDecelerating||n.__isAnimating||e.tap.removeClonedInputs(i,n))},"ontouchstart"in window)i.addEventListener("touchstart",n.touchStart,!1),document.addEventListener("touchmove",n.touchMove,!1),document.addEventListener("touchend",n.touchEnd,!1),document.addEventListener("touchcancel",n.touchEnd,!1);else if(window.navigator.pointerEnabled)i.addEventListener("pointerdown",n.touchStart,!1),document.addEventListener("pointermove",n.touchMove,!1),document.addEventListener("pointerup",n.touchEnd,!1),document.addEventListener("pointercancel",n.touchEnd,!1);else if(window.navigator.msPointerEnabled)i.addEventListener("MSPointerDown",n.touchStart,!1),document.addEventListener("MSPointerMove",n.touchMove,!1),document.addEventListener("MSPointerUp",n.touchEnd,!1),document.addEventListener("MSPointerCancel",n.touchEnd,!1);else{var r=!1;n.mouseDown=function(i){e.tap.ignoreScrollStart(i)||"SELECT"===i.target.tagName||(n.doTouchStart(t(i),i.timeStamp),e.tap.isTextInput(i.target)||i.preventDefault(),r=!0)},n.mouseMove=function(e){r&&!e.defaultPrevented&&(n.doTouchMove(t(e),e.timeStamp),r=!0)},n.mouseUp=function(e){r&&(n.doTouchEnd(e.timeStamp),r=!1)},n.mouseWheel=e.animationFrameThrottle(function(t){var i=e.DomUtil.getParentOrSelfWithClass(t.target,"ionic-scroll");i===n.__container&&(n.hintResize(),n.scrollBy(t.wheelDeltaX/n.options.wheelDampen,-t.wheelDeltaY/n.options.wheelDampen),n.__fadeScrollbars("in"),clearTimeout(n.__wheelHideBarTimeout),n.__wheelHideBarTimeout=setTimeout(function(){n.__fadeScrollbars("out")},100))}),i.addEventListener("mousedown",n.mouseDown,!1),document.addEventListener("mousemove",n.mouseMove,!1),document.addEventListener("mouseup",n.mouseUp,!1),document.addEventListener("mousewheel",n.mouseWheel,!1)}},__cleanup:function(){var t=this.__container,n=this;t.removeEventListener("touchstart",n.touchStart),document.removeEventListener("touchmove",n.touchMove),document.removeEventListener("touchend",n.touchEnd),document.removeEventListener("touchcancel",n.touchCancel),t.removeEventListener("pointerdown",n.touchStart),document.removeEventListener("pointermove",n.touchMove),document.removeEventListener("pointerup",n.touchEnd),document.removeEventListener("pointercancel",n.touchEnd),t.removeEventListener("MSPointerDown",n.touchStart),document.removeEventListener("MSPointerMove",n.touchMove),document.removeEventListener("MSPointerUp",n.touchEnd),document.removeEventListener("MSPointerCancel",n.touchEnd),t.removeEventListener("mousedown",n.mouseDown),document.removeEventListener("mousemove",n.mouseMove),document.removeEventListener("mouseup",n.mouseUp),document.removeEventListener("mousewheel",n.mouseWheel),t.removeEventListener("scrollChildIntoView",n.scrollChildIntoView),t.removeEventListener("resetScrollView",n.resetScrollView),e.tap.removeClonedInputs(t,n),delete this.__container,delete this.__content,delete this.__indicatorX,delete this.__indicatorY,delete this.options.el,this.__callback=this.scrollChildIntoView=this.resetScrollView=angular.noop,this.mouseMove=this.mouseDown=this.mouseUp=this.mouseWheel=this.touchStart=this.touchMove=this.touchEnd=this.touchCancel=angular.noop,this.resize=this.scrollTo=this.zoomTo=this.__scrollingComplete=angular.noop,t=null},__createScrollbar:function(e){var t=document.createElement("div"),n=document.createElement("div");return n.className="scroll-bar-indicator scroll-bar-fade-out",t.className="h"==e?"scroll-bar scroll-bar-h":"scroll-bar scroll-bar-v",t.appendChild(n),t},__createScrollbars:function(){var e,t;this.options.scrollingX&&(e={el:this.__createScrollbar("h"),sizeRatio:1},e.indicator=e.el.children[0],this.options.scrollbarX&&this.__container.appendChild(e.el),this.__indicatorX=e),this.options.scrollingY&&(t={el:this.__createScrollbar("v"),sizeRatio:1},t.indicator=t.el.children[0],this.options.scrollbarY&&this.__container.appendChild(t.el),this.__indicatorY=t)},__resizeScrollbars:function(){var e=this;if(e.__indicatorX){var t=Math.max(Math.round(e.__clientWidth*e.__clientWidth/e.__contentWidth),20);t>e.__contentWidth&&(t=0),e.__indicatorX.size=t,e.__indicatorX.minScale=this.options.minScrollbarSizeX/t,e.__indicatorX.indicator.style.width=t+"px",e.__indicatorX.maxPos=e.__clientWidth-t,e.__indicatorX.sizeRatio=e.__maxScrollLeft?e.__indicatorX.maxPos/e.__maxScrollLeft:1}if(e.__indicatorY){var n=Math.max(Math.round(e.__clientHeight*e.__clientHeight/e.__contentHeight),20);n>e.__contentHeight&&(n=0),e.__indicatorY.size=n,e.__indicatorY.minScale=this.options.minScrollbarSizeY/n,e.__indicatorY.maxPos=e.__clientHeight-n,e.__indicatorY.indicator.style.height=n+"px",e.__indicatorY.sizeRatio=e.__maxScrollTop?e.__indicatorY.maxPos/e.__maxScrollTop:1}},__repositionScrollbars:function(){var e,t,n,i,r,o=this,s=0,a=0;o.__indicatorX&&(o.__indicatorY&&(s=10),i=Math.round(o.__indicatorX.sizeRatio*o.__scrollLeft)||0,t=o.__scrollLeft-(o.__maxScrollLeft-s),o.__scrollLeft<0?(widthScale=Math.max(o.__indicatorX.minScale,(o.__indicatorX.size-Math.abs(o.__scrollLeft))/o.__indicatorX.size),i=0,o.__indicatorX.indicator.style[o.__transformOriginProperty]="left center"):t>0?(widthScale=Math.max(o.__indicatorX.minScale,(o.__indicatorX.size-t)/o.__indicatorX.size),i=o.__indicatorX.maxPos-s,o.__indicatorX.indicator.style[o.__transformOriginProperty]="right center"):(i=Math.min(o.__maxScrollLeft,Math.max(0,i)),widthScale=1),o.__indicatorX.indicator.style[o.__transformProperty]="translate3d("+i+"px, 0, 0) scaleX("+widthScale+")"),o.__indicatorY&&(r=Math.round(o.__indicatorY.sizeRatio*o.__scrollTop)||0,o.__indicatorX&&(a=10),n=o.__scrollTop-(o.__maxScrollTop-a),o.__scrollTop<0?(e=Math.max(o.__indicatorY.minScale,(o.__indicatorY.size-Math.abs(o.__scrollTop))/o.__indicatorY.size),r=0,o.__indicatorY.indicator.style[o.__transformOriginProperty]="center top"):n>0?(e=Math.max(o.__indicatorY.minScale,(o.__indicatorY.size-n)/o.__indicatorY.size),r=o.__indicatorY.maxPos-a,o.__indicatorY.indicator.style[o.__transformOriginProperty]="center bottom"):(r=Math.min(o.__maxScrollTop,Math.max(0,r)),e=1),o.__indicatorY.indicator.style[o.__transformProperty]="translate3d(0,"+r+"px, 0) scaleY("+e+")")},__fadeScrollbars:function(e,t){var n=this;if(this.options.scrollbarsFade){var i="scroll-bar-fade-out";n.options.scrollbarsFade===!0&&(clearTimeout(n.__scrollbarFadeTimeout),"in"==e?(n.__indicatorX&&n.__indicatorX.indicator.classList.remove(i),n.__indicatorY&&n.__indicatorY.indicator.classList.remove(i)):n.__scrollbarFadeTimeout=setTimeout(function(){n.__indicatorX&&n.__indicatorX.indicator.classList.add(i),n.__indicatorY&&n.__indicatorY.indicator.classList.add(i)},t||n.options.scrollbarFadeDelay))}},__scrollingComplete:function(){var t=this;t.options.scrollingComplete(),e.tap.removeClonedInputs(t.__container,t),t.__fadeScrollbars("out")},resize:function(){this.__container&&this.options&&this.setDimensions(this.__container.clientWidth,this.__container.clientHeight,this.options.getContentWidth(),this.options.getContentHeight())},getRenderFn:function(){var e,t=this,n=this.__content,i=document.documentElement.style;"MozAppearance"in i?e="gecko":"WebkitAppearance"in i?e="webkit":"string"==typeof navigator.cpuClass&&(e="trident");var r,o={trident:"ms",gecko:"Moz",webkit:"Webkit",presto:"O"}[e],s=document.createElement("div"),a=o+"Perspective",l=o+"Transform",c=o+"TransformOrigin";return t.__perspectiveProperty=l,t.__transformProperty=l,t.__transformOriginProperty=c,s.style[a]!==r?function(e,i,r,o){n.style[l]="translate3d("+-e+"px,"+-i+"px,0) scale("+r+")",t.__repositionScrollbars(),o||t.triggerScrollEvent()}:s.style[l]!==r?function(e,i,r,o){n.style[l]="translate("+-e+"px,"+-i+"px) scale("+r+")",t.__repositionScrollbars(),o||t.triggerScrollEvent()}:function(e,i,r,o){n.style.marginLeft=e?-e/r+"px":"",n.style.marginTop=i?-i/r+"px":"",n.style.zoom=r||"",t.__repositionScrollbars(),o||t.triggerScrollEvent()}},setDimensions:function(e,t,n,i){var r=this;e===+e&&(r.__clientWidth=e),t===+t&&(r.__clientHeight=t),n===+n&&(r.__contentWidth=n),i===+i&&(r.__contentHeight=i),r.__computeScrollMax(),r.__resizeScrollbars(),r.scrollTo(r.__scrollLeft,r.__scrollTop,!0,null,!0)},setPosition:function(e,t){var n=this;n.__clientLeft=e||0,n.__clientTop=t||0},setSnapSize:function(e,t){var n=this;n.__snapWidth=e,n.__snapHeight=t},activatePullToRefresh:function(t,n,i,r,o,s,a){var l=this;l.__refreshHeight=t,l.__refreshActivate=function(){e.requestAnimationFrame(n)},l.__refreshDeactivate=function(){e.requestAnimationFrame(i)},l.__refreshStart=function(){e.requestAnimationFrame(r)},l.__refreshShow=function(){e.requestAnimationFrame(o)},l.__refreshHide=function(){e.requestAnimationFrame(s)},l.__refreshTail=function(){e.requestAnimationFrame(a)},l.__refreshTailTime=100,l.__minSpinTime=600},triggerPullToRefresh:function(){this.__publish(this.__scrollLeft,-this.__refreshHeight,this.__zoomLevel,!0);var e=new Date;self.refreshStartTime=e.getTime(),this.__refreshStart&&this.__refreshStart()},finishPullToRefresh:function(){var e=this,t=new Date,n=0;e.refreshStartTime+e.__minSpinTime>t.getTime()&&(n=e.refreshStartTime+e.__minSpinTime-t.getTime()),setTimeout(function(){e.__refreshTail&&e.__refreshTail(),setTimeout(function(){e.__refreshActive=!1,e.__refreshDeactivate&&e.__refreshDeactivate(),e.scrollTo(e.__scrollLeft,e.__scrollTop,!0)},e.__refreshTailTime)},n)},getValues:function(){var e=this;return{left:e.__scrollLeft,top:e.__scrollTop,zoom:e.__zoomLevel}},getScrollMax:function(){var e=this;return{left:e.__maxScrollLeft,top:e.__maxScrollTop}},zoomTo:function(e,t,n,i){var r=this;if(!r.options.zooming)throw new Error("Zooming is not enabled!");r.__isDecelerating&&(st.effect.Animate.stop(r.__isDecelerating),r.__isDecelerating=!1);var o=r.__zoomLevel;null==n&&(n=r.__clientWidth/2),null==i&&(i=r.__clientHeight/2),e=Math.max(Math.min(e,r.options.maxZoom),r.options.minZoom),r.__computeScrollMax(e);var s=(n+r.__scrollLeft)*e/o-n,a=(i+r.__scrollTop)*e/o-i;s>r.__maxScrollLeft?s=r.__maxScrollLeft:0>s&&(s=0),a>r.__maxScrollTop?a=r.__maxScrollTop:0>a&&(a=0),r.__publish(s,a,e,t)},zoomBy:function(e,t,n,i){var r=this;r.zoomTo(r.__zoomLevel*e,t,n,i)},scrollTo:function(e,t,n,i,r){var o=this;if(o.__isDecelerating&&(st.effect.Animate.stop(o.__isDecelerating),o.__isDecelerating=!1),null!=i&&i!==o.__zoomLevel){if(!o.options.zooming)throw new Error("Zooming is not enabled!");e*=i,t*=i,o.__computeScrollMax(i)}else i=o.__zoomLevel;o.options.scrollingX?o.options.paging?e=Math.round(e/o.__clientWidth)*o.__clientWidth:o.options.snapping&&(e=Math.round(e/o.__snapWidth)*o.__snapWidth):e=o.__scrollLeft,o.options.scrollingY?o.options.paging?t=Math.round(t/o.__clientHeight)*o.__clientHeight:o.options.snapping&&(t=Math.round(t/o.__snapHeight)*o.__snapHeight):t=o.__scrollTop,e=Math.max(Math.min(o.__maxScrollLeft,e),0),t=Math.max(Math.min(o.__maxScrollTop,t),0),e===o.__scrollLeft&&t===o.__scrollTop&&(n=!1),o.__publish(e,t,i,n,r)},scrollBy:function(e,t,n){var i=this,r=i.__isAnimating?i.__scheduledLeft:i.__scrollLeft,o=i.__isAnimating?i.__scheduledTop:i.__scrollTop;i.scrollTo(r+(e||0),o+(t||0),n)},doMouseZoom:function(e,t,n,i){var r=this,o=e>0?.97:1.03;return r.zoomTo(r.__zoomLevel*o,!1,n-r.__clientLeft,i-r.__clientTop)},doTouchStart:function(e,t){this.hintResize(),t instanceof Date&&(t=t.valueOf()),"number"!=typeof t&&(t=Date.now());var n=this;n.__interruptedAnimation=!0,n.__isDecelerating&&(st.effect.Animate.stop(n.__isDecelerating),n.__isDecelerating=!1,n.__interruptedAnimation=!0),n.__isAnimating&&(st.effect.Animate.stop(n.__isAnimating),n.__isAnimating=!1,n.__interruptedAnimation=!0);var i,r,o=1===e.length;o?(i=e[0].pageX,r=e[0].pageY):(i=Math.abs(e[0].pageX+e[1].pageX)/2,r=Math.abs(e[0].pageY+e[1].pageY)/2),n.__initialTouchLeft=i,n.__initialTouchTop=r,n.__initialTouches=e,n.__zoomLevelStart=n.__zoomLevel,n.__lastTouchLeft=i,n.__lastTouchTop=r,n.__lastTouchMove=t,n.__lastScale=1,n.__enableScrollX=!o&&n.options.scrollingX,n.__enableScrollY=!o&&n.options.scrollingY,n.__isTracking=!0,n.__didDecelerationComplete=!1,n.__isDragging=!o,n.__isSingleTouch=o,n.__positions=[]},doTouchMove:function(e,t,n){t instanceof Date&&(t=t.valueOf()),"number"!=typeof t&&(t=Date.now());var i=this;if(i.__isTracking){var r,o;2===e.length?(r=Math.abs(e[0].pageX+e[1].pageX)/2,o=Math.abs(e[0].pageY+e[1].pageY)/2,!n&&i.options.zooming&&(n=i.__getScale(i.__initialTouches,e))):(r=e[0].pageX,o=e[0].pageY);var s=i.__positions;if(i.__isDragging){var a=r-i.__lastTouchLeft,l=o-i.__lastTouchTop,c=i.__scrollLeft,u=i.__scrollTop,h=i.__zoomLevel;if(null!=n&&i.options.zooming){var d=h;if(h=h/i.__lastScale*n,h=Math.max(Math.min(h,i.options.maxZoom),i.options.minZoom),d!==h){var _=r-i.__clientLeft,f=o-i.__clientTop;c=(_+c)*h/d-_,u=(f+u)*h/d-f,i.__computeScrollMax(h)}}if(i.__enableScrollX){c-=a*this.options.speedMultiplier;var p=i.__maxScrollLeft;(c>p||0>c)&&(i.options.bouncing?c+=a/2*this.options.speedMultiplier:c=c>p?p:0)}if(i.__enableScrollY){u-=l*this.options.speedMultiplier;var m=i.__maxScrollTop;u>m||0>u?i.options.bouncing||i.__refreshHeight&&0>u?(u+=l/2*this.options.speedMultiplier,i.__enableScrollX||null==i.__refreshHeight||(0>u?(i.__refreshHidden=!1,i.__refreshShow()):(i.__refreshHide(),i.__refreshHidden=!0),!i.__refreshActive&&u<=-i.__refreshHeight?(i.__refreshActive=!0,i.__refreshActivate&&i.__refreshActivate()):i.__refreshActive&&u>-i.__refreshHeight&&(i.__refreshActive=!1,i.__refreshDeactivate&&i.__refreshDeactivate()))):u=u>m?m:0:i.__refreshHeight&&!i.__refreshHidden&&(i.__refreshHide(),i.__refreshHidden=!0)}s.length>60&&s.splice(0,30),s.push(c,u,t),i.__publish(c,u,h)}else{var g=i.options.locking?3:0,v=5,T=Math.abs(r-i.__initialTouchLeft),E=Math.abs(o-i.__initialTouchTop);i.__enableScrollX=i.options.scrollingX&&T>=g,i.__enableScrollY=i.options.scrollingY&&E>=g,s.push(i.__scrollLeft,i.__scrollTop,t),i.__isDragging=(i.__enableScrollX||i.__enableScrollY)&&(T>=v||E>=v),i.__isDragging&&(i.__interruptedAnimation=!1,i.__fadeScrollbars("in"))}i.__lastTouchLeft=r,i.__lastTouchTop=o,i.__lastTouchMove=t,i.__lastScale=n}},doTouchEnd:function(t){t instanceof Date&&(t=t.valueOf()),"number"!=typeof t&&(t=Date.now());var n=this;if(n.__isTracking){if(n.__isTracking=!1,n.__isDragging)if(n.__isDragging=!1,n.__isSingleTouch&&n.options.animating&&t-n.__lastTouchMove<=100){for(var i=n.__positions,r=i.length-1,o=r,s=r;s>0&&i[s]>n.__lastTouchMove-100;s-=3)o=s;if(o!==r){var a=i[r]-i[o],l=n.__scrollLeft-i[o-2],c=n.__scrollTop-i[o-1];n.__decelerationVelocityX=l/a*(1e3/60),n.__decelerationVelocityY=c/a*(1e3/60);var u=n.options.paging||n.options.snapping?4:1;(Math.abs(n.__decelerationVelocityX)>u||Math.abs(n.__decelerationVelocityY)>u)&&(n.__refreshActive||n.__startDeceleration(t))}else n.__scrollingComplete()}else t-n.__lastTouchMove>100&&n.__scrollingComplete();if(!n.__isDecelerating)if(n.__refreshActive&&n.__refreshStart){n.__publish(n.__scrollLeft,-n.__refreshHeight,n.__zoomLevel,!0);var h=new Date;n.refreshStartTime=h.getTime(),n.__refreshStart&&n.__refreshStart(),e.Platform.isAndroid()||n.__startDeceleration()}else(n.__interruptedAnimation||n.__isDragging)&&n.__scrollingComplete(),n.scrollTo(n.__scrollLeft,n.__scrollTop,!0,n.__zoomLevel),n.__refreshActive&&(n.__refreshActive=!1,n.__refreshDeactivate&&n.__refreshDeactivate());n.__positions.length=0}},__publish:function(e,t,r,o,s){var a=this,l=a.__isAnimating;if(l&&(st.effect.Animate.stop(l),a.__isAnimating=!1),o&&a.options.animating){a.__scheduledLeft=e,a.__scheduledTop=t,a.__scheduledZoom=r;var c=a.__scrollLeft,u=a.__scrollTop,h=a.__zoomLevel,d=e-c,_=t-u,f=r-h,p=function(e,t,n){n&&(a.__scrollLeft=c+d*e,a.__scrollTop=u+_*e,a.__zoomLevel=h+f*e,a.__callback&&a.__callback(a.__scrollLeft,a.__scrollTop,a.__zoomLevel,s))},m=function(e){return a.__isAnimating===e},g=function(e,t,n){t===a.__isAnimating&&(a.__isAnimating=!1),(a.__didDecelerationComplete||n)&&a.__scrollingComplete(),a.options.zooming&&a.__computeScrollMax()};a.__isAnimating=st.effect.Animate.start(p,m,g,a.options.animationDuration,l?n:i)}else a.__scheduledLeft=a.__scrollLeft=e,a.__scheduledTop=a.__scrollTop=t,a.__scheduledZoom=a.__zoomLevel=r,a.__callback&&a.__callback(e,t,r,s),a.options.zooming&&a.__computeScrollMax()},__computeScrollMax:function(e){var t=this;null==e&&(e=t.__zoomLevel),t.__maxScrollLeft=Math.max(t.__contentWidth*e-t.__clientWidth,0),t.__maxScrollTop=Math.max(t.__contentHeight*e-t.__clientHeight,0),t.__didWaitForSize||t.__maxScrollLeft||t.__maxScrollTop||(t.__didWaitForSize=!0,t.__waitForSize())},__waitForSize:function(){var e=this;clearTimeout(e.__sizerTimeout);var t=function(){e.resize(),e.options.scrollingX&&!e.__maxScrollLeft||e.options.scrollingY&&!e.__maxScrollTop};t(),e.__sizerTimeout=setTimeout(t,1e3)},__startDeceleration:function(){var e=this;if(e.options.paging){var t=Math.max(Math.min(e.__scrollLeft,e.__maxScrollLeft),0),n=Math.max(Math.min(e.__scrollTop,e.__maxScrollTop),0),i=e.__clientWidth,r=e.__clientHeight;e.__minDecelerationScrollLeft=Math.floor(t/i)*i,e.__minDecelerationScrollTop=Math.floor(n/r)*r,e.__maxDecelerationScrollLeft=Math.ceil(t/i)*i,e.__maxDecelerationScrollTop=Math.ceil(n/r)*r}else e.__minDecelerationScrollLeft=0,e.__minDecelerationScrollTop=0,e.__maxDecelerationScrollLeft=e.__maxScrollLeft,e.__maxDecelerationScrollTop=e.__maxScrollTop,e.__refreshActive&&(e.__minDecelerationScrollTop=-1*e.__refreshHeight);var o=function(t,n,i){e.__stepThroughDeceleration(i)};e.__minVelocityToKeepDecelerating=e.options.snapping?4:.1;var s=function(){var t=Math.abs(e.__decelerationVelocityX)>=e.__minVelocityToKeepDecelerating||Math.abs(e.__decelerationVelocityY)>=e.__minVelocityToKeepDecelerating;return t||(e.__didDecelerationComplete=!0,e.options.bouncing&&!e.__refreshActive&&e.scrollTo(Math.min(Math.max(e.__scrollLeft,0),e.__maxScrollLeft),Math.min(Math.max(e.__scrollTop,0),e.__maxScrollTop),e.__refreshActive)),t},a=function(){e.__isDecelerating=!1,e.__didDecelerationComplete&&e.__scrollingComplete(),e.options.paging&&e.scrollTo(e.__scrollLeft,e.__scrollTop,e.options.snapping)};e.__isDecelerating=st.effect.Animate.start(o,s,a)},__stepThroughDeceleration:function(e){var t=this,n=t.__scrollLeft+t.__decelerationVelocityX,i=t.__scrollTop+t.__decelerationVelocityY;if(!t.options.bouncing){var r=Math.max(Math.min(t.__maxDecelerationScrollLeft,n),t.__minDecelerationScrollLeft);r!==n&&(n=r,t.__decelerationVelocityX=0);var o=Math.max(Math.min(t.__maxDecelerationScrollTop,i),t.__minDecelerationScrollTop);o!==i&&(i=o,t.__decelerationVelocityY=0)}if(e?t.__publish(n,i,t.__zoomLevel):(t.__scrollLeft=n,t.__scrollTop=i),!t.options.paging){var s=t.options.deceleration;t.__decelerationVelocityX*=s,t.__decelerationVelocityY*=s}if(t.options.bouncing){var a=0,l=0,c=t.options.penetrationDeceleration,u=t.options.penetrationAcceleration;if(n<t.__minDecelerationScrollLeft?a=t.__minDecelerationScrollLeft-n:n>t.__maxDecelerationScrollLeft&&(a=t.__maxDecelerationScrollLeft-n),i<t.__minDecelerationScrollTop?l=t.__minDecelerationScrollTop-i:i>t.__maxDecelerationScrollTop&&(l=t.__maxDecelerationScrollTop-i),0!==a){var h=a*t.__decelerationVelocityX<=t.__minDecelerationScrollLeft;h&&(t.__decelerationVelocityX+=a*c);var d=Math.abs(t.__decelerationVelocityX)<=t.__minVelocityToKeepDecelerating;(!h||d)&&(t.__decelerationVelocityX=a*u)}if(0!==l){var _=l*t.__decelerationVelocityY<=t.__minDecelerationScrollTop;_&&(t.__decelerationVelocityY+=l*c);var f=Math.abs(t.__decelerationVelocityY)<=t.__minVelocityToKeepDecelerating;(!_||f)&&(t.__decelerationVelocityY=l*u)}}},__getDistance:function(e,t){var n=t.pageX-e.pageX,i=t.pageY-e.pageY;return Math.sqrt(n*n+i*i)},__getScale:function(e,t){var n=this;return e.length>=2&&t.length>=2?n.__getDistance(t[0],t[1])/n.__getDistance(e[0],e[1]):1}}),e.scroll={isScrolling:!1,lastTop:0}}(ionic),function(e){"use strict";e.views.HeaderBar=e.views.View.inherit({initialize:function(t){this.el=t.el,e.extend(this,{alignTitle:"center"},t),this.align()},align:function(t){t||(t=this.alignTitle);var n=this.el.querySelector(".title");if(n){var i=this;e.requestAnimationFrame(function(){var r,o,s,a=i.el.childNodes,l=0,c=0,u=!1;for(r=0;r<a.length;r++)if(o=a[r],o.tagName&&"h1"==o.tagName.toLowerCase())u=!0;else{if(s=null,3==o.nodeType){var h=e.DomUtil.getTextBounds(o);h&&(s=h.width)}else 1==o.nodeType&&(s=o.offsetWidth);s&&(u?c+=s:l+=s)}var d=Math.max(l,c)+10;n.style.left=n.style.right="","center"==t?(d>10&&(n.style.left=d+"px",n.style.right=d+"px"),n.offsetWidth<n.scrollWidth&&c>0&&(n.style.right=c+5+"px")):"left"==t?(n.classList.add("title-left"),l>0&&(n.style.left=l+15+"px")):"right"==t&&(n.classList.add("title-right"),c>0&&(n.style.right=c+15+"px"))})}}})}(ionic),function(e){"use strict";var t="item",n="item-content",i="item-sliding",r="item-options",o="item-placeholder",s="item-reordering",a="item-reorder",l=function(){};l.prototype={start:function(){},drag:function(){},end:function(){},isSameItem:function(){return!1}};var c=function(e){this.dragThresholdX=e.dragThresholdX||10,this.el=e.el,this.canSwipe=e.canSwipe};c.prototype=new l,c.prototype.start=function(o){var s,a,l,c;this.canSwipe()&&(s=o.target.classList.contains(n)?o.target:o.target.classList.contains(t)?o.target.querySelector("."+n):e.DomUtil.getParentWithClass(o.target,n),s&&(s.classList.remove(i),l=parseFloat(s.style[e.CSS.TRANSFORM].replace("translate3d(","").split(",")[0])||0,a=s.parentNode.querySelector("."+r),a&&(a.classList.remove("invisible"),c=a.offsetWidth,this._currentDrag={buttons:a,buttonsWidth:c,content:s,startOffsetX:l})))},c.prototype.isSameItem=function(e){return e._lastDrag&&this._currentDrag?this._currentDrag.content==e._lastDrag.content:!1},c.prototype.clean=function(){var t=this._lastDrag;t&&(t.content.style[e.CSS.TRANSITION]="",t.content.style[e.CSS.TRANSFORM]="",e.requestAnimationFrame(function(){setTimeout(function(){t.buttons&&t.buttons.classList.add("invisible")},250)}))},c.prototype.drag=e.animationFrameThrottle(function(t){var n;if(this._currentDrag&&(!this._isDragging&&(Math.abs(t.gesture.deltaX)>this.dragThresholdX||Math.abs(this._currentDrag.startOffsetX)>0)&&(this._isDragging=!0),this._isDragging)){n=this._currentDrag.buttonsWidth;var i=Math.min(0,this._currentDrag.startOffsetX+t.gesture.deltaX);-n>i&&(i=Math.min(-n,-n+.4*(t.gesture.deltaX+n))),this._currentDrag.content.style[e.CSS.TRANSFORM]="translate3d("+i+"px, 0, 0)",this._currentDrag.content.style[e.CSS.TRANSITION]="none"
}}),c.prototype.end=function(t,n){var i=this;if(!this._currentDrag)return void(n&&n());var r=-this._currentDrag.buttonsWidth;t.gesture.deltaX>-(this._currentDrag.buttonsWidth/2)&&("left"==t.gesture.direction&&Math.abs(t.gesture.velocityX)<.3?r=0:"right"==t.gesture.direction&&(r=0)),e.requestAnimationFrame(function(){if(0===r){i._currentDrag.content.style[e.CSS.TRANSFORM]="";var t=i._currentDrag.buttons;setTimeout(function(){t&&t.classList.add("invisible")},250)}else i._currentDrag.content.style[e.CSS.TRANSFORM]="translate3d("+r+"px, 0, 0)";i._currentDrag.content.style[e.CSS.TRANSITION]="",i._lastDrag=i._currentDrag,i._currentDrag=null,n&&n()})};var u=function(e){if(this.dragThresholdY=e.dragThresholdY||0,this.onReorder=e.onReorder,this.listEl=e.listEl,this.el=e.el,this.scrollEl=e.scrollEl,this.scrollView=e.scrollView,this.listElTrueTop=0,this.listEl.offsetParent){var t=this.listEl;do this.listElTrueTop+=t.offsetTop,t=t.offsetParent;while(t)}};u.prototype=new l,u.prototype._moveElement=function(t){var n=t.gesture.center.pageY+this.scrollView.getValues().top-this._currentDrag.elementHeight/2-this.listElTrueTop;this.el.style[e.CSS.TRANSFORM]="translate3d(0, "+n+"px, 0)"},u.prototype.start=function(t){var n=e.DomUtil.getChildIndex(this.el,this.el.nodeName.toLowerCase()),i=this.el.scrollHeight,r=this.el.cloneNode(!0);r.classList.add(o),this.el.parentNode.insertBefore(r,this.el),this.el.classList.add(s),this._currentDrag={elementHeight:i,startIndex:n,placeholder:r,scrollHeight:scroll,list:r.parentNode},this._moveElement(t)},u.prototype.drag=e.animationFrameThrottle(function(t){var n=this;if(this._currentDrag){var i=0,r=t.gesture.center.pageY,o=this.listElTrueTop;if(this.scrollView){var s=this.scrollView.__container;i=this.scrollView.getValues().top;var a=s.offsetTop,l=a-r+this._currentDrag.elementHeight/2,c=r+this._currentDrag.elementHeight/2-a-s.offsetHeight;t.gesture.deltaY<0&&l>0&&i>0&&(this.scrollView.scrollBy(null,-l),e.requestAnimationFrame(function(){n.drag(t)})),t.gesture.deltaY>0&&c>0&&i<this.scrollView.getScrollMax().top&&(this.scrollView.scrollBy(null,c),e.requestAnimationFrame(function(){n.drag(t)}))}!this._isDragging&&Math.abs(t.gesture.deltaY)>this.dragThresholdY&&(this._isDragging=!0),this._isDragging&&(this._moveElement(t),this._currentDrag.currentY=i+r-o)}}),u.prototype._getReorderIndex=function(){for(var e,t=this,n=(this._currentDrag.placeholder,Array.prototype.slice.call(this._currentDrag.placeholder.parentNode.children).filter(function(e){return e.nodeName===t.el.nodeName&&e!==t.el})),i=this._currentDrag.currentY,r=0,o=n.length;o>r;r++)if(e=n[r],r===o-1){if(i>e.offsetTop)return r}else if(0===r){if(i<e.offsetTop+e.offsetHeight)return r}else if(i>e.offsetTop-e.offsetHeight/2&&i<e.offsetTop+e.offsetHeight)return r;return this._currentDrag.startIndex},u.prototype.end=function(t,n){if(!this._currentDrag)return void(n&&n());var i=this._currentDrag.placeholder,r=this._getReorderIndex();this.el.classList.remove(s),this.el.style[e.CSS.TRANSFORM]="",i.parentNode.insertBefore(this.el,i),i.parentNode.removeChild(i),this.onReorder&&this.onReorder(this.el,this._currentDrag.startIndex,r),this._currentDrag=null,n&&n()},e.views.ListView=e.views.View.inherit({initialize:function(t){var n=this;t=e.extend({onReorder:function(){},virtualRemoveThreshold:-200,virtualAddThreshold:200,canSwipe:function(){return!0}},t),e.extend(this,t),!this.itemHeight&&this.listEl&&(this.itemHeight=this.listEl.children[0]&&parseInt(this.listEl.children[0].style.height,10)),this.onRefresh=t.onRefresh||function(){},this.onRefreshOpening=t.onRefreshOpening||function(){},this.onRefreshHolding=t.onRefreshHolding||function(){},window.ionic.onGesture("release",function(e){n._handleEndDrag(e)},this.el),window.ionic.onGesture("drag",function(e){n._handleDrag(e)},this.el),this._initDrag()},stopRefreshing:function(){var e=this.el.querySelector(".list-refresher");e.style.height="0px"},didScroll:function(e){if(this.isVirtual){var t=this.itemHeight,n=(this.listEl.children.length,e.target.scrollHeight),i=this.el.parentNode.offsetHeight,r=(e.scrollTop,Math.max(0,e.scrollTop+this.virtualRemoveThreshold)),o=Math.min(n,Math.abs(e.scrollTop)+i+this.virtualAddThreshold),s=Math.floor((o-r)/t),a=parseInt(Math.abs(r/t),10),l=parseInt(Math.abs(o/t),10);this._virtualItemsToRemove=Array.prototype.slice.call(this.listEl.children,0,a);{Array.prototype.slice.call(this.listEl.children,a,a+s)}this.renderViewport&&this.renderViewport(r,o,a,l)}},didStopScrolling:function(){if(this.isVirtual)for(var e=0;e<this._virtualItemsToRemove.length;e++){{this._virtualItemsToRemove[e]}this.didHideItem&&this.didHideItem(e)}},clearDragEffects:function(){this._lastDragOp&&(this._lastDragOp.clean&&this._lastDragOp.clean(),this._lastDragOp=null)},_initDrag:function(){this._lastDragOp=this._dragOp,this._dragOp=null},_getItem:function(e){for(;e;){if(e.classList&&e.classList.contains(t))return e;e=e.parentNode}return null},_startDrag:function(t){var n=this;this._isDragging=!1;var i,r=this._lastDragOp;!e.DomUtil.getParentOrSelfWithClass(t.target,a)||"up"!=t.gesture.direction&&"down"!=t.gesture.direction?!this._didDragUpOrDown&&("left"==t.gesture.direction||"right"==t.gesture.direction)&&Math.abs(t.gesture.deltaX)>5&&(i=this._getItem(t.target),i&&i.querySelector(".item-options")&&(this._dragOp=new c({el:this.el,canSwipe:this.canSwipe}),this._dragOp.start(t),t.preventDefault())):(i=this._getItem(t.target),i&&(this._dragOp=new u({listEl:this.el,el:i,scrollEl:this.scrollEl,scrollView:this.scrollView,onReorder:function(e,t,i){n.onReorder&&n.onReorder(e,t,i)}}),this._dragOp.start(t),t.preventDefault())),r&&this._dragOp&&!this._dragOp.isSameItem(r)&&t.defaultPrevented&&r.clean&&r.clean()},_handleEndDrag:function(e){var t=this;this._didDragUpOrDown=!1,this._dragOp&&this._dragOp.end(e,function(){t._initDrag()})},_handleDrag:function(e){Math.abs(e.gesture.deltaY)>5&&(this._didDragUpOrDown=!0),this.isDragging||this._dragOp||this._startDrag(e),this._dragOp&&(e.gesture.srcEvent.preventDefault(),this._dragOp.drag(e))}})}(ionic),function(e){"use strict";e.views.Modal=e.views.View.inherit({initialize:function(t){t=e.extend({focusFirstInput:!1,unfocusOnHide:!0,focusFirstDelay:600,backdropClickToClose:!0,hardwareBackButtonClose:!0},t),e.extend(this,t),this.el=t.el},show:function(){var e=this;e.focusFirstInput&&window.setTimeout(function(){var t=e.el.querySelector("input, textarea");t&&t.focus&&t.focus()},e.focusFirstDelay)},hide:function(){if(this.unfocusOnHide){var e=this.el.querySelectorAll("input, textarea");window.setTimeout(function(){for(var t=0;t<e.length;t++)e[t].blur&&e[t].blur()})}}})}(ionic),function(e){"use strict";e.views.SideMenu=e.views.View.inherit({initialize:function(e){this.el=e.el,this.isEnabled="undefined"==typeof e.isEnabled?!0:e.isEnabled,this.setWidth(e.width)},getFullWidth:function(){return this.width},setWidth:function(e){this.width=e,this.el.style.width=e+"px"},setIsEnabled:function(e){this.isEnabled=e},bringUp:function(){"0"!==this.el.style.zIndex&&(this.el.style.zIndex="0")},pushDown:function(){"-1"!==this.el.style.zIndex&&(this.el.style.zIndex="-1")}}),e.views.SideMenuContent=e.views.View.inherit({initialize:function(t){e.extend(this,{animationClass:"menu-animated",onDrag:function(){},onEndDrag:function(){}},t),e.onGesture("drag",e.proxy(this._onDrag,this),this.el),e.onGesture("release",e.proxy(this._onEndDrag,this),this.el)},_onDrag:function(e){this.onDrag&&this.onDrag(e)},_onEndDrag:function(e){this.onEndDrag&&this.onEndDrag(e)},disableAnimation:function(){this.el.classList.remove(this.animationClass)},enableAnimation:function(){this.el.classList.add(this.animationClass)},getTranslateX:function(){return parseFloat(this.el.style[e.CSS.TRANSFORM].replace("translate3d(","").split(",")[0])},setTranslateX:e.animationFrameThrottle(function(t){this.el.style[e.CSS.TRANSFORM]="translate3d("+t+"px, 0, 0)"})})}(ionic),function(e){"use strict";e.views.Slider=e.views.View.inherit({initialize:function(e){function t(){m=E.children,T=m.length,m.length<2&&(e.continuous=!1),f.transitions&&e.continuous&&m.length<3&&(E.appendChild(m[0].cloneNode(!0)),E.appendChild(E.children[1].cloneNode(!0)),m=E.children),g=new Array(m.length),v=p.offsetWidth||p.getBoundingClientRect().width,E.style.width=m.length*v+"px";for(var t=m.length;t--;){var n=m[t];n.style.width=v+"px",n.setAttribute("data-index",t),f.transitions&&(n.style.left=t*-v+"px",s(t,S>t?-v:t>S?v:0,0))}e.continuous&&f.transitions&&(s(r(S-1),-v,0),s(r(S+1),v,0)),f.transitions||(E.style.left=S*-v+"px"),p.style.visibility="visible",e.slidesChanged&&e.slidesChanged()}function n(){e.continuous?o(S-1):S&&o(S-1)}function i(){e.continuous?o(S+1):S<m.length-1&&o(S+1)}function r(e){return(m.length+e%m.length)%m.length}function o(t,n){if(S!=t){if(f.transitions){var i=Math.abs(S-t)/(S-t);if(e.continuous){var o=i;i=-g[r(t)]/v,i!==o&&(t=-i*m.length+t)}for(var a=Math.abs(S-t)-1;a--;)s(r((t>S?t:S)-a-1),v*i,0);t=r(t),s(S,v*i,n||w),s(t,0,n||w),e.continuous&&s(r(t-i),-(v*i),0)}else t=r(t),l(S*-v,t*-v,n||w);S=t,_(e.callback&&e.callback(S,m[S]))}}function s(e,t,n){a(e,t,n),g[e]=t}function a(e,t,n){var i=m[e],r=i&&i.style;r&&(r.webkitTransitionDuration=r.MozTransitionDuration=r.msTransitionDuration=r.OTransitionDuration=r.transitionDuration=n+"ms",r.webkitTransform="translate("+t+"px,0)translateZ(0)",r.msTransform=r.MozTransform=r.OTransform="translateX("+t+"px)")}function l(t,n,i){if(!i)return void(E.style.left=n+"px");var r=+new Date,o=setInterval(function(){var s=+new Date-r;return s>i?(E.style.left=n+"px",D&&c(),e.transitionEnd&&e.transitionEnd.call(event,S,m[S]),void clearInterval(o)):void(E.style.left=(n-t)*(Math.floor(s/i*100)/100)+t+"px")},4)}function c(){b=setTimeout(i,D)}function u(){D=e.auto||0,clearTimeout(b)}var h=this,d=function(){},_=function(e){setTimeout(e||d,0)},f={addEventListener:!!window.addEventListener,touch:"ontouchstart"in window||window.DocumentTouch&&document instanceof DocumentTouch,transitions:function(e){var t=["transitionProperty","WebkitTransition","MozTransition","OTransition","msTransition"];for(var n in t)if(void 0!==e.style[t[n]])return!0;return!1}(document.createElement("swipe"))},p=e.el;if(p){var m,g,v,T,E=p.children[0];e=e||{};var S=parseInt(e.startSlide,10)||0,w=e.speed||300;e.continuous=void 0!==e.continuous?e.continuous:!0;var b,y,D=e.auto||0,L={},x={},M={handleEvent:function(n){switch(("mousedown"==n.type||"mouseup"==n.type||"mousemove"==n.type)&&(n.touches=[{pageX:n.pageX,pageY:n.pageY}]),n.type){case"mousedown":this.start(n);break;case"touchstart":this.start(n);break;case"touchmove":this.touchmove(n);break;case"mousemove":this.touchmove(n);break;case"touchend":_(this.end(n));break;case"mouseup":_(this.end(n));break;case"webkitTransitionEnd":case"msTransitionEnd":case"oTransitionEnd":case"otransitionend":case"transitionend":_(this.transitionEnd(n));break;case"resize":_(t)}e.stopPropagation&&n.stopPropagation()},start:function(e){var t=e.touches[0];L={x:t.pageX,y:t.pageY,time:+new Date},y=void 0,x={},f.touch?(E.addEventListener("touchmove",this,!1),E.addEventListener("touchend",this,!1)):(E.addEventListener("mousemove",this,!1),E.addEventListener("mouseup",this,!1),document.addEventListener("mouseup",this,!1))},touchmove:function(t){if(!(t.touches.length>1||t.scale&&1!==t.scale||h.slideIsDisabled)){e.disableScroll&&t.preventDefault();var n=t.touches[0];x={x:n.pageX-L.x,y:n.pageY-L.y},"undefined"==typeof y&&(y=!!(y||Math.abs(x.x)<Math.abs(x.y))),y||(t.preventDefault(),u(),e.continuous?(a(r(S-1),x.x+g[r(S-1)],0),a(S,x.x+g[S],0),a(r(S+1),x.x+g[r(S+1)],0)):(x.x=x.x/(!S&&x.x>0||S==m.length-1&&x.x<0?Math.abs(x.x)/v+1:1),a(S-1,x.x+g[S-1],0),a(S,x.x+g[S],0),a(S+1,x.x+g[S+1],0)))}},end:function(){var t=+new Date-L.time,n=Number(t)<250&&Math.abs(x.x)>20||Math.abs(x.x)>v/2,i=!S&&x.x>0||S==m.length-1&&x.x<0;e.continuous&&(i=!1);var o=x.x<0;y||(n&&!i?(o?(e.continuous?(s(r(S-1),-v,0),s(r(S+2),v,0)):s(S-1,-v,0),s(S,g[S]-v,w),s(r(S+1),g[r(S+1)]-v,w),S=r(S+1)):(e.continuous?(s(r(S+1),v,0),s(r(S-2),-v,0)):s(S+1,v,0),s(S,g[S]+v,w),s(r(S-1),g[r(S-1)]+v,w),S=r(S-1)),e.callback&&e.callback(S,m[S])):e.continuous?(s(r(S-1),-v,w),s(S,0,w),s(r(S+1),v,w)):(s(S-1,-v,w),s(S,0,w),s(S+1,v,w))),f.touch?(E.removeEventListener("touchmove",M,!1),E.removeEventListener("touchend",M,!1)):(E.removeEventListener("mousemove",M,!1),E.removeEventListener("mouseup",M,!1),document.removeEventListener("mouseup",M,!1))},transitionEnd:function(t){parseInt(t.target.getAttribute("data-index"),10)==S&&(D&&c(),e.transitionEnd&&e.transitionEnd.call(t,S,m[S]))}};this.update=function(){setTimeout(t)},this.setup=function(){t()},this.enableSlide=function(e){return arguments.length&&(this.slideIsDisabled=!e),!this.slideIsDisabled},this.slide=function(e,t){u(),o(e,t)},this.prev=this.previous=function(){u(),n()},this.next=function(){u(),i()},this.stop=function(){u()},this.start=function(){c()},this.currentIndex=function(){return S},this.slidesCount=function(){return T},this.kill=function(){u(),E.style.width="",E.style.left="";for(var e=m.length;e--;){var t=m[e];t.style.width="",t.style.left="",f.transitions&&a(e,0,0)}f.addEventListener?(E.removeEventListener("touchstart",M,!1),E.removeEventListener("webkitTransitionEnd",M,!1),E.removeEventListener("msTransitionEnd",M,!1),E.removeEventListener("oTransitionEnd",M,!1),E.removeEventListener("otransitionend",M,!1),E.removeEventListener("transitionend",M,!1),window.removeEventListener("resize",M,!1)):window.onresize=null},this.load=function(){t(),D&&c(),f.addEventListener?(f.touch?E.addEventListener("touchstart",M,!1):E.addEventListener("mousedown",M,!1),f.transitions&&(E.addEventListener("webkitTransitionEnd",M,!1),E.addEventListener("msTransitionEnd",M,!1),E.addEventListener("oTransitionEnd",M,!1),E.addEventListener("otransitionend",M,!1),E.addEventListener("transitionend",M,!1)),window.addEventListener("resize",M,!1)):window.onresize=function(){t()}}}}})}(ionic),function(e){"use strict";e.views.Toggle=e.views.View.inherit({initialize:function(t){var n=this;this.el=t.el,this.checkbox=t.checkbox,this.track=t.track,this.handle=t.handle,this.openPercent=-1,this.onChange=t.onChange||function(){},this.triggerThreshold=t.triggerThreshold||20,this.dragStartHandler=function(e){n.dragStart(e)},this.dragHandler=function(e){n.drag(e)},this.holdHandler=function(e){n.hold(e)},this.releaseHandler=function(e){n.release(e)},this.dragStartGesture=e.onGesture("dragstart",this.dragStartHandler,this.el),this.dragGesture=e.onGesture("drag",this.dragHandler,this.el),this.dragHoldGesture=e.onGesture("hold",this.holdHandler,this.el),this.dragReleaseGesture=e.onGesture("release",this.releaseHandler,this.el)},destroy:function(){e.offGesture(this.dragStartGesture,"dragstart",this.dragStartGesture),e.offGesture(this.dragGesture,"drag",this.dragGesture),e.offGesture(this.dragHoldGesture,"hold",this.holdHandler),e.offGesture(this.dragReleaseGesture,"release",this.releaseHandler)},tap:function(){"disabled"!==this.el.getAttribute("disabled")&&this.val(!this.checkbox.checked)},dragStart:function(e){this.checkbox.disabled||(this._dragInfo={width:this.el.offsetWidth,left:this.el.offsetLeft,right:this.el.offsetLeft+this.el.offsetWidth,triggerX:this.el.offsetWidth/2,initialState:this.checkbox.checked},e.gesture.srcEvent.preventDefault(),this.hold(e))},drag:function(t){var n=this;this._dragInfo&&(t.gesture.srcEvent.preventDefault(),e.requestAnimationFrame(function(){if(n._dragInfo){var e=(n.track.offsetLeft+n.handle.offsetWidth/2,n.track.offsetLeft+n.track.offsetWidth-n.handle.offsetWidth/2,t.gesture.deltaX,t.gesture.touches[0].pageX-n._dragInfo.left),i=n._dragInfo.width-n.triggerThreshold;n._dragInfo.initialState?e<n.triggerThreshold?n.setOpenPercent(0):e>n._dragInfo.triggerX&&n.setOpenPercent(100):e<n._dragInfo.triggerX?n.setOpenPercent(0):e>i&&n.setOpenPercent(100)}}))},endDrag:function(){this._dragInfo=null},hold:function(){this.el.classList.add("dragging")},release:function(e){this.el.classList.remove("dragging"),this.endDrag(e)},setOpenPercent:function(t){if(this.openPercent<0||t<this.openPercent-3||t>this.openPercent+3)if(this.openPercent=t,0===t)this.val(!1);else if(100===t)this.val(!0);else{var n=Math.round(t/100*this.track.offsetWidth-this.handle.offsetWidth);n=1>n?0:n,this.handle.style[e.CSS.TRANSFORM]="translate3d("+n+"px,0,0)"}},val:function(t){return(t===!0||t===!1)&&(""!==this.handle.style[e.CSS.TRANSFORM]&&(this.handle.style[e.CSS.TRANSFORM]=""),this.checkbox.checked=t,this.openPercent=t?100:0,this.onChange&&this.onChange()),this.checkbox.checked}})}(ionic)}();
},{}],"/home/ubuntu/workspace/bower_components/ngstorage/ngStorage.min.js":[function(require,module,exports){
/*! ngStorage 0.3.0 | Copyright (c) 2013 Gias Kay Lee | MIT License */"use strict";!function(){function a(a){return["$rootScope","$window",function(b,c){for(var d,e,f,g=c[a]||(console.warn("This browser does not support Web Storage!"),{}),h={$default:function(a){for(var b in a)angular.isDefined(h[b])||(h[b]=a[b]);return h},$reset:function(a){for(var b in h)"$"===b[0]||delete h[b];return h.$default(a)}},i=0;i<g.length;i++)(f=g.key(i))&&"ngStorage-"===f.slice(0,10)&&(h[f.slice(10)]=angular.fromJson(g.getItem(f)));return d=angular.copy(h),b.$watch(function(){e||(e=setTimeout(function(){if(e=null,!angular.equals(h,d)){angular.forEach(h,function(a,b){angular.isDefined(a)&&"$"!==b[0]&&g.setItem("ngStorage-"+b,angular.toJson(a)),delete d[b]});for(var a in d)g.removeItem("ngStorage-"+a);d=angular.copy(h)}},100))}),"localStorage"===a&&c.addEventListener&&c.addEventListener("storage",function(a){"ngStorage-"===a.key.slice(0,10)&&(a.newValue?h[a.key.slice(10)]=angular.fromJson(a.newValue):delete h[a.key.slice(10)],d=angular.copy(h),b.$apply())}),h}]}angular.module("ngStorage",[]).factory("$localStorage",a("localStorage")).factory("$sessionStorage",a("sessionStorage"))}();
},{}],"/home/ubuntu/workspace/client/scripts/players/controllers/dashboard.js":[function(require,module,exports){
'use strict';
var controllername = 'dashboard';

var db = require('app/db.js')('users');

module.exports = function(app) {
  /*jshint validthis: true */

  var deps = ['$scope', '$localStorage', 'main.players.gameServices', '$ionicModal'];

  function controller($scope, $localStorage, gameServices, $ionicModal) {
    var vm = this;
    /* .. */
    vm.errors = { gamename: { } };
    /* logged in user data */
    vm.userData = {};
    /* new game request data */
    vm.newGame = {};
    /* */
    vm.modal = {};

    db.dataFy($localStorage.userData, vm.userData);

    var activate = function() {

      vm.newGame = function() {
        gameServices.newGame(vm.newGame).then(
          function(res) {
            vm.errors.gamename = { };
          }, function(err) {
            vm.errors.gamename.taken = true;
          }
        );
      };

    };

    activate();
  }

  controller.$inject = deps;
  app.controller(app.name + '.' + controllername, controller);
};
},{"app/db.js":"/home/ubuntu/workspace/node_modules/app/db.js"}],"/home/ubuntu/workspace/client/scripts/players/controllers/findAction.js":[function(require,module,exports){
'use strict';
var controllername = 'findAction';

var db={ users: require('app/db')('users') };

/* Handle login redirects - new user screens, updates etc.. */

module.exports = function(app) {
    /*jshint validthis: true */

    var deps = ['$state', 'main.players.userServices', '$localStorage'];

    function controller($state, userServices, $localStorage) {
        var vm = this;
        var user = $localStorage.userData;
        var activate = function() {
            if (!!user.firstScreen) {
                user.firstScreen = true;
                db.put(user.username, user, function(err,res) {
                    $state.go('dashboard');
                });
            }
            
            $state.go('dashboard');
            
        };
        activate();
    }

    controller.$inject = deps;
    app.controller(app.name + '.' + controllername, controller);
};
},{"app/db":"/home/ubuntu/workspace/node_modules/app/db.js"}],"/home/ubuntu/workspace/client/scripts/players/controllers/games.js":[function(require,module,exports){
'use strict';
var controllername = 'games';

module.exports = function(app) {
    /*jshint validthis: true */

    var deps = [];

    function controller() {
        var vm = this;
        vm.message = 'Hello World';
        
        var activate = function() {
            vm.games=[{name:'hello'},{name:'world'}];
        };
        
        activate();
    }

    controller.$inject = deps;
    app.controller(app.name + '.' + controllername, controller);
};
},{}],"/home/ubuntu/workspace/client/scripts/players/controllers/index.js":[function(require,module,exports){
'use strict';

module.exports = function(app) {
    // inject:start
    require('./dashboard')(app);
    require('./findAction')(app);
    require('./games')(app);
    require('./login')(app);
    require('./settings')(app);
    // inject:end
};
},{"./dashboard":"/home/ubuntu/workspace/client/scripts/players/controllers/dashboard.js","./findAction":"/home/ubuntu/workspace/client/scripts/players/controllers/findAction.js","./games":"/home/ubuntu/workspace/client/scripts/players/controllers/games.js","./login":"/home/ubuntu/workspace/client/scripts/players/controllers/login.js","./settings":"/home/ubuntu/workspace/client/scripts/players/controllers/settings.js"}],"/home/ubuntu/workspace/client/scripts/players/controllers/login.js":[function(require,module,exports){
'use strict';
var controllername = 'login';

module.exports = function(app) {
    /*jshint validthis: true */

    var deps = ['$state','$ionicActionSheet', 'main.players.userServices'];

    function controller($state, $ionicActionSheet, userServices) {
        var vm = this;
        
        vm.form = { signUp: { }, signIn: { } };//reflective
        vm.errors = { username: {}, password: {} };//..
        
        vm.errors.clear = function() {
            vm.errors.username = {};
        };

        vm.signUp = function() {
            userServices.signUp(vm.form.signUp).then(function(got) {
                vm.errors.username = { };
                $state.go('findAction');
            }, function() {
                vm.errors.username.duplicate=true;
            });
        };

        vm.signIn = function() {
            userServices.signIn(vm.form.signIn).then(function(got) {
                vm.errors.password = {};
                $state.go('findAction');
            }, function() {
                vm.errors.password.invalid=true;
            });
        };

        var activate = function() {

        };

        activate();
    }

    controller.$inject = deps;
    app.controller(app.name + '.' + controllername, controller);
};

},{}],"/home/ubuntu/workspace/client/scripts/players/controllers/settings.js":[function(require,module,exports){
'use strict';
var controllername = 'settings';

module.exports = function(app) {
    /*jshint validthis: true */

    var deps = [];

    function controller() {
        var vm = this;
        vm.message = 'Hello World';
        var activate = function() {

        };
        activate();
    }

    controller.$inject = deps;
    app.controller(app.name + '.' + controllername, controller);
};
},{}],"/home/ubuntu/workspace/client/scripts/players/index.js":[function(require,module,exports){
'use strict';
require('angular-ui-router');
require('angular-ionic');
require('famous-angular');

var modulename = 'players';

module.exports = function(namespace) {

    var fullname = namespace + '.' + modulename;

    var angular = require('angular');
    /*..*/
    require('ngStorage');

    var app = angular.module(fullname, ['ui.router', 'ionic', 'famous.angular', 'ngStorage']);

    // inject:folders start
    require('./controllers')(app);
    require('./services')(app);

    // inject:folders end

    app.config(['$stateProvider', '$urlRouterProvider', function($stateProvider, $urlRouterProvider) {
        $urlRouterProvider.otherwise('/');
        
        $stateProvider
        .state('login', {
            url : '/login',
            template: require('./views/login.html')
       })
       .state('findAction', {
           url: '/findAction',
           controller: 'main.players.findAction'
       })
       .state('dashboard', {
           url: '/dashboard',
           template: require('./views/dashboard.html'),
           controller: 'main.players.dashboard'
       });

    }]);
    
    
    return app;
};
},{"./controllers":"/home/ubuntu/workspace/client/scripts/players/controllers/index.js","./services":"/home/ubuntu/workspace/client/scripts/players/services/index.js","./views/dashboard.html":"/home/ubuntu/workspace/client/scripts/players/views/dashboard.html","./views/login.html":"/home/ubuntu/workspace/client/scripts/players/views/login.html","angular":"/home/ubuntu/workspace/bower_components/angular/angular.min.js","angular-ionic":"/home/ubuntu/workspace/bower_components/ionic/release/js/ionic-angular.min.js","angular-ui-router":"/home/ubuntu/workspace/bower_components/angular-ui-router/release/angular-ui-router.min.js","famous-angular":"/home/ubuntu/workspace/bower_components/famous-angular/dist/famous-angular.min.js","ngStorage":"/home/ubuntu/workspace/bower_components/ngstorage/ngStorage.min.js"}],"/home/ubuntu/workspace/client/scripts/players/services/gameServices.js":[function(require,module,exports){
'use strict';
var servicename = 'gameServices';

var db = {
    games: require('app/db.js')('games'),
    users: require('app/db.js')('users')
};

module.exports = function(app) {

    var dependencies = [];

    function service() {
        var isInitialized = false;
        var init = function() {
            isInitialized = true;
        };
        return {
            // initialization
            init: init,

            $get: ['$q',
                function($q) {
                    var newGame = function(opts) {
                        var d = $q.defer();
                        var data = db.games.dataCrumb(opts);
                        
                        db.games.get(data.gamename,function(err,res) {
                            
                            if (res) {
                                return d.reject({reason:'Sorry, that name is taken for now.'});
                            }

                            db.games.put(data,data.gamename, function(err,res) {
                                d.resolve({ got:res });
                            });

                        });
                     
                        return d.promise;
                    };

                    return {
                        isInitialized: isInitialized,
                        newGame: newGame
                    };
                }
            ]
        };

    }
    service.$inject = dependencies;

    app.provider(app.name + '.' + servicename, service);
};
},{"app/db.js":"/home/ubuntu/workspace/node_modules/app/db.js"}],"/home/ubuntu/workspace/client/scripts/players/services/index.js":[function(require,module,exports){
'use strict';

module.exports = function(app) {
    // inject:start
    require('./gameServices')(app);
    require('./userServices')(app);
    // inject:end
};
},{"./gameServices":"/home/ubuntu/workspace/client/scripts/players/services/gameServices.js","./userServices":"/home/ubuntu/workspace/client/scripts/players/services/userServices.js"}],"/home/ubuntu/workspace/client/scripts/players/services/userServices.js":[function(require,module,exports){
'use strict';
var servicename = 'userServices';

var db = require('app/db.js')('users');


module.exports = function(app) {

    var dependencies = [ ];

    function service() {
        
        var isInitialized = false;
        
        var init = function() {
            isInitialized = true;
        };
        
        return {
            // initialization
            init: init,

            $get: ['$q', '$localStorage', 
                function($q, $localStorage) {
                    
                    var userData = function() {
                        return $localStorage.userData;
                    }

                    var signUp = function(ctrlData) {
                        var data = db.dataCrumble(ctrlData);
                        var d = $q.defer();

                        db.get(data.username,function(err, res) {
                            //user should not exist.
                            if (res) {
                                return d.reject({reason:'Username exists.'});
                            }

                            //save it
                            db.put(data, data.username, function(err, res) {
                                if (err) throw(err);
                                
                                $localStorage.userData = data;
                                d.resolve({
                                    got: res
                                });
                            });   
                            
                        });


                        return d.promise;
                    };

                    var signIn = function(ctrlData) {
                        var data = db.dataCrumble(ctrlData);
                        
                        var d = $q.defer();
                        //no pass, no login
                        if (!data.passphrase) d.reject();
                        
                        db.get(data.username, function(err, res) {
                            if (err) throw(err);
                            
                            if (res.passphrase == data.passphrase || err) {
                                $localStorage.userData = res;
                                return d.resolve({
                                    got: res
                                });
                            } 
                            
                            return d.reject();
                        });


                        return d.promise;
                    };


                    return {
                        isInitialized: isInitialized,
                        signUp: signUp,
                        signIn: signIn,
                        user: userData
                    };
                }
            ]
        };

    }
    service.$inject = dependencies;

    app.provider(app.name + '.' + servicename, service);

};
},{"app/db.js":"/home/ubuntu/workspace/node_modules/app/db.js"}],"/home/ubuntu/workspace/client/scripts/players/views/dashboard.html":[function(require,module,exports){
module.exports = '<div class="RedWar">\n' +
    '\n' +
    '  <ion-tabs class="tabs-positive tabs-icon-left">\n' +
    '\n' +
    '    <ion-tab title="Home" icon-on="ion-ios7-home" icon-off="ion-ios7-home-outline">\n' +
    '    \n' +
    '      <ion-content ng-controller="main.players.dashboard as ctrl">\n' +
    '\n' +
    '        <div class="item">Start a new game from here, {{ctrl.userData.dataUsername}}.</div>\n' +
    '        <ng-form name="form">\n' +
    '          <div class="list">\n' +
    '\n' +
    '              <label class="item item-input">\n' +
    '                <input minlength="5" required type="text" placeholder="Enter a title for your game." ng-model="ctrl.newGame.dataGamename">\n' +
    '              </label>\n' +
    '              \n' +
    '              <label class="item item-input">\n' +
    '                <input minlength="5" required type="password" placeholder="Optionally, enter a password." ng-model="ctrl.newGame.dataGamePassphrase">\n' +
    '              </label>\n' +
    '              \n' +
    '              <ul class="list">\n' +
    '            \n' +
    '                <li class="item item-toggle">\n' +
    '                   Make it visible to everyone?\n' +
    '                   <label for="visibility" class="toggle toggle-balanced">\n' +
    '                     <input id="visibility" name="visibility" ng-model="dataGameVisibility" type="checkbox">\n' +
    '                     <div class="track">\n' +
    '                       <div class="handle"></div>\n' +
    '                     </div>\n' +
    '                   </label>\n' +
    '                </li>\n' +
    '\n' +
    '              </ul>\n' +
    '              \n' +
    '              \n' +
    '              <div class="item item-button">\n' +
    '                    <button ng-click="ctrl.newGame()" class="button button-positive">Start Game</button>\n' +
    '              </div>\n' +
    '          </div>\n' +
    '        </ng-form>\n' +
    '      </ion-content>\n' +
    '\n' +
    '    </ion-tab>\n' +
    '\n' +
    '    <ion-tab title="Games" icon-on="ion-ios7-keypad" icon-off="ion-ios7-keypad-outline">\n' +
    '      <ion-content ng-controller="main.players.games as ctrl">\n' +
    '        <h1>Games</h1>\n' +
    '        <ul ng-repeat="game in ctrl.games">\n' +
    '          <li>{{game.name}}</li>\n' +
    '        </ul>\n' +
    '      </ion-content>\n' +
    '    </ion-tab>\n' +
    '\n' +
    '    <ion-tab title="Settings" icon-on="ion-ios7-gear" icon-off="ion-ios7-gear-outline">\n' +
    '      <ion-content ng-controller="main.players.settings as ctrl">\n' +
    '        <h1>Settings</h1>\n' +
    '        <ul ng-repeat="setting in ctrl.settings">\n' +
    '          <li>{{setting.name}} :: {{setting.value}}</li>\n' +
    '        </ul>\n' +
    '      </ion-content>    </ion-tab>\n' +
    '\n' +
    '  </ion-tabs>\n' +
    '\n' +
    '</div>\n' +
    '';
},{}],"/home/ubuntu/workspace/client/scripts/players/views/home.html":[function(require,module,exports){
module.exports = '<div ng-controller="main.players.login as ctrl">\n' +
    '\n' +
    '    <ion-header-bar align-title="left" class="bar-positive">\n' +
    '        <h1 class="title">RedWar</h1>\n' +
    '    </ion-header-bar>\n' +
    '    <ion-content>\n' +
    '        <h1>RED WAR</h1>\n' +
    '        <a class="button button-balanced" ui-sref="login">LOGIN</a>\n' +
    '    </ion-content>\n' +
    '    <ion-footer-bar align-title="left" class="bar-positive">\n' +
    '\n' +
    '    </ion-footer-bar>\n' +
    '</div>';
},{}],"/home/ubuntu/workspace/client/scripts/players/views/login.html":[function(require,module,exports){
module.exports = '<div ng-controller="main.players.login as ctrl">\n' +
    '\n' +
    '    <ion-header-bar align-title="left" class="bar-positive">\n' +
    '        <h1 class="title">RedWar</h1>\n' +
    '    </ion-header-bar>\n' +
    '    <ion-content>\n' +
    '        <ng-form name="loginForm">\n' +
    '\n' +
    '            <div class="list">\n' +
    '                <div ng-if="!signUp">\n' +
    '                \n' +
    '                    <label class="item item-input">\n' +
    '                        <input minlength="5" required type="text" placeholder="Enter your Username" ng-model="ctrl.form.signIn.data.username">\n' +
    '                    </label>\n' +
    '                    \n' +
    '                    <label class="item item-input">\n' +
    '                        <input minlength="5" required type="password" placeholder="Enter your Password" ng-model="ctrl.form.signIn.data.passphrase">\n' +
    '                    </label>\n' +
    '                    \n' +
    '                    <div class="item item-divider" ng-show="ctrl.errors.password.invalid">Sorry, that\'s not the right password.</div>\n' +
    '                    \n' +
    '                </div>\n' +
    '\n' +
    '                <div ng-if="signUp">\n' +
    '        \n' +
    '                    <label class="item item-input">\n' +
    '                        <input ng-change="ctrl.errors.clear()" name="username" ng-model="ctrl.form.signUp.data.username" ng-minlength="4" ng-pattern="/[a-zA-Z0-9^ ]/" type="text" placeholder="Create your Username">\n' +
    '                    </label>\n' +
    '                \n' +
    '                    <div class="item item-divider" ng-show="ctrl.errors.username.duplicate">Sorry, that username is already in use.</div>\n' +
    '                    <div class="item item-divider" ng-show="loginForm.username.$error.minlength">I need at least 4 characters.</div>\n' +
    '                    <div class="item item-divider" ng-show="loginForm.username.$error.pattern">Sorry, no funny characters.</div>\n' +
    '\n' +
    '                    <label class="item item-input">\n' +
    '                        <input ng-minlength="5" name="password" ng-model="ctrl.form.signUp.data.passphrase" type="password" placeholder="Create your Password" required>\n' +
    '                    </label>\n' +
    '\n' +
    '                </div>\n' +
    '\n' +
    '\n' +
    '                <div class="item item-checkbox">\n' +
    '                    <label class="checkbox">\n' +
    '                        <input type="checkbox" ng-model="signUp">\n' +
    '                    </label>\n' +
    '                    I want to Sign Up!\n' +
    '                </div>\n' +
    '                <div class="item item-button">\n' +
    '                    <button ng-click="ctrl.signIn()" ng-if="!signUp" class="button button-positive">Sign In</button>\n' +
    '                    <button ng-click="ctrl.signUp()" ng-if="signUp" class="button button-energized">Sign Up</button>\n' +
    '                </div>\n' +
    '            </div>\n' +
    '\n' +
    '        </ng-form>\n' +
    '\n' +
    '    </ion-content>\n' +
    '    <ion-footer-bar align-title="left" class="bar-positive">\n' +
    '\n' +
    '    </ion-footer-bar>\n' +
    '</div>';
},{}],"/home/ubuntu/workspace/node_modules/app/db.js":[function(require,module,exports){

module.exports = function(useDB) {
    var PouchDB = require('pouchdb/dist/pouchdb.js');
    
    var db = new PouchDB('red.war.'+useDB, {
        adapter: 'websql'
    });
    
    /**
     * Do some validation funk. 
     **/
    db.dataCrumble = function(obj) {
        var data = {};
        Object.keys(obj).forEach(function(key) {
            //--call the validate function //
            if (db.validate[key]) 
                db.validate[key]().then(
                    function(valid) { },
                    function(invalid) { }
                );
        });
        return data;
    };

    
    return db;
}
},{"pouchdb/dist/pouchdb.js":"/home/ubuntu/workspace/node_modules/pouchdb/dist/pouchdb.js"}],"/home/ubuntu/workspace/node_modules/famous-polyfills/classList.js":[function(require,module,exports){

/*
 * classList.js: Cross-browser full element.classList implementation.
 * 2011-06-15
 *
 * By Eli Grey, http://eligrey.com
 * Public Domain.
 * NO WARRANTY EXPRESSED OR IMPLIED. USE AT YOUR OWN RISK.
 */

/*global self, document, DOMException */

/*! @source http://purl.eligrey.com/github/classList.js/blob/master/classList.js*/

if (typeof document !== "undefined" && !("classList" in document.createElement("a"))) {

(function (view) {

"use strict";

var
      classListProp = "classList"
    , protoProp = "prototype"
    , elemCtrProto = (view.HTMLElement || view.Element)[protoProp]
    , objCtr = Object
    , strTrim = String[protoProp].trim || function () {
        return this.replace(/^\s+|\s+$/g, "");
    }
    , arrIndexOf = Array[protoProp].indexOf || function (item) {
        var
              i = 0
            , len = this.length
        ;
        for (; i < len; i++) {
            if (i in this && this[i] === item) {
                return i;
            }
        }
        return -1;
    }
    // Vendors: please allow content code to instantiate DOMExceptions
    , DOMEx = function (type, message) {
        this.name = type;
        this.code = DOMException[type];
        this.message = message;
    }
    , checkTokenAndGetIndex = function (classList, token) {
        if (token === "") {
            throw new DOMEx(
                  "SYNTAX_ERR"
                , "An invalid or illegal string was specified"
            );
        }
        if (/\s/.test(token)) {
            throw new DOMEx(
                  "INVALID_CHARACTER_ERR"
                , "String contains an invalid character"
            );
        }
        return arrIndexOf.call(classList, token);
    }
    , ClassList = function (elem) {
        var
              trimmedClasses = strTrim.call(elem.className)
            , classes = trimmedClasses ? trimmedClasses.split(/\s+/) : []
            , i = 0
            , len = classes.length
        ;
        for (; i < len; i++) {
            this.push(classes[i]);
        }
        this._updateClassName = function () {
            elem.className = this.toString();
        };
    }
    , classListProto = ClassList[protoProp] = []
    , classListGetter = function () {
        return new ClassList(this);
    }
;
// Most DOMException implementations don't allow calling DOMException's toString()
// on non-DOMExceptions. Error's toString() is sufficient here.
DOMEx[protoProp] = Error[protoProp];
classListProto.item = function (i) {
    return this[i] || null;
};
classListProto.contains = function (token) {
    token += "";
    return checkTokenAndGetIndex(this, token) !== -1;
};
classListProto.add = function (token) {
    token += "";
    if (checkTokenAndGetIndex(this, token) === -1) {
        this.push(token);
        this._updateClassName();
    }
};
classListProto.remove = function (token) {
    token += "";
    var index = checkTokenAndGetIndex(this, token);
    if (index !== -1) {
        this.splice(index, 1);
        this._updateClassName();
    }
};
classListProto.toggle = function (token) {
    token += "";
    if (checkTokenAndGetIndex(this, token) === -1) {
        this.add(token);
    } else {
        this.remove(token);
    }
};
classListProto.toString = function () {
    return this.join(" ");
};

if (objCtr.defineProperty) {
    var classListPropDesc = {
          get: classListGetter
        , enumerable: true
        , configurable: true
    };
    try {
        objCtr.defineProperty(elemCtrProto, classListProp, classListPropDesc);
    } catch (ex) { // IE 8 doesn't support enumerable:true
        if (ex.number === -0x7FF5EC54) {
            classListPropDesc.enumerable = false;
            objCtr.defineProperty(elemCtrProto, classListProp, classListPropDesc);
        }
    }
} else if (objCtr[protoProp].__defineGetter__) {
    elemCtrProto.__defineGetter__(classListProp, classListGetter);
}

}(self));

}

},{}],"/home/ubuntu/workspace/node_modules/famous-polyfills/functionPrototypeBind.js":[function(require,module,exports){
if (!Function.prototype.bind) {
    Function.prototype.bind = function (oThis) {
        if (typeof this !== "function") {
            // closest thing possible to the ECMAScript 5 internal IsCallable function
            throw new TypeError("Function.prototype.bind - what is trying to be bound is not callable");
        }

        var aArgs = Array.prototype.slice.call(arguments, 1),
        fToBind = this,
        fNOP = function () {},
        fBound = function () {
            return fToBind.apply(this instanceof fNOP && oThis
                ? this
                : oThis,
                aArgs.concat(Array.prototype.slice.call(arguments)));
        };

        fNOP.prototype = this.prototype;
        fBound.prototype = new fNOP();

        return fBound;
    };
}

},{}],"/home/ubuntu/workspace/node_modules/famous-polyfills/index.js":[function(require,module,exports){
require('./classList.js');
require('./functionPrototypeBind.js');
require('./requestAnimationFrame.js');
},{"./classList.js":"/home/ubuntu/workspace/node_modules/famous-polyfills/classList.js","./functionPrototypeBind.js":"/home/ubuntu/workspace/node_modules/famous-polyfills/functionPrototypeBind.js","./requestAnimationFrame.js":"/home/ubuntu/workspace/node_modules/famous-polyfills/requestAnimationFrame.js"}],"/home/ubuntu/workspace/node_modules/famous-polyfills/requestAnimationFrame.js":[function(require,module,exports){
// adds requestAnimationFrame functionality
// Source: http://strd6.com/2011/05/better-window-requestanimationframe-shim/

window.requestAnimationFrame || (window.requestAnimationFrame =
  window.webkitRequestAnimationFrame ||
  window.mozRequestAnimationFrame    ||
  window.oRequestAnimationFrame      ||
  window.msRequestAnimationFrame     ||
  function(callback, element) {
    return window.setTimeout(function() {
      callback(+new Date());
  }, 1000 / 60);
});

},{}],"/home/ubuntu/workspace/node_modules/pouchdb/dist/pouchdb.js":[function(require,module,exports){
(function (global){
//    PouchDB 3.0.6
//    
//    (c) 2012-2014 Dale Harvey and the PouchDB team
//    PouchDB may be freely distributed under the Apache license, version 2.0.
//    For all details and documentation:
//    http://pouchdb.com
!function(e){if("object"==typeof exports)module.exports=e();else if("function"==typeof define&&define.amd)define(e);else{var f;"undefined"!=typeof window?f=window:"undefined"!=typeof global?f=global:"undefined"!=typeof self&&(f=self),f.PouchDB=e()}}(function(){var define,module,exports;return (function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a=typeof require=="function"&&require;if(!u&&a)return a(o,!0);if(i)return i(o,!0);throw new Error("Cannot find module '"+o+"'")}var f=n[o]={exports:{}};t[o][0].call(f.exports,function(e){var n=t[o][1][e];return s(n?n:e)},f,f.exports,e,t,n,r)}return n[o].exports}var i=typeof require=="function"&&require;for(var o=0;o<r.length;o++)s(r[o]);return s})({1:[function(_dereq_,module,exports){
"use strict";

var utils = _dereq_('./utils');
var merge = _dereq_('./merge');
var errors = _dereq_('./deps/errors');
var EventEmitter = _dereq_('events').EventEmitter;
var upsert = _dereq_('./deps/upsert');
var Changes = _dereq_('./changes');
var Promise = utils.Promise;

/*
 * A generic pouch adapter
 */

// returns first element of arr satisfying callback predicate
function arrayFirst(arr, callback) {
  for (var i = 0; i < arr.length; i++) {
    if (callback(arr[i], i) === true) {
      return arr[i];
    }
  }
  return false;
}

// Wrapper for functions that call the bulkdocs api with a single doc,
// if the first result is an error, return an error
function yankError(callback) {
  return function (err, results) {
    if (err || results[0].error) {
      callback(err || results[0]);
    } else {
      callback(null, results[0]);
    }
  };
}

// for every node in a revision tree computes its distance from the closest
// leaf
function computeHeight(revs) {
  var height = {};
  var edges = [];
  merge.traverseRevTree(revs, function (isLeaf, pos, id, prnt) {
    var rev = pos + "-" + id;
    if (isLeaf) {
      height[rev] = 0;
    }
    if (prnt !== undefined) {
      edges.push({from: prnt, to: rev});
    }
    return rev;
  });

  edges.reverse();
  edges.forEach(function (edge) {
    if (height[edge.from] === undefined) {
      height[edge.from] = 1 + height[edge.to];
    } else {
      height[edge.from] = Math.min(height[edge.from], 1 + height[edge.to]);
    }
  });
  return height;
}

function allDocsKeysQuery(api, opts, callback) {
  var keys =  ('limit' in opts) ?
      opts.keys.slice(opts.skip, opts.limit + opts.skip) :
      (opts.skip > 0) ? opts.keys.slice(opts.skip) : opts.keys;
  if (opts.descending) {
    keys.reverse();
  }
  if (!keys.length) {
    return api._allDocs({limit: 0}, callback);
  }
  var finalResults = {
    offset: opts.skip
  };
  return Promise.all(keys.map(function (key, i) {
    var subOpts = utils.extend(true, {key: key, deleted: 'ok'}, opts);
    ['limit', 'skip', 'keys'].forEach(function (optKey) {
      delete subOpts[optKey];
    });
    return new Promise(function (resolve, reject) {
      api._allDocs(subOpts, function (err, res) {
        if (err) {
          return reject(err);
        }
        finalResults.total_rows = res.total_rows;
        resolve(res.rows[0] || {key: key, error: 'not_found'});
      });
    });
  })).then(function (results) {
    finalResults.rows = results;
    return finalResults;
  });
}

utils.inherits(AbstractPouchDB, EventEmitter);
module.exports = AbstractPouchDB;

function AbstractPouchDB() {
  var self = this;
  EventEmitter.call(this);
  self.autoCompact = function (callback) {
    // http doesn't have auto-compaction
    if (!self.auto_compaction || self.type() === 'http') {
      return callback;
    }
    return function (err, res) {
      if (err) {
        callback(err);
      } else {
        var count = res.length;
        var decCount = function () {
          count--;
          if (!count) {
            callback(null, res);
          }
        };
        if (!res.length) {
          return callback(null, res);
        }
        res.forEach(function (doc) {
          if (doc.ok && doc.id) { // if no id, then it was a local doc
            // TODO: we need better error handling
            self.compactDocument(doc.id, 1, decCount);
          } else {
            decCount();
          }
        });
      }
    };
  };

  var listeners = 0, changes;
  var eventNames = ['change', 'delete', 'create', 'update'];
  this.on('newListener', function (eventName) {
    if (~eventNames.indexOf(eventName)) {
      if (listeners) {
        listeners++;
        return;
      } else {
        listeners++;
      }
    } else {
      return;
    }
    var lastChange = 0;
    changes = this.changes({
      conflicts: true,
      include_docs: true,
      continuous: true,
      since: 'now',
      onChange: function (change) {
        if (change.seq <= lastChange) {
          return;
        }
        lastChange = change.seq;
        self.emit('change', change);
        if (change.doc._deleted) {
          self.emit('delete', change);
        } else if (change.doc._rev.split('-')[0] === '1') {
          self.emit('create', change);
        } else {
          self.emit('update', change);
        }
      }
    });
  });
  this.on('removeListener', function (eventName) {
    if (~eventNames.indexOf(eventName)) {
      listeners--;
      if (listeners) {
        return;
      }
    } else {
      return;
    }
    changes.cancel();
  });
}

AbstractPouchDB.prototype.post =
  utils.adapterFun('post', function (doc, opts, callback) {
  if (typeof opts === 'function') {
    callback = opts;
    opts = {};
  }
  if (typeof doc !== 'object' || Array.isArray(doc)) {
    return callback(errors.NOT_AN_OBJECT);
  }
  this.bulkDocs({docs: [doc]}, opts,
      this.autoCompact(yankError(callback)));
});

AbstractPouchDB.prototype.put =
  utils.adapterFun('put', utils.getArguments(function (args) {
  var temp, temptype, opts, callback;
  var doc = args.shift();
  var id = '_id' in doc;
  if (typeof doc !== 'object' || Array.isArray(doc)) {
    callback = args.pop();
    return callback(errors.NOT_AN_OBJECT);
  }
  doc = utils.clone(doc);
  while (true) {
    temp = args.shift();
    temptype = typeof temp;
    if (temptype === "string" && !id) {
      doc._id = temp;
      id = true;
    } else if (temptype === "string" && id && !('_rev' in doc)) {
      doc._rev = temp;
    } else if (temptype === "object") {
      opts = temp;
    } else if (temptype === "function") {
      callback = temp;
    }
    if (!args.length) {
      break;
    }
  }
  opts = opts || {};
  var error = utils.invalidIdError(doc._id);
  if (error) {
    return callback(error);
  }
  if (utils.isLocalId(doc._id) && typeof this._putLocal === 'function') {
    if (doc._deleted) {
      return this._removeLocal(doc, callback);
    } else {
      return this._putLocal(doc, callback);
    }
  }
  this.bulkDocs({docs: [doc]}, opts,
      this.autoCompact(yankError(callback)));
}));

AbstractPouchDB.prototype.putAttachment =
  utils.adapterFun('putAttachment', function (docId, attachmentId, rev,
                                              blob, type, callback) {
  var api = this;
  if (typeof type === 'function') {
    callback = type;
    type = blob;
    blob = rev;
    rev = null;
  }
  if (typeof type === 'undefined') {
    type = blob;
    blob = rev;
    rev = null;
  }

  function createAttachment(doc) {
    doc._attachments = doc._attachments || {};
    doc._attachments[attachmentId] = {
      content_type: type,
      data: blob
    };
    return api.put(doc);
  }

  return api.get(docId).then(function (doc) {
    if (doc._rev !== rev) {
      throw errors.REV_CONFLICT;
    }

    return createAttachment(doc);
  }, function (err) {
     // create new doc
    if (err.error === errors.MISSING_DOC.error) {
      return createAttachment({_id: docId});
    } else {
      throw err;
    }
  });
});

AbstractPouchDB.prototype.removeAttachment =
  utils.adapterFun('removeAttachment', function (docId, attachmentId, rev,
                                                 callback) {
  var self = this;
  self.get(docId, function (err, obj) {
    if (err) {
      callback(err);
      return;
    }
    if (obj._rev !== rev) {
      callback(errors.REV_CONFLICT);
      return;
    }
    if (!obj._attachments) {
      return callback();
    }
    delete obj._attachments[attachmentId];
    if (Object.keys(obj._attachments).length === 0) {
      delete obj._attachments;
    }
    self.put(obj, callback);
  });
});

AbstractPouchDB.prototype.remove =
  utils.adapterFun('remove', function (docOrId, optsOrRev, opts, callback) {
  var doc;
  if (typeof optsOrRev === 'string') {
    // id, rev, opts, callback style
    doc = {
      _id: docOrId,
      _rev: optsOrRev
    };
    if (typeof opts === 'function') {
      callback = opts;
      opts = {};
    }
  } else {
    // doc, opts, callback style
    doc = docOrId;
    if (typeof optsOrRev === 'function') {
      callback = optsOrRev;
      opts = {};
    } else {
      callback = opts;
      opts = optsOrRev;
    }
  }
  opts = utils.clone(opts || {});
  opts.was_delete = true;
  var newDoc = {_id: doc._id, _rev: (doc._rev || opts.rev)};
  newDoc._deleted = true;
  if (utils.isLocalId(newDoc._id) && typeof this._removeLocal === 'function') {
    return this._removeLocal(doc, callback);
  }
  this.bulkDocs({docs: [newDoc]}, opts, yankError(callback));
});

AbstractPouchDB.prototype.revsDiff =
  utils.adapterFun('revsDiff', function (req, opts, callback) {
  if (typeof opts === 'function') {
    callback = opts;
    opts = {};
  }
  opts = utils.clone(opts);
  var ids = Object.keys(req);

  if (!ids.length) {
    return callback(null, {});
  }

  var count = 0;
  var missing = new utils.Map();

  function addToMissing(id, revId) {
    if (!missing.has(id)) {
      missing.set(id, {missing: []});
    }
    missing.get(id).missing.push(revId);
  }

  function processDoc(id, rev_tree) {
    // Is this fast enough? Maybe we should switch to a set simulated by a map
    var missingForId = req[id].slice(0);
    merge.traverseRevTree(rev_tree, function (isLeaf, pos, revHash, ctx,
      opts) {
        var rev = pos + '-' + revHash;
        var idx = missingForId.indexOf(rev);
        if (idx === -1) {
          return;
        }

        missingForId.splice(idx, 1);
        if (opts.status !== 'available') {
          addToMissing(id, rev);
        }
      });

    // Traversing the tree is synchronous, so now `missingForId` contains
    // revisions that were not found in the tree
    missingForId.forEach(function (rev) {
      addToMissing(id, rev);
    });
  }

  ids.map(function (id) {
    this._getRevisionTree(id, function (err, rev_tree) {
      if (err && err.status === 404 && err.message === 'missing') {
        missing.set(id, {missing: req[id]});
      } else if (err) {
        return callback(err);
      } else {
        processDoc(id, rev_tree);
      }

      if (++count === ids.length) {
        // convert LazyMap to object
        var missingObj = {};
        missing.forEach(function (value, key) {
          missingObj[key] = value;
        });
        return callback(null, missingObj);
      }
    });
  }, this);
});

// compact one document and fire callback
// by compacting we mean removing all revisions which
// are further from the leaf in revision tree than max_height
AbstractPouchDB.prototype.compactDocument =
  utils.adapterFun('compactDocument', function (docId, max_height, callback) {
  var self = this;
  this._getRevisionTree(docId, function (err, rev_tree) {
    if (err) {
      return callback(err);
    }
    var height = computeHeight(rev_tree);
    var candidates = [];
    var revs = [];
    Object.keys(height).forEach(function (rev) {
      if (height[rev] > max_height) {
        candidates.push(rev);
      }
    });

    merge.traverseRevTree(rev_tree, function (isLeaf, pos, revHash, ctx, opts) {
      var rev = pos + '-' + revHash;
      if (opts.status === 'available' && candidates.indexOf(rev) !== -1) {
        opts.status = 'missing';
        revs.push(rev);
      }
    });
    self._doCompaction(docId, rev_tree, revs, callback);
  });
});

// compact the whole database using single document
// compaction
AbstractPouchDB.prototype.compact =
  utils.adapterFun('compact', function (opts, callback) {
  if (typeof opts === 'function') {
    callback = opts;
    opts = {};
  }
  var self = this;

  opts = utils.clone(opts || {});

  self.get('_local/compaction')["catch"](function () {
    return false;
  }).then(function (doc) {
    if (typeof self._compact === 'function') {
      if (doc && doc.last_seq) {
        opts.last_seq = doc.last_seq;
      }
      return self._compact(opts, callback);
    }

  });
});
AbstractPouchDB.prototype._compact = function (opts, callback) {
  var done = false;
  var started = 0;
  var copts = {
    returnDocs: false
  };
  var self = this;
  var lastSeq;
  function finish() {
    self.get('_local/compaction')["catch"](function () {
      return false;
    }).then(function (doc) {
      doc = doc || {_id: '_local/compaction'};
      doc.last_seq = lastSeq;
      return self.put(doc);
    }).then(function () {
      callback();
    }, callback);
  }
  if (opts.last_seq) {
    copts.since = opts.last_seq;
  }
  function afterCompact() {
    started--;
    if (!started && done) {
      finish();
    }
  }
  function onChange(row) {
    started++;
    self.compactDocument(row.id, 0).then(afterCompact, callback);
  }
  self.changes(copts).on('change', onChange).on('complete', function (resp) {
    done = true;
    lastSeq = resp.last_seq;
    if (!started) {
      finish();
    }
  }).on('error', callback);
};
/* Begin api wrappers. Specific functionality to storage belongs in the 
   _[method] */
AbstractPouchDB.prototype.get =
  utils.adapterFun('get', function (id, opts, callback) {
  if (typeof opts === 'function') {
    callback = opts;
    opts = {};
  }
  if (typeof id !== 'string') {
    return callback(errors.INVALID_ID);
  }
  if (utils.isLocalId(id) && typeof this._getLocal === 'function') {
    return this._getLocal(id, callback);
  }
  var leaves = [], self = this;
  function finishOpenRevs() {
    var result = [];
    var count = leaves.length;
    if (!count) {
      return callback(null, result);
    }
    // order with open_revs is unspecified
    leaves.forEach(function (leaf) {
      self.get(id,
               {rev: leaf, revs: opts.revs, attachments: opts.attachments},
               function (err, doc) {
        if (!err) {
          result.push({ok: doc});
        } else {
          result.push({missing: leaf});
        }
        count--;
        if (!count) {
          callback(null, result);
        }
      });
    });
  }

  if (opts.open_revs) {
    if (opts.open_revs === "all") {
      this._getRevisionTree(id, function (err, rev_tree) {
        if (err) {
          // if there's no such document we should treat this
          // situation the same way as if revision tree was empty
          rev_tree = [];
        }
        leaves = merge.collectLeaves(rev_tree).map(function (leaf) {
          return leaf.rev;
        });
        finishOpenRevs();
      });
    } else {
      if (Array.isArray(opts.open_revs)) {
        leaves = opts.open_revs;
        for (var i = 0; i < leaves.length; i++) {
          var l = leaves[i];
          // looks like it's the only thing couchdb checks
          if (!(typeof(l) === "string" && /^\d+-/.test(l))) {
            return callback(errors.error(errors.BAD_REQUEST,
              "Invalid rev format"));
          }
        }
        finishOpenRevs();
      } else {
        return callback(errors.error(errors.UNKNOWN_ERROR,
          'function_clause'));
      }
    }
    return; // open_revs does not like other options
  }

  return this._get(id, opts, function (err, result) {
    opts = utils.clone(opts);
    if (err) {
      return callback(err);
    }

    var doc = result.doc;
    if (!doc) {
      // a smoke test for something being very wrong
      return callback(new Error('no doc!'));
    }
    var metadata = result.metadata;
    var ctx = result.ctx;

    if (opts.conflicts) {
      var conflicts = merge.collectConflicts(metadata);
      if (conflicts.length) {
        doc._conflicts = conflicts;
      }
    }

    if (opts.revs || opts.revs_info) {
      var paths = merge.rootToLeaf(metadata.rev_tree);
      var path = arrayFirst(paths, function (arr) {
        return arr.ids.map(function (x) { return x.id; })
          .indexOf(doc._rev.split('-')[1]) !== -1;
      });

      var indexOfRev = path.ids.map(function (x) {return x.id; })
        .indexOf(doc._rev.split('-')[1]) + 1;
      var howMany = path.ids.length - indexOfRev;
      path.ids.splice(indexOfRev, howMany);
      path.ids.reverse();

      if (opts.revs) {
        doc._revisions = {
          start: (path.pos + path.ids.length) - 1,
          ids: path.ids.map(function (rev) {
            return rev.id;
          })
        };
      }
      if (opts.revs_info) {
        var pos =  path.pos + path.ids.length;
        doc._revs_info = path.ids.map(function (rev) {
          pos--;
          return {
            rev: pos + '-' + rev.id,
            status: rev.opts.status
          };
        });
      }
    }

    if (opts.local_seq) {
      doc._local_seq = result.metadata.seq;
    }

    if (opts.attachments && doc._attachments) {
      var attachments = doc._attachments;
      var count = Object.keys(attachments).length;
      if (count === 0) {
        return callback(null, doc);
      }
      Object.keys(attachments).forEach(function (key) {
        this._getAttachment(attachments[key],
                            {encode: true, ctx: ctx}, function (err, data) {
          var att = doc._attachments[key];
          att.data = data;
          delete att.stub;
          if (!--count) {
            callback(null, doc);
          }
        });
      }, self);
    } else {
      if (doc._attachments) {
        for (var key in doc._attachments) {
          if (doc._attachments.hasOwnProperty(key)) {
            doc._attachments[key].stub = true;
          }
        }
      }
      callback(null, doc);
    }
  });
});

AbstractPouchDB.prototype.getAttachment =
  utils.adapterFun('getAttachment', function (docId, attachmentId, opts,
                                              callback) {
  var self = this;
  if (opts instanceof Function) {
    callback = opts;
    opts = {};
  }
  opts = utils.clone(opts);
  this._get(docId, opts, function (err, res) {
    if (err) {
      return callback(err);
    }
    if (res.doc._attachments && res.doc._attachments[attachmentId]) {
      opts.ctx = res.ctx;
      self._getAttachment(res.doc._attachments[attachmentId], opts, callback);
    } else {
      return callback(errors.MISSING_DOC);
    }
  });
});

AbstractPouchDB.prototype.allDocs =
  utils.adapterFun('allDocs', function (opts, callback) {
  if (typeof opts === 'function') {
    callback = opts;
    opts = {};
  }
  opts = utils.clone(opts);
  opts.skip = typeof opts.skip !== 'undefined' ? opts.skip : 0;
  if ('keys' in opts) {
    if (!Array.isArray(opts.keys)) {
      return callback(new TypeError('options.keys must be an array'));
    }
    var incompatibleOpt =
      ['startkey', 'endkey', 'key'].filter(function (incompatibleOpt) {
      return incompatibleOpt in opts;
    })[0];
    if (incompatibleOpt) {
      callback(errors.error(errors.QUERY_PARSE_ERROR,
        'Query parameter `' + incompatibleOpt +
        '` is not compatible with multi-get'
      ));
      return;
    }
    if (this.type() !== 'http') {
      return allDocsKeysQuery(this, opts, callback);
    }
  }

  return this._allDocs(opts, callback);
});

AbstractPouchDB.prototype.changes = function (opts, callback) {
  if (typeof opts === 'function') {
    callback = opts;
    opts = {};
  }
  return new Changes(this, opts, callback);
};

AbstractPouchDB.prototype.close =
  utils.adapterFun('close', function (callback) {
  this._closed = true;
  return this._close(callback);
});

AbstractPouchDB.prototype.info = utils.adapterFun('info', function (callback) {
  var self = this;
  this._info(function (err, info) {
    if (err) {
      return callback(err);
    }
    // assume we know better than the adapter, unless it informs us
    info.db_name = info.db_name || self._db_name;
    info.auto_compaction = !!(self._auto_compaction && self.type() !== 'http');
    callback(null, info);
  });
});

AbstractPouchDB.prototype.id = utils.adapterFun('id', function (callback) {
  return this._id(callback);
});

AbstractPouchDB.prototype.type = function () {
  return (typeof this._type === 'function') ? this._type() : this.adapter;
};

AbstractPouchDB.prototype.bulkDocs =
  utils.adapterFun('bulkDocs', function (req, opts, callback) {
  if (typeof opts === 'function') {
    callback = opts;
    opts = {};
  }

  opts = utils.clone(opts);

  if (Array.isArray(req)) {
    req = {
      docs: req
    };
  }

  if (!req || !req.docs || !Array.isArray(req.docs)) {
    return callback(errors.MISSING_BULK_DOCS);
  }

  for (var i = 0; i < req.docs.length; ++i) {
    if (typeof req.docs[i] !== 'object' || Array.isArray(req.docs[i])) {
      return callback(errors.NOT_AN_OBJECT);
    }
  }

  req = utils.clone(req);
  if (!('new_edits' in opts)) {
    if ('new_edits' in req) {
      opts.new_edits = req.new_edits;
    } else {
      opts.new_edits = true;
    }
  }

  return this._bulkDocs(req, opts, this.autoCompact(callback));
});

AbstractPouchDB.prototype.registerDependentDatabase =
  utils.adapterFun('registerDependentDatabase', function (dependentDb,
                                                          callback) {
  var depDB = new this.constructor(dependentDb, {adapter: this._adapter});
  function diffFun(doc) {
    doc.dependentDbs = doc.dependentDbs || {};
    if (doc.dependentDbs[dependentDb]) {
      return false; // no update required
    }
    doc.dependentDbs[dependentDb] = true;
    return doc;
  }
  upsert(this, '_local/_pouch_dependentDbs', diffFun, function (err) {
    if (err) {
      return callback(err);
    }
    return callback(null, {db: depDB});
  });
});

},{"./changes":6,"./deps/errors":11,"./deps/upsert":13,"./merge":18,"./utils":23,"events":27}],2:[function(_dereq_,module,exports){
(function (process){
"use strict";

var CHANGES_BATCH_SIZE = 25;

var utils = _dereq_('../utils');
var errors = _dereq_('../deps/errors');
// parseUri 1.2.2
// (c) Steven Levithan <stevenlevithan.com>
// MIT License
function parseUri(str) {
  var o = parseUri.options;
  var m = o.parser[o.strictMode ? "strict" : "loose"].exec(str);
  var uri = {};
  var i = 14;

  while (i--) {
    uri[o.key[i]] = m[i] || "";
  }

  uri[o.q.name] = {};
  uri[o.key[12]].replace(o.q.parser, function ($0, $1, $2) {
    if ($1) {
      uri[o.q.name][$1] = $2;
    }
  });

  return uri;
}

function encodeDocId(id) {
  if (/^_(design|local)/.test(id)) {
    return id;
  }
  return encodeURIComponent(id);
}

function preprocessAttachments(doc) {
  if (!doc._attachments || !Object.keys(doc._attachments)) {
    return utils.Promise.resolve();
  }

  return utils.Promise.all(Object.keys(doc._attachments).map(function (key) {
    var attachment = doc._attachments[key];
    if (attachment.data && typeof attachment.data !== 'string') {
      if (typeof process === undefined || process.browser) {
        return new utils.Promise(function (resolve) {
          var reader = new FileReader();
          reader.onloadend = function (e) {
            attachment.data = utils.btoa(
              utils.arrayBufferToBinaryString(e.target.result));
            resolve();
          };
          reader.readAsArrayBuffer(attachment.data);
        });
      } else {
        attachment.data = attachment.data.toString('base64');
      }
    }
  }));
}

parseUri.options = {
  strictMode: false,
  key: ["source", "protocol", "authority", "userInfo", "user", "password",
        "host", "port", "relative", "path", "directory", "file", "query",
        "anchor"],
  q:   {
    name:   "queryKey",
    parser: /(?:^|&)([^&=]*)=?([^&]*)/g
  },
  parser: {
    /* jshint maxlen: false */
    strict: /^(?:([^:\/?#]+):)?(?:\/\/((?:(([^:@]*)(?::([^:@]*))?)?@)?([^:\/?#]*)(?::(\d*))?))?((((?:[^?#\/]*\/)*)([^?#]*))(?:\?([^#]*))?(?:#(.*))?)/,
    loose:  /^(?:(?![^:@]+:[^:@\/]*@)([^:\/?#.]+):)?(?:\/\/)?((?:(([^:@]*)(?::([^:@]*))?)?@)?([^:\/?#]*)(?::(\d*))?)(((\/(?:[^?#](?![^?#\/]*\.[^?#\/.]+(?:[?#]|$)))*\/?)?([^?#\/]*))(?:\?([^#]*))?(?:#(.*))?)/
  }
};

// Get all the information you possibly can about the URI given by name and
// return it as a suitable object.
function getHost(name, opts) {
  // If the given name contains "http:"
  if (/http(s?):/.test(name)) {
    // Prase the URI into all its little bits
    var uri = parseUri(name);

    // Store the fact that it is a remote URI
    uri.remote = true;

    // Store the user and password as a separate auth object
    if (uri.user || uri.password) {
      uri.auth = {username: uri.user, password: uri.password};
    }

    // Split the path part of the URI into parts using '/' as the delimiter
    // after removing any leading '/' and any trailing '/'
    var parts = uri.path.replace(/(^\/|\/$)/g, '').split('/');

    // Store the first part as the database name and remove it from the parts
    // array
    uri.db = parts.pop();

    // Restore the path by joining all the remaining parts (all the parts
    // except for the database name) with '/'s
    uri.path = parts.join('/');
    opts = opts || {};
    opts = utils.clone(opts);
    uri.headers = opts.headers || {};

    if (opts.auth || uri.auth) {
      var nAuth = opts.auth || uri.auth;
      var token = utils.btoa(nAuth.username + ':' + nAuth.password);
      uri.headers.Authorization = 'Basic ' + token;
    }

    if (opts.headers) {
      uri.headers = opts.headers;
    }

    return uri;
  }

  // If the given name does not contain 'http:' then return a very basic object
  // with no host, the current path, the given name as the database name and no
  // username/password
  return {host: '', path: '/', db: name, auth: false};
}

// Generate a URL with the host data given by opts and the given path
function genDBUrl(opts, path) {
  return genUrl(opts, opts.db + '/' + path);
}

// Generate a URL with the host data given by opts and the given path
function genUrl(opts, path) {
  if (opts.remote) {
    // If the host already has a path, then we need to have a path delimiter
    // Otherwise, the path delimiter is the empty string
    var pathDel = !opts.path ? '' : '/';

    // If the host already has a path, then we need to have a path delimiter
    // Otherwise, the path delimiter is the empty string
    return opts.protocol + '://' + opts.host + ':' + opts.port + '/' +
           opts.path + pathDel + path;
  }

  return '/' + path;
}
// Implements the PouchDB API for dealing with CouchDB instances over HTTP
function HttpPouch(opts, callback) {
  // The functions that will be publicly available for HttpPouch
  var api = this;
  api.getHost = opts.getHost ? opts.getHost : getHost;

  // Parse the URI given by opts.name into an easy-to-use object
  var host = api.getHost(opts.name, opts);

  // Generate the database URL based on the host
  var dbUrl = genDBUrl(host, '');

  api.getUrl = function () {return dbUrl; };
  api.getHeaders = function () {return utils.clone(host.headers); };

  var ajaxOpts = opts.ajax || {};
  opts = utils.clone(opts);
  function ajax(options, callback) {
    return utils.ajax(utils.extend({}, ajaxOpts, options), callback);
  }

  // Create a new CouchDB database based on the given opts
  var createDB = function () {
    ajax({headers: host.headers, method: 'PUT', url: dbUrl},
         function (err, ret) {
      // If we get an "Unauthorized" error
      if (err && err.status === 401) {
        // Test if the database already exists
        ajax({headers: host.headers, method: 'HEAD', url: dbUrl},
             function (err, ret) {
          // If there is still an error
          if (err) {
            // Give the error to the callback to deal with
            callback(err);
          } else {
            // Continue as if there had been no errors
            callback(null, api);
          }
        });
        // If there were no errros or if the only error is "Precondition Failed"
        // (note: "Precondition Failed" occurs when we try to create a database
        // that already exists)
      } else if (!err || err.status === 412) {
        // Continue as if there had been no errors
        callback(null, api);
      } else {
        callback(err);
      }
    });
  };
  if (!opts.skipSetup) {
    ajax({headers: host.headers, method: 'GET', url: dbUrl},
         function (err, ret) {
      //check if the db exists
      if (err) {
        if (err.status === 404) {
          //if it doesn't, create it
          createDB();
        } else {
          callback(err);
        }
      } else {
        //go do stuff with the db
        callback(null, api);
      }
    });
  }

  api.type = function () {
    return 'http';
  };

  api.id = utils.adapterFun('id', function (callback) {
    ajax({
      headers: host.headers,
      method: 'GET',
      url: genUrl(host, '')
    }, function (err, result) {
      var uuid = (result && result.uuid) ?
        result.uuid + host.db : genDBUrl(host, '');
      callback(null, uuid);
    });
  });

  api.request = utils.adapterFun('request', function (options, callback) {
    options.headers = host.headers;
    options.url = genDBUrl(host, options.url);
    ajax(options, callback);
  });

  // Sends a POST request to the host calling the couchdb _compact function
  //    version: The version of CouchDB it is running
  api.compact = utils.adapterFun('compact', function (opts, callback) {
    if (typeof opts === 'function') {
      callback = opts;
      opts = {};
    }
    opts = utils.clone(opts);
    ajax({
      headers: host.headers,
      url: genDBUrl(host, '_compact'),
      method: 'POST'
    }, function () {
      function ping() {
        api.info(function (err, res) {
          if (!res.compact_running) {
            callback();
          } else {
            setTimeout(ping, opts.interval || 200);
          }
        });
      }
      // Ping the http if it's finished compaction
      if (typeof callback === "function") {
        ping();
      }
    });
  });

  // Calls GET on the host, which gets back a JSON string containing
  //    couchdb: A welcome string
  //    version: The version of CouchDB it is running
  api._info = function (callback) {
    ajax({
      headers: host.headers,
      method: 'GET',
      url: genDBUrl(host, '')
    }, function (err, res) {
      if (err) {
        callback(err);
      } else {
        res.host = genDBUrl(host, '');
        callback(null, res);
      }
    });
  };

  // Get the document with the given id from the database given by host.
  // The id could be solely the _id in the database, or it may be a
  // _design/ID or _local/ID path
  api.get = utils.adapterFun('get', function (id, opts, callback) {
    // If no options were given, set the callback to the second parameter
    if (typeof opts === 'function') {
      callback = opts;
      opts = {};
    }
    opts = utils.clone(opts);
    if (opts.auto_encode === undefined) {
      opts.auto_encode = true;
    }

    // List of parameters to add to the GET request
    var params = [];

    // If it exists, add the opts.revs value to the list of parameters.
    // If revs=true then the resulting JSON will include a field
    // _revisions containing an array of the revision IDs.
    if (opts.revs) {
      params.push('revs=true');
    }

    // If it exists, add the opts.revs_info value to the list of parameters.
    // If revs_info=true then the resulting JSON will include the field
    // _revs_info containing an array of objects in which each object
    // representing an available revision.
    if (opts.revs_info) {
      params.push('revs_info=true');
    }

    if (opts.local_seq) {
      params.push('local_seq=true');
    }
    // If it exists, add the opts.open_revs value to the list of parameters.
    // If open_revs=all then the resulting JSON will include all the leaf
    // revisions. If open_revs=["rev1", "rev2",...] then the resulting JSON
    // will contain an array of objects containing data of all revisions
    if (opts.open_revs) {
      if (opts.open_revs !== "all") {
        opts.open_revs = JSON.stringify(opts.open_revs);
      }
      params.push('open_revs=' + opts.open_revs);
    }

    // If it exists, add the opts.attachments value to the list of parameters.
    // If attachments=true the resulting JSON will include the base64-encoded
    // contents in the "data" property of each attachment.
    if (opts.attachments) {
      params.push('attachments=true');
    }

    // If it exists, add the opts.rev value to the list of parameters.
    // If rev is given a revision number then get the specified revision.
    if (opts.rev) {
      params.push('rev=' + opts.rev);
    }

    // If it exists, add the opts.conflicts value to the list of parameters.
    // If conflicts=true then the resulting JSON will include the field
    // _conflicts containing all the conflicting revisions.
    if (opts.conflicts) {
      params.push('conflicts=' + opts.conflicts);
    }

    // Format the list of parameters into a valid URI query string
    params = params.join('&');
    params = params === '' ? '' : '?' + params;

    if (opts.auto_encode) {
      id = encodeDocId(id);
    }

    // Set the options for the ajax call
    var options = {
      headers: host.headers,
      method: 'GET',
      url: genDBUrl(host, id + params)
    };

    // If the given id contains at least one '/' and the part before the '/'
    // is NOT "_design" and is NOT "_local"
    // OR
    // If the given id contains at least two '/' and the part before the first
    // '/' is "_design".
    // TODO This second condition seems strange since if parts[0] === '_design'
    // then we already know that parts[0] !== '_local'.
    var parts = id.split('/');
    if ((parts.length > 1 && parts[0] !== '_design' && parts[0] !== '_local') ||
        (parts.length > 2 && parts[0] === '_design' && parts[0] !== '_local')) {
      // Binary is expected back from the server
      options.binary = true;
    }

    // Get the document
    ajax(options, function (err, doc, xhr) {
      // If the document does not exist, send an error to the callback
      if (err) {
        return callback(err);
      }

      // Send the document to the callback
      callback(null, doc, xhr);
    });
  });

  // Delete the document given by doc from the database given by host.
  api.remove = utils.adapterFun('remove', function (docOrId, optsOrRev, opts, callback) {
    var doc;
    if (typeof optsOrRev === 'string') {
      // id, rev, opts, callback style
      doc = {
        _id: docOrId,
        _rev: optsOrRev
      };
      if (typeof opts === 'function') {
        callback = opts;
        opts = {};
      }
    } else {
      // doc, opts, callback style
      doc = docOrId;
      if (typeof optsOrRev === 'function') {
        callback = optsOrRev;
        opts = {};
      } else {
        callback = opts;
        opts = optsOrRev;
      }
    }

    var rev = (doc._rev || opts.rev);

    // Delete the document
    ajax({
      headers: host.headers,
      method: 'DELETE',
      url: genDBUrl(host, encodeDocId(doc._id)) + '?rev=' + rev
    }, callback);
  });

  // Get the attachment
  api.getAttachment =
    utils.adapterFun('getAttachment', function (docId, attachmentId, opts,
                                                callback) {
    if (typeof opts === 'function') {
      callback = opts;
      opts = {};
    }
    opts = utils.clone(opts);
    if (opts.auto_encode === undefined) {
      opts.auto_encode = true;
    }
    if (opts.auto_encode) {
      docId = encodeDocId(docId);
    }
    opts.auto_encode = false;
    api.get(docId + '/' + attachmentId, opts, callback);
  });

  // Remove the attachment given by the id and rev
  api.removeAttachment =
    utils.adapterFun('removeAttachment', function (docId, attachmentId, rev,
                                                   callback) {
    ajax({
      headers: host.headers,
      method: 'DELETE',
      url: genDBUrl(host, encodeDocId(docId) + '/' + attachmentId) + '?rev=' +
           rev
    }, callback);
  });

  // Add the attachment given by blob and its contentType property
  // to the document with the given id, the revision given by rev, and
  // add it to the database given by host.
  api.putAttachment =
    utils.adapterFun('putAttachment', function (docId, attachmentId, rev, blob,
                                                type, callback) {
    if (typeof type === 'function') {
      callback = type;
      type = blob;
      blob = rev;
      rev = null;
    }
    if (typeof type === 'undefined') {
      type = blob;
      blob = rev;
      rev = null;
    }
    var id = encodeDocId(docId) + '/' + attachmentId;
    var url = genDBUrl(host, id);
    if (rev) {
      url += '?rev=' + rev;
    }

    var opts = {
      headers: utils.clone(host.headers),
      method: 'PUT',
      url: url,
      processData: false,
      body: blob,
      timeout: 60000
    };
    opts.headers['Content-Type'] = type;
    // Add the attachment
    ajax(opts, callback);
  });

  // Add the document given by doc (in JSON string format) to the database
  // given by host. This fails if the doc has no _id field.
  api.put = utils.adapterFun('put', utils.getArguments(function (args) {
    var temp, temptype, opts;
    var doc = args.shift();
    var id = '_id' in doc;
    var callback = args.pop();
    if (typeof doc !== 'object' || Array.isArray(doc)) {
      return callback(errors.NOT_AN_OBJECT);
    }

    doc = utils.clone(doc);

    preprocessAttachments(doc).then(function () {
      while (true) {
        temp = args.shift();
        temptype = typeof temp;
        if (temptype === "string" && !id) {
          doc._id = temp;
          id = true;
        } else if (temptype === "string" && id && !('_rev' in doc)) {
          doc._rev = temp;
        } else if (temptype === "object") {
          opts = utils.clone(temp);
        }
        if (!args.length) {
          break;
        }
      }
      opts = opts || {};
      var error = utils.invalidIdError(doc._id);
      if (error) {
        throw error;
      }

      // List of parameter to add to the PUT request
      var params = [];

      // If it exists, add the opts.new_edits value to the list of parameters.
      // If new_edits = false then the database will NOT assign this document a
      // new revision number
      if (opts && typeof opts.new_edits !== 'undefined') {
        params.push('new_edits=' + opts.new_edits);
      }

      // Format the list of parameters into a valid URI query string
      params = params.join('&');
      if (params !== '') {
        params = '?' + params;
      }

      // Add the document
      ajax({
        headers: host.headers,
        method: 'PUT',
        url: genDBUrl(host, encodeDocId(doc._id)) + params,
        body: doc
      }, function (err, res) {
        if (err) {
          return callback(err);
        }
        res.ok = true;
        callback(null, res);
      });
    })["catch"](callback);

  }));

  // Add the document given by doc (in JSON string format) to the database
  // given by host. This does not assume that doc is a new document 
  // (i.e. does not have a _id or a _rev field.)
  api.post = utils.adapterFun('post', function (doc, opts, callback) {
    // If no options were given, set the callback to be the second parameter
    if (typeof opts === 'function') {
      callback = opts;
      opts = {};
    }
    opts = utils.clone(opts);
    if (typeof doc !== 'object') {
      return callback(errors.NOT_AN_OBJECT);
    }
    if (! ("_id" in doc)) {
      doc._id = utils.uuid();
    }
    api.put(doc, opts, function (err, res) {
      if (err) {
        return callback(err);
      }
      res.ok = true;
      callback(null, res);
    });
  });

  // Update/create multiple documents given by req in the database
  // given by host.
  api._bulkDocs = function (req, opts, callback) {
    // If opts.new_edits exists add it to the document data to be
    // send to the database.
    // If new_edits=false then it prevents the database from creating
    // new revision numbers for the documents. Instead it just uses
    // the old ones. This is used in database replication.
    if (typeof opts.new_edits !== 'undefined') {
      req.new_edits = opts.new_edits;
    }

    utils.Promise.all(req.docs.map(preprocessAttachments)).then(function () {
      // Update/create the documents
      ajax({
        headers: host.headers,
        method: 'POST',
        url: genDBUrl(host, '_bulk_docs'),
        body: req
      }, function (err, results) {
        if (err) {
          return callback(err);
        }
        results.forEach(function (result) {
          result.ok = true; // smooths out cloudant not adding this
        });
        callback(null, results);
      });
    })["catch"](callback);
  };

  // Get a listing of the documents in the database given
  // by host and ordered by increasing id.
  api.allDocs = utils.adapterFun('allDocs', function (opts, callback) {
    if (typeof opts === 'function') {
      callback = opts;
      opts = {};
    }
    opts = utils.clone(opts);
    // List of parameters to add to the GET request
    var params = [];
    var body;
    var method = 'GET';

    // TODO I don't see conflicts as a valid parameter for a
    // _all_docs request 
    // (see http://wiki.apache.org/couchdb/HTTP_Document_API#all_docs)
    if (opts.conflicts) {
      params.push('conflicts=true');
    }

    // If opts.descending is truthy add it to params
    if (opts.descending) {
      params.push('descending=true');
    }

    // If opts.include_docs exists, add the include_docs value to the
    // list of parameters.
    // If include_docs=true then include the associated document with each
    // result.
    if (opts.include_docs) {
      params.push('include_docs=true');
    }

    if (opts.key) {
      params.push('key=' + encodeURIComponent(JSON.stringify(opts.key)));
    }

    // If opts.startkey exists, add the startkey value to the list of
    // parameters.
    // If startkey is given then the returned list of documents will
    // start with the document whose id is startkey.
    if (opts.startkey) {
      params.push('startkey=' +
        encodeURIComponent(JSON.stringify(opts.startkey)));
    }

    // If opts.endkey exists, add the endkey value to the list of parameters.
    // If endkey is given then the returned list of docuemnts will
    // end with the document whose id is endkey.
    if (opts.endkey) {
      params.push('endkey=' + encodeURIComponent(JSON.stringify(opts.endkey)));
    }

    if (typeof opts.inclusive_end !== 'undefined') {
      params.push('inclusive_end=' + !!opts.inclusive_end);
    }

    // If opts.limit exists, add the limit value to the parameter list.
    if (typeof opts.limit !== 'undefined') {
      params.push('limit=' + opts.limit);
    }

    if (typeof opts.skip !== 'undefined') {
      params.push('skip=' + opts.skip);
    }

    // Format the list of parameters into a valid URI query string
    params = params.join('&');
    if (params !== '') {
      params = '?' + params;
    }

    if (typeof opts.keys !== 'undefined') {

      var MAX_URL_LENGTH = 2000;
      // according to http://stackoverflow.com/a/417184/680742,
      // the de factor URL length limit is 2000 characters

      var keysAsString =
        'keys=' + encodeURIComponent(JSON.stringify(opts.keys));
      if (keysAsString.length + params.length + 1 <= MAX_URL_LENGTH) {
        // If the keys are short enough, do a GET. we do this to work around
        // Safari not understanding 304s on POSTs (see issue #1239)
        params += (params.indexOf('?') !== -1 ? '&' : '?') + keysAsString;
      } else {
        // If keys are too long, issue a POST request to circumvent GET
        // query string limits
        // see http://wiki.apache.org/couchdb/HTTP_view_API#Querying_Options
        method = 'POST';
        body = JSON.stringify({keys: opts.keys});
      }
    }

    // Get the document listing
    ajax({
      headers: host.headers,
      method: method,
      url: genDBUrl(host, '_all_docs' + params),
      body: body
    }, callback);
  });

  // Get a list of changes made to documents in the database given by host.
  // TODO According to the README, there should be two other methods here,
  // api.changes.addListener and api.changes.removeListener.
  api._changes = function (opts) {
    // We internally page the results of a changes request, this means
    // if there is a large set of changes to be returned we can start
    // processing them quicker instead of waiting on the entire
    // set of changes to return and attempting to process them at once
    var batchSize = 'batch_size' in opts ? opts.batch_size : CHANGES_BATCH_SIZE;

    opts = utils.clone(opts);
    opts.timeout = opts.timeout || 30 * 1000;

    // We give a 5 second buffer for CouchDB changes to respond with
    // an ok timeout
    var params = { timeout: opts.timeout - (5 * 1000) };
    var limit = (typeof opts.limit !== 'undefined') ? opts.limit : false;
    if (limit === 0) {
      limit = 1;
    }
    var returnDocs;
    if ('returnDocs' in opts) {
      returnDocs = opts.returnDocs;
    } else {
      returnDocs = true;
    }
    //
    var leftToFetch = limit;

    if (opts.style) {
      params.style = opts.style;
    }

    if (opts.include_docs || opts.filter && typeof opts.filter === 'function') {
      params.include_docs = true;
    }

    if (opts.continuous) {
      params.feed = 'longpoll';
    }

    if (opts.conflicts) {
      params.conflicts = true;
    }

    if (opts.descending) {
      params.descending = true;
    }

    if (opts.filter && typeof opts.filter === 'string') {
      params.filter = opts.filter;
      if (opts.filter === '_view' &&
          opts.view &&
          typeof opts.view === 'string') {
        params.view = opts.view;
      }
    }

    // If opts.query_params exists, pass it through to the changes request.
    // These parameters may be used by the filter on the source database.
    if (opts.query_params && typeof opts.query_params === 'object') {
      for (var param_name in opts.query_params) {
        if (opts.query_params.hasOwnProperty(param_name)) {
          params[param_name] = opts.query_params[param_name];
        }
      }
    }

    var xhr;
    var lastFetchedSeq;

    // Get all the changes starting wtih the one immediately after the
    // sequence number given by since.
    var fetch = function (since, callback) {
      if (opts.aborted) {
        return;
      }
      params.since = since;
      if (opts.descending) {
        if (limit) {
          params.limit = leftToFetch;
        }
      } else {
        params.limit = (!limit || leftToFetch > batchSize) ?
          batchSize : leftToFetch;
      }

      var paramStr = '?' + Object.keys(params).map(function (k) {
        return k + '=' + params[k];
      }).join('&');

      // Set the options for the ajax call
      var xhrOpts = {
        headers: host.headers,
        method: 'GET',
        url: genDBUrl(host, '_changes' + paramStr),
        // _changes can take a long time to generate, especially when filtered
        timeout: opts.timeout
      };
      lastFetchedSeq = since;

      if (opts.aborted) {
        return;
      }

      // Get the changes
      xhr = ajax(xhrOpts, callback);
    };

    // If opts.since exists, get all the changes from the sequence
    // number given by opts.since. Otherwise, get all the changes
    // from the sequence number 0.
    var fetchTimeout = 10;
    var fetchRetryCount = 0;

    var results = {results: []};

    var fetched = function (err, res) {
      if (opts.aborted) {
        return;
      }
      var raw_results_length = 0;
      // If the result of the ajax call (res) contains changes (res.results)
      if (res && res.results) {
        raw_results_length = res.results.length;
        results.last_seq = res.last_seq;
        // For each change
        var req = {};
        req.query = opts.query_params;
        res.results = res.results.filter(function (c) {
          leftToFetch--;
          var ret = utils.filterChange(opts)(c);
          if (ret) {
            if (returnDocs) {
              results.results.push(c);
            }
            utils.call(opts.onChange, c);
          }
          return ret;
        });
      } else if (err) {
        // In case of an error, stop listening for changes and call
        // opts.complete
        opts.aborted = true;
        utils.call(opts.complete, err);
        return;
      }

      // The changes feed may have timed out with no results
      // if so reuse last update sequence
      if (res && res.last_seq) {
        lastFetchedSeq = res.last_seq;
      }

      var finished = (limit && leftToFetch <= 0) ||
        (res && raw_results_length < batchSize) ||
        (opts.descending);

      if ((opts.continuous && !(limit && leftToFetch <= 0)) || !finished) {
        // Increase retry delay exponentially as long as errors persist
        if (err) {
          fetchRetryCount += 1;
        } else {
          fetchRetryCount = 0;
        }
        var timeoutMultiplier = 1 << fetchRetryCount;
        var retryWait = fetchTimeout * timeoutMultiplier;
        var maximumWait = opts.maximumWait || 30000;

        if (retryWait > maximumWait) {
          utils.call(opts.complete, err || errors.UNKNOWN_ERROR);
          return;
        }

        // Queue a call to fetch again with the newest sequence number
        setTimeout(function () { fetch(lastFetchedSeq, fetched); }, retryWait);
      } else {
        // We're done, call the callback
        utils.call(opts.complete, null, results);
      }
    };

    fetch(opts.since || 0, fetched);

    // Return a method to cancel this method from processing any more
    return {
      cancel: function () {
        opts.aborted = true;
        if (xhr) {
          xhr.abort();
        }
      }
    };
  };

  // Given a set of document/revision IDs (given by req), tets the subset of
  // those that do NOT correspond to revisions stored in the database.
  // See http://wiki.apache.org/couchdb/HttpPostRevsDiff
  api.revsDiff = utils.adapterFun('revsDiff', function (req, opts, callback) {
    // If no options were given, set the callback to be the second parameter
    if (typeof opts === 'function') {
      callback = opts;
      opts = {};
    }

    // Get the missing document/revision IDs
    ajax({
      headers: host.headers,
      method: 'POST',
      url: genDBUrl(host, '_revs_diff'),
      body: JSON.stringify(req)
    }, callback);
  });

  api._close = function (callback) {
    callback();
  };

  api.destroy = utils.adapterFun('destroy', function (callback) {
    ajax({
      url: genDBUrl(host, ''),
      method: 'DELETE',
      headers: host.headers
    }, function (err, resp) {
      if (err) {
        api.emit('error', err);
        callback(err);
      } else {
        api.emit('destroyed');
        callback(null, resp);
      }
    });
  });
}

// Delete the HttpPouch specified by the given name.
HttpPouch.destroy = utils.toPromise(function (name, opts, callback) {
  var host = getHost(name, opts);
  opts = opts || {};
  if (typeof opts === 'function') {
    callback = opts;
    opts = {};
  }
  opts = utils.clone(opts);
  opts.headers = host.headers;
  opts.method = 'DELETE';
  opts.url = genDBUrl(host, '');
  var ajaxOpts = opts.ajax || {};
  opts = utils.extend({}, opts, ajaxOpts);
  utils.ajax(opts, callback);
});

// HttpPouch is a valid adapter.
HttpPouch.valid = function () {
  return true;
};

module.exports = HttpPouch;

}).call(this,_dereq_("/Users/nolan/workspace/pouchdb/node_modules/browserify/node_modules/insert-module-globals/node_modules/process/browser.js"))
},{"../deps/errors":11,"../utils":23,"/Users/nolan/workspace/pouchdb/node_modules/browserify/node_modules/insert-module-globals/node_modules/process/browser.js":28}],3:[function(_dereq_,module,exports){
(function (process,global){
'use strict';

var utils = _dereq_('../utils');
var merge = _dereq_('../merge');
var errors = _dereq_('../deps/errors');
var vuvuzela = _dereq_('vuvuzela');

var cachedDBs = {};
var taskQueue = {
  running: false,
  queue: []
};

function tryCode(fun, that, args) {
  try {
    fun.apply(that, args);
  } catch (err) { // shouldn't happen
    if (window.PouchDB) {
      window.PouchDB.emit('error', err);
    }
  }
}

function applyNext() {
  if (taskQueue.running || !taskQueue.queue.length) {
    return;
  }
  taskQueue.running = true;
  var item = taskQueue.queue.shift();
  item.action(function (err, res) {
    tryCode(item.callback, this, [err, res]);
    taskQueue.running = false;
    process.nextTick(applyNext);
  });
}

function idbError(callback) {
  return function (event) {
    var message = (event.target && event.target.error &&
      event.target.error.name) || event.target;
    callback(errors.error(errors.IDB_ERROR, message, event.type));
  };
}

function isModernIdb() {
  // check for outdated implementations of IDB
  // that rely on the setVersion method instead of onupgradeneeded (issue #1207)

  // cache based on appVersion, in case the browser is updated
  var cacheKey = "_pouch__checkModernIdb_" +
    (global.navigator && global.navigator.appVersion);
  var cached = utils.hasLocalStorage() && global.localStorage[cacheKey];
  if (cached) {
    return JSON.parse(cached);
  }

  var dbName = '_pouch__checkModernIdb';
  var result = global.indexedDB.open(dbName, 1).onupgradeneeded === null;

  if (global.indexedDB.deleteDatabase) {
    global.indexedDB.deleteDatabase(dbName); // db no longer needed
  }
  if (utils.hasLocalStorage()) {
    global.localStorage[cacheKey] = JSON.stringify(result); // cache
  }
  return result;
}

// Unfortunately, the metadata has to be stringified
// when it is put into the database, because otherwise
// IndexedDB can throw errors for deeply-nested objects.
// Originally we just used JSON.parse/JSON.stringify; now
// we use this custom vuvuzela library that avoids recursion.
// If we could do it all over again, we'd probably use a
// format for the revision trees other than JSON.
function encodeMetadata(metadata, winningRev, deleted) {
  var storedObject = {data: vuvuzela.stringify(metadata)};
  storedObject.winningRev = winningRev;
  storedObject.deletedOrLocal = deleted ? '1' : '0';
  storedObject.id = metadata.id;
  return storedObject;
}

function decodeMetadata(storedObject) {
  if (!storedObject) {
    return null;
  }
  if (!storedObject.data) {
    // old format, when we didn't store it stringified
    return storedObject;
  }
  var metadata = vuvuzela.parse(storedObject.data);
  metadata.winningRev = storedObject.winningRev;
  metadata.deletedOrLocal = storedObject.deletedOrLocal === '1';
  return metadata;
}

function IdbPouch(opts, callback) {
  var api = this;

  taskQueue.queue.push({
    action: function (thisCallback) {
      init(api, opts, thisCallback);
    },
    callback: callback
  });
  applyNext();
}

function init(api, opts, callback) {

  // IndexedDB requires a versioned database structure, so we use the
  // version here to manage migrations.
  var ADAPTER_VERSION = 3;

  // The object stores created for each database
  // DOC_STORE stores the document meta data, its revision history and state
  // Keyed by document id
  var DOC_STORE = 'document-store';
  // BY_SEQ_STORE stores a particular version of a document, keyed by its
  // sequence id
  var BY_SEQ_STORE = 'by-sequence';
  // Where we store attachments
  var ATTACH_STORE = 'attach-store';
  // Where we store database-wide meta data in a single record
  // keyed by id: META_STORE
  var META_STORE = 'meta-store';
  // Where we store local documents
  var LOCAL_STORE = 'local-store';
  // Where we detect blob support
  var DETECT_BLOB_SUPPORT_STORE = 'detect-blob-support';

  var name = opts.name;

  var blobSupport = null;
  var instanceId = null;
  var idStored = false;
  var idb = null;
  var docCount = -1;

  function createSchema(db) {
    db.createObjectStore(DOC_STORE, {keyPath : 'id'})
      .createIndex('seq', 'seq', {unique: true});
    db.createObjectStore(BY_SEQ_STORE, {autoIncrement: true})
      .createIndex('_doc_id_rev', '_doc_id_rev', {unique: true});
    db.createObjectStore(ATTACH_STORE, {keyPath: 'digest'});
    db.createObjectStore(META_STORE, {keyPath: 'id', autoIncrement: false});
    db.createObjectStore(DETECT_BLOB_SUPPORT_STORE);
  }

  // migration to version 2
  // unfortunately "deletedOrLocal" is a misnomer now that we no longer
  // store local docs in the main doc-store, but whaddyagonnado
  function addDeletedOrLocalIndex(e, callback) {
    var transaction = e.currentTarget.transaction;
    var docStore = transaction.objectStore(DOC_STORE);
    docStore.createIndex('deletedOrLocal', 'deletedOrLocal', {unique : false});

    docStore.openCursor().onsuccess = function (event) {
      var cursor = event.target.result;
      if (cursor) {
        var metadata = cursor.value;
        var deleted = utils.isDeleted(metadata);
        metadata.deletedOrLocal = deleted ? "1" : "0";
        docStore.put(metadata);
        cursor["continue"]();
      } else {
        callback(transaction);
      }
    };
  }

  // migrations to get to version 3

  function createLocalStoreSchema(db) {
    db.createObjectStore(LOCAL_STORE, {keyPath: '_id'})
      .createIndex('_doc_id_rev', '_doc_id_rev', {unique: true});
  }

  function migrateLocalStore(e, tx) {
    tx = tx || e.currentTarget.transaction;
    var localStore = tx.objectStore(LOCAL_STORE);
    var docStore = tx.objectStore(DOC_STORE);
    var seqStore = tx.objectStore(BY_SEQ_STORE);

    var cursor = docStore.openCursor();
    cursor.onsuccess = function (event) {
      var cursor = event.target.result;
      if (cursor) {
        var metadata = cursor.value;
        var docId = metadata.id;
        var local = utils.isLocalId(docId);
        var rev = merge.winningRev(metadata);
        if (local) {
          var docIdRev = docId + "::" + rev;
          // remove all seq entries
          // associated with this docId
          var start = docId + "::";
          var end = docId + "::~";
          var index = seqStore.index('_doc_id_rev');
          var range = global.IDBKeyRange.bound(start, end, false, false);
          var seqCursor = index.openCursor(range);
          seqCursor.onsuccess = function (e) {
            seqCursor = e.target.result;
            if (!seqCursor) {
              // done
              docStore["delete"](cursor.primaryKey);
              cursor["continue"]();
            } else {
              var data = seqCursor.value;
              if (data._doc_id_rev === docIdRev) {
                localStore.put(data);
              }
              seqStore["delete"](seqCursor.primaryKey);
              seqCursor["continue"]();
            }
          };
        } else {
          cursor["continue"]();
        }
      }
    };
  }

  api.type = function () {
    return 'idb';
  };

  api._id = utils.toPromise(function (callback) {
    callback(null, instanceId);
  });

  api._bulkDocs = function idb_bulkDocs(req, opts, callback) {
    var newEdits = opts.new_edits;
    var userDocs = req.docs;
    // Parse the docs, give them a sequence number for the result
    var docInfos = userDocs.map(function (doc, i) {
      if (doc._id && utils.isLocalId(doc._id)) {
        return doc;
      }
      var newDoc = utils.parseDoc(doc, newEdits);
      newDoc._bulk_seq = i;
      return newDoc;
    });

    var docInfoErrors = docInfos.filter(function (docInfo) {
      return docInfo.error;
    });
    if (docInfoErrors.length) {
      return callback(docInfoErrors[0]);
    }

    var results = new Array(docInfos.length);
    var fetchedDocs = new utils.Map();
    var updateSeq = 0;
    var numDocsWritten = 0;

    function writeMetaData(e) {
      var meta = e.target.result;
      meta.updateSeq = (meta.updateSeq || 0) + updateSeq;
      txn.objectStore(META_STORE).put(meta);
    }

    function checkDoneWritingDocs() {
      if (++numDocsWritten === docInfos.length) {
        txn.objectStore(META_STORE).get(META_STORE).onsuccess = writeMetaData;
      }
    }

    function processDocs() {
      if (!docInfos.length) {
        return;
      }

      var idsToDocs = new utils.Map();

      docInfos.forEach(function (currentDoc, resultsIdx) {
        if (currentDoc._id && utils.isLocalId(currentDoc._id)) {
          api[currentDoc._deleted ? '_removeLocal' : '_putLocal'](
              currentDoc, {ctx: txn}, function (err, resp) {
            if (err) {
              results[resultsIdx] = err;
            } else {
              results[resultsIdx] = {};
            }
            checkDoneWritingDocs();
          });
          return;
        }

        var id = currentDoc.metadata.id;
        if (idsToDocs.has(id)) {
          idsToDocs.get(id).push([currentDoc, resultsIdx]);
        } else {
          idsToDocs.set(id, [[currentDoc, resultsIdx]]);
        }
      });

      // in the case of new_edits, the user can provide multiple docs
      // with the same id. these need to be processed sequentially
      idsToDocs.forEach(function (docs, id) {
        var numDone = 0;

        function docWritten() {
          checkDoneWritingDocs();
          if (++numDone < docs.length) {
            nextDoc();
          }
        }
        function nextDoc() {
          var value = docs[numDone];
          var currentDoc = value[0];
          var resultsIdx = value[1];

          if (fetchedDocs.has(id)) {
            updateDoc(fetchedDocs.get(id), currentDoc, resultsIdx, docWritten);
          } else {
            insertDoc(currentDoc, resultsIdx, docWritten);
          }
        }
        nextDoc();
      });
    }

    function fetchExistingDocs(callback) {
      if (!docInfos.length) {
        return callback();
      }

      var numFetched = 0;

      function checkDone() {
        if (++numFetched === docInfos.length) {
          callback();
        }
      }

      docInfos.forEach(function (docInfo) {
        if (docInfo._id && utils.isLocalId(docInfo._id)) {
          return checkDone(); // skip local docs
        }
        var id = docInfo.metadata.id;
        var req = txn.objectStore(DOC_STORE).get(id);
        req.onsuccess = function process_docRead(event) {
          var metadata = decodeMetadata(event.target.result);
          if (metadata) {
            fetchedDocs.set(id, metadata);
          }
          checkDone();
        };
      });
    }

    function complete() {
      var aresults = results.map(function (result) {
        if (result._bulk_seq) {
          delete result._bulk_seq;
        } else if (!Object.keys(result).length) {
          return {
            ok: true
          };
        }
        if (result.error) {
          return result;
        }

        var metadata = result.metadata;
        var rev = merge.winningRev(metadata);

        return {
          ok: true,
          id: metadata.id,
          rev: rev
        };
      });
      IdbPouch.Changes.notify(name);
      docCount = -1; // invalidate
      callback(null, aresults);
    }

    function preprocessAttachment(att, finish) {
      if (att.stub) {
        return finish();
      }
      if (typeof att.data === 'string') {
        var data;
        try {
          data = atob(att.data);
        } catch (e) {
          var err = errors.error(errors.BAD_ARG,
                                "Attachments need to be base64 encoded");
          return callback(err);
        }
        if (blobSupport) {
          var type = att.content_type;
          data = utils.fixBinary(data);
          att.data = utils.createBlob([data], {type: type});
        }
        utils.MD5(data).then(function (result) {
          att.digest = 'md5-' + result;
          finish();
        });
        return;
      }
      var reader = new FileReader();
      reader.onloadend = function (e) {
        var binary = utils.arrayBufferToBinaryString(this.result || '');
        if (!blobSupport) {
          att.data = btoa(binary);
        }
        utils.MD5(binary).then(function (result) {
          att.digest = 'md5-' + result;
          finish();
        });
      };
      reader.readAsArrayBuffer(att.data);
    }

    function preprocessAttachments(callback) {
      if (!docInfos.length) {
        return callback();
      }

      var docv = 0;
      docInfos.forEach(function (docInfo) {
        var attachments = docInfo.data && docInfo.data._attachments ?
          Object.keys(docInfo.data._attachments) : [];

        if (!attachments.length) {
          return done();
        }

        var recv = 0;
        function attachmentProcessed() {
          recv++;
          if (recv === attachments.length) {
            done();
          }
        }

        for (var key in docInfo.data._attachments) {
          if (docInfo.data._attachments.hasOwnProperty(key)) {
            preprocessAttachment(docInfo.data._attachments[key],
                                 attachmentProcessed);
          }
        }
      });

      function done() {
        docv++;
        if (docInfos.length === docv) {
          callback();
        }
      }
    }

    function writeDoc(docInfo, winningRev, deleted, callback, resultsIdx) {
      var err = null;
      var recv = 0;
      docInfo.data._id = docInfo.metadata.id;
      docInfo.data._rev = docInfo.metadata.rev;

      if (deleted) {
        docInfo.data._deleted = true;
      }

      var attachments = docInfo.data._attachments ?
        Object.keys(docInfo.data._attachments) : [];

      function collectResults(attachmentErr) {
        if (!err) {
          if (attachmentErr) {
            err = attachmentErr;
            callback(err);
          } else if (recv === attachments.length) {
            finish();
          }
        }
      }

      function attachmentSaved(err) {
        recv++;
        collectResults(err);
      }

      for (var key in docInfo.data._attachments) {
        if (!docInfo.data._attachments[key].stub) {
          var data = docInfo.data._attachments[key].data;
          delete docInfo.data._attachments[key].data;
          var digest = docInfo.data._attachments[key].digest;
          saveAttachment(docInfo, digest, data, attachmentSaved);
        } else {
          recv++;
          collectResults();
        }
      }

      function finish() {
        updateSeq++;
        docInfo.data._doc_id_rev = docInfo.data._id + "::" + docInfo.data._rev;
        var seqStore = txn.objectStore(BY_SEQ_STORE);
        var index = seqStore.index('_doc_id_rev');

        function afterPut(e) {
          var metadata = docInfo.metadata;
          metadata.seq = e.target.result;
          // Current _rev is calculated from _rev_tree on read
          delete metadata.rev;
          var metadataToStore = encodeMetadata(metadata, winningRev, deleted);
          var metaDataReq = txn.objectStore(DOC_STORE).put(metadataToStore);
          metaDataReq.onsuccess = function () {
            delete metadata.deletedOrLocal;
            delete metadata.winningRev;
            results[resultsIdx] = docInfo;
            fetchedDocs.set(docInfo.metadata.id, docInfo.metadata);
            utils.call(callback);
          };
        }

        var putReq = seqStore.put(docInfo.data);

        putReq.onsuccess = afterPut;
        putReq.onerror = function (e) {
          // ConstraintError, need to update, not put (see #1638 for details)
          e.preventDefault(); // avoid transaction abort
          e.stopPropagation(); // avoid transaction onerror
          var getKeyReq = index.getKey(docInfo.data._doc_id_rev);
          getKeyReq.onsuccess = function (e) {
            var putReq = seqStore.put(docInfo.data, e.target.result);
            updateSeq--; // discount, since it's an update, not a new seq
            putReq.onsuccess = afterPut;
          };
        };
      }

      if (!attachments.length) {
        finish();
      }
    }

    function updateDoc(oldDoc, docInfo, resultsIdx, callback) {
      var merged =
        merge.merge(oldDoc.rev_tree, docInfo.metadata.rev_tree[0], 1000);
      var wasPreviouslyDeleted = utils.isDeleted(oldDoc);
      var deleted = utils.isDeleted(docInfo.metadata);
      var inConflict = (wasPreviouslyDeleted && deleted && newEdits) ||
        (!wasPreviouslyDeleted && newEdits && merged.conflicts !== 'new_leaf');

      if (inConflict) {
        results[resultsIdx] = makeErr(errors.REV_CONFLICT, docInfo._bulk_seq);
        return callback();
      }

      docInfo.metadata.rev_tree = merged.tree;

      // recalculate
      var winningRev = merge.winningRev(docInfo.metadata);
      deleted = utils.isDeleted(docInfo.metadata, winningRev);

      writeDoc(docInfo, winningRev, deleted, callback, resultsIdx);
    }

    function insertDoc(docInfo, resultsIdx, callback) {
      var winningRev = merge.winningRev(docInfo.metadata);
      var deleted = utils.isDeleted(docInfo.metadata, winningRev);
      // Cant insert new deleted documents
      if ('was_delete' in opts && deleted) {
        results[resultsIdx] = errors.MISSING_DOC;
        return callback();
      }

      writeDoc(docInfo, winningRev, deleted, callback, resultsIdx);
    }

    // Insert sequence number into the error so we can sort later
    function makeErr(err, seq) {
      err._bulk_seq = seq;
      return err;
    }

    function saveAttachment(docInfo, digest, data, callback) {
      var objectStore = txn.objectStore(ATTACH_STORE);
      objectStore.get(digest).onsuccess = function (e) {
        var originalRefs = e.target.result && e.target.result.refs || {};
        var ref = [docInfo.metadata.id, docInfo.metadata.rev].join('@');
        var newAtt = {
          digest: digest,
          body: data,
          refs: originalRefs
        };
        newAtt.refs[ref] = true;
        objectStore.put(newAtt).onsuccess = function (e) {
          utils.call(callback);
        };
      };
    }

    var txn;
    preprocessAttachments(function () {
      var stores = [DOC_STORE, BY_SEQ_STORE, ATTACH_STORE, META_STORE,
        LOCAL_STORE];
      txn = idb.transaction(stores, 'readwrite');
      txn.onerror = idbError(callback);
      txn.ontimeout = idbError(callback);
      txn.oncomplete = complete;

      fetchExistingDocs(processDocs);
    });
  };

  // First we look up the metadata in the ids database, then we fetch the
  // current revision(s) from the by sequence store
  api._get = function idb_get(id, opts, callback) {
    var doc;
    var metadata;
    var err;
    var txn;
    opts = utils.clone(opts);
    if (opts.ctx) {
      txn = opts.ctx;
    } else {
      txn =
        idb.transaction([DOC_STORE, BY_SEQ_STORE, ATTACH_STORE], 'readonly');
    }

    function finish() {
      callback(err, {doc: doc, metadata: metadata, ctx: txn});
    }

    txn.objectStore(DOC_STORE).get(id).onsuccess = function (e) {
      metadata = decodeMetadata(e.target.result);
      // we can determine the result here if:
      // 1. there is no such document
      // 2. the document is deleted and we don't ask about specific rev
      // When we ask with opts.rev we expect the answer to be either
      // doc (possibly with _deleted=true) or missing error
      if (!metadata) {
        err = errors.MISSING_DOC;
        return finish();
      }
      if (utils.isDeleted(metadata) && !opts.rev) {
        err = errors.error(errors.MISSING_DOC, "deleted");
        return finish();
      }
      var objectStore = txn.objectStore(BY_SEQ_STORE);

      // metadata.winningRev was added later, so older DBs might not have it
      var rev = opts.rev || metadata.winningRev || merge.winningRev(metadata);
      var key = metadata.id + '::' + rev;

      objectStore.index('_doc_id_rev').get(key).onsuccess = function (e) {
        doc = e.target.result;
        if (doc && doc._doc_id_rev) {
          delete(doc._doc_id_rev);
        }
        if (!doc) {
          err = errors.MISSING_DOC;
          return finish();
        }
        finish();
      };
    };
  };

  api._getAttachment = function (attachment, opts, callback) {
    var txn;
    opts = utils.clone(opts);
    if (opts.ctx) {
      txn = opts.ctx;
    } else {
      txn =
        idb.transaction([DOC_STORE, BY_SEQ_STORE, ATTACH_STORE], 'readonly');
    }
    var digest = attachment.digest;
    var type = attachment.content_type;

    txn.objectStore(ATTACH_STORE).get(digest).onsuccess = function (e) {
      var data = e.target.result.body;
      if (opts.encode) {
        if (!data) {
          callback(null, '');
        } else if (typeof data !== 'string') { // we have blob support
          var reader = new FileReader();
          reader.onloadend = function (e) {
            var binary = utils.arrayBufferToBinaryString(this.result || '');
            callback(null, btoa(binary));
          };
          reader.readAsArrayBuffer(data);
        } else { // no blob support
          callback(null, data);
        }
      } else {
        if (!data) {
          callback(null, utils.createBlob([''], {type: type}));
        } else if (typeof data !== 'string') { // we have blob support
          callback(null, data);
        } else { // no blob support
          data = utils.fixBinary(atob(data));
          callback(null, utils.createBlob([data], {type: type}));
        }
      }
    };
  };

  function allDocsQuery(totalRows, opts, callback) {
    var start = 'startkey' in opts ? opts.startkey : false;
    var end = 'endkey' in opts ? opts.endkey : false;
    var key = 'key' in opts ? opts.key : false;
    var skip = opts.skip || 0;
    var limit = typeof opts.limit === 'number' ? opts.limit : -1;
    var inclusiveEnd = opts.inclusive_end !== false;
    var descending = 'descending' in opts && opts.descending ? 'prev' : null;

    var manualDescEnd = false;
    if (descending && start && end) {
      // unfortunately IDB has a quirk where IDBKeyRange.bound is invalid if the
      // start is less than the end, even in descending mode.  Best bet
      // is just to handle it manually in that case.
      manualDescEnd = end;
      end = false;
    }

    var keyRange = null;
    try {
      if (start && end) {
        keyRange = global.IDBKeyRange.bound(start, end, false, !inclusiveEnd);
      } else if (start) {
        if (descending) {
          keyRange = global.IDBKeyRange.upperBound(start);
        } else {
          keyRange = global.IDBKeyRange.lowerBound(start);
        }
      } else if (end) {
        if (descending) {
          keyRange = global.IDBKeyRange.lowerBound(end, !inclusiveEnd);
        } else {
          keyRange = global.IDBKeyRange.upperBound(end, !inclusiveEnd);
        }
      } else if (key) {
        keyRange = global.IDBKeyRange.only(key);
      }
    } catch (e) {
      if (e.name === "DataError" && e.code === 0) {
        // data error, start is less than end
        return callback(null, {
          total_rows : totalRows,
          offset : opts.skip,
          rows : []
        });
      } else {
        return callback(errors.error(errors.IDB_ERROR, e.name, e.message));
      }
    }

    var transaction = idb.transaction([DOC_STORE, BY_SEQ_STORE], 'readonly');
    transaction.oncomplete = function () {
      callback(null, {
        total_rows: totalRows,
        offset: opts.skip,
        rows: results
      });
    };

    var oStore = transaction.objectStore(DOC_STORE);
    var oCursor = descending ? oStore.openCursor(keyRange, descending)
      : oStore.openCursor(keyRange);
    var results = [];
    oCursor.onsuccess = function (e) {
      if (!e.target.result) {
        return;
      }
      var cursor = e.target.result;
      var metadata = decodeMetadata(cursor.value);
      // metadata.winningRev added later, some dbs might be missing it
      var winningRev = metadata.winningRev || merge.winningRev(metadata);

      function allDocsInner(metadata, data) {
        var doc = {
          id: metadata.id,
          key: metadata.id,
          value: {
            rev: winningRev
          }
        };
        if (opts.include_docs) {
          doc.doc = data;
          doc.doc._rev = winningRev;
          if (doc.doc._doc_id_rev) {
            delete(doc.doc._doc_id_rev);
          }
          if (opts.conflicts) {
            doc.doc._conflicts = merge.collectConflicts(metadata);
          }
          for (var att in doc.doc._attachments) {
            if (doc.doc._attachments.hasOwnProperty(att)) {
              doc.doc._attachments[att].stub = true;
            }
          }
        }
        var deleted = utils.isDeleted(metadata, winningRev);
        if (opts.deleted === 'ok') {
          // deleted docs are okay with keys_requests
          if (deleted) {
            doc.value.deleted = true;
            doc.doc = null;
          }
          results.push(doc);
        } else if (!deleted && skip-- <= 0) {
          if (manualDescEnd) {
            if (inclusiveEnd && doc.key < manualDescEnd) {
              return;
            } else if (!inclusiveEnd && doc.key <= manualDescEnd) {
              return;
            }
          }
          results.push(doc);
          if (--limit === 0) {
            return;
          }
        }
        cursor["continue"]();
      }

      if (!opts.include_docs) {
        allDocsInner(metadata);
      } else {
        var index = transaction.objectStore(BY_SEQ_STORE).index('_doc_id_rev');
        var key = metadata.id + "::" + winningRev;
        index.get(key).onsuccess = function (event) {
          allDocsInner(decodeMetadata(cursor.value), event.target.result);
        };
      }
    };
  }

  function countDocs(callback) {
    if (docCount !== -1) {
      return callback(null, docCount);
    }

    var count;
    var txn = idb.transaction([DOC_STORE], 'readonly');
    var index = txn.objectStore(DOC_STORE).index('deletedOrLocal');
    index.count(global.IDBKeyRange.only("0")).onsuccess = function (e) {
      count = e.target.result;
    };
    txn.onerror = idbError(callback);
    txn.oncomplete = function () {
      docCount = count;
      callback(null, docCount);
    };
  }

  api._allDocs = function idb_allDocs(opts, callback) {

    // first count the total_rows
    countDocs(function (err, totalRows) {
      if (err) {
        return callback(err);
      }
      if (opts.limit === 0) {
        return callback(null, {
          total_rows : totalRows,
          offset : opts.skip,
          rows : []
        });
      }
      allDocsQuery(totalRows, opts, callback);
    });
  };

  api._info = function idb_info(callback) {

    countDocs(function (err, count) {
      if (err) {
        return callback(err);
      }
      if (idb === null) {
        var error = new Error('db isn\'t open');
        error.id = 'idbNull';
        return callback(error);
      }
      var updateSeq = 0;
      var txn = idb.transaction([META_STORE], 'readonly');

      txn.objectStore(META_STORE).get(META_STORE).onsuccess = function (e) {
        updateSeq = e.target.result && e.target.result.updateSeq || 0;
      };

      txn.oncomplete = function () {
        callback(null, {
          doc_count: count,
          update_seq: updateSeq
        });
      };
    });
  };

  api._changes = function (opts) {
    opts = utils.clone(opts);

    if (opts.continuous) {
      var id = name + ':' + utils.uuid();
      IdbPouch.Changes.addListener(name, id, api, opts);
      IdbPouch.Changes.notify(name);
      return {
        cancel: function () {
          IdbPouch.Changes.removeListener(name, id);
        }
      };
    }

    var descending = opts.descending ? 'prev' : null;
    var lastSeq = 0;

    // Ignore the `since` parameter when `descending` is true
    opts.since = opts.since && !descending ? opts.since : 0;

    var limit = 'limit' in opts ? opts.limit : -1;
    if (limit === 0) {
      limit = 1; // per CouchDB _changes spec
    }
    var returnDocs;
    if ('returnDocs' in opts) {
      returnDocs = opts.returnDocs;
    } else {
      returnDocs = true;
    }

    var results = [];
    var numResults = 0;
    var filter = utils.filterChange(opts);

    var txn;

    function fetchChanges() {
      txn = idb.transaction([DOC_STORE, BY_SEQ_STORE], 'readonly');
      txn.oncomplete = onTxnComplete;

      var req;

      if (descending) {
        req = txn.objectStore(BY_SEQ_STORE)
            .openCursor(global.IDBKeyRange.lowerBound(opts.since, true),
                        descending);
      } else {
        req = txn.objectStore(BY_SEQ_STORE)
            .openCursor(global.IDBKeyRange.lowerBound(opts.since, true));
      }

      req.onsuccess = onsuccess;
      req.onerror = onerror;
    }

    fetchChanges();

    function onsuccess(event) {
      var cursor = event.target.result;

      if (!cursor) {
        return;
      }

      var doc = cursor.value;

      if (opts.doc_ids && opts.doc_ids.indexOf(doc._id) === -1) {
        return cursor["continue"]();
      }

      var index = txn.objectStore(DOC_STORE);
      index.get(doc._id).onsuccess = function (event) {
        var metadata = decodeMetadata(event.target.result);

        if (lastSeq < metadata.seq) {
          lastSeq = metadata.seq;
        }
        // metadata.winningRev was only added later
        var winningRev = metadata.winningRev || merge.winningRev(metadata);
        if (doc._rev !== winningRev) {
          return cursor["continue"]();
        }

        delete doc['_doc_id_rev'];

        var change = opts.processChange(doc, metadata, opts);
        change.seq = cursor.key;
        if (filter(change)) {
          numResults++;
          if (returnDocs) {
            results.push(change);
          }
          opts.onChange(change);
        }
        if (numResults !== limit) {
          cursor["continue"]();
        }
      };
    }

    function onTxnComplete() {
      if (!opts.continuous) {
        opts.complete(null, {
          results: results,
          last_seq: lastSeq
        });
      }
    }
  };

  api._close = function (callback) {
    if (idb === null) {
      return callback(errors.NOT_OPEN);
    }

    // https://developer.mozilla.org/en-US/docs/IndexedDB/IDBDatabase#close
    // "Returns immediately and closes the connection in a separate thread..."
    idb.close();
    delete cachedDBs[name];
    idb = null;
    callback();
  };

  api._getRevisionTree = function (docId, callback) {
    var txn = idb.transaction([DOC_STORE], 'readonly');
    var req = txn.objectStore(DOC_STORE).get(docId);
    req.onsuccess = function (event) {
      var doc = decodeMetadata(event.target.result);
      if (!doc) {
        callback(errors.MISSING_DOC);
      } else {
        callback(null, doc.rev_tree);
      }
    };
  };

  // This function removes revisions of document docId
  // which are listed in revs and sets this document
  // revision to to rev_tree
  api._doCompaction = function (docId, rev_tree, revs, callback) {
    var txn = idb.transaction([DOC_STORE, BY_SEQ_STORE], 'readwrite');

    var index = txn.objectStore(DOC_STORE);
    index.get(docId).onsuccess = function (event) {
      var metadata = decodeMetadata(event.target.result);
      metadata.rev_tree = rev_tree;

      var count = revs.length;
      revs.forEach(function (rev) {
        var index = txn.objectStore(BY_SEQ_STORE).index('_doc_id_rev');
        var key = docId + "::" + rev;
        index.getKey(key).onsuccess = function (e) {
          var seq = e.target.result;
          if (!seq) {
            return;
          }
          txn.objectStore(BY_SEQ_STORE)["delete"](seq);

          count--;
          if (!count) {
            // winningRev is not guaranteed to be there, since it's
            // not formally migrated. deletedOrLocal is a
            // now-unfortunate name that really just means "deleted"
            var winningRev = metadata.winningRev ||
              merge.winningRev(metadata);
            var deleted = metadata.deletedOrLocal;
            txn.objectStore(DOC_STORE).put(
              encodeMetadata(metadata, winningRev, deleted));
          }
        };
      });
    };
    txn.oncomplete = function () {
      utils.call(callback);
    };
  };


  api._getLocal = function (id, callback) {
    var tx = idb.transaction([LOCAL_STORE], 'readonly');
    var req = tx.objectStore(LOCAL_STORE).get(id);

    req.onerror = idbError(callback);
    req.onsuccess = function (e) {
      var doc = e.target.result;
      if (!doc) {
        callback(errors.MISSING_DOC);
      } else {
        delete doc['_doc_id_rev'];
        callback(null, doc);
      }
    };
  };

  api._putLocal = function (doc, opts, callback) {
    if (typeof opts === 'function') {
      callback = opts;
      opts = {};
    }
    delete doc._revisions; // ignore this, trust the rev
    var oldRev = doc._rev;
    var id = doc._id;
    if (!oldRev) {
      doc._rev = '0-1';
    } else {
      doc._rev = '0-' + (parseInt(oldRev.split('-')[1], 10) + 1);
    }
    doc._doc_id_rev = id + '::' + doc._rev;

    var tx = opts.ctx;
    var ret;
    if (!tx) {
      tx = idb.transaction([LOCAL_STORE], 'readwrite');
      tx.onerror = idbError(callback);
      tx.oncomplete = function () {
        if (ret) {
          callback(null, ret);
        }
      };
    }

    var oStore = tx.objectStore(LOCAL_STORE);
    var req;
    if (oldRev) {
      var index = oStore.index('_doc_id_rev');
      var docIdRev = id + '::' + oldRev;
      req = index.get(docIdRev);
      req.onsuccess = function (e) {
        if (!e.target.result) {
          callback(errors.REV_CONFLICT);
        } else { // update
          var req = oStore.put(doc);
          req.onsuccess = function () {
            ret = {ok: true, id: doc._id, rev: doc._rev};
            if (opts.ctx) { // retuthis.immediately
              callback(null, ret);
            }
          };
        }
      };
    } else { // new doc
      req = oStore.get(id);
      req.onsuccess = function (e) {
        if (e.target.result) { // already exists
          callback(errors.REV_CONFLICT);
        } else { // insert
          var req = oStore.put(doc);
          req.onsuccess = function () {
            ret = {ok: true, id: doc._id, rev: doc._rev};
            if (opts.ctx) { // return immediately
              callback(null, ret);
            }
          };
        }
      };
    }
  };

  api._removeLocal = function (doc, callback) {
    var tx = idb.transaction([LOCAL_STORE], 'readwrite');
    var ret;
    tx.oncomplete = function () {
      if (ret) {
        callback(null, ret);
      }
    };
    var docIdRev = doc._id + '::' + doc._rev;
    var oStore = tx.objectStore(LOCAL_STORE);
    var index = oStore.index('_doc_id_rev');
    var req = index.get(docIdRev);

    req.onerror = idbError(callback);
    req.onsuccess = function (e) {
      var doc = e.target.result;
      if (!doc) {
        callback(errors.MISSING_DOC);
      } else {
        var req = index.getKey(docIdRev);
        req.onsuccess = function (e) {
          var key = e.target.result;
          oStore["delete"](key);
          ret = {ok: true, id: doc._id, rev: '0-0'};
        };
      }
    };
  };

  var cached = cachedDBs[name];

  if (cached) {
    idb = cached.idb;
    blobSupport = cached.blobSupport;
    instanceId = cached.instanceId;
    idStored = cached.idStored;
    process.nextTick(function () {
      callback(null, api);
    });
    return;
  }

  var req = global.indexedDB.open(name, ADAPTER_VERSION);

  if (!('openReqList' in IdbPouch)) {
    IdbPouch.openReqList = {};
  }
  IdbPouch.openReqList[name] = req;

  req.onupgradeneeded = function (e) {
    var db = e.target.result;
    if (e.oldVersion < 1) {
      // initial schema
      createSchema(db);
    }
    if (e.oldVersion < 3) {
      createLocalStoreSchema(db);
      if (e.oldVersion < 2) {
        // version 2 adds the deletedOrLocal index
        addDeletedOrLocalIndex(e, function (transaction) {
          migrateLocalStore(e, transaction);
        });
      } else {
        migrateLocalStore(e);
      }
    }
  };

  req.onsuccess = function (e) {

    idb = e.target.result;

    idb.onversionchange = function () {
      idb.close();
      delete cachedDBs[name];
    };
    idb.onabort = function () {
      idb.close();
      delete cachedDBs[name];
    };

    var txn = idb.transaction([META_STORE, DETECT_BLOB_SUPPORT_STORE],
      'readwrite');

    var req = txn.objectStore(META_STORE).get(META_STORE);

    req.onsuccess = function (e) {

      var checkSetupComplete = function () {
        if (blobSupport === null || !idStored) {
          return;
        } else {
          cachedDBs[name] = {
            idb: idb,
            blobSupport: blobSupport,
            instanceId: instanceId,
            idStored: idStored,
            loaded: true
          };
          callback(null, api);
        }
      };

      var meta = e.target.result || {id: META_STORE};
      if (name  + '_id' in meta) {
        instanceId = meta[name + '_id'];
        idStored = true;
        checkSetupComplete();
      } else {
        instanceId = utils.uuid();
        meta[name + '_id'] = instanceId;
        txn.objectStore(META_STORE).put(meta).onsuccess = function () {
          idStored = true;
          checkSetupComplete();
        };
      }

      // Detect blob support. Chrome didn't support it until version 38.
      // in version 37 they had a broken version where PNGs (and possibly
      // other binary types) aren't stored correctly.
      try {
        var blob = utils.createBlob([''], {type: 'image/png'});
        txn.objectStore(DETECT_BLOB_SUPPORT_STORE).put(blob, 'key');
        txn.oncomplete = function () {
          // have to do it in a separate transaction, else the correct
          // content type is always returned
          txn = idb.transaction([META_STORE, DETECT_BLOB_SUPPORT_STORE],
            'readwrite');
          var getBlobReq = txn.objectStore(
            DETECT_BLOB_SUPPORT_STORE).get('key');
          getBlobReq.onsuccess = function (e) {
            var storedBlob = e.target.result;
            var url = URL.createObjectURL(storedBlob);
            utils.ajax({
              url: url,
              cache: true,
              binary: true
            }, function (err, res) {
              if (err && err.status === 405) {
                // firefox won't let us do that. but firefox doesn't
                // have the blob type bug that Chrome does, so that's ok
                blobSupport = true;
              } else {
                blobSupport = !!(res && res.type === 'image/png');
              }
              checkSetupComplete();
            });
          };
        };
      } catch (err) {
        blobSupport = false;
        checkSetupComplete();
      }
    };
  };

  req.onerror = idbError(callback);

}

IdbPouch.valid = function () {
  // Issue #2533, we finally gave up on doing bug
  // detection instead of browser sniffing. Safari brought us
  // to our knees.
  var isSafari = typeof openDatabase !== 'undefined' &&
    /Safari/.test(navigator.userAgent) &&
    !/Chrome/.test(navigator.userAgent);
  return !isSafari && global.indexedDB && isModernIdb();
};

function destroy(name, opts, callback) {
  if (!('openReqList' in IdbPouch)) {
    IdbPouch.openReqList = {};
  }
  IdbPouch.Changes.removeAllListeners(name);

  //Close open request for "name" database to fix ie delay.
  if (IdbPouch.openReqList[name] && IdbPouch.openReqList[name].result) {
    IdbPouch.openReqList[name].result.close();
  }
  var req = global.indexedDB.deleteDatabase(name);

  req.onsuccess = function () {
    //Remove open request from the list.
    if (IdbPouch.openReqList[name]) {
      IdbPouch.openReqList[name] = null;
    }
    if (utils.hasLocalStorage() && (name in global.localStorage)) {
      delete global.localStorage[name];
    }
    delete cachedDBs[name];
    callback(null, { 'ok': true });
  };

  req.onerror = idbError(callback);
}

IdbPouch.destroy = utils.toPromise(function (name, opts, callback) {
  taskQueue.queue.push({
    action: function (thisCallback) {
      destroy(name, opts, thisCallback);
    },
    callback: callback
  });
  applyNext();
});

IdbPouch.Changes = new utils.Changes();

module.exports = IdbPouch;

}).call(this,_dereq_("/Users/nolan/workspace/pouchdb/node_modules/browserify/node_modules/insert-module-globals/node_modules/process/browser.js"),typeof self !== "undefined" ? self : typeof window !== "undefined" ? window : {})
},{"../deps/errors":11,"../merge":18,"../utils":23,"/Users/nolan/workspace/pouchdb/node_modules/browserify/node_modules/insert-module-globals/node_modules/process/browser.js":28,"vuvuzela":58}],4:[function(_dereq_,module,exports){
module.exports = ['idb', 'websql'];
},{}],5:[function(_dereq_,module,exports){
(function (global){
'use strict';

var utils = _dereq_('../utils');
var merge = _dereq_('../merge');
var errors = _dereq_('../deps/errors');
var vuvuzela = _dereq_('vuvuzela');
function quote(str) {
  return "'" + str + "'";
}

var cachedDatabases = {};

var openDB = utils.getArguments(function (args) {
  if (typeof global !== 'undefined') {
    if (global.navigator && global.navigator.sqlitePlugin &&
        global.navigator.sqlitePlugin.openDatabase) {
      return navigator.sqlitePlugin.openDatabase
        .apply(navigator.sqlitePlugin, args);
    } else if (global.sqlitePlugin && global.sqlitePlugin.openDatabase) {
      return global.sqlitePlugin.openDatabase
        .apply(global.sqlitePlugin, args);
    } else {
      var db = cachedDatabases[args[0]];
      if (!db) {
        db = cachedDatabases[args[0]] =
          global.openDatabase.apply(global, args);
      }
      return db;
    }
  }
});

var POUCH_VERSION = 1;
var ADAPTER_VERSION = 4; // used to manage migrations

// The object stores created for each database
// DOC_STORE stores the document meta data, its revision history and state
var DOC_STORE = quote('document-store');
// BY_SEQ_STORE stores a particular version of a document, keyed by its
// sequence id
var BY_SEQ_STORE = quote('by-sequence');
// Where we store attachments
var ATTACH_STORE = quote('attach-store');
var LOCAL_STORE = quote('local-store');
var META_STORE = quote('metadata-store');

// these indexes cover the ground for most allDocs queries
var BY_SEQ_STORE_DELETED_INDEX_SQL =
  'CREATE INDEX IF NOT EXISTS \'by-seq-deleted-idx\' ON ' +
  BY_SEQ_STORE + ' (seq, deleted)';
var BY_SEQ_STORE_DOC_ID_REV_INDEX_SQL =
  'CREATE UNIQUE INDEX IF NOT EXISTS \'by-seq-doc-id-rev\' ON ' +
    BY_SEQ_STORE + ' (doc_id, rev)';
var DOC_STORE_WINNINGSEQ_INDEX_SQL =
  'CREATE INDEX IF NOT EXISTS \'doc-winningseq-idx\' ON ' +
  DOC_STORE + ' (winningseq)';

var DOC_STORE_AND_BY_SEQ_JOINER = BY_SEQ_STORE +
  '.seq = ' + DOC_STORE + '.winningseq';

var SELECT_DOCS = BY_SEQ_STORE + '.seq AS seq, ' +
  BY_SEQ_STORE + '.deleted AS deleted, ' +
  BY_SEQ_STORE + '.json AS data, ' +
  BY_SEQ_STORE + '.rev AS rev, ' +
  DOC_STORE + '.json AS metadata';

function select(selector, table, joiner, where, orderBy) {
  return 'SELECT ' + selector + ' FROM ' +
    (typeof table === 'string' ? table : table.join(' JOIN ')) +
    (joiner ? (' ON ' + joiner) : '') +
    (where ? (' WHERE ' +
      (typeof where === 'string' ? where : where.join(' AND '))) : '') +
    (orderBy ? (' ORDER BY ' + orderBy) : '');
}

function unknownError(callback) {
  return function (event) {
    // event may actually be a SQLError object, so report is as such
    var errorNameMatch = event && event.constructor.toString()
      .match(/function ([^\(]+)/);
    var errorName = (errorNameMatch && errorNameMatch[1]) || event.type;
    var errorReason = event.target || event.message;
    callback(errors.error(errors.WSQ_ERROR, errorReason, errorName));
  };
}
function decodeUtf8(str) {
  return decodeURIComponent(window.escape(str));
}
function parseHexString(str, encoding) {
  var result = '';
  var charWidth = encoding === 'UTF-8' ? 2 : 4;
  for (var i = 0, len = str.length; i < len; i += charWidth) {
    var substring = str.substring(i, i + charWidth);
    if (charWidth === 4) { // UTF-16, twiddle the bits
      substring = substring.substring(2, 4) + substring.substring(0, 2);
    }
    result += String.fromCharCode(parseInt(substring, 16));
  }
  result = encoding === 'UTF-8' ? decodeUtf8(result) : result;
  return result;
}

function stringifyDoc(doc) {
  // don't bother storing the id/rev. it uses lots of space,
  // in persistent map/reduce especially
  delete doc._id;
  delete doc._rev;
  return JSON.stringify(doc);
}

function unstringifyDoc(doc, id, rev) {
  doc = JSON.parse(doc);
  doc._id = id;
  doc._rev = rev;
  return doc;
}

function getSize(opts) {
  if ('size' in opts) {
    // triggers immediate popup in iOS, fixes #2347
    // e.g. 5000001 asks for 5 MB, 10000001 asks for 10 MB,
    return opts.size * 1000000;
  }
  // In iOS, doesn't matter as long as it's <= 5000000.
  // Except that if you request too much, our tests fail
  // because of the native "do you accept?" popup.
  // In Android <=4.3, this value is actually used as an
  // honest-to-god ceiling for data, so we need to
  // set it to a decently high number.
  var isAndroid = /Android/.test(window.navigator.userAgent);
  return isAndroid ? 5000000 : 1;
}

function WebSqlPouch(opts, callback) {
  var api = this;
  var instanceId = null;
  var name = opts.name;
  var size = getSize(opts);
  var idRequests = [];
  var docCount = -1; // cache sqlite count(*) for performance
  var encoding;

  var db = openDB(name, POUCH_VERSION, name, size);
  if (!db) {
    return callback(errors.UNKNOWN_ERROR);
  } else if (typeof db.readTransaction !== 'function') {
    // doesn't exist in sqlite plugin
    db.readTransaction = db.transaction;
  }

  function dbCreated() {
    // note the db name in case the browser upgrades to idb
    if (utils.hasLocalStorage()) {
      global.localStorage['_pouch__websqldb_' + name] = true;
    }
    callback(null, api);
  }

  // In this migration, we added the 'deleted' and 'local' columns to the
  // by-seq and doc store tables.
  // To preserve existing user data, we re-process all the existing JSON
  // and add these values.
  // Called migration2 because it corresponds to adapter version (db_version) #2
  function runMigration2(tx, callback) {
    // index used for the join in the allDocs query
    tx.executeSql(DOC_STORE_WINNINGSEQ_INDEX_SQL);

    tx.executeSql('ALTER TABLE ' + BY_SEQ_STORE +
      ' ADD COLUMN deleted TINYINT(1) DEFAULT 0', [], function () {
      tx.executeSql(BY_SEQ_STORE_DELETED_INDEX_SQL);
      tx.executeSql('ALTER TABLE ' + DOC_STORE +
        ' ADD COLUMN local TINYINT(1) DEFAULT 0', [], function () {
        tx.executeSql('CREATE INDEX IF NOT EXISTS \'doc-store-local-idx\' ON ' +
          DOC_STORE + ' (local, id)');

        var sql = 'SELECT ' + DOC_STORE + '.winningseq AS seq, ' + DOC_STORE +
          '.json AS metadata FROM ' + BY_SEQ_STORE + ' JOIN ' + DOC_STORE +
          ' ON ' + BY_SEQ_STORE + '.seq = ' + DOC_STORE + '.winningseq';

        tx.executeSql(sql, [], function (tx, result) {

          var deleted = [];
          var local = [];

          for (var i = 0; i < result.rows.length; i++) {
            var item = result.rows.item(i);
            var seq = item.seq;
            var metadata = JSON.parse(item.metadata);
            if (utils.isDeleted(metadata)) {
              deleted.push(seq);
            }
            if (utils.isLocalId(metadata.id)) {
              local.push(metadata.id);
            }
          }
          tx.executeSql('UPDATE ' + DOC_STORE + 'SET local = 1 WHERE id IN (' +
            local.map(function () {
            return '?';
          }).join(',') + ')', local, function () {
            tx.executeSql('UPDATE ' + BY_SEQ_STORE +
              ' SET deleted = 1 WHERE seq IN (' + deleted.map(function () {
              return '?';
            }).join(',') + ')', deleted, callback);
          });
        });
      });
    });
  }

  // in this migration, we make all the local docs unversioned
  function runMigration3(tx, callback) {
    var local = 'CREATE TABLE IF NOT EXISTS ' + LOCAL_STORE +
      ' (id UNIQUE, rev, json)';
    tx.executeSql(local, [], function () {
      var sql = 'SELECT ' + DOC_STORE + '.id AS id, ' +
        BY_SEQ_STORE + '.json AS data ' +
        'FROM ' + BY_SEQ_STORE + ' JOIN ' +
        DOC_STORE + ' ON ' + BY_SEQ_STORE + '.seq = ' +
        DOC_STORE + '.winningseq WHERE local = 1';
      tx.executeSql(sql, [], function (tx, res) {
        var rows = [];
        for (var i = 0; i < res.rows.length; i++) {
          rows.push(res.rows.item(i));
        }
        function doNext() {
          if (!rows.length) {
            return callback();
          }
          var row = rows.shift();
          var rev = JSON.parse(row.data)._rev;
          tx.executeSql('INSERT INTO ' + LOCAL_STORE +
              ' (id, rev, json) VALUES (?,?,?)',
              [row.id, rev, row.data], function (tx) {
            tx.executeSql('DELETE FROM ' + DOC_STORE + ' WHERE id=?',
                [row.id], function (tx) {
              tx.executeSql('DELETE FROM ' + BY_SEQ_STORE + ' WHERE seq=?',
                  [row.seq], function () {
                doNext();
              });
            });
          });
        }
        doNext();
      });
    });
  }

  // in this migration, we remove doc_id_rev and just use rev
  function runMigration4(tx, callback) {

    function updateRows(rows, encoding) {
      function doNext() {
        if (!rows.length) {
          return callback();
        }
        var row = rows.shift();
        var doc_id_rev = parseHexString(row.hex, encoding);
        var idx = doc_id_rev.lastIndexOf('::');
        var doc_id = doc_id_rev.substring(0, idx);
        var rev = doc_id_rev.substring(idx + 2);
        var sql = 'UPDATE ' + BY_SEQ_STORE +
          ' SET doc_id=?, rev=? WHERE doc_id_rev=?';
        tx.executeSql(sql, [doc_id, rev, doc_id_rev], function () {
          doNext();
        });
      }
      doNext();
    }

    var sql = 'ALTER TABLE ' + BY_SEQ_STORE + ' ADD COLUMN doc_id';
    tx.executeSql(sql, [], function (tx) {
      var sql = 'ALTER TABLE ' + BY_SEQ_STORE + ' ADD COLUMN rev';
      tx.executeSql(sql, [], function (tx) {
        tx.executeSql(BY_SEQ_STORE_DOC_ID_REV_INDEX_SQL, [], function (tx) {
          var sql = 'SELECT hex(doc_id_rev) as hex FROM ' + BY_SEQ_STORE;
          tx.executeSql(sql, [], function (tx, res) {
            var rows = [];
            for (var i = 0; i < res.rows.length; i++) {
              rows.push(res.rows.item(i));
            }
            // it sucks, but we fetch the encoding twice
            tx.executeSql(
                'SELECT dbid, hex(dbid) AS hexId FROM ' + META_STORE, [],
              function (tx, result) {
                var id = result.rows.item(0).dbid;
                var hexId = result.rows.item(0).hexId;
                var encoding = (hexId.length === id.length * 2) ?
                  'UTF-8' : 'UTF-16';
                updateRows(rows, encoding);
              }
            );
          });
        });
      });
    });
  }

  function onGetInstanceId(tx) {
    while (idRequests.length > 0) {
      var idCallback = idRequests.pop();
      idCallback(null, instanceId);
    }
    checkDbEncoding(tx);
  }

  function checkDbEncoding(tx) {
    // check db encoding - utf-8 (chrome, opera) or utf-16 (safari)?
    tx.executeSql('SELECT dbid, hex(dbid) AS hexId FROM ' + META_STORE, [],
      function (tx, result) {
        var id = result.rows.item(0).dbid;
        var hexId = result.rows.item(0).hexId;
        encoding = (hexId.length === id.length * 2) ? 'UTF-8' : 'UTF-16';
      }
    );
  }

  function onGetVersion(tx, dbVersion) {
    if (dbVersion === 0) {
      // initial schema

      var meta = 'CREATE TABLE IF NOT EXISTS ' + META_STORE +
        ' (update_seq INTEGER, dbid, db_version INTEGER)';
      var attach = 'CREATE TABLE IF NOT EXISTS ' + ATTACH_STORE +
        ' (digest, json, body BLOB)';
      var doc = 'CREATE TABLE IF NOT EXISTS ' + DOC_STORE +
        ' (id unique, json, winningseq)';
      var seq = 'CREATE TABLE IF NOT EXISTS ' + BY_SEQ_STORE +
        ' (seq INTEGER NOT NULL PRIMARY KEY AUTOINCREMENT, ' +
        'json, deleted TINYINT(1), doc_id, rev)';
      var local = 'CREATE TABLE IF NOT EXISTS ' + LOCAL_STORE +
        ' (id UNIQUE, rev, json)';

      // creates
      tx.executeSql(attach);
      tx.executeSql(local);
      tx.executeSql(doc, [], function () {
        tx.executeSql(DOC_STORE_WINNINGSEQ_INDEX_SQL);
        tx.executeSql(seq, [], function () {
          tx.executeSql(BY_SEQ_STORE_DELETED_INDEX_SQL);
          tx.executeSql(BY_SEQ_STORE_DOC_ID_REV_INDEX_SQL);
          tx.executeSql(meta, [], function () {
            // mark the update_seq, db version, and new dbid
            var initSeq = 'INSERT INTO ' + META_STORE +
              ' (update_seq, db_version, dbid) VALUES (?, ?, ?)';
            instanceId = utils.uuid();
            var initSeqArgs = [0, ADAPTER_VERSION, instanceId];
            tx.executeSql(initSeq, initSeqArgs, function (tx) {
              onGetInstanceId(tx);
            });
          });
        });
      });
    } else { // version > 0

      var setupDone = function () {
        var migrated = dbVersion < ADAPTER_VERSION;
        if (migrated) {
          // update the db version within this transaction
          tx.executeSql('UPDATE ' + META_STORE + ' SET db_version = ' +
            ADAPTER_VERSION);
        }
        // notify db.id() callers
        var sql = 'SELECT dbid FROM ' + META_STORE;
        tx.executeSql(sql, [], function (tx, result) {
          instanceId = result.rows.item(0).dbid;
          onGetInstanceId(tx);
        });
      };

      // would love to use promises here, but then websql
      // ends the transaction early
      switch (dbVersion) {
        case 1:
          runMigration2(tx, function () {
            runMigration3(tx, function () {
              runMigration4(tx, setupDone);
            });
          });
          break;
        case 2:
          runMigration3(tx, function () {
            runMigration4(tx, setupDone);
          });
          break;
        case 3:
          runMigration4(tx, setupDone);
          break;
        default:
          setupDone();
          break;
      }
    }
  }

  function setup() {

    db.transaction(function (tx) {
      // first get the version
      tx.executeSql('SELECT sql FROM sqlite_master WHERE tbl_name = ' +
                    META_STORE, [], function (tx, result) {
        if (!result.rows.length) {
          // database hasn't even been created yet (version 0)
          onGetVersion(tx, 0);
        } else if (!/db_version/.test(result.rows.item(0).sql)) {
          // table was created, but without the new db_version column,
          // so add it.
          tx.executeSql('ALTER TABLE ' + META_STORE +
            ' ADD COLUMN db_version INTEGER', [], function () {
            // before version 2, this column didn't even exist
            onGetVersion(tx, 1);
          });
        } else { // column exists, we can safely get it
          tx.executeSql('SELECT db_version FROM ' + META_STORE, [],
            function (tx, result) {
            var dbVersion = result.rows.item(0).db_version;
            onGetVersion(tx, dbVersion);
          });
        }
      });
    }, unknownError(callback), dbCreated);
  }

  if (utils.isCordova() && typeof global !== 'undefined') {
    //to wait until custom api is made in pouch.adapters before doing setup
    global.addEventListener(name + '_pouch', function cordova_init() {
      global.removeEventListener(name + '_pouch', cordova_init, false);
      setup();
    }, false);
  } else {
    setup();
  }

  api.type = function () {
    return 'websql';
  };

  api._id = utils.toPromise(function (callback) {
    callback(null, instanceId);
  });

  api._info = function (callback) {
    db.readTransaction(function (tx) {
      countDocs(tx, function (docCount) {
        var sql = 'SELECT update_seq FROM ' + META_STORE;
        tx.executeSql(sql, [], function (tx, result) {
          var updateSeq = result.rows.item(0).update_seq;
          callback(null, {
            doc_count: docCount,
            update_seq: updateSeq
          });
        });
      });
    }, unknownError(callback));
  };

  api._bulkDocs = function (req, opts, callback) {

    var newEdits = opts.new_edits;
    var userDocs = req.docs;

    // Parse the docs, give them a sequence number for the result
    var docInfos = userDocs.map(function (doc, i) {
      if (doc._id && utils.isLocalId(doc._id)) {
        return doc;
      }
      var newDoc = utils.parseDoc(doc, newEdits);
      newDoc._bulk_seq = i;
      return newDoc;
    });

    var docInfoErrors = docInfos.filter(function (docInfo) {
      return docInfo.error;
    });
    if (docInfoErrors.length) {
      return callback(docInfoErrors[0]);
    }

    var tx;
    var results = new Array(docInfos.length);
    var updateSeq = 0;
    var fetchedDocs = new utils.Map();
    var numDocsWritten = 0;

    function complete() {
      var aresults = results.map(function (result) {
        if (result._bulk_seq) {
          delete result._bulk_seq;
        } else if (!Object.keys(result).length) {
          return {
            ok: true
          };
        }
        if (result.error) {
          return result;
        }

        var metadata = result.metadata;
        var rev = merge.winningRev(metadata);

        return {
          ok: true,
          id: metadata.id,
          rev: rev
        };
      });
      WebSqlPouch.Changes.notify(name);

      var updateseq = 'SELECT update_seq FROM ' + META_STORE;
      tx.executeSql(updateseq, [], function (tx, result) {
        var update_seq = result.rows.item(0).update_seq + updateSeq;
        var sql = 'UPDATE ' + META_STORE + ' SET update_seq=?';
        tx.executeSql(sql, [update_seq], function () {
          callback(null, aresults);
        });
      });
    }

    function preprocessAttachment(att, finish) {
      if (att.stub) {
        return finish();
      }
      if (typeof att.data === 'string') {
        try {
          att.data = atob(att.data);
        } catch (e) {
          var err = errors.error(errors.BAD_ARG,
                                "Attachments need to be base64 encoded");
          return callback(err);
        }
        var data = utils.fixBinary(att.data);
        att.data = utils.createBlob([data], {type: att.content_type});
      }
      var reader = new FileReader();
      reader.onloadend = function (e) {
        var binary = utils.arrayBufferToBinaryString(this.result);
        att.data = binary;
        utils.MD5(binary).then(function (result) {
          att.digest = 'md5-' + result;
          finish();
        });
      };
      reader.readAsArrayBuffer(att.data);
    }

    function preprocessAttachments(callback) {
      if (!docInfos.length) {
        return callback();
      }

      var docv = 0;

      docInfos.forEach(function (docInfo) {
        var attachments = docInfo.data && docInfo.data._attachments ?
          Object.keys(docInfo.data._attachments) : [];
        var recv = 0;

        if (!attachments.length) {
          return done();
        }

        function processedAttachment() {
          recv++;
          if (recv === attachments.length) {
            done();
          }
        }

        for (var key in docInfo.data._attachments) {
          if (docInfo.data._attachments.hasOwnProperty(key)) {
            preprocessAttachment(docInfo.data._attachments[key],
                                 processedAttachment);
          }
        }
      });

      function done() {
        docv++;
        if (docInfos.length === docv) {
          callback();
        }
      }
    }

    function writeDoc(docInfo, winningRev, deleted, callback, isUpdate,
                      resultsIdx) {

      function finish() {
        updateSeq++;
        var data = docInfo.data;
        var deletedInt = deleted ? 1 : 0;

        var id = data._id;
        var rev = data._rev;
        var json = stringifyDoc(data);
        var sql = 'INSERT INTO ' + BY_SEQ_STORE +
          ' (doc_id, rev, json, deleted) VALUES (?, ?, ?, ?);';
        var sqlArgs = [id, rev, json, deletedInt];

        tx.executeSql(sql, sqlArgs, function (tx, result) {
          dataWritten(tx, result.insertId);
        }, function () {
          // constraint error, recover by updating instead (see #1638)
          var fetchSql = select('seq', BY_SEQ_STORE, null,
            'doc_id=? AND rev=?');
          tx.executeSql(fetchSql, [id, rev], function (tx, res) {
            var seq = res.rows.item(0).seq;
            var sql = 'UPDATE ' + BY_SEQ_STORE +
              ' SET json=?, deleted=? WHERE doc_id=? AND rev=?;';
            var sqlArgs = [json, deletedInt, id, rev];
            tx.executeSql(sql, sqlArgs, function (tx) {
              updateSeq--; // discount, since it's an update, not a new seq
              dataWritten(tx, seq);
            });
          });
          return false; // ack that we've handled the error
        });
      }

      function collectResults(attachmentErr) {
        if (!err) {
          if (attachmentErr) {
            err = attachmentErr;
            callback(err);
          } else if (recv === attachments.length) {
            finish();
          }
        }
      }

      var err = null;
      var recv = 0;

      docInfo.data._id = docInfo.metadata.id;
      docInfo.data._rev = docInfo.metadata.rev;

      if (deleted) {
        docInfo.data._deleted = true;
      }

      var attachments = docInfo.data._attachments ?
        Object.keys(docInfo.data._attachments) : [];

      function attachmentSaved(err) {
        recv++;
        collectResults(err);
      }

      for (var key in docInfo.data._attachments) {
        if (!docInfo.data._attachments[key].stub) {
          var data = docInfo.data._attachments[key].data;
          delete docInfo.data._attachments[key].data;
          var digest = docInfo.data._attachments[key].digest;
          saveAttachment(docInfo, digest, data, attachmentSaved);
        } else {
          recv++;
          collectResults();
        }
      }

      if (!attachments.length) {
        finish();
      }

      function dataWritten(tx, seq) {
        docInfo.metadata.seq = seq;
        delete docInfo.metadata.rev;

        var sql = isUpdate ?
          'UPDATE ' + DOC_STORE +
          ' SET json=?, winningseq=(SELECT seq FROM ' + BY_SEQ_STORE +
          ' WHERE doc_id=' + DOC_STORE + '.id AND rev=?) WHERE id=?'
          : 'INSERT INTO ' + DOC_STORE +
          ' (id, winningseq, json) VALUES (?, ?, ?);';
        var metadataStr = vuvuzela.stringify(docInfo.metadata);
        var id = docInfo.metadata.id;
        var params = isUpdate ?
          [metadataStr, winningRev, id] :
          [id, seq, metadataStr];
        tx.executeSql(sql, params, function () {
          results[resultsIdx] = docInfo;
          fetchedDocs.set(id, docInfo.metadata);
          callback();
        });
      }
    }

    function updateDoc(oldDoc, docInfo, resultsIdx, callback) {
      var merged =
        merge.merge(oldDoc.rev_tree, docInfo.metadata.rev_tree[0], 1000);
      var deleted = utils.isDeleted(docInfo.metadata);
      var oldDocDeleted = utils.isDeleted(oldDoc);
      var inConflict = (oldDocDeleted && deleted && newEdits) ||
        (!oldDocDeleted && newEdits && merged.conflicts !== 'new_leaf');
      if (inConflict) {
        results[resultsIdx] = makeErr(errors.REV_CONFLICT, docInfo._bulk_seq);
        return callback();
      }

      docInfo.metadata.rev_tree = merged.tree;

      // recalculate
      var winningRev = merge.winningRev(docInfo.metadata);
      deleted = utils.isDeleted(docInfo.metadata, winningRev);

      writeDoc(docInfo, winningRev, deleted, callback, true, resultsIdx);
    }

    function insertDoc(docInfo, resultsIdx, callback) {
      // Cant insert new deleted documents
      var winningRev = merge.winningRev(docInfo.metadata);
      var deleted = utils.isDeleted(docInfo.metadata, winningRev);
      if ('was_delete' in opts && deleted) {
        results[resultsIdx] = errors.MISSING_DOC;
        return callback();
      }
      writeDoc(docInfo, winningRev, deleted, callback, false, resultsIdx);
    }

    function checkDoneWritingDocs() {
      if (++numDocsWritten === docInfos.length) {
        complete();
      }
    }

    function processDocs() {
      if (!docInfos.length) {
        return complete();
      }

      var idsToDocs = new utils.Map();

      docInfos.forEach(function (currentDoc, resultsIdx) {

        if (currentDoc._id && utils.isLocalId(currentDoc._id)) {
          api[currentDoc._deleted ? '_removeLocal' : '_putLocal'](
              currentDoc, {ctx: tx}, function (err, resp) {
            if (err) {
              results[resultsIdx] = err;
            } else {
              results[resultsIdx] = {};
            }
            checkDoneWritingDocs();
          });
          return;
        }

        var id = currentDoc.metadata.id;
        if (idsToDocs.has(id)) {
          idsToDocs.get(id).push([currentDoc, resultsIdx]);
        } else {
          idsToDocs.set(id, [[currentDoc, resultsIdx]]);
        }
      });

      // in the case of new_edits, the user can provide multiple docs
      // with the same id. these need to be processed sequentially
      idsToDocs.forEach(function (docs, id) {
        var numDone = 0;

        function docWritten() {
          checkDoneWritingDocs();
          if (++numDone < docs.length) {
            nextDoc();
          }
        }
        function nextDoc() {
          var value = docs[numDone];
          var currentDoc = value[0];
          var resultsIdx = value[1];

          if (fetchedDocs.has(id)) {
            updateDoc(fetchedDocs.get(id), currentDoc, resultsIdx, docWritten);
          } else {
            insertDoc(currentDoc, resultsIdx, docWritten);
          }
        }
        nextDoc();
      });
    }

    function fetchExistingDocs(callback) {
      if (!docInfos.length) {
        return callback();
      }

      var numFetched = 0;

      function checkDone() {
        if (++numFetched === docInfos.length) {
          callback();
        }
      }

      docInfos.forEach(function (docInfo) {
        if (docInfo._id && utils.isLocalId(docInfo._id)) {
          return checkDone(); // skip local docs
        }
        var id = docInfo.metadata.id;
        tx.executeSql('SELECT json FROM ' + DOC_STORE +
          ' WHERE id = ?', [id], function (tx, result) {
          if (result.rows.length) {
            var metadata = vuvuzela.parse(result.rows.item(0).json);
            fetchedDocs.set(id, metadata);
          }
          checkDone();
        });
      });
    }

    // Insert sequence number into the error so we can sort later
    function makeErr(err, seq) {
      err._bulk_seq = seq;
      return err;
    }

    function saveAttachment(docInfo, digest, data, callback) {
      var ref = [docInfo.metadata.id, docInfo.metadata.rev].join('@');
      var newAtt = {digest: digest};
      var sql = 'SELECT digest, json FROM ' + ATTACH_STORE + ' WHERE digest=?';
      tx.executeSql(sql, [digest], function (tx, result) {
        if (!result.rows.length) {
          newAtt.refs = {};
          newAtt.refs[ref] = true;
          sql = 'INSERT INTO ' + ATTACH_STORE +
                '(digest, json, body) VALUES (?, ?, ?)';
          tx.executeSql(sql, [digest, JSON.stringify(newAtt), data],
            function () {
            callback();
          });
        } else {
          newAtt.refs = JSON.parse(result.rows.item(0).json).refs;
          sql = 'UPDATE ' + ATTACH_STORE + ' SET json=?, body=? WHERE digest=?';
          tx.executeSql(sql, [JSON.stringify(newAtt), data, digest],
            function () {
            callback();
          });
        }
      });
    }

    preprocessAttachments(function () {
      db.transaction(function (txn) {
        tx = txn;
        fetchExistingDocs(processDocs);
      }, unknownError(callback), function () {
        docCount = -1;
      });
    });
  };

  api._get = function (id, opts, callback) {
    opts = utils.clone(opts);
    var doc;
    var metadata;
    var err;
    if (!opts.ctx) {
      db.readTransaction(function (txn) {
        opts.ctx = txn;
        api._get(id, opts, callback);
      });
      return;
    }
    var tx = opts.ctx;

    function finish() {
      callback(err, {doc: doc, metadata: metadata, ctx: tx});
    }

    var sql;
    var sqlArgs;
    if (opts.rev) {
      sql = select(
        SELECT_DOCS,
        [DOC_STORE, BY_SEQ_STORE],
        DOC_STORE + '.id=' + BY_SEQ_STORE + '.doc_id',
        [BY_SEQ_STORE + '.doc_id=?', BY_SEQ_STORE + '.rev=?']);
      sqlArgs = [id, opts.rev];
    } else {
      sql = select(
        SELECT_DOCS,
        [DOC_STORE, BY_SEQ_STORE],
        DOC_STORE_AND_BY_SEQ_JOINER,
        DOC_STORE + '.id=?');
      sqlArgs = [id];
    }
    tx.executeSql(sql, sqlArgs, function (a, results) {
      if (!results.rows.length) {
        err = errors.MISSING_DOC;
        return finish();
      }
      var item = results.rows.item(0);
      metadata = vuvuzela.parse(item.metadata);
      if (item.deleted && !opts.rev) {
        err = errors.error(errors.MISSING_DOC, 'deleted');
        return finish();
      }
      doc = unstringifyDoc(item.data, metadata.id, item.rev);
      finish();
    });
  };

  function countDocs(tx, callback) {

    if (docCount !== -1) {
      return callback(docCount);
    }

    // count the total rows
    var sql = select(
      'COUNT(' + DOC_STORE + '.id) AS \'num\'',
      [DOC_STORE, BY_SEQ_STORE],
      DOC_STORE_AND_BY_SEQ_JOINER,
      BY_SEQ_STORE + '.deleted=0');

    tx.executeSql(sql, [], function (tx, result) {
      docCount = result.rows.item(0).num;
      callback(docCount);
    });
  }

  api._allDocs = function (opts, callback) {
    var results = [];
    var totalRows;

    var start = 'startkey' in opts ? opts.startkey : false;
    var end = 'endkey' in opts ? opts.endkey : false;
    var key = 'key' in opts ? opts.key : false;
    var descending = 'descending' in opts ? opts.descending : false;
    var limit = 'limit' in opts ? opts.limit : -1;
    var offset = 'skip' in opts ? opts.skip : 0;
    var inclusiveEnd = opts.inclusive_end !== false;

    var sqlArgs = [];
    var criteria = [];

    if (key !== false) {
      criteria.push(DOC_STORE + '.id = ?');
      sqlArgs.push(key);
    } else if (start !== false || end !== false) {
      if (start !== false) {
        criteria.push(DOC_STORE + '.id ' + (descending ? '<=' : '>=') + ' ?');
        sqlArgs.push(start);
      }
      if (end !== false) {
        var comparator = descending ? '>' : '<';
        if (inclusiveEnd) {
          comparator += '=';
        }
        criteria.push(DOC_STORE + '.id ' + comparator + ' ?');
        sqlArgs.push(end);
      }
      if (key !== false) {
        criteria.push(DOC_STORE + '.id = ?');
        sqlArgs.push(key);
      }
    }

    if (opts.deleted !== 'ok') {
      // report deleted if keys are specified
      criteria.push(BY_SEQ_STORE + '.deleted = 0');
    }

    db.readTransaction(function (tx) {

      // first count up the total rows
      countDocs(tx, function (count) {
        totalRows = count;

        if (limit === 0) {
          return;
        }

        // then actually fetch the documents
        var sql = select(
          SELECT_DOCS,
          [DOC_STORE, BY_SEQ_STORE],
          DOC_STORE_AND_BY_SEQ_JOINER,
          criteria,
          DOC_STORE + '.id ' + (descending ? 'DESC' : 'ASC')
          );
        sql += ' LIMIT ' + limit + ' OFFSET ' + offset;

        tx.executeSql(sql, sqlArgs, function (tx, result) {
          for (var i = 0, l = result.rows.length; i < l; i++) {
            var item = result.rows.item(i);
            var metadata = vuvuzela.parse(item.metadata);
            var data = unstringifyDoc(item.data, metadata.id, item.rev);
            var winningRev = data._rev;
            var doc = {
              id: metadata.id,
              key: metadata.id,
              value: {rev: winningRev}
            };
            if (opts.include_docs) {
              doc.doc = data;
              doc.doc._rev = winningRev;
              if (opts.conflicts) {
                doc.doc._conflicts = merge.collectConflicts(metadata);
              }
              for (var att in doc.doc._attachments) {
                if (doc.doc._attachments.hasOwnProperty(att)) {
                  doc.doc._attachments[att].stub = true;
                }
              }
            }
            if (item.deleted) {
              if (opts.deleted === 'ok') {
                doc.value.deleted = true;
                doc.doc = null;
              } else {
                continue;
              }
            }
            results.push(doc);
          }
        });
      });
    }, unknownError(callback), function () {
      callback(null, {
        total_rows: totalRows,
        offset: opts.skip,
        rows: results
      });
    });
  };

  api._changes = function (opts) {
    opts = utils.clone(opts);

    if (opts.continuous) {
      var id = name + ':' + utils.uuid();
      WebSqlPouch.Changes.addListener(name, id, api, opts);
      WebSqlPouch.Changes.notify(name);
      return {
        cancel: function () {
          WebSqlPouch.Changes.removeListener(name, id);
        }
      };
    }

    var descending = opts.descending;

    // Ignore the `since` parameter when `descending` is true
    opts.since = opts.since && !descending ? opts.since : 0;

    var limit = 'limit' in opts ? opts.limit : -1;
    if (limit === 0) {
      limit = 1; // per CouchDB _changes spec
    }

    var returnDocs;
    if ('returnDocs' in opts) {
      returnDocs = opts.returnDocs;
    } else {
      returnDocs = true;
    }
    var results = [];
    var numResults = 0;
    function fetchChanges() {

      var criteria = [
        DOC_STORE + '.winningseq > ' + opts.since
      ];
      var sqlArgs = [];
      if (opts.doc_ids) {
        criteria.push(DOC_STORE + '.id IN (' + opts.doc_ids.map(function () {
          return '?';
        }).join(',') + ')');
        sqlArgs = opts.doc_ids;
      }

      var sql = select(SELECT_DOCS, [DOC_STORE, BY_SEQ_STORE],
        DOC_STORE_AND_BY_SEQ_JOINER, criteria,
        DOC_STORE + '.winningseq ' + (descending ? 'DESC' : 'ASC'));

      var filter = utils.filterChange(opts);
      if (!opts.view && !opts.filter) {
        // we can just limit in the query
        sql += ' LIMIT ' + limit;
      }

      db.readTransaction(function (tx) {
        tx.executeSql(sql, sqlArgs, function (tx, result) {
          var lastSeq = 0;
          for (var i = 0, l = result.rows.length; i < l; i++) {
            var res = result.rows.item(i);
            var metadata = vuvuzela.parse(res.metadata);
            if (lastSeq < res.seq) {
              lastSeq = res.seq;
            }
            var doc = unstringifyDoc(res.data, metadata.id, res.rev);
            var change = opts.processChange(doc, metadata, opts);
            change.seq = res.seq;
            if (filter(change)) {
              numResults++;
              if (returnDocs) {
                results.push(change);
              }
              opts.onChange(change);
            }
            if (numResults === limit) {
              break;
            }
          }
          if (!opts.continuous) {
            opts.complete(null, {
              results: results,
              last_seq: lastSeq
            });
          }
        });
      });
    }

    fetchChanges();
  };

  api._close = function (callback) {
    //WebSQL databases do not need to be closed
    callback();
  };

  api._getAttachment = function (attachment, opts, callback) {
    var res;
    var tx = opts.ctx;
    var digest = attachment.digest;
    var type = attachment.content_type;
    var sql = 'SELECT hex(body) as body FROM ' + ATTACH_STORE +
              ' WHERE digest=?';
    tx.executeSql(sql, [digest], function (tx, result) {
      // sqlite normally stores data as utf8, so even the hex() function
      // "encodes" the binary data in utf8/16 before returning it. yet hex()
      // is the only way to get the full data, so we do this.
      var data = parseHexString(result.rows.item(0).body, encoding);
      if (opts.encode) {
        res = btoa(data);
      } else {
        data = utils.fixBinary(data);
        res = utils.createBlob([data], {type: type});
      }
      callback(null, res);
    });
  };

  api._getRevisionTree = function (docId, callback) {
    db.readTransaction(function (tx) {
      var sql = 'SELECT json AS metadata FROM ' + DOC_STORE + ' WHERE id = ?';
      tx.executeSql(sql, [docId], function (tx, result) {
        if (!result.rows.length) {
          callback(errors.MISSING_DOC);
        } else {
          var data = vuvuzela.parse(result.rows.item(0).metadata);
          callback(null, data.rev_tree);
        }
      });
    });
  };

  api._doCompaction = function (docId, rev_tree, revs, callback) {
    if (!revs.length) {
      return callback();
    }
    db.transaction(function (tx) {
      var sql = 'SELECT json AS metadata FROM ' + DOC_STORE + ' WHERE id = ?';
      tx.executeSql(sql, [docId], function (tx, result) {
        if (!result.rows.length) {
          return utils.call(callback);
        }
        var metadata = vuvuzela.parse(result.rows.item(0).metadata);
        metadata.rev_tree = rev_tree;

        var numDone = 0;
        revs.forEach(function (rev) {
          var sql = 'DELETE FROM ' + BY_SEQ_STORE + ' WHERE doc_id=? AND rev=?';
          tx.executeSql(sql, [docId, rev], function (tx) {
            if (++numDone === revs.length) {
              var sql = 'UPDATE ' + DOC_STORE + ' SET json = ? WHERE id = ?';
              tx.executeSql(sql, [vuvuzela.stringify(metadata), docId],
                function () {
                callback();
              });
            }
          });
        });
      });
    });
  };

  api._getLocal = function (id, callback) {
    db.readTransaction(function (tx) {
      var sql = 'SELECT json, rev FROM ' + LOCAL_STORE + ' WHERE id=?';
      tx.executeSql(sql, [id], function (tx, res) {
        if (res.rows.length) {
          var item = res.rows.item(0);
          var doc = unstringifyDoc(item.json, id, item.rev);
          callback(null, doc);
        } else {
          callback(errors.MISSING_DOC);
        }
      });
    });
  };

  api._putLocal = function (doc, opts, callback) {
    if (typeof opts === 'function') {
      callback = opts;
      opts = {};
    }
    delete doc._revisions; // ignore this, trust the rev
    var oldRev = doc._rev;
    var id = doc._id;
    var newRev;
    if (!oldRev) {
      newRev = doc._rev = '0-1';
    } else {
      newRev = doc._rev = '0-' + (parseInt(oldRev.split('-')[1], 10) + 1);
    }
    var json = stringifyDoc(doc);

    var ret;
    function putLocal(tx) {
      var sql;
      var values;
      if (oldRev) {
        sql = 'UPDATE ' + LOCAL_STORE + ' SET rev=?, json=? ' +
          'WHERE id=? AND rev=?';
        values = [newRev, json, id, oldRev];
      } else {
        sql = 'INSERT INTO ' + LOCAL_STORE + ' (id, rev, json) VALUES (?,?,?)';
        values = [id, newRev, json];
      }
      tx.executeSql(sql, values, function (tx, res) {
        if (res.rowsAffected) {
          ret = {ok: true, id: id, rev: newRev};
          if (opts.ctx) { // return immediately
            callback(null, ret);
          }
        } else {
          callback(errors.REV_CONFLICT);
        }
      }, function () {
        callback(errors.REV_CONFLICT);
        return false; // ack that we handled the error
      });
    }

    if (opts.ctx) {
      putLocal(opts.ctx);
    } else {
      db.transaction(function (tx) {
        putLocal(tx);
      }, unknownError(callback), function () {
        if (ret) {
          callback(null, ret);
        }
      });
    }
  };

  api._removeLocal = function (doc, callback) {
    var ret;
    db.transaction(function (tx) {
      var sql = 'DELETE FROM ' + LOCAL_STORE + ' WHERE id=? AND rev=?';
      var params = [doc._id, doc._rev];
      tx.executeSql(sql, params, function (tx, res) {
        if (!res.rowsAffected) {
          return callback(errors.REV_CONFLICT);
        }
        ret = {ok: true, id: doc._id, rev: '0-0'};
      });
    }, unknownError(callback), function () {
      callback(null, ret);
    });
  };
}

WebSqlPouch.valid = function () {
  if (typeof global !== 'undefined') {
    if (global.navigator &&
        global.navigator.sqlitePlugin &&
        global.navigator.sqlitePlugin.openDatabase) {
      return true;
    } else if (global.sqlitePlugin && global.sqlitePlugin.openDatabase) {
      return true;
    } else if (global.openDatabase) {
      return true;
    }
  }
  return false;
};

WebSqlPouch.destroy = utils.toPromise(function (name, opts, callback) {
  WebSqlPouch.Changes.removeAllListeners(name);
  var size = getSize(opts);
  var db = openDB(name, POUCH_VERSION, name, size);
  db.transaction(function (tx) {
    var stores = [DOC_STORE, BY_SEQ_STORE, ATTACH_STORE, META_STORE,
      LOCAL_STORE];
    stores.forEach(function (store) {
      tx.executeSql('DROP TABLE IF EXISTS ' + store, []);
    });
  }, unknownError(callback), function () {
    if (utils.hasLocalStorage()) {
      delete global.localStorage['_pouch__websqldb_' + name];
      delete global.localStorage[name];
    }
    callback(null, {'ok': true});
  });
});

WebSqlPouch.Changes = new utils.Changes();

module.exports = WebSqlPouch;

}).call(this,typeof self !== "undefined" ? self : typeof window !== "undefined" ? window : {})
},{"../deps/errors":11,"../merge":18,"../utils":23,"vuvuzela":58}],6:[function(_dereq_,module,exports){
'use strict';
var utils = _dereq_('./utils');
var merge = _dereq_('./merge');
var errors = _dereq_('./deps/errors');
var EE = _dereq_('events').EventEmitter;
var evalFilter = _dereq_('./evalFilter');
var evalView = _dereq_('./evalView');
module.exports = Changes;
utils.inherits(Changes, EE);

function Changes(db, opts, callback) {
  EE.call(this);
  var self = this;
  this.db = db;
  opts = opts ? utils.clone(opts) : {};
  var oldComplete = callback || opts.complete || function () {};
  var complete = opts.complete = utils.once(function (err, resp) {
    if (err) {
      self.emit('error', err);
    } else {
      self.emit('complete', resp);
    }
    self.removeAllListeners();
    db.removeListener('destroyed', onDestroy);
  });
  if (oldComplete) {
    self.on('complete', function (resp) {
      oldComplete(null, resp);
    });
    self.on('error', function (err) {
      oldComplete(err);
    });
  }
  var oldOnChange = opts.onChange;
  if (oldOnChange) {
    self.on('change', oldOnChange);
  }
  function onDestroy() {
    self.cancel();
  }
  db.once('destroyed', onDestroy);

  opts.onChange = function (change) {
    if (opts.isCancelled) {
      return;
    }
    self.emit('change', change);
    if (self.startSeq && self.startSeq <= change.seq) {
      self.emit('uptodate');
      self.startSeq = false;
    }
    if (change.deleted) {
      self.emit('delete', change);
    } else if (change.changes.length === 1 &&
      change.changes[0].rev.slice(0, 2) === '1-') {
      self.emit('create', change);
    } else {
      self.emit('update', change);
    }
  };

  var promise = new utils.Promise(function (fulfill, reject) {
    opts.complete = function (err, res) {
      if (err) {
        reject(err);
      } else {
        fulfill(res);
      }
    };
  });
  self.once('cancel', function () {
    if (oldOnChange) {
      self.removeListener('change', oldOnChange);
    }
    opts.complete(null, {status: 'cancelled'});
  });
  this.then = promise.then.bind(promise);
  this['catch'] = promise['catch'].bind(promise);
  this.then(function (result) {
    complete(null, result);
  }, complete);



  if (!db.taskqueue.isReady) {
    db.taskqueue.addTask(function () {
      if (self.isCancelled) {
        self.emit('cancel');
      } else {
        self.doChanges(opts);
      }
    });
  } else {
    self.doChanges(opts);
  }
}
Changes.prototype.cancel = function () {
  this.isCancelled = true;
  if (this.db.taskqueue.isReady) {
    this.emit('cancel');
  }
};
function processChange(doc, metadata, opts) {
  var changeList = [{rev: doc._rev}];
  if (opts.style === 'all_docs') {
    changeList = merge.collectLeaves(metadata.rev_tree)
    .map(function (x) { return {rev: x.rev}; });
  }
  var change = {
    id: metadata.id,
    changes: changeList,
    doc: doc
  };

  if (utils.isDeleted(metadata, doc._rev)) {
    change.deleted = true;
  }
  if (opts.conflicts) {
    change.doc._conflicts = merge.collectConflicts(metadata);
    if (!change.doc._conflicts.length) {
      delete change.doc._conflicts;
    }
  }
  return change;
}

Changes.prototype.doChanges = function (opts) {
  var self = this;
  var callback = opts.complete;

  opts = utils.clone(opts);
  if ('live' in opts && !('continuous' in opts)) {
    opts.continuous = opts.live;
  }
  opts.processChange = processChange;

  if (opts.since === 'latest') {
    opts.since = 'now';
  }
  if (!opts.since) {
    opts.since = 0;
  }
  if (opts.since === 'now') {
    this.db.info().then(function (info) {
      if (self.isCancelled) {
        callback(null, {status: 'cancelled'});
        return;
      }
      opts.since = info.update_seq  - 1;
      self.doChanges(opts);
    }, callback);
    return;
  }

  if (opts.continuous && opts.since !== 'now') {
    this.db.info().then(function (info) {
      self.startSeq = info.update_seq - 1;
    }, function (err) {
      if (err.id === 'idbNull') {
        //db closed before this returned
        //thats ok
        return;
      }
      throw err;
    });
  }

  if (this.db.type() !== 'http' &&
    opts.filter && typeof opts.filter === 'string') {
    return this.filterChanges(opts);
  }

  if (!('descending' in opts)) {
    opts.descending = false;
  }

  // 0 and 1 should return 1 document
  opts.limit = opts.limit === 0 ? 1 : opts.limit;
  opts.complete = callback;
  var newPromise = this.db._changes(opts);
  if (newPromise && typeof newPromise.cancel === 'function') {
    var cancel = self.cancel;
    self.cancel = utils.getArguments(function (args) {
      newPromise.cancel();
      cancel.apply(this, args);
    });
  }
};

Changes.prototype.filterChanges = function (opts) {
  var self = this;
  var callback = opts.complete;
  if (opts.filter === '_view') {
    if (!opts.view || typeof opts.view !== 'string') {
      var err = new  Error('`view` filter parameter is not provided.');
      err.status = errors.BAD_REQUEST.status;
      err.name = errors.BAD_REQUEST.name;
      err.error = true;
      callback(err);
      return;
    }
    // fetch a view from a design doc, make it behave like a filter
    var viewName = opts.view.split('/');
    this.db.get('_design/' + viewName[0], function (err, ddoc) {
      if (self.isCancelled) {
        callback(null, {status: 'cancelled'});
        return;
      }
      if (err) {
        callback(err);
        return;
      }
      if (ddoc && ddoc.views && ddoc.views[viewName[1]]) {
        
        var filter = evalView(ddoc.views[viewName[1]].map);
        opts.filter = filter;
        self.doChanges(opts);
        return;
      }
      var msg = ddoc.views ? 'missing json key: ' + viewName[1] :
        'missing json key: views';
      if (!err) {
        err = new  Error(msg);
        err.status = errors.MISSING_DOC.status;
        err.name = errors.MISSING_DOC.name;
        err.error = true;
      }
      callback(err);
      return;
    });
  } else {
    // fetch a filter from a design doc
    var filterName = opts.filter.split('/');
    this.db.get('_design/' + filterName[0], function (err, ddoc) {
      if (self.isCancelled) {
        callback(null, {status: 'cancelled'});
        return;
      }
      if (err) {
        callback(err);
        return;
      }
      if (ddoc && ddoc.filters && ddoc.filters[filterName[1]]) {
        var filter = evalFilter(ddoc.filters[filterName[1]]);
        opts.filter = filter;
        self.doChanges(opts);
        return;
      } else {
        var msg = (ddoc && ddoc.filters) ? 'missing json key: ' + filterName[1]
          : 'missing json key: filters';
        if (!err) {
          err = new  Error(msg);
          err.status = errors.MISSING_DOC.status;
          err.name = errors.MISSING_DOC.name;
          err.error = true;
        }
        callback(err);
        return;
      }
    });
  }
};
},{"./deps/errors":11,"./evalFilter":15,"./evalView":16,"./merge":18,"./utils":23,"events":27}],7:[function(_dereq_,module,exports){
(function (global){
/*globals cordova */
"use strict";

var Adapter = _dereq_('./adapter');
var utils = _dereq_('./utils');
var TaskQueue = _dereq_('./taskqueue');
var Promise = utils.Promise;

function defaultCallback(err) {
  if (err && global.debug) {
    console.error(err);
  }
}

utils.inherits(PouchDB, Adapter);
function PouchDB(name, opts, callback) {

  if (!(this instanceof PouchDB)) {
    return new PouchDB(name, opts, callback);
  }
  var self = this;
  if (typeof opts === 'function' || typeof opts === 'undefined') {
    callback = opts;
    opts = {};
  }

  if (name && typeof name === 'object') {
    opts = name;
    name = undefined;
  }
  if (typeof callback === 'undefined') {
    callback = defaultCallback;
  }
  opts = opts || {};
  var oldCB = callback;
  self.auto_compaction = opts.auto_compaction;
  self.prefix = PouchDB.prefix;
  Adapter.call(self);
  self.taskqueue = new TaskQueue();
  var promise = new Promise(function (fulfill, reject) {
    callback = function (err, resp) {
      if (err) {
        return reject(err);
      }
      delete resp.then;
      fulfill(resp);
    };
  
    opts = utils.clone(opts);
    var originalName = opts.name || name;
    var backend, error;
    (function () {
      try {

        if (typeof originalName !== 'string') {
          error = new Error('Missing/invalid DB name');
          error.code = 400;
          throw error;
        }

        backend = PouchDB.parseAdapter(originalName, opts);
        
        opts.originalName = originalName;
        opts.name = backend.name;
        if (opts.prefix && backend.adapter !== 'http' &&
            backend.adapter !== 'https') {
          opts.name = opts.prefix + opts.name;
        }
        opts.adapter = opts.adapter || backend.adapter;
        self._adapter = opts.adapter;
        self._db_name = originalName;
        if (!PouchDB.adapters[opts.adapter]) {
          error = new Error('Adapter is missing');
          error.code = 404;
          throw error;
        }

        if (!PouchDB.adapters[opts.adapter].valid()) {
          error = new Error('Invalid Adapter');
          error.code = 404;
          throw error;
        }
      } catch (err) {
        self.taskqueue.fail(err);
        self.changes = utils.toPromise(function (opts) {
          if (opts.complete) {
            opts.complete(err);
          }
        });
      }
    }());
    if (error) {
      return reject(error); // constructor error, see above
    }
    self.adapter = opts.adapter;

    // needs access to PouchDB;
    self.replicate = {};

    self.replicate.from = function (url, opts, callback) {
      return self.constructor.replicate(url, self, opts, callback);
    };

    self.replicate.to = function (url, opts, callback) {
      return self.constructor.replicate(self, url, opts, callback);
    };

    self.sync = function (dbName, opts, callback) {
      return self.constructor.sync(self, dbName, opts, callback);
    };

    self.replicate.sync = self.sync;

    self.destroy = utils.adapterFun('destroy', function (callback) {
      var self = this;
      self.info(function (err, info) {
        if (err) {
          return callback(err);
        }
        self.constructor.destroy(info.db_name, callback);
      });
    });

    PouchDB.adapters[opts.adapter].call(self, opts, function (err, db) {
      if (err) {
        if (callback) {
          self.taskqueue.fail(err);
          callback(err);
        }
        return;
      }
      function destructionListener(event) {
        if (event === 'destroyed') {
          self.emit('destroyed');
          PouchDB.removeListener(originalName, destructionListener);
        }
      }
      PouchDB.on(originalName, destructionListener);
      self.emit('created', self);
      PouchDB.emit('created', opts.originalName);
      self.taskqueue.ready(self);
      callback(null, self);
      
    });
    if (opts.skipSetup) {
      self.taskqueue.ready(self);
    }

    if (utils.isCordova()) {
      //to inform websql adapter that we can use api
      cordova.fireWindowEvent(opts.name + "_pouch", {});
    }
  });
  promise.then(function (resp) {
    oldCB(null, resp);
  }, oldCB);
  self.then = promise.then.bind(promise);
  self["catch"] = promise["catch"].bind(promise);

}

module.exports = PouchDB;

}).call(this,typeof self !== "undefined" ? self : typeof window !== "undefined" ? window : {})
},{"./adapter":1,"./taskqueue":22,"./utils":23}],8:[function(_dereq_,module,exports){
"use strict";

var createBlob = _dereq_('./blob.js');
var errors = _dereq_('./errors');
var utils = _dereq_("../utils");
var hasUpload;

function ajax(options, adapterCallback) {

  var requestCompleted = false;
  var callback = utils.getArguments(function (args) {
    if (requestCompleted) {
      return;
    }
    adapterCallback.apply(this, args);
    requestCompleted = true;
  });

  if (typeof options === "function") {
    callback = options;
    options = {};
  }

  options = utils.clone(options);

  var defaultOptions = {
    method : "GET",
    headers: {},
    json: true,
    processData: true,
    timeout: 10000,
    cache: false
  };

  options = utils.extend(true, defaultOptions, options);

  // cache-buster, specifically designed to work around IE's aggressive caching
  // see http://www.dashbay.com/2011/05/internet-explorer-caches-ajax/
  if (options.method === 'GET' && !options.cache) {
    var hasArgs = options.url.indexOf('?') !== -1;
    options.url += (hasArgs ? '&' : '?') + '_nonce=' + utils.uuid(16);
  }

  function onSuccess(obj, resp, cb) {
    if (!options.binary && !options.json && options.processData &&
      typeof obj !== 'string') {
      obj = JSON.stringify(obj);
    } else if (!options.binary && options.json && typeof obj === 'string') {
      try {
        obj = JSON.parse(obj);
      } catch (e) {
        // Probably a malformed JSON from server
        return cb(e);
      }
    }
    if (Array.isArray(obj)) {
      obj = obj.map(function (v) {
        var obj;
        if (v.ok) {
          return v;
        } else if (v.error && v.error === 'conflict') {
          obj = errors.REV_CONFLICT;
          obj.id = v.id;
          return obj;
        } else if (v.error && v.error === 'forbidden') {
          obj = errors.FORBIDDEN;
          obj.id = v.id;
          obj.reason = v.reason;
          return obj;
        } else if (v.missing) {
          obj = errors.MISSING_DOC;
          obj.missing = v.missing;
          return obj;
        } else {
          return v;
        }
      });
    }
    cb(null, obj, resp);
  }

  function onError(err, cb) {
    var errParsed, errObj, errType, key;
    try {
      errParsed = JSON.parse(err.responseText);
      //would prefer not to have a try/catch clause
      for (key in errors) {
        if (errors.hasOwnProperty(key) &&
            errors[key].name === errParsed.error) {
          errType = errors[key];
          break;
        }
      }
      if (!errType) {
        errType = errors.UNKNOWN_ERROR;
        if (err.status) {
          errType.status = err.status;
        }
        if (err.statusText) {
          err.name = err.statusText;
        }
      }
      errObj = errors.error(errType, errParsed.reason);
    } catch (e) {
      for (var key in errors) {
        if (errors.hasOwnProperty(key) && errors[key].status === err.status) {
          errType = errors[key];
          break;
        }
      }
      if (!errType) {
        errType = errors.UNKNOWN_ERROR;
        if (err.status) {
          errType.status = err.status;
        }
        if (err.statusText) {
          err.name = err.statusText;
        }
      }
      errObj = errors.error(errType);
    }
    if (err.withCredentials && err.status === 0) {
      // apparently this is what we get when the method
      // is reported as not allowed by CORS. so fudge it
      errObj.status = 405;
      errObj.statusText = "Method Not Allowed";
    }
    cb(errObj);
  }

  var timer;
  var xhr;
  if (options.xhr) {
    xhr = new options.xhr();
  } else {
    xhr = new XMLHttpRequest();
  }
  xhr.open(options.method, options.url);
  xhr.withCredentials = true;

  if (options.json) {
    options.headers.Accept = 'application/json';
    options.headers['Content-Type'] = options.headers['Content-Type'] ||
      'application/json';
    if (options.body &&
        options.processData &&
        typeof options.body !== "string") {
      options.body = JSON.stringify(options.body);
    }
  }

  if (options.binary) {
    xhr.responseType = 'arraybuffer';
  }

  var createCookie = function (name, value, days) {
    var expires = "";
    if (days) {
      var date = new Date();
      date.setTime(date.getTime() + (days * 24 * 60 * 60 * 1000));
      expires = "; expires=" + date.toGMTString();
    }
    document.cookie = name + "=" + value + expires + "; path=/";
  };

  for (var key in options.headers) {
    if (key === 'Cookie') {
      var cookie = options.headers[key].split('=');
      createCookie(cookie[0], cookie[1], 10);
    } else {
      xhr.setRequestHeader(key, options.headers[key]);
    }
  }

  if (!("body" in options)) {
    options.body = null;
  }

  var abortReq = function () {
    if (requestCompleted) {
      return;
    }
    xhr.abort();
    onError(xhr, callback);
  };

  xhr.onreadystatechange = function () {
    if (xhr.readyState !== 4 || requestCompleted) {
      return;
    }
    clearTimeout(timer);
    if (xhr.status >= 200 && xhr.status < 300) {
      var data;
      if (options.binary) {
        data = createBlob([xhr.response || ''], {
          type: xhr.getResponseHeader('Content-Type')
        });
      } else {
        data = xhr.responseText;
      }
      onSuccess(data, xhr, callback);
    } else {
      onError(xhr, callback);
    }
  };

  if (options.timeout > 0) {
    timer = setTimeout(abortReq, options.timeout);
    xhr.onprogress = function () {
      clearTimeout(timer);
      timer = setTimeout(abortReq, options.timeout);
    };
    if (typeof hasUpload === 'undefined') {
      // IE throws an error if you try to access it directly
      hasUpload = Object.keys(xhr).indexOf('upload') !== -1;
    }
    if (hasUpload) { // does not exist in ie9
      xhr.upload.onprogress = xhr.onprogress;
    }
  }
  if (options.body && (options.body instanceof Blob)) {
    var reader = new FileReader();
    reader.onloadend = function (e) {

      var binary = "";
      var bytes = new Uint8Array(this.result);
      var length = bytes.byteLength;

      for (var i = 0; i < length; i++) {
        binary += String.fromCharCode(bytes[i]);
      }

      binary = utils.fixBinary(binary);
      xhr.send(binary);
    };
    reader.readAsArrayBuffer(options.body);
  } else {
    xhr.send(options.body);
  }
  return {abort: abortReq};
}

module.exports = ajax;

},{"../utils":23,"./blob.js":9,"./errors":11}],9:[function(_dereq_,module,exports){
(function (global){
"use strict";

//Abstracts constructing a Blob object, so it also works in older
//browsers that don't support the native Blob constructor. (i.e.
//old QtWebKit versions, at least).
function createBlob(parts, properties) {
  parts = parts || [];
  properties = properties || {};
  try {
    return new Blob(parts, properties);
  } catch (e) {
    if (e.name !== "TypeError") {
      throw e;
    }
    var BlobBuilder = global.BlobBuilder ||
                      global.MSBlobBuilder ||
                      global.MozBlobBuilder ||
                      global.WebKitBlobBuilder;
    var builder = new BlobBuilder();
    for (var i = 0; i < parts.length; i += 1) {
      builder.append(parts[i]);
    }
    return builder.getBlob(properties.type);
  }
}

module.exports = createBlob;


}).call(this,typeof self !== "undefined" ? self : typeof window !== "undefined" ? window : {})
},{}],10:[function(_dereq_,module,exports){
'use strict';
exports.Map = LazyMap; // TODO: use ES6 map
exports.Set = LazySet; // TODO: use ES6 set
// based on https://github.com/montagejs/collections
function LazyMap() {
  this.store = {};
}
LazyMap.prototype.mangle = function (key) {
  if (typeof key !== "string") {
    throw new TypeError("key must be a string but Got " + key);
  }
  return '$' + key;
};
LazyMap.prototype.unmangle = function (key) {
  return key.substring(1);
};
LazyMap.prototype.get = function (key) {
  var mangled = this.mangle(key);
  if (mangled in this.store) {
    return this.store[mangled];
  } else {
    return void 0;
  }
};
LazyMap.prototype.set = function (key, value) {
  var mangled = this.mangle(key);
  this.store[mangled] = value;
  return true;
};
LazyMap.prototype.has = function (key) {
  var mangled = this.mangle(key);
  return mangled in this.store;
};
LazyMap.prototype["delete"] = function (key) {
  var mangled = this.mangle(key);
  if (mangled in this.store) {
    delete this.store[mangled];
    return true;
  }
  return false;
};
LazyMap.prototype.forEach = function (cb) {
  var self = this;
  var keys = Object.keys(self.store);
  keys.forEach(function (key) {
    var value = self.store[key];
    key = self.unmangle(key);
    cb(value, key);
  });
};

function LazySet() {
  this.store = new LazyMap();
}
LazySet.prototype.add = function (key) {
  return this.store.set(key, true);
};
LazySet.prototype.has = function (key) {
  return this.store.has(key);
};
LazySet.prototype["delete"] = function (key) {
  return this.store["delete"](key);
};
},{}],11:[function(_dereq_,module,exports){
"use strict";

function PouchError(opts) {
  this.status = opts.status;
  this.name = opts.error;
  this.message = opts.reason;
  this.error = true;
}

PouchError.prototype__proto__ = Error.prototype;

PouchError.prototype.toString = function () {
  return JSON.stringify({
    status: this.status,
    name: this.name,
    message: this.message
  });
};

exports.UNAUTHORIZED = new PouchError({
  status: 401,
  error: 'unauthorized',
  reason: "Name or password is incorrect."
});
exports.MISSING_BULK_DOCS = new PouchError({
  status: 400,
  error: 'bad_request',
  reason: "Missing JSON list of 'docs'"
});
exports.MISSING_DOC = new PouchError({
  status: 404,
  error: 'not_found',
  reason: 'missing'
});
exports.REV_CONFLICT = new PouchError({
  status: 409,
  error: 'conflict',
  reason: 'Document update conflict'
});
exports.INVALID_ID = new PouchError({
  status: 400,
  error: 'invalid_id',
  reason: '_id field must contain a string'
});
exports.MISSING_ID = new PouchError({
  status: 412,
  error: 'missing_id',
  reason: '_id is required for puts'
});
exports.RESERVED_ID = new PouchError({
  status: 400,
  error: 'bad_request',
  reason: 'Only reserved document ids may start with underscore.'
});
exports.NOT_OPEN = new PouchError({
  status: 412,
  error: 'precondition_failed',
  reason: 'Database not open'
});
exports.UNKNOWN_ERROR = new PouchError({
  status: 500,
  error: 'unknown_error',
  reason: 'Database encountered an unknown error'
});
exports.BAD_ARG = new PouchError({
  status: 500,
  error: 'badarg',
  reason: 'Some query argument is invalid'
});
exports.INVALID_REQUEST = new PouchError({
  status: 400,
  error: 'invalid_request',
  reason: 'Request was invalid'
});
exports.QUERY_PARSE_ERROR = new PouchError({
  status: 400,
  error: 'query_parse_error',
  reason: 'Some query parameter is invalid'
});
exports.DOC_VALIDATION = new PouchError({
  status: 500,
  error: 'doc_validation',
  reason: 'Bad special document member'
});
exports.BAD_REQUEST = new PouchError({
  status: 400,
  error: 'bad_request',
  reason: 'Something wrong with the request'
});
exports.NOT_AN_OBJECT = new PouchError({
  status: 400,
  error: 'bad_request',
  reason: 'Document must be a JSON object'
});
exports.DB_MISSING = new PouchError({
  status: 404,
  error: 'not_found',
  reason: 'Database not found'
});
exports.IDB_ERROR = new PouchError({
  status: 500,
  error: 'indexed_db_went_bad',
  reason: 'unknown'
});
exports.WSQ_ERROR = new PouchError({
  status: 500,
  error: 'web_sql_went_bad',
  reason: 'unknown'
});
exports.LDB_ERROR = new PouchError({
  status: 500,
  error: 'levelDB_went_went_bad',
  reason: 'unknown'
});
exports.FORBIDDEN = new PouchError({
  status: 403,
  error: 'forbidden',
  reason: 'Forbidden by design doc validate_doc_update function'
});
exports.error = function (error, reason, name) {
  function CustomPouchError(msg) {
    this.message = reason;
    if (name) {
      this.name = name;
    }
  }
  CustomPouchError.prototype = error;
  return new CustomPouchError(reason);
};

},{}],12:[function(_dereq_,module,exports){
(function (process,global){
'use strict';

var crypto = _dereq_('crypto');
var Md5 = _dereq_('spark-md5');
var setImmediateShim = global.setImmediate || global.setTimeout;

function sliceShim(arrayBuffer, begin, end) {
  if (typeof arrayBuffer.slice === 'function') {
    if (!begin) {
      return arrayBuffer.slice();
    } else if (!end) {
      return arrayBuffer.slice(begin);
    } else {
      return arrayBuffer.slice(begin, end);
    }
  }
  //
  // shim for IE courtesy of http://stackoverflow.com/a/21440217
  //

  //If `begin`/`end` is unspecified, Chrome assumes 0, so we do the same
  //Chrome also converts the values to integers via flooring
  begin = Math.floor(begin || 0);
  end = Math.floor(end || 0);

  var len = arrayBuffer.byteLength;

  //If either `begin` or `end` is negative, it refers to an
  //index from the end of the array, as opposed to from the beginning.
  //The range specified by the `begin` and `end` values is clamped to the
  //valid index range for the current array.
  begin = begin < 0 ? Math.max(begin + len, 0) : Math.min(len, begin);
  end = end < 0 ? Math.max(end + len, 0) : Math.min(len, end);

  //If the computed length of the new ArrayBuffer would be negative, it
  //is clamped to zero.
  if (end - begin <= 0) {
    return new ArrayBuffer(0);
  }

  var result = new ArrayBuffer(end - begin);
  var resultBytes = new Uint8Array(result);
  var sourceBytes = new Uint8Array(arrayBuffer, begin, end - begin);

  resultBytes.set(sourceBytes);

  return result;
}

// convert a 64-bit int to a binary string
function intToString(int) {
  var bytes = [
    (int & 0xff),
    ((int >>> 8) & 0xff),
    ((int >>> 16) & 0xff),
    ((int >>> 24) & 0xff)
  ];
  return bytes.map(function (byte) {
    return String.fromCharCode(byte);
  }).join('');
}

// convert an array of 64-bit ints into
// a base64-encoded string
function rawToBase64(raw) {
  var res = '';
  for (var i = 0; i < raw.length; i++) {
    res += intToString(raw[i]);
  }
  return global.btoa(res);
}

module.exports = function (data, callback) {
  if (!process.browser) {
    var base64 = crypto.createHash('md5').update(data).digest('base64');
    callback(null, base64);
    return;
  }
  var inputIsString = typeof data === 'string';
  var len = inputIsString ? data.length : data.byteLength;
  var chunkSize = Math.min(524288, len);
  var chunks = Math.ceil(len / chunkSize);
  var currentChunk = 0;
  var buffer = inputIsString ? new Md5() : new Md5.ArrayBuffer();

  function append(buffer, data, start, end) {
    if (inputIsString) {
      buffer.appendBinary(data.substring(start, end));
    } else {
      buffer.append(sliceShim(data, start, end));
    }
  }

  function loadNextChunk() {
    var start = currentChunk * chunkSize;
    var end = start + chunkSize;
    if ((start + chunkSize) >= data.size) {
      end = data.size;
    }
    currentChunk++;
    if (currentChunk < chunks) {
      append(buffer, data, start, end);
      setImmediateShim(loadNextChunk);
    } else {
      append(buffer, data, start, end);
      var raw = buffer.end(true);
      var base64 = rawToBase64(raw);
      callback(null, base64);
      buffer.destroy();
    }
  }
  loadNextChunk();
};

}).call(this,_dereq_("/Users/nolan/workspace/pouchdb/node_modules/browserify/node_modules/insert-module-globals/node_modules/process/browser.js"),typeof self !== "undefined" ? self : typeof window !== "undefined" ? window : {})
},{"/Users/nolan/workspace/pouchdb/node_modules/browserify/node_modules/insert-module-globals/node_modules/process/browser.js":28,"crypto":26,"spark-md5":57}],13:[function(_dereq_,module,exports){
'use strict';
var Promise = _dereq_('../utils').Promise;

// this is essentially the "update sugar" function from daleharvey/pouchdb#1388
// the diffFun tells us what delta to apply to the doc.  it either returns
// the doc, or false if it doesn't need to do an update after all
function upsert(db, docId, diffFun) {
  return new Promise(function (fulfill, reject) {
    if (docId && typeof docId === 'object') {
      docId = docId._id;
    }
    if (typeof docId !== 'string') {
      return reject(new Error('doc id is required'));
    }

    db.get(docId, function (err, doc) {
      if (err) {
        if (err.status !== 404) {
          return reject(err);
        }
        return fulfill(tryAndPut(db, diffFun({_id : docId}), diffFun));
      }
      var newDoc = diffFun(doc);
      if (!newDoc) {
        return fulfill(doc);
      }
      fulfill(tryAndPut(db, newDoc, diffFun));
    });
  });
}

function tryAndPut(db, doc, diffFun) {
  return db.put(doc)["catch"](function (err) {
    if (err.status !== 409) {
      throw err;
    }
    return upsert(db, doc, diffFun);
  });
}

module.exports = function (db, docId, diffFun, cb) {
  if (typeof cb === 'function') {
    upsert(db, docId, diffFun).then(function (resp) {
      cb(null, resp);
    }, cb);
  } else {
    return upsert(db, docId, diffFun);
  }
};

},{"../utils":23}],14:[function(_dereq_,module,exports){
"use strict";

// BEGIN Math.uuid.js

/*!
Math.uuid.js (v1.4)
http://www.broofa.com
mailto:robert@broofa.com

Copyright (c) 2010 Robert Kieffer
Dual licensed under the MIT and GPL licenses.
*/

/*
 * Generate a random uuid.
 *
 * USAGE: Math.uuid(length, radix)
 *   length - the desired number of characters
 *   radix  - the number of allowable values for each character.
 *
 * EXAMPLES:
 *   // No arguments  - returns RFC4122, version 4 ID
 *   >>> Math.uuid()
 *   "92329D39-6F5C-4520-ABFC-AAB64544E172"
 *
 *   // One argument - returns ID of the specified length
 *   >>> Math.uuid(15)     // 15 character ID (default base=62)
 *   "VcydxgltxrVZSTV"
 *
 *   // Two arguments - returns ID of the specified length, and radix. 
 *   // (Radix must be <= 62)
 *   >>> Math.uuid(8, 2)  // 8 character ID (base=2)
 *   "01001010"
 *   >>> Math.uuid(8, 10) // 8 character ID (base=10)
 *   "47473046"
 *   >>> Math.uuid(8, 16) // 8 character ID (base=16)
 *   "098F4D35"
 */
var chars = (
  '0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ' +
  'abcdefghijklmnopqrstuvwxyz'
).split('');
function getValue(radix) {
  return 0 | Math.random() * radix;
}
function uuid(len, radix) {
  radix = radix || chars.length;
  var out = '';
  var i = -1;

  if (len) {
    // Compact form
    while (++i < len) {
      out += chars[getValue(radix)];
    }
    return out;
  }
    // rfc4122, version 4 form
    // Fill in random data.  At i==19 set the high bits of clock sequence as
    // per rfc4122, sec. 4.1.5
  while (++i < 36) {
    switch (i) {
      case 8:
      case 13:
      case 18:
      case 23:
        out += '-';
        break;
      case 19:
        out += chars[(getValue(16) & 0x3) | 0x8];
        break;
      default:
        out += chars[getValue(16)];
    }
  }

  return out;
}



module.exports = uuid;


},{}],15:[function(_dereq_,module,exports){
'use strict';

module.exports = evalFilter;
function evalFilter(input) {
  /*jshint evil: true */
  return eval([
    '(function () { return ',
    input,
    ' })()'
  ].join(''));
}
},{}],16:[function(_dereq_,module,exports){
'use strict';

module.exports = evalView;
function evalView(input) {
  /*jshint evil: true */
  return eval([
    '(function () {',
    '  return function (doc) {',
    '    var emitted = false;',
    '    var emit = function (a, b) {',
    '      emitted = true;',
    '    };',
    '    var view = ' + input + ';',
    '    view(doc);',
    '    if (emitted) {',
    '      return true;',
    '    }',
    '  }',
    '})()'
  ].join('\n'));
}
},{}],17:[function(_dereq_,module,exports){
(function (process){
"use strict";

var PouchDB = _dereq_('./setup');

module.exports = PouchDB;

PouchDB.ajax = _dereq_('./deps/ajax');
PouchDB.extend = _dereq_('pouchdb-extend');
PouchDB.utils = _dereq_('./utils');
PouchDB.Errors = _dereq_('./deps/errors');
PouchDB.replicate = _dereq_('./replicate').replicate;
PouchDB.sync = _dereq_('./sync');
PouchDB.version = _dereq_('./version');
var httpAdapter = _dereq_('./adapters/http');
PouchDB.adapter('http', httpAdapter);
PouchDB.adapter('https', httpAdapter);

PouchDB.adapter('idb', _dereq_('./adapters/idb'));
PouchDB.adapter('websql', _dereq_('./adapters/websql'));
PouchDB.plugin(_dereq_('pouchdb-mapreduce'));

if (!process.browser) {
  var ldbAdapter = _dereq_('./adapters/leveldb');
  PouchDB.adapter('ldb', ldbAdapter);
  PouchDB.adapter('leveldb', ldbAdapter);
}

}).call(this,_dereq_("/Users/nolan/workspace/pouchdb/node_modules/browserify/node_modules/insert-module-globals/node_modules/process/browser.js"))
},{"./adapters/http":2,"./adapters/idb":3,"./adapters/leveldb":26,"./adapters/websql":5,"./deps/ajax":8,"./deps/errors":11,"./replicate":19,"./setup":20,"./sync":21,"./utils":23,"./version":24,"/Users/nolan/workspace/pouchdb/node_modules/browserify/node_modules/insert-module-globals/node_modules/process/browser.js":28,"pouchdb-extend":48,"pouchdb-mapreduce":51}],18:[function(_dereq_,module,exports){
'use strict';
var extend = _dereq_('pouchdb-extend');


// for a better overview of what this is doing, read:
// https://github.com/apache/couchdb/blob/master/src/couchdb/couch_key_tree.erl
//
// But for a quick intro, CouchDB uses a revision tree to store a documents
// history, A -> B -> C, when a document has conflicts, that is a branch in the
// tree, A -> (B1 | B2 -> C), We store these as a nested array in the format
//
// KeyTree = [Path ... ]
// Path = {pos: position_from_root, ids: Tree}
// Tree = [Key, Opts, [Tree, ...]], in particular single node: [Key, []]

// Turn a path as a flat array into a tree with a single branch
function pathToTree(path) {
  var doc = path.shift();
  var root = [doc.id, doc.opts, []];
  var leaf = root;
  var nleaf;

  while (path.length) {
    doc = path.shift();
    nleaf = [doc.id, doc.opts, []];
    leaf[2].push(nleaf);
    leaf = nleaf;
  }
  return root;
}

// Merge two trees together
// The roots of tree1 and tree2 must be the same revision
function mergeTree(in_tree1, in_tree2) {
  var queue = [{tree1: in_tree1, tree2: in_tree2}];
  var conflicts = false;
  while (queue.length > 0) {
    var item = queue.pop();
    var tree1 = item.tree1;
    var tree2 = item.tree2;

    if (tree1[1].status || tree2[1].status) {
      tree1[1].status =
        (tree1[1].status ===  'available' ||
         tree2[1].status === 'available') ? 'available' : 'missing';
    }

    for (var i = 0; i < tree2[2].length; i++) {
      if (!tree1[2][0]) {
        conflicts = 'new_leaf';
        tree1[2][0] = tree2[2][i];
        continue;
      }

      var merged = false;
      for (var j = 0; j < tree1[2].length; j++) {
        if (tree1[2][j][0] === tree2[2][i][0]) {
          queue.push({tree1: tree1[2][j], tree2: tree2[2][i]});
          merged = true;
        }
      }
      if (!merged) {
        conflicts = 'new_branch';
        tree1[2].push(tree2[2][i]);
        tree1[2].sort();
      }
    }
  }
  return {conflicts: conflicts, tree: in_tree1};
}

function doMerge(tree, path, dontExpand) {
  var restree = [];
  var conflicts = false;
  var merged = false;
  var res;

  if (!tree.length) {
    return {tree: [path], conflicts: 'new_leaf'};
  }

  tree.forEach(function (branch) {
    if (branch.pos === path.pos && branch.ids[0] === path.ids[0]) {
      // Paths start at the same position and have the same root, so they need
      // merged
      res = mergeTree(branch.ids, path.ids);
      restree.push({pos: branch.pos, ids: res.tree});
      conflicts = conflicts || res.conflicts;
      merged = true;
    } else if (dontExpand !== true) {
      // The paths start at a different position, take the earliest path and
      // traverse up until it as at the same point from root as the path we
      // want to merge.  If the keys match we return the longer path with the
      // other merged After stemming we dont want to expand the trees

      var t1 = branch.pos < path.pos ? branch : path;
      var t2 = branch.pos < path.pos ? path : branch;
      var diff = t2.pos - t1.pos;

      var candidateParents = [];

      var trees = [];
      trees.push({ids: t1.ids, diff: diff, parent: null, parentIdx: null});
      while (trees.length > 0) {
        var item = trees.pop();
        if (item.diff === 0) {
          if (item.ids[0] === t2.ids[0]) {
            candidateParents.push(item);
          }
          continue;
        }
        if (!item.ids) {
          continue;
        }
        /*jshint loopfunc:true */
        item.ids[2].forEach(function (el, idx) {
          trees.push(
            {ids: el, diff: item.diff - 1, parent: item.ids, parentIdx: idx});
        });
      }

      var el = candidateParents[0];

      if (!el) {
        restree.push(branch);
      } else {
        res = mergeTree(el.ids, t2.ids);
        el.parent[2][el.parentIdx] = res.tree;
        restree.push({pos: t1.pos, ids: t1.ids});
        conflicts = conflicts || res.conflicts;
        merged = true;
      }
    } else {
      restree.push(branch);
    }
  });

  // We didnt find
  if (!merged) {
    restree.push(path);
  }

  restree.sort(function (a, b) {
    return a.pos - b.pos;
  });

  return {
    tree: restree,
    conflicts: conflicts || 'internal_node'
  };
}

// To ensure we dont grow the revision tree infinitely, we stem old revisions
function stem(tree, depth) {
  // First we break out the tree into a complete list of root to leaf paths,
  // we cut off the start of the path and generate a new set of flat trees
  var stemmedPaths = PouchMerge.rootToLeaf(tree).map(function (path) {
    var stemmed = path.ids.slice(-depth);
    return {
      pos: path.pos + (path.ids.length - stemmed.length),
      ids: pathToTree(stemmed)
    };
  });
  // Then we remerge all those flat trees together, ensuring that we dont
  // connect trees that would go beyond the depth limit
  return stemmedPaths.reduce(function (prev, current, i, arr) {
    return doMerge(prev, current, true).tree;
  }, [stemmedPaths.shift()]);
}

var PouchMerge = {};

PouchMerge.merge = function (tree, path, depth) {
  // Ugh, nicer way to not modify arguments in place?
  tree = extend(true, [], tree);
  path = extend(true, {}, path);
  var newTree = doMerge(tree, path);
  return {
    tree: stem(newTree.tree, depth),
    conflicts: newTree.conflicts
  };
};

// We fetch all leafs of the revision tree, and sort them based on tree length
// and whether they were deleted, undeleted documents with the longest revision
// tree (most edits) win
// The final sort algorithm is slightly documented in a sidebar here:
// http://guide.couchdb.org/draft/conflicts.html
PouchMerge.winningRev = function (metadata) {
  var leafs = [];
  PouchMerge.traverseRevTree(metadata.rev_tree,
                              function (isLeaf, pos, id, something, opts) {
    if (isLeaf) {
      leafs.push({pos: pos, id: id, deleted: !!opts.deleted});
    }
  });
  leafs.sort(function (a, b) {
    if (a.deleted !== b.deleted) {
      return a.deleted > b.deleted ? 1 : -1;
    }
    if (a.pos !== b.pos) {
      return b.pos - a.pos;
    }
    return a.id < b.id ? 1 : -1;
  });

  return leafs[0].pos + '-' + leafs[0].id;
};

// Pretty much all below can be combined into a higher order function to
// traverse revisions
// The return value from the callback will be passed as context to all
// children of that node
PouchMerge.traverseRevTree = function (revs, callback) {
  var toVisit = revs.slice();

  var node;
  while ((node = toVisit.pop())) {
    var pos = node.pos;
    var tree = node.ids;
    var branches = tree[2];
    var newCtx =
      callback(branches.length === 0, pos, tree[0], node.ctx, tree[1]);
    for (var i = 0, len = branches.length; i < len; i++) {
      toVisit.push({pos: pos + 1, ids: branches[i], ctx: newCtx});
    }
  }
};

PouchMerge.collectLeaves = function (revs) {
  var leaves = [];
  PouchMerge.traverseRevTree(revs, function (isLeaf, pos, id, acc, opts) {
    if (isLeaf) {
      leaves.unshift({rev: pos + "-" + id, pos: pos, opts: opts});
    }
  });
  leaves.sort(function (a, b) {
    return b.pos - a.pos;
  });
  leaves.map(function (leaf) { delete leaf.pos; });
  return leaves;
};

// returns revs of all conflicts that is leaves such that
// 1. are not deleted and
// 2. are different than winning revision
PouchMerge.collectConflicts = function (metadata) {
  var win = PouchMerge.winningRev(metadata);
  var leaves = PouchMerge.collectLeaves(metadata.rev_tree);
  var conflicts = [];
  leaves.forEach(function (leaf) {
    if (leaf.rev !== win && !leaf.opts.deleted) {
      conflicts.push(leaf.rev);
    }
  });
  return conflicts;
};

PouchMerge.rootToLeaf = function (tree) {
  var paths = [];
  PouchMerge.traverseRevTree(tree, function (isLeaf, pos, id, history, opts) {
    history = history ? history.slice(0) : [];
    history.push({id: id, opts: opts});
    if (isLeaf) {
      var rootPos = pos + 1 - history.length;
      paths.unshift({pos: rootPos, ids: history});
    }
    return history;
  });
  return paths;
};


module.exports = PouchMerge;

},{"pouchdb-extend":48}],19:[function(_dereq_,module,exports){
'use strict';

var utils = _dereq_('./utils');
var EE = _dereq_('events').EventEmitter;

var MAX_SIMULTANEOUS_REVS = 50;

// We create a basic promise so the caller can cancel the replication possibly
// before we have actually started listening to changes etc
utils.inherits(Replication, EE);
function Replication(opts) {
  EE.call(this);
  this.cancelled = false;
  var self = this;
  var promise = new utils.Promise(function (fulfill, reject) {
    self.once('complete', fulfill);
    self.once('error', reject);
  });
  self.then = function (resolve, reject) {
    return promise.then(resolve, reject);
  };
  self["catch"] = function (reject) {
    return promise["catch"](reject);
  };
  // As we allow error handling via "error" event as well,
  // put a stub in here so that rejecting never throws UnhandledError.
  self["catch"](function (err) {});
}

Replication.prototype.cancel = function () {
  this.cancelled = true;
  this.emit('cancel');
};

Replication.prototype.ready = function (src, target) {
  var self = this;
  function onDestroy() {
    self.cancel();
  }
  src.once('destroyed', onDestroy);
  target.once('destroyed', onDestroy);
  function cleanup() {
    src.removeListener('destroyed', onDestroy);
    target.removeListener('destroyed', onDestroy);
  }
  this.then(cleanup, cleanup);
};


// TODO: check CouchDB's replication id generation
// Generate a unique id particular to this replication
function genReplicationId(src, target, opts) {
  var filterFun = opts.filter ? opts.filter.toString() : '';
  return src.id().then(function (src_id) {
    return target.id().then(function (target_id) {
      var queryData = src_id + target_id + filterFun +
        JSON.stringify(opts.query_params) + opts.doc_ids;
      return utils.MD5(queryData).then(function (md5) {
        // can't use straight-up md5 alphabet, because
        // the char '/' is interpreted as being for attachments,
        // and + is also not url-safe
        md5 = md5.replace(/\//g, '.').replace(/\+/g, '_');
        return '_local/' + md5;
      });
    });
  });
}


function updateCheckpoint(db, id, checkpoint, returnValue) {
    return db.get(id)["catch"](function (err) {
      if (err.status === 404) {
        return {_id: id};
      }
      throw err;
    }).then(function (doc) {
      if (returnValue.cancelled) {
        return;
      }
      doc.last_seq = checkpoint;
      return db.put(doc);
    });
  }

function Checkpointer(src, target, id, returnValue) {
  this.src = src;
  this.target = target;
  this.id = id;
  this.returnValue = returnValue;
}

Checkpointer.prototype.writeCheckpoint = function (checkpoint) {
  var self = this;
  return this.updateTarget(checkpoint).then(function () {
    return self.updateSource(checkpoint);
  });
};
Checkpointer.prototype.updateTarget = function (checkpoint) {
  return updateCheckpoint(this.target, this.id, checkpoint, this.returnValue);
};
Checkpointer.prototype.updateSource = function (checkpoint) {
  var self = this;
  if (this.readOnlySource) {
    return utils.Promise.resolve(true);
  }
  return updateCheckpoint(this.src, this.id, checkpoint, this.returnValue)[
    "catch"](function (err) {
    var isForbidden = typeof err.status === 'number' &&
      Math.floor(err.status / 100) === 4;
    if (isForbidden) {
      self.readOnlySource = true;
      return true;
    }
    throw err;
  });
};
Checkpointer.prototype.getCheckpoint = function () {
  var self = this;
  return self.target.get(self.id).then(function (targetDoc) {
    return self.src.get(self.id).then(function (sourceDoc) {
      if (targetDoc.last_seq === sourceDoc.last_seq) {
        return sourceDoc.last_seq;
      }
      return 0;
    }, function (err) {
      if (err.status === 404 && targetDoc.last_seq) {
        return self.src.put({
          _id: self.id,
          last_seq: 0
        }).then(function () {
          return 0;
        }, function (err) {
          if (err.status === 401) {
            self.readOnlySource = true;
            return targetDoc.last_seq;
          }
          return 0;
        });
      }
      throw err;
    });
  })["catch"](function (err) {
    if (err.status !== 404) {
      throw err;
    }
    return 0;
  });
};
function replicate(repId, src, target, opts, returnValue) {
  var batches = [];               // list of batches to be processed
  var currentBatch;               // the batch currently being processed
  var pendingBatch = {
    seq: 0,
    changes: [],
    docs: []
  }; // next batch, not yet ready to be processed
  var writingCheckpoint = false;  // true while checkpoint is being written
  var changesCompleted = false;   // true when all changes received
  var replicationCompleted = false; // true when replication has completed
  var last_seq = 0;
  var continuous = opts.continuous || opts.live || false;
  var batch_size = opts.batch_size || 100;
  var batches_limit = opts.batches_limit || 10;
  var changesPending = false;     // true while src.changes is running
  var doc_ids = opts.doc_ids;
  var checkpointer = new Checkpointer(src, target, repId, returnValue);
  var result = {
    ok: true,
    start_time: new Date(),
    docs_read: 0,
    docs_written: 0,
    doc_write_failures: 0,
    errors: []
  };
  var changesOpts = {};
  returnValue.ready(src, target);


  function writeDocs() {
    if (currentBatch.docs.length === 0) {
      return;
    }
    var docs = currentBatch.docs;
    return target.bulkDocs({
      docs: docs
    }, {
      new_edits: false
    }).then(function (res) {
      if (returnValue.cancelled) {
        completeReplication();
        throw new Error('cancelled');
      }
      var errors = [];
      res.forEach(function (res) {
        if (res.error) {
          result.doc_write_failures++;
          var error = new Error(res.reason || res.message || 'Unknown reason');
          error.name = res.name || res.error;
          errors.push(error);
        }
      });
      result.errors = result.errors.concat(errors);
      result.docs_written += currentBatch.docs.length - errors.length;
      var non403s = errors.filter(function (error) {
        return error.name !== 'unauthorized' && error.name !== 'forbidden';
      });
      if (non403s.length > 0) {
        var error = new Error('bulkDocs error');
        error.other_errors = errors;
        abortReplication('target.bulkDocs failed to write docs', error);
        throw new Error('bulkWrite partial failure');
      }
    }, function (err) {
      result.doc_write_failures += docs.length;
      throw err;
    });
  }


  function getNextDoc() {
    var diffs = currentBatch.diffs;
    var id = Object.keys(diffs)[0];
    var allMissing = diffs[id].missing;
    // avoid url too long error by batching
    var missingBatches = [];
    for (var i = 0; i < allMissing.length; i += MAX_SIMULTANEOUS_REVS) {
      missingBatches.push(allMissing.slice(i, Math.min(allMissing.length,
        i + MAX_SIMULTANEOUS_REVS)));
    }

    return utils.Promise.all(missingBatches.map(function (missing) {
      return src.get(id, {revs: true, open_revs: missing, attachments: true})
        .then(function (docs) {
          docs.forEach(function (doc) {
            if (returnValue.cancelled) {
              return completeReplication();
            }
            if (doc.ok) {
              result.docs_read++;
              currentBatch.pendingRevs++;
              currentBatch.docs.push(doc.ok);
              delete diffs[doc.ok._id];
            }
          });
        });
    }));
  }

  function getAllDocs() {
    if (Object.keys(currentBatch.diffs).length > 0) {
      return getNextDoc().then(getAllDocs);
    } else {
      return utils.Promise.resolve();
    }
  }


  function getRevisionOneDocs() {
    // filter out the generation 1 docs and get them
    // leaving the non-generation one docs to be got otherwise
    var ids = Object.keys(currentBatch.diffs).filter(function (id) {
      var missing = currentBatch.diffs[id].missing;
      return missing.length === 1 && missing[0].slice(0, 2) === '1-';
    });
    return src.allDocs({
      keys: ids,
      include_docs: true
    }).then(function (res) {
      if (returnValue.cancelled) {
        completeReplication();
        throw (new Error('cancelled'));
      }
      res.rows.forEach(function (row) {
        if (row.doc && !row.deleted &&
          row.value.rev.slice(0, 2) === '1-' && (
            !row.doc._attachments ||
            Object.keys(row.doc._attachments).length === 0
          )
        ) {
          result.docs_read++;
          currentBatch.pendingRevs++;
          currentBatch.docs.push(row.doc);
          delete currentBatch.diffs[row.id];
        }
      });
    });
  }


  function getDocs() {
    return getRevisionOneDocs().then(getAllDocs);
  }


  function finishBatch() {
    writingCheckpoint = true;
    return checkpointer.writeCheckpoint(
      currentBatch.seq
    ).then(function (res) {
      writingCheckpoint = false;
      if (returnValue.cancelled) {
        completeReplication();
        throw new Error('cancelled');
      }
      result.last_seq = last_seq = currentBatch.seq;
      returnValue.emit('change', utils.clone(result));
      currentBatch = undefined;
      getChanges();
    })["catch"](function (err) {
      writingCheckpoint = false;
      abortReplication('writeCheckpoint completed with error', err);
      throw err;
    });
  }


  function getDiffs() {
    var diff = {};
    currentBatch.changes.forEach(function (change) {
      diff[change.id] = change.changes.map(function (x) {
        return x.rev;
      });
    });
    return target.revsDiff(diff).then(function (diffs) {
      if (returnValue.cancelled) {
        completeReplication();
        throw new Error('cancelled');
      }
      // currentBatch.diffs elements are deleted as the documents are written
      currentBatch.diffs = diffs;
      currentBatch.pendingRevs = 0;
    });
  }


  function startNextBatch() {
    if (returnValue.cancelled || currentBatch) {
      return;
    }
    if (batches.length === 0) {
      processPendingBatch(true);
      return;
    }
    currentBatch = batches.shift();
    getDiffs()
    .then(getDocs)
    .then(writeDocs)
    .then(finishBatch)
    .then(startNextBatch)[
    "catch"](function (err) {
      abortReplication('batch processing terminated with error', err);
    });
  }


  function processPendingBatch(immediate) {
    if (pendingBatch.changes.length === 0) {
      if (batches.length === 0 && !currentBatch) {
        if ((continuous && changesOpts.live) || changesCompleted) {
          returnValue.emit('uptodate', utils.clone(result));
        }
        if (changesCompleted) {
          completeReplication();
        }
      }
      return;
    }
    if (
      immediate ||
      changesCompleted ||
      pendingBatch.changes.length >= batch_size
    ) {
      batches.push(pendingBatch);
      pendingBatch = {
        seq: 0,
        changes: [],
        docs: []
      };
      startNextBatch();
    }
  }


  function abortReplication(reason, err) {
    if (replicationCompleted) {
      return;
    }
    result.ok = false;
    result.status = 'aborted';
    result.errors.push(err);
    batches = [];
    pendingBatch = {
      seq: 0,
      changes: [],
      docs: []
    };
    completeReplication();
  }


  function completeReplication() {
    if (replicationCompleted) {
      return;
    }
    if (returnValue.cancelled) {
      result.status = 'cancelled';
      if (writingCheckpoint) {
        return;
      }
    }
    result.status = result.status || 'complete';
    result.end_time = new Date();
    result.last_seq = last_seq;
    replicationCompleted = returnValue.cancelled = true;
    var non403s = result.errors.filter(function (error) {
      return error.name !== 'unauthorized' && error.name !== 'forbidden';
    });
    if (non403s.length > 0) {
      var error = result.errors.pop();
      if (result.errors.length > 0) {
        error.other_errors = result.errors;
      }
      error.result = result;
      returnValue.emit('error', error);
    } else {
      returnValue.emit('complete', result);
    }
    returnValue.removeAllListeners();
  }


  function onChange(change) {
    if (returnValue.cancelled) {
      return completeReplication();
    }
    if (
      pendingBatch.changes.length === 0 &&
      batches.length === 0 &&
      !currentBatch
    ) {
      returnValue.emit('outofdate', utils.clone(result));
    }
    pendingBatch.seq = change.seq;
    pendingBatch.changes.push(change);
    processPendingBatch(batches.length === 0);
  }


  function onChangesComplete(changes) {
    changesPending = false;
    if (returnValue.cancelled) {
      return completeReplication();
    }
    if (changesOpts.since < changes.last_seq) {
      changesOpts.since = changes.last_seq;
      getChanges();
    } else {
      if (continuous) {
        changesOpts.live = true;
        getChanges();
      } else {
        changesCompleted = true;
      }
    }
    processPendingBatch(true);
  }


  function onChangesError(err) {
    changesPending = false;
    if (returnValue.cancelled) {
      return completeReplication();
    }
    abortReplication('changes rejected', err);
  }


  function getChanges() {
    if (!(
      !changesPending &&
      !changesCompleted &&
      batches.length < batches_limit
    )) {
      return;
    }
    changesPending = true;
    function abortChanges() {
      changes.cancel();
    }
    function removeListener() {
      returnValue.removeListener('cancel', abortChanges);
    }
    returnValue.once('cancel', abortChanges);
    var changes = src.changes(changesOpts)
    .on('change', onChange);
    changes.then(removeListener, removeListener);
    changes.then(onChangesComplete)[
    "catch"](onChangesError);
  }


  function startChanges() {
    checkpointer.getCheckpoint().then(function (checkpoint) {
      last_seq = checkpoint;
      changesOpts = {
        since: last_seq,
        limit: batch_size,
        batch_size: batch_size,
        style: 'all_docs',
        doc_ids: doc_ids,
        returnDocs: false
      };
      if (opts.filter) {
        changesOpts.filter = opts.filter;
      }
      if (opts.query_params) {
        changesOpts.query_params = opts.query_params;
      }
      getChanges();
    })["catch"](function (err) {
      abortReplication('getCheckpoint rejected with ', err);
    });
  }


  returnValue.once('cancel', completeReplication);

  if (typeof opts.onChange === 'function') {
    returnValue.on('change', opts.onChange);
  }

  if (typeof opts.complete === 'function') {
    returnValue.once('error', opts.complete);
    returnValue.once('complete', function (result) {
      opts.complete(null, result);
    });
  }

  if (typeof opts.since === 'undefined') {
    startChanges();
  } else {
    writingCheckpoint = true;
    checkpointer.writeCheckpoint(opts.since).then(function (res) {
      writingCheckpoint = false;
      if (returnValue.cancelled) {
        completeReplication();
        return;
      }
      last_seq = opts.since;
      startChanges();
    })["catch"](function (err) {
      writingCheckpoint = false;
      abortReplication('writeCheckpoint completed with error', err);
      throw err;
    });
  }
}

exports.toPouch = toPouch;
function toPouch(db, opts) {
  var PouchConstructor = opts.PouchConstructor;
  if (typeof db === 'string') {
    return new PouchConstructor(db);
  } else if (db.then) {
    return db;
  } else {
    return utils.Promise.resolve(db);
  }
}


exports.replicate = replicateWrapper;
function replicateWrapper(src, target, opts, callback) {
  if (typeof opts === 'function') {
    callback = opts;
    opts = {};
  }
  if (typeof opts === 'undefined') {
    opts = {};
  }
  if (!opts.complete) {
    opts.complete = callback || function () {};
  }
  opts = utils.clone(opts);
  opts.continuous = opts.continuous || opts.live;
  /*jshint validthis:true */
  opts.PouchConstructor = opts.PouchConstructor || this;
  var replicateRet = new Replication(opts);
  toPouch(src, opts).then(function (src) {
    return toPouch(target, opts).then(function (target) {
      return genReplicationId(src, target, opts).then(function (repId) {
        replicate(repId, src, target, opts, replicateRet);
      });
    });
  })["catch"](function (err) {
    replicateRet.emit('error', err);
    opts.complete(err);
  });
  return replicateRet;
}

},{"./utils":23,"events":27}],20:[function(_dereq_,module,exports){
(function (global){
"use strict";

var PouchDB = _dereq_("./constructor");
var utils = _dereq_('./utils');
var Promise = utils.Promise;
var EventEmitter = _dereq_('events').EventEmitter;
PouchDB.adapters = {};
PouchDB.preferredAdapters = _dereq_('./adapters/preferredAdapters.js');

PouchDB.prefix = '_pouch_';

var eventEmitter = new EventEmitter();

var eventEmitterMethods = [
  'on',
  'addListener',
  'emit',
  'listeners',
  'once',
  'removeAllListeners',
  'removeListener',
  'setMaxListeners'
];

eventEmitterMethods.forEach(function (method) {
  PouchDB[method] = eventEmitter[method].bind(eventEmitter);
});
PouchDB.setMaxListeners(0);
PouchDB.parseAdapter = function (name, opts) {
  var match = name.match(/([a-z\-]*):\/\/(.*)/);
  var adapter, adapterName;
  if (match) {
    // the http adapter expects the fully qualified name
    name = /http(s?)/.test(match[1]) ? match[1] + '://' + match[2] : match[2];
    adapter = match[1];
    if (!PouchDB.adapters[adapter].valid()) {
      throw 'Invalid adapter';
    }
    return {name: name, adapter: match[1]};
  }

  // check for browsers that have been upgraded from websql-only to websql+idb
  var skipIdb = 'idb' in PouchDB.adapters && 'websql' in PouchDB.adapters &&
    utils.hasLocalStorage() &&
    global.localStorage['_pouch__websqldb_' + PouchDB.prefix + name];

  if (typeof opts !== 'undefined' && opts.db) {
    adapterName = 'leveldb';
  } else {
    for (var i = 0; i < PouchDB.preferredAdapters.length; ++i) {
      adapterName = PouchDB.preferredAdapters[i];
      if (adapterName in PouchDB.adapters) {
        if (skipIdb && adapterName === 'idb') {
          continue; // keep using websql to avoid user data loss
        }
        break;
      }
    }
  }

  adapter = PouchDB.adapters[adapterName];
  if (adapterName && adapter) {
    var use_prefix = 'use_prefix' in adapter ? adapter.use_prefix : true;

    return {
      name: use_prefix ? PouchDB.prefix + name : name,
      adapter: adapterName
    };
  }

  throw 'No valid adapter found';
};

PouchDB.destroy = utils.toPromise(function (name, opts, callback) {
  if (typeof opts === 'function' || typeof opts === 'undefined') {
    callback = opts;
    opts = {};
  }

  if (name && typeof name === 'object') {
    opts = name;
    name = undefined;
  }

  var backend = PouchDB.parseAdapter(opts.name || name, opts);
  var dbName = backend.name;
  var adapter = PouchDB.adapters[backend.adapter];
  var usePrefix = 'use_prefix' in adapter ? adapter.use_prefix : true;
  var baseName = usePrefix ?
    dbName.replace(new RegExp('^' + PouchDB.prefix), '') : dbName;
  var fullName = (backend.adapter === 'http' || backend.adapter === 'https' ?
      '' : (opts.prefix || '')) + dbName;
  function destroyDb() {
    // call destroy method of the particular adaptor
    adapter.destroy(fullName, opts, function (err, resp) {
      if (err) {
        callback(err);
      } else {
        PouchDB.emit('destroyed', name);
        //so we don't have to sift through all dbnames
        PouchDB.emit(name, 'destroyed');
        callback(null, resp || { 'ok': true });
      }
    });
  }

  var createOpts = utils.extend(true, {}, opts, {adapter : backend.adapter});
  new PouchDB(baseName, createOpts, function (err, db) {
    if (err) {
      return callback(err);
    }
    db.get('_local/_pouch_dependentDbs', function (err, localDoc) {
      if (err) {
        if (err.status !== 404) {
          return callback(err);
        } else { // no dependencies
          return destroyDb();
        }
      }
      var dependentDbs = localDoc.dependentDbs;
      var deletedMap = Object.keys(dependentDbs).map(function (name) {
        var trueName = usePrefix ?
          name.replace(new RegExp('^' + PouchDB.prefix), '') : name;
        var subOpts = utils.extend(true, opts, {adapter: backend.adapter});
        return PouchDB.destroy(trueName, subOpts);
      });
      Promise.all(deletedMap).then(destroyDb, function (error) {
        callback(error);
      });
    });
  });
});

PouchDB.allDbs = utils.toPromise(function (callback) {
  var err = new Error('allDbs method removed');
  err.stats = '400';
  callback(err);
});
PouchDB.adapter = function (id, obj) {
  if (obj.valid()) {
    PouchDB.adapters[id] = obj;
  }
};

PouchDB.plugin = function (obj) {
  Object.keys(obj).forEach(function (id) {
    PouchDB.prototype[id] = obj[id];
  });
};

PouchDB.defaults = function (defaultOpts) {
  function PouchAlt(name, opts, callback) {
    if (typeof opts === 'function' || typeof opts === 'undefined') {
      callback = opts;
      opts = {};
    }
    if (name && typeof name === 'object') {
      opts = name;
      name = undefined;
    }

    opts = utils.extend(true, {}, defaultOpts, opts);
    PouchDB.call(this, name, opts, callback);
  }

  utils.inherits(PouchAlt, PouchDB);

  PouchAlt.destroy = utils.toPromise(function (name, opts, callback) {
    if (typeof opts === 'function' || typeof opts === 'undefined') {
      callback = opts;
      opts = {};
    }

    if (name && typeof name === 'object') {
      opts = name;
      name = undefined;
    }
    opts = utils.extend(true, {}, defaultOpts, opts);
    return PouchDB.destroy(name, opts, callback);
  });

  eventEmitterMethods.forEach(function (method) {
    PouchAlt[method] = eventEmitter[method].bind(eventEmitter);
  });
  PouchAlt.setMaxListeners(0);

  PouchAlt.preferredAdapters = PouchDB.preferredAdapters.slice();
  Object.keys(PouchDB).forEach(function (key) {
    if (!(key in PouchAlt)) {
      PouchAlt[key] = PouchDB[key];
    }
  });

  return PouchAlt;
};

module.exports = PouchDB;

}).call(this,typeof self !== "undefined" ? self : typeof window !== "undefined" ? window : {})
},{"./adapters/preferredAdapters.js":4,"./constructor":7,"./utils":23,"events":27}],21:[function(_dereq_,module,exports){
'use strict';
var utils = _dereq_('./utils');
var replication = _dereq_('./replicate');
var replicate = replication.replicate;
var EE = _dereq_('events').EventEmitter;

utils.inherits(Sync, EE);
module.exports = sync;
function sync(src, target, opts, callback) {
  if (typeof opts === 'function') {
    callback = opts;
    opts = {};
  }
  if (typeof opts === 'undefined') {
    opts = {};
  }
  opts = utils.clone(opts);
  /*jshint validthis:true */
  opts.PouchConstructor = opts.PouchConstructor || this;
  src = replication.toPouch(src, opts);
  target = replication.toPouch(target, opts);
  return new Sync(src, target, opts, callback);
}
function Sync(src, target, opts, callback) {
  var self = this;
  this.canceled = false;
  
  var onChange, complete;
  if ('onChange' in opts) {
    onChange = opts.onChange;
    delete opts.onChange;
  }
  if (typeof callback === 'function' && !opts.complete) {
    complete = callback;
  } else if ('complete' in opts) {
    complete = opts.complete;
    delete opts.complete;
  }

  this.push = replicate(src, target, opts);

  this.pull = replicate(target, src, opts);
  var emittedCancel = false;
  function onCancel(data) {
    if (!emittedCancel) {
      emittedCancel = true;
      self.emit('cancel', data);
    }
  }

  function pullChange(change) {
    self.emit('change', {
      direction: 'pull',
      change: change
    });
  }
  function pushChange(change) {
    self.emit('change', {
      direction: 'push',
      change: change
    });
  }
  var listeners = {};

  var removed = {};
  function removeAll(type) { // type is 'push' or 'pull'
    return function (event, func) {
      var isChange = event === 'change' &&
        (func === pullChange || func === pushChange);
      var isCancel = event === 'cancel' && func === onCancel;
      var isOtherEvent = event in listeners && func === listeners[event];

      if (isChange || isCancel || isOtherEvent) {
        if (!(event in removed)) {
          removed[event] = {};
        }
        removed[event][type] = true;
        if (Object.keys(removed[event]).length === 2) {
          // both push and pull have asked to be removed
          self.removeAllListeners(event);
        }
      }
    };
  }

  this.on('newListener', function (event) {
    if (event === 'change') {
      self.pull.on('change', pullChange);
      self.push.on('change', pushChange);
    } else if (event === 'cancel') {
      self.pull.on('cancel', onCancel);
      self.push.on('cancel', onCancel);
    } else if (event !== 'error' &&
      event !== 'removeListener' &&
      event !== 'complete' && !(event in listeners)) {
      listeners[event] = function (e) {
        self.emit(event, e);
      };
      self.pull.on(event, listeners[event]);
      self.push.on(event, listeners[event]);
    }
  });

  this.on('removeListener', function (event) {
    if (event === 'change') {
      self.pull.removeListener('change', pullChange);
      self.push.removeListener('change', pushChange);
    } else if (event === 'cancel') {
      self.pull.removeListener('cancel', onCancel);
      self.push.removeListener('cancel', onCancel);
    } else if (event in listeners) {
      if (typeof listeners[event] === 'function') {
        self.pull.removeListener(event, listeners[event]);
        self.push.removeListener(event, listeners[event]);
        delete listeners[event];
      }
    }
  });

  this.pull.on('removeListener', removeAll('pull'));
  this.push.on('removeListener', removeAll('push'));

  var promise = utils.Promise.all([
    this.push,
    this.pull
  ]).then(function (resp) {
    var out = {
      push: resp[0],
      pull: resp[1]
    };
    self.emit('complete', out);
    if (complete) {
      complete(null, out);
    }
    self.removeAllListeners();
    return out;
  }, function (err) {
    self.cancel();
    self.emit('error', err);
    if (complete) {
      complete(err);
    }
    self.removeAllListeners();
    throw err;
  });

  this.then = function (success, err) {
    return promise.then(success, err);
  };

  this["catch"] = function (err) {
    return promise["catch"](err);
  };
}

Sync.prototype.cancel = function () {
  if (!this.canceled) {
    this.canceled = true;
    this.push.cancel();
    this.pull.cancel();
  }
};

},{"./replicate":19,"./utils":23,"events":27}],22:[function(_dereq_,module,exports){
'use strict';

module.exports = TaskQueue;

function TaskQueue() {
  this.isReady = false;
  this.failed = false;
  this.queue = [];
}

TaskQueue.prototype.execute = function () {
  var d, func;
  if (this.failed) {
    while ((d = this.queue.shift())) {
      if (typeof d === 'function') {
        d(this.failed);
        continue;
      }
      func = d.parameters[d.parameters.length - 1];
      if (typeof func === 'function') {
        func(this.failed);
      } else if (d.name === 'changes' && typeof func.complete === 'function') {
        func.complete(this.failed);
      }
    }
  } else if (this.isReady) {
    while ((d = this.queue.shift())) {

      if (typeof d === 'function') {
        d();
      } else {
        d.task = this.db[d.name].apply(this.db, d.parameters);
      }
    }
  }
};

TaskQueue.prototype.fail = function (err) {
  this.failed = err;
  this.execute();
};

TaskQueue.prototype.ready = function (db) {
  if (this.failed) {
    return false;
  } else if (arguments.length === 0) {
    return this.isReady;
  }
  this.isReady = db ? true: false;
  this.db = db;
  this.execute();
};

TaskQueue.prototype.addTask = function (name, parameters) {
  if (typeof name === 'function') {
    this.queue.push(name);
    if (this.failed) {
      this.execute();
    }
  } else {
    var task = { name: name, parameters: parameters };
    this.queue.push(task);
    if (this.failed) {
      this.execute();
    }
    return task;
  }
};

},{}],23:[function(_dereq_,module,exports){
(function (process,global){
/*jshint strict: false */
/*global chrome */
var merge = _dereq_('./merge');
exports.extend = _dereq_('pouchdb-extend');
exports.ajax = _dereq_('./deps/ajax');
exports.createBlob = _dereq_('./deps/blob');
exports.uuid = _dereq_('./deps/uuid');
exports.getArguments = _dereq_('argsarray');
var buffer = _dereq_('./deps/buffer');
var errors = _dereq_('./deps/errors');
var EventEmitter = _dereq_('events').EventEmitter;
var collections = _dereq_('./deps/collections');
exports.Map = collections.Map;
exports.Set = collections.Set;

if (typeof global.Promise === 'function') {
  exports.Promise = global.Promise;
} else {
  exports.Promise = _dereq_('bluebird');
}
var Promise = exports.Promise;

function toObject(array) {
  var obj = {};
  array.forEach(function (item) { obj[item] = true; });
  return obj;
}
// List of top level reserved words for doc
var reservedWords = toObject([
  '_id',
  '_rev',
  '_attachments',
  '_deleted',
  '_revisions',
  '_revs_info',
  '_conflicts',
  '_deleted_conflicts',
  '_local_seq',
  '_rev_tree',
  //replication documents
  '_replication_id',
  '_replication_state',
  '_replication_state_time',
  '_replication_state_reason',
  '_replication_stats'
]);

// List of reserved words that should end up the document
var dataWords = toObject([
  '_attachments',
  //replication documents
  '_replication_id',
  '_replication_state',
  '_replication_state_time',
  '_replication_state_reason',
  '_replication_stats'
]);

exports.clone = function (obj) {
  return exports.extend(true, {}, obj);
};
exports.inherits = _dereq_('inherits');
// Determine id an ID is valid
//   - invalid IDs begin with an underescore that does not begin '_design' or
//     '_local'
//   - any other string value is a valid id
// Returns the specific error object for each case
exports.invalidIdError = function (id) {
  var err;
  if (!id) {
    err = new TypeError(errors.MISSING_ID.message);
    err.status = 412;
  } else if (typeof id !== 'string') {
    err = new TypeError(errors.INVALID_ID.message);
    err.status = 400;
  } else if (/^_/.test(id) && !(/^_(design|local)/).test(id)) {
    err = new TypeError(errors.RESERVED_ID.message);
    err.status = 400;
  }
  if (err) {
    throw err;
  }
};

function isChromeApp() {
  return (typeof chrome !== "undefined" &&
          typeof chrome.storage !== "undefined" &&
          typeof chrome.storage.local !== "undefined");
}

// Pretty dumb name for a function, just wraps callback calls so we dont
// to if (callback) callback() everywhere
exports.call = exports.getArguments(function (args) {
  if (!args.length) {
    return;
  }
  var fun = args.shift();
  if (typeof fun === 'function') {
    fun.apply(this, args);
  }
});

exports.isLocalId = function (id) {
  return (/^_local/).test(id);
};

// check if a specific revision of a doc has been deleted
//  - metadata: the metadata object from the doc store
//  - rev: (optional) the revision to check. defaults to winning revision
exports.isDeleted = function (metadata, rev) {
  if (!rev) {
    rev = merge.winningRev(metadata);
  }
  var dashIndex = rev.indexOf('-');
  if (dashIndex !== -1) {
    rev = rev.substring(dashIndex + 1);
  }
  var deleted = false;
  merge.traverseRevTree(metadata.rev_tree,
  function (isLeaf, pos, id, acc, opts) {
    if (id === rev) {
      deleted = !!opts.deleted;
    }
  });

  return deleted;
};

exports.filterChange = function (opts) {
  return function (change) {
    var req = {};
    var hasFilter = opts.filter && typeof opts.filter === 'function';

    req.query = opts.query_params;
    if (opts.filter && hasFilter && !opts.filter.call(this, change.doc, req)) {
      return false;
    }
    if (opts.doc_ids && opts.doc_ids.indexOf(change.id) === -1) {
      return false;
    }
    if (!opts.include_docs) {
      delete change.doc;
    } else {
      for (var att in change.doc._attachments) {
        if (change.doc._attachments.hasOwnProperty(att)) {
          change.doc._attachments[att].stub = true;
        }
      }
    }
    return true;
  };
};

// Preprocess documents, parse their revisions, assign an id and a
// revision for new writes that are missing them, etc
exports.parseDoc = function (doc, newEdits) {
  var nRevNum;
  var newRevId;
  var revInfo;
  var error;
  var opts = {status: 'available'};
  if (doc._deleted) {
    opts.deleted = true;
  }

  if (newEdits) {
    if (!doc._id) {
      doc._id = exports.uuid();
    }
    newRevId = exports.uuid(32, 16).toLowerCase();
    if (doc._rev) {
      revInfo = /^(\d+)-(.+)$/.exec(doc._rev);
      if (!revInfo) {
        var err = new TypeError("invalid value for property '_rev'");
        err.status = 400;
      }
      doc._rev_tree = [{
        pos: parseInt(revInfo[1], 10),
        ids: [revInfo[2], {status: 'missing'}, [[newRevId, opts, []]]]
      }];
      nRevNum = parseInt(revInfo[1], 10) + 1;
    } else {
      doc._rev_tree = [{
        pos: 1,
        ids : [newRevId, opts, []]
      }];
      nRevNum = 1;
    }
  } else {
    if (doc._revisions) {
      doc._rev_tree = [{
        pos: doc._revisions.start - doc._revisions.ids.length + 1,
        ids: doc._revisions.ids.reduce(function (acc, x) {
          if (acc === null) {
            return [x, opts, []];
          } else {
            return [x, {status: 'missing'}, [acc]];
          }
        }, null)
      }];
      nRevNum = doc._revisions.start;
      newRevId = doc._revisions.ids[0];
    }
    if (!doc._rev_tree) {
      revInfo = /^(\d+)-(.+)$/.exec(doc._rev);
      if (!revInfo) {
        error = new TypeError(errors.BAD_ARG.message);
        error.status = errors.BAD_ARG.status;
        throw error;
      }
      nRevNum = parseInt(revInfo[1], 10);
      newRevId = revInfo[2];
      doc._rev_tree = [{
        pos: parseInt(revInfo[1], 10),
        ids: [revInfo[2], opts, []]
      }];
    }
  }

  exports.invalidIdError(doc._id);

  doc._rev = [nRevNum, newRevId].join('-');

  var result = {metadata : {}, data : {}};
  for (var key in doc) {
    if (doc.hasOwnProperty(key)) {
      var specialKey = key[0] === '_';
      if (specialKey && !reservedWords[key]) {
        error = new Error(errors.DOC_VALIDATION.message + ': ' + key);
        error.status = errors.DOC_VALIDATION.status;
        throw error;
      } else if (specialKey && !dataWords[key]) {
        result.metadata[key.slice(1)] = doc[key];
      } else {
        result.data[key] = doc[key];
      }
    }
  }
  return result;
};

exports.isCordova = function () {
  return (typeof cordova !== "undefined" ||
          typeof PhoneGap !== "undefined" ||
          typeof phonegap !== "undefined");
};

exports.hasLocalStorage = function () {
  if (isChromeApp()) {
    return false;
  }
  try {
    return global.localStorage;
  } catch (e) {
    return false;
  }
};
exports.Changes = Changes;
exports.inherits(Changes, EventEmitter);
function Changes() {
  if (!(this instanceof Changes)) {
    return new Changes();
  }
  var self = this;
  EventEmitter.call(this);
  this.isChrome = isChromeApp();
  this.listeners = {};
  this.hasLocal = false;
  if (!this.isChrome) {
    this.hasLocal = exports.hasLocalStorage();
  }
  if (this.isChrome) {
    chrome.storage.onChanged.addListener(function (e) {
      // make sure it's event addressed to us
      if (e.db_name != null) {
        //object only has oldValue, newValue members
        self.emit(e.dbName.newValue);
      }
    });
  } else if (this.hasLocal) {
    if (global.addEventListener) {
      global.addEventListener("storage", function (e) {
        self.emit(e.key);
      });
    } else {
      global.attachEvent("storage", function (e) {
        self.emit(e.key);
      });
    }
  }

}
Changes.prototype.addListener = function (dbName, id, db, opts) {
  if (this.listeners[id]) {
    return;
  }
  function eventFunction() {
    db.changes({
      include_docs: opts.include_docs,
      conflicts: opts.conflicts,
      continuous: false,
      descending: false,
      filter: opts.filter,
      view: opts.view,
      since: opts.since,
      query_params: opts.query_params,
      onChange: function (c) {
        if (c.seq > opts.since && !opts.cancelled) {
          opts.since = c.seq;
          exports.call(opts.onChange, c);
        }
      }
    });
  }
  this.listeners[id] = eventFunction;
  this.on(dbName, eventFunction);
};

Changes.prototype.removeListener = function (dbName, id) {
  if (!(id in this.listeners)) {
    return;
  }
  EventEmitter.prototype.removeListener.call(this, dbName,
    this.listeners[id]);
};


Changes.prototype.notifyLocalWindows = function (dbName) {
  //do a useless change on a storage thing
  //in order to get other windows's listeners to activate
  if (this.isChrome) {
    chrome.storage.local.set({dbName: dbName});
  } else if (this.hasLocal) {
    localStorage[dbName] = (localStorage[dbName] === "a") ? "b" : "a";
  }
};

Changes.prototype.notify = function (dbName) {
  this.emit(dbName);
  this.notifyLocalWindows(dbName);
};

if (!process.browser || !('atob' in global)) {
  exports.atob = function (str) {
    var base64 = new buffer(str, 'base64');
    // Node.js will just skip the characters it can't encode instead of
    // throwing and exception
    if (base64.toString('base64') !== str) {
      throw ("Cannot base64 encode full string");
    }
    return base64.toString('binary');
  };
} else {
  exports.atob = function (str) {
    return atob(str);
  };
}

if (!process.browser || !('btoa' in global)) {
  exports.btoa = function (str) {
    return new buffer(str, 'binary').toString('base64');
  };
} else {
  exports.btoa = function (str) {
    return btoa(str);
  };
}

// From http://stackoverflow.com/questions/14967647/ (continues on next line)
// encode-decode-image-with-base64-breaks-image (2013-04-21)
exports.fixBinary = function (bin) {
  if (!process.browser) {
    // don't need to do this in Node
    return bin;
  }

  var length = bin.length;
  var buf = new ArrayBuffer(length);
  var arr = new Uint8Array(buf);
  for (var i = 0; i < length; i++) {
    arr[i] = bin.charCodeAt(i);
  }
  return buf;
};

exports.once = function (fun) {
  var called = false;
  return exports.getArguments(function (args) {
    if (called) {
      if (typeof console.trace === 'function') {
        console.trace();
      }
      throw new Error('once called  more than once');
    } else {
      called = true;
      fun.apply(this, args);
    }
  });
};

exports.toPromise = function (func) {
  //create the function we will be returning
  return exports.getArguments(function (args) {
    var self = this;
    var tempCB =
      (typeof args[args.length - 1] === 'function') ? args.pop() : false;
    // if the last argument is a function, assume its a callback
    var usedCB;
    if (tempCB) {
      // if it was a callback, create a new callback which calls it,
      // but do so async so we don't trap any errors
      usedCB = function (err, resp) {
        process.nextTick(function () {
          tempCB(err, resp);
        });
      };
    }
    var promise = new Promise(function (fulfill, reject) {
      var resp;
      try {
        var callback = exports.once(function (err, mesg) {
          if (err) {
            reject(err);
          } else {
            fulfill(mesg);
          }
        });
        // create a callback for this invocation
        // apply the function in the orig context
        args.push(callback);
        resp = func.apply(self, args);
        if (resp && typeof resp.then === 'function') {
          fulfill(resp);
        }
      } catch (e) {
        reject(e);
      }
    });
    // if there is a callback, call it back
    if (usedCB) {
      promise.then(function (result) {
        usedCB(null, result);
      }, usedCB);
    }
    promise.cancel = function () {
      return this;
    };
    return promise;
  });
};

exports.adapterFun = function (name, callback) {
  return exports.toPromise(exports.getArguments(function (args) {
    if (this._closed) {
      return Promise.reject(new Error('database is closed'));
    }
    var self = this;
    if (!this.taskqueue.isReady) {
      return new exports.Promise(function (fulfill, reject) {
        self.taskqueue.addTask(function (failed) {
          if (failed) {
            reject(failed);
          } else {
            fulfill(self[name].apply(self, args));
          }
        });
      });
    }
    return callback.apply(this, args);
  }));
};
//Can't find original post, but this is close
//http://stackoverflow.com/questions/6965107/ (continues on next line)
//converting-between-strings-and-arraybuffers
exports.arrayBufferToBinaryString = function (buffer) {
  var binary = "";
  var bytes = new Uint8Array(buffer);
  var length = bytes.byteLength;
  for (var i = 0; i < length; i++) {
    binary += String.fromCharCode(bytes[i]);
  }
  return binary;
};

exports.cancellableFun = function (fun, self, opts) {

  opts = opts ? exports.clone(true, {}, opts) : {};

  var emitter = new EventEmitter();
  var oldComplete = opts.complete || function () { };
  var complete = opts.complete = exports.once(function (err, resp) {
    if (err) {
      oldComplete(err);
    } else {
      emitter.emit('end', resp);
      oldComplete(null, resp);
    }
    emitter.removeAllListeners();
  });
  var oldOnChange = opts.onChange || function () {};
  var lastChange = 0;
  self.on('destroyed', function () {
    emitter.removeAllListeners();
  });
  opts.onChange = function (change) {
    oldOnChange(change);
    if (change.seq <= lastChange) {
      return;
    }
    lastChange = change.seq;
    emitter.emit('change', change);
    if (change.deleted) {
      emitter.emit('delete', change);
    } else if (change.changes.length === 1 &&
      change.changes[0].rev.slice(0, 1) === '1-') {
      emitter.emit('create', change);
    } else {
      emitter.emit('update', change);
    }
  };
  var promise = new Promise(function (fulfill, reject) {
    opts.complete = function (err, res) {
      if (err) {
        reject(err);
      } else {
        fulfill(res);
      }
    };
  });

  promise.then(function (result) {
    complete(null, result);
  }, complete);

  // this needs to be overwridden by caller, dont fire complete until
  // the task is ready
  promise.cancel = function () {
    promise.isCancelled = true;
    if (self.taskqueue.isReady) {
      opts.complete(null, {status: 'cancelled'});
    }
  };

  if (!self.taskqueue.isReady) {
    self.taskqueue.addTask(function () {
      if (promise.isCancelled) {
        opts.complete(null, {status: 'cancelled'});
      } else {
        fun(self, opts, promise);
      }
    });
  } else {
    fun(self, opts, promise);
  }
  promise.on = emitter.on.bind(emitter);
  promise.once = emitter.once.bind(emitter);
  promise.addListener = emitter.addListener.bind(emitter);
  promise.removeListener = emitter.removeListener.bind(emitter);
  promise.removeAllListeners = emitter.removeAllListeners.bind(emitter);
  promise.setMaxListeners = emitter.setMaxListeners.bind(emitter);
  promise.listeners = emitter.listeners.bind(emitter);
  promise.emit = emitter.emit.bind(emitter);
  return promise;
};

exports.MD5 = exports.toPromise(_dereq_('./deps/md5'));

}).call(this,_dereq_("/Users/nolan/workspace/pouchdb/node_modules/browserify/node_modules/insert-module-globals/node_modules/process/browser.js"),typeof self !== "undefined" ? self : typeof window !== "undefined" ? window : {})
},{"./deps/ajax":8,"./deps/blob":9,"./deps/buffer":26,"./deps/collections":10,"./deps/errors":11,"./deps/md5":12,"./deps/uuid":14,"./merge":18,"/Users/nolan/workspace/pouchdb/node_modules/browserify/node_modules/insert-module-globals/node_modules/process/browser.js":28,"argsarray":25,"bluebird":33,"events":27,"inherits":29,"pouchdb-extend":48}],24:[function(_dereq_,module,exports){
module.exports = "3.0.6";

},{}],25:[function(_dereq_,module,exports){
'use strict';

module.exports = argsArray;

function argsArray(fun) {
  return function () {
    var len = arguments.length;
    if (len) {
      var args = [];
      var i = -1;
      while (++i < len) {
        args[i] = arguments[i];
      }
      return fun.call(this, args);
    } else {
      return fun.call(this, []);
    }
  };
}
},{}],26:[function(_dereq_,module,exports){

},{}],27:[function(_dereq_,module,exports){
// Copyright Joyent, Inc. and other Node contributors.
//
// Permission is hereby granted, free of charge, to any person obtaining a
// copy of this software and associated documentation files (the
// "Software"), to deal in the Software without restriction, including
// without limitation the rights to use, copy, modify, merge, publish,
// distribute, sublicense, and/or sell copies of the Software, and to permit
// persons to whom the Software is furnished to do so, subject to the
// following conditions:
//
// The above copyright notice and this permission notice shall be included
// in all copies or substantial portions of the Software.
//
// THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS
// OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF
// MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN
// NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM,
// DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR
// OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE
// USE OR OTHER DEALINGS IN THE SOFTWARE.

function EventEmitter() {
  this._events = this._events || {};
  this._maxListeners = this._maxListeners || undefined;
}
module.exports = EventEmitter;

// Backwards-compat with node 0.10.x
EventEmitter.EventEmitter = EventEmitter;

EventEmitter.prototype._events = undefined;
EventEmitter.prototype._maxListeners = undefined;

// By default EventEmitters will print a warning if more than 10 listeners are
// added to it. This is a useful default which helps finding memory leaks.
EventEmitter.defaultMaxListeners = 10;

// Obviously not all Emitters should be limited to 10. This function allows
// that to be increased. Set to zero for unlimited.
EventEmitter.prototype.setMaxListeners = function(n) {
  if (!isNumber(n) || n < 0 || isNaN(n))
    throw TypeError('n must be a positive number');
  this._maxListeners = n;
  return this;
};

EventEmitter.prototype.emit = function(type) {
  var er, handler, len, args, i, listeners;

  if (!this._events)
    this._events = {};

  // If there is no 'error' event listener then throw.
  if (type === 'error') {
    if (!this._events.error ||
        (isObject(this._events.error) && !this._events.error.length)) {
      er = arguments[1];
      if (er instanceof Error) {
        throw er; // Unhandled 'error' event
      }
      throw TypeError('Uncaught, unspecified "error" event.');
    }
  }

  handler = this._events[type];

  if (isUndefined(handler))
    return false;

  if (isFunction(handler)) {
    switch (arguments.length) {
      // fast cases
      case 1:
        handler.call(this);
        break;
      case 2:
        handler.call(this, arguments[1]);
        break;
      case 3:
        handler.call(this, arguments[1], arguments[2]);
        break;
      // slower
      default:
        len = arguments.length;
        args = new Array(len - 1);
        for (i = 1; i < len; i++)
          args[i - 1] = arguments[i];
        handler.apply(this, args);
    }
  } else if (isObject(handler)) {
    len = arguments.length;
    args = new Array(len - 1);
    for (i = 1; i < len; i++)
      args[i - 1] = arguments[i];

    listeners = handler.slice();
    len = listeners.length;
    for (i = 0; i < len; i++)
      listeners[i].apply(this, args);
  }

  return true;
};

EventEmitter.prototype.addListener = function(type, listener) {
  var m;

  if (!isFunction(listener))
    throw TypeError('listener must be a function');

  if (!this._events)
    this._events = {};

  // To avoid recursion in the case that type === "newListener"! Before
  // adding it to the listeners, first emit "newListener".
  if (this._events.newListener)
    this.emit('newListener', type,
              isFunction(listener.listener) ?
              listener.listener : listener);

  if (!this._events[type])
    // Optimize the case of one listener. Don't need the extra array object.
    this._events[type] = listener;
  else if (isObject(this._events[type]))
    // If we've already got an array, just append.
    this._events[type].push(listener);
  else
    // Adding the second element, need to change to array.
    this._events[type] = [this._events[type], listener];

  // Check for listener leak
  if (isObject(this._events[type]) && !this._events[type].warned) {
    var m;
    if (!isUndefined(this._maxListeners)) {
      m = this._maxListeners;
    } else {
      m = EventEmitter.defaultMaxListeners;
    }

    if (m && m > 0 && this._events[type].length > m) {
      this._events[type].warned = true;
      console.error('(node) warning: possible EventEmitter memory ' +
                    'leak detected. %d listeners added. ' +
                    'Use emitter.setMaxListeners() to increase limit.',
                    this._events[type].length);
      if (typeof console.trace === 'function') {
        // not supported in IE 10
        console.trace();
      }
    }
  }

  return this;
};

EventEmitter.prototype.on = EventEmitter.prototype.addListener;

EventEmitter.prototype.once = function(type, listener) {
  if (!isFunction(listener))
    throw TypeError('listener must be a function');

  var fired = false;

  function g() {
    this.removeListener(type, g);

    if (!fired) {
      fired = true;
      listener.apply(this, arguments);
    }
  }

  g.listener = listener;
  this.on(type, g);

  return this;
};

// emits a 'removeListener' event iff the listener was removed
EventEmitter.prototype.removeListener = function(type, listener) {
  var list, position, length, i;

  if (!isFunction(listener))
    throw TypeError('listener must be a function');

  if (!this._events || !this._events[type])
    return this;

  list = this._events[type];
  length = list.length;
  position = -1;

  if (list === listener ||
      (isFunction(list.listener) && list.listener === listener)) {
    delete this._events[type];
    if (this._events.removeListener)
      this.emit('removeListener', type, listener);

  } else if (isObject(list)) {
    for (i = length; i-- > 0;) {
      if (list[i] === listener ||
          (list[i].listener && list[i].listener === listener)) {
        position = i;
        break;
      }
    }

    if (position < 0)
      return this;

    if (list.length === 1) {
      list.length = 0;
      delete this._events[type];
    } else {
      list.splice(position, 1);
    }

    if (this._events.removeListener)
      this.emit('removeListener', type, listener);
  }

  return this;
};

EventEmitter.prototype.removeAllListeners = function(type) {
  var key, listeners;

  if (!this._events)
    return this;

  // not listening for removeListener, no need to emit
  if (!this._events.removeListener) {
    if (arguments.length === 0)
      this._events = {};
    else if (this._events[type])
      delete this._events[type];
    return this;
  }

  // emit removeListener for all listeners on all events
  if (arguments.length === 0) {
    for (key in this._events) {
      if (key === 'removeListener') continue;
      this.removeAllListeners(key);
    }
    this.removeAllListeners('removeListener');
    this._events = {};
    return this;
  }

  listeners = this._events[type];

  if (isFunction(listeners)) {
    this.removeListener(type, listeners);
  } else {
    // LIFO order
    while (listeners.length)
      this.removeListener(type, listeners[listeners.length - 1]);
  }
  delete this._events[type];

  return this;
};

EventEmitter.prototype.listeners = function(type) {
  var ret;
  if (!this._events || !this._events[type])
    ret = [];
  else if (isFunction(this._events[type]))
    ret = [this._events[type]];
  else
    ret = this._events[type].slice();
  return ret;
};

EventEmitter.listenerCount = function(emitter, type) {
  var ret;
  if (!emitter._events || !emitter._events[type])
    ret = 0;
  else if (isFunction(emitter._events[type]))
    ret = 1;
  else
    ret = emitter._events[type].length;
  return ret;
};

function isFunction(arg) {
  return typeof arg === 'function';
}

function isNumber(arg) {
  return typeof arg === 'number';
}

function isObject(arg) {
  return typeof arg === 'object' && arg !== null;
}

function isUndefined(arg) {
  return arg === void 0;
}

},{}],28:[function(_dereq_,module,exports){
// shim for using process in browser

var process = module.exports = {};

process.nextTick = (function () {
    var canSetImmediate = typeof window !== 'undefined'
    && window.setImmediate;
    var canPost = typeof window !== 'undefined'
    && window.postMessage && window.addEventListener
    ;

    if (canSetImmediate) {
        return function (f) { return window.setImmediate(f) };
    }

    if (canPost) {
        var queue = [];
        window.addEventListener('message', function (ev) {
            var source = ev.source;
            if ((source === window || source === null) && ev.data === 'process-tick') {
                ev.stopPropagation();
                if (queue.length > 0) {
                    var fn = queue.shift();
                    fn();
                }
            }
        }, true);

        return function nextTick(fn) {
            queue.push(fn);
            window.postMessage('process-tick', '*');
        };
    }

    return function nextTick(fn) {
        setTimeout(fn, 0);
    };
})();

process.title = 'browser';
process.browser = true;
process.env = {};
process.argv = [];

process.binding = function (name) {
    throw new Error('process.binding is not supported');
}

// TODO(shtylman)
process.cwd = function () { return '/' };
process.chdir = function (dir) {
    throw new Error('process.chdir is not supported');
};

},{}],29:[function(_dereq_,module,exports){
if (typeof Object.create === 'function') {
  // implementation from standard node.js 'util' module
  module.exports = function inherits(ctor, superCtor) {
    ctor.super_ = superCtor
    ctor.prototype = Object.create(superCtor.prototype, {
      constructor: {
        value: ctor,
        enumerable: false,
        writable: true,
        configurable: true
      }
    });
  };
} else {
  // old school shim for old browsers
  module.exports = function inherits(ctor, superCtor) {
    ctor.super_ = superCtor
    var TempCtor = function () {}
    TempCtor.prototype = superCtor.prototype
    ctor.prototype = new TempCtor()
    ctor.prototype.constructor = ctor
  }
}

},{}],30:[function(_dereq_,module,exports){
'use strict';

module.exports = INTERNAL;

function INTERNAL() {}
},{}],31:[function(_dereq_,module,exports){
'use strict';
var Promise = _dereq_('./promise');
var reject = _dereq_('./reject');
var resolve = _dereq_('./resolve');
var INTERNAL = _dereq_('./INTERNAL');
var handlers = _dereq_('./handlers');
module.exports = all;
function all(iterable) {
  if (Object.prototype.toString.call(iterable) !== '[object Array]') {
    return reject(new TypeError('must be an array'));
  }

  var len = iterable.length;
  var called = false;
  if (!len) {
    return resolve([]);
  }

  var values = new Array(len);
  var resolved = 0;
  var i = -1;
  var promise = new Promise(INTERNAL);
  
  while (++i < len) {
    allResolver(iterable[i], i);
  }
  return promise;
  function allResolver(value, i) {
    resolve(value).then(resolveFromAll, function (error) {
      if (!called) {
        called = true;
        handlers.reject(promise, error);
      }
    });
    function resolveFromAll(outValue) {
      values[i] = outValue;
      if (++resolved === len & !called) {
        called = true;
        handlers.resolve(promise, values);
      }
    }
  }
}
},{"./INTERNAL":30,"./handlers":32,"./promise":34,"./reject":37,"./resolve":38}],32:[function(_dereq_,module,exports){
'use strict';
var tryCatch = _dereq_('./tryCatch');
var resolveThenable = _dereq_('./resolveThenable');
var states = _dereq_('./states');

exports.resolve = function (self, value) {
  var result = tryCatch(getThen, value);
  if (result.status === 'error') {
    return exports.reject(self, result.value);
  }
  var thenable = result.value;

  if (thenable) {
    resolveThenable.safely(self, thenable);
  } else {
    self.state = states.FULFILLED;
    self.outcome = value;
    var i = -1;
    var len = self.queue.length;
    while (++i < len) {
      self.queue[i].callFulfilled(value);
    }
  }
  return self;
};
exports.reject = function (self, error) {
  self.state = states.REJECTED;
  self.outcome = error;
  var i = -1;
  var len = self.queue.length;
  while (++i < len) {
    self.queue[i].callRejected(error);
  }
  return self;
};

function getThen(obj) {
  // Make sure we only access the accessor once as required by the spec
  var then = obj && obj.then;
  if (obj && typeof obj === 'object' && typeof then === 'function') {
    return function appyThen() {
      then.apply(obj, arguments);
    };
  }
}
},{"./resolveThenable":39,"./states":40,"./tryCatch":41}],33:[function(_dereq_,module,exports){
module.exports = exports = _dereq_('./promise');

exports.resolve = _dereq_('./resolve');
exports.reject = _dereq_('./reject');
exports.all = _dereq_('./all');
exports.race = _dereq_('./race');
},{"./all":31,"./promise":34,"./race":36,"./reject":37,"./resolve":38}],34:[function(_dereq_,module,exports){
'use strict';

var unwrap = _dereq_('./unwrap');
var INTERNAL = _dereq_('./INTERNAL');
var resolveThenable = _dereq_('./resolveThenable');
var states = _dereq_('./states');
var QueueItem = _dereq_('./queueItem');

module.exports = Promise;
function Promise(resolver) {
  if (!(this instanceof Promise)) {
    return new Promise(resolver);
  }
  if (typeof resolver !== 'function') {
    throw new TypeError('reslover must be a function');
  }
  this.state = states.PENDING;
  this.queue = [];
  this.outcome = void 0;
  if (resolver !== INTERNAL) {
    resolveThenable.safely(this, resolver);
  }
}

Promise.prototype['catch'] = function (onRejected) {
  return this.then(null, onRejected);
};
Promise.prototype.then = function (onFulfilled, onRejected) {
  if (typeof onFulfilled !== 'function' && this.state === states.FULFILLED ||
    typeof onRejected !== 'function' && this.state === states.REJECTED) {
    return this;
  }
  var promise = new Promise(INTERNAL);

  
  if (this.state !== states.PENDING) {
    var resolver = this.state === states.FULFILLED ? onFulfilled: onRejected;
    unwrap(promise, resolver, this.outcome);
  } else {
    this.queue.push(new QueueItem(promise, onFulfilled, onRejected));
  }

  return promise;
};

},{"./INTERNAL":30,"./queueItem":35,"./resolveThenable":39,"./states":40,"./unwrap":42}],35:[function(_dereq_,module,exports){
'use strict';
var handlers = _dereq_('./handlers');
var unwrap = _dereq_('./unwrap');

module.exports = QueueItem;
function QueueItem(promise, onFulfilled, onRejected) {
  this.promise = promise;
  if (typeof onFulfilled === 'function') {
    this.onFulfilled = onFulfilled;
    this.callFulfilled = this.otherCallFulfilled;
  }
  if (typeof onRejected === 'function') {
    this.onRejected = onRejected;
    this.callRejected = this.otherCallRejected;
  }
}
QueueItem.prototype.callFulfilled = function (value) {
  handlers.resolve(this.promise, value);
};
QueueItem.prototype.otherCallFulfilled = function (value) {
  unwrap(this.promise, this.onFulfilled, value);
};
QueueItem.prototype.callRejected = function (value) {
  handlers.reject(this.promise, value);
};
QueueItem.prototype.otherCallRejected = function (value) {
  unwrap(this.promise, this.onRejected, value);
};
},{"./handlers":32,"./unwrap":42}],36:[function(_dereq_,module,exports){
'use strict';
var Promise = _dereq_('./promise');
var reject = _dereq_('./reject');
var resolve = _dereq_('./resolve');
var INTERNAL = _dereq_('./INTERNAL');
var handlers = _dereq_('./handlers');
module.exports = race;
function race(iterable) {
  if (Object.prototype.toString.call(iterable) !== '[object Array]') {
    return reject(new TypeError('must be an array'));
  }

  var len = iterable.length;
  var called = false;
  if (!len) {
    return resolve([]);
  }

  var resolved = 0;
  var i = -1;
  var promise = new Promise(INTERNAL);
  
  while (++i < len) {
    resolver(iterable[i]);
  }
  return promise;
  function resolver(value) {
    resolve(value).then(function (response) {
      if (!called) {
        called = true;
        handlers.resolve(promise, response);
      }
    }, function (error) {
      if (!called) {
        called = true;
        handlers.reject(promise, error);
      }
    });
  }
}
},{"./INTERNAL":30,"./handlers":32,"./promise":34,"./reject":37,"./resolve":38}],37:[function(_dereq_,module,exports){
'use strict';

var Promise = _dereq_('./promise');
var INTERNAL = _dereq_('./INTERNAL');
var handlers = _dereq_('./handlers');
module.exports = reject;

function reject(reason) {
	var promise = new Promise(INTERNAL);
	return handlers.reject(promise, reason);
}
},{"./INTERNAL":30,"./handlers":32,"./promise":34}],38:[function(_dereq_,module,exports){
'use strict';

var Promise = _dereq_('./promise');
var INTERNAL = _dereq_('./INTERNAL');
var handlers = _dereq_('./handlers');
module.exports = resolve;

var FALSE = handlers.resolve(new Promise(INTERNAL), false);
var NULL = handlers.resolve(new Promise(INTERNAL), null);
var UNDEFINED = handlers.resolve(new Promise(INTERNAL), void 0);
var ZERO = handlers.resolve(new Promise(INTERNAL), 0);
var EMPTYSTRING = handlers.resolve(new Promise(INTERNAL), '');

function resolve(value) {
  if (value) {
    if (value instanceof Promise) {
      return value;
    }
    return handlers.resolve(new Promise(INTERNAL), value);
  }
  var valueType = typeof value;
  switch (valueType) {
    case 'boolean':
      return FALSE;
    case 'undefined':
      return UNDEFINED;
    case 'object':
      return NULL;
    case 'number':
      return ZERO;
    case 'string':
      return EMPTYSTRING;
  }
}
},{"./INTERNAL":30,"./handlers":32,"./promise":34}],39:[function(_dereq_,module,exports){
'use strict';
var handlers = _dereq_('./handlers');
var tryCatch = _dereq_('./tryCatch');
function safelyResolveThenable(self, thenable) {
  // Either fulfill, reject or reject with error
  var called = false;
  function onError(value) {
    if (called) {
      return;
    }
    called = true;
    handlers.reject(self, value);
  }

  function onSuccess(value) {
    if (called) {
      return;
    }
    called = true;
    handlers.resolve(self, value);
  }

  function tryToUnwrap() {
    thenable(onSuccess, onError);
  }
  
  var result = tryCatch(tryToUnwrap);
  if (result.status === 'error') {
    onError(result.value);
  }
}
exports.safely = safelyResolveThenable;
},{"./handlers":32,"./tryCatch":41}],40:[function(_dereq_,module,exports){
// Lazy man's symbols for states

exports.REJECTED = ['REJECTED'];
exports.FULFILLED = ['FULFILLED'];
exports.PENDING = ['PENDING'];
},{}],41:[function(_dereq_,module,exports){
'use strict';

module.exports = tryCatch;

function tryCatch(func, value) {
  var out = {};
  try {
    out.value = func(value);
    out.status = 'success';
  } catch (e) {
    out.status = 'error';
    out.value = e;
  }
  return out;
}
},{}],42:[function(_dereq_,module,exports){
'use strict';

var immediate = _dereq_('immediate');
var handlers = _dereq_('./handlers');
module.exports = unwrap;

function unwrap(promise, func, value) {
  immediate(function () {
    var returnValue;
    try {
      returnValue = func(value);
    } catch (e) {
      return handlers.reject(promise, e);
    }
    if (returnValue === promise) {
      handlers.reject(promise, new TypeError('Cannot resolve promise with itself'));
    } else {
      handlers.resolve(promise, returnValue);
    }
  });
}
},{"./handlers":32,"immediate":43}],43:[function(_dereq_,module,exports){
'use strict';
var types = [
  _dereq_('./nextTick'),
  _dereq_('./mutation.js'),
  _dereq_('./messageChannel'),
  _dereq_('./stateChange'),
  _dereq_('./timeout')
];
var draining;
var queue = [];
function drainQueue() {
  draining = true;
  var i, oldQueue;
  var len = queue.length;
  while (len) {
    oldQueue = queue;
    queue = [];
    i = -1;
    while (++i < len) {
      oldQueue[i]();
    }
    len = queue.length;
  }
  draining = false;
}
var scheduleDrain;
var i = -1;
var len = types.length;
while (++ i < len) {
  if (types[i] && types[i].test && types[i].test()) {
    scheduleDrain = types[i].install(drainQueue);
    break;
  }
}
module.exports = immediate;
function immediate(task) {
  if (queue.push(task) === 1 && !draining) {
    scheduleDrain();
  }
}
},{"./messageChannel":44,"./mutation.js":45,"./nextTick":26,"./stateChange":46,"./timeout":47}],44:[function(_dereq_,module,exports){
(function (global){
'use strict';

exports.test = function () {
  if (global.setImmediate) {
    // we can only get here in IE10
    // which doesn't handel postMessage well
    return false;
  }
  return typeof global.MessageChannel !== 'undefined';
};

exports.install = function (func) {
  var channel = new global.MessageChannel();
  channel.port1.onmessage = func;
  return function () {
    channel.port2.postMessage(0);
  };
};
}).call(this,typeof self !== "undefined" ? self : typeof window !== "undefined" ? window : {})
},{}],45:[function(_dereq_,module,exports){
(function (global){
'use strict';
//based off rsvp https://github.com/tildeio/rsvp.js
//license https://github.com/tildeio/rsvp.js/blob/master/LICENSE
//https://github.com/tildeio/rsvp.js/blob/master/lib/rsvp/asap.js

var Mutation = global.MutationObserver || global.WebKitMutationObserver;

exports.test = function () {
  return Mutation;
};

exports.install = function (handle) {
  var called = 0;
  var observer = new Mutation(handle);
  var element = global.document.createTextNode('');
  observer.observe(element, {
    characterData: true
  });
  return function () {
    element.data = (called = ++called % 2);
  };
};
}).call(this,typeof self !== "undefined" ? self : typeof window !== "undefined" ? window : {})
},{}],46:[function(_dereq_,module,exports){
(function (global){
'use strict';

exports.test = function () {
  return 'document' in global && 'onreadystatechange' in global.document.createElement('script');
};

exports.install = function (handle) {
  return function () {

    // Create a <script> element; its readystatechange event will be fired asynchronously once it is inserted
    // into the document. Do so, thus queuing up the task. Remember to clean up once it's been called.
    var scriptEl = global.document.createElement('script');
    scriptEl.onreadystatechange = function () {
      handle();

      scriptEl.onreadystatechange = null;
      scriptEl.parentNode.removeChild(scriptEl);
      scriptEl = null;
    };
    global.document.documentElement.appendChild(scriptEl);

    return handle;
  };
};
}).call(this,typeof self !== "undefined" ? self : typeof window !== "undefined" ? window : {})
},{}],47:[function(_dereq_,module,exports){
'use strict';
exports.test = function () {
  return true;
};

exports.install = function (t) {
  return function () {
    setTimeout(t, 0);
  };
};
},{}],48:[function(_dereq_,module,exports){
"use strict";

// Extends method
// (taken from http://code.jquery.com/jquery-1.9.0.js)
// Populate the class2type map
var class2type = {};

var types = [
  "Boolean", "Number", "String", "Function", "Array",
  "Date", "RegExp", "Object", "Error"
];
for (var i = 0; i < types.length; i++) {
  var typename = types[i];
  class2type["[object " + typename + "]"] = typename.toLowerCase();
}

var core_toString = class2type.toString;
var core_hasOwn = class2type.hasOwnProperty;

function type(obj) {
  if (obj === null) {
    return String(obj);
  }
  return typeof obj === "object" || typeof obj === "function" ?
    class2type[core_toString.call(obj)] || "object" :
    typeof obj;
}

function isWindow(obj) {
  return obj !== null && obj === obj.window;
}

function isPlainObject(obj) {
  // Must be an Object.
  // Because of IE, we also have to check the presence of
  // the constructor property.
  // Make sure that DOM nodes and window objects don't pass through, as well
  if (!obj || type(obj) !== "object" || obj.nodeType || isWindow(obj)) {
    return false;
  }

  try {
    // Not own constructor property must be Object
    if (obj.constructor &&
      !core_hasOwn.call(obj, "constructor") &&
      !core_hasOwn.call(obj.constructor.prototype, "isPrototypeOf")) {
      return false;
    }
  } catch ( e ) {
    // IE8,9 Will throw exceptions on certain host objects #9897
    return false;
  }

  // Own properties are enumerated firstly, so to speed up,
  // if last one is own, then all properties are own.
  var key;
  for (key in obj) {}

  return key === undefined || core_hasOwn.call(obj, key);
}


function isFunction(obj) {
  return type(obj) === "function";
}

var isArray = Array.isArray || function (obj) {
  return type(obj) === "array";
};

function extend() {
  // originally extend() was recursive, but this ended up giving us
  // "call stack exceeded", so it's been unrolled to use a literal stack
  // (see https://github.com/pouchdb/pouchdb/issues/2543)
  var stack = [];
  var i = -1;
  var len = arguments.length;
  var args = new Array(len);
  while (++i < len) {
    args[i] = arguments[i];
  }
  var container = {};
  stack.push({args: args, result: {container: container, key: 'key'}});
  var next;
  while ((next = stack.pop())) {
    extendInner(stack, next.args, next.result);
  }
  return container.key;
}

function extendInner(stack, args, result) {
  var options, name, src, copy, copyIsArray, clone,
    target = args[0] || {},
    i = 1,
    length = args.length,
    deep = false,
    numericStringRegex = /\d+/,
    optionsIsArray;

  // Handle a deep copy situation
  if (typeof target === "boolean") {
    deep = target;
    target = args[1] || {};
    // skip the boolean and the target
    i = 2;
  }

  // Handle case when target is a string or something (possible in deep copy)
  if (typeof target !== "object" && !isFunction(target)) {
    target = {};
  }

  // extend jQuery itself if only one argument is passed
  if (length === i) {
    /* jshint validthis: true */
    target = this;
    --i;
  }

  for (; i < length; i++) {
    // Only deal with non-null/undefined values
    if ((options = args[i]) != null) {
      optionsIsArray = isArray(options);
      // Extend the base object
      for (name in options) {
        //if (options.hasOwnProperty(name)) {
        if (!(name in Object.prototype)) {
          if (optionsIsArray && !numericStringRegex.test(name)) {
            continue;
          }

          src = target[name];
          copy = options[name];

          // Prevent never-ending loop
          if (target === copy) {
            continue;
          }

          // Recurse if we're merging plain objects or arrays
          if (deep && copy && (isPlainObject(copy) ||
              (copyIsArray = isArray(copy)))) {
            if (copyIsArray) {
              copyIsArray = false;
              clone = src && isArray(src) ? src : [];

            } else {
              clone = src && isPlainObject(src) ? src : {};
            }

            // Never move original objects, clone them
            stack.push({
              args: [deep, clone, copy],
              result: {
                container: target,
                key: name
              }
            });

          // Don't bring in undefined values
          } else if (copy !== undefined) {
            if (!(isArray(options) && isFunction(copy))) {
              target[name] = copy;
            }
          }
        }
      }
    }
  }

  // "Return" the modified object by setting the key
  // on the given container
  result.container[result.key] = target;
}


module.exports = extend;



},{}],49:[function(_dereq_,module,exports){
'use strict';

var upsert = _dereq_('./upsert');
var utils = _dereq_('./utils');
var Promise = utils.Promise;

module.exports = function (opts) {
  var sourceDB = opts.db;
  var viewName = opts.viewName;
  var mapFun = opts.map;
  var reduceFun = opts.reduce;
  var temporary = opts.temporary;

  // the "undefined" part is for backwards compatibility
  var viewSignature = mapFun.toString() + (reduceFun && reduceFun.toString()) +
    'undefined';

  if (!temporary && sourceDB._cachedViews) {
    var cachedView = sourceDB._cachedViews[viewSignature];
    if (cachedView) {
      return Promise.resolve(cachedView);
    }
  }

  return sourceDB.info().then(function (info) {

    var depDbName = info.db_name + '-mrview-' +
      (temporary ? 'temp' : utils.MD5(viewSignature));

    // save the view name in the source PouchDB so it can be cleaned up if necessary
    // (e.g. when the _design doc is deleted, remove all associated view data)
    function diffFunction(doc) {
      doc.views = doc.views || {};
      var fullViewName = viewName;
      if (fullViewName.indexOf('/') === -1) {
        fullViewName = viewName + '/' + viewName;
      }
      var depDbs = doc.views[fullViewName] = doc.views[fullViewName] || {};
      /* istanbul ignore if */
      if (depDbs[depDbName]) {
        return; // no update necessary
      }
      depDbs[depDbName] = true;
      return doc;
    }
    return upsert(sourceDB, '_local/mrviews', diffFunction).then(function () {
      return sourceDB.registerDependentDatabase(depDbName).then(function (res) {
        var db = res.db;
        db.auto_compaction = true;
        var view = {
          name: depDbName,
          db: db, 
          sourceDB: sourceDB,
          adapter: sourceDB.adapter,
          mapFun: mapFun,
          reduceFun: reduceFun
        };
        return view.db.get('_local/lastSeq')["catch"](function (err) {
          /* istanbul ignore if */
          if (err.status !== 404) {
            throw err;
          }
        }).then(function (lastSeqDoc) {
          view.seq = lastSeqDoc ? lastSeqDoc.seq : 0;
          if (!temporary) {
            sourceDB._cachedViews = sourceDB._cachedViews || {};
            sourceDB._cachedViews[viewSignature] = view;
            view.db.on('destroyed', function () {
              delete sourceDB._cachedViews[viewSignature];
            });
          }
          return view;
        });
      });
    });
  });
};

},{"./upsert":55,"./utils":56}],50:[function(_dereq_,module,exports){
'use strict';

module.exports = function (func, emit, sum, log, isArray, toJSON) {
  /*jshint evil:true,unused:false */
  return eval("'use strict'; (" + func.replace(/;\s*$/, "") + ");");
};

},{}],51:[function(_dereq_,module,exports){
(function (process){
'use strict';

var pouchCollate = _dereq_('pouchdb-collate');
var TaskQueue = _dereq_('./taskqueue');
var collate = pouchCollate.collate;
var toIndexableString = pouchCollate.toIndexableString;
var normalizeKey = pouchCollate.normalizeKey;
var createView = _dereq_('./create-view');
var evalFunc = _dereq_('./evalfunc');
var log; 
/* istanbul ignore else */
if ((typeof console !== 'undefined') && (typeof console.log === 'function')) {
  log = Function.prototype.bind.call(console.log, console);
} else {
  log = function () {};
}
var utils = _dereq_('./utils');
var Promise = utils.Promise;
var mainQueue = new TaskQueue();
var tempViewQueue = new TaskQueue();
var CHANGES_BATCH_SIZE = 50;

function parseViewName(name) {
  // can be either 'ddocname/viewname' or just 'viewname'
  // (where the ddoc name is the same)
  return name.indexOf('/') === -1 ? [name, name] : name.split('/');
}

function tryCode(db, fun, args) {
  // emit an event if there was an error thrown by a map/reduce function.
  // putting try/catches in a single function also avoids deoptimizations.
  try {
    return {
      output : fun.apply(null, args)
    };
  } catch (e) {
    db.emit('error', e);
    return {error : e};
  }
}

function sortByKeyThenValue(x, y) {
  var keyCompare = collate(x.key, y.key);
  return keyCompare !== 0 ? keyCompare : collate(x.value, y.value);
}

function sliceResults(results, limit, skip) {
  skip = skip || 0;
  if (typeof limit === 'number') {
    return results.slice(skip, limit + skip);
  } else if (skip > 0) {
    return results.slice(skip);
  }
  return results;
}

function createBuiltInError(name) {
  var error = new Error('builtin ' + name +
    ' function requires map values to be numbers' +
    ' or number arrays');
  error.name = 'invalid_value';
  error.status = 500;
  return error;
}

function sum(values) {
  var result = 0;
  for (var i = 0, len = values.length; i < len; i++) {
    var num = values[i];
    if (typeof num !== 'number') {
      if (Array.isArray(num)) {
        // lists of numbers are also allowed, sum them separately
        result = typeof result === 'number' ? [result] : result;
        for (var j = 0, jLen = num.length; j < jLen; j++) {
          var jNum = num[j];
          if (typeof jNum !== 'number') {
            throw createBuiltInError('_sum');
          } else if (typeof result[j] === 'undefined') {
            result.push(jNum);
          } else {
            result[j] += jNum;
          }
        }
      } else { // not array/number
        throw createBuiltInError('_sum');
      }
    } else if (typeof result === 'number') {
      result += num;
    } else { // add number to array
      result[0] += num;
    }
  }
  return result;
}

var builtInReduce = {
  _sum: function (keys, values) {
    return sum(values);
  },

  _count: function (keys, values) {
    return values.length;
  },

  _stats: function (keys, values) {
    // no need to implement rereduce=true, because Pouch
    // will never call it
    function sumsqr(values) {
      var _sumsqr = 0;
      for (var i = 0, len = values.length; i < len; i++) {
        var num = values[i];
        _sumsqr += (num * num);
      }
      return _sumsqr;
    }
    return {
      sum     : sum(values),
      min     : Math.min.apply(null, values),
      max     : Math.max.apply(null, values),
      count   : values.length,
      sumsqr : sumsqr(values)
    };
  }
};

function addHttpParam(paramName, opts, params, asJson) {
  // add an http param from opts to params, optionally json-encoded
  var val = opts[paramName];
  if (typeof val !== 'undefined') {
    if (asJson) {
      val = encodeURIComponent(JSON.stringify(val));
    }
    params.push(paramName + '=' + val);
  }
}

function checkQueryParseError(options, fun) {
  var startkeyName = options.descending ? 'endkey' : 'startkey';
  var endkeyName = options.descending ? 'startkey' : 'endkey';

  if (typeof options[startkeyName] !== 'undefined' &&
    typeof options[endkeyName] !== 'undefined' &&
    collate(options[startkeyName], options[endkeyName]) > 0) {
    throw new QueryParseError('No rows can match your key range, reverse your ' +
        'start_key and end_key or set {descending : true}');
  } else if (fun.reduce && options.reduce !== false) {
    if (options.include_docs) {
      throw new QueryParseError('{include_docs:true} is invalid for reduce');
    } else if (options.keys && options.keys.length > 1 &&
        !options.group && !options.group_level) {
      throw new QueryParseError('Multi-key fetches for reduce views must use {group: true}');
    }
  }
  if (options.group_level) {
    if (typeof options.group_level !== 'number') {
      throw new QueryParseError('Invalid value for integer: "' + options.group_level + '"');
    }
    if (options.group_level < 0) {
      throw new QueryParseError('Invalid value for positive integer: ' +
        '"' + options.group_level + '"');
    }
  }
}

function httpQuery(db, fun, opts) {
  // List of parameters to add to the PUT request
  var params = [];
  var body;
  var method = 'GET';

  // If opts.reduce exists and is defined, then add it to the list
  // of parameters.
  // If reduce=false then the results are that of only the map function
  // not the final result of map and reduce.
  addHttpParam('reduce', opts, params);
  addHttpParam('include_docs', opts, params);
  addHttpParam('limit', opts, params);
  addHttpParam('descending', opts, params);
  addHttpParam('group', opts, params);
  addHttpParam('group_level', opts, params);
  addHttpParam('skip', opts, params);
  addHttpParam('stale', opts, params);
  addHttpParam('startkey', opts, params, true);
  addHttpParam('endkey', opts, params, true);
  addHttpParam('inclusive_end', opts, params);
  addHttpParam('key', opts, params, true);

  // Format the list of parameters into a valid URI query string
  params = params.join('&');
  params = params === '' ? '' : '?' + params;

  // If keys are supplied, issue a POST request to circumvent GET query string limits
  // see http://wiki.apache.org/couchdb/HTTP_view_API#Querying_Options
  if (typeof opts.keys !== 'undefined') {
    var MAX_URL_LENGTH = 2000;
    // according to http://stackoverflow.com/a/417184/680742,
    // the de facto URL length limit is 2000 characters

    var keysAsString =
      'keys=' + encodeURIComponent(JSON.stringify(opts.keys));
    if (keysAsString.length + params.length + 1 <= MAX_URL_LENGTH) {
      // If the keys are short enough, do a GET. we do this to work around
      // Safari not understanding 304s on POSTs (see pouchdb/pouchdb#1239)
      params += (params[0] === '?' ? '&' : '?') + keysAsString;
    } else {
      method = 'POST';
      if (typeof fun === 'string') {
        body = JSON.stringify({keys: opts.keys});
      } else { // fun is {map : mapfun}, so append to this
        fun.keys = opts.keys;
      }
    }
  }

  // We are referencing a query defined in the design doc
  if (typeof fun === 'string') {
    var parts = parseViewName(fun);
    return db.request({
      method: method,
      url: '_design/' + parts[0] + '/_view/' + parts[1] + params,
      body: body
    });
  }

  // We are using a temporary view, terrible for performance but good for testing
  body = body || {};
  Object.keys(fun).forEach(function (key) {
    if (Array.isArray(fun[key])) {
      body[key] = fun[key];
    } else {
      body[key] = fun[key].toString();
    }
  });
  return db.request({
    method: 'POST',
    url: '_temp_view' + params,
    body: body
  });
}

function defaultsTo(value) {
  return function (reason) {
    /* istanbul ignore else */
    if (reason.status === 404) {
      return value;
    } else {
      throw reason;
    }
  };
}

// returns a promise for a list of docs to update, based on the input docId.
// we update the metaDoc first (i.e. the doc that points from the sourceDB
// document Id to the ids of the documents in the mrview database), then
// the key/value docs.  that way, if lightning strikes the user's computer
// in the middle of an update, we don't write any docs that we wouldn't
// be able to find later using the metaDoc.
function getDocsToPersist(docId, view, docIdsToEmits) {
  var metaDocId = '_local/doc_' + docId;
  return view.db.get(metaDocId)[
    "catch"](defaultsTo({_id: metaDocId, keys: []}))
    .then(function (metaDoc) {
      return Promise.resolve().then(function () {
        if (metaDoc.keys.length) {
          return view.db.allDocs({
            keys: metaDoc.keys,
            include_docs: true
          });
        }
        return {rows: []}; // no keys, no need for a lookup
      }).then(function (res) {
        var kvDocs = res.rows.map(function (row) {
          return row.doc;
        }).filter(function (row) {
          return row;
        });

        var indexableKeysToKeyValues = docIdsToEmits[docId];
        var oldKeysMap = {};
        kvDocs.forEach(function (kvDoc) {
          oldKeysMap[kvDoc._id] = true;
          kvDoc._deleted = !indexableKeysToKeyValues[kvDoc._id];
          if (!kvDoc._deleted) {
            var keyValue = indexableKeysToKeyValues[kvDoc._id];
            if ('value' in keyValue) {
              kvDoc.value = keyValue.value;
            }
          }
        });

        var newKeys = Object.keys(indexableKeysToKeyValues);
        newKeys.forEach(function (key) {
          if (!oldKeysMap[key]) {
            // new doc
            var kvDoc = {
              _id: key
            };
            var keyValue = indexableKeysToKeyValues[key];
            if ('value' in keyValue) {
              kvDoc.value = keyValue.value;
            }
            kvDocs.push(kvDoc);
          }
        });
        metaDoc.keys = utils.uniq(newKeys.concat(metaDoc.keys));
        kvDocs.splice(0, 0, metaDoc);

        return kvDocs;
      });
    });
}

// updates all emitted key/value docs and metaDocs in the mrview database
// for the given batch of documents from the source database
function saveKeyValues(view, docIdsToEmits, seq) {
  var seqDocId = '_local/lastSeq';
  return view.db.get(seqDocId)[
  "catch"](defaultsTo({_id: seqDocId, seq: 0}))
  .then(function (lastSeqDoc) {
    var docIds = Object.keys(docIdsToEmits);
    return Promise.all(docIds.map(function (docId) {
        return getDocsToPersist(docId, view, docIdsToEmits);
      })).then(function (listOfDocsToPersist) {
        var docsToPersist = [];
        listOfDocsToPersist.forEach(function (docList) {
          docsToPersist = docsToPersist.concat(docList);
        });

        // update the seq doc last, so that if a meteor strikes the user's
        // computer in the middle of an update, we can apply the idempotent
        // batch update operation again
        lastSeqDoc.seq = seq;
        docsToPersist.push(lastSeqDoc);

        return view.db.bulkDocs({docs : docsToPersist});
      });
  });
}

var updateView = utils.sequentialize(mainQueue, function (view) {
  // bind the emit function once
  var mapResults;
  var doc;

  function emit(key, value) {
    var output = { id: doc._id, key: normalizeKey(key) };
    // Don't explicitly store the value unless it's defined and non-null.
    // This saves on storage space, because often people don't use it.
    if (typeof value !== 'undefined' && value !== null) {
      output.value = normalizeKey(value);
    }
    mapResults.push(output);
  }

  var mapFun;
  // for temp_views one can use emit(doc, emit), see #38
  if (typeof view.mapFun === "function" && view.mapFun.length === 2) {
    var origMap = view.mapFun;
    mapFun = function (doc) {
      return origMap(doc, emit);
    };
  } else {
    mapFun = evalFunc(view.mapFun.toString(), emit, sum, log, Array.isArray, JSON.parse);
  }

  var currentSeq = view.seq || 0;

  function processChange(docIdsToEmits, seq) {
    return function () {
      return saveKeyValues(view, docIdsToEmits, seq);
    };
  }
  var queue = new TaskQueue();
  // TODO(neojski): https://github.com/daleharvey/pouchdb/issues/1521

  return new Promise(function (resolve, reject) {

    function complete() {
      queue.finish().then(function () {
        view.seq = currentSeq;
        resolve();
      });
    }

    function processNextBatch() {
      view.sourceDB.changes({
        conflicts: true,
        include_docs: true,
        since : currentSeq,
        limit : CHANGES_BATCH_SIZE
      }).on('complete', function (response) {
        var results = response.results;
        if (!results.length) {
          return complete();
        }
        var docIdsToEmits = {};
        for (var i = 0, l = results.length; i < l; i++) {
          var change = results[i];
          if (change.doc._id[0] !== '_') {
            mapResults = [];
            doc = change.doc;

            if (!doc._deleted) {
              tryCode(view.sourceDB, mapFun, [doc]);
            }
            mapResults.sort(sortByKeyThenValue);

            var indexableKeysToKeyValues = {};
            var lastKey;
            for (var j = 0, jl = mapResults.length; j < jl; j++) {
              var obj = mapResults[j];
              var complexKey = [obj.key, obj.id];
              if (obj.key === lastKey) {
                complexKey.push(j); // dup key+id, so make it unique
              }
              var indexableKey = toIndexableString(complexKey);
              indexableKeysToKeyValues[indexableKey] = obj;
              lastKey = obj.key;
            }
            docIdsToEmits[change.doc._id] = indexableKeysToKeyValues;
          }
          currentSeq = change.seq;
        }
        queue.add(processChange(docIdsToEmits, currentSeq));
        if (results.length < CHANGES_BATCH_SIZE) {
          return complete();
        }
        return processNextBatch();
      }).on('error', onError);
      /* istanbul ignore next */
      function onError(err) {
        reject(err);
      }
    }
    processNextBatch();
  });
});

function reduceView(view, results, options) {
  if (options.group_level === 0) {
    delete options.group_level;
  }

  var shouldGroup = options.group || options.group_level;

  var reduceFun;
  if (builtInReduce[view.reduceFun]) {
    reduceFun = builtInReduce[view.reduceFun];
  } else {
    reduceFun = evalFunc(
      view.reduceFun.toString(), null, sum, log, Array.isArray, JSON.parse);
  }

  var groups = [];
  var lvl = options.group_level;
  results.forEach(function (e) {
    var last = groups[groups.length - 1];
    var key = shouldGroup ? e.key : null;

    // only set group_level for array keys
    if (shouldGroup && Array.isArray(key) && typeof lvl === 'number') {
      key = key.length > lvl ? key.slice(0, lvl) : key;
    }

    if (last && collate(last.key[0][0], key) === 0) {
      last.key.push([key, e.id]);
      last.value.push(e.value);
      return;
    }
    groups.push({key: [
      [key, e.id]
    ], value: [e.value]});
  });
  for (var i = 0, len = groups.length; i < len; i++) {
    var e = groups[i];
    var reduceTry = tryCode(view.sourceDB, reduceFun, [e.key, e.value, false]);
    // CouchDB typically just sets the value to null if reduce errors out
    e.value = reduceTry.error ? null : reduceTry.output;
    e.key = e.key[0][0];
  }
  // no total_rows/offset when reducing
  return {rows: sliceResults(groups, options.limit, options.skip)};
}

var queryView = utils.sequentialize(mainQueue, function (view, opts) {
  var totalRows;
  var shouldReduce = view.reduceFun && opts.reduce !== false;
  var skip = opts.skip || 0;
  if (typeof opts.keys !== 'undefined' && !opts.keys.length) {
    // equivalent query
    opts.limit = 0;
    delete opts.keys;
  }

  function fetchFromView(viewOpts) {
    viewOpts.include_docs = true;
    return view.db.allDocs(viewOpts).then(function (res) {
      totalRows = res.total_rows;
      return res.rows.map(function (result) {

        // implicit migration - in older versions of PouchDB,
        // we explicitly stored the doc as {id: ..., key: ..., value: ...}
        // this is tested in a migration test
        /* istanbul ignore next */
        if ('value' in result.doc && typeof result.doc.value === 'object' &&
            result.doc.value !== null) {
          var keys = Object.keys(result.doc.value).sort();
          // this detection method is not perfect, but it's unlikely the user
          // emitted a value which was an object with these 3 exact keys
          var expectedKeys = ['id', 'key', 'value'];
          if (!(keys < expectedKeys || keys > expectedKeys)) {
            return result.doc.value;
          }
        }

        var parsedKeyAndDocId = pouchCollate.parseIndexableString(result.doc._id);
        return {
          key: parsedKeyAndDocId[0],
          id: parsedKeyAndDocId[1],
          value: ('value' in result.doc ? result.doc.value : null)
        };
      });
    });
  }

  function onMapResultsReady(results) {
    var res;
    if (shouldReduce) {
      res = reduceView(view, results, opts);
    } else {
      res = {
        total_rows: totalRows,
        offset: skip,
        rows: results
      };
    }
    if (opts.include_docs) {
      var getDocsPromises = results.map(function (row) {
        var val = row.value;
        var docId = (val && typeof val === 'object' && val._id) || row.id;
        return view.sourceDB.get(docId).then(function (joinedDoc) {
          row.doc = joinedDoc;
        }, function () {
          // document error = don't join
        });
      });
      return Promise.all(getDocsPromises).then(function () {
        return res;
      });
    } else {
      return res;
    }
  }

  var flatten = function (array) {
    return array.reduce(function (prev, cur) {
      return prev.concat(cur);
    });
  };

  if (typeof opts.keys !== 'undefined') {
    var keys = opts.keys;
    var fetchPromises = keys.map(function (key) {
      var viewOpts = {
        startkey : toIndexableString([key]),
        endkey   : toIndexableString([key, {}])
      };
      return fetchFromView(viewOpts);
    });
    return Promise.all(fetchPromises).then(flatten).then(onMapResultsReady);
  } else { // normal query, no 'keys'
    var viewOpts = {
      descending : opts.descending
    };
    if (typeof opts.startkey !== 'undefined') {
      viewOpts.startkey = opts.descending ?
        toIndexableString([opts.startkey, {}]) :
        toIndexableString([opts.startkey]);
    }
    if (typeof opts.endkey !== 'undefined') {
      var inclusiveEnd = opts.inclusive_end !== false;
      if (opts.descending) {
        inclusiveEnd = !inclusiveEnd;
      }

      viewOpts.endkey = toIndexableString(inclusiveEnd ? [opts.endkey, {}] : [opts.endkey]);
    }
    if (typeof opts.key !== 'undefined') {
      var keyStart = toIndexableString([opts.key]);
      var keyEnd = toIndexableString([opts.key, {}]);
      if (viewOpts.descending) {
        viewOpts.endkey = keyStart;
        viewOpts.startkey = keyEnd;
      } else {
        viewOpts.startkey = keyStart;
        viewOpts.endkey = keyEnd;
      }
    }
    if (!shouldReduce) {
      if (typeof opts.limit === 'number') {
        viewOpts.limit = opts.limit;
      }
      viewOpts.skip = skip;
    }
    return fetchFromView(viewOpts).then(onMapResultsReady);
  }
});

function httpViewCleanup(db) {
  return db.request({
    method: 'POST',
    url: '_view_cleanup'
  });
}

var localViewCleanup = utils.sequentialize(mainQueue, function (db) {
  return db.get('_local/mrviews').then(function (metaDoc) {
    var docsToViews = {};
    Object.keys(metaDoc.views).forEach(function (fullViewName) {
      var parts = parseViewName(fullViewName);
      var designDocName = '_design/' + parts[0];
      var viewName = parts[1];
      docsToViews[designDocName] = docsToViews[designDocName] || {};
      docsToViews[designDocName][viewName] = true;
    });
    var opts = {
      keys : Object.keys(docsToViews),
      include_docs : true
    };
    return db.allDocs(opts).then(function (res) {
      var viewsToStatus = {};
      res.rows.forEach(function (row) {
        var ddocName = row.key.substring(8);
        Object.keys(docsToViews[row.key]).forEach(function (viewName) {
          var fullViewName = ddocName + '/' + viewName;
          /* istanbul ignore if */
          if (!metaDoc.views[fullViewName]) {
            // new format, without slashes, to support PouchDB 2.2.0
            // migration test in pouchdb's browser.migration.js verifies this
            fullViewName = viewName;
          }
          var viewDBNames = Object.keys(metaDoc.views[fullViewName]);
          // design doc deleted, or view function nonexistent
          var statusIsGood = row.doc && row.doc.views && row.doc.views[viewName];
          viewDBNames.forEach(function (viewDBName) {
            viewsToStatus[viewDBName] = viewsToStatus[viewDBName] || statusIsGood;
          });
        });
      });
      var dbsToDelete = Object.keys(viewsToStatus).filter(function (viewDBName) {
        return !viewsToStatus[viewDBName];
      });
      var destroyPromises = dbsToDelete.map(function (viewDBName) {
        return db.constructor.destroy(viewDBName, {adapter : db.adapter});
      });
      return Promise.all(destroyPromises).then(function () {
        return {ok: true};
      });
    });
  }, defaultsTo({ok: true}));
});

exports.viewCleanup = utils.callbackify(function () {
  var db = this;
  if (db.type() === 'http') {
    return httpViewCleanup(db);
  }
  return localViewCleanup(db);
});

function queryPromised(db, fun, opts) {
  if (db.type() === 'http') {
    return httpQuery(db, fun, opts);
  }

  if (typeof fun !== 'string') {
    // temp_view
    checkQueryParseError(opts, fun);

    var createViewOpts = {
      db : db,
      viewName : 'temp_view/temp_view',
      map : fun.map,
      reduce : fun.reduce,
      temporary : true
    };
    tempViewQueue.add(function () {
      return createView(createViewOpts).then(function (view) {
        function cleanup() {
          return view.db.destroy();
        }
        return utils.fin(updateView(view).then(function () {
          return queryView(view, opts);
        }), cleanup);
      });
    });
    return tempViewQueue.finish();
  } else {
    // persistent view
    var fullViewName = fun;
    var parts = parseViewName(fullViewName);
    var designDocName = parts[0];
    var viewName = parts[1];
    return db.get('_design/' + designDocName).then(function (doc) {
      var fun = doc.views && doc.views[viewName];

      if (!fun || typeof fun.map !== 'string') {
        throw new NotFoundError('ddoc ' + designDocName + ' has no view named ' +
          viewName);
      }
      checkQueryParseError(opts, fun);

      var createViewOpts = {
        db : db,
        viewName : fullViewName,
        map : fun.map,
        reduce : fun.reduce
      };
      return createView(createViewOpts).then(function (view) {
        if (opts.stale === 'ok' || opts.stale === 'update_after') {
          if (opts.stale === 'update_after') {
            process.nextTick(function () {
              updateView(view);
            });
          }
          return queryView(view, opts);
        } else { // stale not ok
          return updateView(view).then(function () {
            return queryView(view, opts);
          });
        }
      });
    });
  }
}

exports.query = function (fun, opts, callback) {
  if (typeof opts === 'function') {
    callback = opts;
    opts = {};
  }
  opts = utils.extend(true, {}, opts);

  if (typeof fun === 'function') {
    fun = {map : fun};
  }

  var db = this;
  var promise = Promise.resolve().then(function () {
    return queryPromised(db, fun, opts);
  });
  utils.promisedCallback(promise, callback);
  return promise;
};

function QueryParseError(message) {
  this.status = 400;
  this.name = 'query_parse_error';
  this.message = message;
  this.error = true;
  try {
    Error.captureStackTrace(this, QueryParseError);
  } catch (e) {}
}

utils.inherits(QueryParseError, Error);

function NotFoundError(message) {
  this.status = 404;
  this.name = 'not_found';
  this.message = message;
  this.error = true;
  try {
    Error.captureStackTrace(this, NotFoundError);
  } catch (e) {}
}

utils.inherits(NotFoundError, Error);

}).call(this,_dereq_("/Users/nolan/workspace/pouchdb/node_modules/browserify/node_modules/insert-module-globals/node_modules/process/browser.js"))
},{"./create-view":49,"./evalfunc":50,"./taskqueue":54,"./utils":56,"/Users/nolan/workspace/pouchdb/node_modules/browserify/node_modules/insert-module-globals/node_modules/process/browser.js":28,"pouchdb-collate":52}],52:[function(_dereq_,module,exports){
'use strict';

var MIN_MAGNITUDE = -324; // verified by -Number.MIN_VALUE
var MAGNITUDE_DIGITS = 3; // ditto
var SEP = ''; // set to '_' for easier debugging 

var utils = _dereq_('./utils');

exports.collate = function (a, b) {

  if (a === b) {
    return 0;
  }

  a = exports.normalizeKey(a);
  b = exports.normalizeKey(b);

  var ai = collationIndex(a);
  var bi = collationIndex(b);
  if ((ai - bi) !== 0) {
    return ai - bi;
  }
  if (a === null) {
    return 0;
  }
  switch (typeof a) {
    case 'number':
      return a - b;
    case 'boolean':
      return a === b ? 0 : (a < b ? -1 : 1);
    case 'string':
      return stringCollate(a, b);
  }
  return Array.isArray(a) ? arrayCollate(a, b) : objectCollate(a, b);
};

// couch considers null/NaN/Infinity/-Infinity === undefined,
// for the purposes of mapreduce indexes. also, dates get stringified.
exports.normalizeKey = function (key) {
  switch (typeof key) {
    case 'undefined':
      return null;
    case 'number':
      if (key === Infinity || key === -Infinity || isNaN(key)) {
        return null;
      }
      return key;
    case 'object':
      var origKey = key;
      if (Array.isArray(key)) {
        var len = key.length;
        key = new Array(len);
        for (var i = 0; i < len; i++) {
          key[i] = exports.normalizeKey(origKey[i]);
        }
      } else if (key instanceof Date) {
        return key.toJSON();
      } else if (key !== null) { // generic object
        key = {};
        for (var k in origKey) {
          if (origKey.hasOwnProperty(k)) {
            var val = origKey[k];
            if (typeof val !== 'undefined') {
              key[k] = exports.normalizeKey(val);
            }
          }
        }
      }
  }
  return key;
};

function indexify(key) {
  if (key !== null) {
    switch (typeof key) {
      case 'boolean':
        return key ? 1 : 0;
      case 'number':
        return numToIndexableString(key);
      case 'string':
        // We've to be sure that key does not contain \u0000
        // Do order-preserving replacements:
        // 0 -> 1, 1
        // 1 -> 1, 2
        // 2 -> 2, 2
        return key
          .replace(/\u0002/g, '\u0002\u0002')
          .replace(/\u0001/g, '\u0001\u0002')
          .replace(/\u0000/g, '\u0001\u0001');
      case 'object':
        var isArray = Array.isArray(key);
        var arr = isArray ? key : Object.keys(key);
        var i = -1;
        var len = arr.length;
        var result = '';
        if (isArray) {
          while (++i < len) {
            result += exports.toIndexableString(arr[i]);
          }
        } else {
          while (++i < len) {
            var objKey = arr[i];
            result += exports.toIndexableString(objKey) +
                exports.toIndexableString(key[objKey]);
          }
        }
        return result;
    }
  }
  return '';
}

// convert the given key to a string that would be appropriate
// for lexical sorting, e.g. within a database, where the
// sorting is the same given by the collate() function.
exports.toIndexableString = function (key) {
  var zero = '\u0000';
  key = exports.normalizeKey(key);
  return collationIndex(key) + SEP + indexify(key) + zero;
};

function parseNumber(str, i) {
  var originalIdx = i;
  var num;
  var zero = str[i] === '1';
  if (zero) {
    num = 0;
    i++;
  } else {
    var neg = str[i] === '0';
    i++;
    var numAsString = '';
    var magAsString = str.substring(i, i + MAGNITUDE_DIGITS);
    var magnitude = parseInt(magAsString, 10) + MIN_MAGNITUDE;
    if (neg) {
      magnitude = -magnitude;
    }
    i += MAGNITUDE_DIGITS;
    while (true) {
      var ch = str[i];
      if (ch === '\u0000') {
        break;
      } else {
        numAsString += ch;
      }
      i++;
    }
    numAsString = numAsString.split('.');
    if (numAsString.length === 1) {
      num = parseInt(numAsString, 10);
    } else {
      num = parseFloat(numAsString[0] + '.' + numAsString[1]);
    }
    if (neg) {
      num = num - 10;
    }
    if (magnitude !== 0) {
      // parseFloat is more reliable than pow due to rounding errors
      // e.g. Number.MAX_VALUE would return Infinity if we did
      // num * Math.pow(10, magnitude);
      num = parseFloat(num + 'e' + magnitude);
    }
  }
  return {num: num, length : i - originalIdx};
}

// move up the stack while parsing
// this function moved outside of parseIndexableString for performance
function pop(stack, metaStack) {
  var obj = stack.pop();

  if (metaStack.length) {
    var lastMetaElement = metaStack[metaStack.length - 1];
    if (obj === lastMetaElement.element) {
      // popping a meta-element, e.g. an object whose value is another object
      metaStack.pop();
      lastMetaElement = metaStack[metaStack.length - 1];
    }
    var element = lastMetaElement.element;
    var lastElementIndex = lastMetaElement.index;
    if (Array.isArray(element)) {
      element.push(obj);
    } else if (lastElementIndex === stack.length - 2) { // obj with key+value
      var key = stack.pop();
      element[key] = obj;
    } else {
      stack.push(obj); // obj with key only
    }
  }
}

exports.parseIndexableString = function (str) {
  var stack = [];
  var metaStack = []; // stack for arrays and objects
  var i = 0;

  while (true) {
    var collationIndex = str[i++];
    if (collationIndex === '\u0000') {
      if (stack.length === 1) {
        return stack.pop();
      } else {
        pop(stack, metaStack);
        continue;
      }
    }
    switch (collationIndex) {
      case '1':
        stack.push(null);
        break;
      case '2':
        stack.push(str[i] === '1');
        i++;
        break;
      case '3':
        var parsedNum = parseNumber(str, i);
        stack.push(parsedNum.num);
        i += parsedNum.length;
        break;
      case '4':
        var parsedStr = '';
        while (true) {
          var ch = str[i];
          if (ch === '\u0000') {
            break;
          }
          parsedStr += ch;
          i++;
        }
        // perform the reverse of the order-preserving replacement
        // algorithm (see above)
        parsedStr = parsedStr.replace(/\u0001\u0001/g, '\u0000')
          .replace(/\u0001\u0002/g, '\u0001')
          .replace(/\u0002\u0002/g, '\u0002');
        stack.push(parsedStr);
        break;
      case '5':
        var arrayElement = { element: [], index: stack.length };
        stack.push(arrayElement.element);
        metaStack.push(arrayElement);
        break;
      case '6':
        var objElement = { element: {}, index: stack.length };
        stack.push(objElement.element);
        metaStack.push(objElement);
        break;
      default:
        throw new Error(
          'bad collationIndex or unexpectedly reached end of input: ' + collationIndex);
    }
  }
};

function arrayCollate(a, b) {
  var len = Math.min(a.length, b.length);
  for (var i = 0; i < len; i++) {
    var sort = exports.collate(a[i], b[i]);
    if (sort !== 0) {
      return sort;
    }
  }
  return (a.length === b.length) ? 0 :
    (a.length > b.length) ? 1 : -1;
}
function stringCollate(a, b) {
  // See: https://github.com/daleharvey/pouchdb/issues/40
  // This is incompatible with the CouchDB implementation, but its the
  // best we can do for now
  return (a === b) ? 0 : ((a > b) ? 1 : -1);
}
function objectCollate(a, b) {
  var ak = Object.keys(a), bk = Object.keys(b);
  var len = Math.min(ak.length, bk.length);
  for (var i = 0; i < len; i++) {
    // First sort the keys
    var sort = exports.collate(ak[i], bk[i]);
    if (sort !== 0) {
      return sort;
    }
    // if the keys are equal sort the values
    sort = exports.collate(a[ak[i]], b[bk[i]]);
    if (sort !== 0) {
      return sort;
    }

  }
  return (ak.length === bk.length) ? 0 :
    (ak.length > bk.length) ? 1 : -1;
}
// The collation is defined by erlangs ordered terms
// the atoms null, true, false come first, then numbers, strings,
// arrays, then objects
// null/undefined/NaN/Infinity/-Infinity are all considered null
function collationIndex(x) {
  var id = ['boolean', 'number', 'string', 'object'];
  var idx = id.indexOf(typeof x);
  //false if -1 otherwise true, but fast!!!!1
  if (~idx) {
    if (x === null) {
      return 1;
    }
    if (Array.isArray(x)) {
      return 5;
    }
    return idx < 3 ? (idx + 2) : (idx + 3);
  }
  if (Array.isArray(x)) {
    return 5;
  }
}

// conversion:
// x yyy zz...zz
// x = 0 for negative, 1 for 0, 2 for positive
// y = exponent (for negative numbers negated) moved so that it's >= 0
// z = mantisse
function numToIndexableString(num) {

  if (num === 0) {
    return '1';
  }

  // convert number to exponential format for easier and
  // more succinct string sorting
  var expFormat = num.toExponential().split(/e\+?/);
  var magnitude = parseInt(expFormat[1], 10);

  var neg = num < 0;

  var result = neg ? '0' : '2';

  // first sort by magnitude
  // it's easier if all magnitudes are positive
  var magForComparison = ((neg ? -magnitude : magnitude) - MIN_MAGNITUDE);
  var magString = utils.padLeft((magForComparison).toString(), '0', MAGNITUDE_DIGITS);

  result += SEP + magString;

  // then sort by the factor
  var factor = Math.abs(parseFloat(expFormat[0])); // [1..10)
  if (neg) { // for negative reverse ordering
    factor = 10 - factor;
  }

  var factorStr = factor.toFixed(20);

  // strip zeros from the end
  factorStr = factorStr.replace(/\.?0+$/, '');

  result += SEP + factorStr;

  return result;
}

},{"./utils":53}],53:[function(_dereq_,module,exports){
'use strict';

function pad(str, padWith, upToLength) {
  var padding = '';
  var targetLength = upToLength - str.length;
  while (padding.length < targetLength) {
    padding += padWith;
  }
  return padding;
}

exports.padLeft = function (str, padWith, upToLength) {
  var padding = pad(str, padWith, upToLength);
  return padding + str;
};

exports.padRight = function (str, padWith, upToLength) {
  var padding = pad(str, padWith, upToLength);
  return str + padding;
};

exports.stringLexCompare = function (a, b) {

  var aLen = a.length;
  var bLen = b.length;

  var i;
  for (i = 0; i < aLen; i++) {
    if (i === bLen) {
      // b is shorter substring of a
      return 1;
    }
    var aChar = a.charAt(i);
    var bChar = b.charAt(i);
    if (aChar !== bChar) {
      return aChar < bChar ? -1 : 1;
    }
  }

  if (aLen < bLen) {
    // a is shorter substring of b
    return -1;
  }

  return 0;
};

/*
 * returns the decimal form for the given integer, i.e. writes
 * out all the digits (in base-10) instead of using scientific notation
 */
exports.intToDecimalForm = function (int) {

  var isNeg = int < 0;
  var result = '';

  do {
    var remainder = isNeg ? -Math.ceil(int % 10) : Math.floor(int % 10);

    result = remainder + result;
    int = isNeg ? Math.ceil(int / 10) : Math.floor(int / 10);
  } while (int);


  if (isNeg && result !== '0') {
    result = '-' + result;
  }

  return result;
};
},{}],54:[function(_dereq_,module,exports){
'use strict';
/*
 * Simple task queue to sequentialize actions. Assumes callbacks will eventually fire (once).
 */

var Promise = _dereq_('./utils').Promise;

function TaskQueue() {
  this.promise = new Promise(function (fulfill) {fulfill(); });
}
TaskQueue.prototype.add = function (promiseFactory) {
  this.promise = this.promise["catch"](function () {
    // just recover
  }).then(function () {
    return promiseFactory();
  });
  return this.promise;
};
TaskQueue.prototype.finish = function () {
  return this.promise;
};

module.exports = TaskQueue;

},{"./utils":56}],55:[function(_dereq_,module,exports){
'use strict';
var Promise = _dereq_('./utils').Promise;

// this is essentially the "update sugar" function from daleharvey/pouchdb#1388
// the diffFun tells us what delta to apply to the doc.  it either returns
// the doc, or false if it doesn't need to do an update after all
function upsert(db, docId, diffFun) {
  return new Promise(function (fulfill, reject) {
    if (docId && typeof docId === 'object') {
      docId = docId._id;
    }
    if (typeof docId !== 'string') {
      return reject(new Error('doc id is required'));
    }

    db.get(docId, function (err, doc) {
      if (err) {
        if (err.status !== 404) {
          return reject(err);
        }
        return fulfill(tryAndPut(db, diffFun({_id : docId}), diffFun));
      }
      var newDoc = diffFun(doc);
      if (!newDoc) {
        return fulfill(doc);
      }
      fulfill(tryAndPut(db, newDoc, diffFun));
    });
  });
}

function tryAndPut(db, doc, diffFun) {
  return db.put(doc)["catch"](function (err) {
    if (err.status !== 409) {
      throw err;
    }
    return upsert(db, doc, diffFun);
  });
}

module.exports = upsert;

},{"./utils":56}],56:[function(_dereq_,module,exports){
(function (process,global){
'use strict';
/* istanbul ignore if */
if (typeof global.Promise === 'function') {
  exports.Promise = global.Promise;
} else {
  exports.Promise = _dereq_('lie');
}
// uniquify a list, similar to underscore's _.uniq
exports.uniq = function (arr) {
  var map = {};
  arr.forEach(function (element) {
    map[element] = true;
  });
  return Object.keys(map);
};

exports.inherits = _dereq_('inherits');
exports.extend = _dereq_('pouchdb-extend');
var argsarray = _dereq_('argsarray');

exports.promisedCallback = function (promise, callback) {
  if (callback) {
    promise.then(function (res) {
      process.nextTick(function () {
        callback(null, res);
      });
    }, function (reason) {
      process.nextTick(function () {
        callback(reason);
      });
    });
  }
  return promise;
};

exports.callbackify = function (fun) {
  return argsarray(function (args) {
    var cb = args.pop();
    var promise = fun.apply(this, args);
    if (typeof cb === 'function') {
      exports.promisedCallback(promise, cb);
    }
    return promise;
  });
};

// Promise finally util similar to Q.finally
exports.fin = function (promise, cb) {
  return promise.then(function (res) {
    var promise2 = cb();
    if (typeof promise2.then === 'function') {
      return promise2.then(function () {
        return res;
      });
    }
    return res;
  }, function (reason) {
    var promise2 = cb();
    if (typeof promise2.then === 'function') {
      return promise2.then(function () {
        throw reason;
      });
    }
    throw reason;
  });
};

exports.sequentialize = function (queue, promiseFactory) {
  return function () {
    var args = arguments;
    var that = this;
    return queue.add(function () {
      return promiseFactory.apply(that, args);
    });
  };
};

var crypto = _dereq_('crypto');
var Md5 = _dereq_('spark-md5');

exports.MD5 = function (string) {
  /* istanbul ignore else */
  if (!process.browser) {
    return crypto.createHash('md5').update(string).digest('hex');
  } else {
    return Md5.hash(string);
  }
};
}).call(this,_dereq_("/Users/nolan/workspace/pouchdb/node_modules/browserify/node_modules/insert-module-globals/node_modules/process/browser.js"),typeof self !== "undefined" ? self : typeof window !== "undefined" ? window : {})
},{"/Users/nolan/workspace/pouchdb/node_modules/browserify/node_modules/insert-module-globals/node_modules/process/browser.js":28,"argsarray":25,"crypto":26,"inherits":29,"lie":33,"pouchdb-extend":48,"spark-md5":57}],57:[function(_dereq_,module,exports){
/*jshint bitwise:false*/
/*global unescape*/

(function (factory) {
    if (typeof exports === 'object') {
        // Node/CommonJS
        module.exports = factory();
    } else if (typeof define === 'function' && define.amd) {
        // AMD
        define(factory);
    } else {
        // Browser globals (with support for web workers)
        var glob;
        try {
            glob = window;
        } catch (e) {
            glob = self;
        }

        glob.SparkMD5 = factory();
    }
}(function (undefined) {

    'use strict';

    ////////////////////////////////////////////////////////////////////////////

    /*
     * Fastest md5 implementation around (JKM md5)
     * Credits: Joseph Myers
     *
     * @see http://www.myersdaily.org/joseph/javascript/md5-text.html
     * @see http://jsperf.com/md5-shootout/7
     */

    /* this function is much faster,
      so if possible we use it. Some IEs
      are the only ones I know of that
      need the idiotic second function,
      generated by an if clause.  */
    var add32 = function (a, b) {
        return (a + b) & 0xFFFFFFFF;
    },

    cmn = function (q, a, b, x, s, t) {
        a = add32(add32(a, q), add32(x, t));
        return add32((a << s) | (a >>> (32 - s)), b);
    },

    ff = function (a, b, c, d, x, s, t) {
        return cmn((b & c) | ((~b) & d), a, b, x, s, t);
    },

    gg = function (a, b, c, d, x, s, t) {
        return cmn((b & d) | (c & (~d)), a, b, x, s, t);
    },

    hh = function (a, b, c, d, x, s, t) {
        return cmn(b ^ c ^ d, a, b, x, s, t);
    },

    ii = function (a, b, c, d, x, s, t) {
        return cmn(c ^ (b | (~d)), a, b, x, s, t);
    },

    md5cycle = function (x, k) {
        var a = x[0],
            b = x[1],
            c = x[2],
            d = x[3];

        a = ff(a, b, c, d, k[0], 7, -680876936);
        d = ff(d, a, b, c, k[1], 12, -389564586);
        c = ff(c, d, a, b, k[2], 17, 606105819);
        b = ff(b, c, d, a, k[3], 22, -1044525330);
        a = ff(a, b, c, d, k[4], 7, -176418897);
        d = ff(d, a, b, c, k[5], 12, 1200080426);
        c = ff(c, d, a, b, k[6], 17, -1473231341);
        b = ff(b, c, d, a, k[7], 22, -45705983);
        a = ff(a, b, c, d, k[8], 7, 1770035416);
        d = ff(d, a, b, c, k[9], 12, -1958414417);
        c = ff(c, d, a, b, k[10], 17, -42063);
        b = ff(b, c, d, a, k[11], 22, -1990404162);
        a = ff(a, b, c, d, k[12], 7, 1804603682);
        d = ff(d, a, b, c, k[13], 12, -40341101);
        c = ff(c, d, a, b, k[14], 17, -1502002290);
        b = ff(b, c, d, a, k[15], 22, 1236535329);

        a = gg(a, b, c, d, k[1], 5, -165796510);
        d = gg(d, a, b, c, k[6], 9, -1069501632);
        c = gg(c, d, a, b, k[11], 14, 643717713);
        b = gg(b, c, d, a, k[0], 20, -373897302);
        a = gg(a, b, c, d, k[5], 5, -701558691);
        d = gg(d, a, b, c, k[10], 9, 38016083);
        c = gg(c, d, a, b, k[15], 14, -660478335);
        b = gg(b, c, d, a, k[4], 20, -405537848);
        a = gg(a, b, c, d, k[9], 5, 568446438);
        d = gg(d, a, b, c, k[14], 9, -1019803690);
        c = gg(c, d, a, b, k[3], 14, -187363961);
        b = gg(b, c, d, a, k[8], 20, 1163531501);
        a = gg(a, b, c, d, k[13], 5, -1444681467);
        d = gg(d, a, b, c, k[2], 9, -51403784);
        c = gg(c, d, a, b, k[7], 14, 1735328473);
        b = gg(b, c, d, a, k[12], 20, -1926607734);

        a = hh(a, b, c, d, k[5], 4, -378558);
        d = hh(d, a, b, c, k[8], 11, -2022574463);
        c = hh(c, d, a, b, k[11], 16, 1839030562);
        b = hh(b, c, d, a, k[14], 23, -35309556);
        a = hh(a, b, c, d, k[1], 4, -1530992060);
        d = hh(d, a, b, c, k[4], 11, 1272893353);
        c = hh(c, d, a, b, k[7], 16, -155497632);
        b = hh(b, c, d, a, k[10], 23, -1094730640);
        a = hh(a, b, c, d, k[13], 4, 681279174);
        d = hh(d, a, b, c, k[0], 11, -358537222);
        c = hh(c, d, a, b, k[3], 16, -722521979);
        b = hh(b, c, d, a, k[6], 23, 76029189);
        a = hh(a, b, c, d, k[9], 4, -640364487);
        d = hh(d, a, b, c, k[12], 11, -421815835);
        c = hh(c, d, a, b, k[15], 16, 530742520);
        b = hh(b, c, d, a, k[2], 23, -995338651);

        a = ii(a, b, c, d, k[0], 6, -198630844);
        d = ii(d, a, b, c, k[7], 10, 1126891415);
        c = ii(c, d, a, b, k[14], 15, -1416354905);
        b = ii(b, c, d, a, k[5], 21, -57434055);
        a = ii(a, b, c, d, k[12], 6, 1700485571);
        d = ii(d, a, b, c, k[3], 10, -1894986606);
        c = ii(c, d, a, b, k[10], 15, -1051523);
        b = ii(b, c, d, a, k[1], 21, -2054922799);
        a = ii(a, b, c, d, k[8], 6, 1873313359);
        d = ii(d, a, b, c, k[15], 10, -30611744);
        c = ii(c, d, a, b, k[6], 15, -1560198380);
        b = ii(b, c, d, a, k[13], 21, 1309151649);
        a = ii(a, b, c, d, k[4], 6, -145523070);
        d = ii(d, a, b, c, k[11], 10, -1120210379);
        c = ii(c, d, a, b, k[2], 15, 718787259);
        b = ii(b, c, d, a, k[9], 21, -343485551);

        x[0] = add32(a, x[0]);
        x[1] = add32(b, x[1]);
        x[2] = add32(c, x[2]);
        x[3] = add32(d, x[3]);
    },

    /* there needs to be support for Unicode here,
       * unless we pretend that we can redefine the MD-5
       * algorithm for multi-byte characters (perhaps
       * by adding every four 16-bit characters and
       * shortening the sum to 32 bits). Otherwise
       * I suggest performing MD-5 as if every character
       * was two bytes--e.g., 0040 0025 = @%--but then
       * how will an ordinary MD-5 sum be matched?
       * There is no way to standardize text to something
       * like UTF-8 before transformation; speed cost is
       * utterly prohibitive. The JavaScript standard
       * itself needs to look at this: it should start
       * providing access to strings as preformed UTF-8
       * 8-bit unsigned value arrays.
       */
    md5blk = function (s) {
        var md5blks = [],
            i; /* Andy King said do it this way. */

        for (i = 0; i < 64; i += 4) {
            md5blks[i >> 2] = s.charCodeAt(i) + (s.charCodeAt(i + 1) << 8) + (s.charCodeAt(i + 2) << 16) + (s.charCodeAt(i + 3) << 24);
        }
        return md5blks;
    },

    md5blk_array = function (a) {
        var md5blks = [],
            i; /* Andy King said do it this way. */

        for (i = 0; i < 64; i += 4) {
            md5blks[i >> 2] = a[i] + (a[i + 1] << 8) + (a[i + 2] << 16) + (a[i + 3] << 24);
        }
        return md5blks;
    },

    md51 = function (s) {
        var n = s.length,
            state = [1732584193, -271733879, -1732584194, 271733878],
            i,
            length,
            tail,
            tmp,
            lo,
            hi;

        for (i = 64; i <= n; i += 64) {
            md5cycle(state, md5blk(s.substring(i - 64, i)));
        }
        s = s.substring(i - 64);
        length = s.length;
        tail = [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0];
        for (i = 0; i < length; i += 1) {
            tail[i >> 2] |= s.charCodeAt(i) << ((i % 4) << 3);
        }
        tail[i >> 2] |= 0x80 << ((i % 4) << 3);
        if (i > 55) {
            md5cycle(state, tail);
            for (i = 0; i < 16; i += 1) {
                tail[i] = 0;
            }
        }

        // Beware that the final length might not fit in 32 bits so we take care of that
        tmp = n * 8;
        tmp = tmp.toString(16).match(/(.*?)(.{0,8})$/);
        lo = parseInt(tmp[2], 16);
        hi = parseInt(tmp[1], 16) || 0;

        tail[14] = lo;
        tail[15] = hi;

        md5cycle(state, tail);
        return state;
    },

    md51_array = function (a) {
        var n = a.length,
            state = [1732584193, -271733879, -1732584194, 271733878],
            i,
            length,
            tail,
            tmp,
            lo,
            hi;

        for (i = 64; i <= n; i += 64) {
            md5cycle(state, md5blk_array(a.subarray(i - 64, i)));
        }

        // Not sure if it is a bug, however IE10 will always produce a sub array of length 1
        // containing the last element of the parent array if the sub array specified starts
        // beyond the length of the parent array - weird.
        // https://connect.microsoft.com/IE/feedback/details/771452/typed-array-subarray-issue
        a = (i - 64) < n ? a.subarray(i - 64) : new Uint8Array(0);

        length = a.length;
        tail = [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0];
        for (i = 0; i < length; i += 1) {
            tail[i >> 2] |= a[i] << ((i % 4) << 3);
        }

        tail[i >> 2] |= 0x80 << ((i % 4) << 3);
        if (i > 55) {
            md5cycle(state, tail);
            for (i = 0; i < 16; i += 1) {
                tail[i] = 0;
            }
        }

        // Beware that the final length might not fit in 32 bits so we take care of that
        tmp = n * 8;
        tmp = tmp.toString(16).match(/(.*?)(.{0,8})$/);
        lo = parseInt(tmp[2], 16);
        hi = parseInt(tmp[1], 16) || 0;

        tail[14] = lo;
        tail[15] = hi;

        md5cycle(state, tail);

        return state;
    },

    hex_chr = ['0', '1', '2', '3', '4', '5', '6', '7', '8', '9', 'a', 'b', 'c', 'd', 'e', 'f'],

    rhex = function (n) {
        var s = '',
            j;
        for (j = 0; j < 4; j += 1) {
            s += hex_chr[(n >> (j * 8 + 4)) & 0x0F] + hex_chr[(n >> (j * 8)) & 0x0F];
        }
        return s;
    },

    hex = function (x) {
        var i;
        for (i = 0; i < x.length; i += 1) {
            x[i] = rhex(x[i]);
        }
        return x.join('');
    },

    md5 = function (s) {
        return hex(md51(s));
    },



    ////////////////////////////////////////////////////////////////////////////

    /**
     * SparkMD5 OOP implementation.
     *
     * Use this class to perform an incremental md5, otherwise use the
     * static methods instead.
     */
    SparkMD5 = function () {
        // call reset to init the instance
        this.reset();
    };


    // In some cases the fast add32 function cannot be used..
    if (md5('hello') !== '5d41402abc4b2a76b9719d911017c592') {
        add32 = function (x, y) {
            var lsw = (x & 0xFFFF) + (y & 0xFFFF),
                msw = (x >> 16) + (y >> 16) + (lsw >> 16);
            return (msw << 16) | (lsw & 0xFFFF);
        };
    }


    /**
     * Appends a string.
     * A conversion will be applied if an utf8 string is detected.
     *
     * @param {String} str The string to be appended
     *
     * @return {SparkMD5} The instance itself
     */
    SparkMD5.prototype.append = function (str) {
        // converts the string to utf8 bytes if necessary
        if (/[\u0080-\uFFFF]/.test(str)) {
            str = unescape(encodeURIComponent(str));
        }

        // then append as binary
        this.appendBinary(str);

        return this;
    };

    /**
     * Appends a binary string.
     *
     * @param {String} contents The binary string to be appended
     *
     * @return {SparkMD5} The instance itself
     */
    SparkMD5.prototype.appendBinary = function (contents) {
        this._buff += contents;
        this._length += contents.length;

        var length = this._buff.length,
            i;

        for (i = 64; i <= length; i += 64) {
            md5cycle(this._state, md5blk(this._buff.substring(i - 64, i)));
        }

        this._buff = this._buff.substr(i - 64);

        return this;
    };

    /**
     * Finishes the incremental computation, reseting the internal state and
     * returning the result.
     * Use the raw parameter to obtain the raw result instead of the hex one.
     *
     * @param {Boolean} raw True to get the raw result, false to get the hex result
     *
     * @return {String|Array} The result
     */
    SparkMD5.prototype.end = function (raw) {
        var buff = this._buff,
            length = buff.length,
            i,
            tail = [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
            ret;

        for (i = 0; i < length; i += 1) {
            tail[i >> 2] |= buff.charCodeAt(i) << ((i % 4) << 3);
        }

        this._finish(tail, length);
        ret = !!raw ? this._state : hex(this._state);

        this.reset();

        return ret;
    };

    /**
     * Finish the final calculation based on the tail.
     *
     * @param {Array}  tail   The tail (will be modified)
     * @param {Number} length The length of the remaining buffer
     */
    SparkMD5.prototype._finish = function (tail, length) {
        var i = length,
            tmp,
            lo,
            hi;

        tail[i >> 2] |= 0x80 << ((i % 4) << 3);
        if (i > 55) {
            md5cycle(this._state, tail);
            for (i = 0; i < 16; i += 1) {
                tail[i] = 0;
            }
        }

        // Do the final computation based on the tail and length
        // Beware that the final length may not fit in 32 bits so we take care of that
        tmp = this._length * 8;
        tmp = tmp.toString(16).match(/(.*?)(.{0,8})$/);
        lo = parseInt(tmp[2], 16);
        hi = parseInt(tmp[1], 16) || 0;

        tail[14] = lo;
        tail[15] = hi;
        md5cycle(this._state, tail);
    };

    /**
     * Resets the internal state of the computation.
     *
     * @return {SparkMD5} The instance itself
     */
    SparkMD5.prototype.reset = function () {
        this._buff = "";
        this._length = 0;
        this._state = [1732584193, -271733879, -1732584194, 271733878];

        return this;
    };

    /**
     * Releases memory used by the incremental buffer and other aditional
     * resources. If you plan to use the instance again, use reset instead.
     */
    SparkMD5.prototype.destroy = function () {
        delete this._state;
        delete this._buff;
        delete this._length;
    };


    /**
     * Performs the md5 hash on a string.
     * A conversion will be applied if utf8 string is detected.
     *
     * @param {String}  str The string
     * @param {Boolean} raw True to get the raw result, false to get the hex result
     *
     * @return {String|Array} The result
     */
    SparkMD5.hash = function (str, raw) {
        // converts the string to utf8 bytes if necessary
        if (/[\u0080-\uFFFF]/.test(str)) {
            str = unescape(encodeURIComponent(str));
        }

        var hash = md51(str);

        return !!raw ? hash : hex(hash);
    };

    /**
     * Performs the md5 hash on a binary string.
     *
     * @param {String}  content The binary string
     * @param {Boolean} raw     True to get the raw result, false to get the hex result
     *
     * @return {String|Array} The result
     */
    SparkMD5.hashBinary = function (content, raw) {
        var hash = md51(content);

        return !!raw ? hash : hex(hash);
    };

    /**
     * SparkMD5 OOP implementation for array buffers.
     *
     * Use this class to perform an incremental md5 ONLY for array buffers.
     */
    SparkMD5.ArrayBuffer = function () {
        // call reset to init the instance
        this.reset();
    };

    ////////////////////////////////////////////////////////////////////////////

    /**
     * Appends an array buffer.
     *
     * @param {ArrayBuffer} arr The array to be appended
     *
     * @return {SparkMD5.ArrayBuffer} The instance itself
     */
    SparkMD5.ArrayBuffer.prototype.append = function (arr) {
        // TODO: we could avoid the concatenation here but the algorithm would be more complex
        //       if you find yourself needing extra performance, please make a PR.
        var buff = this._concatArrayBuffer(this._buff, arr),
            length = buff.length,
            i;

        this._length += arr.byteLength;

        for (i = 64; i <= length; i += 64) {
            md5cycle(this._state, md5blk_array(buff.subarray(i - 64, i)));
        }

        // Avoids IE10 weirdness (documented above)
        this._buff = (i - 64) < length ? buff.subarray(i - 64) : new Uint8Array(0);

        return this;
    };

    /**
     * Finishes the incremental computation, reseting the internal state and
     * returning the result.
     * Use the raw parameter to obtain the raw result instead of the hex one.
     *
     * @param {Boolean} raw True to get the raw result, false to get the hex result
     *
     * @return {String|Array} The result
     */
    SparkMD5.ArrayBuffer.prototype.end = function (raw) {
        var buff = this._buff,
            length = buff.length,
            tail = [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
            i,
            ret;

        for (i = 0; i < length; i += 1) {
            tail[i >> 2] |= buff[i] << ((i % 4) << 3);
        }

        this._finish(tail, length);
        ret = !!raw ? this._state : hex(this._state);

        this.reset();

        return ret;
    };

    SparkMD5.ArrayBuffer.prototype._finish = SparkMD5.prototype._finish;

    /**
     * Resets the internal state of the computation.
     *
     * @return {SparkMD5.ArrayBuffer} The instance itself
     */
    SparkMD5.ArrayBuffer.prototype.reset = function () {
        this._buff = new Uint8Array(0);
        this._length = 0;
        this._state = [1732584193, -271733879, -1732584194, 271733878];

        return this;
    };

    /**
     * Releases memory used by the incremental buffer and other aditional
     * resources. If you plan to use the instance again, use reset instead.
     */
    SparkMD5.ArrayBuffer.prototype.destroy = SparkMD5.prototype.destroy;

    /**
     * Concats two array buffers, returning a new one.
     *
     * @param  {ArrayBuffer} first  The first array buffer
     * @param  {ArrayBuffer} second The second array buffer
     *
     * @return {ArrayBuffer} The new array buffer
     */
    SparkMD5.ArrayBuffer.prototype._concatArrayBuffer = function (first, second) {
        var firstLength = first.length,
            result = new Uint8Array(firstLength + second.byteLength);

        result.set(first);
        result.set(new Uint8Array(second), firstLength);

        return result;
    };

    /**
     * Performs the md5 hash on an array buffer.
     *
     * @param {ArrayBuffer} arr The array buffer
     * @param {Boolean}     raw True to get the raw result, false to get the hex result
     *
     * @return {String|Array} The result
     */
    SparkMD5.ArrayBuffer.hash = function (arr, raw) {
        var hash = md51_array(new Uint8Array(arr));

        return !!raw ? hash : hex(hash);
    };

    return SparkMD5;
}));

},{}],58:[function(_dereq_,module,exports){
'use strict';

/**
 * Stringify/parse functions that don't operate
 * recursively, so they avoid call stack exceeded
 * errors.
 */
exports.stringify = function stringify(input) {
  var queue = [];
  queue.push({obj: input});

  var res = '';
  var next, obj, prefix, val, i, arrayPrefix, keys, k, key, value, objPrefix;
  while ((next = queue.pop())) {
    obj = next.obj;
    prefix = next.prefix || '';
    val = next.val || '';
    res += prefix;
    if (val) {
      res += val;
    } else if (typeof obj !== 'object') {
      res += typeof obj === 'undefined' ? null : JSON.stringify(obj);
    } else if (obj === null) {
      res += 'null';
    } else if (Array.isArray(obj)) {
      queue.push({val: ']'});
      for (i = obj.length - 1; i >= 0; i--) {
        arrayPrefix = i === 0 ? '' : ',';
        queue.push({obj: obj[i], prefix: arrayPrefix});
      }
      queue.push({val: '['});
    } else { // object
      keys = [];
      for (k in obj) {
        if (obj.hasOwnProperty(k)) {
          keys.push(k);
        }
      }
      queue.push({val: '}'});
      for (i = keys.length - 1; i >= 0; i--) {
        key = keys[i];
        value = obj[key];
        objPrefix = (i > 0 ? ',' : '');
        objPrefix += JSON.stringify(key) + ':';
        queue.push({obj: value, prefix: objPrefix});
      }
      queue.push({val: '{'});
    }
  }
  return res;
};

// Convenience function for the parse function.
// This pop function is basically copied from
// pouchCollate.parseIndexableString
function pop(obj, stack, metaStack) {
  var lastMetaElement = metaStack[metaStack.length - 1];
  if (obj === lastMetaElement.element) {
    // popping a meta-element, e.g. an object whose value is another object
    metaStack.pop();
    lastMetaElement = metaStack[metaStack.length - 1];
  }
  var element = lastMetaElement.element;
  var lastElementIndex = lastMetaElement.index;
  if (Array.isArray(element)) {
    element.push(obj);
  } else if (lastElementIndex === stack.length - 2) { // obj with key+value
    var key = stack.pop();
    element[key] = obj;
  } else {
    stack.push(obj); // obj with key only
  }
}

exports.parse = function (str) {
  var stack = [];
  var metaStack = []; // stack for arrays and objects
  var i = 0;
  var collationIndex,parsedNum,numChar;
  var parsedString,lastCh,numConsecutiveSlashes,ch;
  var arrayElement, objElement;
  while (true) {
    collationIndex = str[i++];
    if (collationIndex === '}' ||
        collationIndex === ']' ||
        typeof collationIndex === 'undefined') {
      if (stack.length === 1) {
        return stack.pop();
      } else {
        pop(stack.pop(), stack, metaStack);
        continue;
      }
    }
    switch (collationIndex) {
      case ' ':
      case '\t':
      case '\n':
      case ':':
      case ',':
        break;
      case 'n':
        i += 3; // 'ull'
        pop(null, stack, metaStack);
        break;
      case 't':
        i += 3; // 'rue'
        pop(true, stack, metaStack);
        break;
      case 'f':
        i += 4; // 'alse'
        pop(false, stack, metaStack);
        break;
      case '0':
      case '1':
      case '2':
      case '3':
      case '4':
      case '5':
      case '6':
      case '7':
      case '8':
      case '9':
      case '-':
        parsedNum = '';
        i--;
        while (true) {
          numChar = str[i++];
          if (/[\d\.\-e\+]/.test(numChar)) {
            parsedNum += numChar;
          } else {
            i--;
            break;
          }
        }
        pop(parseFloat(parsedNum), stack, metaStack);
        break;
      case '"':
        parsedString = '';
        lastCh = void 0;
        numConsecutiveSlashes = 0;
        while (true) {
          ch = str[i++];
          if (ch !== '"' || (lastCh === '\\' &&
              numConsecutiveSlashes % 2 === 1)) {
            parsedString += ch;
            lastCh = ch;
            if (lastCh === '\\') {
              numConsecutiveSlashes++;
            } else {
              numConsecutiveSlashes = 0;
            }
          } else {
            break;
          }
        }
        pop(JSON.parse('"' + parsedString + '"'), stack, metaStack);
        break;
      case '[':
        arrayElement = { element: [], index: stack.length };
        stack.push(arrayElement.element);
        metaStack.push(arrayElement);
        break;
      case '{':
        objElement = { element: {}, index: stack.length };
        stack.push(objElement.element);
        metaStack.push(objElement);
        break;
      default:
        throw new Error(
          'unexpectedly reached end of input: ' + collationIndex);
    }
  }
};

},{}]},{},[17])
(17)
});
}).call(this,typeof global !== "undefined" ? global : typeof self !== "undefined" ? self : typeof window !== "undefined" ? window : {})
},{}]},{},["./client/scripts/main.js"])
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIm5vZGVfbW9kdWxlcy9icm93c2VyaWZ5L25vZGVfbW9kdWxlcy9icm93c2VyLXBhY2svX3ByZWx1ZGUuanMiLCJjbGllbnQvc2NyaXB0cy9tYWluLmpzIiwiYm93ZXJfY29tcG9uZW50cy9hbmd1bGFyLWFuaW1hdGUvYW5ndWxhci1hbmltYXRlLm1pbi5qcyIsImJvd2VyX2NvbXBvbmVudHMvYW5ndWxhci1zYW5pdGl6ZS9hbmd1bGFyLXNhbml0aXplLm1pbi5qcyIsImJvd2VyX2NvbXBvbmVudHMvYW5ndWxhci11aS1yb3V0ZXIvcmVsZWFzZS9hbmd1bGFyLXVpLXJvdXRlci5taW4uanMiLCJib3dlcl9jb21wb25lbnRzL2FuZ3VsYXIvYW5ndWxhci5taW4uanMiLCJib3dlcl9jb21wb25lbnRzL2ZhbW91cy1hbmd1bGFyL2Rpc3QvZmFtb3VzLWFuZ3VsYXIubWluLmpzIiwiYm93ZXJfY29tcG9uZW50cy9mYW1vdXMvZGlzdC9mYW1vdXMtZ2xvYmFsLm1pbi5qcyIsImJvd2VyX2NvbXBvbmVudHMvaW9uaWMvcmVsZWFzZS9qcy9pb25pYy1hbmd1bGFyLm1pbi5qcyIsImJvd2VyX2NvbXBvbmVudHMvaW9uaWMvcmVsZWFzZS9qcy9pb25pYy5taW4uanMiLCJib3dlcl9jb21wb25lbnRzL25nc3RvcmFnZS9uZ1N0b3JhZ2UubWluLmpzIiwiY2xpZW50L3NjcmlwdHMvcGxheWVycy9jb250cm9sbGVycy9kYXNoYm9hcmQuanMiLCJjbGllbnQvc2NyaXB0cy9wbGF5ZXJzL2NvbnRyb2xsZXJzL2ZpbmRBY3Rpb24uanMiLCJjbGllbnQvc2NyaXB0cy9wbGF5ZXJzL2NvbnRyb2xsZXJzL2dhbWVzLmpzIiwiY2xpZW50L3NjcmlwdHMvcGxheWVycy9jb250cm9sbGVycy9pbmRleC5qcyIsImNsaWVudC9zY3JpcHRzL3BsYXllcnMvY29udHJvbGxlcnMvbG9naW4uanMiLCJjbGllbnQvc2NyaXB0cy9wbGF5ZXJzL2NvbnRyb2xsZXJzL3NldHRpbmdzLmpzIiwiY2xpZW50L3NjcmlwdHMvcGxheWVycy9pbmRleC5qcyIsImNsaWVudC9zY3JpcHRzL3BsYXllcnMvc2VydmljZXMvZ2FtZVNlcnZpY2VzLmpzIiwiY2xpZW50L3NjcmlwdHMvcGxheWVycy9zZXJ2aWNlcy9pbmRleC5qcyIsImNsaWVudC9zY3JpcHRzL3BsYXllcnMvc2VydmljZXMvdXNlclNlcnZpY2VzLmpzIiwiY2xpZW50L3NjcmlwdHMvcGxheWVycy92aWV3cy9kYXNoYm9hcmQuaHRtbCIsImNsaWVudC9zY3JpcHRzL3BsYXllcnMvdmlld3MvaG9tZS5odG1sIiwiY2xpZW50L3NjcmlwdHMvcGxheWVycy92aWV3cy9sb2dpbi5odG1sIiwibm9kZV9tb2R1bGVzL2FwcC9kYi5qcyIsIm5vZGVfbW9kdWxlcy9mYW1vdXMtcG9seWZpbGxzL2NsYXNzTGlzdC5qcyIsIm5vZGVfbW9kdWxlcy9mYW1vdXMtcG9seWZpbGxzL2Z1bmN0aW9uUHJvdG90eXBlQmluZC5qcyIsIm5vZGVfbW9kdWxlcy9mYW1vdXMtcG9seWZpbGxzL2luZGV4LmpzIiwibm9kZV9tb2R1bGVzL2ZhbW91cy1wb2x5ZmlsbHMvcmVxdWVzdEFuaW1hdGlvbkZyYW1lLmpzIiwibm9kZV9tb2R1bGVzL3BvdWNoZGIvZGlzdC9wb3VjaGRiLmpzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQUFBO0FDQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQ3ZCQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQzVCQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUNmQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQ2JBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDL05BO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDbkJBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQ2xCQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDN0JBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDaEJBOztBQ0FBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQzFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQy9CQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUNyQkE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUNWQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQzlDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQ25CQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUM3Q0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDdERBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDUEE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQy9GQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQ2hFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUNaQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQzFEQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDMUJBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQzFJQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDdkJBO0FBQ0E7QUFDQTs7QUNGQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQ2JBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSIsImZpbGUiOiJnZW5lcmF0ZWQuanMiLCJzb3VyY2VSb290IjoiIiwic291cmNlc0NvbnRlbnQiOlsiKGZ1bmN0aW9uIGUodCxuLHIpe2Z1bmN0aW9uIHMobyx1KXtpZighbltvXSl7aWYoIXRbb10pe3ZhciBhPXR5cGVvZiByZXF1aXJlPT1cImZ1bmN0aW9uXCImJnJlcXVpcmU7aWYoIXUmJmEpcmV0dXJuIGEobywhMCk7aWYoaSlyZXR1cm4gaShvLCEwKTt2YXIgZj1uZXcgRXJyb3IoXCJDYW5ub3QgZmluZCBtb2R1bGUgJ1wiK28rXCInXCIpO3Rocm93IGYuY29kZT1cIk1PRFVMRV9OT1RfRk9VTkRcIixmfXZhciBsPW5bb109e2V4cG9ydHM6e319O3Rbb11bMF0uY2FsbChsLmV4cG9ydHMsZnVuY3Rpb24oZSl7dmFyIG49dFtvXVsxXVtlXTtyZXR1cm4gcyhuP246ZSl9LGwsbC5leHBvcnRzLGUsdCxuLHIpfXJldHVybiBuW29dLmV4cG9ydHN9dmFyIGk9dHlwZW9mIHJlcXVpcmU9PVwiZnVuY3Rpb25cIiYmcmVxdWlyZTtmb3IodmFyIG89MDtvPHIubGVuZ3RoO28rKylzKHJbb10pO3JldHVybiBzfSkiLCIndXNlIHN0cmljdCc7XG5cbnZhciBuYW1lc3BhY2UgPSAnbWFpbic7XG5cbnZhciBhbmd1bGFyID0gcmVxdWlyZSgnYW5ndWxhcicpO1xuXG52YXIgYXBwID0gYW5ndWxhci5tb2R1bGUobmFtZXNwYWNlLCBbXG4gICAgJ3VpLnJvdXRlcicsXG4gICAgLy8gaW5qZWN0Om1vZHVsZXMgc3RhcnRcbiAgICByZXF1aXJlKCcuL3BsYXllcnMnKShuYW1lc3BhY2UpLm5hbWVcbiAgICAvLyBpbmplY3Q6bW9kdWxlcyBlbmRcbl0pO1xuXG5cbmFwcC5jb25maWcoWyckc3RhdGVQcm92aWRlcicsICckdXJsUm91dGVyUHJvdmlkZXInLCBmdW5jdGlvbigkc3RhdGVQcm92aWRlciwgJHVybFJvdXRlclByb3ZpZGVyKSB7XG4gICAgJHVybFJvdXRlclByb3ZpZGVyLm90aGVyd2lzZSgnLycpO1xuICAgICRzdGF0ZVByb3ZpZGVyLnN0YXRlKCdob21lJywge1xuICAgICAgICB1cmwgOiAnLycsXG4gICAgICAgIHRlbXBsYXRlOiByZXF1aXJlKCcuL3BsYXllcnMvdmlld3MvaG9tZS5odG1sJykgXG4gICB9KTtcbn1dKTtcblxubW9kdWxlLmV4cG9ydHMgPSBhcHA7XG4iLCIvKlxuIEFuZ3VsYXJKUyB2MS4yLjI2XG4gKGMpIDIwMTAtMjAxNCBHb29nbGUsIEluYy4gaHR0cDovL2FuZ3VsYXJqcy5vcmdcbiBMaWNlbnNlOiBNSVRcbiovXG4oZnVuY3Rpb24oRixlLE8peyd1c2Ugc3RyaWN0JztlLm1vZHVsZShcIm5nQW5pbWF0ZVwiLFtcIm5nXCJdKS5kaXJlY3RpdmUoXCJuZ0FuaW1hdGVDaGlsZHJlblwiLGZ1bmN0aW9uKCl7cmV0dXJuIGZ1bmN0aW9uKEcscyxnKXtnPWcubmdBbmltYXRlQ2hpbGRyZW47ZS5pc1N0cmluZyhnKSYmMD09PWcubGVuZ3RoP3MuZGF0YShcIiQkbmdBbmltYXRlQ2hpbGRyZW5cIiwhMCk6Ry4kd2F0Y2goZyxmdW5jdGlvbihlKXtzLmRhdGEoXCIkJG5nQW5pbWF0ZUNoaWxkcmVuXCIsISFlKX0pfX0pLmZhY3RvcnkoXCIkJGFuaW1hdGVSZWZsb3dcIixbXCIkJHJBRlwiLFwiJGRvY3VtZW50XCIsZnVuY3Rpb24oZSxzKXtyZXR1cm4gZnVuY3Rpb24oZyl7cmV0dXJuIGUoZnVuY3Rpb24oKXtnKCl9KX19XSkuY29uZmlnKFtcIiRwcm92aWRlXCIsXCIkYW5pbWF0ZVByb3ZpZGVyXCIsZnVuY3Rpb24oRyxzKXtmdW5jdGlvbiBnKGUpe2Zvcih2YXIgZz0wO2c8ZS5sZW5ndGg7ZysrKXt2YXIgbD1lW2ddO2lmKGwubm9kZVR5cGU9PWFhKXJldHVybiBsfX1cbmZ1bmN0aW9uIEIobCl7cmV0dXJuIGUuZWxlbWVudChnKGwpKX12YXIgbT1lLm5vb3AsdT1lLmZvckVhY2gsUD1zLiQkc2VsZWN0b3JzLGFhPTEsbD1cIiQkbmdBbmltYXRlU3RhdGVcIixWPVwiJCRuZ0FuaW1hdGVDaGlsZHJlblwiLEo9XCJuZy1hbmltYXRlXCIsbj17cnVubmluZzohMH07Ry5kZWNvcmF0b3IoXCIkYW5pbWF0ZVwiLFtcIiRkZWxlZ2F0ZVwiLFwiJGluamVjdG9yXCIsXCIkc25pZmZlclwiLFwiJHJvb3RFbGVtZW50XCIsXCIkJGFzeW5jQ2FsbGJhY2tcIixcIiRyb290U2NvcGVcIixcIiRkb2N1bWVudFwiLGZ1bmN0aW9uKHosRiwkLFIsRSxILE8pe2Z1bmN0aW9uIEsoYSl7dmFyIGI9YS5kYXRhKGwpfHx7fTtiLnJ1bm5pbmc9ITA7YS5kYXRhKGwsYil9ZnVuY3Rpb24gTChhKXtpZihhKXt2YXIgYj1bXSxjPXt9O2E9YS5zdWJzdHIoMSkuc3BsaXQoXCIuXCIpOygkLnRyYW5zaXRpb25zfHwkLmFuaW1hdGlvbnMpJiZiLnB1c2goRi5nZXQoUFtcIlwiXSkpO2Zvcih2YXIgZD0wO2Q8YS5sZW5ndGg7ZCsrKXt2YXIgZj1cbmFbZF0sZT1QW2ZdO2UmJiFjW2ZdJiYoYi5wdXNoKEYuZ2V0KGUpKSxjW2ZdPSEwKX1yZXR1cm4gYn19ZnVuY3Rpb24gRyhhLGIsYyl7ZnVuY3Rpb24gZChhLGIpe3ZhciBjPWFbYl0sZD1hW1wiYmVmb3JlXCIrYi5jaGFyQXQoMCkudG9VcHBlckNhc2UoKStiLnN1YnN0cigxKV07aWYoY3x8ZClyZXR1cm5cImxlYXZlXCI9PWImJihkPWMsYz1udWxsKSxuLnB1c2goe2V2ZW50OmIsZm46Y30pLGgucHVzaCh7ZXZlbnQ6YixmbjpkfSksITB9ZnVuY3Rpb24gZihiLGQsZSl7dmFyIGY9W107dShiLGZ1bmN0aW9uKGEpe2EuZm4mJmYucHVzaChhKX0pO3ZhciBnPTA7dShmLGZ1bmN0aW9uKGIsbCl7dmFyIEM9ZnVuY3Rpb24oKXthOntpZihkKXsoZFtsXXx8bSkoKTtpZigrK2c8Zi5sZW5ndGgpYnJlYWsgYTtkPW51bGx9ZSgpfX07c3dpdGNoKGIuZXZlbnQpe2Nhc2UgXCJzZXRDbGFzc1wiOmQucHVzaChiLmZuKGEsQSxrLEMpKTticmVhaztjYXNlIFwiYWRkQ2xhc3NcIjpkLnB1c2goYi5mbihhLEF8fGMsXG5DKSk7YnJlYWs7Y2FzZSBcInJlbW92ZUNsYXNzXCI6ZC5wdXNoKGIuZm4oYSxrfHxjLEMpKTticmVhaztkZWZhdWx0OmQucHVzaChiLmZuKGEsQykpfX0pO2QmJjA9PT1kLmxlbmd0aCYmZSgpfXZhciBnPWFbMF07aWYoZyl7dmFyIGw9XCJzZXRDbGFzc1wiPT1iLHA9bHx8XCJhZGRDbGFzc1wiPT1ifHxcInJlbW92ZUNsYXNzXCI9PWIsQSxrO2UuaXNBcnJheShjKSYmKEE9Y1swXSxrPWNbMV0sYz1BK1wiIFwiK2spO3ZhciB4PWEuYXR0cihcImNsYXNzXCIpK1wiIFwiK2M7aWYoTSh4KSl7dmFyIHQ9bSx3PVtdLGg9W10scT1tLHk9W10sbj1bXSx4PShcIiBcIit4KS5yZXBsYWNlKC9cXHMrL2csXCIuXCIpO3UoTCh4KSxmdW5jdGlvbihhKXshZChhLGIpJiZsJiYoZChhLFwiYWRkQ2xhc3NcIiksZChhLFwicmVtb3ZlQ2xhc3NcIikpfSk7cmV0dXJue25vZGU6ZyxldmVudDpiLGNsYXNzTmFtZTpjLGlzQ2xhc3NCYXNlZDpwLGlzU2V0Q2xhc3NPcGVyYXRpb246bCxiZWZvcmU6ZnVuY3Rpb24oYSl7dD1hO2YoaCx3LGZ1bmN0aW9uKCl7dD1cbm07YSgpfSl9LGFmdGVyOmZ1bmN0aW9uKGEpe3E9YTtmKG4seSxmdW5jdGlvbigpe3E9bTthKCl9KX0sY2FuY2VsOmZ1bmN0aW9uKCl7dyYmKHUodyxmdW5jdGlvbihhKXsoYXx8bSkoITApfSksdCghMCkpO3kmJih1KHksZnVuY3Rpb24oYSl7KGF8fG0pKCEwKX0pLHEoITApKX19fX19ZnVuY3Rpb24gcihhLGIsYyxkLGYsZyxuKXtmdW5jdGlvbiBwKGQpe3ZhciBlPVwiJGFuaW1hdGU6XCIrZDtxJiYocVtlXSYmMDxxW2VdLmxlbmd0aCkmJkUoZnVuY3Rpb24oKXtjLnRyaWdnZXJIYW5kbGVyKGUse2V2ZW50OmEsY2xhc3NOYW1lOmJ9KX0pfWZ1bmN0aW9uIEEoKXtwKFwiYmVmb3JlXCIpfWZ1bmN0aW9uIG0oKXtwKFwiYWZ0ZXJcIil9ZnVuY3Rpb24geCgpe3AoXCJjbG9zZVwiKTtuJiZFKGZ1bmN0aW9uKCl7bigpfSl9ZnVuY3Rpb24gdCgpe3QuaGFzQmVlblJ1bnx8KHQuaGFzQmVlblJ1bj0hMCxnKCkpfWZ1bmN0aW9uIHcoKXtpZighdy5oYXNCZWVuUnVuKXt3Lmhhc0JlZW5SdW49ITA7dmFyIGQ9XG5jLmRhdGEobCk7ZCYmKGgmJmguaXNDbGFzc0Jhc2VkP2soYyxiKTooRShmdW5jdGlvbigpe3ZhciBkPWMuZGF0YShsKXx8e307cj09ZC5pbmRleCYmayhjLGIsYSl9KSxjLmRhdGEobCxkKSkpO3goKX19dmFyIGg9RyhjLGEsYik7aWYoaCl7Yj1oLmNsYXNzTmFtZTt2YXIgcT1lLmVsZW1lbnQuX2RhdGEoaC5ub2RlKSxxPXEmJnEuZXZlbnRzO2R8fChkPWY/Zi5wYXJlbnQoKTpjLnBhcmVudCgpKTt2YXIgeT1jLmRhdGEobCl8fHt9O2Y9eS5hY3RpdmV8fHt9O3ZhciB6PXkudG90YWxBY3RpdmV8fDAsQz15Lmxhc3QsRDtoLmlzQ2xhc3NCYXNlZCYmKEQ9eS5ydW5uaW5nfHx5LmRpc2FibGVkfHxDJiYhQy5pc0NsYXNzQmFzZWQpO2lmKER8fE4oYyxkKSl0KCksQSgpLG0oKSx3KCk7ZWxzZXtkPSExO2lmKDA8eil7RD1bXTtpZihoLmlzQ2xhc3NCYXNlZClcInNldENsYXNzXCI9PUMuZXZlbnQ/KEQucHVzaChDKSxrKGMsYikpOmZbYl0mJih2PWZbYl0sdi5ldmVudD09YT9kPSEwOihELnB1c2godiksXG5rKGMsYikpKTtlbHNlIGlmKFwibGVhdmVcIj09YSYmZltcIm5nLWxlYXZlXCJdKWQ9ITA7ZWxzZXtmb3IodmFyIHYgaW4gZilELnB1c2goZlt2XSksayhjLHYpO2Y9e307ej0wfTA8RC5sZW5ndGgmJnUoRCxmdW5jdGlvbihhKXthLmNhbmNlbCgpfSl9IWguaXNDbGFzc0Jhc2VkfHwoaC5pc1NldENsYXNzT3BlcmF0aW9ufHxkKXx8KGQ9XCJhZGRDbGFzc1wiPT1hPT1jLmhhc0NsYXNzKGIpKTtpZihkKXQoKSxBKCksbSgpLHgoKTtlbHNle2lmKFwibGVhdmVcIj09YSljLm9uZShcIiRkZXN0cm95XCIsZnVuY3Rpb24oYSl7YT1lLmVsZW1lbnQodGhpcyk7dmFyIGI9YS5kYXRhKGwpO2ImJihiPWIuYWN0aXZlW1wibmctbGVhdmVcIl0pJiYoYi5jYW5jZWwoKSxrKGEsXCJuZy1sZWF2ZVwiKSl9KTtjLmFkZENsYXNzKEopO3ZhciByPVkrKzt6Kys7ZltiXT1oO2MuZGF0YShsLHtsYXN0OmgsYWN0aXZlOmYsaW5kZXg6cix0b3RhbEFjdGl2ZTp6fSk7QSgpO2guYmVmb3JlKGZ1bmN0aW9uKGQpe3ZhciBlPWMuZGF0YShsKTtcbmQ9ZHx8IWV8fCFlLmFjdGl2ZVtiXXx8aC5pc0NsYXNzQmFzZWQmJmUuYWN0aXZlW2JdLmV2ZW50IT1hO3QoKTshMD09PWQ/dygpOihtKCksaC5hZnRlcih3KSl9KX19fWVsc2UgdCgpLEEoKSxtKCksdygpfWZ1bmN0aW9uIFQoYSl7aWYoYT1nKGEpKWE9ZS5pc0Z1bmN0aW9uKGEuZ2V0RWxlbWVudHNCeUNsYXNzTmFtZSk/YS5nZXRFbGVtZW50c0J5Q2xhc3NOYW1lKEopOmEucXVlcnlTZWxlY3RvckFsbChcIi5cIitKKSx1KGEsZnVuY3Rpb24oYSl7YT1lLmVsZW1lbnQoYSk7KGE9YS5kYXRhKGwpKSYmYS5hY3RpdmUmJnUoYS5hY3RpdmUsZnVuY3Rpb24oYSl7YS5jYW5jZWwoKX0pfSl9ZnVuY3Rpb24gayhhLGIpe2lmKGcoYSk9PWcoUikpbi5kaXNhYmxlZHx8KG4ucnVubmluZz0hMSxuLnN0cnVjdHVyYWw9ITEpO2Vsc2UgaWYoYil7dmFyIGM9YS5kYXRhKGwpfHx7fSxkPSEwPT09YjshZCYmKGMuYWN0aXZlJiZjLmFjdGl2ZVtiXSkmJihjLnRvdGFsQWN0aXZlLS0sZGVsZXRlIGMuYWN0aXZlW2JdKTtcbmlmKGR8fCFjLnRvdGFsQWN0aXZlKWEucmVtb3ZlQ2xhc3MoSiksYS5yZW1vdmVEYXRhKGwpfX1mdW5jdGlvbiBOKGEsYil7aWYobi5kaXNhYmxlZClyZXR1cm4hMDtpZihnKGEpPT1nKFIpKXJldHVybiBuLnJ1bm5pbmc7dmFyIGMsZCxmO2Rve2lmKDA9PT1iLmxlbmd0aClicmVhazt2YXIgbT1nKGIpPT1nKFIpLGs9bT9uOmIuZGF0YShsKXx8e307aWYoay5kaXNhYmxlZClyZXR1cm4hMDttJiYoZj0hMCk7ITEhPT1jJiYobT1iLmRhdGEoViksZS5pc0RlZmluZWQobSkmJihjPW0pKTtkPWR8fGsucnVubmluZ3x8ay5sYXN0JiYhay5sYXN0LmlzQ2xhc3NCYXNlZH13aGlsZShiPWIucGFyZW50KCkpO3JldHVybiFmfHwhYyYmZH12YXIgWT0wO1IuZGF0YShsLG4pO0guJCRwb3N0RGlnZXN0KGZ1bmN0aW9uKCl7SC4kJHBvc3REaWdlc3QoZnVuY3Rpb24oKXtuLnJ1bm5pbmc9ITF9KX0pO3ZhciBRPXMuY2xhc3NOYW1lRmlsdGVyKCksTT1RP2Z1bmN0aW9uKGEpe3JldHVybiBRLnRlc3QoYSl9OlxuZnVuY3Rpb24oKXtyZXR1cm4hMH07cmV0dXJue2VudGVyOmZ1bmN0aW9uKGEsYixjLGQpe2E9ZS5lbGVtZW50KGEpO2I9YiYmZS5lbGVtZW50KGIpO2M9YyYmZS5lbGVtZW50KGMpO0soYSk7ei5lbnRlcihhLGIsYyk7SC4kJHBvc3REaWdlc3QoZnVuY3Rpb24oKXthPUIoYSk7cihcImVudGVyXCIsXCJuZy1lbnRlclwiLGEsYixjLG0sZCl9KX0sbGVhdmU6ZnVuY3Rpb24oYSxiKXthPWUuZWxlbWVudChhKTtUKGEpO0soYSk7SC4kJHBvc3REaWdlc3QoZnVuY3Rpb24oKXtyKFwibGVhdmVcIixcIm5nLWxlYXZlXCIsQihhKSxudWxsLG51bGwsZnVuY3Rpb24oKXt6LmxlYXZlKGEpfSxiKX0pfSxtb3ZlOmZ1bmN0aW9uKGEsYixjLGQpe2E9ZS5lbGVtZW50KGEpO2I9YiYmZS5lbGVtZW50KGIpO2M9YyYmZS5lbGVtZW50KGMpO1QoYSk7SyhhKTt6Lm1vdmUoYSxiLGMpO0guJCRwb3N0RGlnZXN0KGZ1bmN0aW9uKCl7YT1CKGEpO3IoXCJtb3ZlXCIsXCJuZy1tb3ZlXCIsYSxiLGMsbSxkKX0pfSxhZGRDbGFzczpmdW5jdGlvbihhLFxuYixjKXthPWUuZWxlbWVudChhKTthPUIoYSk7cihcImFkZENsYXNzXCIsYixhLG51bGwsbnVsbCxmdW5jdGlvbigpe3ouYWRkQ2xhc3MoYSxiKX0sYyl9LHJlbW92ZUNsYXNzOmZ1bmN0aW9uKGEsYixjKXthPWUuZWxlbWVudChhKTthPUIoYSk7cihcInJlbW92ZUNsYXNzXCIsYixhLG51bGwsbnVsbCxmdW5jdGlvbigpe3oucmVtb3ZlQ2xhc3MoYSxiKX0sYyl9LHNldENsYXNzOmZ1bmN0aW9uKGEsYixjLGQpe2E9ZS5lbGVtZW50KGEpO2E9QihhKTtyKFwic2V0Q2xhc3NcIixbYixjXSxhLG51bGwsbnVsbCxmdW5jdGlvbigpe3ouc2V0Q2xhc3MoYSxiLGMpfSxkKX0sZW5hYmxlZDpmdW5jdGlvbihhLGIpe3N3aXRjaChhcmd1bWVudHMubGVuZ3RoKXtjYXNlIDI6aWYoYSlrKGIpO2Vsc2V7dmFyIGM9Yi5kYXRhKGwpfHx7fTtjLmRpc2FibGVkPSEwO2IuZGF0YShsLGMpfWJyZWFrO2Nhc2UgMTpuLmRpc2FibGVkPSFhO2JyZWFrO2RlZmF1bHQ6YT0hbi5kaXNhYmxlZH1yZXR1cm4hIWF9fX1dKTtzLnJlZ2lzdGVyKFwiXCIsXG5bXCIkd2luZG93XCIsXCIkc25pZmZlclwiLFwiJHRpbWVvdXRcIixcIiQkYW5pbWF0ZVJlZmxvd1wiLGZ1bmN0aW9uKGwsbixzLEIpe2Z1bmN0aW9uIEUoYSxVKXtTJiZTKCk7Vy5wdXNoKFUpO1M9QihmdW5jdGlvbigpe3UoVyxmdW5jdGlvbihhKXthKCl9KTtXPVtdO1M9bnVsbDt2PXt9fSl9ZnVuY3Rpb24gSChhLFUpe3ZhciBiPWcoYSk7YT1lLmVsZW1lbnQoYik7Wi5wdXNoKGEpO2I9RGF0ZS5ub3coKStVO2I8PWRhfHwocy5jYW5jZWwoY2EpLGRhPWIsY2E9cyhmdW5jdGlvbigpe0coWik7Wj1bXX0sVSwhMSkpfWZ1bmN0aW9uIEcoYSl7dShhLGZ1bmN0aW9uKGEpeyhhPWEuZGF0YShxKSkmJihhLmNsb3NlQW5pbWF0aW9uRm58fG0pKCl9KX1mdW5jdGlvbiBLKGEsYil7dmFyIGM9Yj92W2JdOm51bGw7aWYoIWMpe3ZhciBkPTAsZT0wLGY9MCxnPTAsbSxrLGgscTt1KGEsZnVuY3Rpb24oYSl7aWYoYS5ub2RlVHlwZT09YWEpe2E9bC5nZXRDb21wdXRlZFN0eWxlKGEpfHx7fTtoPWFbSStQXTtkPVxuTWF0aC5tYXgoTChoKSxkKTtxPWFbSSt4XTttPWFbSSt0XTtlPU1hdGgubWF4KEwobSksZSk7az1hW3ArdF07Zz1NYXRoLm1heChMKGspLGcpO3ZhciBiPUwoYVtwK1BdKTswPGImJihiKj1wYXJzZUludChhW3Ard10sMTApfHwxKTtmPU1hdGgubWF4KGIsZil9fSk7Yz17dG90YWw6MCx0cmFuc2l0aW9uUHJvcGVydHlTdHlsZTpxLHRyYW5zaXRpb25EdXJhdGlvblN0eWxlOmgsdHJhbnNpdGlvbkRlbGF5U3R5bGU6bSx0cmFuc2l0aW9uRGVsYXk6ZSx0cmFuc2l0aW9uRHVyYXRpb246ZCxhbmltYXRpb25EZWxheVN0eWxlOmssYW5pbWF0aW9uRGVsYXk6ZyxhbmltYXRpb25EdXJhdGlvbjpmfTtiJiYodltiXT1jKX1yZXR1cm4gY31mdW5jdGlvbiBMKGEpe3ZhciBiPTA7YT1lLmlzU3RyaW5nKGEpP2Euc3BsaXQoL1xccyosXFxzKi8pOltdO3UoYSxmdW5jdGlvbihhKXtiPU1hdGgubWF4KHBhcnNlRmxvYXQoYSl8fDAsYil9KTtyZXR1cm4gYn1mdW5jdGlvbiBKKGEpe3ZhciBiPWEucGFyZW50KCksXG5jPWIuZGF0YShoKTtjfHwoYi5kYXRhKGgsKytiYSksYz1iYSk7cmV0dXJuIGMrXCItXCIrZyhhKS5nZXRBdHRyaWJ1dGUoXCJjbGFzc1wiKX1mdW5jdGlvbiByKGEsYixjLGQpe3ZhciBlPUooYiksZj1lK1wiIFwiK2MsbD12W2ZdPysrdltmXS50b3RhbDowLGs9e307aWYoMDxsKXt2YXIgaD1jK1wiLXN0YWdnZXJcIixrPWUrXCIgXCIraDsoZT0hdltrXSkmJmIuYWRkQ2xhc3MoaCk7az1LKGIsayk7ZSYmYi5yZW1vdmVDbGFzcyhoKX1kPWR8fGZ1bmN0aW9uKGEpe3JldHVybiBhKCl9O2IuYWRkQ2xhc3MoYyk7dmFyIGg9Yi5kYXRhKHEpfHx7fSxuPWQoZnVuY3Rpb24oKXtyZXR1cm4gSyhiLGYpfSk7ZD1uLnRyYW5zaXRpb25EdXJhdGlvbjtlPW4uYW5pbWF0aW9uRHVyYXRpb247aWYoMD09PWQmJjA9PT1lKXJldHVybiBiLnJlbW92ZUNsYXNzKGMpLCExO2IuZGF0YShxLHtydW5uaW5nOmgucnVubmluZ3x8MCxpdGVtSW5kZXg6bCxzdGFnZ2VyOmssdGltaW5nczpuLGNsb3NlQW5pbWF0aW9uRm46bX0pO1xuYT0wPGgucnVubmluZ3x8XCJzZXRDbGFzc1wiPT1hOzA8ZCYmVChiLGMsYSk7MDxlJiYoMDxrLmFuaW1hdGlvbkRlbGF5JiYwPT09ay5hbmltYXRpb25EdXJhdGlvbikmJihnKGIpLnN0eWxlW3BdPVwibm9uZSAwc1wiKTtyZXR1cm4hMH1mdW5jdGlvbiBUKGEsYixjKXtcIm5nLWVudGVyXCIhPWImJihcIm5nLW1vdmVcIiE9YiYmXCJuZy1sZWF2ZVwiIT1iKSYmYz9hLmFkZENsYXNzKHkpOmcoYSkuc3R5bGVbSSt4XT1cIm5vbmVcIn1mdW5jdGlvbiBrKGEsYil7dmFyIGM9SSt4LGQ9ZyhhKTtkLnN0eWxlW2NdJiYwPGQuc3R5bGVbY10ubGVuZ3RoJiYoZC5zdHlsZVtjXT1cIlwiKTthLnJlbW92ZUNsYXNzKHkpfWZ1bmN0aW9uIE4oYSl7dmFyIGI9cDthPWcoYSk7YS5zdHlsZVtiXSYmMDxhLnN0eWxlW2JdLmxlbmd0aCYmKGEuc3R5bGVbYl09XCJcIil9ZnVuY3Rpb24gWShhLGIsZCxlKXtmdW5jdGlvbiBrKGEpe2Iub2ZmKHgsbCk7Yi5yZW1vdmVDbGFzcyhtKTtjKGIsZCk7YT1nKGIpO2Zvcih2YXIgZSBpbiBzKWEuc3R5bGUucmVtb3ZlUHJvcGVydHkoc1tlXSl9XG5mdW5jdGlvbiBsKGEpe2Euc3RvcFByb3BhZ2F0aW9uKCk7dmFyIGI9YS5vcmlnaW5hbEV2ZW50fHxhO2E9Yi4kbWFudWFsVGltZVN0YW1wfHxiLnRpbWVTdGFtcHx8RGF0ZS5ub3coKTtiPXBhcnNlRmxvYXQoYi5lbGFwc2VkVGltZS50b0ZpeGVkKFYpKTtNYXRoLm1heChhLXosMCk+PXkmJmI+PXYmJmUoKX12YXIgaD1nKGIpO2E9Yi5kYXRhKHEpO2lmKC0xIT1oLmdldEF0dHJpYnV0ZShcImNsYXNzXCIpLmluZGV4T2YoZCkmJmEpe3ZhciBtPVwiXCI7dShkLnNwbGl0KFwiIFwiKSxmdW5jdGlvbihhLGIpe20rPSgwPGI/XCIgXCI6XCJcIikrYStcIi1hY3RpdmVcIn0pO3ZhciBuPWEuc3RhZ2dlcixwPWEudGltaW5ncyx0PWEuaXRlbUluZGV4LHY9TWF0aC5tYXgocC50cmFuc2l0aW9uRHVyYXRpb24scC5hbmltYXRpb25EdXJhdGlvbiksdz1NYXRoLm1heChwLnRyYW5zaXRpb25EZWxheSxwLmFuaW1hdGlvbkRlbGF5KSx5PXcqRCx6PURhdGUubm93KCkseD1BK1wiIFwiK1gscj1cIlwiLHM9W107aWYoMDxwLnRyYW5zaXRpb25EdXJhdGlvbil7dmFyIEI9XG5wLnRyYW5zaXRpb25Qcm9wZXJ0eVN0eWxlOy0xPT1CLmluZGV4T2YoXCJhbGxcIikmJihyKz1mK1widHJhbnNpdGlvbi1wcm9wZXJ0eTogXCIrQitcIjtcIixyKz1mK1widHJhbnNpdGlvbi1kdXJhdGlvbjogXCIrcC50cmFuc2l0aW9uRHVyYXRpb25TdHlsZStcIjtcIixzLnB1c2goZitcInRyYW5zaXRpb24tcHJvcGVydHlcIikscy5wdXNoKGYrXCJ0cmFuc2l0aW9uLWR1cmF0aW9uXCIpKX0wPHQmJigwPG4udHJhbnNpdGlvbkRlbGF5JiYwPT09bi50cmFuc2l0aW9uRHVyYXRpb24mJihyKz1mK1widHJhbnNpdGlvbi1kZWxheTogXCIrUShwLnRyYW5zaXRpb25EZWxheVN0eWxlLG4udHJhbnNpdGlvbkRlbGF5LHQpK1wiOyBcIixzLnB1c2goZitcInRyYW5zaXRpb24tZGVsYXlcIikpLDA8bi5hbmltYXRpb25EZWxheSYmMD09PW4uYW5pbWF0aW9uRHVyYXRpb24mJihyKz1mK1wiYW5pbWF0aW9uLWRlbGF5OiBcIitRKHAuYW5pbWF0aW9uRGVsYXlTdHlsZSxuLmFuaW1hdGlvbkRlbGF5LHQpK1wiOyBcIixzLnB1c2goZitcImFuaW1hdGlvbi1kZWxheVwiKSkpO1xuMDxzLmxlbmd0aCYmKHA9aC5nZXRBdHRyaWJ1dGUoXCJzdHlsZVwiKXx8XCJcIixoLnNldEF0dHJpYnV0ZShcInN0eWxlXCIscCtcIjsgXCIrcikpO2Iub24oeCxsKTtiLmFkZENsYXNzKG0pO2EuY2xvc2VBbmltYXRpb25Gbj1mdW5jdGlvbigpe2soKTtlKCl9O2g9KHQqKE1hdGgubWF4KG4uYW5pbWF0aW9uRGVsYXksbi50cmFuc2l0aW9uRGVsYXkpfHwwKSsodyt2KSpDKSpEO2EucnVubmluZysrO0goYixoKTtyZXR1cm4ga31lKCl9ZnVuY3Rpb24gUShhLGIsYyl7dmFyIGQ9XCJcIjt1KGEuc3BsaXQoXCIsXCIpLGZ1bmN0aW9uKGEsZSl7ZCs9KDA8ZT9cIixcIjpcIlwiKSsoYypiK3BhcnNlSW50KGEsMTApKStcInNcIn0pO3JldHVybiBkfWZ1bmN0aW9uIE0oYSxiLGQsZSl7aWYocihhLGIsZCxlKSlyZXR1cm4gZnVuY3Rpb24oYSl7YSYmYyhiLGQpfX1mdW5jdGlvbiBhKGEsYixkLGUpe2lmKGIuZGF0YShxKSlyZXR1cm4gWShhLGIsZCxlKTtjKGIsZCk7ZSgpfWZ1bmN0aW9uIGIoYixjLGQsZSl7dmFyIGY9TShiLFxuYyxkKTtpZihmKXt2YXIgZz1mO0UoYyxmdW5jdGlvbigpe2soYyxkKTtOKGMpO2c9YShiLGMsZCxlKX0pO3JldHVybiBmdW5jdGlvbihhKXsoZ3x8bSkoYSl9fWUoKX1mdW5jdGlvbiBjKGEsYil7YS5yZW1vdmVDbGFzcyhiKTt2YXIgYz1hLmRhdGEocSk7YyYmKGMucnVubmluZyYmYy5ydW5uaW5nLS0sYy5ydW5uaW5nJiYwIT09Yy5ydW5uaW5nfHxhLnJlbW92ZURhdGEocSkpfWZ1bmN0aW9uIGQoYSxiKXt2YXIgYz1cIlwiO2E9ZS5pc0FycmF5KGEpP2E6YS5zcGxpdCgvXFxzKy8pO3UoYSxmdW5jdGlvbihhLGQpe2EmJjA8YS5sZW5ndGgmJihjKz0oMDxkP1wiIFwiOlwiXCIpK2ErYil9KTtyZXR1cm4gY312YXIgZj1cIlwiLEksWCxwLEE7Ri5vbnRyYW5zaXRpb25lbmQ9PT1PJiZGLm9ud2Via2l0dHJhbnNpdGlvbmVuZCE9PU8/KGY9XCItd2Via2l0LVwiLEk9XCJXZWJraXRUcmFuc2l0aW9uXCIsWD1cIndlYmtpdFRyYW5zaXRpb25FbmQgdHJhbnNpdGlvbmVuZFwiKTooST1cInRyYW5zaXRpb25cIixYPVwidHJhbnNpdGlvbmVuZFwiKTtcbkYub25hbmltYXRpb25lbmQ9PT1PJiZGLm9ud2Via2l0YW5pbWF0aW9uZW5kIT09Tz8oZj1cIi13ZWJraXQtXCIscD1cIldlYmtpdEFuaW1hdGlvblwiLEE9XCJ3ZWJraXRBbmltYXRpb25FbmQgYW5pbWF0aW9uZW5kXCIpOihwPVwiYW5pbWF0aW9uXCIsQT1cImFuaW1hdGlvbmVuZFwiKTt2YXIgUD1cIkR1cmF0aW9uXCIseD1cIlByb3BlcnR5XCIsdD1cIkRlbGF5XCIsdz1cIkl0ZXJhdGlvbkNvdW50XCIsaD1cIiQkbmdBbmltYXRlS2V5XCIscT1cIiQkbmdBbmltYXRlQ1NTM0RhdGFcIix5PVwibmctYW5pbWF0ZS1ibG9jay10cmFuc2l0aW9uc1wiLFY9MyxDPTEuNSxEPTFFMyx2PXt9LGJhPTAsVz1bXSxTLGNhPW51bGwsZGE9MCxaPVtdO3JldHVybntlbnRlcjpmdW5jdGlvbihhLGMpe3JldHVybiBiKFwiZW50ZXJcIixhLFwibmctZW50ZXJcIixjKX0sbGVhdmU6ZnVuY3Rpb24oYSxjKXtyZXR1cm4gYihcImxlYXZlXCIsYSxcIm5nLWxlYXZlXCIsYyl9LG1vdmU6ZnVuY3Rpb24oYSxjKXtyZXR1cm4gYihcIm1vdmVcIixhLFwibmctbW92ZVwiLFxuYyl9LGJlZm9yZVNldENsYXNzOmZ1bmN0aW9uKGEsYixjLGUpe3ZhciBmPWQoYyxcIi1yZW1vdmVcIikrXCIgXCIrZChiLFwiLWFkZFwiKSxnPU0oXCJzZXRDbGFzc1wiLGEsZixmdW5jdGlvbihkKXt2YXIgZT1hLmF0dHIoXCJjbGFzc1wiKTthLnJlbW92ZUNsYXNzKGMpO2EuYWRkQ2xhc3MoYik7ZD1kKCk7YS5hdHRyKFwiY2xhc3NcIixlKTtyZXR1cm4gZH0pO2lmKGcpcmV0dXJuIEUoYSxmdW5jdGlvbigpe2soYSxmKTtOKGEpO2UoKX0pLGc7ZSgpfSxiZWZvcmVBZGRDbGFzczpmdW5jdGlvbihhLGIsYyl7dmFyIGU9TShcImFkZENsYXNzXCIsYSxkKGIsXCItYWRkXCIpLGZ1bmN0aW9uKGMpe2EuYWRkQ2xhc3MoYik7Yz1jKCk7YS5yZW1vdmVDbGFzcyhiKTtyZXR1cm4gY30pO2lmKGUpcmV0dXJuIEUoYSxmdW5jdGlvbigpe2soYSxiKTtOKGEpO2MoKX0pLGU7YygpfSxzZXRDbGFzczpmdW5jdGlvbihiLGMsZSxmKXtlPWQoZSxcIi1yZW1vdmVcIik7Yz1kKGMsXCItYWRkXCIpO3JldHVybiBhKFwic2V0Q2xhc3NcIixiLFxuZStcIiBcIitjLGYpfSxhZGRDbGFzczpmdW5jdGlvbihiLGMsZSl7cmV0dXJuIGEoXCJhZGRDbGFzc1wiLGIsZChjLFwiLWFkZFwiKSxlKX0sYmVmb3JlUmVtb3ZlQ2xhc3M6ZnVuY3Rpb24oYSxiLGMpe3ZhciBlPU0oXCJyZW1vdmVDbGFzc1wiLGEsZChiLFwiLXJlbW92ZVwiKSxmdW5jdGlvbihjKXt2YXIgZD1hLmF0dHIoXCJjbGFzc1wiKTthLnJlbW92ZUNsYXNzKGIpO2M9YygpO2EuYXR0cihcImNsYXNzXCIsZCk7cmV0dXJuIGN9KTtpZihlKXJldHVybiBFKGEsZnVuY3Rpb24oKXtrKGEsYik7TihhKTtjKCl9KSxlO2MoKX0scmVtb3ZlQ2xhc3M6ZnVuY3Rpb24oYixjLGUpe3JldHVybiBhKFwicmVtb3ZlQ2xhc3NcIixiLGQoYyxcIi1yZW1vdmVcIiksZSl9fX1dKX1dKX0pKHdpbmRvdyx3aW5kb3cuYW5ndWxhcik7XG4vLyMgc291cmNlTWFwcGluZ1VSTD1hbmd1bGFyLWFuaW1hdGUubWluLmpzLm1hcFxuIiwiLypcbiBBbmd1bGFySlMgdjEuMi4yNlxuIChjKSAyMDEwLTIwMTQgR29vZ2xlLCBJbmMuIGh0dHA6Ly9hbmd1bGFyanMub3JnXG4gTGljZW5zZTogTUlUXG4qL1xuKGZ1bmN0aW9uKHEsZyxyKXsndXNlIHN0cmljdCc7ZnVuY3Rpb24gRihhKXt2YXIgZD1bXTt0KGQsZy5ub29wKS5jaGFycyhhKTtyZXR1cm4gZC5qb2luKFwiXCIpfWZ1bmN0aW9uIG0oYSl7dmFyIGQ9e307YT1hLnNwbGl0KFwiLFwiKTt2YXIgYztmb3IoYz0wO2M8YS5sZW5ndGg7YysrKWRbYVtjXV09ITA7cmV0dXJuIGR9ZnVuY3Rpb24gRyhhLGQpe2Z1bmN0aW9uIGMoYSxiLGMsaCl7Yj1nLmxvd2VyY2FzZShiKTtpZih1W2JdKWZvcig7Zi5sYXN0KCkmJnZbZi5sYXN0KCldOyllKFwiXCIsZi5sYXN0KCkpO3dbYl0mJmYubGFzdCgpPT1iJiZlKFwiXCIsYik7KGg9eFtiXXx8ISFoKXx8Zi5wdXNoKGIpO3ZhciBuPXt9O2MucmVwbGFjZShILGZ1bmN0aW9uKGEsYixkLGMsZSl7bltiXT1zKGR8fGN8fGV8fFwiXCIpfSk7ZC5zdGFydCYmZC5zdGFydChiLG4saCl9ZnVuY3Rpb24gZShhLGIpe3ZhciBjPTAsZTtpZihiPWcubG93ZXJjYXNlKGIpKWZvcihjPWYubGVuZ3RoLTE7MDw9YyYmZltjXSE9YjtjLS0pO1xuaWYoMDw9Yyl7Zm9yKGU9Zi5sZW5ndGgtMTtlPj1jO2UtLSlkLmVuZCYmZC5lbmQoZltlXSk7Zi5sZW5ndGg9Y319XCJzdHJpbmdcIiE9PXR5cGVvZiBhJiYoYT1udWxsPT09YXx8XCJ1bmRlZmluZWRcIj09PXR5cGVvZiBhP1wiXCI6XCJcIithKTt2YXIgYixsLGY9W10sbj1hLGg7Zm9yKGYubGFzdD1mdW5jdGlvbigpe3JldHVybiBmW2YubGVuZ3RoLTFdfTthOyl7aD1cIlwiO2w9ITA7aWYoZi5sYXN0KCkmJnlbZi5sYXN0KCldKWE9YS5yZXBsYWNlKFJlZ0V4cChcIiguKik8XFxcXHMqXFxcXC9cXFxccypcIitmLmxhc3QoKStcIltePl0qPlwiLFwiaVwiKSxmdW5jdGlvbihhLGIpe2I9Yi5yZXBsYWNlKEksXCIkMVwiKS5yZXBsYWNlKEosXCIkMVwiKTtkLmNoYXJzJiZkLmNoYXJzKHMoYikpO3JldHVyblwiXCJ9KSxlKFwiXCIsZi5sYXN0KCkpO2Vsc2V7aWYoMD09PWEuaW5kZXhPZihcIlxceDNjIS0tXCIpKWI9YS5pbmRleE9mKFwiLS1cIiw0KSwwPD1iJiZhLmxhc3RJbmRleE9mKFwiLS1cXHgzZVwiLGIpPT09YiYmKGQuY29tbWVudCYmZC5jb21tZW50KGEuc3Vic3RyaW5nKDQsXG5iKSksYT1hLnN1YnN0cmluZyhiKzMpLGw9ITEpO2Vsc2UgaWYoei50ZXN0KGEpKXtpZihiPWEubWF0Y2goeikpYT1hLnJlcGxhY2UoYlswXSxcIlwiKSxsPSExfWVsc2UgaWYoSy50ZXN0KGEpKXtpZihiPWEubWF0Y2goQSkpYT1hLnN1YnN0cmluZyhiWzBdLmxlbmd0aCksYlswXS5yZXBsYWNlKEEsZSksbD0hMX1lbHNlIEwudGVzdChhKSYmKChiPWEubWF0Y2goQikpPyhiWzRdJiYoYT1hLnN1YnN0cmluZyhiWzBdLmxlbmd0aCksYlswXS5yZXBsYWNlKEIsYykpLGw9ITEpOihoKz1cIjxcIixhPWEuc3Vic3RyaW5nKDEpKSk7bCYmKGI9YS5pbmRleE9mKFwiPFwiKSxoKz0wPmI/YTphLnN1YnN0cmluZygwLGIpLGE9MD5iP1wiXCI6YS5zdWJzdHJpbmcoYiksZC5jaGFycyYmZC5jaGFycyhzKGgpKSl9aWYoYT09bil0aHJvdyBNKFwiYmFkcGFyc2VcIixhKTtuPWF9ZSgpfWZ1bmN0aW9uIHMoYSl7aWYoIWEpcmV0dXJuXCJcIjt2YXIgZD1OLmV4ZWMoYSk7YT1kWzFdO3ZhciBjPWRbM107aWYoZD1kWzJdKXAuaW5uZXJIVE1MPVxuZC5yZXBsYWNlKC88L2csXCImbHQ7XCIpLGQ9XCJ0ZXh0Q29udGVudFwiaW4gcD9wLnRleHRDb250ZW50OnAuaW5uZXJUZXh0O3JldHVybiBhK2QrY31mdW5jdGlvbiBDKGEpe3JldHVybiBhLnJlcGxhY2UoLyYvZyxcIiZhbXA7XCIpLnJlcGxhY2UoTyxmdW5jdGlvbihhKXt2YXIgYz1hLmNoYXJDb2RlQXQoMCk7YT1hLmNoYXJDb2RlQXQoMSk7cmV0dXJuXCImI1wiKygxMDI0KihjLTU1Mjk2KSsoYS01NjMyMCkrNjU1MzYpK1wiO1wifSkucmVwbGFjZShQLGZ1bmN0aW9uKGEpe3JldHVyblwiJiNcIithLmNoYXJDb2RlQXQoMCkrXCI7XCJ9KS5yZXBsYWNlKC88L2csXCImbHQ7XCIpLnJlcGxhY2UoLz4vZyxcIiZndDtcIil9ZnVuY3Rpb24gdChhLGQpe3ZhciBjPSExLGU9Zy5iaW5kKGEsYS5wdXNoKTtyZXR1cm57c3RhcnQ6ZnVuY3Rpb24oYSxsLGYpe2E9Zy5sb3dlcmNhc2UoYSk7IWMmJnlbYV0mJihjPWEpO2N8fCEwIT09RFthXXx8KGUoXCI8XCIpLGUoYSksZy5mb3JFYWNoKGwsZnVuY3Rpb24oYyxmKXt2YXIgaz1cbmcubG93ZXJjYXNlKGYpLGw9XCJpbWdcIj09PWEmJlwic3JjXCI9PT1rfHxcImJhY2tncm91bmRcIj09PWs7ITAhPT1RW2tdfHwhMD09PUVba10mJiFkKGMsbCl8fChlKFwiIFwiKSxlKGYpLGUoJz1cIicpLGUoQyhjKSksZSgnXCInKSl9KSxlKGY/XCIvPlwiOlwiPlwiKSl9LGVuZDpmdW5jdGlvbihhKXthPWcubG93ZXJjYXNlKGEpO2N8fCEwIT09RFthXXx8KGUoXCI8L1wiKSxlKGEpLGUoXCI+XCIpKTthPT1jJiYoYz0hMSl9LGNoYXJzOmZ1bmN0aW9uKGEpe2N8fGUoQyhhKSl9fX12YXIgTT1nLiQkbWluRXJyKFwiJHNhbml0aXplXCIpLEI9L148KCg/OlthLXpBLVpdKVtcXHc6LV0qKSgoPzpcXHMrW1xcdzotXSsoPzpcXHMqPVxccyooPzooPzpcIlteXCJdKlwiKXwoPzonW14nXSonKXxbXj5cXHNdKykpPykqKVxccyooXFwvPylcXHMqKD4/KS8sQT0vXjxcXC9cXHMqKFtcXHc6LV0rKVtePl0qPi8sSD0vKFtcXHc6LV0rKSg/Olxccyo9XFxzKig/Oig/OlwiKCg/OlteXCJdKSopXCIpfCg/OicoKD86W14nXSkqKScpfChbXj5cXHNdKykpKT8vZyxMPS9ePC8sXG5LPS9ePFxcLy8sST0vXFx4M2MhLS0oLio/KS0tXFx4M2UvZyx6PS88IURPQ1RZUEUoW14+XSo/KT4vaSxKPS88IVxcW0NEQVRBXFxbKC4qPyldXVxceDNlL2csTz0vW1xcdUQ4MDAtXFx1REJGRl1bXFx1REMwMC1cXHVERkZGXS9nLFA9LyhbXlxcIy1+fCB8IV0pL2cseD1tKFwiYXJlYSxicixjb2wsaHIsaW1nLHdiclwiKTtxPW0oXCJjb2xncm91cCxkZCxkdCxsaSxwLHRib2R5LHRkLHRmb290LHRoLHRoZWFkLHRyXCIpO3I9bShcInJwLHJ0XCIpO3ZhciB3PWcuZXh0ZW5kKHt9LHIscSksdT1nLmV4dGVuZCh7fSxxLG0oXCJhZGRyZXNzLGFydGljbGUsYXNpZGUsYmxvY2txdW90ZSxjYXB0aW9uLGNlbnRlcixkZWwsZGlyLGRpdixkbCxmaWd1cmUsZmlnY2FwdGlvbixmb290ZXIsaDEsaDIsaDMsaDQsaDUsaDYsaGVhZGVyLGhncm91cCxocixpbnMsbWFwLG1lbnUsbmF2LG9sLHByZSxzY3JpcHQsc2VjdGlvbix0YWJsZSx1bFwiKSksdj1nLmV4dGVuZCh7fSxyLG0oXCJhLGFiYnIsYWNyb255bSxiLGJkaSxiZG8sYmlnLGJyLGNpdGUsY29kZSxkZWwsZGZuLGVtLGZvbnQsaSxpbWcsaW5zLGtiZCxsYWJlbCxtYXAsbWFyayxxLHJ1YnkscnAscnQscyxzYW1wLHNtYWxsLHNwYW4sc3RyaWtlLHN0cm9uZyxzdWIsc3VwLHRpbWUsdHQsdSx2YXJcIikpLFxueT1tKFwic2NyaXB0LHN0eWxlXCIpLEQ9Zy5leHRlbmQoe30seCx1LHYsdyksRT1tKFwiYmFja2dyb3VuZCxjaXRlLGhyZWYsbG9uZ2Rlc2Msc3JjLHVzZW1hcFwiKSxRPWcuZXh0ZW5kKHt9LEUsbShcImFiYnIsYWxpZ24sYWx0LGF4aXMsYmdjb2xvcixib3JkZXIsY2VsbHBhZGRpbmcsY2VsbHNwYWNpbmcsY2xhc3MsY2xlYXIsY29sb3IsY29scyxjb2xzcGFuLGNvbXBhY3QsY29vcmRzLGRpcixmYWNlLGhlYWRlcnMsaGVpZ2h0LGhyZWZsYW5nLGhzcGFjZSxpc21hcCxsYW5nLGxhbmd1YWdlLG5vaHJlZixub3dyYXAscmVsLHJldixyb3dzLHJvd3NwYW4scnVsZXMsc2NvcGUsc2Nyb2xsaW5nLHNoYXBlLHNpemUsc3BhbixzdGFydCxzdW1tYXJ5LHRhcmdldCx0aXRsZSx0eXBlLHZhbGlnbix2YWx1ZSx2c3BhY2Usd2lkdGhcIikpLHA9ZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcInByZVwiKSxOPS9eKFxccyopKFtcXHNcXFNdKj8pKFxccyopJC87Zy5tb2R1bGUoXCJuZ1Nhbml0aXplXCIsW10pLnByb3ZpZGVyKFwiJHNhbml0aXplXCIsXG5mdW5jdGlvbigpe3RoaXMuJGdldD1bXCIkJHNhbml0aXplVXJpXCIsZnVuY3Rpb24oYSl7cmV0dXJuIGZ1bmN0aW9uKGQpe3ZhciBjPVtdO0coZCx0KGMsZnVuY3Rpb24oYyxiKXtyZXR1cm4hL151bnNhZmUvLnRlc3QoYShjLGIpKX0pKTtyZXR1cm4gYy5qb2luKFwiXCIpfX1dfSk7Zy5tb2R1bGUoXCJuZ1Nhbml0aXplXCIpLmZpbHRlcihcImxpbmt5XCIsW1wiJHNhbml0aXplXCIsZnVuY3Rpb24oYSl7dmFyIGQ9LygoZnRwfGh0dHBzPyk6XFwvXFwvfChtYWlsdG86KT9bQS1aYS16MC05Ll8lKy1dK0ApXFxTKlteXFxzLjssKCl7fTw+XCJdLyxjPS9ebWFpbHRvOi87cmV0dXJuIGZ1bmN0aW9uKGUsYil7ZnVuY3Rpb24gbChhKXthJiZrLnB1c2goRihhKSl9ZnVuY3Rpb24gZihhLGMpe2sucHVzaChcIjxhIFwiKTtnLmlzRGVmaW5lZChiKSYmKGsucHVzaCgndGFyZ2V0PVwiJyksay5wdXNoKGIpLGsucHVzaCgnXCIgJykpO2sucHVzaCgnaHJlZj1cIicpO2sucHVzaChhKTtrLnB1c2goJ1wiPicpO2woYyk7ay5wdXNoKFwiPC9hPlwiKX1cbmlmKCFlKXJldHVybiBlO2Zvcih2YXIgbixoPWUsaz1bXSxtLHA7bj1oLm1hdGNoKGQpOyltPW5bMF0sblsyXT09blszXSYmKG09XCJtYWlsdG86XCIrbSkscD1uLmluZGV4LGwoaC5zdWJzdHIoMCxwKSksZihtLG5bMF0ucmVwbGFjZShjLFwiXCIpKSxoPWguc3Vic3RyaW5nKHArblswXS5sZW5ndGgpO2woaCk7cmV0dXJuIGEoay5qb2luKFwiXCIpKX19XSl9KSh3aW5kb3csd2luZG93LmFuZ3VsYXIpO1xuLy8jIHNvdXJjZU1hcHBpbmdVUkw9YW5ndWxhci1zYW5pdGl6ZS5taW4uanMubWFwXG4iLCIoZnVuY3Rpb24gKGdsb2JhbCl7XG5cbjsgcmVxdWlyZShcIi9ob21lL3VidW50dS93b3Jrc3BhY2UvYm93ZXJfY29tcG9uZW50cy9hbmd1bGFyL2FuZ3VsYXIubWluLmpzXCIpO1xuO19fYnJvd3NlcmlmeV9zaGltX3JlcXVpcmVfXz1yZXF1aXJlOyhmdW5jdGlvbiBicm93c2VyaWZ5U2hpbShtb2R1bGUsIGRlZmluZSwgcmVxdWlyZSkge1xuLyoqXG4gKiBTdGF0ZS1iYXNlZCByb3V0aW5nIGZvciBBbmd1bGFySlNcbiAqIEB2ZXJzaW9uIHYwLjIuMTBcbiAqIEBsaW5rIGh0dHA6Ly9hbmd1bGFyLXVpLmdpdGh1Yi5jb20vXG4gKiBAbGljZW5zZSBNSVQgTGljZW5zZSwgaHR0cDovL3d3dy5vcGVuc291cmNlLm9yZy9saWNlbnNlcy9NSVRcbiAqL1xuXCJ1bmRlZmluZWRcIiE9dHlwZW9mIG1vZHVsZSYmXCJ1bmRlZmluZWRcIiE9dHlwZW9mIGV4cG9ydHMmJm1vZHVsZS5leHBvcnRzPT09ZXhwb3J0cyYmKG1vZHVsZS5leHBvcnRzPVwidWkucm91dGVyXCIpLGZ1bmN0aW9uKGEsYixjKXtcInVzZSBzdHJpY3RcIjtmdW5jdGlvbiBkKGEsYil7cmV0dXJuIEkobmV3KEkoZnVuY3Rpb24oKXt9LHtwcm90b3R5cGU6YX0pKSxiKX1mdW5jdGlvbiBlKGEpe3JldHVybiBIKGFyZ3VtZW50cyxmdW5jdGlvbihiKXtiIT09YSYmSChiLGZ1bmN0aW9uKGIsYyl7YS5oYXNPd25Qcm9wZXJ0eShjKXx8KGFbY109Yil9KX0pLGF9ZnVuY3Rpb24gZihhLGIpe3ZhciBjPVtdO2Zvcih2YXIgZCBpbiBhLnBhdGgpe2lmKGEucGF0aFtkXSE9PWIucGF0aFtkXSlicmVhaztjLnB1c2goYS5wYXRoW2RdKX1yZXR1cm4gY31mdW5jdGlvbiBnKGEsYil7aWYoQXJyYXkucHJvdG90eXBlLmluZGV4T2YpcmV0dXJuIGEuaW5kZXhPZihiLE51bWJlcihhcmd1bWVudHNbMl0pfHwwKTt2YXIgYz1hLmxlbmd0aD4+PjAsZD1OdW1iZXIoYXJndW1lbnRzWzJdKXx8MDtmb3IoZD0wPmQ/TWF0aC5jZWlsKGQpOk1hdGguZmxvb3IoZCksMD5kJiYoZCs9Yyk7Yz5kO2QrKylpZihkIGluIGEmJmFbZF09PT1iKXJldHVybiBkO3JldHVybi0xfWZ1bmN0aW9uIGgoYSxiLGMsZCl7dmFyIGUsaD1mKGMsZCksaT17fSxqPVtdO2Zvcih2YXIgayBpbiBoKWlmKGhba10ucGFyYW1zJiZoW2tdLnBhcmFtcy5sZW5ndGgpe2U9aFtrXS5wYXJhbXM7Zm9yKHZhciBsIGluIGUpZyhqLGVbbF0pPj0wfHwoai5wdXNoKGVbbF0pLGlbZVtsXV09YVtlW2xdXSl9cmV0dXJuIEkoe30saSxiKX1mdW5jdGlvbiBpKGEsYil7dmFyIGM9e307cmV0dXJuIEgoYSxmdW5jdGlvbihhKXt2YXIgZD1iW2FdO2NbYV09bnVsbCE9ZD9TdHJpbmcoZCk6bnVsbH0pLGN9ZnVuY3Rpb24gaihhLGIsYyl7aWYoIWMpe2M9W107Zm9yKHZhciBkIGluIGEpYy5wdXNoKGQpfWZvcih2YXIgZT0wO2U8Yy5sZW5ndGg7ZSsrKXt2YXIgZj1jW2VdO2lmKGFbZl0hPWJbZl0pcmV0dXJuITF9cmV0dXJuITB9ZnVuY3Rpb24gayhhLGIpe3ZhciBjPXt9O3JldHVybiBIKGEsZnVuY3Rpb24oYSl7Y1thXT1iW2FdfSksY31mdW5jdGlvbiBsKGEsYil7dmFyIGQ9MSxmPTIsZz17fSxoPVtdLGk9ZyxqPUkoYS53aGVuKGcpLHskJHByb21pc2VzOmcsJCR2YWx1ZXM6Z30pO3RoaXMuc3R1ZHk9ZnVuY3Rpb24oZyl7ZnVuY3Rpb24gayhhLGMpe2lmKG9bY10hPT1mKXtpZihuLnB1c2goYyksb1tjXT09PWQpdGhyb3cgbi5zcGxpY2UoMCxuLmluZGV4T2YoYykpLG5ldyBFcnJvcihcIkN5Y2xpYyBkZXBlbmRlbmN5OiBcIituLmpvaW4oXCIgLT4gXCIpKTtpZihvW2NdPWQsRShhKSltLnB1c2goYyxbZnVuY3Rpb24oKXtyZXR1cm4gYi5nZXQoYSl9XSxoKTtlbHNle3ZhciBlPWIuYW5ub3RhdGUoYSk7SChlLGZ1bmN0aW9uKGEpe2EhPT1jJiZnLmhhc093blByb3BlcnR5KGEpJiZrKGdbYV0sYSl9KSxtLnB1c2goYyxhLGUpfW4ucG9wKCksb1tjXT1mfX1mdW5jdGlvbiBsKGEpe3JldHVybiBGKGEpJiZhLnRoZW4mJmEuJCRwcm9taXNlc31pZighRihnKSl0aHJvdyBuZXcgRXJyb3IoXCInaW52b2NhYmxlcycgbXVzdCBiZSBhbiBvYmplY3RcIik7dmFyIG09W10sbj1bXSxvPXt9O3JldHVybiBIKGcsayksZz1uPW89bnVsbCxmdW5jdGlvbihkLGYsZyl7ZnVuY3Rpb24gaCgpey0tc3x8KHR8fGUocixmLiQkdmFsdWVzKSxwLiQkdmFsdWVzPXIscC4kJHByb21pc2VzPSEwLG8ucmVzb2x2ZShyKSl9ZnVuY3Rpb24gayhhKXtwLiQkZmFpbHVyZT1hLG8ucmVqZWN0KGEpfWZ1bmN0aW9uIG4oYyxlLGYpe2Z1bmN0aW9uIGkoYSl7bC5yZWplY3QoYSksayhhKX1mdW5jdGlvbiBqKCl7aWYoIUMocC4kJGZhaWx1cmUpKXRyeXtsLnJlc29sdmUoYi5pbnZva2UoZSxnLHIpKSxsLnByb21pc2UudGhlbihmdW5jdGlvbihhKXtyW2NdPWEsaCgpfSxpKX1jYXRjaChhKXtpKGEpfX12YXIgbD1hLmRlZmVyKCksbT0wO0goZixmdW5jdGlvbihhKXtxLmhhc093blByb3BlcnR5KGEpJiYhZC5oYXNPd25Qcm9wZXJ0eShhKSYmKG0rKyxxW2FdLnRoZW4oZnVuY3Rpb24oYil7clthXT1iLC0tbXx8aigpfSxpKSl9KSxtfHxqKCkscVtjXT1sLnByb21pc2V9aWYobChkKSYmZz09PWMmJihnPWYsZj1kLGQ9bnVsbCksZCl7aWYoIUYoZCkpdGhyb3cgbmV3IEVycm9yKFwiJ2xvY2FscycgbXVzdCBiZSBhbiBvYmplY3RcIil9ZWxzZSBkPWk7aWYoZil7aWYoIWwoZikpdGhyb3cgbmV3IEVycm9yKFwiJ3BhcmVudCcgbXVzdCBiZSBhIHByb21pc2UgcmV0dXJuZWQgYnkgJHJlc29sdmUucmVzb2x2ZSgpXCIpfWVsc2UgZj1qO3ZhciBvPWEuZGVmZXIoKSxwPW8ucHJvbWlzZSxxPXAuJCRwcm9taXNlcz17fSxyPUkoe30sZCkscz0xK20ubGVuZ3RoLzMsdD0hMTtpZihDKGYuJCRmYWlsdXJlKSlyZXR1cm4gayhmLiQkZmFpbHVyZSkscDtmLiQkdmFsdWVzPyh0PWUocixmLiQkdmFsdWVzKSxoKCkpOihJKHEsZi4kJHByb21pc2VzKSxmLnRoZW4oaCxrKSk7Zm9yKHZhciB1PTAsdj1tLmxlbmd0aDt2PnU7dSs9MylkLmhhc093blByb3BlcnR5KG1bdV0pP2goKTpuKG1bdV0sbVt1KzFdLG1bdSsyXSk7cmV0dXJuIHB9fSx0aGlzLnJlc29sdmU9ZnVuY3Rpb24oYSxiLGMsZCl7cmV0dXJuIHRoaXMuc3R1ZHkoYSkoYixjLGQpfX1mdW5jdGlvbiBtKGEsYixjKXt0aGlzLmZyb21Db25maWc9ZnVuY3Rpb24oYSxiLGMpe3JldHVybiBDKGEudGVtcGxhdGUpP3RoaXMuZnJvbVN0cmluZyhhLnRlbXBsYXRlLGIpOkMoYS50ZW1wbGF0ZVVybCk/dGhpcy5mcm9tVXJsKGEudGVtcGxhdGVVcmwsYik6QyhhLnRlbXBsYXRlUHJvdmlkZXIpP3RoaXMuZnJvbVByb3ZpZGVyKGEudGVtcGxhdGVQcm92aWRlcixiLGMpOm51bGx9LHRoaXMuZnJvbVN0cmluZz1mdW5jdGlvbihhLGIpe3JldHVybiBEKGEpP2EoYik6YX0sdGhpcy5mcm9tVXJsPWZ1bmN0aW9uKGMsZCl7cmV0dXJuIEQoYykmJihjPWMoZCkpLG51bGw9PWM/bnVsbDphLmdldChjLHtjYWNoZTpifSkudGhlbihmdW5jdGlvbihhKXtyZXR1cm4gYS5kYXRhfSl9LHRoaXMuZnJvbVByb3ZpZGVyPWZ1bmN0aW9uKGEsYixkKXtyZXR1cm4gYy5pbnZva2UoYSxudWxsLGR8fHtwYXJhbXM6Yn0pfX1mdW5jdGlvbiBuKGEpe2Z1bmN0aW9uIGIoYil7aWYoIS9eXFx3KygtK1xcdyspKiQvLnRlc3QoYikpdGhyb3cgbmV3IEVycm9yKFwiSW52YWxpZCBwYXJhbWV0ZXIgbmFtZSAnXCIrYitcIicgaW4gcGF0dGVybiAnXCIrYStcIidcIik7aWYoZltiXSl0aHJvdyBuZXcgRXJyb3IoXCJEdXBsaWNhdGUgcGFyYW1ldGVyIG5hbWUgJ1wiK2IrXCInIGluIHBhdHRlcm4gJ1wiK2ErXCInXCIpO2ZbYl09ITAsai5wdXNoKGIpfWZ1bmN0aW9uIGMoYSl7cmV0dXJuIGEucmVwbGFjZSgvW1xcXFxcXFtcXF1cXF4kKis/LigpfHt9XS9nLFwiXFxcXCQmXCIpfXZhciBkLGU9LyhbOipdKShcXHcrKXxcXHsoXFx3KykoPzpcXDooKD86W157fVxcXFxdK3xcXFxcLnxcXHsoPzpbXnt9XFxcXF0rfFxcXFwuKSpcXH0pKykpP1xcfS9nLGY9e30sZz1cIl5cIixoPTAsaT10aGlzLnNlZ21lbnRzPVtdLGo9dGhpcy5wYXJhbXM9W107dGhpcy5zb3VyY2U9YTtmb3IodmFyIGssbCxtOyhkPWUuZXhlYyhhKSkmJihrPWRbMl18fGRbM10sbD1kWzRdfHwoXCIqXCI9PWRbMV0/XCIuKlwiOlwiW14vXSpcIiksbT1hLnN1YnN0cmluZyhoLGQuaW5kZXgpLCEobS5pbmRleE9mKFwiP1wiKT49MCkpOylnKz1jKG0pK1wiKFwiK2wrXCIpXCIsYihrKSxpLnB1c2gobSksaD1lLmxhc3RJbmRleDttPWEuc3Vic3RyaW5nKGgpO3ZhciBuPW0uaW5kZXhPZihcIj9cIik7aWYobj49MCl7dmFyIG89dGhpcy5zb3VyY2VTZWFyY2g9bS5zdWJzdHJpbmcobik7bT1tLnN1YnN0cmluZygwLG4pLHRoaXMuc291cmNlUGF0aD1hLnN1YnN0cmluZygwLGgrbiksSChvLnN1YnN0cmluZygxKS5zcGxpdCgvWyY/XS8pLGIpfWVsc2UgdGhpcy5zb3VyY2VQYXRoPWEsdGhpcy5zb3VyY2VTZWFyY2g9XCJcIjtnKz1jKG0pK1wiJFwiLGkucHVzaChtKSx0aGlzLnJlZ2V4cD1uZXcgUmVnRXhwKGcpLHRoaXMucHJlZml4PWlbMF19ZnVuY3Rpb24gbygpe3RoaXMuY29tcGlsZT1mdW5jdGlvbihhKXtyZXR1cm4gbmV3IG4oYSl9LHRoaXMuaXNNYXRjaGVyPWZ1bmN0aW9uKGEpe3JldHVybiBGKGEpJiZEKGEuZXhlYykmJkQoYS5mb3JtYXQpJiZEKGEuY29uY2F0KX0sdGhpcy4kZ2V0PWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXN9fWZ1bmN0aW9uIHAoYSl7ZnVuY3Rpb24gYihhKXt2YXIgYj0vXlxcXigoPzpcXFxcW15hLXpBLVowLTldfFteXFxcXFxcW1xcXVxcXiQqKz8uKCl8e31dKykqKS8uZXhlYyhhLnNvdXJjZSk7cmV0dXJuIG51bGwhPWI/YlsxXS5yZXBsYWNlKC9cXFxcKC4pL2csXCIkMVwiKTpcIlwifWZ1bmN0aW9uIGMoYSxiKXtyZXR1cm4gYS5yZXBsYWNlKC9cXCQoXFwkfFxcZHsxLDJ9KS8sZnVuY3Rpb24oYSxjKXtyZXR1cm4gYltcIiRcIj09PWM/MDpOdW1iZXIoYyldfSl9ZnVuY3Rpb24gZChhLGIsYyl7aWYoIWMpcmV0dXJuITE7dmFyIGQ9YS5pbnZva2UoYixiLHskbWF0Y2g6Y30pO3JldHVybiBDKGQpP2Q6ITB9dmFyIGU9W10sZj1udWxsO3RoaXMucnVsZT1mdW5jdGlvbihhKXtpZighRChhKSl0aHJvdyBuZXcgRXJyb3IoXCIncnVsZScgbXVzdCBiZSBhIGZ1bmN0aW9uXCIpO3JldHVybiBlLnB1c2goYSksdGhpc30sdGhpcy5vdGhlcndpc2U9ZnVuY3Rpb24oYSl7aWYoRShhKSl7dmFyIGI9YTthPWZ1bmN0aW9uKCl7cmV0dXJuIGJ9fWVsc2UgaWYoIUQoYSkpdGhyb3cgbmV3IEVycm9yKFwiJ3J1bGUnIG11c3QgYmUgYSBmdW5jdGlvblwiKTtyZXR1cm4gZj1hLHRoaXN9LHRoaXMud2hlbj1mdW5jdGlvbihlLGYpe3ZhciBnLGg9RShmKTtpZihFKGUpJiYoZT1hLmNvbXBpbGUoZSkpLCFoJiYhRChmKSYmIUcoZikpdGhyb3cgbmV3IEVycm9yKFwiaW52YWxpZCAnaGFuZGxlcicgaW4gd2hlbigpXCIpO3ZhciBpPXttYXRjaGVyOmZ1bmN0aW9uKGIsYyl7cmV0dXJuIGgmJihnPWEuY29tcGlsZShjKSxjPVtcIiRtYXRjaFwiLGZ1bmN0aW9uKGEpe3JldHVybiBnLmZvcm1hdChhKX1dKSxJKGZ1bmN0aW9uKGEsZSl7cmV0dXJuIGQoYSxjLGIuZXhlYyhlLnBhdGgoKSxlLnNlYXJjaCgpKSl9LHtwcmVmaXg6RShiLnByZWZpeCk/Yi5wcmVmaXg6XCJcIn0pfSxyZWdleDpmdW5jdGlvbihhLGUpe2lmKGEuZ2xvYmFsfHxhLnN0aWNreSl0aHJvdyBuZXcgRXJyb3IoXCJ3aGVuKCkgUmVnRXhwIG11c3Qgbm90IGJlIGdsb2JhbCBvciBzdGlja3lcIik7cmV0dXJuIGgmJihnPWUsZT1bXCIkbWF0Y2hcIixmdW5jdGlvbihhKXtyZXR1cm4gYyhnLGEpfV0pLEkoZnVuY3Rpb24oYixjKXtyZXR1cm4gZChiLGUsYS5leGVjKGMucGF0aCgpKSl9LHtwcmVmaXg6YihhKX0pfX0saj17bWF0Y2hlcjphLmlzTWF0Y2hlcihlKSxyZWdleDplIGluc3RhbmNlb2YgUmVnRXhwfTtmb3IodmFyIGsgaW4gailpZihqW2tdKXJldHVybiB0aGlzLnJ1bGUoaVtrXShlLGYpKTt0aHJvdyBuZXcgRXJyb3IoXCJpbnZhbGlkICd3aGF0JyBpbiB3aGVuKClcIil9LHRoaXMuJGdldD1bXCIkbG9jYXRpb25cIixcIiRyb290U2NvcGVcIixcIiRpbmplY3RvclwiLGZ1bmN0aW9uKGEsYixjKXtmdW5jdGlvbiBkKGIpe2Z1bmN0aW9uIGQoYil7dmFyIGQ9YihjLGEpO3JldHVybiBkPyhFKGQpJiZhLnJlcGxhY2UoKS51cmwoZCksITApOiExfWlmKCFifHwhYi5kZWZhdWx0UHJldmVudGVkKXt2YXIgZyxoPWUubGVuZ3RoO2ZvcihnPTA7aD5nO2crKylpZihkKGVbZ10pKXJldHVybjtmJiZkKGYpfX1yZXR1cm4gYi4kb24oXCIkbG9jYXRpb25DaGFuZ2VTdWNjZXNzXCIsZCkse3N5bmM6ZnVuY3Rpb24oKXtkKCl9fX1dfWZ1bmN0aW9uIHEoYSxlLGYpe2Z1bmN0aW9uIGcoYSl7cmV0dXJuIDA9PT1hLmluZGV4T2YoXCIuXCIpfHwwPT09YS5pbmRleE9mKFwiXlwiKX1mdW5jdGlvbiBsKGEsYil7dmFyIGQ9RShhKSxlPWQ/YTphLm5hbWUsZj1nKGUpO2lmKGYpe2lmKCFiKXRocm93IG5ldyBFcnJvcihcIk5vIHJlZmVyZW5jZSBwb2ludCBnaXZlbiBmb3IgcGF0aCAnXCIrZStcIidcIik7Zm9yKHZhciBoPWUuc3BsaXQoXCIuXCIpLGk9MCxqPWgubGVuZ3RoLGs9YjtqPmk7aSsrKWlmKFwiXCIhPT1oW2ldfHwwIT09aSl7aWYoXCJeXCIhPT1oW2ldKWJyZWFrO2lmKCFrLnBhcmVudCl0aHJvdyBuZXcgRXJyb3IoXCJQYXRoICdcIitlK1wiJyBub3QgdmFsaWQgZm9yIHN0YXRlICdcIitiLm5hbWUrXCInXCIpO2s9ay5wYXJlbnR9ZWxzZSBrPWI7aD1oLnNsaWNlKGkpLmpvaW4oXCIuXCIpLGU9ay5uYW1lKyhrLm5hbWUmJmg/XCIuXCI6XCJcIikraH12YXIgbD13W2VdO3JldHVybiFsfHwhZCYmKGR8fGwhPT1hJiZsLnNlbGYhPT1hKT9jOmx9ZnVuY3Rpb24gbShhLGIpe3hbYV18fCh4W2FdPVtdKSx4W2FdLnB1c2goYil9ZnVuY3Rpb24gbihiKXtiPWQoYix7c2VsZjpiLHJlc29sdmU6Yi5yZXNvbHZlfHx7fSx0b1N0cmluZzpmdW5jdGlvbigpe3JldHVybiB0aGlzLm5hbWV9fSk7dmFyIGM9Yi5uYW1lO2lmKCFFKGMpfHxjLmluZGV4T2YoXCJAXCIpPj0wKXRocm93IG5ldyBFcnJvcihcIlN0YXRlIG11c3QgaGF2ZSBhIHZhbGlkIG5hbWVcIik7aWYody5oYXNPd25Qcm9wZXJ0eShjKSl0aHJvdyBuZXcgRXJyb3IoXCJTdGF0ZSAnXCIrYytcIicnIGlzIGFscmVhZHkgZGVmaW5lZFwiKTt2YXIgZT0tMSE9PWMuaW5kZXhPZihcIi5cIik/Yy5zdWJzdHJpbmcoMCxjLmxhc3RJbmRleE9mKFwiLlwiKSk6RShiLnBhcmVudCk/Yi5wYXJlbnQ6XCJcIjtpZihlJiYhd1tlXSlyZXR1cm4gbShlLGIuc2VsZik7Zm9yKHZhciBmIGluIHopRCh6W2ZdKSYmKGJbZl09eltmXShiLHouJGRlbGVnYXRlc1tmXSkpO2lmKHdbY109YiwhYlt5XSYmYi51cmwmJmEud2hlbihiLnVybCxbXCIkbWF0Y2hcIixcIiRzdGF0ZVBhcmFtc1wiLGZ1bmN0aW9uKGEsYyl7di4kY3VycmVudC5uYXZpZ2FibGU9PWImJmooYSxjKXx8di50cmFuc2l0aW9uVG8oYixhLHtsb2NhdGlvbjohMX0pfV0pLHhbY10pZm9yKHZhciBnPTA7Zzx4W2NdLmxlbmd0aDtnKyspbih4W2NdW2ddKTtyZXR1cm4gYn1mdW5jdGlvbiBvKGEpe3JldHVybiBhLmluZGV4T2YoXCIqXCIpPi0xfWZ1bmN0aW9uIHAoYSl7dmFyIGI9YS5zcGxpdChcIi5cIiksYz12LiRjdXJyZW50Lm5hbWUuc3BsaXQoXCIuXCIpO2lmKFwiKipcIj09PWJbMF0mJihjPWMuc2xpY2UoYy5pbmRleE9mKGJbMV0pKSxjLnVuc2hpZnQoXCIqKlwiKSksXCIqKlwiPT09YltiLmxlbmd0aC0xXSYmKGMuc3BsaWNlKGMuaW5kZXhPZihiW2IubGVuZ3RoLTJdKSsxLE51bWJlci5NQVhfVkFMVUUpLGMucHVzaChcIioqXCIpKSxiLmxlbmd0aCE9Yy5sZW5ndGgpcmV0dXJuITE7Zm9yKHZhciBkPTAsZT1iLmxlbmd0aDtlPmQ7ZCsrKVwiKlwiPT09YltkXSYmKGNbZF09XCIqXCIpO3JldHVybiBjLmpvaW4oXCJcIik9PT1iLmpvaW4oXCJcIil9ZnVuY3Rpb24gcShhLGIpe3JldHVybiBFKGEpJiYhQyhiKT96W2FdOkQoYikmJkUoYSk/KHpbYV0mJiF6LiRkZWxlZ2F0ZXNbYV0mJih6LiRkZWxlZ2F0ZXNbYV09elthXSkselthXT1iLHRoaXMpOnRoaXN9ZnVuY3Rpb24gcihhLGIpe3JldHVybiBGKGEpP2I9YTpiLm5hbWU9YSxuKGIpLHRoaXN9ZnVuY3Rpb24gcyhhLGUsZyxtLG4scSxyLHMseCl7ZnVuY3Rpb24geigpe3IudXJsKCkhPT1NJiYoci51cmwoTSksci5yZXBsYWNlKCkpfWZ1bmN0aW9uIEEoYSxjLGQsZixoKXt2YXIgaT1kP2M6ayhhLnBhcmFtcyxjKSxqPXskc3RhdGVQYXJhbXM6aX07aC5yZXNvbHZlPW4ucmVzb2x2ZShhLnJlc29sdmUsaixoLnJlc29sdmUsYSk7dmFyIGw9W2gucmVzb2x2ZS50aGVuKGZ1bmN0aW9uKGEpe2guZ2xvYmFscz1hfSldO3JldHVybiBmJiZsLnB1c2goZiksSChhLnZpZXdzLGZ1bmN0aW9uKGMsZCl7dmFyIGU9Yy5yZXNvbHZlJiZjLnJlc29sdmUhPT1hLnJlc29sdmU/Yy5yZXNvbHZlOnt9O2UuJHRlbXBsYXRlPVtmdW5jdGlvbigpe3JldHVybiBnLmxvYWQoZCx7dmlldzpjLGxvY2FsczpqLHBhcmFtczppLG5vdGlmeTohMX0pfHxcIlwifV0sbC5wdXNoKG4ucmVzb2x2ZShlLGosaC5yZXNvbHZlLGEpLnRoZW4oZnVuY3Rpb24oZil7aWYoRChjLmNvbnRyb2xsZXJQcm92aWRlcil8fEcoYy5jb250cm9sbGVyUHJvdmlkZXIpKXt2YXIgZz1iLmV4dGVuZCh7fSxlLGopO2YuJCRjb250cm9sbGVyPW0uaW52b2tlKGMuY29udHJvbGxlclByb3ZpZGVyLG51bGwsZyl9ZWxzZSBmLiQkY29udHJvbGxlcj1jLmNvbnRyb2xsZXI7Zi4kJHN0YXRlPWEsZi4kJGNvbnRyb2xsZXJBcz1jLmNvbnRyb2xsZXJBcyxoW2RdPWZ9KSl9KSxlLmFsbChsKS50aGVuKGZ1bmN0aW9uKCl7cmV0dXJuIGh9KX12YXIgQj1lLnJlamVjdChuZXcgRXJyb3IoXCJ0cmFuc2l0aW9uIHN1cGVyc2VkZWRcIikpLEY9ZS5yZWplY3QobmV3IEVycm9yKFwidHJhbnNpdGlvbiBwcmV2ZW50ZWRcIikpLEs9ZS5yZWplY3QobmV3IEVycm9yKFwidHJhbnNpdGlvbiBhYm9ydGVkXCIpKSxMPWUucmVqZWN0KG5ldyBFcnJvcihcInRyYW5zaXRpb24gZmFpbGVkXCIpKSxNPXIudXJsKCksTj14LmJhc2VIcmVmKCk7cmV0dXJuIHUubG9jYWxzPXtyZXNvbHZlOm51bGwsZ2xvYmFsczp7JHN0YXRlUGFyYW1zOnt9fX0sdj17cGFyYW1zOnt9LGN1cnJlbnQ6dS5zZWxmLCRjdXJyZW50OnUsdHJhbnNpdGlvbjpudWxsfSx2LnJlbG9hZD1mdW5jdGlvbigpe3YudHJhbnNpdGlvblRvKHYuY3VycmVudCxxLHtyZWxvYWQ6ITAsaW5oZXJpdDohMSxub3RpZnk6ITF9KX0sdi5nbz1mdW5jdGlvbihhLGIsYyl7cmV0dXJuIHRoaXMudHJhbnNpdGlvblRvKGEsYixJKHtpbmhlcml0OiEwLHJlbGF0aXZlOnYuJGN1cnJlbnR9LGMpKX0sdi50cmFuc2l0aW9uVG89ZnVuY3Rpb24oYixjLGYpe2M9Y3x8e30sZj1JKHtsb2NhdGlvbjohMCxpbmhlcml0OiExLHJlbGF0aXZlOm51bGwsbm90aWZ5OiEwLHJlbG9hZDohMSwkcmV0cnk6ITF9LGZ8fHt9KTt2YXIgZyxrPXYuJGN1cnJlbnQsbj12LnBhcmFtcyxvPWsucGF0aCxwPWwoYixmLnJlbGF0aXZlKTtpZighQyhwKSl7dmFyIHM9e3RvOmIsdG9QYXJhbXM6YyxvcHRpb25zOmZ9O2lmKGc9YS4kYnJvYWRjYXN0KFwiJHN0YXRlTm90Rm91bmRcIixzLGsuc2VsZixuKSxnLmRlZmF1bHRQcmV2ZW50ZWQpcmV0dXJuIHooKSxLO2lmKGcucmV0cnkpe2lmKGYuJHJldHJ5KXJldHVybiB6KCksTDt2YXIgdz12LnRyYW5zaXRpb249ZS53aGVuKGcucmV0cnkpO3JldHVybiB3LnRoZW4oZnVuY3Rpb24oKXtyZXR1cm4gdyE9PXYudHJhbnNpdGlvbj9COihzLm9wdGlvbnMuJHJldHJ5PSEwLHYudHJhbnNpdGlvblRvKHMudG8scy50b1BhcmFtcyxzLm9wdGlvbnMpKX0sZnVuY3Rpb24oKXtyZXR1cm4gS30pLHooKSx3fWlmKGI9cy50byxjPXMudG9QYXJhbXMsZj1zLm9wdGlvbnMscD1sKGIsZi5yZWxhdGl2ZSksIUMocCkpe2lmKGYucmVsYXRpdmUpdGhyb3cgbmV3IEVycm9yKFwiQ291bGQgbm90IHJlc29sdmUgJ1wiK2IrXCInIGZyb20gc3RhdGUgJ1wiK2YucmVsYXRpdmUrXCInXCIpO3Rocm93IG5ldyBFcnJvcihcIk5vIHN1Y2ggc3RhdGUgJ1wiK2IrXCInXCIpfX1pZihwW3ldKXRocm93IG5ldyBFcnJvcihcIkNhbm5vdCB0cmFuc2l0aW9uIHRvIGFic3RyYWN0IHN0YXRlICdcIitiK1wiJ1wiKTtmLmluaGVyaXQmJihjPWgocSxjfHx7fSx2LiRjdXJyZW50LHApKSxiPXA7dmFyIHgsRCxFPWIucGF0aCxHPXUubG9jYWxzLEg9W107Zm9yKHg9MCxEPUVbeF07RCYmRD09PW9beF0mJmooYyxuLEQub3duUGFyYW1zKSYmIWYucmVsb2FkO3grKyxEPUVbeF0pRz1IW3hdPUQubG9jYWxzO2lmKHQoYixrLEcsZikpcmV0dXJuIGIuc2VsZi5yZWxvYWRPblNlYXJjaCE9PSExJiZ6KCksdi50cmFuc2l0aW9uPW51bGwsZS53aGVuKHYuY3VycmVudCk7aWYoYz1pKGIucGFyYW1zLGN8fHt9KSxmLm5vdGlmeSYmKGc9YS4kYnJvYWRjYXN0KFwiJHN0YXRlQ2hhbmdlU3RhcnRcIixiLnNlbGYsYyxrLnNlbGYsbiksZy5kZWZhdWx0UHJldmVudGVkKSlyZXR1cm4geigpLEY7Zm9yKHZhciBOPWUud2hlbihHKSxPPXg7TzxFLmxlbmd0aDtPKyssRD1FW09dKUc9SFtPXT1kKEcpLE49QShELGMsRD09PWIsTixHKTt2YXIgUD12LnRyYW5zaXRpb249Ti50aGVuKGZ1bmN0aW9uKCl7dmFyIGQsZSxnO2lmKHYudHJhbnNpdGlvbiE9PVApcmV0dXJuIEI7Zm9yKGQ9by5sZW5ndGgtMTtkPj14O2QtLSlnPW9bZF0sZy5zZWxmLm9uRXhpdCYmbS5pbnZva2UoZy5zZWxmLm9uRXhpdCxnLnNlbGYsZy5sb2NhbHMuZ2xvYmFscyksZy5sb2NhbHM9bnVsbDtmb3IoZD14O2Q8RS5sZW5ndGg7ZCsrKWU9RVtkXSxlLmxvY2Fscz1IW2RdLGUuc2VsZi5vbkVudGVyJiZtLmludm9rZShlLnNlbGYub25FbnRlcixlLnNlbGYsZS5sb2NhbHMuZ2xvYmFscyk7aWYodi50cmFuc2l0aW9uIT09UClyZXR1cm4gQjt2LiRjdXJyZW50PWIsdi5jdXJyZW50PWIuc2VsZix2LnBhcmFtcz1jLEoodi5wYXJhbXMscSksdi50cmFuc2l0aW9uPW51bGw7dmFyIGg9Yi5uYXZpZ2FibGU7cmV0dXJuIGYubG9jYXRpb24mJmgmJihyLnVybChoLnVybC5mb3JtYXQoaC5sb2NhbHMuZ2xvYmFscy4kc3RhdGVQYXJhbXMpKSxcInJlcGxhY2VcIj09PWYubG9jYXRpb24mJnIucmVwbGFjZSgpKSxmLm5vdGlmeSYmYS4kYnJvYWRjYXN0KFwiJHN0YXRlQ2hhbmdlU3VjY2Vzc1wiLGIuc2VsZixjLGsuc2VsZixuKSxNPXIudXJsKCksdi5jdXJyZW50fSxmdW5jdGlvbihkKXtyZXR1cm4gdi50cmFuc2l0aW9uIT09UD9COih2LnRyYW5zaXRpb249bnVsbCxhLiRicm9hZGNhc3QoXCIkc3RhdGVDaGFuZ2VFcnJvclwiLGIuc2VsZixjLGsuc2VsZixuLGQpLHooKSxlLnJlamVjdChkKSl9KTtyZXR1cm4gUH0sdi5pcz1mdW5jdGlvbihhLGQpe3ZhciBlPWwoYSk7cmV0dXJuIEMoZSk/di4kY3VycmVudCE9PWU/ITE6QyhkKSYmbnVsbCE9PWQ/Yi5lcXVhbHMocSxkKTohMDpjfSx2LmluY2x1ZGVzPWZ1bmN0aW9uKGEsZCl7aWYoRShhKSYmbyhhKSl7aWYoIXAoYSkpcmV0dXJuITE7YT12LiRjdXJyZW50Lm5hbWV9dmFyIGU9bChhKTtpZighQyhlKSlyZXR1cm4gYztpZighQyh2LiRjdXJyZW50LmluY2x1ZGVzW2UubmFtZV0pKXJldHVybiExO3ZhciBmPSEwO3JldHVybiBiLmZvckVhY2goZCxmdW5jdGlvbihhLGIpe0MocVtiXSkmJnFbYl09PT1hfHwoZj0hMSl9KSxmfSx2LmhyZWY9ZnVuY3Rpb24oYSxiLGMpe2M9SSh7bG9zc3k6ITAsaW5oZXJpdDohMSxhYnNvbHV0ZTohMSxyZWxhdGl2ZTp2LiRjdXJyZW50fSxjfHx7fSk7dmFyIGQ9bChhLGMucmVsYXRpdmUpO2lmKCFDKGQpKXJldHVybiBudWxsO2I9aChxLGJ8fHt9LHYuJGN1cnJlbnQsZCk7dmFyIGU9ZCYmYy5sb3NzeT9kLm5hdmlnYWJsZTpkLGc9ZSYmZS51cmw/ZS51cmwuZm9ybWF0KGkoZC5wYXJhbXMsYnx8e30pKTpudWxsO3JldHVybiFmLmh0bWw1TW9kZSgpJiZnJiYoZz1cIiNcIitmLmhhc2hQcmVmaXgoKStnKSxcIi9cIiE9PU4mJihmLmh0bWw1TW9kZSgpP2c9Ti5zbGljZSgwLC0xKStnOmMuYWJzb2x1dGUmJihnPU4uc2xpY2UoMSkrZykpLGMuYWJzb2x1dGUmJmcmJihnPXIucHJvdG9jb2woKStcIjovL1wiK3IuaG9zdCgpKyg4MD09ci5wb3J0KCl8fDQ0Mz09ci5wb3J0KCk/XCJcIjpcIjpcIityLnBvcnQoKSkrKCFmLmh0bWw1TW9kZSgpJiZnP1wiL1wiOlwiXCIpK2cpLGd9LHYuZ2V0PWZ1bmN0aW9uKGEsYil7aWYoIUMoYSkpe3ZhciBjPVtdO3JldHVybiBIKHcsZnVuY3Rpb24oYSl7Yy5wdXNoKGEuc2VsZil9KSxjfXZhciBkPWwoYSxiKTtyZXR1cm4gZCYmZC5zZWxmP2Quc2VsZjpudWxsfSx2fWZ1bmN0aW9uIHQoYSxiLGMsZCl7cmV0dXJuIGEhPT1ifHwoYyE9PWIubG9jYWxzfHxkLnJlbG9hZCkmJmEuc2VsZi5yZWxvYWRPblNlYXJjaCE9PSExP3ZvaWQgMDohMH12YXIgdSx2LHc9e30seD17fSx5PVwiYWJzdHJhY3RcIix6PXtwYXJlbnQ6ZnVuY3Rpb24oYSl7aWYoQyhhLnBhcmVudCkmJmEucGFyZW50KXJldHVybiBsKGEucGFyZW50KTt2YXIgYj0vXiguKylcXC5bXi5dKyQvLmV4ZWMoYS5uYW1lKTtyZXR1cm4gYj9sKGJbMV0pOnV9LGRhdGE6ZnVuY3Rpb24oYSl7cmV0dXJuIGEucGFyZW50JiZhLnBhcmVudC5kYXRhJiYoYS5kYXRhPWEuc2VsZi5kYXRhPUkoe30sYS5wYXJlbnQuZGF0YSxhLmRhdGEpKSxhLmRhdGF9LHVybDpmdW5jdGlvbihhKXt2YXIgYj1hLnVybDtpZihFKGIpKXJldHVyblwiXlwiPT1iLmNoYXJBdCgwKT9lLmNvbXBpbGUoYi5zdWJzdHJpbmcoMSkpOihhLnBhcmVudC5uYXZpZ2FibGV8fHUpLnVybC5jb25jYXQoYik7aWYoZS5pc01hdGNoZXIoYil8fG51bGw9PWIpcmV0dXJuIGI7dGhyb3cgbmV3IEVycm9yKFwiSW52YWxpZCB1cmwgJ1wiK2IrXCInIGluIHN0YXRlICdcIithK1wiJ1wiKX0sbmF2aWdhYmxlOmZ1bmN0aW9uKGEpe3JldHVybiBhLnVybD9hOmEucGFyZW50P2EucGFyZW50Lm5hdmlnYWJsZTpudWxsfSxwYXJhbXM6ZnVuY3Rpb24oYSl7aWYoIWEucGFyYW1zKXJldHVybiBhLnVybD9hLnVybC5wYXJhbWV0ZXJzKCk6YS5wYXJlbnQucGFyYW1zO2lmKCFHKGEucGFyYW1zKSl0aHJvdyBuZXcgRXJyb3IoXCJJbnZhbGlkIHBhcmFtcyBpbiBzdGF0ZSAnXCIrYStcIidcIik7aWYoYS51cmwpdGhyb3cgbmV3IEVycm9yKFwiQm90aCBwYXJhbXMgYW5kIHVybCBzcGVjaWNpZmllZCBpbiBzdGF0ZSAnXCIrYStcIidcIik7cmV0dXJuIGEucGFyYW1zfSx2aWV3czpmdW5jdGlvbihhKXt2YXIgYj17fTtyZXR1cm4gSChDKGEudmlld3MpP2Eudmlld3M6e1wiXCI6YX0sZnVuY3Rpb24oYyxkKXtkLmluZGV4T2YoXCJAXCIpPDAmJihkKz1cIkBcIithLnBhcmVudC5uYW1lKSxiW2RdPWN9KSxifSxvd25QYXJhbXM6ZnVuY3Rpb24oYSl7aWYoIWEucGFyZW50KXJldHVybiBhLnBhcmFtczt2YXIgYj17fTtIKGEucGFyYW1zLGZ1bmN0aW9uKGEpe2JbYV09ITB9KSxIKGEucGFyZW50LnBhcmFtcyxmdW5jdGlvbihjKXtpZighYltjXSl0aHJvdyBuZXcgRXJyb3IoXCJNaXNzaW5nIHJlcXVpcmVkIHBhcmFtZXRlciAnXCIrYytcIicgaW4gc3RhdGUgJ1wiK2EubmFtZStcIidcIik7YltjXT0hMX0pO3ZhciBjPVtdO3JldHVybiBIKGIsZnVuY3Rpb24oYSxiKXthJiZjLnB1c2goYil9KSxjfSxwYXRoOmZ1bmN0aW9uKGEpe3JldHVybiBhLnBhcmVudD9hLnBhcmVudC5wYXRoLmNvbmNhdChhKTpbXX0saW5jbHVkZXM6ZnVuY3Rpb24oYSl7dmFyIGI9YS5wYXJlbnQ/SSh7fSxhLnBhcmVudC5pbmNsdWRlcyk6e307cmV0dXJuIGJbYS5uYW1lXT0hMCxifSwkZGVsZWdhdGVzOnt9fTt1PW4oe25hbWU6XCJcIix1cmw6XCJeXCIsdmlld3M6bnVsbCxcImFic3RyYWN0XCI6ITB9KSx1Lm5hdmlnYWJsZT1udWxsLHRoaXMuZGVjb3JhdG9yPXEsdGhpcy5zdGF0ZT1yLHRoaXMuJGdldD1zLHMuJGluamVjdD1bXCIkcm9vdFNjb3BlXCIsXCIkcVwiLFwiJHZpZXdcIixcIiRpbmplY3RvclwiLFwiJHJlc29sdmVcIixcIiRzdGF0ZVBhcmFtc1wiLFwiJGxvY2F0aW9uXCIsXCIkdXJsUm91dGVyXCIsXCIkYnJvd3NlclwiXX1mdW5jdGlvbiByKCl7ZnVuY3Rpb24gYShhLGIpe3JldHVybntsb2FkOmZ1bmN0aW9uKGMsZCl7dmFyIGUsZj17dGVtcGxhdGU6bnVsbCxjb250cm9sbGVyOm51bGwsdmlldzpudWxsLGxvY2FsczpudWxsLG5vdGlmeTohMCxhc3luYzohMCxwYXJhbXM6e319O3JldHVybiBkPUkoZixkKSxkLnZpZXcmJihlPWIuZnJvbUNvbmZpZyhkLnZpZXcsZC5wYXJhbXMsZC5sb2NhbHMpKSxlJiZkLm5vdGlmeSYmYS4kYnJvYWRjYXN0KFwiJHZpZXdDb250ZW50TG9hZGluZ1wiLGQpLGV9fX10aGlzLiRnZXQ9YSxhLiRpbmplY3Q9W1wiJHJvb3RTY29wZVwiLFwiJHRlbXBsYXRlRmFjdG9yeVwiXX1mdW5jdGlvbiBzKCl7dmFyIGE9ITE7dGhpcy51c2VBbmNob3JTY3JvbGw9ZnVuY3Rpb24oKXthPSEwfSx0aGlzLiRnZXQ9W1wiJGFuY2hvclNjcm9sbFwiLFwiJHRpbWVvdXRcIixmdW5jdGlvbihiLGMpe3JldHVybiBhP2I6ZnVuY3Rpb24oYSl7YyhmdW5jdGlvbigpe2FbMF0uc2Nyb2xsSW50b1ZpZXcoKX0sMCwhMSl9fV19ZnVuY3Rpb24gdChhLGMsZCl7ZnVuY3Rpb24gZSgpe3JldHVybiBjLmhhcz9mdW5jdGlvbihhKXtyZXR1cm4gYy5oYXMoYSk/Yy5nZXQoYSk6bnVsbH06ZnVuY3Rpb24oYSl7dHJ5e3JldHVybiBjLmdldChhKX1jYXRjaChiKXtyZXR1cm4gbnVsbH19fWZ1bmN0aW9uIGYoYSxiKXt2YXIgYz1mdW5jdGlvbigpe3JldHVybntlbnRlcjpmdW5jdGlvbihhLGIsYyl7Yi5hZnRlcihhKSxjKCl9LGxlYXZlOmZ1bmN0aW9uKGEsYil7YS5yZW1vdmUoKSxiKCl9fX07aWYoaSlyZXR1cm57ZW50ZXI6ZnVuY3Rpb24oYSxiLGMpe2kuZW50ZXIoYSxudWxsLGIsYyl9LGxlYXZlOmZ1bmN0aW9uKGEsYil7aS5sZWF2ZShhLGIpfX07aWYoaCl7dmFyIGQ9aCYmaChiLGEpO3JldHVybntlbnRlcjpmdW5jdGlvbihhLGIsYyl7ZC5lbnRlcihhLG51bGwsYiksYygpfSxsZWF2ZTpmdW5jdGlvbihhLGIpe2QubGVhdmUoYSksYigpfX19cmV0dXJuIGMoKX12YXIgZz1lKCksaD1nKFwiJGFuaW1hdG9yXCIpLGk9ZyhcIiRhbmltYXRlXCIpLGo9e3Jlc3RyaWN0OlwiRUNBXCIsdGVybWluYWw6ITAscHJpb3JpdHk6NDAwLHRyYW5zY2x1ZGU6XCJlbGVtZW50XCIsY29tcGlsZTpmdW5jdGlvbihjLGUsZyl7cmV0dXJuIGZ1bmN0aW9uKGMsZSxoKXtmdW5jdGlvbiBpKCl7ayYmKGsucmVtb3ZlKCksaz1udWxsKSxtJiYobS4kZGVzdHJveSgpLG09bnVsbCksbCYmKHEubGVhdmUobCxmdW5jdGlvbigpe2s9bnVsbH0pLGs9bCxsPW51bGwpfWZ1bmN0aW9uIGooZil7dmFyIGg9Yy4kbmV3KCksaj1sJiZsLmRhdGEoXCIkdWlWaWV3TmFtZVwiKSxrPWomJmEuJGN1cnJlbnQmJmEuJGN1cnJlbnQubG9jYWxzW2pdO2lmKGZ8fGshPT1uKXt2YXIgcj1nKGgsZnVuY3Rpb24oYSl7cS5lbnRlcihhLGUsZnVuY3Rpb24oKXsoYi5pc0RlZmluZWQocCkmJiFwfHxjLiRldmFsKHApKSYmZChhKX0pLGkoKX0pO249YS4kY3VycmVudC5sb2NhbHNbci5kYXRhKFwiJHVpVmlld05hbWVcIildLGw9cixtPWgsbS4kZW1pdChcIiR2aWV3Q29udGVudExvYWRlZFwiKSxtLiRldmFsKG8pfX12YXIgayxsLG0sbixvPWgub25sb2FkfHxcIlwiLHA9aC5hdXRvc2Nyb2xsLHE9ZihoLGMpO2MuJG9uKFwiJHN0YXRlQ2hhbmdlU3VjY2Vzc1wiLGZ1bmN0aW9uKCl7aighMSl9KSxjLiRvbihcIiR2aWV3Q29udGVudExvYWRpbmdcIixmdW5jdGlvbigpe2ooITEpfSksaighMCl9fX07cmV0dXJuIGp9ZnVuY3Rpb24gdShhLGIsYyl7cmV0dXJue3Jlc3RyaWN0OlwiRUNBXCIscHJpb3JpdHk6LTQwMCxjb21waWxlOmZ1bmN0aW9uKGQpe3ZhciBlPWQuaHRtbCgpO3JldHVybiBmdW5jdGlvbihkLGYsZyl7dmFyIGg9Zy51aVZpZXd8fGcubmFtZXx8XCJcIixpPWYuaW5oZXJpdGVkRGF0YShcIiR1aVZpZXdcIik7aC5pbmRleE9mKFwiQFwiKTwwJiYoaD1oK1wiQFwiKyhpP2kuc3RhdGUubmFtZTpcIlwiKSksZi5kYXRhKFwiJHVpVmlld05hbWVcIixoKTt2YXIgaj1jLiRjdXJyZW50LGs9aiYmai5sb2NhbHNbaF07aWYoayl7Zi5kYXRhKFwiJHVpVmlld1wiLHtuYW1lOmgsc3RhdGU6ay4kJHN0YXRlfSksZi5odG1sKGsuJHRlbXBsYXRlP2suJHRlbXBsYXRlOmUpO3ZhciBsPWEoZi5jb250ZW50cygpKTtpZihrLiQkY29udHJvbGxlcil7ay4kc2NvcGU9ZDt2YXIgbT1iKGsuJCRjb250cm9sbGVyLGspO2suJCRjb250cm9sbGVyQXMmJihkW2suJCRjb250cm9sbGVyQXNdPW0pLGYuZGF0YShcIiRuZ0NvbnRyb2xsZXJDb250cm9sbGVyXCIsbSksZi5jaGlsZHJlbigpLmRhdGEoXCIkbmdDb250cm9sbGVyQ29udHJvbGxlclwiLG0pfWwoZCl9fX19fWZ1bmN0aW9uIHYoYSl7dmFyIGI9YS5yZXBsYWNlKC9cXG4vZyxcIiBcIikubWF0Y2goL14oW14oXSs/KVxccyooXFwoKC4qKVxcKSk/JC8pO2lmKCFifHw0IT09Yi5sZW5ndGgpdGhyb3cgbmV3IEVycm9yKFwiSW52YWxpZCBzdGF0ZSByZWYgJ1wiK2ErXCInXCIpO3JldHVybntzdGF0ZTpiWzFdLHBhcmFtRXhwcjpiWzNdfHxudWxsfX1mdW5jdGlvbiB3KGEpe3ZhciBiPWEucGFyZW50KCkuaW5oZXJpdGVkRGF0YShcIiR1aVZpZXdcIik7cmV0dXJuIGImJmIuc3RhdGUmJmIuc3RhdGUubmFtZT9iLnN0YXRlOnZvaWQgMH1mdW5jdGlvbiB4KGEsYyl7dmFyIGQ9W1wibG9jYXRpb25cIixcImluaGVyaXRcIixcInJlbG9hZFwiXTtyZXR1cm57cmVzdHJpY3Q6XCJBXCIscmVxdWlyZTpcIj9edWlTcmVmQWN0aXZlXCIsbGluazpmdW5jdGlvbihlLGYsZyxoKXt2YXIgaT12KGcudWlTcmVmKSxqPW51bGwsaz13KGYpfHxhLiRjdXJyZW50LGw9XCJGT1JNXCI9PT1mWzBdLm5vZGVOYW1lLG09bD9cImFjdGlvblwiOlwiaHJlZlwiLG49ITAsbz17cmVsYXRpdmU6a30scD1lLiRldmFsKGcudWlTcmVmT3B0cyl8fHt9O2IuZm9yRWFjaChkLGZ1bmN0aW9uKGEpe2EgaW4gcCYmKG9bYV09cFthXSl9KTt2YXIgcT1mdW5jdGlvbihiKXtpZihiJiYoaj1iKSxuKXt2YXIgYz1hLmhyZWYoaS5zdGF0ZSxqLG8pO3JldHVybiBoJiZoLiQkc2V0U3RhdGVJbmZvKGkuc3RhdGUsaiksYz92b2lkKGZbMF1bbV09Yyk6KG49ITEsITEpfX07aS5wYXJhbUV4cHImJihlLiR3YXRjaChpLnBhcmFtRXhwcixmdW5jdGlvbihhKXthIT09aiYmcShhKX0sITApLGo9ZS4kZXZhbChpLnBhcmFtRXhwcikpLHEoKSxsfHxmLmJpbmQoXCJjbGlja1wiLGZ1bmN0aW9uKGIpe3ZhciBkPWIud2hpY2h8fGIuYnV0dG9uO2Q+MXx8Yi5jdHJsS2V5fHxiLm1ldGFLZXl8fGIuc2hpZnRLZXl8fGYuYXR0cihcInRhcmdldFwiKXx8KGMoZnVuY3Rpb24oKXthLmdvKGkuc3RhdGUsaixvKX0pLGIucHJldmVudERlZmF1bHQoKSl9KX19fWZ1bmN0aW9uIHkoYSxiLGMpe3JldHVybntyZXN0cmljdDpcIkFcIixjb250cm9sbGVyOltcIiRzY29wZVwiLFwiJGVsZW1lbnRcIixcIiRhdHRyc1wiLGZ1bmN0aW9uKGQsZSxmKXtmdW5jdGlvbiBnKCl7YS4kY3VycmVudC5zZWxmPT09aSYmaCgpP2UuYWRkQ2xhc3MobCk6ZS5yZW1vdmVDbGFzcyhsKX1mdW5jdGlvbiBoKCl7cmV0dXJuIWt8fGooayxiKX12YXIgaSxrLGw7bD1jKGYudWlTcmVmQWN0aXZlfHxcIlwiLCExKShkKSx0aGlzLiQkc2V0U3RhdGVJbmZvPWZ1bmN0aW9uKGIsYyl7aT1hLmdldChiLHcoZSkpLGs9YyxnKCl9LGQuJG9uKFwiJHN0YXRlQ2hhbmdlU3VjY2Vzc1wiLGcpfV19fWZ1bmN0aW9uIHooYSl7cmV0dXJuIGZ1bmN0aW9uKGIpe3JldHVybiBhLmlzKGIpfX1mdW5jdGlvbiBBKGEpe3JldHVybiBmdW5jdGlvbihiKXtyZXR1cm4gYS5pbmNsdWRlcyhiKX19ZnVuY3Rpb24gQihhLGIpe2Z1bmN0aW9uIGUoYSl7dGhpcy5sb2NhbHM9YS5sb2NhbHMuZ2xvYmFscyx0aGlzLnBhcmFtcz10aGlzLmxvY2Fscy4kc3RhdGVQYXJhbXN9ZnVuY3Rpb24gZigpe3RoaXMubG9jYWxzPW51bGwsdGhpcy5wYXJhbXM9bnVsbH1mdW5jdGlvbiBnKGMsZyl7aWYobnVsbCE9Zy5yZWRpcmVjdFRvKXt2YXIgaCxqPWcucmVkaXJlY3RUbztpZihFKGopKWg9ajtlbHNle2lmKCFEKGopKXRocm93IG5ldyBFcnJvcihcIkludmFsaWQgJ3JlZGlyZWN0VG8nIGluIHdoZW4oKVwiKTtoPWZ1bmN0aW9uKGEsYil7cmV0dXJuIGooYSxiLnBhdGgoKSxiLnNlYXJjaCgpKX19Yi53aGVuKGMsaCl9ZWxzZSBhLnN0YXRlKGQoZyx7cGFyZW50Om51bGwsbmFtZTpcInJvdXRlOlwiK2VuY29kZVVSSUNvbXBvbmVudChjKSx1cmw6YyxvbkVudGVyOmUsb25FeGl0OmZ9KSk7cmV0dXJuIGkucHVzaChnKSx0aGlzfWZ1bmN0aW9uIGgoYSxiLGQpe2Z1bmN0aW9uIGUoYSl7cmV0dXJuXCJcIiE9PWEubmFtZT9hOmN9dmFyIGY9e3JvdXRlczppLHBhcmFtczpkLGN1cnJlbnQ6Y307cmV0dXJuIGIuJG9uKFwiJHN0YXRlQ2hhbmdlU3RhcnRcIixmdW5jdGlvbihhLGMsZCxmKXtiLiRicm9hZGNhc3QoXCIkcm91dGVDaGFuZ2VTdGFydFwiLGUoYyksZShmKSl9KSxiLiRvbihcIiRzdGF0ZUNoYW5nZVN1Y2Nlc3NcIixmdW5jdGlvbihhLGMsZCxnKXtmLmN1cnJlbnQ9ZShjKSxiLiRicm9hZGNhc3QoXCIkcm91dGVDaGFuZ2VTdWNjZXNzXCIsZShjKSxlKGcpKSxKKGQsZi5wYXJhbXMpfSksYi4kb24oXCIkc3RhdGVDaGFuZ2VFcnJvclwiLGZ1bmN0aW9uKGEsYyxkLGYsZyxoKXtiLiRicm9hZGNhc3QoXCIkcm91dGVDaGFuZ2VFcnJvclwiLGUoYyksZShmKSxoKX0pLGZ9dmFyIGk9W107ZS4kaW5qZWN0PVtcIiQkc3RhdGVcIl0sdGhpcy53aGVuPWcsdGhpcy4kZ2V0PWgsaC4kaW5qZWN0PVtcIiRzdGF0ZVwiLFwiJHJvb3RTY29wZVwiLFwiJHJvdXRlUGFyYW1zXCJdfXZhciBDPWIuaXNEZWZpbmVkLEQ9Yi5pc0Z1bmN0aW9uLEU9Yi5pc1N0cmluZyxGPWIuaXNPYmplY3QsRz1iLmlzQXJyYXksSD1iLmZvckVhY2gsST1iLmV4dGVuZCxKPWIuY29weTtiLm1vZHVsZShcInVpLnJvdXRlci51dGlsXCIsW1wibmdcIl0pLGIubW9kdWxlKFwidWkucm91dGVyLnJvdXRlclwiLFtcInVpLnJvdXRlci51dGlsXCJdKSxiLm1vZHVsZShcInVpLnJvdXRlci5zdGF0ZVwiLFtcInVpLnJvdXRlci5yb3V0ZXJcIixcInVpLnJvdXRlci51dGlsXCJdKSxiLm1vZHVsZShcInVpLnJvdXRlclwiLFtcInVpLnJvdXRlci5zdGF0ZVwiXSksYi5tb2R1bGUoXCJ1aS5yb3V0ZXIuY29tcGF0XCIsW1widWkucm91dGVyXCJdKSxsLiRpbmplY3Q9W1wiJHFcIixcIiRpbmplY3RvclwiXSxiLm1vZHVsZShcInVpLnJvdXRlci51dGlsXCIpLnNlcnZpY2UoXCIkcmVzb2x2ZVwiLGwpLG0uJGluamVjdD1bXCIkaHR0cFwiLFwiJHRlbXBsYXRlQ2FjaGVcIixcIiRpbmplY3RvclwiXSxiLm1vZHVsZShcInVpLnJvdXRlci51dGlsXCIpLnNlcnZpY2UoXCIkdGVtcGxhdGVGYWN0b3J5XCIsbSksbi5wcm90b3R5cGUuY29uY2F0PWZ1bmN0aW9uKGEpe3JldHVybiBuZXcgbih0aGlzLnNvdXJjZVBhdGgrYSt0aGlzLnNvdXJjZVNlYXJjaCl9LG4ucHJvdG90eXBlLnRvU3RyaW5nPWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuc291cmNlfSxuLnByb3RvdHlwZS5leGVjPWZ1bmN0aW9uKGEsYil7dmFyIGM9dGhpcy5yZWdleHAuZXhlYyhhKTtpZighYylyZXR1cm4gbnVsbDt2YXIgZCxlPXRoaXMucGFyYW1zLGY9ZS5sZW5ndGgsZz10aGlzLnNlZ21lbnRzLmxlbmd0aC0xLGg9e307aWYoZyE9PWMubGVuZ3RoLTEpdGhyb3cgbmV3IEVycm9yKFwiVW5iYWxhbmNlZCBjYXB0dXJlIGdyb3VwIGluIHJvdXRlICdcIit0aGlzLnNvdXJjZStcIidcIik7Zm9yKGQ9MDtnPmQ7ZCsrKWhbZVtkXV09Y1tkKzFdO2Zvcig7Zj5kO2QrKyloW2VbZF1dPWJbZVtkXV07cmV0dXJuIGh9LG4ucHJvdG90eXBlLnBhcmFtZXRlcnM9ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5wYXJhbXN9LG4ucHJvdG90eXBlLmZvcm1hdD1mdW5jdGlvbihhKXt2YXIgYj10aGlzLnNlZ21lbnRzLGM9dGhpcy5wYXJhbXM7aWYoIWEpcmV0dXJuIGIuam9pbihcIlwiKTt2YXIgZCxlLGYsZz1iLmxlbmd0aC0xLGg9Yy5sZW5ndGgsaT1iWzBdO2ZvcihkPTA7Zz5kO2QrKylmPWFbY1tkXV0sbnVsbCE9ZiYmKGkrPWVuY29kZVVSSUNvbXBvbmVudChmKSksaSs9YltkKzFdO2Zvcig7aD5kO2QrKylmPWFbY1tkXV0sbnVsbCE9ZiYmKGkrPShlP1wiJlwiOlwiP1wiKStjW2RdK1wiPVwiK2VuY29kZVVSSUNvbXBvbmVudChmKSxlPSEwKTtyZXR1cm4gaX0sYi5tb2R1bGUoXCJ1aS5yb3V0ZXIudXRpbFwiKS5wcm92aWRlcihcIiR1cmxNYXRjaGVyRmFjdG9yeVwiLG8pLHAuJGluamVjdD1bXCIkdXJsTWF0Y2hlckZhY3RvcnlQcm92aWRlclwiXSxiLm1vZHVsZShcInVpLnJvdXRlci5yb3V0ZXJcIikucHJvdmlkZXIoXCIkdXJsUm91dGVyXCIscCkscS4kaW5qZWN0PVtcIiR1cmxSb3V0ZXJQcm92aWRlclwiLFwiJHVybE1hdGNoZXJGYWN0b3J5UHJvdmlkZXJcIixcIiRsb2NhdGlvblByb3ZpZGVyXCJdLGIubW9kdWxlKFwidWkucm91dGVyLnN0YXRlXCIpLnZhbHVlKFwiJHN0YXRlUGFyYW1zXCIse30pLnByb3ZpZGVyKFwiJHN0YXRlXCIscSksci4kaW5qZWN0PVtdLGIubW9kdWxlKFwidWkucm91dGVyLnN0YXRlXCIpLnByb3ZpZGVyKFwiJHZpZXdcIixyKSxiLm1vZHVsZShcInVpLnJvdXRlci5zdGF0ZVwiKS5wcm92aWRlcihcIiR1aVZpZXdTY3JvbGxcIixzKSx0LiRpbmplY3Q9W1wiJHN0YXRlXCIsXCIkaW5qZWN0b3JcIixcIiR1aVZpZXdTY3JvbGxcIl0sdS4kaW5qZWN0PVtcIiRjb21waWxlXCIsXCIkY29udHJvbGxlclwiLFwiJHN0YXRlXCJdLGIubW9kdWxlKFwidWkucm91dGVyLnN0YXRlXCIpLmRpcmVjdGl2ZShcInVpVmlld1wiLHQpLGIubW9kdWxlKFwidWkucm91dGVyLnN0YXRlXCIpLmRpcmVjdGl2ZShcInVpVmlld1wiLHUpLHguJGluamVjdD1bXCIkc3RhdGVcIixcIiR0aW1lb3V0XCJdLHkuJGluamVjdD1bXCIkc3RhdGVcIixcIiRzdGF0ZVBhcmFtc1wiLFwiJGludGVycG9sYXRlXCJdLGIubW9kdWxlKFwidWkucm91dGVyLnN0YXRlXCIpLmRpcmVjdGl2ZShcInVpU3JlZlwiLHgpLmRpcmVjdGl2ZShcInVpU3JlZkFjdGl2ZVwiLHkpLHouJGluamVjdD1bXCIkc3RhdGVcIl0sQS4kaW5qZWN0PVtcIiRzdGF0ZVwiXSxiLm1vZHVsZShcInVpLnJvdXRlci5zdGF0ZVwiKS5maWx0ZXIoXCJpc1N0YXRlXCIseikuZmlsdGVyKFwiaW5jbHVkZWRCeVN0YXRlXCIsQSksQi4kaW5qZWN0PVtcIiRzdGF0ZVByb3ZpZGVyXCIsXCIkdXJsUm91dGVyUHJvdmlkZXJcIl0sYi5tb2R1bGUoXCJ1aS5yb3V0ZXIuY29tcGF0XCIpLnByb3ZpZGVyKFwiJHJvdXRlXCIsQikuZGlyZWN0aXZlKFwibmdWaWV3XCIsdCl9KHdpbmRvdyx3aW5kb3cuYW5ndWxhcik7XG59KS5jYWxsKGdsb2JhbCwgbW9kdWxlLCB1bmRlZmluZWQsIHVuZGVmaW5lZCk7XG5cbn0pLmNhbGwodGhpcyx0eXBlb2YgZ2xvYmFsICE9PSBcInVuZGVmaW5lZFwiID8gZ2xvYmFsIDogdHlwZW9mIHNlbGYgIT09IFwidW5kZWZpbmVkXCIgPyBzZWxmIDogdHlwZW9mIHdpbmRvdyAhPT0gXCJ1bmRlZmluZWRcIiA/IHdpbmRvdyA6IHt9KSIsIihmdW5jdGlvbiAoZ2xvYmFsKXtcbjtfX2Jyb3dzZXJpZnlfc2hpbV9yZXF1aXJlX189cmVxdWlyZTsoZnVuY3Rpb24gYnJvd3NlcmlmeVNoaW0obW9kdWxlLCBleHBvcnRzLCByZXF1aXJlLCBkZWZpbmUsIGJyb3dzZXJpZnlfc2hpbV9fZGVmaW5lX19tb2R1bGVfX2V4cG9ydF9fKSB7XG4vKlxuIEFuZ3VsYXJKUyB2MS4yLjI2XG4gKGMpIDIwMTAtMjAxNCBHb29nbGUsIEluYy4gaHR0cDovL2FuZ3VsYXJqcy5vcmdcbiBMaWNlbnNlOiBNSVRcbiovXG4oZnVuY3Rpb24oVyxYLHQpeyd1c2Ugc3RyaWN0JztmdW5jdGlvbiBDKGIpe3JldHVybiBmdW5jdGlvbigpe3ZhciBhPWFyZ3VtZW50c1swXSxjLGE9XCJbXCIrKGI/YitcIjpcIjpcIlwiKSthK1wiXSBodHRwOi8vZXJyb3JzLmFuZ3VsYXJqcy5vcmcvMS4yLjI2L1wiKyhiP2IrXCIvXCI6XCJcIikrYTtmb3IoYz0xO2M8YXJndW1lbnRzLmxlbmd0aDtjKyspYT1hKygxPT1jP1wiP1wiOlwiJlwiKStcInBcIisoYy0xKStcIj1cIitlbmNvZGVVUklDb21wb25lbnQoXCJmdW5jdGlvblwiPT10eXBlb2YgYXJndW1lbnRzW2NdP2FyZ3VtZW50c1tjXS50b1N0cmluZygpLnJlcGxhY2UoLyBcXHtbXFxzXFxTXSokLyxcIlwiKTpcInVuZGVmaW5lZFwiPT10eXBlb2YgYXJndW1lbnRzW2NdP1widW5kZWZpbmVkXCI6XCJzdHJpbmdcIiE9dHlwZW9mIGFyZ3VtZW50c1tjXT9KU09OLnN0cmluZ2lmeShhcmd1bWVudHNbY10pOmFyZ3VtZW50c1tjXSk7cmV0dXJuIEVycm9yKGEpfX1mdW5jdGlvbiBQYShiKXtpZihudWxsPT1ifHxHYShiKSlyZXR1cm4hMTtcbnZhciBhPWIubGVuZ3RoO3JldHVybiAxPT09Yi5ub2RlVHlwZSYmYT8hMDp2KGIpfHxKKGIpfHwwPT09YXx8XCJudW1iZXJcIj09PXR5cGVvZiBhJiYwPGEmJmEtMSBpbiBifWZ1bmN0aW9uIHIoYixhLGMpe3ZhciBkO2lmKGIpaWYoUChiKSlmb3IoZCBpbiBiKVwicHJvdG90eXBlXCI9PWR8fChcImxlbmd0aFwiPT1kfHxcIm5hbWVcIj09ZHx8Yi5oYXNPd25Qcm9wZXJ0eSYmIWIuaGFzT3duUHJvcGVydHkoZCkpfHxhLmNhbGwoYyxiW2RdLGQpO2Vsc2UgaWYoSihiKXx8UGEoYikpZm9yKGQ9MDtkPGIubGVuZ3RoO2QrKylhLmNhbGwoYyxiW2RdLGQpO2Vsc2UgaWYoYi5mb3JFYWNoJiZiLmZvckVhY2ghPT1yKWIuZm9yRWFjaChhLGMpO2Vsc2UgZm9yKGQgaW4gYiliLmhhc093blByb3BlcnR5KGQpJiZhLmNhbGwoYyxiW2RdLGQpO3JldHVybiBifWZ1bmN0aW9uIFpiKGIpe3ZhciBhPVtdLGM7Zm9yKGMgaW4gYiliLmhhc093blByb3BlcnR5KGMpJiZhLnB1c2goYyk7cmV0dXJuIGEuc29ydCgpfWZ1bmN0aW9uIFRjKGIsXG5hLGMpe2Zvcih2YXIgZD1aYihiKSxlPTA7ZTxkLmxlbmd0aDtlKyspYS5jYWxsKGMsYltkW2VdXSxkW2VdKTtyZXR1cm4gZH1mdW5jdGlvbiAkYihiKXtyZXR1cm4gZnVuY3Rpb24oYSxjKXtiKGMsYSl9fWZ1bmN0aW9uIGhiKCl7Zm9yKHZhciBiPW1hLmxlbmd0aCxhO2I7KXtiLS07YT1tYVtiXS5jaGFyQ29kZUF0KDApO2lmKDU3PT1hKXJldHVybiBtYVtiXT1cIkFcIixtYS5qb2luKFwiXCIpO2lmKDkwPT1hKW1hW2JdPVwiMFwiO2Vsc2UgcmV0dXJuIG1hW2JdPVN0cmluZy5mcm9tQ2hhckNvZGUoYSsxKSxtYS5qb2luKFwiXCIpfW1hLnVuc2hpZnQoXCIwXCIpO3JldHVybiBtYS5qb2luKFwiXCIpfWZ1bmN0aW9uIGFjKGIsYSl7YT9iLiQkaGFzaEtleT1hOmRlbGV0ZSBiLiQkaGFzaEtleX1mdW5jdGlvbiBEKGIpe3ZhciBhPWIuJCRoYXNoS2V5O3IoYXJndW1lbnRzLGZ1bmN0aW9uKGEpe2EhPT1iJiZyKGEsZnVuY3Rpb24oYSxjKXtiW2NdPWF9KX0pO2FjKGIsYSk7cmV0dXJuIGJ9ZnVuY3Rpb24gVShiKXtyZXR1cm4gcGFyc2VJbnQoYixcbjEwKX1mdW5jdGlvbiBiYyhiLGEpe3JldHVybiBEKG5ldyAoRChmdW5jdGlvbigpe30se3Byb3RvdHlwZTpifSkpLGEpfWZ1bmN0aW9uIEUoKXt9ZnVuY3Rpb24gUWEoYil7cmV0dXJuIGJ9ZnVuY3Rpb24gYmEoYil7cmV0dXJuIGZ1bmN0aW9uKCl7cmV0dXJuIGJ9fWZ1bmN0aW9uIHgoYil7cmV0dXJuXCJ1bmRlZmluZWRcIj09PXR5cGVvZiBifWZ1bmN0aW9uIHkoYil7cmV0dXJuXCJ1bmRlZmluZWRcIiE9PXR5cGVvZiBifWZ1bmN0aW9uIFQoYil7cmV0dXJuIG51bGwhPWImJlwib2JqZWN0XCI9PT10eXBlb2YgYn1mdW5jdGlvbiB2KGIpe3JldHVyblwic3RyaW5nXCI9PT10eXBlb2YgYn1mdW5jdGlvbiBpYihiKXtyZXR1cm5cIm51bWJlclwiPT09dHlwZW9mIGJ9ZnVuY3Rpb24gdGEoYil7cmV0dXJuXCJbb2JqZWN0IERhdGVdXCI9PT16YS5jYWxsKGIpfWZ1bmN0aW9uIFAoYil7cmV0dXJuXCJmdW5jdGlvblwiPT09dHlwZW9mIGJ9ZnVuY3Rpb24gamIoYil7cmV0dXJuXCJbb2JqZWN0IFJlZ0V4cF1cIj09PXphLmNhbGwoYil9XG5mdW5jdGlvbiBHYShiKXtyZXR1cm4gYiYmYi5kb2N1bWVudCYmYi5sb2NhdGlvbiYmYi5hbGVydCYmYi5zZXRJbnRlcnZhbH1mdW5jdGlvbiBVYyhiKXtyZXR1cm4hKCFifHwhKGIubm9kZU5hbWV8fGIucHJvcCYmYi5hdHRyJiZiLmZpbmQpKX1mdW5jdGlvbiBWYyhiLGEsYyl7dmFyIGQ9W107cihiLGZ1bmN0aW9uKGIsZixnKXtkLnB1c2goYS5jYWxsKGMsYixmLGcpKX0pO3JldHVybiBkfWZ1bmN0aW9uIFJhKGIsYSl7aWYoYi5pbmRleE9mKXJldHVybiBiLmluZGV4T2YoYSk7Zm9yKHZhciBjPTA7YzxiLmxlbmd0aDtjKyspaWYoYT09PWJbY10pcmV0dXJuIGM7cmV0dXJuLTF9ZnVuY3Rpb24gU2EoYixhKXt2YXIgYz1SYShiLGEpOzA8PWMmJmIuc3BsaWNlKGMsMSk7cmV0dXJuIGF9ZnVuY3Rpb24gSGEoYixhLGMsZCl7aWYoR2EoYil8fGImJmIuJGV2YWxBc3luYyYmYi4kd2F0Y2gpdGhyb3cgVGEoXCJjcHdzXCIpO2lmKGEpe2lmKGI9PT1hKXRocm93IFRhKFwiY3BpXCIpO2M9Y3x8W107XG5kPWR8fFtdO2lmKFQoYikpe3ZhciBlPVJhKGMsYik7aWYoLTEhPT1lKXJldHVybiBkW2VdO2MucHVzaChiKTtkLnB1c2goYSl9aWYoSihiKSlmb3IodmFyIGY9YS5sZW5ndGg9MDtmPGIubGVuZ3RoO2YrKyllPUhhKGJbZl0sbnVsbCxjLGQpLFQoYltmXSkmJihjLnB1c2goYltmXSksZC5wdXNoKGUpKSxhLnB1c2goZSk7ZWxzZXt2YXIgZz1hLiQkaGFzaEtleTtKKGEpP2EubGVuZ3RoPTA6cihhLGZ1bmN0aW9uKGIsYyl7ZGVsZXRlIGFbY119KTtmb3IoZiBpbiBiKWU9SGEoYltmXSxudWxsLGMsZCksVChiW2ZdKSYmKGMucHVzaChiW2ZdKSxkLnB1c2goZSkpLGFbZl09ZTthYyhhLGcpfX1lbHNlIGlmKGE9YilKKGIpP2E9SGEoYixbXSxjLGQpOnRhKGIpP2E9bmV3IERhdGUoYi5nZXRUaW1lKCkpOmpiKGIpPyhhPVJlZ0V4cChiLnNvdXJjZSxiLnRvU3RyaW5nKCkubWF0Y2goL1teXFwvXSokLylbMF0pLGEubGFzdEluZGV4PWIubGFzdEluZGV4KTpUKGIpJiYoYT1IYShiLHt9LGMsZCkpO1xucmV0dXJuIGF9ZnVuY3Rpb24gaGEoYixhKXtpZihKKGIpKXthPWF8fFtdO2Zvcih2YXIgYz0wO2M8Yi5sZW5ndGg7YysrKWFbY109YltjXX1lbHNlIGlmKFQoYikpZm9yKGMgaW4gYT1hfHx7fSxiKSFrYi5jYWxsKGIsYyl8fFwiJFwiPT09Yy5jaGFyQXQoMCkmJlwiJFwiPT09Yy5jaGFyQXQoMSl8fChhW2NdPWJbY10pO3JldHVybiBhfHxifWZ1bmN0aW9uIEFhKGIsYSl7aWYoYj09PWEpcmV0dXJuITA7aWYobnVsbD09PWJ8fG51bGw9PT1hKXJldHVybiExO2lmKGIhPT1iJiZhIT09YSlyZXR1cm4hMDt2YXIgYz10eXBlb2YgYixkO2lmKGM9PXR5cGVvZiBhJiZcIm9iamVjdFwiPT1jKWlmKEooYikpe2lmKCFKKGEpKXJldHVybiExO2lmKChjPWIubGVuZ3RoKT09YS5sZW5ndGgpe2ZvcihkPTA7ZDxjO2QrKylpZighQWEoYltkXSxhW2RdKSlyZXR1cm4hMTtyZXR1cm4hMH19ZWxzZXtpZih0YShiKSlyZXR1cm4gdGEoYSk/aXNOYU4oYi5nZXRUaW1lKCkpJiZpc05hTihhLmdldFRpbWUoKSl8fGIuZ2V0VGltZSgpPT09XG5hLmdldFRpbWUoKTohMTtpZihqYihiKSYmamIoYSkpcmV0dXJuIGIudG9TdHJpbmcoKT09YS50b1N0cmluZygpO2lmKGImJmIuJGV2YWxBc3luYyYmYi4kd2F0Y2h8fGEmJmEuJGV2YWxBc3luYyYmYS4kd2F0Y2h8fEdhKGIpfHxHYShhKXx8SihhKSlyZXR1cm4hMTtjPXt9O2ZvcihkIGluIGIpaWYoXCIkXCIhPT1kLmNoYXJBdCgwKSYmIVAoYltkXSkpe2lmKCFBYShiW2RdLGFbZF0pKXJldHVybiExO2NbZF09ITB9Zm9yKGQgaW4gYSlpZighYy5oYXNPd25Qcm9wZXJ0eShkKSYmXCIkXCIhPT1kLmNoYXJBdCgwKSYmYVtkXSE9PXQmJiFQKGFbZF0pKXJldHVybiExO3JldHVybiEwfXJldHVybiExfWZ1bmN0aW9uIEJiKGIsYSl7dmFyIGM9Mjxhcmd1bWVudHMubGVuZ3RoP0JhLmNhbGwoYXJndW1lbnRzLDIpOltdO3JldHVybiFQKGEpfHxhIGluc3RhbmNlb2YgUmVnRXhwP2E6Yy5sZW5ndGg/ZnVuY3Rpb24oKXtyZXR1cm4gYXJndW1lbnRzLmxlbmd0aD9hLmFwcGx5KGIsYy5jb25jYXQoQmEuY2FsbChhcmd1bWVudHMsXG4wKSkpOmEuYXBwbHkoYixjKX06ZnVuY3Rpb24oKXtyZXR1cm4gYXJndW1lbnRzLmxlbmd0aD9hLmFwcGx5KGIsYXJndW1lbnRzKTphLmNhbGwoYil9fWZ1bmN0aW9uIFdjKGIsYSl7dmFyIGM9YTtcInN0cmluZ1wiPT09dHlwZW9mIGImJlwiJFwiPT09Yi5jaGFyQXQoMCk/Yz10OkdhKGEpP2M9XCIkV0lORE9XXCI6YSYmWD09PWE/Yz1cIiRET0NVTUVOVFwiOmEmJihhLiRldmFsQXN5bmMmJmEuJHdhdGNoKSYmKGM9XCIkU0NPUEVcIik7cmV0dXJuIGN9ZnVuY3Rpb24gbmEoYixhKXtyZXR1cm5cInVuZGVmaW5lZFwiPT09dHlwZW9mIGI/dDpKU09OLnN0cmluZ2lmeShiLFdjLGE/XCIgIFwiOm51bGwpfWZ1bmN0aW9uIGNjKGIpe3JldHVybiB2KGIpP0pTT04ucGFyc2UoYik6Yn1mdW5jdGlvbiBVYShiKXtcImZ1bmN0aW9uXCI9PT10eXBlb2YgYj9iPSEwOmImJjAhPT1iLmxlbmd0aD8oYj1LKFwiXCIrYiksYj0hKFwiZlwiPT1ifHxcIjBcIj09Ynx8XCJmYWxzZVwiPT1ifHxcIm5vXCI9PWJ8fFwiblwiPT1ifHxcIltdXCI9PWIpKTpiPSExO1xucmV0dXJuIGJ9ZnVuY3Rpb24gaWEoYil7Yj13KGIpLmNsb25lKCk7dHJ5e2IuZW1wdHkoKX1jYXRjaChhKXt9dmFyIGM9dyhcIjxkaXY+XCIpLmFwcGVuZChiKS5odG1sKCk7dHJ5e3JldHVybiAzPT09YlswXS5ub2RlVHlwZT9LKGMpOmMubWF0Y2goL14oPFtePl0rPikvKVsxXS5yZXBsYWNlKC9ePChbXFx3XFwtXSspLyxmdW5jdGlvbihhLGIpe3JldHVyblwiPFwiK0soYil9KX1jYXRjaChkKXtyZXR1cm4gSyhjKX19ZnVuY3Rpb24gZGMoYil7dHJ5e3JldHVybiBkZWNvZGVVUklDb21wb25lbnQoYil9Y2F0Y2goYSl7fX1mdW5jdGlvbiBlYyhiKXt2YXIgYT17fSxjLGQ7cigoYnx8XCJcIikuc3BsaXQoXCImXCIpLGZ1bmN0aW9uKGIpe2ImJihjPWIucmVwbGFjZSgvXFwrL2csXCIlMjBcIikuc3BsaXQoXCI9XCIpLGQ9ZGMoY1swXSkseShkKSYmKGI9eShjWzFdKT9kYyhjWzFdKTohMCxrYi5jYWxsKGEsZCk/SihhW2RdKT9hW2RdLnB1c2goYik6YVtkXT1bYVtkXSxiXTphW2RdPWIpKX0pO3JldHVybiBhfWZ1bmN0aW9uIENiKGIpe3ZhciBhPVxuW107cihiLGZ1bmN0aW9uKGIsZCl7SihiKT9yKGIsZnVuY3Rpb24oYil7YS5wdXNoKENhKGQsITApKyghMD09PWI/XCJcIjpcIj1cIitDYShiLCEwKSkpfSk6YS5wdXNoKENhKGQsITApKyghMD09PWI/XCJcIjpcIj1cIitDYShiLCEwKSkpfSk7cmV0dXJuIGEubGVuZ3RoP2Euam9pbihcIiZcIik6XCJcIn1mdW5jdGlvbiBsYihiKXtyZXR1cm4gQ2EoYiwhMCkucmVwbGFjZSgvJTI2L2dpLFwiJlwiKS5yZXBsYWNlKC8lM0QvZ2ksXCI9XCIpLnJlcGxhY2UoLyUyQi9naSxcIitcIil9ZnVuY3Rpb24gQ2EoYixhKXtyZXR1cm4gZW5jb2RlVVJJQ29tcG9uZW50KGIpLnJlcGxhY2UoLyU0MC9naSxcIkBcIikucmVwbGFjZSgvJTNBL2dpLFwiOlwiKS5yZXBsYWNlKC8lMjQvZyxcIiRcIikucmVwbGFjZSgvJTJDL2dpLFwiLFwiKS5yZXBsYWNlKC8lMjAvZyxhP1wiJTIwXCI6XCIrXCIpfWZ1bmN0aW9uIFhjKGIsYSl7ZnVuY3Rpb24gYyhhKXthJiZkLnB1c2goYSl9dmFyIGQ9W2JdLGUsZixnPVtcIm5nOmFwcFwiLFwibmctYXBwXCIsXCJ4LW5nLWFwcFwiLFxuXCJkYXRhLW5nLWFwcFwiXSxrPS9cXHNuZ1s6XFwtXWFwcCg6XFxzKihbXFx3XFxkX10rKTs/KT9cXHMvO3IoZyxmdW5jdGlvbihhKXtnW2FdPSEwO2MoWC5nZXRFbGVtZW50QnlJZChhKSk7YT1hLnJlcGxhY2UoXCI6XCIsXCJcXFxcOlwiKTtiLnF1ZXJ5U2VsZWN0b3JBbGwmJihyKGIucXVlcnlTZWxlY3RvckFsbChcIi5cIithKSxjKSxyKGIucXVlcnlTZWxlY3RvckFsbChcIi5cIithK1wiXFxcXDpcIiksYykscihiLnF1ZXJ5U2VsZWN0b3JBbGwoXCJbXCIrYStcIl1cIiksYykpfSk7cihkLGZ1bmN0aW9uKGEpe2lmKCFlKXt2YXIgYj1rLmV4ZWMoXCIgXCIrYS5jbGFzc05hbWUrXCIgXCIpO2I/KGU9YSxmPShiWzJdfHxcIlwiKS5yZXBsYWNlKC9cXHMrL2csXCIsXCIpKTpyKGEuYXR0cmlidXRlcyxmdW5jdGlvbihiKXshZSYmZ1tiLm5hbWVdJiYoZT1hLGY9Yi52YWx1ZSl9KX19KTtlJiZhKGUsZj9bZl06W10pfWZ1bmN0aW9uIGZjKGIsYSl7dmFyIGM9ZnVuY3Rpb24oKXtiPXcoYik7aWYoYi5pbmplY3RvcigpKXt2YXIgYz1iWzBdPT09WD9cblwiZG9jdW1lbnRcIjppYShiKTt0aHJvdyBUYShcImJ0c3RycGRcIixjLnJlcGxhY2UoLzwvLFwiJmx0O1wiKS5yZXBsYWNlKC8+LyxcIiZndDtcIikpO31hPWF8fFtdO2EudW5zaGlmdChbXCIkcHJvdmlkZVwiLGZ1bmN0aW9uKGEpe2EudmFsdWUoXCIkcm9vdEVsZW1lbnRcIixiKX1dKTthLnVuc2hpZnQoXCJuZ1wiKTtjPWdjKGEpO2MuaW52b2tlKFtcIiRyb290U2NvcGVcIixcIiRyb290RWxlbWVudFwiLFwiJGNvbXBpbGVcIixcIiRpbmplY3RvclwiLFwiJGFuaW1hdGVcIixmdW5jdGlvbihhLGIsYyxkLGUpe2EuJGFwcGx5KGZ1bmN0aW9uKCl7Yi5kYXRhKFwiJGluamVjdG9yXCIsZCk7YyhiKShhKX0pfV0pO3JldHVybiBjfSxkPS9eTkdfREVGRVJfQk9PVFNUUkFQIS87aWYoVyYmIWQudGVzdChXLm5hbWUpKXJldHVybiBjKCk7Vy5uYW1lPVcubmFtZS5yZXBsYWNlKGQsXCJcIik7VmEucmVzdW1lQm9vdHN0cmFwPWZ1bmN0aW9uKGIpe3IoYixmdW5jdGlvbihiKXthLnB1c2goYil9KTtjKCl9fWZ1bmN0aW9uIG1iKGIsYSl7YT1cbmF8fFwiX1wiO3JldHVybiBiLnJlcGxhY2UoWWMsZnVuY3Rpb24oYixkKXtyZXR1cm4oZD9hOlwiXCIpK2IudG9Mb3dlckNhc2UoKX0pfWZ1bmN0aW9uIERiKGIsYSxjKXtpZighYil0aHJvdyBUYShcImFyZXFcIixhfHxcIj9cIixjfHxcInJlcXVpcmVkXCIpO3JldHVybiBifWZ1bmN0aW9uIFdhKGIsYSxjKXtjJiZKKGIpJiYoYj1iW2IubGVuZ3RoLTFdKTtEYihQKGIpLGEsXCJub3QgYSBmdW5jdGlvbiwgZ290IFwiKyhiJiZcIm9iamVjdFwiPT09dHlwZW9mIGI/Yi5jb25zdHJ1Y3Rvci5uYW1lfHxcIk9iamVjdFwiOnR5cGVvZiBiKSk7cmV0dXJuIGJ9ZnVuY3Rpb24gRGEoYixhKXtpZihcImhhc093blByb3BlcnR5XCI9PT1iKXRocm93IFRhKFwiYmFkbmFtZVwiLGEpO31mdW5jdGlvbiBoYyhiLGEsYyl7aWYoIWEpcmV0dXJuIGI7YT1hLnNwbGl0KFwiLlwiKTtmb3IodmFyIGQsZT1iLGY9YS5sZW5ndGgsZz0wO2c8ZjtnKyspZD1hW2ddLGImJihiPShlPWIpW2RdKTtyZXR1cm4hYyYmUChiKT9CYihlLGIpOmJ9ZnVuY3Rpb24gRWIoYil7dmFyIGE9XG5iWzBdO2I9YltiLmxlbmd0aC0xXTtpZihhPT09YilyZXR1cm4gdyhhKTt2YXIgYz1bYV07ZG97YT1hLm5leHRTaWJsaW5nO2lmKCFhKWJyZWFrO2MucHVzaChhKX13aGlsZShhIT09Yik7cmV0dXJuIHcoYyl9ZnVuY3Rpb24gWmMoYil7dmFyIGE9QyhcIiRpbmplY3RvclwiKSxjPUMoXCJuZ1wiKTtiPWIuYW5ndWxhcnx8KGIuYW5ndWxhcj17fSk7Yi4kJG1pbkVycj1iLiQkbWluRXJyfHxDO3JldHVybiBiLm1vZHVsZXx8KGIubW9kdWxlPWZ1bmN0aW9uKCl7dmFyIGI9e307cmV0dXJuIGZ1bmN0aW9uKGUsZixnKXtpZihcImhhc093blByb3BlcnR5XCI9PT1lKXRocm93IGMoXCJiYWRuYW1lXCIsXCJtb2R1bGVcIik7ZiYmYi5oYXNPd25Qcm9wZXJ0eShlKSYmKGJbZV09bnVsbCk7cmV0dXJuIGJbZV18fChiW2VdPWZ1bmN0aW9uKCl7ZnVuY3Rpb24gYihhLGQsZSl7cmV0dXJuIGZ1bmN0aW9uKCl7Y1tlfHxcInB1c2hcIl0oW2EsZCxhcmd1bWVudHNdKTtyZXR1cm4gbn19aWYoIWYpdGhyb3cgYShcIm5vbW9kXCIsXG5lKTt2YXIgYz1bXSxkPVtdLGw9YihcIiRpbmplY3RvclwiLFwiaW52b2tlXCIpLG49e19pbnZva2VRdWV1ZTpjLF9ydW5CbG9ja3M6ZCxyZXF1aXJlczpmLG5hbWU6ZSxwcm92aWRlcjpiKFwiJHByb3ZpZGVcIixcInByb3ZpZGVyXCIpLGZhY3Rvcnk6YihcIiRwcm92aWRlXCIsXCJmYWN0b3J5XCIpLHNlcnZpY2U6YihcIiRwcm92aWRlXCIsXCJzZXJ2aWNlXCIpLHZhbHVlOmIoXCIkcHJvdmlkZVwiLFwidmFsdWVcIiksY29uc3RhbnQ6YihcIiRwcm92aWRlXCIsXCJjb25zdGFudFwiLFwidW5zaGlmdFwiKSxhbmltYXRpb246YihcIiRhbmltYXRlUHJvdmlkZXJcIixcInJlZ2lzdGVyXCIpLGZpbHRlcjpiKFwiJGZpbHRlclByb3ZpZGVyXCIsXCJyZWdpc3RlclwiKSxjb250cm9sbGVyOmIoXCIkY29udHJvbGxlclByb3ZpZGVyXCIsXCJyZWdpc3RlclwiKSxkaXJlY3RpdmU6YihcIiRjb21waWxlUHJvdmlkZXJcIixcImRpcmVjdGl2ZVwiKSxjb25maWc6bCxydW46ZnVuY3Rpb24oYSl7ZC5wdXNoKGEpO3JldHVybiB0aGlzfX07ZyYmbChnKTtyZXR1cm4gbn0oKSl9fSgpKX1cbmZ1bmN0aW9uICRjKGIpe0QoYix7Ym9vdHN0cmFwOmZjLGNvcHk6SGEsZXh0ZW5kOkQsZXF1YWxzOkFhLGVsZW1lbnQ6dyxmb3JFYWNoOnIsaW5qZWN0b3I6Z2Msbm9vcDpFLGJpbmQ6QmIsdG9Kc29uOm5hLGZyb21Kc29uOmNjLGlkZW50aXR5OlFhLGlzVW5kZWZpbmVkOngsaXNEZWZpbmVkOnksaXNTdHJpbmc6dixpc0Z1bmN0aW9uOlAsaXNPYmplY3Q6VCxpc051bWJlcjppYixpc0VsZW1lbnQ6VWMsaXNBcnJheTpKLHZlcnNpb246YWQsaXNEYXRlOnRhLGxvd2VyY2FzZTpLLHVwcGVyY2FzZTpJYSxjYWxsYmFja3M6e2NvdW50ZXI6MH0sJCRtaW5FcnI6QywkJGNzcDpYYX0pO1lhPVpjKFcpO3RyeXtZYShcIm5nTG9jYWxlXCIpfWNhdGNoKGEpe1lhKFwibmdMb2NhbGVcIixbXSkucHJvdmlkZXIoXCIkbG9jYWxlXCIsYmQpfVlhKFwibmdcIixbXCJuZ0xvY2FsZVwiXSxbXCIkcHJvdmlkZVwiLGZ1bmN0aW9uKGEpe2EucHJvdmlkZXIoeyQkc2FuaXRpemVVcmk6Y2R9KTthLnByb3ZpZGVyKFwiJGNvbXBpbGVcIixcbmljKS5kaXJlY3RpdmUoe2E6ZGQsaW5wdXQ6amMsdGV4dGFyZWE6amMsZm9ybTplZCxzY3JpcHQ6ZmQsc2VsZWN0OmdkLHN0eWxlOmhkLG9wdGlvbjppZCxuZ0JpbmQ6amQsbmdCaW5kSHRtbDprZCxuZ0JpbmRUZW1wbGF0ZTpsZCxuZ0NsYXNzOm1kLG5nQ2xhc3NFdmVuOm5kLG5nQ2xhc3NPZGQ6b2QsbmdDbG9hazpwZCxuZ0NvbnRyb2xsZXI6cWQsbmdGb3JtOnJkLG5nSGlkZTpzZCxuZ0lmOnRkLG5nSW5jbHVkZTp1ZCxuZ0luaXQ6dmQsbmdOb25CaW5kYWJsZTp3ZCxuZ1BsdXJhbGl6ZTp4ZCxuZ1JlcGVhdDp5ZCxuZ1Nob3c6emQsbmdTdHlsZTpBZCxuZ1N3aXRjaDpCZCxuZ1N3aXRjaFdoZW46Q2QsbmdTd2l0Y2hEZWZhdWx0OkRkLG5nT3B0aW9uczpFZCxuZ1RyYW5zY2x1ZGU6RmQsbmdNb2RlbDpHZCxuZ0xpc3Q6SGQsbmdDaGFuZ2U6SWQscmVxdWlyZWQ6a2MsbmdSZXF1aXJlZDprYyxuZ1ZhbHVlOkpkfSkuZGlyZWN0aXZlKHtuZ0luY2x1ZGU6S2R9KS5kaXJlY3RpdmUoRmIpLmRpcmVjdGl2ZShsYyk7XG5hLnByb3ZpZGVyKHskYW5jaG9yU2Nyb2xsOkxkLCRhbmltYXRlOk1kLCRicm93c2VyOk5kLCRjYWNoZUZhY3Rvcnk6T2QsJGNvbnRyb2xsZXI6UGQsJGRvY3VtZW50OlFkLCRleGNlcHRpb25IYW5kbGVyOlJkLCRmaWx0ZXI6bWMsJGludGVycG9sYXRlOlNkLCRpbnRlcnZhbDpUZCwkaHR0cDpVZCwkaHR0cEJhY2tlbmQ6VmQsJGxvY2F0aW9uOldkLCRsb2c6WGQsJHBhcnNlOllkLCRyb290U2NvcGU6WmQsJHE6JGQsJHNjZTphZSwkc2NlRGVsZWdhdGU6YmUsJHNuaWZmZXI6Y2UsJHRlbXBsYXRlQ2FjaGU6ZGUsJHRpbWVvdXQ6ZWUsJHdpbmRvdzpmZSwkJHJBRjpnZSwkJGFzeW5jQ2FsbGJhY2s6aGV9KX1dKX1mdW5jdGlvbiBaYShiKXtyZXR1cm4gYi5yZXBsYWNlKGllLGZ1bmN0aW9uKGEsYixkLGUpe3JldHVybiBlP2QudG9VcHBlckNhc2UoKTpkfSkucmVwbGFjZShqZSxcIk1veiQxXCIpfWZ1bmN0aW9uIEdiKGIsYSxjLGQpe2Z1bmN0aW9uIGUoYil7dmFyIGU9YyYmYj9bdGhpcy5maWx0ZXIoYildOlxuW3RoaXNdLG09YSxoLGwsbixwLHEscztpZighZHx8bnVsbCE9Yilmb3IoO2UubGVuZ3RoOylmb3IoaD1lLnNoaWZ0KCksbD0wLG49aC5sZW5ndGg7bDxuO2wrKylmb3IocD13KGhbbF0pLG0/cC50cmlnZ2VySGFuZGxlcihcIiRkZXN0cm95XCIpOm09IW0scT0wLHA9KHM9cC5jaGlsZHJlbigpKS5sZW5ndGg7cTxwO3ErKyllLnB1c2goRWEoc1txXSkpO3JldHVybiBmLmFwcGx5KHRoaXMsYXJndW1lbnRzKX12YXIgZj1FYS5mbltiXSxmPWYuJG9yaWdpbmFsfHxmO2UuJG9yaWdpbmFsPWY7RWEuZm5bYl09ZX1mdW5jdGlvbiBTKGIpe2lmKGIgaW5zdGFuY2VvZiBTKXJldHVybiBiO3YoYikmJihiPWFhKGIpKTtpZighKHRoaXMgaW5zdGFuY2VvZiBTKSl7aWYodihiKSYmXCI8XCIhPWIuY2hhckF0KDApKXRocm93IEhiKFwibm9zZWxcIik7cmV0dXJuIG5ldyBTKGIpfWlmKHYoYikpe3ZhciBhPWI7Yj1YO3ZhciBjO2lmKGM9a2UuZXhlYyhhKSliPVtiLmNyZWF0ZUVsZW1lbnQoY1sxXSldO2Vsc2V7dmFyIGQ9XG5iLGU7Yj1kLmNyZWF0ZURvY3VtZW50RnJhZ21lbnQoKTtjPVtdO2lmKEliLnRlc3QoYSkpe2Q9Yi5hcHBlbmRDaGlsZChkLmNyZWF0ZUVsZW1lbnQoXCJkaXZcIikpO2U9KGxlLmV4ZWMoYSl8fFtcIlwiLFwiXCJdKVsxXS50b0xvd2VyQ2FzZSgpO2U9ZWFbZV18fGVhLl9kZWZhdWx0O2QuaW5uZXJIVE1MPVwiPGRpdj4mIzE2MDs8L2Rpdj5cIitlWzFdK2EucmVwbGFjZShtZSxcIjwkMT48LyQyPlwiKStlWzJdO2QucmVtb3ZlQ2hpbGQoZC5maXJzdENoaWxkKTtmb3IoYT1lWzBdO2EtLTspZD1kLmxhc3RDaGlsZDthPTA7Zm9yKGU9ZC5jaGlsZE5vZGVzLmxlbmd0aDthPGU7KythKWMucHVzaChkLmNoaWxkTm9kZXNbYV0pO2Q9Yi5maXJzdENoaWxkO2QudGV4dENvbnRlbnQ9XCJcIn1lbHNlIGMucHVzaChkLmNyZWF0ZVRleHROb2RlKGEpKTtiLnRleHRDb250ZW50PVwiXCI7Yi5pbm5lckhUTUw9XCJcIjtiPWN9SmIodGhpcyxiKTt3KFguY3JlYXRlRG9jdW1lbnRGcmFnbWVudCgpKS5hcHBlbmQodGhpcyl9ZWxzZSBKYih0aGlzLFxuYil9ZnVuY3Rpb24gS2IoYil7cmV0dXJuIGIuY2xvbmVOb2RlKCEwKX1mdW5jdGlvbiBKYShiKXtMYihiKTt2YXIgYT0wO2ZvcihiPWIuY2hpbGROb2Rlc3x8W107YTxiLmxlbmd0aDthKyspSmEoYlthXSl9ZnVuY3Rpb24gbmMoYixhLGMsZCl7aWYoeShkKSl0aHJvdyBIYihcIm9mZmFyZ3NcIik7dmFyIGU9b2EoYixcImV2ZW50c1wiKTtvYShiLFwiaGFuZGxlXCIpJiYoeChhKT9yKGUsZnVuY3Rpb24oYSxjKXskYShiLGMsYSk7ZGVsZXRlIGVbY119KTpyKGEuc3BsaXQoXCIgXCIpLGZ1bmN0aW9uKGEpe3goYyk/KCRhKGIsYSxlW2FdKSxkZWxldGUgZVthXSk6U2EoZVthXXx8W10sYyl9KSl9ZnVuY3Rpb24gTGIoYixhKXt2YXIgYz1iLm5nMzM5LGQ9YWJbY107ZCYmKGE/ZGVsZXRlIGFiW2NdLmRhdGFbYV06KGQuaGFuZGxlJiYoZC5ldmVudHMuJGRlc3Ryb3kmJmQuaGFuZGxlKHt9LFwiJGRlc3Ryb3lcIiksbmMoYikpLGRlbGV0ZSBhYltjXSxiLm5nMzM5PXQpKX1mdW5jdGlvbiBvYShiLGEsYyl7dmFyIGQ9XG5iLm5nMzM5LGQ9YWJbZHx8LTFdO2lmKHkoYykpZHx8KGIubmczMzk9ZD0rK25lLGQ9YWJbZF09e30pLGRbYV09YztlbHNlIHJldHVybiBkJiZkW2FdfWZ1bmN0aW9uIE1iKGIsYSxjKXt2YXIgZD1vYShiLFwiZGF0YVwiKSxlPXkoYyksZj0hZSYmeShhKSxnPWYmJiFUKGEpO2R8fGd8fG9hKGIsXCJkYXRhXCIsZD17fSk7aWYoZSlkW2FdPWM7ZWxzZSBpZihmKXtpZihnKXJldHVybiBkJiZkW2FdO0QoZCxhKX1lbHNlIHJldHVybiBkfWZ1bmN0aW9uIE5iKGIsYSl7cmV0dXJuIGIuZ2V0QXR0cmlidXRlPy0xPChcIiBcIisoYi5nZXRBdHRyaWJ1dGUoXCJjbGFzc1wiKXx8XCJcIikrXCIgXCIpLnJlcGxhY2UoL1tcXG5cXHRdL2csXCIgXCIpLmluZGV4T2YoXCIgXCIrYStcIiBcIik6ITF9ZnVuY3Rpb24gbmIoYixhKXthJiZiLnNldEF0dHJpYnV0ZSYmcihhLnNwbGl0KFwiIFwiKSxmdW5jdGlvbihhKXtiLnNldEF0dHJpYnV0ZShcImNsYXNzXCIsYWEoKFwiIFwiKyhiLmdldEF0dHJpYnV0ZShcImNsYXNzXCIpfHxcIlwiKStcIiBcIikucmVwbGFjZSgvW1xcblxcdF0vZyxcblwiIFwiKS5yZXBsYWNlKFwiIFwiK2FhKGEpK1wiIFwiLFwiIFwiKSkpfSl9ZnVuY3Rpb24gb2IoYixhKXtpZihhJiZiLnNldEF0dHJpYnV0ZSl7dmFyIGM9KFwiIFwiKyhiLmdldEF0dHJpYnV0ZShcImNsYXNzXCIpfHxcIlwiKStcIiBcIikucmVwbGFjZSgvW1xcblxcdF0vZyxcIiBcIik7cihhLnNwbGl0KFwiIFwiKSxmdW5jdGlvbihhKXthPWFhKGEpOy0xPT09Yy5pbmRleE9mKFwiIFwiK2ErXCIgXCIpJiYoYys9YStcIiBcIil9KTtiLnNldEF0dHJpYnV0ZShcImNsYXNzXCIsYWEoYykpfX1mdW5jdGlvbiBKYihiLGEpe2lmKGEpe2E9YS5ub2RlTmFtZXx8IXkoYS5sZW5ndGgpfHxHYShhKT9bYV06YTtmb3IodmFyIGM9MDtjPGEubGVuZ3RoO2MrKyliLnB1c2goYVtjXSl9fWZ1bmN0aW9uIG9jKGIsYSl7cmV0dXJuIHBiKGIsXCIkXCIrKGF8fFwibmdDb250cm9sbGVyXCIpK1wiQ29udHJvbGxlclwiKX1mdW5jdGlvbiBwYihiLGEsYyl7OT09Yi5ub2RlVHlwZSYmKGI9Yi5kb2N1bWVudEVsZW1lbnQpO2ZvcihhPUooYSk/YTpbYV07Yjspe2Zvcih2YXIgZD1cbjAsZT1hLmxlbmd0aDtkPGU7ZCsrKWlmKChjPXcuZGF0YShiLGFbZF0pKSE9PXQpcmV0dXJuIGM7Yj1iLnBhcmVudE5vZGV8fDExPT09Yi5ub2RlVHlwZSYmYi5ob3N0fX1mdW5jdGlvbiBwYyhiKXtmb3IodmFyIGE9MCxjPWIuY2hpbGROb2RlczthPGMubGVuZ3RoO2ErKylKYShjW2FdKTtmb3IoO2IuZmlyc3RDaGlsZDspYi5yZW1vdmVDaGlsZChiLmZpcnN0Q2hpbGQpfWZ1bmN0aW9uIHFjKGIsYSl7dmFyIGM9cWJbYS50b0xvd2VyQ2FzZSgpXTtyZXR1cm4gYyYmcmNbYi5ub2RlTmFtZV0mJmN9ZnVuY3Rpb24gb2UoYixhKXt2YXIgYz1mdW5jdGlvbihjLGUpe2MucHJldmVudERlZmF1bHR8fChjLnByZXZlbnREZWZhdWx0PWZ1bmN0aW9uKCl7Yy5yZXR1cm5WYWx1ZT0hMX0pO2Muc3RvcFByb3BhZ2F0aW9ufHwoYy5zdG9wUHJvcGFnYXRpb249ZnVuY3Rpb24oKXtjLmNhbmNlbEJ1YmJsZT0hMH0pO2MudGFyZ2V0fHwoYy50YXJnZXQ9Yy5zcmNFbGVtZW50fHxYKTtpZih4KGMuZGVmYXVsdFByZXZlbnRlZCkpe3ZhciBmPVxuYy5wcmV2ZW50RGVmYXVsdDtjLnByZXZlbnREZWZhdWx0PWZ1bmN0aW9uKCl7Yy5kZWZhdWx0UHJldmVudGVkPSEwO2YuY2FsbChjKX07Yy5kZWZhdWx0UHJldmVudGVkPSExfWMuaXNEZWZhdWx0UHJldmVudGVkPWZ1bmN0aW9uKCl7cmV0dXJuIGMuZGVmYXVsdFByZXZlbnRlZHx8ITE9PT1jLnJldHVyblZhbHVlfTt2YXIgZz1oYShhW2V8fGMudHlwZV18fFtdKTtyKGcsZnVuY3Rpb24oYSl7YS5jYWxsKGIsYyl9KTs4Pj1RPyhjLnByZXZlbnREZWZhdWx0PW51bGwsYy5zdG9wUHJvcGFnYXRpb249bnVsbCxjLmlzRGVmYXVsdFByZXZlbnRlZD1udWxsKTooZGVsZXRlIGMucHJldmVudERlZmF1bHQsZGVsZXRlIGMuc3RvcFByb3BhZ2F0aW9uLGRlbGV0ZSBjLmlzRGVmYXVsdFByZXZlbnRlZCl9O2MuZWxlbT1iO3JldHVybiBjfWZ1bmN0aW9uIEthKGIsYSl7dmFyIGM9dHlwZW9mIGIsZDtcImZ1bmN0aW9uXCI9PWN8fFwib2JqZWN0XCI9PWMmJm51bGwhPT1iP1wiZnVuY3Rpb25cIj09dHlwZW9mKGQ9XG5iLiQkaGFzaEtleSk/ZD1iLiQkaGFzaEtleSgpOmQ9PT10JiYoZD1iLiQkaGFzaEtleT0oYXx8aGIpKCkpOmQ9YjtyZXR1cm4gYytcIjpcIitkfWZ1bmN0aW9uIGJiKGIsYSl7aWYoYSl7dmFyIGM9MDt0aGlzLm5leHRVaWQ9ZnVuY3Rpb24oKXtyZXR1cm4rK2N9fXIoYix0aGlzLnB1dCx0aGlzKX1mdW5jdGlvbiBzYyhiKXt2YXIgYSxjO1wiZnVuY3Rpb25cIj09PXR5cGVvZiBiPyhhPWIuJGluamVjdCl8fChhPVtdLGIubGVuZ3RoJiYoYz1iLnRvU3RyaW5nKCkucmVwbGFjZShwZSxcIlwiKSxjPWMubWF0Y2gocWUpLHIoY1sxXS5zcGxpdChyZSksZnVuY3Rpb24oYil7Yi5yZXBsYWNlKHNlLGZ1bmN0aW9uKGIsYyxkKXthLnB1c2goZCl9KX0pKSxiLiRpbmplY3Q9YSk6SihiKT8oYz1iLmxlbmd0aC0xLFdhKGJbY10sXCJmblwiKSxhPWIuc2xpY2UoMCxjKSk6V2EoYixcImZuXCIsITApO3JldHVybiBhfWZ1bmN0aW9uIGdjKGIpe2Z1bmN0aW9uIGEoYSl7cmV0dXJuIGZ1bmN0aW9uKGIsYyl7aWYoVChiKSlyKGIsXG4kYihhKSk7ZWxzZSByZXR1cm4gYShiLGMpfX1mdW5jdGlvbiBjKGEsYil7RGEoYSxcInNlcnZpY2VcIik7aWYoUChiKXx8SihiKSliPW4uaW5zdGFudGlhdGUoYik7aWYoIWIuJGdldCl0aHJvdyBjYihcInBnZXRcIixhKTtyZXR1cm4gbFthK2tdPWJ9ZnVuY3Rpb24gZChhLGIpe3JldHVybiBjKGEseyRnZXQ6Yn0pfWZ1bmN0aW9uIGUoYSl7dmFyIGI9W10sYyxkLGYsaztyKGEsZnVuY3Rpb24oYSl7aWYoIWguZ2V0KGEpKXtoLnB1dChhLCEwKTt0cnl7aWYodihhKSlmb3IoYz1ZYShhKSxiPWIuY29uY2F0KGUoYy5yZXF1aXJlcykpLmNvbmNhdChjLl9ydW5CbG9ja3MpLGQ9Yy5faW52b2tlUXVldWUsZj0wLGs9ZC5sZW5ndGg7ZjxrO2YrKyl7dmFyIGc9ZFtmXSxtPW4uZ2V0KGdbMF0pO21bZ1sxXV0uYXBwbHkobSxnWzJdKX1lbHNlIFAoYSk/Yi5wdXNoKG4uaW52b2tlKGEpKTpKKGEpP2IucHVzaChuLmludm9rZShhKSk6V2EoYSxcIm1vZHVsZVwiKX1jYXRjaChsKXt0aHJvdyBKKGEpJiYoYT1cbmFbYS5sZW5ndGgtMV0pLGwubWVzc2FnZSYmKGwuc3RhY2smJi0xPT1sLnN0YWNrLmluZGV4T2YobC5tZXNzYWdlKSkmJihsPWwubWVzc2FnZStcIlxcblwiK2wuc3RhY2spLGNiKFwibW9kdWxlcnJcIixhLGwuc3RhY2t8fGwubWVzc2FnZXx8bCk7fX19KTtyZXR1cm4gYn1mdW5jdGlvbiBmKGEsYil7ZnVuY3Rpb24gYyhkKXtpZihhLmhhc093blByb3BlcnR5KGQpKXtpZihhW2RdPT09Zyl0aHJvdyBjYihcImNkZXBcIixkK1wiIDwtIFwiK20uam9pbihcIiA8LSBcIikpO3JldHVybiBhW2RdfXRyeXtyZXR1cm4gbS51bnNoaWZ0KGQpLGFbZF09ZyxhW2RdPWIoZCl9Y2F0Y2goZSl7dGhyb3cgYVtkXT09PWcmJmRlbGV0ZSBhW2RdLGU7fWZpbmFsbHl7bS5zaGlmdCgpfX1mdW5jdGlvbiBkKGEsYixlKXt2YXIgZj1bXSxrPXNjKGEpLGcsbSxoO209MDtmb3IoZz1rLmxlbmd0aDttPGc7bSsrKXtoPWtbbV07aWYoXCJzdHJpbmdcIiE9PXR5cGVvZiBoKXRocm93IGNiKFwiaXRrblwiLGgpO2YucHVzaChlJiZlLmhhc093blByb3BlcnR5KGgpP1xuZVtoXTpjKGgpKX1KKGEpJiYoYT1hW2ddKTtyZXR1cm4gYS5hcHBseShiLGYpfXJldHVybntpbnZva2U6ZCxpbnN0YW50aWF0ZTpmdW5jdGlvbihhLGIpe3ZhciBjPWZ1bmN0aW9uKCl7fSxlO2MucHJvdG90eXBlPShKKGEpP2FbYS5sZW5ndGgtMV06YSkucHJvdG90eXBlO2M9bmV3IGM7ZT1kKGEsYyxiKTtyZXR1cm4gVChlKXx8UChlKT9lOmN9LGdldDpjLGFubm90YXRlOnNjLGhhczpmdW5jdGlvbihiKXtyZXR1cm4gbC5oYXNPd25Qcm9wZXJ0eShiK2spfHxhLmhhc093blByb3BlcnR5KGIpfX19dmFyIGc9e30saz1cIlByb3ZpZGVyXCIsbT1bXSxoPW5ldyBiYihbXSwhMCksbD17JHByb3ZpZGU6e3Byb3ZpZGVyOmEoYyksZmFjdG9yeTphKGQpLHNlcnZpY2U6YShmdW5jdGlvbihhLGIpe3JldHVybiBkKGEsW1wiJGluamVjdG9yXCIsZnVuY3Rpb24oYSl7cmV0dXJuIGEuaW5zdGFudGlhdGUoYil9XSl9KSx2YWx1ZTphKGZ1bmN0aW9uKGEsYil7cmV0dXJuIGQoYSxiYShiKSl9KSxjb25zdGFudDphKGZ1bmN0aW9uKGEsXG5iKXtEYShhLFwiY29uc3RhbnRcIik7bFthXT1iO3BbYV09Yn0pLGRlY29yYXRvcjpmdW5jdGlvbihhLGIpe3ZhciBjPW4uZ2V0KGErayksZD1jLiRnZXQ7Yy4kZ2V0PWZ1bmN0aW9uKCl7dmFyIGE9cS5pbnZva2UoZCxjKTtyZXR1cm4gcS5pbnZva2UoYixudWxsLHskZGVsZWdhdGU6YX0pfX19fSxuPWwuJGluamVjdG9yPWYobCxmdW5jdGlvbigpe3Rocm93IGNiKFwidW5wclwiLG0uam9pbihcIiA8LSBcIikpO30pLHA9e30scT1wLiRpbmplY3Rvcj1mKHAsZnVuY3Rpb24oYSl7YT1uLmdldChhK2spO3JldHVybiBxLmludm9rZShhLiRnZXQsYSl9KTtyKGUoYiksZnVuY3Rpb24oYSl7cS5pbnZva2UoYXx8RSl9KTtyZXR1cm4gcX1mdW5jdGlvbiBMZCgpe3ZhciBiPSEwO3RoaXMuZGlzYWJsZUF1dG9TY3JvbGxpbmc9ZnVuY3Rpb24oKXtiPSExfTt0aGlzLiRnZXQ9W1wiJHdpbmRvd1wiLFwiJGxvY2F0aW9uXCIsXCIkcm9vdFNjb3BlXCIsZnVuY3Rpb24oYSxjLGQpe2Z1bmN0aW9uIGUoYSl7dmFyIGI9bnVsbDtcbnIoYSxmdW5jdGlvbihhKXtifHxcImFcIiE9PUsoYS5ub2RlTmFtZSl8fChiPWEpfSk7cmV0dXJuIGJ9ZnVuY3Rpb24gZigpe3ZhciBiPWMuaGFzaCgpLGQ7Yj8oZD1nLmdldEVsZW1lbnRCeUlkKGIpKT9kLnNjcm9sbEludG9WaWV3KCk6KGQ9ZShnLmdldEVsZW1lbnRzQnlOYW1lKGIpKSk/ZC5zY3JvbGxJbnRvVmlldygpOlwidG9wXCI9PT1iJiZhLnNjcm9sbFRvKDAsMCk6YS5zY3JvbGxUbygwLDApfXZhciBnPWEuZG9jdW1lbnQ7YiYmZC4kd2F0Y2goZnVuY3Rpb24oKXtyZXR1cm4gYy5oYXNoKCl9LGZ1bmN0aW9uKCl7ZC4kZXZhbEFzeW5jKGYpfSk7cmV0dXJuIGZ9XX1mdW5jdGlvbiBoZSgpe3RoaXMuJGdldD1bXCIkJHJBRlwiLFwiJHRpbWVvdXRcIixmdW5jdGlvbihiLGEpe3JldHVybiBiLnN1cHBvcnRlZD9mdW5jdGlvbihhKXtyZXR1cm4gYihhKX06ZnVuY3Rpb24oYil7cmV0dXJuIGEoYiwwLCExKX19XX1mdW5jdGlvbiB0ZShiLGEsYyxkKXtmdW5jdGlvbiBlKGEpe3RyeXthLmFwcGx5KG51bGwsXG5CYS5jYWxsKGFyZ3VtZW50cywxKSl9ZmluYWxseXtpZihzLS0sMD09PXMpZm9yKDtGLmxlbmd0aDspdHJ5e0YucG9wKCkoKX1jYXRjaChiKXtjLmVycm9yKGIpfX19ZnVuY3Rpb24gZihhLGIpeyhmdW5jdGlvbiBmYSgpe3IodSxmdW5jdGlvbihhKXthKCl9KTtBPWIoZmEsYSl9KSgpfWZ1bmN0aW9uIGcoKXt6PW51bGw7TiE9ay51cmwoKSYmKE49ay51cmwoKSxyKGNhLGZ1bmN0aW9uKGEpe2Eoay51cmwoKSl9KSl9dmFyIGs9dGhpcyxtPWFbMF0saD1iLmxvY2F0aW9uLGw9Yi5oaXN0b3J5LG49Yi5zZXRUaW1lb3V0LHA9Yi5jbGVhclRpbWVvdXQscT17fTtrLmlzTW9jaz0hMTt2YXIgcz0wLEY9W107ay4kJGNvbXBsZXRlT3V0c3RhbmRpbmdSZXF1ZXN0PWU7ay4kJGluY091dHN0YW5kaW5nUmVxdWVzdENvdW50PWZ1bmN0aW9uKCl7cysrfTtrLm5vdGlmeVdoZW5Ob091dHN0YW5kaW5nUmVxdWVzdHM9ZnVuY3Rpb24oYSl7cih1LGZ1bmN0aW9uKGEpe2EoKX0pOzA9PT1zP2EoKTpGLnB1c2goYSl9O1xudmFyIHU9W10sQTtrLmFkZFBvbGxGbj1mdW5jdGlvbihhKXt4KEEpJiZmKDEwMCxuKTt1LnB1c2goYSk7cmV0dXJuIGF9O3ZhciBOPWguaHJlZixSPWEuZmluZChcImJhc2VcIiksej1udWxsO2sudXJsPWZ1bmN0aW9uKGEsYyl7aCE9PWIubG9jYXRpb24mJihoPWIubG9jYXRpb24pO2whPT1iLmhpc3RvcnkmJihsPWIuaGlzdG9yeSk7aWYoYSl7aWYoTiE9YSlyZXR1cm4gTj1hLGQuaGlzdG9yeT9jP2wucmVwbGFjZVN0YXRlKG51bGwsXCJcIixhKToobC5wdXNoU3RhdGUobnVsbCxcIlwiLGEpLFIuYXR0cihcImhyZWZcIixSLmF0dHIoXCJocmVmXCIpKSk6KHo9YSxjP2gucmVwbGFjZShhKTpoLmhyZWY9YSksa31lbHNlIHJldHVybiB6fHxoLmhyZWYucmVwbGFjZSgvJTI3L2csXCInXCIpfTt2YXIgY2E9W10sTD0hMTtrLm9uVXJsQ2hhbmdlPWZ1bmN0aW9uKGEpe2lmKCFMKXtpZihkLmhpc3RvcnkpdyhiKS5vbihcInBvcHN0YXRlXCIsZyk7aWYoZC5oYXNoY2hhbmdlKXcoYikub24oXCJoYXNoY2hhbmdlXCIsZyk7XG5lbHNlIGsuYWRkUG9sbEZuKGcpO0w9ITB9Y2EucHVzaChhKTtyZXR1cm4gYX07ay4kJGNoZWNrVXJsQ2hhbmdlPWc7ay5iYXNlSHJlZj1mdW5jdGlvbigpe3ZhciBhPVIuYXR0cihcImhyZWZcIik7cmV0dXJuIGE/YS5yZXBsYWNlKC9eKGh0dHBzP1xcOik/XFwvXFwvW15cXC9dKi8sXCJcIik6XCJcIn07dmFyIE89e30sZGE9XCJcIixCPWsuYmFzZUhyZWYoKTtrLmNvb2tpZXM9ZnVuY3Rpb24oYSxiKXt2YXIgZCxlLGYsaztpZihhKWI9PT10P20uY29va2llPWVzY2FwZShhKStcIj07cGF0aD1cIitCK1wiO2V4cGlyZXM9VGh1LCAwMSBKYW4gMTk3MCAwMDowMDowMCBHTVRcIjp2KGIpJiYoZD0obS5jb29raWU9ZXNjYXBlKGEpK1wiPVwiK2VzY2FwZShiKStcIjtwYXRoPVwiK0IpLmxlbmd0aCsxLDQwOTY8ZCYmYy53YXJuKFwiQ29va2llICdcIithK1wiJyBwb3NzaWJseSBub3Qgc2V0IG9yIG92ZXJmbG93ZWQgYmVjYXVzZSBpdCB3YXMgdG9vIGxhcmdlIChcIitkK1wiID4gNDA5NiBieXRlcykhXCIpKTtlbHNle2lmKG0uY29va2llIT09XG5kYSlmb3IoZGE9bS5jb29raWUsZD1kYS5zcGxpdChcIjsgXCIpLE89e30sZj0wO2Y8ZC5sZW5ndGg7ZisrKWU9ZFtmXSxrPWUuaW5kZXhPZihcIj1cIiksMDxrJiYoYT11bmVzY2FwZShlLnN1YnN0cmluZygwLGspKSxPW2FdPT09dCYmKE9bYV09dW5lc2NhcGUoZS5zdWJzdHJpbmcoaysxKSkpKTtyZXR1cm4gT319O2suZGVmZXI9ZnVuY3Rpb24oYSxiKXt2YXIgYztzKys7Yz1uKGZ1bmN0aW9uKCl7ZGVsZXRlIHFbY107ZShhKX0sYnx8MCk7cVtjXT0hMDtyZXR1cm4gY307ay5kZWZlci5jYW5jZWw9ZnVuY3Rpb24oYSl7cmV0dXJuIHFbYV0/KGRlbGV0ZSBxW2FdLHAoYSksZShFKSwhMCk6ITF9fWZ1bmN0aW9uIE5kKCl7dGhpcy4kZ2V0PVtcIiR3aW5kb3dcIixcIiRsb2dcIixcIiRzbmlmZmVyXCIsXCIkZG9jdW1lbnRcIixmdW5jdGlvbihiLGEsYyxkKXtyZXR1cm4gbmV3IHRlKGIsZCxhLGMpfV19ZnVuY3Rpb24gT2QoKXt0aGlzLiRnZXQ9ZnVuY3Rpb24oKXtmdW5jdGlvbiBiKGIsZCl7ZnVuY3Rpb24gZShhKXthIT1cbm4mJihwP3A9PWEmJihwPWEubik6cD1hLGYoYS5uLGEucCksZihhLG4pLG49YSxuLm49bnVsbCl9ZnVuY3Rpb24gZihhLGIpe2EhPWImJihhJiYoYS5wPWIpLGImJihiLm49YSkpfWlmKGIgaW4gYSl0aHJvdyBDKFwiJGNhY2hlRmFjdG9yeVwiKShcImlpZFwiLGIpO3ZhciBnPTAsaz1EKHt9LGQse2lkOmJ9KSxtPXt9LGg9ZCYmZC5jYXBhY2l0eXx8TnVtYmVyLk1BWF9WQUxVRSxsPXt9LG49bnVsbCxwPW51bGw7cmV0dXJuIGFbYl09e3B1dDpmdW5jdGlvbihhLGIpe2lmKGg8TnVtYmVyLk1BWF9WQUxVRSl7dmFyIGM9bFthXXx8KGxbYV09e2tleTphfSk7ZShjKX1pZigheChiKSlyZXR1cm4gYSBpbiBtfHxnKyssbVthXT1iLGc+aCYmdGhpcy5yZW1vdmUocC5rZXkpLGJ9LGdldDpmdW5jdGlvbihhKXtpZihoPE51bWJlci5NQVhfVkFMVUUpe3ZhciBiPWxbYV07aWYoIWIpcmV0dXJuO2UoYil9cmV0dXJuIG1bYV19LHJlbW92ZTpmdW5jdGlvbihhKXtpZihoPE51bWJlci5NQVhfVkFMVUUpe3ZhciBiPVxubFthXTtpZighYilyZXR1cm47Yj09biYmKG49Yi5wKTtiPT1wJiYocD1iLm4pO2YoYi5uLGIucCk7ZGVsZXRlIGxbYV19ZGVsZXRlIG1bYV07Zy0tfSxyZW1vdmVBbGw6ZnVuY3Rpb24oKXttPXt9O2c9MDtsPXt9O249cD1udWxsfSxkZXN0cm95OmZ1bmN0aW9uKCl7bD1rPW09bnVsbDtkZWxldGUgYVtiXX0saW5mbzpmdW5jdGlvbigpe3JldHVybiBEKHt9LGsse3NpemU6Z30pfX19dmFyIGE9e307Yi5pbmZvPWZ1bmN0aW9uKCl7dmFyIGI9e307cihhLGZ1bmN0aW9uKGEsZSl7YltlXT1hLmluZm8oKX0pO3JldHVybiBifTtiLmdldD1mdW5jdGlvbihiKXtyZXR1cm4gYVtiXX07cmV0dXJuIGJ9fWZ1bmN0aW9uIGRlKCl7dGhpcy4kZ2V0PVtcIiRjYWNoZUZhY3RvcnlcIixmdW5jdGlvbihiKXtyZXR1cm4gYihcInRlbXBsYXRlc1wiKX1dfWZ1bmN0aW9uIGljKGIsYSl7dmFyIGM9e30sZD1cIkRpcmVjdGl2ZVwiLGU9L15cXHMqZGlyZWN0aXZlXFw6XFxzKihbXFxkXFx3X1xcLV0rKVxccysoLiopJC8sZj0vKChbXFxkXFx3X1xcLV0rKSg/OlxcOihbXjtdKykpPzs/KS8sXG5nPS9eKG9uW2Etel0rfGZvcm1hY3Rpb24pJC87dGhpcy5kaXJlY3RpdmU9ZnVuY3Rpb24gbShhLGUpe0RhKGEsXCJkaXJlY3RpdmVcIik7dihhKT8oRGIoZSxcImRpcmVjdGl2ZUZhY3RvcnlcIiksYy5oYXNPd25Qcm9wZXJ0eShhKXx8KGNbYV09W10sYi5mYWN0b3J5KGErZCxbXCIkaW5qZWN0b3JcIixcIiRleGNlcHRpb25IYW5kbGVyXCIsZnVuY3Rpb24oYixkKXt2YXIgZT1bXTtyKGNbYV0sZnVuY3Rpb24oYyxmKXt0cnl7dmFyIGc9Yi5pbnZva2UoYyk7UChnKT9nPXtjb21waWxlOmJhKGcpfTohZy5jb21waWxlJiZnLmxpbmsmJihnLmNvbXBpbGU9YmEoZy5saW5rKSk7Zy5wcmlvcml0eT1nLnByaW9yaXR5fHwwO2cuaW5kZXg9ZjtnLm5hbWU9Zy5uYW1lfHxhO2cucmVxdWlyZT1nLnJlcXVpcmV8fGcuY29udHJvbGxlciYmZy5uYW1lO2cucmVzdHJpY3Q9Zy5yZXN0cmljdHx8XCJBXCI7ZS5wdXNoKGcpfWNhdGNoKG0pe2QobSl9fSk7cmV0dXJuIGV9XSkpLGNbYV0ucHVzaChlKSk6cihhLCRiKG0pKTtcbnJldHVybiB0aGlzfTt0aGlzLmFIcmVmU2FuaXRpemF0aW9uV2hpdGVsaXN0PWZ1bmN0aW9uKGIpe3JldHVybiB5KGIpPyhhLmFIcmVmU2FuaXRpemF0aW9uV2hpdGVsaXN0KGIpLHRoaXMpOmEuYUhyZWZTYW5pdGl6YXRpb25XaGl0ZWxpc3QoKX07dGhpcy5pbWdTcmNTYW5pdGl6YXRpb25XaGl0ZWxpc3Q9ZnVuY3Rpb24oYil7cmV0dXJuIHkoYik/KGEuaW1nU3JjU2FuaXRpemF0aW9uV2hpdGVsaXN0KGIpLHRoaXMpOmEuaW1nU3JjU2FuaXRpemF0aW9uV2hpdGVsaXN0KCl9O3RoaXMuJGdldD1bXCIkaW5qZWN0b3JcIixcIiRpbnRlcnBvbGF0ZVwiLFwiJGV4Y2VwdGlvbkhhbmRsZXJcIixcIiRodHRwXCIsXCIkdGVtcGxhdGVDYWNoZVwiLFwiJHBhcnNlXCIsXCIkY29udHJvbGxlclwiLFwiJHJvb3RTY29wZVwiLFwiJGRvY3VtZW50XCIsXCIkc2NlXCIsXCIkYW5pbWF0ZVwiLFwiJCRzYW5pdGl6ZVVyaVwiLGZ1bmN0aW9uKGEsYixsLG4scCxxLHMsRix1LEEsTixSKXtmdW5jdGlvbiB6KGEsYixjLGQsZSl7YSBpbnN0YW5jZW9mXG53fHwoYT13KGEpKTtyKGEsZnVuY3Rpb24oYixjKXszPT1iLm5vZGVUeXBlJiZiLm5vZGVWYWx1ZS5tYXRjaCgvXFxTKy8pJiYoYVtjXT13KGIpLndyYXAoXCI8c3Bhbj48L3NwYW4+XCIpLnBhcmVudCgpWzBdKX0pO3ZhciBmPUwoYSxiLGEsYyxkLGUpO2NhKGEsXCJuZy1zY29wZVwiKTtyZXR1cm4gZnVuY3Rpb24oYixjLGQsZSl7RGIoYixcInNjb3BlXCIpO3ZhciBnPWM/TGEuY2xvbmUuY2FsbChhKTphO3IoZCxmdW5jdGlvbihhLGIpe2cuZGF0YShcIiRcIitiK1wiQ29udHJvbGxlclwiLGEpfSk7ZD0wO2Zvcih2YXIgbT1nLmxlbmd0aDtkPG07ZCsrKXt2YXIgaD1nW2RdLm5vZGVUeXBlOzEhPT1oJiY5IT09aHx8Zy5lcShkKS5kYXRhKFwiJHNjb3BlXCIsYil9YyYmYyhnLGIpO2YmJmYoYixnLGcsZSk7cmV0dXJuIGd9fWZ1bmN0aW9uIGNhKGEsYil7dHJ5e2EuYWRkQ2xhc3MoYil9Y2F0Y2goYyl7fX1mdW5jdGlvbiBMKGEsYixjLGQsZSxmKXtmdW5jdGlvbiBnKGEsYyxkLGUpe3ZhciBmLGgsbCxxLG4sXG5wLHM7Zj1jLmxlbmd0aDt2YXIgTT1BcnJheShmKTtmb3IocT0wO3E8ZjtxKyspTVtxXT1jW3FdO3A9cT0wO2ZvcihuPW0ubGVuZ3RoO3E8bjtwKyspaD1NW3BdLGM9bVtxKytdLGY9bVtxKytdLGM/KGMuc2NvcGU/KGw9YS4kbmV3KCksdy5kYXRhKGgsXCIkc2NvcGVcIixsKSk6bD1hLHM9Yy50cmFuc2NsdWRlT25UaGlzRWxlbWVudD9PKGEsYy50cmFuc2NsdWRlLGUpOiFjLnRlbXBsYXRlT25UaGlzRWxlbWVudCYmZT9lOiFlJiZiP08oYSxiKTpudWxsLGMoZixsLGgsZCxzKSk6ZiYmZihhLGguY2hpbGROb2Rlcyx0LGUpfWZvcih2YXIgbT1bXSxoLGwscSxuLHA9MDtwPGEubGVuZ3RoO3ArKyloPW5ldyBPYixsPWRhKGFbcF0sW10saCwwPT09cD9kOnQsZSksKGY9bC5sZW5ndGg/SChsLGFbcF0saCxiLGMsbnVsbCxbXSxbXSxmKTpudWxsKSYmZi5zY29wZSYmY2EoaC4kJGVsZW1lbnQsXCJuZy1zY29wZVwiKSxoPWYmJmYudGVybWluYWx8fCEocT1hW3BdLmNoaWxkTm9kZXMpfHwhcS5sZW5ndGg/XG5udWxsOkwocSxmPyhmLnRyYW5zY2x1ZGVPblRoaXNFbGVtZW50fHwhZi50ZW1wbGF0ZU9uVGhpc0VsZW1lbnQpJiZmLnRyYW5zY2x1ZGU6YiksbS5wdXNoKGYsaCksbj1ufHxmfHxoLGY9bnVsbDtyZXR1cm4gbj9nOm51bGx9ZnVuY3Rpb24gTyhhLGIsYyl7cmV0dXJuIGZ1bmN0aW9uKGQsZSxmKXt2YXIgZz0hMTtkfHwoZD1hLiRuZXcoKSxnPWQuJCR0cmFuc2NsdWRlZD0hMCk7ZT1iKGQsZSxmLGMpO2lmKGcpZS5vbihcIiRkZXN0cm95XCIsZnVuY3Rpb24oKXtkLiRkZXN0cm95KCl9KTtyZXR1cm4gZX19ZnVuY3Rpb24gZGEoYSxiLGMsZCxnKXt2YXIgbT1jLiRhdHRyLGg7c3dpdGNoKGEubm9kZVR5cGUpe2Nhc2UgMTpmYShiLHBhKE1hKGEpLnRvTG93ZXJDYXNlKCkpLFwiRVwiLGQsZyk7Zm9yKHZhciBsLHEsbixwPWEuYXR0cmlidXRlcyxzPTAsRj1wJiZwLmxlbmd0aDtzPEY7cysrKXt2YXIgQT0hMSxOPSExO2w9cFtzXTtpZighUXx8ODw9UXx8bC5zcGVjaWZpZWQpe2g9bC5uYW1lO3E9XG5hYShsLnZhbHVlKTtsPXBhKGgpO2lmKG49VS50ZXN0KGwpKWg9bWIobC5zdWJzdHIoNiksXCItXCIpO3ZhciB1PWwucmVwbGFjZSgvKFN0YXJ0fEVuZCkkLyxcIlwiKTtsPT09dStcIlN0YXJ0XCImJihBPWgsTj1oLnN1YnN0cigwLGgubGVuZ3RoLTUpK1wiZW5kXCIsaD1oLnN1YnN0cigwLGgubGVuZ3RoLTYpKTtsPXBhKGgudG9Mb3dlckNhc2UoKSk7bVtsXT1oO2lmKG58fCFjLmhhc093blByb3BlcnR5KGwpKWNbbF09cSxxYyhhLGwpJiYoY1tsXT0hMCk7UyhhLGIscSxsKTtmYShiLGwsXCJBXCIsZCxnLEEsTil9fWE9YS5jbGFzc05hbWU7aWYodihhKSYmXCJcIiE9PWEpZm9yKDtoPWYuZXhlYyhhKTspbD1wYShoWzJdKSxmYShiLGwsXCJDXCIsZCxnKSYmKGNbbF09YWEoaFszXSkpLGE9YS5zdWJzdHIoaC5pbmRleCtoWzBdLmxlbmd0aCk7YnJlYWs7Y2FzZSAzOksoYixhLm5vZGVWYWx1ZSk7YnJlYWs7Y2FzZSA4OnRyeXtpZihoPWUuZXhlYyhhLm5vZGVWYWx1ZSkpbD1wYShoWzFdKSxmYShiLGwsXCJNXCIsXG5kLGcpJiYoY1tsXT1hYShoWzJdKSl9Y2F0Y2goeil7fX1iLnNvcnQoeCk7cmV0dXJuIGJ9ZnVuY3Rpb24gQihhLGIsYyl7dmFyIGQ9W10sZT0wO2lmKGImJmEuaGFzQXR0cmlidXRlJiZhLmhhc0F0dHJpYnV0ZShiKSl7ZG97aWYoIWEpdGhyb3cgamEoXCJ1dGVyZGlyXCIsYixjKTsxPT1hLm5vZGVUeXBlJiYoYS5oYXNBdHRyaWJ1dGUoYikmJmUrKyxhLmhhc0F0dHJpYnV0ZShjKSYmZS0tKTtkLnB1c2goYSk7YT1hLm5leHRTaWJsaW5nfXdoaWxlKDA8ZSl9ZWxzZSBkLnB1c2goYSk7cmV0dXJuIHcoZCl9ZnVuY3Rpb24gSShhLGIsYyl7cmV0dXJuIGZ1bmN0aW9uKGQsZSxmLGcsaCl7ZT1CKGVbMF0sYixjKTtyZXR1cm4gYShkLGUsZixnLGgpfX1mdW5jdGlvbiBIKGEsYyxkLGUsZixnLG0sbixwKXtmdW5jdGlvbiBGKGEsYixjLGQpe2lmKGEpe2MmJihhPUkoYSxjLGQpKTthLnJlcXVpcmU9Ry5yZXF1aXJlO2EuZGlyZWN0aXZlTmFtZT1DO2lmKEw9PT1HfHxHLiQkaXNvbGF0ZVNjb3BlKWE9XG50YyhhLHtpc29sYXRlU2NvcGU6ITB9KTttLnB1c2goYSl9aWYoYil7YyYmKGI9SShiLGMsZCkpO2IucmVxdWlyZT1HLnJlcXVpcmU7Yi5kaXJlY3RpdmVOYW1lPUM7aWYoTD09PUd8fEcuJCRpc29sYXRlU2NvcGUpYj10YyhiLHtpc29sYXRlU2NvcGU6ITB9KTtuLnB1c2goYil9fWZ1bmN0aW9uIEEoYSxiLGMsZCl7dmFyIGUsZj1cImRhdGFcIixnPSExO2lmKHYoYikpe2Zvcig7XCJeXCI9PShlPWIuY2hhckF0KDApKXx8XCI/XCI9PWU7KWI9Yi5zdWJzdHIoMSksXCJeXCI9PWUmJihmPVwiaW5oZXJpdGVkRGF0YVwiKSxnPWd8fFwiP1wiPT1lO2U9bnVsbDtkJiZcImRhdGFcIj09PWYmJihlPWRbYl0pO2U9ZXx8Y1tmXShcIiRcIitiK1wiQ29udHJvbGxlclwiKTtpZighZSYmIWcpdGhyb3cgamEoXCJjdHJlcVwiLGIsYSk7fWVsc2UgSihiKSYmKGU9W10scihiLGZ1bmN0aW9uKGIpe2UucHVzaChBKGEsYixjLGQpKX0pKTtyZXR1cm4gZX1mdW5jdGlvbiBOKGEsZSxmLGcscCl7ZnVuY3Rpb24gRihhLGIpe3ZhciBjOzI+YXJndW1lbnRzLmxlbmd0aCYmXG4oYj1hLGE9dCk7SyYmKGM9ZGEpO3JldHVybiBwKGEsYixjKX12YXIgdSxNLHosTyxJLEIsZGE9e30scmI7dT1jPT09Zj9kOmhhKGQsbmV3IE9iKHcoZiksZC4kYXR0cikpO009dS4kJGVsZW1lbnQ7aWYoTCl7dmFyIE5hPS9eXFxzKihbQD0mXSkoXFw/PylcXHMqKFxcdyopXFxzKiQvO0I9ZS4kbmV3KCEwKTshSHx8SCE9PUwmJkghPT1MLiQkb3JpZ2luYWxEaXJlY3RpdmU/TS5kYXRhKFwiJGlzb2xhdGVTY29wZU5vVGVtcGxhdGVcIixCKTpNLmRhdGEoXCIkaXNvbGF0ZVNjb3BlXCIsQik7Y2EoTSxcIm5nLWlzb2xhdGUtc2NvcGVcIik7cihMLnNjb3BlLGZ1bmN0aW9uKGEsYyl7dmFyIGQ9YS5tYXRjaChOYSl8fFtdLGY9ZFszXXx8YyxnPVwiP1wiPT1kWzJdLGQ9ZFsxXSxtLGwsbixwO0IuJCRpc29sYXRlQmluZGluZ3NbY109ZCtmO3N3aXRjaChkKXtjYXNlIFwiQFwiOnUuJG9ic2VydmUoZixmdW5jdGlvbihhKXtCW2NdPWF9KTt1LiQkb2JzZXJ2ZXJzW2ZdLiQkc2NvcGU9ZTt1W2ZdJiYoQltjXT1iKHVbZl0pKGUpKTtcbmJyZWFrO2Nhc2UgXCI9XCI6aWYoZyYmIXVbZl0pYnJlYWs7bD1xKHVbZl0pO3A9bC5saXRlcmFsP0FhOmZ1bmN0aW9uKGEsYil7cmV0dXJuIGE9PT1ifHxhIT09YSYmYiE9PWJ9O249bC5hc3NpZ258fGZ1bmN0aW9uKCl7bT1CW2NdPWwoZSk7dGhyb3cgamEoXCJub25hc3NpZ25cIix1W2ZdLEwubmFtZSk7fTttPUJbY109bChlKTtCLiR3YXRjaChmdW5jdGlvbigpe3ZhciBhPWwoZSk7cChhLEJbY10pfHwocChhLG0pP24oZSxhPUJbY10pOkJbY109YSk7cmV0dXJuIG09YX0sbnVsbCxsLmxpdGVyYWwpO2JyZWFrO2Nhc2UgXCImXCI6bD1xKHVbZl0pO0JbY109ZnVuY3Rpb24oYSl7cmV0dXJuIGwoZSxhKX07YnJlYWs7ZGVmYXVsdDp0aHJvdyBqYShcImlzY3BcIixMLm5hbWUsYyxhKTt9fSl9cmI9cCYmRjtSJiZyKFIsZnVuY3Rpb24oYSl7dmFyIGI9eyRzY29wZTphPT09THx8YS4kJGlzb2xhdGVTY29wZT9COmUsJGVsZW1lbnQ6TSwkYXR0cnM6dSwkdHJhbnNjbHVkZTpyYn0sYztJPWEuY29udHJvbGxlcjtcblwiQFwiPT1JJiYoST11W2EubmFtZV0pO2M9cyhJLGIpO2RhW2EubmFtZV09YztLfHxNLmRhdGEoXCIkXCIrYS5uYW1lK1wiQ29udHJvbGxlclwiLGMpO2EuY29udHJvbGxlckFzJiYoYi4kc2NvcGVbYS5jb250cm9sbGVyQXNdPWMpfSk7Zz0wO2Zvcih6PW0ubGVuZ3RoO2c8ejtnKyspdHJ5e089bVtnXSxPKE8uaXNvbGF0ZVNjb3BlP0I6ZSxNLHUsTy5yZXF1aXJlJiZBKE8uZGlyZWN0aXZlTmFtZSxPLnJlcXVpcmUsTSxkYSkscmIpfWNhdGNoKEcpe2woRyxpYShNKSl9Zz1lO0wmJihMLnRlbXBsYXRlfHxudWxsPT09TC50ZW1wbGF0ZVVybCkmJihnPUIpO2EmJmEoZyxmLmNoaWxkTm9kZXMsdCxwKTtmb3IoZz1uLmxlbmd0aC0xOzA8PWc7Zy0tKXRyeXtPPW5bZ10sTyhPLmlzb2xhdGVTY29wZT9COmUsTSx1LE8ucmVxdWlyZSYmQShPLmRpcmVjdGl2ZU5hbWUsTy5yZXF1aXJlLE0sZGEpLHJiKX1jYXRjaCh5KXtsKHksaWEoTSkpfX1wPXB8fHt9O2Zvcih2YXIgdT0tTnVtYmVyLk1BWF9WQUxVRSxcbk8sUj1wLmNvbnRyb2xsZXJEaXJlY3RpdmVzLEw9cC5uZXdJc29sYXRlU2NvcGVEaXJlY3RpdmUsSD1wLnRlbXBsYXRlRGlyZWN0aXZlLGZhPXAubm9uVGxiVHJhbnNjbHVkZURpcmVjdGl2ZSx4PSExLEQ9ITEsSz1wLmhhc0VsZW1lbnRUcmFuc2NsdWRlRGlyZWN0aXZlLFo9ZC4kJGVsZW1lbnQ9dyhjKSxHLEMsVixTPWUsUSxGYT0wLHFhPWEubGVuZ3RoO0ZhPHFhO0ZhKyspe0c9YVtGYV07dmFyIFU9Ry4kJHN0YXJ0LFk9Ry4kJGVuZDtVJiYoWj1CKGMsVSxZKSk7Vj10O2lmKHU+Ry5wcmlvcml0eSlicmVhaztpZihWPUcuc2NvcGUpTz1PfHxHLEcudGVtcGxhdGVVcmx8fChkYihcIm5ldy9pc29sYXRlZCBzY29wZVwiLEwsRyxaKSxUKFYpJiYoTD1HKSk7Qz1HLm5hbWU7IUcudGVtcGxhdGVVcmwmJkcuY29udHJvbGxlciYmKFY9Ry5jb250cm9sbGVyLFI9Unx8e30sZGIoXCInXCIrQytcIicgY29udHJvbGxlclwiLFJbQ10sRyxaKSxSW0NdPUcpO2lmKFY9Ry50cmFuc2NsdWRlKXg9ITAsRy4kJHRsYnx8XG4oZGIoXCJ0cmFuc2NsdXNpb25cIixmYSxHLFopLGZhPUcpLFwiZWxlbWVudFwiPT1WPyhLPSEwLHU9Ry5wcmlvcml0eSxWPVosWj1kLiQkZWxlbWVudD13KFguY3JlYXRlQ29tbWVudChcIiBcIitDK1wiOiBcIitkW0NdK1wiIFwiKSksYz1aWzBdLE5hKGYsQmEuY2FsbChWLDApLGMpLFM9eihWLGUsdSxnJiZnLm5hbWUse25vblRsYlRyYW5zY2x1ZGVEaXJlY3RpdmU6ZmF9KSk6KFY9dyhLYihjKSkuY29udGVudHMoKSxaLmVtcHR5KCksUz16KFYsZSkpO2lmKEcudGVtcGxhdGUpaWYoRD0hMCxkYihcInRlbXBsYXRlXCIsSCxHLFopLEg9RyxWPVAoRy50ZW1wbGF0ZSk/Ry50ZW1wbGF0ZShaLGQpOkcudGVtcGxhdGUsVj1XKFYpLEcucmVwbGFjZSl7Zz1HO1Y9SWIudGVzdChWKT93KGFhKFYpKTpbXTtjPVZbMF07aWYoMSE9Vi5sZW5ndGh8fDEhPT1jLm5vZGVUeXBlKXRocm93IGphKFwidHBscnRcIixDLFwiXCIpO05hKGYsWixjKTtxYT17JGF0dHI6e319O1Y9ZGEoYyxbXSxxYSk7dmFyICQ9YS5zcGxpY2UoRmErXG4xLGEubGVuZ3RoLShGYSsxKSk7TCYmeShWKTthPWEuY29uY2F0KFYpLmNvbmNhdCgkKTtFKGQscWEpO3FhPWEubGVuZ3RofWVsc2UgWi5odG1sKFYpO2lmKEcudGVtcGxhdGVVcmwpRD0hMCxkYihcInRlbXBsYXRlXCIsSCxHLFopLEg9RyxHLnJlcGxhY2UmJihnPUcpLE49dWUoYS5zcGxpY2UoRmEsYS5sZW5ndGgtRmEpLFosZCxmLHgmJlMsbSxuLHtjb250cm9sbGVyRGlyZWN0aXZlczpSLG5ld0lzb2xhdGVTY29wZURpcmVjdGl2ZTpMLHRlbXBsYXRlRGlyZWN0aXZlOkgsbm9uVGxiVHJhbnNjbHVkZURpcmVjdGl2ZTpmYX0pLHFhPWEubGVuZ3RoO2Vsc2UgaWYoRy5jb21waWxlKXRyeXtRPUcuY29tcGlsZShaLGQsUyksUChRKT9GKG51bGwsUSxVLFkpOlEmJkYoUS5wcmUsUS5wb3N0LFUsWSl9Y2F0Y2godmUpe2wodmUsaWEoWikpfUcudGVybWluYWwmJihOLnRlcm1pbmFsPSEwLHU9TWF0aC5tYXgodSxHLnByaW9yaXR5KSl9Ti5zY29wZT1PJiYhMD09PU8uc2NvcGU7Ti50cmFuc2NsdWRlT25UaGlzRWxlbWVudD1cbng7Ti50ZW1wbGF0ZU9uVGhpc0VsZW1lbnQ9RDtOLnRyYW5zY2x1ZGU9UztwLmhhc0VsZW1lbnRUcmFuc2NsdWRlRGlyZWN0aXZlPUs7cmV0dXJuIE59ZnVuY3Rpb24geShhKXtmb3IodmFyIGI9MCxjPWEubGVuZ3RoO2I8YztiKyspYVtiXT1iYyhhW2JdLHskJGlzb2xhdGVTY29wZTohMH0pfWZ1bmN0aW9uIGZhKGIsZSxmLGcsaCxxLG4pe2lmKGU9PT1oKXJldHVybiBudWxsO2g9bnVsbDtpZihjLmhhc093blByb3BlcnR5KGUpKXt2YXIgcDtlPWEuZ2V0KGUrZCk7Zm9yKHZhciBzPTAsdT1lLmxlbmd0aDtzPHU7cysrKXRyeXtwPWVbc10sKGc9PT10fHxnPnAucHJpb3JpdHkpJiYtMSE9cC5yZXN0cmljdC5pbmRleE9mKGYpJiYocSYmKHA9YmMocCx7JCRzdGFydDpxLCQkZW5kOm59KSksYi5wdXNoKHApLGg9cCl9Y2F0Y2goRil7bChGKX19cmV0dXJuIGh9ZnVuY3Rpb24gRShhLGIpe3ZhciBjPWIuJGF0dHIsZD1hLiRhdHRyLGU9YS4kJGVsZW1lbnQ7cihhLGZ1bmN0aW9uKGQsZSl7XCIkXCIhPVxuZS5jaGFyQXQoMCkmJihiW2VdJiZiW2VdIT09ZCYmKGQrPShcInN0eWxlXCI9PT1lP1wiO1wiOlwiIFwiKStiW2VdKSxhLiRzZXQoZSxkLCEwLGNbZV0pKX0pO3IoYixmdW5jdGlvbihiLGYpe1wiY2xhc3NcIj09Zj8oY2EoZSxiKSxhW1wiY2xhc3NcIl09KGFbXCJjbGFzc1wiXT9hW1wiY2xhc3NcIl0rXCIgXCI6XCJcIikrYik6XCJzdHlsZVwiPT1mPyhlLmF0dHIoXCJzdHlsZVwiLGUuYXR0cihcInN0eWxlXCIpK1wiO1wiK2IpLGEuc3R5bGU9KGEuc3R5bGU/YS5zdHlsZStcIjtcIjpcIlwiKStiKTpcIiRcIj09Zi5jaGFyQXQoMCl8fGEuaGFzT3duUHJvcGVydHkoZil8fChhW2ZdPWIsZFtmXT1jW2ZdKX0pfWZ1bmN0aW9uIHVlKGEsYixjLGQsZSxmLGcsaCl7dmFyIG09W10sbCxxLHM9YlswXSx1PWEuc2hpZnQoKSxGPUQoe30sdSx7dGVtcGxhdGVVcmw6bnVsbCx0cmFuc2NsdWRlOm51bGwscmVwbGFjZTpudWxsLCQkb3JpZ2luYWxEaXJlY3RpdmU6dX0pLE49UCh1LnRlbXBsYXRlVXJsKT91LnRlbXBsYXRlVXJsKGIsYyk6dS50ZW1wbGF0ZVVybDtcbmIuZW1wdHkoKTtuLmdldChBLmdldFRydXN0ZWRSZXNvdXJjZVVybChOKSx7Y2FjaGU6cH0pLnN1Y2Nlc3MoZnVuY3Rpb24obil7dmFyIHAsQTtuPVcobik7aWYodS5yZXBsYWNlKXtuPUliLnRlc3Qobik/dyhhYShuKSk6W107cD1uWzBdO2lmKDEhPW4ubGVuZ3RofHwxIT09cC5ub2RlVHlwZSl0aHJvdyBqYShcInRwbHJ0XCIsdS5uYW1lLE4pO249eyRhdHRyOnt9fTtOYShkLGIscCk7dmFyIHo9ZGEocCxbXSxuKTtUKHUuc2NvcGUpJiZ5KHopO2E9ei5jb25jYXQoYSk7RShjLG4pfWVsc2UgcD1zLGIuaHRtbChuKTthLnVuc2hpZnQoRik7bD1IKGEscCxjLGUsYix1LGYsZyxoKTtyKGQsZnVuY3Rpb24oYSxjKXthPT1wJiYoZFtjXT1iWzBdKX0pO2ZvcihxPUwoYlswXS5jaGlsZE5vZGVzLGUpO20ubGVuZ3RoOyl7bj1tLnNoaWZ0KCk7QT1tLnNoaWZ0KCk7dmFyIFI9bS5zaGlmdCgpLEk9bS5zaGlmdCgpLHo9YlswXTtpZihBIT09cyl7dmFyIEI9QS5jbGFzc05hbWU7aC5oYXNFbGVtZW50VHJhbnNjbHVkZURpcmVjdGl2ZSYmXG51LnJlcGxhY2V8fCh6PUtiKHApKTtOYShSLHcoQSkseik7Y2Eodyh6KSxCKX1BPWwudHJhbnNjbHVkZU9uVGhpc0VsZW1lbnQ/TyhuLGwudHJhbnNjbHVkZSxJKTpJO2wocSxuLHosZCxBKX1tPW51bGx9KS5lcnJvcihmdW5jdGlvbihhLGIsYyxkKXt0aHJvdyBqYShcInRwbG9hZFwiLGQudXJsKTt9KTtyZXR1cm4gZnVuY3Rpb24oYSxiLGMsZCxlKXthPWU7bT8obS5wdXNoKGIpLG0ucHVzaChjKSxtLnB1c2goZCksbS5wdXNoKGEpKToobC50cmFuc2NsdWRlT25UaGlzRWxlbWVudCYmKGE9TyhiLGwudHJhbnNjbHVkZSxlKSksbChxLGIsYyxkLGEpKX19ZnVuY3Rpb24geChhLGIpe3ZhciBjPWIucHJpb3JpdHktYS5wcmlvcml0eTtyZXR1cm4gMCE9PWM/YzphLm5hbWUhPT1iLm5hbWU/YS5uYW1lPGIubmFtZT8tMToxOmEuaW5kZXgtYi5pbmRleH1mdW5jdGlvbiBkYihhLGIsYyxkKXtpZihiKXRocm93IGphKFwibXVsdGlkaXJcIixiLm5hbWUsYy5uYW1lLGEsaWEoZCkpO31mdW5jdGlvbiBLKGEsXG5jKXt2YXIgZD1iKGMsITApO2QmJmEucHVzaCh7cHJpb3JpdHk6MCxjb21waWxlOmZ1bmN0aW9uKGEpe3ZhciBiPWEucGFyZW50KCkubGVuZ3RoO2ImJmNhKGEucGFyZW50KCksXCJuZy1iaW5kaW5nXCIpO3JldHVybiBmdW5jdGlvbihhLGMpe3ZhciBlPWMucGFyZW50KCksZj1lLmRhdGEoXCIkYmluZGluZ1wiKXx8W107Zi5wdXNoKGQpO2UuZGF0YShcIiRiaW5kaW5nXCIsZik7Ynx8Y2EoZSxcIm5nLWJpbmRpbmdcIik7YS4kd2F0Y2goZCxmdW5jdGlvbihhKXtjWzBdLm5vZGVWYWx1ZT1hfSl9fX0pfWZ1bmN0aW9uIEMoYSxiKXtpZihcInNyY2RvY1wiPT1iKXJldHVybiBBLkhUTUw7dmFyIGM9TWEoYSk7aWYoXCJ4bGlua0hyZWZcIj09Ynx8XCJGT1JNXCI9PWMmJlwiYWN0aW9uXCI9PWJ8fFwiSU1HXCIhPWMmJihcInNyY1wiPT1ifHxcIm5nU3JjXCI9PWIpKXJldHVybiBBLlJFU09VUkNFX1VSTH1mdW5jdGlvbiBTKGEsYyxkLGUpe3ZhciBmPWIoZCwhMCk7aWYoZil7aWYoXCJtdWx0aXBsZVwiPT09ZSYmXCJTRUxFQ1RcIj09PVxuTWEoYSkpdGhyb3cgamEoXCJzZWxtdWx0aVwiLGlhKGEpKTtjLnB1c2goe3ByaW9yaXR5OjEwMCxjb21waWxlOmZ1bmN0aW9uKCl7cmV0dXJue3ByZTpmdW5jdGlvbihjLGQsbSl7ZD1tLiQkb2JzZXJ2ZXJzfHwobS4kJG9ic2VydmVycz17fSk7aWYoZy50ZXN0KGUpKXRocm93IGphKFwibm9kb21ldmVudHNcIik7aWYoZj1iKG1bZV0sITAsQyhhLGUpKSltW2VdPWYoYyksKGRbZV18fChkW2VdPVtdKSkuJCRpbnRlcj0hMCwobS4kJG9ic2VydmVycyYmbS4kJG9ic2VydmVyc1tlXS4kJHNjb3BlfHxjKS4kd2F0Y2goZixmdW5jdGlvbihhLGIpe1wiY2xhc3NcIj09PWUmJmEhPWI/bS4kdXBkYXRlQ2xhc3MoYSxiKTptLiRzZXQoZSxhKX0pfX19fSl9fWZ1bmN0aW9uIE5hKGEsYixjKXt2YXIgZD1iWzBdLGU9Yi5sZW5ndGgsZj1kLnBhcmVudE5vZGUsZyxtO2lmKGEpZm9yKGc9MCxtPWEubGVuZ3RoO2c8bTtnKyspaWYoYVtnXT09ZCl7YVtnKytdPWM7bT1nK2UtMTtmb3IodmFyIGg9YS5sZW5ndGg7Zzxcbmg7ZysrLG0rKyltPGg/YVtnXT1hW21dOmRlbGV0ZSBhW2ddO2EubGVuZ3RoLT1lLTE7YnJlYWt9ZiYmZi5yZXBsYWNlQ2hpbGQoYyxkKTthPVguY3JlYXRlRG9jdW1lbnRGcmFnbWVudCgpO2EuYXBwZW5kQ2hpbGQoZCk7Y1t3LmV4cGFuZG9dPWRbdy5leHBhbmRvXTtkPTE7Zm9yKGU9Yi5sZW5ndGg7ZDxlO2QrKylmPWJbZF0sdyhmKS5yZW1vdmUoKSxhLmFwcGVuZENoaWxkKGYpLGRlbGV0ZSBiW2RdO2JbMF09YztiLmxlbmd0aD0xfWZ1bmN0aW9uIHRjKGEsYil7cmV0dXJuIEQoZnVuY3Rpb24oKXtyZXR1cm4gYS5hcHBseShudWxsLGFyZ3VtZW50cyl9LGEsYil9dmFyIE9iPWZ1bmN0aW9uKGEsYil7dGhpcy4kJGVsZW1lbnQ9YTt0aGlzLiRhdHRyPWJ8fHt9fTtPYi5wcm90b3R5cGU9eyRub3JtYWxpemU6cGEsJGFkZENsYXNzOmZ1bmN0aW9uKGEpe2EmJjA8YS5sZW5ndGgmJk4uYWRkQ2xhc3ModGhpcy4kJGVsZW1lbnQsYSl9LCRyZW1vdmVDbGFzczpmdW5jdGlvbihhKXthJiYwPFxuYS5sZW5ndGgmJk4ucmVtb3ZlQ2xhc3ModGhpcy4kJGVsZW1lbnQsYSl9LCR1cGRhdGVDbGFzczpmdW5jdGlvbihhLGIpe3ZhciBjPXVjKGEsYiksZD11YyhiLGEpOzA9PT1jLmxlbmd0aD9OLnJlbW92ZUNsYXNzKHRoaXMuJCRlbGVtZW50LGQpOjA9PT1kLmxlbmd0aD9OLmFkZENsYXNzKHRoaXMuJCRlbGVtZW50LGMpOk4uc2V0Q2xhc3ModGhpcy4kJGVsZW1lbnQsYyxkKX0sJHNldDpmdW5jdGlvbihhLGIsYyxkKXt2YXIgZT1xYyh0aGlzLiQkZWxlbWVudFswXSxhKTtlJiYodGhpcy4kJGVsZW1lbnQucHJvcChhLGIpLGQ9ZSk7dGhpc1thXT1iO2Q/dGhpcy4kYXR0clthXT1kOihkPXRoaXMuJGF0dHJbYV0pfHwodGhpcy4kYXR0clthXT1kPW1iKGEsXCItXCIpKTtlPU1hKHRoaXMuJCRlbGVtZW50KTtpZihcIkFcIj09PWUmJlwiaHJlZlwiPT09YXx8XCJJTUdcIj09PWUmJlwic3JjXCI9PT1hKXRoaXNbYV09Yj1SKGIsXCJzcmNcIj09PWEpOyExIT09YyYmKG51bGw9PT1ifHxiPT09dD90aGlzLiQkZWxlbWVudC5yZW1vdmVBdHRyKGQpOlxudGhpcy4kJGVsZW1lbnQuYXR0cihkLGIpKTsoYz10aGlzLiQkb2JzZXJ2ZXJzKSYmcihjW2FdLGZ1bmN0aW9uKGEpe3RyeXthKGIpfWNhdGNoKGMpe2woYyl9fSl9LCRvYnNlcnZlOmZ1bmN0aW9uKGEsYil7dmFyIGM9dGhpcyxkPWMuJCRvYnNlcnZlcnN8fChjLiQkb2JzZXJ2ZXJzPXt9KSxlPWRbYV18fChkW2FdPVtdKTtlLnB1c2goYik7Ri4kZXZhbEFzeW5jKGZ1bmN0aW9uKCl7ZS4kJGludGVyfHxiKGNbYV0pfSk7cmV0dXJuIGJ9fTt2YXIgcWE9Yi5zdGFydFN5bWJvbCgpLFo9Yi5lbmRTeW1ib2woKSxXPVwie3tcIj09cWF8fFwifX1cIj09Wj9RYTpmdW5jdGlvbihhKXtyZXR1cm4gYS5yZXBsYWNlKC9cXHtcXHsvZyxxYSkucmVwbGFjZSgvfX0vZyxaKX0sVT0vXm5nQXR0cltBLVpdLztyZXR1cm4gen1dfWZ1bmN0aW9uIHBhKGIpe3JldHVybiBaYShiLnJlcGxhY2Uod2UsXCJcIikpfWZ1bmN0aW9uIHVjKGIsYSl7dmFyIGM9XCJcIixkPWIuc3BsaXQoL1xccysvKSxlPWEuc3BsaXQoL1xccysvKSxmPVxuMDthOmZvcig7ZjxkLmxlbmd0aDtmKyspe2Zvcih2YXIgZz1kW2ZdLGs9MDtrPGUubGVuZ3RoO2srKylpZihnPT1lW2tdKWNvbnRpbnVlIGE7Yys9KDA8Yy5sZW5ndGg/XCIgXCI6XCJcIikrZ31yZXR1cm4gY31mdW5jdGlvbiBQZCgpe3ZhciBiPXt9LGE9L14oXFxTKykoXFxzK2FzXFxzKyhcXHcrKSk/JC87dGhpcy5yZWdpc3Rlcj1mdW5jdGlvbihhLGQpe0RhKGEsXCJjb250cm9sbGVyXCIpO1QoYSk/RChiLGEpOmJbYV09ZH07dGhpcy4kZ2V0PVtcIiRpbmplY3RvclwiLFwiJHdpbmRvd1wiLGZ1bmN0aW9uKGMsZCl7cmV0dXJuIGZ1bmN0aW9uKGUsZil7dmFyIGcsayxtO3YoZSkmJihnPWUubWF0Y2goYSksaz1nWzFdLG09Z1szXSxlPWIuaGFzT3duUHJvcGVydHkoayk/YltrXTpoYyhmLiRzY29wZSxrLCEwKXx8aGMoZCxrLCEwKSxXYShlLGssITApKTtnPWMuaW5zdGFudGlhdGUoZSxmKTtpZihtKXtpZighZnx8XCJvYmplY3RcIiE9PXR5cGVvZiBmLiRzY29wZSl0aHJvdyBDKFwiJGNvbnRyb2xsZXJcIikoXCJub3NjcFwiLFxua3x8ZS5uYW1lLG0pO2YuJHNjb3BlW21dPWd9cmV0dXJuIGd9fV19ZnVuY3Rpb24gUWQoKXt0aGlzLiRnZXQ9W1wiJHdpbmRvd1wiLGZ1bmN0aW9uKGIpe3JldHVybiB3KGIuZG9jdW1lbnQpfV19ZnVuY3Rpb24gUmQoKXt0aGlzLiRnZXQ9W1wiJGxvZ1wiLGZ1bmN0aW9uKGIpe3JldHVybiBmdW5jdGlvbihhLGMpe2IuZXJyb3IuYXBwbHkoYixhcmd1bWVudHMpfX1dfWZ1bmN0aW9uIHZjKGIpe3ZhciBhPXt9LGMsZCxlO2lmKCFiKXJldHVybiBhO3IoYi5zcGxpdChcIlxcblwiKSxmdW5jdGlvbihiKXtlPWIuaW5kZXhPZihcIjpcIik7Yz1LKGFhKGIuc3Vic3RyKDAsZSkpKTtkPWFhKGIuc3Vic3RyKGUrMSkpO2MmJihhW2NdPWFbY10/YVtjXStcIiwgXCIrZDpkKX0pO3JldHVybiBhfWZ1bmN0aW9uIHdjKGIpe3ZhciBhPVQoYik/Yjp0O3JldHVybiBmdW5jdGlvbihjKXthfHwoYT12YyhiKSk7cmV0dXJuIGM/YVtLKGMpXXx8bnVsbDphfX1mdW5jdGlvbiB4YyhiLGEsYyl7aWYoUChjKSlyZXR1cm4gYyhiLFxuYSk7cihjLGZ1bmN0aW9uKGMpe2I9YyhiLGEpfSk7cmV0dXJuIGJ9ZnVuY3Rpb24gVWQoKXt2YXIgYj0vXlxccyooXFxbfFxce1teXFx7XSkvLGE9L1tcXH1cXF1dXFxzKiQvLGM9L15cXClcXF1cXH0nLD9cXG4vLGQ9e1wiQ29udGVudC1UeXBlXCI6XCJhcHBsaWNhdGlvbi9qc29uO2NoYXJzZXQ9dXRmLThcIn0sZT10aGlzLmRlZmF1bHRzPXt0cmFuc2Zvcm1SZXNwb25zZTpbZnVuY3Rpb24oZCl7dihkKSYmKGQ9ZC5yZXBsYWNlKGMsXCJcIiksYi50ZXN0KGQpJiZhLnRlc3QoZCkmJihkPWNjKGQpKSk7cmV0dXJuIGR9XSx0cmFuc2Zvcm1SZXF1ZXN0OltmdW5jdGlvbihhKXtyZXR1cm4gVChhKSYmXCJbb2JqZWN0IEZpbGVdXCIhPT16YS5jYWxsKGEpJiZcIltvYmplY3QgQmxvYl1cIiE9PXphLmNhbGwoYSk/bmEoYSk6YX1dLGhlYWRlcnM6e2NvbW1vbjp7QWNjZXB0OlwiYXBwbGljYXRpb24vanNvbiwgdGV4dC9wbGFpbiwgKi8qXCJ9LHBvc3Q6aGEoZCkscHV0OmhhKGQpLHBhdGNoOmhhKGQpfSx4c3JmQ29va2llTmFtZTpcIlhTUkYtVE9LRU5cIixcbnhzcmZIZWFkZXJOYW1lOlwiWC1YU1JGLVRPS0VOXCJ9LGY9dGhpcy5pbnRlcmNlcHRvcnM9W10sZz10aGlzLnJlc3BvbnNlSW50ZXJjZXB0b3JzPVtdO3RoaXMuJGdldD1bXCIkaHR0cEJhY2tlbmRcIixcIiRicm93c2VyXCIsXCIkY2FjaGVGYWN0b3J5XCIsXCIkcm9vdFNjb3BlXCIsXCIkcVwiLFwiJGluamVjdG9yXCIsZnVuY3Rpb24oYSxiLGMsZCxuLHApe2Z1bmN0aW9uIHEoYSl7ZnVuY3Rpb24gYihhKXt2YXIgZD1EKHt9LGEse2RhdGE6eGMoYS5kYXRhLGEuaGVhZGVycyxjLnRyYW5zZm9ybVJlc3BvbnNlKX0pO3JldHVybiAyMDA8PWEuc3RhdHVzJiYzMDA+YS5zdGF0dXM/ZDpuLnJlamVjdChkKX12YXIgYz17bWV0aG9kOlwiZ2V0XCIsdHJhbnNmb3JtUmVxdWVzdDplLnRyYW5zZm9ybVJlcXVlc3QsdHJhbnNmb3JtUmVzcG9uc2U6ZS50cmFuc2Zvcm1SZXNwb25zZX0sZD1mdW5jdGlvbihhKXt2YXIgYj1lLmhlYWRlcnMsYz1EKHt9LGEuaGVhZGVycyksZCxmLGI9RCh7fSxiLmNvbW1vbixiW0soYS5tZXRob2QpXSk7XG5hOmZvcihkIGluIGIpe2E9SyhkKTtmb3IoZiBpbiBjKWlmKEsoZik9PT1hKWNvbnRpbnVlIGE7Y1tkXT1iW2RdfShmdW5jdGlvbihhKXt2YXIgYjtyKGEsZnVuY3Rpb24oYyxkKXtQKGMpJiYoYj1jKCksbnVsbCE9Yj9hW2RdPWI6ZGVsZXRlIGFbZF0pfSl9KShjKTtyZXR1cm4gY30oYSk7RChjLGEpO2MuaGVhZGVycz1kO2MubWV0aG9kPUlhKGMubWV0aG9kKTt2YXIgZj1bZnVuY3Rpb24oYSl7ZD1hLmhlYWRlcnM7dmFyIGM9eGMoYS5kYXRhLHdjKGQpLGEudHJhbnNmb3JtUmVxdWVzdCk7eChjKSYmcihkLGZ1bmN0aW9uKGEsYil7XCJjb250ZW50LXR5cGVcIj09PUsoYikmJmRlbGV0ZSBkW2JdfSk7eChhLndpdGhDcmVkZW50aWFscykmJiF4KGUud2l0aENyZWRlbnRpYWxzKSYmKGEud2l0aENyZWRlbnRpYWxzPWUud2l0aENyZWRlbnRpYWxzKTtyZXR1cm4gcyhhLGMsZCkudGhlbihiLGIpfSx0XSxnPW4ud2hlbihjKTtmb3IocihBLGZ1bmN0aW9uKGEpeyhhLnJlcXVlc3R8fGEucmVxdWVzdEVycm9yKSYmXG5mLnVuc2hpZnQoYS5yZXF1ZXN0LGEucmVxdWVzdEVycm9yKTsoYS5yZXNwb25zZXx8YS5yZXNwb25zZUVycm9yKSYmZi5wdXNoKGEucmVzcG9uc2UsYS5yZXNwb25zZUVycm9yKX0pO2YubGVuZ3RoOyl7YT1mLnNoaWZ0KCk7dmFyIG09Zi5zaGlmdCgpLGc9Zy50aGVuKGEsbSl9Zy5zdWNjZXNzPWZ1bmN0aW9uKGEpe2cudGhlbihmdW5jdGlvbihiKXthKGIuZGF0YSxiLnN0YXR1cyxiLmhlYWRlcnMsYyl9KTtyZXR1cm4gZ307Zy5lcnJvcj1mdW5jdGlvbihhKXtnLnRoZW4obnVsbCxmdW5jdGlvbihiKXthKGIuZGF0YSxiLnN0YXR1cyxiLmhlYWRlcnMsYyl9KTtyZXR1cm4gZ307cmV0dXJuIGd9ZnVuY3Rpb24gcyhjLGYsZyl7ZnVuY3Rpb24gaChhLGIsYyxlKXtJJiYoMjAwPD1hJiYzMDA+YT9JLnB1dCh3LFthLGIsdmMoYyksZV0pOkkucmVtb3ZlKHcpKTtwKGIsYSxjLGUpO2QuJCRwaGFzZXx8ZC4kYXBwbHkoKX1mdW5jdGlvbiBwKGEsYixkLGUpe2I9TWF0aC5tYXgoYiwwKTsoMjAwPD1cbmImJjMwMD5iP0EucmVzb2x2ZTpBLnJlamVjdCkoe2RhdGE6YSxzdGF0dXM6YixoZWFkZXJzOndjKGQpLGNvbmZpZzpjLHN0YXR1c1RleHQ6ZX0pfWZ1bmN0aW9uIHMoKXt2YXIgYT1SYShxLnBlbmRpbmdSZXF1ZXN0cyxjKTstMSE9PWEmJnEucGVuZGluZ1JlcXVlc3RzLnNwbGljZShhLDEpfXZhciBBPW4uZGVmZXIoKSxyPUEucHJvbWlzZSxJLEgsdz1GKGMudXJsLGMucGFyYW1zKTtxLnBlbmRpbmdSZXF1ZXN0cy5wdXNoKGMpO3IudGhlbihzLHMpOyFjLmNhY2hlJiYhZS5jYWNoZXx8KCExPT09Yy5jYWNoZXx8XCJHRVRcIiE9PWMubWV0aG9kJiZcIkpTT05QXCIhPT1jLm1ldGhvZCl8fChJPVQoYy5jYWNoZSk/Yy5jYWNoZTpUKGUuY2FjaGUpP2UuY2FjaGU6dSk7aWYoSSlpZihIPUkuZ2V0KHcpLHkoSCkpe2lmKEgmJlAoSC50aGVuKSlyZXR1cm4gSC50aGVuKHMscyksSDtKKEgpP3AoSFsxXSxIWzBdLGhhKEhbMl0pLEhbM10pOnAoSCwyMDAse30sXCJPS1wiKX1lbHNlIEkucHV0KHcscik7eChIKSYmXG4oKEg9UGIoYy51cmwpP2IuY29va2llcygpW2MueHNyZkNvb2tpZU5hbWV8fGUueHNyZkNvb2tpZU5hbWVdOnQpJiYoZ1tjLnhzcmZIZWFkZXJOYW1lfHxlLnhzcmZIZWFkZXJOYW1lXT1IKSxhKGMubWV0aG9kLHcsZixoLGcsYy50aW1lb3V0LGMud2l0aENyZWRlbnRpYWxzLGMucmVzcG9uc2VUeXBlKSk7cmV0dXJuIHJ9ZnVuY3Rpb24gRihhLGIpe2lmKCFiKXJldHVybiBhO3ZhciBjPVtdO1RjKGIsZnVuY3Rpb24oYSxiKXtudWxsPT09YXx8eChhKXx8KEooYSl8fChhPVthXSkscihhLGZ1bmN0aW9uKGEpe1QoYSkmJihhPXRhKGEpP2EudG9JU09TdHJpbmcoKTpuYShhKSk7Yy5wdXNoKENhKGIpK1wiPVwiK0NhKGEpKX0pKX0pOzA8Yy5sZW5ndGgmJihhKz0oLTE9PWEuaW5kZXhPZihcIj9cIik/XCI/XCI6XCImXCIpK2Muam9pbihcIiZcIikpO3JldHVybiBhfXZhciB1PWMoXCIkaHR0cFwiKSxBPVtdO3IoZixmdW5jdGlvbihhKXtBLnVuc2hpZnQodihhKT9wLmdldChhKTpwLmludm9rZShhKSl9KTtyKGcsXG5mdW5jdGlvbihhLGIpe3ZhciBjPXYoYSk/cC5nZXQoYSk6cC5pbnZva2UoYSk7QS5zcGxpY2UoYiwwLHtyZXNwb25zZTpmdW5jdGlvbihhKXtyZXR1cm4gYyhuLndoZW4oYSkpfSxyZXNwb25zZUVycm9yOmZ1bmN0aW9uKGEpe3JldHVybiBjKG4ucmVqZWN0KGEpKX19KX0pO3EucGVuZGluZ1JlcXVlc3RzPVtdOyhmdW5jdGlvbihhKXtyKGFyZ3VtZW50cyxmdW5jdGlvbihhKXtxW2FdPWZ1bmN0aW9uKGIsYyl7cmV0dXJuIHEoRChjfHx7fSx7bWV0aG9kOmEsdXJsOmJ9KSl9fSl9KShcImdldFwiLFwiZGVsZXRlXCIsXCJoZWFkXCIsXCJqc29ucFwiKTsoZnVuY3Rpb24oYSl7cihhcmd1bWVudHMsZnVuY3Rpb24oYSl7cVthXT1mdW5jdGlvbihiLGMsZCl7cmV0dXJuIHEoRChkfHx7fSx7bWV0aG9kOmEsdXJsOmIsZGF0YTpjfSkpfX0pfSkoXCJwb3N0XCIsXCJwdXRcIik7cS5kZWZhdWx0cz1lO3JldHVybiBxfV19ZnVuY3Rpb24geGUoYil7aWYoOD49USYmKCFiLm1hdGNoKC9eKGdldHxwb3N0fGhlYWR8cHV0fGRlbGV0ZXxvcHRpb25zKSQvaSl8fFxuIVcuWE1MSHR0cFJlcXVlc3QpKXJldHVybiBuZXcgVy5BY3RpdmVYT2JqZWN0KFwiTWljcm9zb2Z0LlhNTEhUVFBcIik7aWYoVy5YTUxIdHRwUmVxdWVzdClyZXR1cm4gbmV3IFcuWE1MSHR0cFJlcXVlc3Q7dGhyb3cgQyhcIiRodHRwQmFja2VuZFwiKShcIm5veGhyXCIpO31mdW5jdGlvbiBWZCgpe3RoaXMuJGdldD1bXCIkYnJvd3NlclwiLFwiJHdpbmRvd1wiLFwiJGRvY3VtZW50XCIsZnVuY3Rpb24oYixhLGMpe3JldHVybiB5ZShiLHhlLGIuZGVmZXIsYS5hbmd1bGFyLmNhbGxiYWNrcyxjWzBdKX1dfWZ1bmN0aW9uIHllKGIsYSxjLGQsZSl7ZnVuY3Rpb24gZihhLGIsYyl7dmFyIGY9ZS5jcmVhdGVFbGVtZW50KFwic2NyaXB0XCIpLGc9bnVsbDtmLnR5cGU9XCJ0ZXh0L2phdmFzY3JpcHRcIjtmLnNyYz1hO2YuYXN5bmM9ITA7Zz1mdW5jdGlvbihhKXskYShmLFwibG9hZFwiLGcpOyRhKGYsXCJlcnJvclwiLGcpO2UuYm9keS5yZW1vdmVDaGlsZChmKTtmPW51bGw7dmFyIGs9LTEscz1cInVua25vd25cIjthJiYoXCJsb2FkXCIhPT1cbmEudHlwZXx8ZFtiXS5jYWxsZWR8fChhPXt0eXBlOlwiZXJyb3JcIn0pLHM9YS50eXBlLGs9XCJlcnJvclwiPT09YS50eXBlPzQwNDoyMDApO2MmJmMoayxzKX07c2IoZixcImxvYWRcIixnKTtzYihmLFwiZXJyb3JcIixnKTs4Pj1RJiYoZi5vbnJlYWR5c3RhdGVjaGFuZ2U9ZnVuY3Rpb24oKXt2KGYucmVhZHlTdGF0ZSkmJi9sb2FkZWR8Y29tcGxldGUvLnRlc3QoZi5yZWFkeVN0YXRlKSYmKGYub25yZWFkeXN0YXRlY2hhbmdlPW51bGwsZyh7dHlwZTpcImxvYWRcIn0pKX0pO2UuYm9keS5hcHBlbmRDaGlsZChmKTtyZXR1cm4gZ312YXIgZz0tMTtyZXR1cm4gZnVuY3Rpb24oZSxtLGgsbCxuLHAscSxzKXtmdW5jdGlvbiBGKCl7QT1nO1ImJlIoKTt6JiZ6LmFib3J0KCl9ZnVuY3Rpb24gdShhLGQsZSxmLGcpe0wmJmMuY2FuY2VsKEwpO1I9ej1udWxsOzA9PT1kJiYoZD1lPzIwMDpcImZpbGVcIj09dWEobSkucHJvdG9jb2w/NDA0OjApO2EoMTIyMz09PWQ/MjA0OmQsZSxmLGd8fFwiXCIpO2IuJCRjb21wbGV0ZU91dHN0YW5kaW5nUmVxdWVzdChFKX1cbnZhciBBO2IuJCRpbmNPdXRzdGFuZGluZ1JlcXVlc3RDb3VudCgpO209bXx8Yi51cmwoKTtpZihcImpzb25wXCI9PUsoZSkpe3ZhciBOPVwiX1wiKyhkLmNvdW50ZXIrKykudG9TdHJpbmcoMzYpO2RbTl09ZnVuY3Rpb24oYSl7ZFtOXS5kYXRhPWE7ZFtOXS5jYWxsZWQ9ITB9O3ZhciBSPWYobS5yZXBsYWNlKFwiSlNPTl9DQUxMQkFDS1wiLFwiYW5ndWxhci5jYWxsYmFja3MuXCIrTiksTixmdW5jdGlvbihhLGIpe3UobCxhLGRbTl0uZGF0YSxcIlwiLGIpO2RbTl09RX0pfWVsc2V7dmFyIHo9YShlKTt6Lm9wZW4oZSxtLCEwKTtyKG4sZnVuY3Rpb24oYSxiKXt5KGEpJiZ6LnNldFJlcXVlc3RIZWFkZXIoYixhKX0pO3oub25yZWFkeXN0YXRlY2hhbmdlPWZ1bmN0aW9uKCl7aWYoeiYmND09ei5yZWFkeVN0YXRlKXt2YXIgYT1udWxsLGI9bnVsbCxjPVwiXCI7QSE9PWcmJihhPXouZ2V0QWxsUmVzcG9uc2VIZWFkZXJzKCksYj1cInJlc3BvbnNlXCJpbiB6P3oucmVzcG9uc2U6ei5yZXNwb25zZVRleHQpO0E9PT1nJiZcbjEwPlF8fChjPXouc3RhdHVzVGV4dCk7dShsLEF8fHouc3RhdHVzLGIsYSxjKX19O3EmJih6LndpdGhDcmVkZW50aWFscz0hMCk7aWYocyl0cnl7ei5yZXNwb25zZVR5cGU9c31jYXRjaChjYSl7aWYoXCJqc29uXCIhPT1zKXRocm93IGNhO316LnNlbmQoaHx8bnVsbCl9aWYoMDxwKXZhciBMPWMoRixwKTtlbHNlIHAmJlAocC50aGVuKSYmcC50aGVuKEYpfX1mdW5jdGlvbiBTZCgpe3ZhciBiPVwie3tcIixhPVwifX1cIjt0aGlzLnN0YXJ0U3ltYm9sPWZ1bmN0aW9uKGEpe3JldHVybiBhPyhiPWEsdGhpcyk6Yn07dGhpcy5lbmRTeW1ib2w9ZnVuY3Rpb24oYil7cmV0dXJuIGI/KGE9Yix0aGlzKTphfTt0aGlzLiRnZXQ9W1wiJHBhcnNlXCIsXCIkZXhjZXB0aW9uSGFuZGxlclwiLFwiJHNjZVwiLGZ1bmN0aW9uKGMsZCxlKXtmdW5jdGlvbiBmKGYsaCxsKXtmb3IodmFyIG4scCxxPTAscz1bXSxGPWYubGVuZ3RoLHU9ITEsQT1bXTtxPEY7KS0xIT0obj1mLmluZGV4T2YoYixxKSkmJi0xIT0ocD1mLmluZGV4T2YoYSxcbm4rZykpPyhxIT1uJiZzLnB1c2goZi5zdWJzdHJpbmcocSxuKSkscy5wdXNoKHE9Yyh1PWYuc3Vic3RyaW5nKG4rZyxwKSkpLHEuZXhwPXUscT1wK2ssdT0hMCk6KHEhPUYmJnMucHVzaChmLnN1YnN0cmluZyhxKSkscT1GKTsoRj1zLmxlbmd0aCl8fChzLnB1c2goXCJcIiksRj0xKTtpZihsJiYxPHMubGVuZ3RoKXRocm93IHljKFwibm9jb25jYXRcIixmKTtpZighaHx8dSlyZXR1cm4gQS5sZW5ndGg9RixxPWZ1bmN0aW9uKGEpe3RyeXtmb3IodmFyIGI9MCxjPUYsZztiPGM7YisrKXtpZihcImZ1bmN0aW9uXCI9PXR5cGVvZihnPXNbYl0pKWlmKGc9ZyhhKSxnPWw/ZS5nZXRUcnVzdGVkKGwsZyk6ZS52YWx1ZU9mKGcpLG51bGw9PWcpZz1cIlwiO2Vsc2Ugc3dpdGNoKHR5cGVvZiBnKXtjYXNlIFwic3RyaW5nXCI6YnJlYWs7Y2FzZSBcIm51bWJlclwiOmc9XCJcIitnO2JyZWFrO2RlZmF1bHQ6Zz1uYShnKX1BW2JdPWd9cmV0dXJuIEEuam9pbihcIlwiKX1jYXRjaChrKXthPXljKFwiaW50ZXJyXCIsZixrLnRvU3RyaW5nKCkpLFxuZChhKX19LHEuZXhwPWYscS5wYXJ0cz1zLHF9dmFyIGc9Yi5sZW5ndGgsaz1hLmxlbmd0aDtmLnN0YXJ0U3ltYm9sPWZ1bmN0aW9uKCl7cmV0dXJuIGJ9O2YuZW5kU3ltYm9sPWZ1bmN0aW9uKCl7cmV0dXJuIGF9O3JldHVybiBmfV19ZnVuY3Rpb24gVGQoKXt0aGlzLiRnZXQ9W1wiJHJvb3RTY29wZVwiLFwiJHdpbmRvd1wiLFwiJHFcIixmdW5jdGlvbihiLGEsYyl7ZnVuY3Rpb24gZChkLGcsayxtKXt2YXIgaD1hLnNldEludGVydmFsLGw9YS5jbGVhckludGVydmFsLG49Yy5kZWZlcigpLHA9bi5wcm9taXNlLHE9MCxzPXkobSkmJiFtO2s9eShrKT9rOjA7cC50aGVuKG51bGwsbnVsbCxkKTtwLiQkaW50ZXJ2YWxJZD1oKGZ1bmN0aW9uKCl7bi5ub3RpZnkocSsrKTswPGsmJnE+PWsmJihuLnJlc29sdmUocSksbChwLiQkaW50ZXJ2YWxJZCksZGVsZXRlIGVbcC4kJGludGVydmFsSWRdKTtzfHxiLiRhcHBseSgpfSxnKTtlW3AuJCRpbnRlcnZhbElkXT1uO3JldHVybiBwfXZhciBlPXt9O2QuY2FuY2VsPVxuZnVuY3Rpb24oYil7cmV0dXJuIGImJmIuJCRpbnRlcnZhbElkIGluIGU/KGVbYi4kJGludGVydmFsSWRdLnJlamVjdChcImNhbmNlbGVkXCIpLGEuY2xlYXJJbnRlcnZhbChiLiQkaW50ZXJ2YWxJZCksZGVsZXRlIGVbYi4kJGludGVydmFsSWRdLCEwKTohMX07cmV0dXJuIGR9XX1mdW5jdGlvbiBiZCgpe3RoaXMuJGdldD1mdW5jdGlvbigpe3JldHVybntpZDpcImVuLXVzXCIsTlVNQkVSX0ZPUk1BVFM6e0RFQ0lNQUxfU0VQOlwiLlwiLEdST1VQX1NFUDpcIixcIixQQVRURVJOUzpbe21pbkludDoxLG1pbkZyYWM6MCxtYXhGcmFjOjMscG9zUHJlOlwiXCIscG9zU3VmOlwiXCIsbmVnUHJlOlwiLVwiLG5lZ1N1ZjpcIlwiLGdTaXplOjMsbGdTaXplOjN9LHttaW5JbnQ6MSxtaW5GcmFjOjIsbWF4RnJhYzoyLHBvc1ByZTpcIlxcdTAwYTRcIixwb3NTdWY6XCJcIixuZWdQcmU6XCIoXFx1MDBhNFwiLG5lZ1N1ZjpcIilcIixnU2l6ZTozLGxnU2l6ZTozfV0sQ1VSUkVOQ1lfU1lNOlwiJFwifSxEQVRFVElNRV9GT1JNQVRTOntNT05USDpcIkphbnVhcnkgRmVicnVhcnkgTWFyY2ggQXByaWwgTWF5IEp1bmUgSnVseSBBdWd1c3QgU2VwdGVtYmVyIE9jdG9iZXIgTm92ZW1iZXIgRGVjZW1iZXJcIi5zcGxpdChcIiBcIiksXG5TSE9SVE1PTlRIOlwiSmFuIEZlYiBNYXIgQXByIE1heSBKdW4gSnVsIEF1ZyBTZXAgT2N0IE5vdiBEZWNcIi5zcGxpdChcIiBcIiksREFZOlwiU3VuZGF5IE1vbmRheSBUdWVzZGF5IFdlZG5lc2RheSBUaHVyc2RheSBGcmlkYXkgU2F0dXJkYXlcIi5zcGxpdChcIiBcIiksU0hPUlREQVk6XCJTdW4gTW9uIFR1ZSBXZWQgVGh1IEZyaSBTYXRcIi5zcGxpdChcIiBcIiksQU1QTVM6W1wiQU1cIixcIlBNXCJdLG1lZGl1bTpcIk1NTSBkLCB5IGg6bW06c3MgYVwiLFwic2hvcnRcIjpcIk0vZC95eSBoOm1tIGFcIixmdWxsRGF0ZTpcIkVFRUUsIE1NTU0gZCwgeVwiLGxvbmdEYXRlOlwiTU1NTSBkLCB5XCIsbWVkaXVtRGF0ZTpcIk1NTSBkLCB5XCIsc2hvcnREYXRlOlwiTS9kL3l5XCIsbWVkaXVtVGltZTpcImg6bW06c3MgYVwiLHNob3J0VGltZTpcImg6bW0gYVwifSxwbHVyYWxDYXQ6ZnVuY3Rpb24oYil7cmV0dXJuIDE9PT1iP1wib25lXCI6XCJvdGhlclwifX19fWZ1bmN0aW9uIFFiKGIpe2I9Yi5zcGxpdChcIi9cIik7Zm9yKHZhciBhPWIubGVuZ3RoO2EtLTspYlthXT1cbmxiKGJbYV0pO3JldHVybiBiLmpvaW4oXCIvXCIpfWZ1bmN0aW9uIHpjKGIsYSxjKXtiPXVhKGIsYyk7YS4kJHByb3RvY29sPWIucHJvdG9jb2w7YS4kJGhvc3Q9Yi5ob3N0bmFtZTthLiQkcG9ydD1VKGIucG9ydCl8fHplW2IucHJvdG9jb2xdfHxudWxsfWZ1bmN0aW9uIEFjKGIsYSxjKXt2YXIgZD1cIi9cIiE9PWIuY2hhckF0KDApO2QmJihiPVwiL1wiK2IpO2I9dWEoYixjKTthLiQkcGF0aD1kZWNvZGVVUklDb21wb25lbnQoZCYmXCIvXCI9PT1iLnBhdGhuYW1lLmNoYXJBdCgwKT9iLnBhdGhuYW1lLnN1YnN0cmluZygxKTpiLnBhdGhuYW1lKTthLiQkc2VhcmNoPWVjKGIuc2VhcmNoKTthLiQkaGFzaD1kZWNvZGVVUklDb21wb25lbnQoYi5oYXNoKTthLiQkcGF0aCYmXCIvXCIhPWEuJCRwYXRoLmNoYXJBdCgwKSYmKGEuJCRwYXRoPVwiL1wiK2EuJCRwYXRoKX1mdW5jdGlvbiByYShiLGEpe2lmKDA9PT1hLmluZGV4T2YoYikpcmV0dXJuIGEuc3Vic3RyKGIubGVuZ3RoKX1mdW5jdGlvbiBlYihiKXt2YXIgYT1cbmIuaW5kZXhPZihcIiNcIik7cmV0dXJuLTE9PWE/YjpiLnN1YnN0cigwLGEpfWZ1bmN0aW9uIFJiKGIpe3JldHVybiBiLnN1YnN0cigwLGViKGIpLmxhc3RJbmRleE9mKFwiL1wiKSsxKX1mdW5jdGlvbiBCYyhiLGEpe3RoaXMuJCRodG1sNT0hMDthPWF8fFwiXCI7dmFyIGM9UmIoYik7emMoYix0aGlzLGIpO3RoaXMuJCRwYXJzZT1mdW5jdGlvbihhKXt2YXIgZT1yYShjLGEpO2lmKCF2KGUpKXRocm93IFNiKFwiaXB0aHByZnhcIixhLGMpO0FjKGUsdGhpcyxiKTt0aGlzLiQkcGF0aHx8KHRoaXMuJCRwYXRoPVwiL1wiKTt0aGlzLiQkY29tcG9zZSgpfTt0aGlzLiQkY29tcG9zZT1mdW5jdGlvbigpe3ZhciBhPUNiKHRoaXMuJCRzZWFyY2gpLGI9dGhpcy4kJGhhc2g/XCIjXCIrbGIodGhpcy4kJGhhc2gpOlwiXCI7dGhpcy4kJHVybD1RYih0aGlzLiQkcGF0aCkrKGE/XCI/XCIrYTpcIlwiKStiO3RoaXMuJCRhYnNVcmw9Yyt0aGlzLiQkdXJsLnN1YnN0cigxKX07dGhpcy4kJHJld3JpdGU9ZnVuY3Rpb24oZCl7dmFyIGU7XG5pZigoZT1yYShiLGQpKSE9PXQpcmV0dXJuIGQ9ZSwoZT1yYShhLGUpKSE9PXQ/YysocmEoXCIvXCIsZSl8fGUpOmIrZDtpZigoZT1yYShjLGQpKSE9PXQpcmV0dXJuIGMrZTtpZihjPT1kK1wiL1wiKXJldHVybiBjfX1mdW5jdGlvbiBUYihiLGEpe3ZhciBjPVJiKGIpO3pjKGIsdGhpcyxiKTt0aGlzLiQkcGFyc2U9ZnVuY3Rpb24oZCl7dmFyIGU9cmEoYixkKXx8cmEoYyxkKSxlPVwiI1wiPT1lLmNoYXJBdCgwKT9yYShhLGUpOnRoaXMuJCRodG1sNT9lOlwiXCI7aWYoIXYoZSkpdGhyb3cgU2IoXCJpaHNocHJmeFwiLGQsYSk7QWMoZSx0aGlzLGIpO2Q9dGhpcy4kJHBhdGg7dmFyIGY9L15cXC9bQS1aXTooXFwvLiopLzswPT09ZS5pbmRleE9mKGIpJiYoZT1lLnJlcGxhY2UoYixcIlwiKSk7Zi5leGVjKGUpfHwoZD0oZT1mLmV4ZWMoZCkpP2VbMV06ZCk7dGhpcy4kJHBhdGg9ZDt0aGlzLiQkY29tcG9zZSgpfTt0aGlzLiQkY29tcG9zZT1mdW5jdGlvbigpe3ZhciBjPUNiKHRoaXMuJCRzZWFyY2gpLGU9dGhpcy4kJGhhc2g/XG5cIiNcIitsYih0aGlzLiQkaGFzaCk6XCJcIjt0aGlzLiQkdXJsPVFiKHRoaXMuJCRwYXRoKSsoYz9cIj9cIitjOlwiXCIpK2U7dGhpcy4kJGFic1VybD1iKyh0aGlzLiQkdXJsP2ErdGhpcy4kJHVybDpcIlwiKX07dGhpcy4kJHJld3JpdGU9ZnVuY3Rpb24oYSl7aWYoZWIoYik9PWViKGEpKXJldHVybiBhfX1mdW5jdGlvbiBVYihiLGEpe3RoaXMuJCRodG1sNT0hMDtUYi5hcHBseSh0aGlzLGFyZ3VtZW50cyk7dmFyIGM9UmIoYik7dGhpcy4kJHJld3JpdGU9ZnVuY3Rpb24oZCl7dmFyIGU7aWYoYj09ZWIoZCkpcmV0dXJuIGQ7aWYoZT1yYShjLGQpKXJldHVybiBiK2ErZTtpZihjPT09ZCtcIi9cIilyZXR1cm4gY307dGhpcy4kJGNvbXBvc2U9ZnVuY3Rpb24oKXt2YXIgYz1DYih0aGlzLiQkc2VhcmNoKSxlPXRoaXMuJCRoYXNoP1wiI1wiK2xiKHRoaXMuJCRoYXNoKTpcIlwiO3RoaXMuJCR1cmw9UWIodGhpcy4kJHBhdGgpKyhjP1wiP1wiK2M6XCJcIikrZTt0aGlzLiQkYWJzVXJsPWIrYSt0aGlzLiQkdXJsfX1mdW5jdGlvbiB0YihiKXtyZXR1cm4gZnVuY3Rpb24oKXtyZXR1cm4gdGhpc1tiXX19XG5mdW5jdGlvbiBDYyhiLGEpe3JldHVybiBmdW5jdGlvbihjKXtpZih4KGMpKXJldHVybiB0aGlzW2JdO3RoaXNbYl09YShjKTt0aGlzLiQkY29tcG9zZSgpO3JldHVybiB0aGlzfX1mdW5jdGlvbiBXZCgpe3ZhciBiPVwiXCIsYT0hMTt0aGlzLmhhc2hQcmVmaXg9ZnVuY3Rpb24oYSl7cmV0dXJuIHkoYSk/KGI9YSx0aGlzKTpifTt0aGlzLmh0bWw1TW9kZT1mdW5jdGlvbihiKXtyZXR1cm4geShiKT8oYT1iLHRoaXMpOmF9O3RoaXMuJGdldD1bXCIkcm9vdFNjb3BlXCIsXCIkYnJvd3NlclwiLFwiJHNuaWZmZXJcIixcIiRyb290RWxlbWVudFwiLGZ1bmN0aW9uKGMsZCxlLGYpe2Z1bmN0aW9uIGcoYSl7Yy4kYnJvYWRjYXN0KFwiJGxvY2F0aW9uQ2hhbmdlU3VjY2Vzc1wiLGsuYWJzVXJsKCksYSl9dmFyIGssbSxoPWQuYmFzZUhyZWYoKSxsPWQudXJsKCksbjthPyhuPWwuc3Vic3RyaW5nKDAsbC5pbmRleE9mKFwiL1wiLGwuaW5kZXhPZihcIi8vXCIpKzIpKSsoaHx8XCIvXCIpLG09ZS5oaXN0b3J5P0JjOlViKToobj1cbmViKGwpLG09VGIpO2s9bmV3IG0obixcIiNcIitiKTtrLiQkcGFyc2Uoay4kJHJld3JpdGUobCkpO3ZhciBwPS9eXFxzKihqYXZhc2NyaXB0fG1haWx0byk6L2k7Zi5vbihcImNsaWNrXCIsZnVuY3Rpb24oYSl7aWYoIWEuY3RybEtleSYmIWEubWV0YUtleSYmMiE9YS53aGljaCl7Zm9yKHZhciBlPXcoYS50YXJnZXQpO1wiYVwiIT09SyhlWzBdLm5vZGVOYW1lKTspaWYoZVswXT09PWZbMF18fCEoZT1lLnBhcmVudCgpKVswXSlyZXR1cm47dmFyIGc9ZS5wcm9wKFwiaHJlZlwiKTtUKGcpJiZcIltvYmplY3QgU1ZHQW5pbWF0ZWRTdHJpbmddXCI9PT1nLnRvU3RyaW5nKCkmJihnPXVhKGcuYW5pbVZhbCkuaHJlZik7aWYoIXAudGVzdChnKSl7aWYobT09PVViKXt2YXIgaD1lLmF0dHIoXCJocmVmXCIpfHxlLmF0dHIoXCJ4bGluazpocmVmXCIpO2lmKGgmJjA+aC5pbmRleE9mKFwiOi8vXCIpKWlmKGc9XCIjXCIrYixcIi9cIj09aFswXSlnPW4rZytoO2Vsc2UgaWYoXCIjXCI9PWhbMF0pZz1uK2crKGsucGF0aCgpfHxcIi9cIikraDtcbmVsc2V7dmFyIGw9ay5wYXRoKCkuc3BsaXQoXCIvXCIpLGg9aC5zcGxpdChcIi9cIik7MiE9PWwubGVuZ3RofHxsWzFdfHwobC5sZW5ndGg9MSk7Zm9yKHZhciBxPTA7cTxoLmxlbmd0aDtxKyspXCIuXCIhPWhbcV0mJihcIi4uXCI9PWhbcV0/bC5wb3AoKTpoW3FdLmxlbmd0aCYmbC5wdXNoKGhbcV0pKTtnPW4rZytsLmpvaW4oXCIvXCIpfX1sPWsuJCRyZXdyaXRlKGcpO2cmJighZS5hdHRyKFwidGFyZ2V0XCIpJiZsJiYhYS5pc0RlZmF1bHRQcmV2ZW50ZWQoKSkmJihhLnByZXZlbnREZWZhdWx0KCksbCE9ZC51cmwoKSYmKGsuJCRwYXJzZShsKSxjLiRhcHBseSgpLFcuYW5ndWxhcltcImZmLTY4NDIwOC1wcmV2ZW50RGVmYXVsdFwiXT0hMCkpfX19KTtrLmFic1VybCgpIT1sJiZkLnVybChrLmFic1VybCgpLCEwKTtkLm9uVXJsQ2hhbmdlKGZ1bmN0aW9uKGEpe2suYWJzVXJsKCkhPWEmJihjLiRldmFsQXN5bmMoZnVuY3Rpb24oKXt2YXIgYj1rLmFic1VybCgpO2suJCRwYXJzZShhKTtjLiRicm9hZGNhc3QoXCIkbG9jYXRpb25DaGFuZ2VTdGFydFwiLFxuYSxiKS5kZWZhdWx0UHJldmVudGVkPyhrLiQkcGFyc2UoYiksZC51cmwoYikpOmcoYil9KSxjLiQkcGhhc2V8fGMuJGRpZ2VzdCgpKX0pO3ZhciBxPTA7Yy4kd2F0Y2goZnVuY3Rpb24oKXt2YXIgYT1kLnVybCgpLGI9ay4kJHJlcGxhY2U7cSYmYT09ay5hYnNVcmwoKXx8KHErKyxjLiRldmFsQXN5bmMoZnVuY3Rpb24oKXtjLiRicm9hZGNhc3QoXCIkbG9jYXRpb25DaGFuZ2VTdGFydFwiLGsuYWJzVXJsKCksYSkuZGVmYXVsdFByZXZlbnRlZD9rLiQkcGFyc2UoYSk6KGQudXJsKGsuYWJzVXJsKCksYiksZyhhKSl9KSk7ay4kJHJlcGxhY2U9ITE7cmV0dXJuIHF9KTtyZXR1cm4ga31dfWZ1bmN0aW9uIFhkKCl7dmFyIGI9ITAsYT10aGlzO3RoaXMuZGVidWdFbmFibGVkPWZ1bmN0aW9uKGEpe3JldHVybiB5KGEpPyhiPWEsdGhpcyk6Yn07dGhpcy4kZ2V0PVtcIiR3aW5kb3dcIixmdW5jdGlvbihjKXtmdW5jdGlvbiBkKGEpe2EgaW5zdGFuY2VvZiBFcnJvciYmKGEuc3RhY2s/YT1hLm1lc3NhZ2UmJlxuLTE9PT1hLnN0YWNrLmluZGV4T2YoYS5tZXNzYWdlKT9cIkVycm9yOiBcIithLm1lc3NhZ2UrXCJcXG5cIithLnN0YWNrOmEuc3RhY2s6YS5zb3VyY2VVUkwmJihhPWEubWVzc2FnZStcIlxcblwiK2Euc291cmNlVVJMK1wiOlwiK2EubGluZSkpO3JldHVybiBhfWZ1bmN0aW9uIGUoYSl7dmFyIGI9Yy5jb25zb2xlfHx7fSxlPWJbYV18fGIubG9nfHxFO2E9ITE7dHJ5e2E9ISFlLmFwcGx5fWNhdGNoKG0pe31yZXR1cm4gYT9mdW5jdGlvbigpe3ZhciBhPVtdO3IoYXJndW1lbnRzLGZ1bmN0aW9uKGIpe2EucHVzaChkKGIpKX0pO3JldHVybiBlLmFwcGx5KGIsYSl9OmZ1bmN0aW9uKGEsYil7ZShhLG51bGw9PWI/XCJcIjpiKX19cmV0dXJue2xvZzplKFwibG9nXCIpLGluZm86ZShcImluZm9cIiksd2FybjplKFwid2FyblwiKSxlcnJvcjplKFwiZXJyb3JcIiksZGVidWc6ZnVuY3Rpb24oKXt2YXIgYz1lKFwiZGVidWdcIik7cmV0dXJuIGZ1bmN0aW9uKCl7YiYmYy5hcHBseShhLGFyZ3VtZW50cyl9fSgpfX1dfWZ1bmN0aW9uIGthKGIsXG5hKXtpZihcIl9fZGVmaW5lR2V0dGVyX19cIj09PWJ8fFwiX19kZWZpbmVTZXR0ZXJfX1wiPT09Ynx8XCJfX2xvb2t1cEdldHRlcl9fXCI9PT1ifHxcIl9fbG9va3VwU2V0dGVyX19cIj09PWJ8fFwiX19wcm90b19fXCI9PT1iKXRocm93IGxhKFwiaXNlY2ZsZFwiLGEpO3JldHVybiBifWZ1bmN0aW9uIHZhKGIsYSl7aWYoYil7aWYoYi5jb25zdHJ1Y3Rvcj09PWIpdGhyb3cgbGEoXCJpc2VjZm5cIixhKTtpZihiLmRvY3VtZW50JiZiLmxvY2F0aW9uJiZiLmFsZXJ0JiZiLnNldEludGVydmFsKXRocm93IGxhKFwiaXNlY3dpbmRvd1wiLGEpO2lmKGIuY2hpbGRyZW4mJihiLm5vZGVOYW1lfHxiLnByb3AmJmIuYXR0ciYmYi5maW5kKSl0aHJvdyBsYShcImlzZWNkb21cIixhKTtpZihiPT09T2JqZWN0KXRocm93IGxhKFwiaXNlY29ialwiLGEpO31yZXR1cm4gYn1mdW5jdGlvbiB1YihiLGEsYyxkLGUpe3ZhKGIsZCk7ZT1lfHx7fTthPWEuc3BsaXQoXCIuXCIpO2Zvcih2YXIgZixnPTA7MTxhLmxlbmd0aDtnKyspe2Y9a2EoYS5zaGlmdCgpLFxuZCk7dmFyIGs9dmEoYltmXSxkKTtrfHwoaz17fSxiW2ZdPWspO2I9aztiLnRoZW4mJmUudW53cmFwUHJvbWlzZXMmJih3YShkKSxcIiQkdlwiaW4gYnx8ZnVuY3Rpb24oYSl7YS50aGVuKGZ1bmN0aW9uKGIpe2EuJCR2PWJ9KX0oYiksYi4kJHY9PT10JiYoYi4kJHY9e30pLGI9Yi4kJHYpfWY9a2EoYS5zaGlmdCgpLGQpO3ZhKGJbZl0sZCk7cmV0dXJuIGJbZl09Y31mdW5jdGlvbiBEYyhiLGEsYyxkLGUsZixnKXtrYShiLGYpO2thKGEsZik7a2EoYyxmKTtrYShkLGYpO2thKGUsZik7cmV0dXJuIGcudW53cmFwUHJvbWlzZXM/ZnVuY3Rpb24oZyxtKXt2YXIgaD1tJiZtLmhhc093blByb3BlcnR5KGIpP206ZyxsO2lmKG51bGw9PWgpcmV0dXJuIGg7KGg9aFtiXSkmJmgudGhlbiYmKHdhKGYpLFwiJCR2XCJpbiBofHwobD1oLGwuJCR2PXQsbC50aGVuKGZ1bmN0aW9uKGEpe2wuJCR2PWF9KSksaD1oLiQkdik7aWYoIWEpcmV0dXJuIGg7aWYobnVsbD09aClyZXR1cm4gdDsoaD1oW2FdKSYmaC50aGVuJiZcbih3YShmKSxcIiQkdlwiaW4gaHx8KGw9aCxsLiQkdj10LGwudGhlbihmdW5jdGlvbihhKXtsLiQkdj1hfSkpLGg9aC4kJHYpO2lmKCFjKXJldHVybiBoO2lmKG51bGw9PWgpcmV0dXJuIHQ7KGg9aFtjXSkmJmgudGhlbiYmKHdhKGYpLFwiJCR2XCJpbiBofHwobD1oLGwuJCR2PXQsbC50aGVuKGZ1bmN0aW9uKGEpe2wuJCR2PWF9KSksaD1oLiQkdik7aWYoIWQpcmV0dXJuIGg7aWYobnVsbD09aClyZXR1cm4gdDsoaD1oW2RdKSYmaC50aGVuJiYod2EoZiksXCIkJHZcImluIGh8fChsPWgsbC4kJHY9dCxsLnRoZW4oZnVuY3Rpb24oYSl7bC4kJHY9YX0pKSxoPWguJCR2KTtpZighZSlyZXR1cm4gaDtpZihudWxsPT1oKXJldHVybiB0OyhoPWhbZV0pJiZoLnRoZW4mJih3YShmKSxcIiQkdlwiaW4gaHx8KGw9aCxsLiQkdj10LGwudGhlbihmdW5jdGlvbihhKXtsLiQkdj1hfSkpLGg9aC4kJHYpO3JldHVybiBofTpmdW5jdGlvbihmLGcpe3ZhciBoPWcmJmcuaGFzT3duUHJvcGVydHkoYik/ZzpmO2lmKG51bGw9PVxuaClyZXR1cm4gaDtoPWhbYl07aWYoIWEpcmV0dXJuIGg7aWYobnVsbD09aClyZXR1cm4gdDtoPWhbYV07aWYoIWMpcmV0dXJuIGg7aWYobnVsbD09aClyZXR1cm4gdDtoPWhbY107aWYoIWQpcmV0dXJuIGg7aWYobnVsbD09aClyZXR1cm4gdDtoPWhbZF07cmV0dXJuIGU/bnVsbD09aD90Omg9aFtlXTpofX1mdW5jdGlvbiBFYyhiLGEsYyl7aWYoVmIuaGFzT3duUHJvcGVydHkoYikpcmV0dXJuIFZiW2JdO3ZhciBkPWIuc3BsaXQoXCIuXCIpLGU9ZC5sZW5ndGgsZjtpZihhLmNzcClmPTY+ZT9EYyhkWzBdLGRbMV0sZFsyXSxkWzNdLGRbNF0sYyxhKTpmdW5jdGlvbihiLGYpe3ZhciBnPTAsaztkbyBrPURjKGRbZysrXSxkW2crK10sZFtnKytdLGRbZysrXSxkW2crK10sYyxhKShiLGYpLGY9dCxiPWs7d2hpbGUoZzxlKTtyZXR1cm4ga307ZWxzZXt2YXIgZz1cInZhciBwO1xcblwiO3IoZCxmdW5jdGlvbihiLGQpe2thKGIsYyk7Zys9XCJpZihzID09IG51bGwpIHJldHVybiB1bmRlZmluZWQ7XFxucz1cIitcbihkP1wic1wiOicoKGsmJmsuaGFzT3duUHJvcGVydHkoXCInK2IrJ1wiKSk/azpzKScpKydbXCInK2IrJ1wiXTtcXG4nKyhhLnVud3JhcFByb21pc2VzPydpZiAocyAmJiBzLnRoZW4pIHtcXG4gcHcoXCInK2MucmVwbGFjZSgvKFtcIlxcclxcbl0pL2csXCJcXFxcJDFcIikrJ1wiKTtcXG4gaWYgKCEoXCIkJHZcIiBpbiBzKSkge1xcbiBwPXM7XFxuIHAuJCR2ID0gdW5kZWZpbmVkO1xcbiBwLnRoZW4oZnVuY3Rpb24odikge3AuJCR2PXY7fSk7XFxufVxcbiBzPXMuJCR2XFxufVxcbic6XCJcIil9KTt2YXIgZz1nK1wicmV0dXJuIHM7XCIsaz1uZXcgRnVuY3Rpb24oXCJzXCIsXCJrXCIsXCJwd1wiLGcpO2sudG9TdHJpbmc9YmEoZyk7Zj1hLnVud3JhcFByb21pc2VzP2Z1bmN0aW9uKGEsYil7cmV0dXJuIGsoYSxiLHdhKX06a31cImhhc093blByb3BlcnR5XCIhPT1iJiYoVmJbYl09Zik7cmV0dXJuIGZ9ZnVuY3Rpb24gWWQoKXt2YXIgYj17fSxhPXtjc3A6ITEsdW53cmFwUHJvbWlzZXM6ITEsbG9nUHJvbWlzZVdhcm5pbmdzOiEwfTt0aGlzLnVud3JhcFByb21pc2VzPVxuZnVuY3Rpb24oYil7cmV0dXJuIHkoYik/KGEudW53cmFwUHJvbWlzZXM9ISFiLHRoaXMpOmEudW53cmFwUHJvbWlzZXN9O3RoaXMubG9nUHJvbWlzZVdhcm5pbmdzPWZ1bmN0aW9uKGIpe3JldHVybiB5KGIpPyhhLmxvZ1Byb21pc2VXYXJuaW5ncz1iLHRoaXMpOmEubG9nUHJvbWlzZVdhcm5pbmdzfTt0aGlzLiRnZXQ9W1wiJGZpbHRlclwiLFwiJHNuaWZmZXJcIixcIiRsb2dcIixmdW5jdGlvbihjLGQsZSl7YS5jc3A9ZC5jc3A7d2E9ZnVuY3Rpb24oYil7YS5sb2dQcm9taXNlV2FybmluZ3MmJiFGYy5oYXNPd25Qcm9wZXJ0eShiKSYmKEZjW2JdPSEwLGUud2FybihcIlskcGFyc2VdIFByb21pc2UgZm91bmQgaW4gdGhlIGV4cHJlc3Npb24gYFwiK2IrXCJgLiBBdXRvbWF0aWMgdW53cmFwcGluZyBvZiBwcm9taXNlcyBpbiBBbmd1bGFyIGV4cHJlc3Npb25zIGlzIGRlcHJlY2F0ZWQuXCIpKX07cmV0dXJuIGZ1bmN0aW9uKGQpe3ZhciBlO3N3aXRjaCh0eXBlb2YgZCl7Y2FzZSBcInN0cmluZ1wiOmlmKGIuaGFzT3duUHJvcGVydHkoZCkpcmV0dXJuIGJbZF07XG5lPW5ldyBXYihhKTtlPShuZXcgZmIoZSxjLGEpKS5wYXJzZShkKTtcImhhc093blByb3BlcnR5XCIhPT1kJiYoYltkXT1lKTtyZXR1cm4gZTtjYXNlIFwiZnVuY3Rpb25cIjpyZXR1cm4gZDtkZWZhdWx0OnJldHVybiBFfX19XX1mdW5jdGlvbiAkZCgpe3RoaXMuJGdldD1bXCIkcm9vdFNjb3BlXCIsXCIkZXhjZXB0aW9uSGFuZGxlclwiLGZ1bmN0aW9uKGIsYSl7cmV0dXJuIEFlKGZ1bmN0aW9uKGEpe2IuJGV2YWxBc3luYyhhKX0sYSl9XX1mdW5jdGlvbiBBZShiLGEpe2Z1bmN0aW9uIGMoYSl7cmV0dXJuIGF9ZnVuY3Rpb24gZChhKXtyZXR1cm4gZyhhKX12YXIgZT1mdW5jdGlvbigpe3ZhciBnPVtdLGgsbDtyZXR1cm4gbD17cmVzb2x2ZTpmdW5jdGlvbihhKXtpZihnKXt2YXIgYz1nO2c9dDtoPWYoYSk7Yy5sZW5ndGgmJmIoZnVuY3Rpb24oKXtmb3IodmFyIGEsYj0wLGQ9Yy5sZW5ndGg7YjxkO2IrKylhPWNbYl0saC50aGVuKGFbMF0sYVsxXSxhWzJdKX0pfX0scmVqZWN0OmZ1bmN0aW9uKGEpe2wucmVzb2x2ZShrKGEpKX0sXG5ub3RpZnk6ZnVuY3Rpb24oYSl7aWYoZyl7dmFyIGM9ZztnLmxlbmd0aCYmYihmdW5jdGlvbigpe2Zvcih2YXIgYixkPTAsZT1jLmxlbmd0aDtkPGU7ZCsrKWI9Y1tkXSxiWzJdKGEpfSl9fSxwcm9taXNlOnt0aGVuOmZ1bmN0aW9uKGIsZixrKXt2YXIgbD1lKCksRj1mdW5jdGlvbihkKXt0cnl7bC5yZXNvbHZlKChQKGIpP2I6YykoZCkpfWNhdGNoKGUpe2wucmVqZWN0KGUpLGEoZSl9fSx1PWZ1bmN0aW9uKGIpe3RyeXtsLnJlc29sdmUoKFAoZik/ZjpkKShiKSl9Y2F0Y2goYyl7bC5yZWplY3QoYyksYShjKX19LEE9ZnVuY3Rpb24oYil7dHJ5e2wubm90aWZ5KChQKGspP2s6YykoYikpfWNhdGNoKGQpe2EoZCl9fTtnP2cucHVzaChbRix1LEFdKTpoLnRoZW4oRix1LEEpO3JldHVybiBsLnByb21pc2V9LFwiY2F0Y2hcIjpmdW5jdGlvbihhKXtyZXR1cm4gdGhpcy50aGVuKG51bGwsYSl9LFwiZmluYWxseVwiOmZ1bmN0aW9uKGEpe2Z1bmN0aW9uIGIoYSxjKXt2YXIgZD1lKCk7Yz9kLnJlc29sdmUoYSk6XG5kLnJlamVjdChhKTtyZXR1cm4gZC5wcm9taXNlfWZ1bmN0aW9uIGQoZSxmKXt2YXIgZz1udWxsO3RyeXtnPShhfHxjKSgpfWNhdGNoKGspe3JldHVybiBiKGssITEpfXJldHVybiBnJiZQKGcudGhlbik/Zy50aGVuKGZ1bmN0aW9uKCl7cmV0dXJuIGIoZSxmKX0sZnVuY3Rpb24oYSl7cmV0dXJuIGIoYSwhMSl9KTpiKGUsZil9cmV0dXJuIHRoaXMudGhlbihmdW5jdGlvbihhKXtyZXR1cm4gZChhLCEwKX0sZnVuY3Rpb24oYSl7cmV0dXJuIGQoYSwhMSl9KX19fX0sZj1mdW5jdGlvbihhKXtyZXR1cm4gYSYmUChhLnRoZW4pP2E6e3RoZW46ZnVuY3Rpb24oYyl7dmFyIGQ9ZSgpO2IoZnVuY3Rpb24oKXtkLnJlc29sdmUoYyhhKSl9KTtyZXR1cm4gZC5wcm9taXNlfX19LGc9ZnVuY3Rpb24oYSl7dmFyIGI9ZSgpO2IucmVqZWN0KGEpO3JldHVybiBiLnByb21pc2V9LGs9ZnVuY3Rpb24oYyl7cmV0dXJue3RoZW46ZnVuY3Rpb24oZixnKXt2YXIgaz1lKCk7YihmdW5jdGlvbigpe3RyeXtrLnJlc29sdmUoKFAoZyk/XG5nOmQpKGMpKX1jYXRjaChiKXtrLnJlamVjdChiKSxhKGIpfX0pO3JldHVybiBrLnByb21pc2V9fX07cmV0dXJue2RlZmVyOmUscmVqZWN0Omcsd2hlbjpmdW5jdGlvbihrLGgsbCxuKXt2YXIgcD1lKCkscSxzPWZ1bmN0aW9uKGIpe3RyeXtyZXR1cm4oUChoKT9oOmMpKGIpfWNhdGNoKGQpe3JldHVybiBhKGQpLGcoZCl9fSxGPWZ1bmN0aW9uKGIpe3RyeXtyZXR1cm4oUChsKT9sOmQpKGIpfWNhdGNoKGMpe3JldHVybiBhKGMpLGcoYyl9fSx1PWZ1bmN0aW9uKGIpe3RyeXtyZXR1cm4oUChuKT9uOmMpKGIpfWNhdGNoKGQpe2EoZCl9fTtiKGZ1bmN0aW9uKCl7ZihrKS50aGVuKGZ1bmN0aW9uKGEpe3F8fChxPSEwLHAucmVzb2x2ZShmKGEpLnRoZW4ocyxGLHUpKSl9LGZ1bmN0aW9uKGEpe3F8fChxPSEwLHAucmVzb2x2ZShGKGEpKSl9LGZ1bmN0aW9uKGEpe3F8fHAubm90aWZ5KHUoYSkpfSl9KTtyZXR1cm4gcC5wcm9taXNlfSxhbGw6ZnVuY3Rpb24oYSl7dmFyIGI9ZSgpLGM9MCxkPUooYSk/XG5bXTp7fTtyKGEsZnVuY3Rpb24oYSxlKXtjKys7ZihhKS50aGVuKGZ1bmN0aW9uKGEpe2QuaGFzT3duUHJvcGVydHkoZSl8fChkW2VdPWEsLS1jfHxiLnJlc29sdmUoZCkpfSxmdW5jdGlvbihhKXtkLmhhc093blByb3BlcnR5KGUpfHxiLnJlamVjdChhKX0pfSk7MD09PWMmJmIucmVzb2x2ZShkKTtyZXR1cm4gYi5wcm9taXNlfX19ZnVuY3Rpb24gZ2UoKXt0aGlzLiRnZXQ9W1wiJHdpbmRvd1wiLFwiJHRpbWVvdXRcIixmdW5jdGlvbihiLGEpe3ZhciBjPWIucmVxdWVzdEFuaW1hdGlvbkZyYW1lfHxiLndlYmtpdFJlcXVlc3RBbmltYXRpb25GcmFtZXx8Yi5tb3pSZXF1ZXN0QW5pbWF0aW9uRnJhbWUsZD1iLmNhbmNlbEFuaW1hdGlvbkZyYW1lfHxiLndlYmtpdENhbmNlbEFuaW1hdGlvbkZyYW1lfHxiLm1vekNhbmNlbEFuaW1hdGlvbkZyYW1lfHxiLndlYmtpdENhbmNlbFJlcXVlc3RBbmltYXRpb25GcmFtZSxlPSEhYyxmPWU/ZnVuY3Rpb24oYSl7dmFyIGI9YyhhKTtyZXR1cm4gZnVuY3Rpb24oKXtkKGIpfX06XG5mdW5jdGlvbihiKXt2YXIgYz1hKGIsMTYuNjYsITEpO3JldHVybiBmdW5jdGlvbigpe2EuY2FuY2VsKGMpfX07Zi5zdXBwb3J0ZWQ9ZTtyZXR1cm4gZn1dfWZ1bmN0aW9uIFpkKCl7dmFyIGI9MTAsYT1DKFwiJHJvb3RTY29wZVwiKSxjPW51bGw7dGhpcy5kaWdlc3RUdGw9ZnVuY3Rpb24oYSl7YXJndW1lbnRzLmxlbmd0aCYmKGI9YSk7cmV0dXJuIGJ9O3RoaXMuJGdldD1bXCIkaW5qZWN0b3JcIixcIiRleGNlcHRpb25IYW5kbGVyXCIsXCIkcGFyc2VcIixcIiRicm93c2VyXCIsZnVuY3Rpb24oZCxlLGYsZyl7ZnVuY3Rpb24gaygpe3RoaXMuJGlkPWhiKCk7dGhpcy4kJHBoYXNlPXRoaXMuJHBhcmVudD10aGlzLiQkd2F0Y2hlcnM9dGhpcy4kJG5leHRTaWJsaW5nPXRoaXMuJCRwcmV2U2libGluZz10aGlzLiQkY2hpbGRIZWFkPXRoaXMuJCRjaGlsZFRhaWw9bnVsbDt0aGlzW1widGhpc1wiXT10aGlzLiRyb290PXRoaXM7dGhpcy4kJGRlc3Ryb3llZD0hMTt0aGlzLiQkYXN5bmNRdWV1ZT1bXTt0aGlzLiQkcG9zdERpZ2VzdFF1ZXVlPVxuW107dGhpcy4kJGxpc3RlbmVycz17fTt0aGlzLiQkbGlzdGVuZXJDb3VudD17fTt0aGlzLiQkaXNvbGF0ZUJpbmRpbmdzPXt9fWZ1bmN0aW9uIG0oYil7aWYocC4kJHBoYXNlKXRocm93IGEoXCJpbnByb2dcIixwLiQkcGhhc2UpO3AuJCRwaGFzZT1ifWZ1bmN0aW9uIGgoYSxiKXt2YXIgYz1mKGEpO1dhKGMsYik7cmV0dXJuIGN9ZnVuY3Rpb24gbChhLGIsYyl7ZG8gYS4kJGxpc3RlbmVyQ291bnRbY10tPWIsMD09PWEuJCRsaXN0ZW5lckNvdW50W2NdJiZkZWxldGUgYS4kJGxpc3RlbmVyQ291bnRbY107d2hpbGUoYT1hLiRwYXJlbnQpfWZ1bmN0aW9uIG4oKXt9ay5wcm90b3R5cGU9e2NvbnN0cnVjdG9yOmssJG5ldzpmdW5jdGlvbihhKXthPyhhPW5ldyBrLGEuJHJvb3Q9dGhpcy4kcm9vdCxhLiQkYXN5bmNRdWV1ZT10aGlzLiQkYXN5bmNRdWV1ZSxhLiQkcG9zdERpZ2VzdFF1ZXVlPXRoaXMuJCRwb3N0RGlnZXN0UXVldWUpOih0aGlzLiQkY2hpbGRTY29wZUNsYXNzfHwodGhpcy4kJGNoaWxkU2NvcGVDbGFzcz1cbmZ1bmN0aW9uKCl7dGhpcy4kJHdhdGNoZXJzPXRoaXMuJCRuZXh0U2libGluZz10aGlzLiQkY2hpbGRIZWFkPXRoaXMuJCRjaGlsZFRhaWw9bnVsbDt0aGlzLiQkbGlzdGVuZXJzPXt9O3RoaXMuJCRsaXN0ZW5lckNvdW50PXt9O3RoaXMuJGlkPWhiKCk7dGhpcy4kJGNoaWxkU2NvcGVDbGFzcz1udWxsfSx0aGlzLiQkY2hpbGRTY29wZUNsYXNzLnByb3RvdHlwZT10aGlzKSxhPW5ldyB0aGlzLiQkY2hpbGRTY29wZUNsYXNzKTthW1widGhpc1wiXT1hO2EuJHBhcmVudD10aGlzO2EuJCRwcmV2U2libGluZz10aGlzLiQkY2hpbGRUYWlsO3RoaXMuJCRjaGlsZEhlYWQ/dGhpcy4kJGNoaWxkVGFpbD10aGlzLiQkY2hpbGRUYWlsLiQkbmV4dFNpYmxpbmc9YTp0aGlzLiQkY2hpbGRIZWFkPXRoaXMuJCRjaGlsZFRhaWw9YTtyZXR1cm4gYX0sJHdhdGNoOmZ1bmN0aW9uKGEsYixkKXt2YXIgZT1oKGEsXCJ3YXRjaFwiKSxmPXRoaXMuJCR3YXRjaGVycyxnPXtmbjpiLGxhc3Q6bixnZXQ6ZSxleHA6YSxcbmVxOiEhZH07Yz1udWxsO2lmKCFQKGIpKXt2YXIgaz1oKGJ8fEUsXCJsaXN0ZW5lclwiKTtnLmZuPWZ1bmN0aW9uKGEsYixjKXtrKGMpfX1pZihcInN0cmluZ1wiPT10eXBlb2YgYSYmZS5jb25zdGFudCl7dmFyIGw9Zy5mbjtnLmZuPWZ1bmN0aW9uKGEsYixjKXtsLmNhbGwodGhpcyxhLGIsYyk7U2EoZixnKX19Znx8KGY9dGhpcy4kJHdhdGNoZXJzPVtdKTtmLnVuc2hpZnQoZyk7cmV0dXJuIGZ1bmN0aW9uKCl7U2EoZixnKTtjPW51bGx9fSwkd2F0Y2hDb2xsZWN0aW9uOmZ1bmN0aW9uKGEsYil7dmFyIGM9dGhpcyxkLGUsZyxrPTE8Yi5sZW5ndGgsaD0wLGw9ZihhKSxtPVtdLHA9e30sbj0hMCxyPTA7cmV0dXJuIHRoaXMuJHdhdGNoKGZ1bmN0aW9uKCl7ZD1sKGMpO3ZhciBhLGIsZjtpZihUKGQpKWlmKFBhKGQpKWZvcihlIT09bSYmKGU9bSxyPWUubGVuZ3RoPTAsaCsrKSxhPWQubGVuZ3RoLHIhPT1hJiYoaCsrLGUubGVuZ3RoPXI9YSksYj0wO2I8YTtiKyspZj1lW2JdIT09ZVtiXSYmZFtiXSE9PVxuZFtiXSxmfHxlW2JdPT09ZFtiXXx8KGgrKyxlW2JdPWRbYl0pO2Vsc2V7ZSE9PXAmJihlPXA9e30scj0wLGgrKyk7YT0wO2ZvcihiIGluIGQpZC5oYXNPd25Qcm9wZXJ0eShiKSYmKGErKyxlLmhhc093blByb3BlcnR5KGIpPyhmPWVbYl0hPT1lW2JdJiZkW2JdIT09ZFtiXSxmfHxlW2JdPT09ZFtiXXx8KGgrKyxlW2JdPWRbYl0pKToocisrLGVbYl09ZFtiXSxoKyspKTtpZihyPmEpZm9yKGIgaW4gaCsrLGUpZS5oYXNPd25Qcm9wZXJ0eShiKSYmIWQuaGFzT3duUHJvcGVydHkoYikmJihyLS0sZGVsZXRlIGVbYl0pfWVsc2UgZSE9PWQmJihlPWQsaCsrKTtyZXR1cm4gaH0sZnVuY3Rpb24oKXtuPyhuPSExLGIoZCxkLGMpKTpiKGQsZyxjKTtpZihrKWlmKFQoZCkpaWYoUGEoZCkpe2c9QXJyYXkoZC5sZW5ndGgpO2Zvcih2YXIgYT0wO2E8ZC5sZW5ndGg7YSsrKWdbYV09ZFthXX1lbHNlIGZvcihhIGluIGc9e30sZClrYi5jYWxsKGQsYSkmJihnW2FdPWRbYV0pO2Vsc2UgZz1kfSl9LCRkaWdlc3Q6ZnVuY3Rpb24oKXt2YXIgZCxcbmYsayxoLGw9dGhpcy4kJGFzeW5jUXVldWUscj10aGlzLiQkcG9zdERpZ2VzdFF1ZXVlLFIseix0PWIsTCxPPVtdLHcsQixJO20oXCIkZGlnZXN0XCIpO2cuJCRjaGVja1VybENoYW5nZSgpO2M9bnVsbDtkb3t6PSExO2ZvcihMPXRoaXM7bC5sZW5ndGg7KXt0cnl7ST1sLnNoaWZ0KCksSS5zY29wZS4kZXZhbChJLmV4cHJlc3Npb24pfWNhdGNoKEgpe3AuJCRwaGFzZT1udWxsLGUoSCl9Yz1udWxsfWE6ZG97aWYoaD1MLiQkd2F0Y2hlcnMpZm9yKFI9aC5sZW5ndGg7Ui0tOyl0cnl7aWYoZD1oW1JdKWlmKChmPWQuZ2V0KEwpKSE9PShrPWQubGFzdCkmJiEoZC5lcT9BYShmLGspOlwibnVtYmVyXCI9PT10eXBlb2YgZiYmXCJudW1iZXJcIj09PXR5cGVvZiBrJiZpc05hTihmKSYmaXNOYU4oaykpKXo9ITAsYz1kLGQubGFzdD1kLmVxP0hhKGYsbnVsbCk6ZixkLmZuKGYsaz09PW4/ZjprLEwpLDU+dCYmKHc9NC10LE9bd118fChPW3ddPVtdKSxCPVAoZC5leHApP1wiZm46IFwiKyhkLmV4cC5uYW1lfHxkLmV4cC50b1N0cmluZygpKTpcbmQuZXhwLEIrPVwiOyBuZXdWYWw6IFwiK25hKGYpK1wiOyBvbGRWYWw6IFwiK25hKGspLE9bd10ucHVzaChCKSk7ZWxzZSBpZihkPT09Yyl7ej0hMTticmVhayBhfX1jYXRjaCh5KXtwLiQkcGhhc2U9bnVsbCxlKHkpfWlmKCEoaD1MLiQkY2hpbGRIZWFkfHxMIT09dGhpcyYmTC4kJG5leHRTaWJsaW5nKSlmb3IoO0whPT10aGlzJiYhKGg9TC4kJG5leHRTaWJsaW5nKTspTD1MLiRwYXJlbnR9d2hpbGUoTD1oKTtpZigoenx8bC5sZW5ndGgpJiYhdC0tKXRocm93IHAuJCRwaGFzZT1udWxsLGEoXCJpbmZkaWdcIixiLG5hKE8pKTt9d2hpbGUoenx8bC5sZW5ndGgpO2ZvcihwLiQkcGhhc2U9bnVsbDtyLmxlbmd0aDspdHJ5e3Iuc2hpZnQoKSgpfWNhdGNoKHYpe2Uodil9fSwkZGVzdHJveTpmdW5jdGlvbigpe2lmKCF0aGlzLiQkZGVzdHJveWVkKXt2YXIgYT10aGlzLiRwYXJlbnQ7dGhpcy4kYnJvYWRjYXN0KFwiJGRlc3Ryb3lcIik7dGhpcy4kJGRlc3Ryb3llZD0hMDt0aGlzIT09cCYmKHIodGhpcy4kJGxpc3RlbmVyQ291bnQsXG5CYihudWxsLGwsdGhpcykpLGEuJCRjaGlsZEhlYWQ9PXRoaXMmJihhLiQkY2hpbGRIZWFkPXRoaXMuJCRuZXh0U2libGluZyksYS4kJGNoaWxkVGFpbD09dGhpcyYmKGEuJCRjaGlsZFRhaWw9dGhpcy4kJHByZXZTaWJsaW5nKSx0aGlzLiQkcHJldlNpYmxpbmcmJih0aGlzLiQkcHJldlNpYmxpbmcuJCRuZXh0U2libGluZz10aGlzLiQkbmV4dFNpYmxpbmcpLHRoaXMuJCRuZXh0U2libGluZyYmKHRoaXMuJCRuZXh0U2libGluZy4kJHByZXZTaWJsaW5nPXRoaXMuJCRwcmV2U2libGluZyksdGhpcy4kcGFyZW50PXRoaXMuJCRuZXh0U2libGluZz10aGlzLiQkcHJldlNpYmxpbmc9dGhpcy4kJGNoaWxkSGVhZD10aGlzLiQkY2hpbGRUYWlsPXRoaXMuJHJvb3Q9bnVsbCx0aGlzLiQkbGlzdGVuZXJzPXt9LHRoaXMuJCR3YXRjaGVycz10aGlzLiQkYXN5bmNRdWV1ZT10aGlzLiQkcG9zdERpZ2VzdFF1ZXVlPVtdLHRoaXMuJGRlc3Ryb3k9dGhpcy4kZGlnZXN0PXRoaXMuJGFwcGx5PUUsdGhpcy4kb249XG50aGlzLiR3YXRjaD1mdW5jdGlvbigpe3JldHVybiBFfSl9fSwkZXZhbDpmdW5jdGlvbihhLGIpe3JldHVybiBmKGEpKHRoaXMsYil9LCRldmFsQXN5bmM6ZnVuY3Rpb24oYSl7cC4kJHBoYXNlfHxwLiQkYXN5bmNRdWV1ZS5sZW5ndGh8fGcuZGVmZXIoZnVuY3Rpb24oKXtwLiQkYXN5bmNRdWV1ZS5sZW5ndGgmJnAuJGRpZ2VzdCgpfSk7dGhpcy4kJGFzeW5jUXVldWUucHVzaCh7c2NvcGU6dGhpcyxleHByZXNzaW9uOmF9KX0sJCRwb3N0RGlnZXN0OmZ1bmN0aW9uKGEpe3RoaXMuJCRwb3N0RGlnZXN0UXVldWUucHVzaChhKX0sJGFwcGx5OmZ1bmN0aW9uKGEpe3RyeXtyZXR1cm4gbShcIiRhcHBseVwiKSx0aGlzLiRldmFsKGEpfWNhdGNoKGIpe2UoYil9ZmluYWxseXtwLiQkcGhhc2U9bnVsbDt0cnl7cC4kZGlnZXN0KCl9Y2F0Y2goYyl7dGhyb3cgZShjKSxjO319fSwkb246ZnVuY3Rpb24oYSxiKXt2YXIgYz10aGlzLiQkbGlzdGVuZXJzW2FdO2N8fCh0aGlzLiQkbGlzdGVuZXJzW2FdPVxuYz1bXSk7Yy5wdXNoKGIpO3ZhciBkPXRoaXM7ZG8gZC4kJGxpc3RlbmVyQ291bnRbYV18fChkLiQkbGlzdGVuZXJDb3VudFthXT0wKSxkLiQkbGlzdGVuZXJDb3VudFthXSsrO3doaWxlKGQ9ZC4kcGFyZW50KTt2YXIgZT10aGlzO3JldHVybiBmdW5jdGlvbigpe2NbUmEoYyxiKV09bnVsbDtsKGUsMSxhKX19LCRlbWl0OmZ1bmN0aW9uKGEsYil7dmFyIGM9W10sZCxmPXRoaXMsZz0hMSxrPXtuYW1lOmEsdGFyZ2V0U2NvcGU6ZixzdG9wUHJvcGFnYXRpb246ZnVuY3Rpb24oKXtnPSEwfSxwcmV2ZW50RGVmYXVsdDpmdW5jdGlvbigpe2suZGVmYXVsdFByZXZlbnRlZD0hMH0sZGVmYXVsdFByZXZlbnRlZDohMX0saD1ba10uY29uY2F0KEJhLmNhbGwoYXJndW1lbnRzLDEpKSxsLG07ZG97ZD1mLiQkbGlzdGVuZXJzW2FdfHxjO2suY3VycmVudFNjb3BlPWY7bD0wO2ZvcihtPWQubGVuZ3RoO2w8bTtsKyspaWYoZFtsXSl0cnl7ZFtsXS5hcHBseShudWxsLGgpfWNhdGNoKHApe2UocCl9ZWxzZSBkLnNwbGljZShsLFxuMSksbC0tLG0tLTtpZihnKWJyZWFrO2Y9Zi4kcGFyZW50fXdoaWxlKGYpO3JldHVybiBrfSwkYnJvYWRjYXN0OmZ1bmN0aW9uKGEsYil7Zm9yKHZhciBjPXRoaXMsZD10aGlzLGY9e25hbWU6YSx0YXJnZXRTY29wZTp0aGlzLHByZXZlbnREZWZhdWx0OmZ1bmN0aW9uKCl7Zi5kZWZhdWx0UHJldmVudGVkPSEwfSxkZWZhdWx0UHJldmVudGVkOiExfSxnPVtmXS5jb25jYXQoQmEuY2FsbChhcmd1bWVudHMsMSkpLGssaDtjPWQ7KXtmLmN1cnJlbnRTY29wZT1jO2Q9Yy4kJGxpc3RlbmVyc1thXXx8W107az0wO2ZvcihoPWQubGVuZ3RoO2s8aDtrKyspaWYoZFtrXSl0cnl7ZFtrXS5hcHBseShudWxsLGcpfWNhdGNoKGwpe2UobCl9ZWxzZSBkLnNwbGljZShrLDEpLGstLSxoLS07aWYoIShkPWMuJCRsaXN0ZW5lckNvdW50W2FdJiZjLiQkY2hpbGRIZWFkfHxjIT09dGhpcyYmYy4kJG5leHRTaWJsaW5nKSlmb3IoO2MhPT10aGlzJiYhKGQ9Yy4kJG5leHRTaWJsaW5nKTspYz1jLiRwYXJlbnR9cmV0dXJuIGZ9fTtcbnZhciBwPW5ldyBrO3JldHVybiBwfV19ZnVuY3Rpb24gY2QoKXt2YXIgYj0vXlxccyooaHR0cHM/fGZ0cHxtYWlsdG98dGVsfGZpbGUpOi8sYT0vXlxccyooKGh0dHBzP3xmdHB8ZmlsZSk6fGRhdGE6aW1hZ2VcXC8pLzt0aGlzLmFIcmVmU2FuaXRpemF0aW9uV2hpdGVsaXN0PWZ1bmN0aW9uKGEpe3JldHVybiB5KGEpPyhiPWEsdGhpcyk6Yn07dGhpcy5pbWdTcmNTYW5pdGl6YXRpb25XaGl0ZWxpc3Q9ZnVuY3Rpb24oYil7cmV0dXJuIHkoYik/KGE9Yix0aGlzKTphfTt0aGlzLiRnZXQ9ZnVuY3Rpb24oKXtyZXR1cm4gZnVuY3Rpb24oYyxkKXt2YXIgZT1kP2E6YixmO2lmKCFRfHw4PD1RKWlmKGY9dWEoYykuaHJlZixcIlwiIT09ZiYmIWYubWF0Y2goZSkpcmV0dXJuXCJ1bnNhZmU6XCIrZjtyZXR1cm4gY319fWZ1bmN0aW9uIEJlKGIpe2lmKFwic2VsZlwiPT09YilyZXR1cm4gYjtpZih2KGIpKXtpZigtMTxiLmluZGV4T2YoXCIqKipcIikpdGhyb3cgeGEoXCJpd2NhcmRcIixiKTtiPWIucmVwbGFjZSgvKFstKClcXFtcXF17fSs/Ki4kXFxefCw6IzwhXFxcXF0pL2csXG5cIlxcXFwkMVwiKS5yZXBsYWNlKC9cXHgwOC9nLFwiXFxcXHgwOFwiKS5yZXBsYWNlKFwiXFxcXCpcXFxcKlwiLFwiLipcIikucmVwbGFjZShcIlxcXFwqXCIsXCJbXjovLj8mO10qXCIpO3JldHVybiBSZWdFeHAoXCJeXCIrYitcIiRcIil9aWYoamIoYikpcmV0dXJuIFJlZ0V4cChcIl5cIitiLnNvdXJjZStcIiRcIik7dGhyb3cgeGEoXCJpbWF0Y2hlclwiKTt9ZnVuY3Rpb24gR2MoYil7dmFyIGE9W107eShiKSYmcihiLGZ1bmN0aW9uKGIpe2EucHVzaChCZShiKSl9KTtyZXR1cm4gYX1mdW5jdGlvbiBiZSgpe3RoaXMuU0NFX0NPTlRFWFRTPWdhO3ZhciBiPVtcInNlbGZcIl0sYT1bXTt0aGlzLnJlc291cmNlVXJsV2hpdGVsaXN0PWZ1bmN0aW9uKGEpe2FyZ3VtZW50cy5sZW5ndGgmJihiPUdjKGEpKTtyZXR1cm4gYn07dGhpcy5yZXNvdXJjZVVybEJsYWNrbGlzdD1mdW5jdGlvbihiKXthcmd1bWVudHMubGVuZ3RoJiYoYT1HYyhiKSk7cmV0dXJuIGF9O3RoaXMuJGdldD1bXCIkaW5qZWN0b3JcIixmdW5jdGlvbihjKXtmdW5jdGlvbiBkKGEpe3ZhciBiPVxuZnVuY3Rpb24oYSl7dGhpcy4kJHVud3JhcFRydXN0ZWRWYWx1ZT1mdW5jdGlvbigpe3JldHVybiBhfX07YSYmKGIucHJvdG90eXBlPW5ldyBhKTtiLnByb3RvdHlwZS52YWx1ZU9mPWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuJCR1bndyYXBUcnVzdGVkVmFsdWUoKX07Yi5wcm90b3R5cGUudG9TdHJpbmc9ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy4kJHVud3JhcFRydXN0ZWRWYWx1ZSgpLnRvU3RyaW5nKCl9O3JldHVybiBifXZhciBlPWZ1bmN0aW9uKGEpe3Rocm93IHhhKFwidW5zYWZlXCIpO307Yy5oYXMoXCIkc2FuaXRpemVcIikmJihlPWMuZ2V0KFwiJHNhbml0aXplXCIpKTt2YXIgZj1kKCksZz17fTtnW2dhLkhUTUxdPWQoZik7Z1tnYS5DU1NdPWQoZik7Z1tnYS5VUkxdPWQoZik7Z1tnYS5KU109ZChmKTtnW2dhLlJFU09VUkNFX1VSTF09ZChnW2dhLlVSTF0pO3JldHVybnt0cnVzdEFzOmZ1bmN0aW9uKGEsYil7dmFyIGM9Zy5oYXNPd25Qcm9wZXJ0eShhKT9nW2FdOm51bGw7aWYoIWMpdGhyb3cgeGEoXCJpY29udGV4dFwiLFxuYSxiKTtpZihudWxsPT09Ynx8Yj09PXR8fFwiXCI9PT1iKXJldHVybiBiO2lmKFwic3RyaW5nXCIhPT10eXBlb2YgYil0aHJvdyB4YShcIml0eXBlXCIsYSk7cmV0dXJuIG5ldyBjKGIpfSxnZXRUcnVzdGVkOmZ1bmN0aW9uKGMsZCl7aWYobnVsbD09PWR8fGQ9PT10fHxcIlwiPT09ZClyZXR1cm4gZDt2YXIgZj1nLmhhc093blByb3BlcnR5KGMpP2dbY106bnVsbDtpZihmJiZkIGluc3RhbmNlb2YgZilyZXR1cm4gZC4kJHVud3JhcFRydXN0ZWRWYWx1ZSgpO2lmKGM9PT1nYS5SRVNPVVJDRV9VUkwpe3ZhciBmPXVhKGQudG9TdHJpbmcoKSksbCxuLHA9ITE7bD0wO2ZvcihuPWIubGVuZ3RoO2w8bjtsKyspaWYoXCJzZWxmXCI9PT1iW2xdP1BiKGYpOmJbbF0uZXhlYyhmLmhyZWYpKXtwPSEwO2JyZWFrfWlmKHApZm9yKGw9MCxuPWEubGVuZ3RoO2w8bjtsKyspaWYoXCJzZWxmXCI9PT1hW2xdP1BiKGYpOmFbbF0uZXhlYyhmLmhyZWYpKXtwPSExO2JyZWFrfWlmKHApcmV0dXJuIGQ7dGhyb3cgeGEoXCJpbnNlY3VybFwiLFxuZC50b1N0cmluZygpKTt9aWYoYz09PWdhLkhUTUwpcmV0dXJuIGUoZCk7dGhyb3cgeGEoXCJ1bnNhZmVcIik7fSx2YWx1ZU9mOmZ1bmN0aW9uKGEpe3JldHVybiBhIGluc3RhbmNlb2YgZj9hLiQkdW53cmFwVHJ1c3RlZFZhbHVlKCk6YX19fV19ZnVuY3Rpb24gYWUoKXt2YXIgYj0hMDt0aGlzLmVuYWJsZWQ9ZnVuY3Rpb24oYSl7YXJndW1lbnRzLmxlbmd0aCYmKGI9ISFhKTtyZXR1cm4gYn07dGhpcy4kZ2V0PVtcIiRwYXJzZVwiLFwiJHNuaWZmZXJcIixcIiRzY2VEZWxlZ2F0ZVwiLGZ1bmN0aW9uKGEsYyxkKXtpZihiJiZjLm1zaWUmJjg+Yy5tc2llRG9jdW1lbnRNb2RlKXRocm93IHhhKFwiaWVxdWlya3NcIik7dmFyIGU9aGEoZ2EpO2UuaXNFbmFibGVkPWZ1bmN0aW9uKCl7cmV0dXJuIGJ9O2UudHJ1c3RBcz1kLnRydXN0QXM7ZS5nZXRUcnVzdGVkPWQuZ2V0VHJ1c3RlZDtlLnZhbHVlT2Y9ZC52YWx1ZU9mO2J8fChlLnRydXN0QXM9ZS5nZXRUcnVzdGVkPWZ1bmN0aW9uKGEsYil7cmV0dXJuIGJ9LFxuZS52YWx1ZU9mPVFhKTtlLnBhcnNlQXM9ZnVuY3Rpb24oYixjKXt2YXIgZD1hKGMpO3JldHVybiBkLmxpdGVyYWwmJmQuY29uc3RhbnQ/ZDpmdW5jdGlvbihhLGMpe3JldHVybiBlLmdldFRydXN0ZWQoYixkKGEsYykpfX07dmFyIGY9ZS5wYXJzZUFzLGc9ZS5nZXRUcnVzdGVkLGs9ZS50cnVzdEFzO3IoZ2EsZnVuY3Rpb24oYSxiKXt2YXIgYz1LKGIpO2VbWmEoXCJwYXJzZV9hc19cIitjKV09ZnVuY3Rpb24oYil7cmV0dXJuIGYoYSxiKX07ZVtaYShcImdldF90cnVzdGVkX1wiK2MpXT1mdW5jdGlvbihiKXtyZXR1cm4gZyhhLGIpfTtlW1phKFwidHJ1c3RfYXNfXCIrYyldPWZ1bmN0aW9uKGIpe3JldHVybiBrKGEsYil9fSk7cmV0dXJuIGV9XX1mdW5jdGlvbiBjZSgpe3RoaXMuJGdldD1bXCIkd2luZG93XCIsXCIkZG9jdW1lbnRcIixmdW5jdGlvbihiLGEpe3ZhciBjPXt9LGQ9VSgoL2FuZHJvaWQgKFxcZCspLy5leGVjKEsoKGIubmF2aWdhdG9yfHx7fSkudXNlckFnZW50KSl8fFtdKVsxXSksZT0vQm94ZWUvaS50ZXN0KChiLm5hdmlnYXRvcnx8XG57fSkudXNlckFnZW50KSxmPWFbMF18fHt9LGc9Zi5kb2N1bWVudE1vZGUsayxtPS9eKE1venx3ZWJraXR8T3xtcykoPz1bQS1aXSkvLGg9Zi5ib2R5JiZmLmJvZHkuc3R5bGUsbD0hMSxuPSExO2lmKGgpe2Zvcih2YXIgcCBpbiBoKWlmKGw9bS5leGVjKHApKXtrPWxbMF07az1rLnN1YnN0cigwLDEpLnRvVXBwZXJDYXNlKCkray5zdWJzdHIoMSk7YnJlYWt9a3x8KGs9XCJXZWJraXRPcGFjaXR5XCJpbiBoJiZcIndlYmtpdFwiKTtsPSEhKFwidHJhbnNpdGlvblwiaW4gaHx8aytcIlRyYW5zaXRpb25cImluIGgpO249ISEoXCJhbmltYXRpb25cImluIGh8fGsrXCJBbmltYXRpb25cImluIGgpOyFkfHxsJiZufHwobD12KGYuYm9keS5zdHlsZS53ZWJraXRUcmFuc2l0aW9uKSxuPXYoZi5ib2R5LnN0eWxlLndlYmtpdEFuaW1hdGlvbikpfXJldHVybntoaXN0b3J5OiEoIWIuaGlzdG9yeXx8IWIuaGlzdG9yeS5wdXNoU3RhdGV8fDQ+ZHx8ZSksaGFzaGNoYW5nZTpcIm9uaGFzaGNoYW5nZVwiaW4gYiYmKCFnfHw3PFxuZyksaGFzRXZlbnQ6ZnVuY3Rpb24oYSl7aWYoXCJpbnB1dFwiPT1hJiY5PT1RKXJldHVybiExO2lmKHgoY1thXSkpe3ZhciBiPWYuY3JlYXRlRWxlbWVudChcImRpdlwiKTtjW2FdPVwib25cIithIGluIGJ9cmV0dXJuIGNbYV19LGNzcDpYYSgpLHZlbmRvclByZWZpeDprLHRyYW5zaXRpb25zOmwsYW5pbWF0aW9uczpuLGFuZHJvaWQ6ZCxtc2llOlEsbXNpZURvY3VtZW50TW9kZTpnfX1dfWZ1bmN0aW9uIGVlKCl7dGhpcy4kZ2V0PVtcIiRyb290U2NvcGVcIixcIiRicm93c2VyXCIsXCIkcVwiLFwiJGV4Y2VwdGlvbkhhbmRsZXJcIixmdW5jdGlvbihiLGEsYyxkKXtmdW5jdGlvbiBlKGUsayxtKXt2YXIgaD1jLmRlZmVyKCksbD1oLnByb21pc2Usbj15KG0pJiYhbTtrPWEuZGVmZXIoZnVuY3Rpb24oKXt0cnl7aC5yZXNvbHZlKGUoKSl9Y2F0Y2goYSl7aC5yZWplY3QoYSksZChhKX1maW5hbGx5e2RlbGV0ZSBmW2wuJCR0aW1lb3V0SWRdfW58fGIuJGFwcGx5KCl9LGspO2wuJCR0aW1lb3V0SWQ9aztmW2tdPWg7XG5yZXR1cm4gbH12YXIgZj17fTtlLmNhbmNlbD1mdW5jdGlvbihiKXtyZXR1cm4gYiYmYi4kJHRpbWVvdXRJZCBpbiBmPyhmW2IuJCR0aW1lb3V0SWRdLnJlamVjdChcImNhbmNlbGVkXCIpLGRlbGV0ZSBmW2IuJCR0aW1lb3V0SWRdLGEuZGVmZXIuY2FuY2VsKGIuJCR0aW1lb3V0SWQpKTohMX07cmV0dXJuIGV9XX1mdW5jdGlvbiB1YShiLGEpe3ZhciBjPWI7USYmKFkuc2V0QXR0cmlidXRlKFwiaHJlZlwiLGMpLGM9WS5ocmVmKTtZLnNldEF0dHJpYnV0ZShcImhyZWZcIixjKTtyZXR1cm57aHJlZjpZLmhyZWYscHJvdG9jb2w6WS5wcm90b2NvbD9ZLnByb3RvY29sLnJlcGxhY2UoLzokLyxcIlwiKTpcIlwiLGhvc3Q6WS5ob3N0LHNlYXJjaDpZLnNlYXJjaD9ZLnNlYXJjaC5yZXBsYWNlKC9eXFw/LyxcIlwiKTpcIlwiLGhhc2g6WS5oYXNoP1kuaGFzaC5yZXBsYWNlKC9eIy8sXCJcIik6XCJcIixob3N0bmFtZTpZLmhvc3RuYW1lLHBvcnQ6WS5wb3J0LHBhdGhuYW1lOlwiL1wiPT09WS5wYXRobmFtZS5jaGFyQXQoMCk/WS5wYXRobmFtZTpcblwiL1wiK1kucGF0aG5hbWV9fWZ1bmN0aW9uIFBiKGIpe2I9dihiKT91YShiKTpiO3JldHVybiBiLnByb3RvY29sPT09SGMucHJvdG9jb2wmJmIuaG9zdD09PUhjLmhvc3R9ZnVuY3Rpb24gZmUoKXt0aGlzLiRnZXQ9YmEoVyl9ZnVuY3Rpb24gbWMoYil7ZnVuY3Rpb24gYShkLGUpe2lmKFQoZCkpe3ZhciBmPXt9O3IoZCxmdW5jdGlvbihiLGMpe2ZbY109YShjLGIpfSk7cmV0dXJuIGZ9cmV0dXJuIGIuZmFjdG9yeShkK2MsZSl9dmFyIGM9XCJGaWx0ZXJcIjt0aGlzLnJlZ2lzdGVyPWE7dGhpcy4kZ2V0PVtcIiRpbmplY3RvclwiLGZ1bmN0aW9uKGEpe3JldHVybiBmdW5jdGlvbihiKXtyZXR1cm4gYS5nZXQoYitjKX19XTthKFwiY3VycmVuY3lcIixJYyk7YShcImRhdGVcIixKYyk7YShcImZpbHRlclwiLENlKTthKFwianNvblwiLERlKTthKFwibGltaXRUb1wiLEVlKTthKFwibG93ZXJjYXNlXCIsRmUpO2EoXCJudW1iZXJcIixLYyk7YShcIm9yZGVyQnlcIixMYyk7YShcInVwcGVyY2FzZVwiLEdlKX1mdW5jdGlvbiBDZSgpe3JldHVybiBmdW5jdGlvbihiLFxuYSxjKXtpZighSihiKSlyZXR1cm4gYjt2YXIgZD10eXBlb2YgYyxlPVtdO2UuY2hlY2s9ZnVuY3Rpb24oYSl7Zm9yKHZhciBiPTA7YjxlLmxlbmd0aDtiKyspaWYoIWVbYl0oYSkpcmV0dXJuITE7cmV0dXJuITB9O1wiZnVuY3Rpb25cIiE9PWQmJihjPVwiYm9vbGVhblwiPT09ZCYmYz9mdW5jdGlvbihhLGIpe3JldHVybiBWYS5lcXVhbHMoYSxiKX06ZnVuY3Rpb24oYSxiKXtpZihhJiZiJiZcIm9iamVjdFwiPT09dHlwZW9mIGEmJlwib2JqZWN0XCI9PT10eXBlb2YgYil7Zm9yKHZhciBkIGluIGEpaWYoXCIkXCIhPT1kLmNoYXJBdCgwKSYma2IuY2FsbChhLGQpJiZjKGFbZF0sYltkXSkpcmV0dXJuITA7cmV0dXJuITF9Yj0oXCJcIitiKS50b0xvd2VyQ2FzZSgpO3JldHVybi0xPChcIlwiK2EpLnRvTG93ZXJDYXNlKCkuaW5kZXhPZihiKX0pO3ZhciBmPWZ1bmN0aW9uKGEsYil7aWYoXCJzdHJpbmdcIj09dHlwZW9mIGImJlwiIVwiPT09Yi5jaGFyQXQoMCkpcmV0dXJuIWYoYSxiLnN1YnN0cigxKSk7c3dpdGNoKHR5cGVvZiBhKXtjYXNlIFwiYm9vbGVhblwiOmNhc2UgXCJudW1iZXJcIjpjYXNlIFwic3RyaW5nXCI6cmV0dXJuIGMoYSxcbmIpO2Nhc2UgXCJvYmplY3RcIjpzd2l0Y2godHlwZW9mIGIpe2Nhc2UgXCJvYmplY3RcIjpyZXR1cm4gYyhhLGIpO2RlZmF1bHQ6Zm9yKHZhciBkIGluIGEpaWYoXCIkXCIhPT1kLmNoYXJBdCgwKSYmZihhW2RdLGIpKXJldHVybiEwfXJldHVybiExO2Nhc2UgXCJhcnJheVwiOmZvcihkPTA7ZDxhLmxlbmd0aDtkKyspaWYoZihhW2RdLGIpKXJldHVybiEwO3JldHVybiExO2RlZmF1bHQ6cmV0dXJuITF9fTtzd2l0Y2godHlwZW9mIGEpe2Nhc2UgXCJib29sZWFuXCI6Y2FzZSBcIm51bWJlclwiOmNhc2UgXCJzdHJpbmdcIjphPXskOmF9O2Nhc2UgXCJvYmplY3RcIjpmb3IodmFyIGcgaW4gYSkoZnVuY3Rpb24oYil7XCJ1bmRlZmluZWRcIiE9PXR5cGVvZiBhW2JdJiZlLnB1c2goZnVuY3Rpb24oYyl7cmV0dXJuIGYoXCIkXCI9PWI/YzpjJiZjW2JdLGFbYl0pfSl9KShnKTticmVhaztjYXNlIFwiZnVuY3Rpb25cIjplLnB1c2goYSk7YnJlYWs7ZGVmYXVsdDpyZXR1cm4gYn1kPVtdO2ZvcihnPTA7ZzxiLmxlbmd0aDtnKyspe3ZhciBrPVxuYltnXTtlLmNoZWNrKGspJiZkLnB1c2goayl9cmV0dXJuIGR9fWZ1bmN0aW9uIEljKGIpe3ZhciBhPWIuTlVNQkVSX0ZPUk1BVFM7cmV0dXJuIGZ1bmN0aW9uKGIsZCl7eChkKSYmKGQ9YS5DVVJSRU5DWV9TWU0pO3JldHVybiBNYyhiLGEuUEFUVEVSTlNbMV0sYS5HUk9VUF9TRVAsYS5ERUNJTUFMX1NFUCwyKS5yZXBsYWNlKC9cXHUwMEE0L2csZCl9fWZ1bmN0aW9uIEtjKGIpe3ZhciBhPWIuTlVNQkVSX0ZPUk1BVFM7cmV0dXJuIGZ1bmN0aW9uKGIsZCl7cmV0dXJuIE1jKGIsYS5QQVRURVJOU1swXSxhLkdST1VQX1NFUCxhLkRFQ0lNQUxfU0VQLGQpfX1mdW5jdGlvbiBNYyhiLGEsYyxkLGUpe2lmKG51bGw9PWJ8fCFpc0Zpbml0ZShiKXx8VChiKSlyZXR1cm5cIlwiO3ZhciBmPTA+YjtiPU1hdGguYWJzKGIpO3ZhciBnPWIrXCJcIixrPVwiXCIsbT1bXSxoPSExO2lmKC0xIT09Zy5pbmRleE9mKFwiZVwiKSl7dmFyIGw9Zy5tYXRjaCgvKFtcXGRcXC5dKyllKC0/KShcXGQrKS8pO2wmJlwiLVwiPT1sWzJdJiZcbmxbM10+ZSsxPyhnPVwiMFwiLGI9MCk6KGs9ZyxoPSEwKX1pZihoKTA8ZSYmKC0xPGImJjE+YikmJihrPWIudG9GaXhlZChlKSk7ZWxzZXtnPShnLnNwbGl0KE5jKVsxXXx8XCJcIikubGVuZ3RoO3goZSkmJihlPU1hdGgubWluKE1hdGgubWF4KGEubWluRnJhYyxnKSxhLm1heEZyYWMpKTtiPSsoTWF0aC5yb3VuZCgrKGIudG9TdHJpbmcoKStcImVcIitlKSkudG9TdHJpbmcoKStcImVcIistZSk7MD09PWImJihmPSExKTtiPShcIlwiK2IpLnNwbGl0KE5jKTtnPWJbMF07Yj1iWzFdfHxcIlwiO3ZhciBsPTAsbj1hLmxnU2l6ZSxwPWEuZ1NpemU7aWYoZy5sZW5ndGg+PW4rcClmb3IobD1nLmxlbmd0aC1uLGg9MDtoPGw7aCsrKTA9PT0obC1oKSVwJiYwIT09aCYmKGsrPWMpLGsrPWcuY2hhckF0KGgpO2ZvcihoPWw7aDxnLmxlbmd0aDtoKyspMD09PShnLmxlbmd0aC1oKSVuJiYwIT09aCYmKGsrPWMpLGsrPWcuY2hhckF0KGgpO2Zvcig7Yi5sZW5ndGg8ZTspYis9XCIwXCI7ZSYmXCIwXCIhPT1lJiYoays9ZCtiLnN1YnN0cigwLFxuZSkpfW0ucHVzaChmP2EubmVnUHJlOmEucG9zUHJlKTttLnB1c2goayk7bS5wdXNoKGY/YS5uZWdTdWY6YS5wb3NTdWYpO3JldHVybiBtLmpvaW4oXCJcIil9ZnVuY3Rpb24gWGIoYixhLGMpe3ZhciBkPVwiXCI7MD5iJiYoZD1cIi1cIixiPS1iKTtmb3IoYj1cIlwiK2I7Yi5sZW5ndGg8YTspYj1cIjBcIitiO2MmJihiPWIuc3Vic3RyKGIubGVuZ3RoLWEpKTtyZXR1cm4gZCtifWZ1bmN0aW9uICQoYixhLGMsZCl7Yz1jfHwwO3JldHVybiBmdW5jdGlvbihlKXtlPWVbXCJnZXRcIitiXSgpO2lmKDA8Y3x8ZT4tYyllKz1jOzA9PT1lJiYtMTI9PWMmJihlPTEyKTtyZXR1cm4gWGIoZSxhLGQpfX1mdW5jdGlvbiB2YihiLGEpe3JldHVybiBmdW5jdGlvbihjLGQpe3ZhciBlPWNbXCJnZXRcIitiXSgpLGY9SWEoYT9cIlNIT1JUXCIrYjpiKTtyZXR1cm4gZFtmXVtlXX19ZnVuY3Rpb24gSmMoYil7ZnVuY3Rpb24gYShhKXt2YXIgYjtpZihiPWEubWF0Y2goYykpe2E9bmV3IERhdGUoMCk7dmFyIGY9MCxnPTAsaz1iWzhdP1xuYS5zZXRVVENGdWxsWWVhcjphLnNldEZ1bGxZZWFyLG09Yls4XT9hLnNldFVUQ0hvdXJzOmEuc2V0SG91cnM7Yls5XSYmKGY9VShiWzldK2JbMTBdKSxnPVUoYls5XStiWzExXSkpO2suY2FsbChhLFUoYlsxXSksVShiWzJdKS0xLFUoYlszXSkpO2Y9VShiWzRdfHwwKS1mO2c9VShiWzVdfHwwKS1nO2s9VShiWzZdfHwwKTtiPU1hdGgucm91bmQoMUUzKnBhcnNlRmxvYXQoXCIwLlwiKyhiWzddfHwwKSkpO20uY2FsbChhLGYsZyxrLGIpfXJldHVybiBhfXZhciBjPS9eKFxcZHs0fSktPyhcXGRcXGQpLT8oXFxkXFxkKSg/OlQoXFxkXFxkKSg/Ojo/KFxcZFxcZCkoPzo6PyhcXGRcXGQpKD86XFwuKFxcZCspKT8pPyk/KFp8KFsrLV0pKFxcZFxcZCk6PyhcXGRcXGQpKT8pPyQvO3JldHVybiBmdW5jdGlvbihjLGUpe3ZhciBmPVwiXCIsZz1bXSxrLG07ZT1lfHxcIm1lZGl1bURhdGVcIjtlPWIuREFURVRJTUVfRk9STUFUU1tlXXx8ZTt2KGMpJiYoYz1IZS50ZXN0KGMpP1UoYyk6YShjKSk7aWIoYykmJihjPW5ldyBEYXRlKGMpKTtcbmlmKCF0YShjKSlyZXR1cm4gYztmb3IoO2U7KShtPUllLmV4ZWMoZSkpPyhnPWcuY29uY2F0KEJhLmNhbGwobSwxKSksZT1nLnBvcCgpKTooZy5wdXNoKGUpLGU9bnVsbCk7cihnLGZ1bmN0aW9uKGEpe2s9SmVbYV07Zis9az9rKGMsYi5EQVRFVElNRV9GT1JNQVRTKTphLnJlcGxhY2UoLyheJ3wnJCkvZyxcIlwiKS5yZXBsYWNlKC8nJy9nLFwiJ1wiKX0pO3JldHVybiBmfX1mdW5jdGlvbiBEZSgpe3JldHVybiBmdW5jdGlvbihiKXtyZXR1cm4gbmEoYiwhMCl9fWZ1bmN0aW9uIEVlKCl7cmV0dXJuIGZ1bmN0aW9uKGIsYSl7aWYoIUooYikmJiF2KGIpKXJldHVybiBiO2E9SW5maW5pdHk9PT1NYXRoLmFicyhOdW1iZXIoYSkpP051bWJlcihhKTpVKGEpO2lmKHYoYikpcmV0dXJuIGE/MDw9YT9iLnNsaWNlKDAsYSk6Yi5zbGljZShhLGIubGVuZ3RoKTpcIlwiO3ZhciBjPVtdLGQsZTthPmIubGVuZ3RoP2E9Yi5sZW5ndGg6YTwtYi5sZW5ndGgmJihhPS1iLmxlbmd0aCk7MDxhPyhkPTAsZT1hKTooZD1cbmIubGVuZ3RoK2EsZT1iLmxlbmd0aCk7Zm9yKDtkPGU7ZCsrKWMucHVzaChiW2RdKTtyZXR1cm4gY319ZnVuY3Rpb24gTGMoYil7cmV0dXJuIGZ1bmN0aW9uKGEsYyxkKXtmdW5jdGlvbiBlKGEsYil7cmV0dXJuIFVhKGIpP2Z1bmN0aW9uKGIsYyl7cmV0dXJuIGEoYyxiKX06YX1mdW5jdGlvbiBmKGEsYil7dmFyIGM9dHlwZW9mIGEsZD10eXBlb2YgYjtyZXR1cm4gYz09ZD8odGEoYSkmJnRhKGIpJiYoYT1hLnZhbHVlT2YoKSxiPWIudmFsdWVPZigpKSxcInN0cmluZ1wiPT1jJiYoYT1hLnRvTG93ZXJDYXNlKCksYj1iLnRvTG93ZXJDYXNlKCkpLGE9PT1iPzA6YTxiPy0xOjEpOmM8ZD8tMToxfWlmKCFQYShhKXx8IWMpcmV0dXJuIGE7Yz1KKGMpP2M6W2NdO2M9VmMoYyxmdW5jdGlvbihhKXt2YXIgYz0hMSxkPWF8fFFhO2lmKHYoYSkpe2lmKFwiK1wiPT1hLmNoYXJBdCgwKXx8XCItXCI9PWEuY2hhckF0KDApKWM9XCItXCI9PWEuY2hhckF0KDApLGE9YS5zdWJzdHJpbmcoMSk7ZD1iKGEpO2lmKGQuY29uc3RhbnQpe3ZhciBnPVxuZCgpO3JldHVybiBlKGZ1bmN0aW9uKGEsYil7cmV0dXJuIGYoYVtnXSxiW2ddKX0sYyl9fXJldHVybiBlKGZ1bmN0aW9uKGEsYil7cmV0dXJuIGYoZChhKSxkKGIpKX0sYyl9KTtmb3IodmFyIGc9W10saz0wO2s8YS5sZW5ndGg7aysrKWcucHVzaChhW2tdKTtyZXR1cm4gZy5zb3J0KGUoZnVuY3Rpb24oYSxiKXtmb3IodmFyIGQ9MDtkPGMubGVuZ3RoO2QrKyl7dmFyIGU9Y1tkXShhLGIpO2lmKDAhPT1lKXJldHVybiBlfXJldHVybiAwfSxkKSl9fWZ1bmN0aW9uIHlhKGIpe1AoYikmJihiPXtsaW5rOmJ9KTtiLnJlc3RyaWN0PWIucmVzdHJpY3R8fFwiQUNcIjtyZXR1cm4gYmEoYil9ZnVuY3Rpb24gT2MoYixhLGMsZCl7ZnVuY3Rpb24gZShhLGMpe2M9Yz9cIi1cIittYihjLFwiLVwiKTpcIlwiO2Quc2V0Q2xhc3MoYiwoYT93Yjp4YikrYywoYT94Yjp3YikrYyl9dmFyIGY9dGhpcyxnPWIucGFyZW50KCkuY29udHJvbGxlcihcImZvcm1cIil8fHliLGs9MCxtPWYuJGVycm9yPXt9LGg9W107Zi4kbmFtZT1cbmEubmFtZXx8YS5uZ0Zvcm07Zi4kZGlydHk9ITE7Zi4kcHJpc3RpbmU9ITA7Zi4kdmFsaWQ9ITA7Zi4kaW52YWxpZD0hMTtnLiRhZGRDb250cm9sKGYpO2IuYWRkQ2xhc3MoT2EpO2UoITApO2YuJGFkZENvbnRyb2w9ZnVuY3Rpb24oYSl7RGEoYS4kbmFtZSxcImlucHV0XCIpO2gucHVzaChhKTthLiRuYW1lJiYoZlthLiRuYW1lXT1hKX07Zi4kcmVtb3ZlQ29udHJvbD1mdW5jdGlvbihhKXthLiRuYW1lJiZmW2EuJG5hbWVdPT09YSYmZGVsZXRlIGZbYS4kbmFtZV07cihtLGZ1bmN0aW9uKGIsYyl7Zi4kc2V0VmFsaWRpdHkoYywhMCxhKX0pO1NhKGgsYSl9O2YuJHNldFZhbGlkaXR5PWZ1bmN0aW9uKGEsYixjKXt2YXIgZD1tW2FdO2lmKGIpZCYmKFNhKGQsYyksZC5sZW5ndGh8fChrLS0sa3x8KGUoYiksZi4kdmFsaWQ9ITAsZi4kaW52YWxpZD0hMSksbVthXT0hMSxlKCEwLGEpLGcuJHNldFZhbGlkaXR5KGEsITAsZikpKTtlbHNle2t8fGUoYik7aWYoZCl7aWYoLTEhPVJhKGQsYykpcmV0dXJufWVsc2UgbVthXT1cbmQ9W10saysrLGUoITEsYSksZy4kc2V0VmFsaWRpdHkoYSwhMSxmKTtkLnB1c2goYyk7Zi4kdmFsaWQ9ITE7Zi4kaW52YWxpZD0hMH19O2YuJHNldERpcnR5PWZ1bmN0aW9uKCl7ZC5yZW1vdmVDbGFzcyhiLE9hKTtkLmFkZENsYXNzKGIsemIpO2YuJGRpcnR5PSEwO2YuJHByaXN0aW5lPSExO2cuJHNldERpcnR5KCl9O2YuJHNldFByaXN0aW5lPWZ1bmN0aW9uKCl7ZC5yZW1vdmVDbGFzcyhiLHpiKTtkLmFkZENsYXNzKGIsT2EpO2YuJGRpcnR5PSExO2YuJHByaXN0aW5lPSEwO3IoaCxmdW5jdGlvbihhKXthLiRzZXRQcmlzdGluZSgpfSl9fWZ1bmN0aW9uIHNhKGIsYSxjLGQpe2IuJHNldFZhbGlkaXR5KGEsYyk7cmV0dXJuIGM/ZDp0fWZ1bmN0aW9uIFBjKGIsYSl7dmFyIGMsZDtpZihhKWZvcihjPTA7YzxhLmxlbmd0aDsrK2MpaWYoZD1hW2NdLGJbZF0pcmV0dXJuITA7cmV0dXJuITF9ZnVuY3Rpb24gS2UoYixhLGMsZCxlKXtUKGUpJiYoYi4kJGhhc05hdGl2ZVZhbGlkYXRvcnM9ITAsXG5iLiRwYXJzZXJzLnB1c2goZnVuY3Rpb24oZil7aWYoYi4kZXJyb3JbYV18fFBjKGUsZCl8fCFQYyhlLGMpKXJldHVybiBmO2IuJHNldFZhbGlkaXR5KGEsITEpfSkpfWZ1bmN0aW9uIEFiKGIsYSxjLGQsZSxmKXt2YXIgZz1hLnByb3AoTGUpLGs9YVswXS5wbGFjZWhvbGRlcixtPXt9LGg9SyhhWzBdLnR5cGUpO2QuJCR2YWxpZGl0eVN0YXRlPWc7aWYoIWUuYW5kcm9pZCl7dmFyIGw9ITE7YS5vbihcImNvbXBvc2l0aW9uc3RhcnRcIixmdW5jdGlvbihhKXtsPSEwfSk7YS5vbihcImNvbXBvc2l0aW9uZW5kXCIsZnVuY3Rpb24oKXtsPSExO24oKX0pfXZhciBuPWZ1bmN0aW9uKGUpe2lmKCFsKXt2YXIgZj1hLnZhbCgpO2lmKFEmJlwiaW5wdXRcIj09PShlfHxtKS50eXBlJiZhWzBdLnBsYWNlaG9sZGVyIT09aylrPWFbMF0ucGxhY2Vob2xkZXI7ZWxzZSBpZihcInBhc3N3b3JkXCIhPT1oJiZVYShjLm5nVHJpbXx8XCJUXCIpJiYoZj1hYShmKSksZT1nJiZkLiQkaGFzTmF0aXZlVmFsaWRhdG9ycyxkLiR2aWV3VmFsdWUhPT1cbmZ8fFwiXCI9PT1mJiZlKWIuJHJvb3QuJCRwaGFzZT9kLiRzZXRWaWV3VmFsdWUoZik6Yi4kYXBwbHkoZnVuY3Rpb24oKXtkLiRzZXRWaWV3VmFsdWUoZil9KX19O2lmKGUuaGFzRXZlbnQoXCJpbnB1dFwiKSlhLm9uKFwiaW5wdXRcIixuKTtlbHNle3ZhciBwLHE9ZnVuY3Rpb24oKXtwfHwocD1mLmRlZmVyKGZ1bmN0aW9uKCl7bigpO3A9bnVsbH0pKX07YS5vbihcImtleWRvd25cIixmdW5jdGlvbihhKXthPWEua2V5Q29kZTs5MT09PWF8fCgxNTxhJiYxOT5hfHwzNzw9YSYmNDA+PWEpfHxxKCl9KTtpZihlLmhhc0V2ZW50KFwicGFzdGVcIikpYS5vbihcInBhc3RlIGN1dFwiLHEpfWEub24oXCJjaGFuZ2VcIixuKTtkLiRyZW5kZXI9ZnVuY3Rpb24oKXthLnZhbChkLiRpc0VtcHR5KGQuJHZpZXdWYWx1ZSk/XCJcIjpkLiR2aWV3VmFsdWUpfTt2YXIgcz1jLm5nUGF0dGVybjtzJiYoKGU9cy5tYXRjaCgvXlxcLyguKilcXC8oW2dpbV0qKSQvKSk/KHM9UmVnRXhwKGVbMV0sZVsyXSksZT1mdW5jdGlvbihhKXtyZXR1cm4gc2EoZCxcblwicGF0dGVyblwiLGQuJGlzRW1wdHkoYSl8fHMudGVzdChhKSxhKX0pOmU9ZnVuY3Rpb24oYyl7dmFyIGU9Yi4kZXZhbChzKTtpZighZXx8IWUudGVzdCl0aHJvdyBDKFwibmdQYXR0ZXJuXCIpKFwibm9yZWdleHBcIixzLGUsaWEoYSkpO3JldHVybiBzYShkLFwicGF0dGVyblwiLGQuJGlzRW1wdHkoYyl8fGUudGVzdChjKSxjKX0sZC4kZm9ybWF0dGVycy5wdXNoKGUpLGQuJHBhcnNlcnMucHVzaChlKSk7aWYoYy5uZ01pbmxlbmd0aCl7dmFyIHI9VShjLm5nTWlubGVuZ3RoKTtlPWZ1bmN0aW9uKGEpe3JldHVybiBzYShkLFwibWlubGVuZ3RoXCIsZC4kaXNFbXB0eShhKXx8YS5sZW5ndGg+PXIsYSl9O2QuJHBhcnNlcnMucHVzaChlKTtkLiRmb3JtYXR0ZXJzLnB1c2goZSl9aWYoYy5uZ01heGxlbmd0aCl7dmFyIHU9VShjLm5nTWF4bGVuZ3RoKTtlPWZ1bmN0aW9uKGEpe3JldHVybiBzYShkLFwibWF4bGVuZ3RoXCIsZC4kaXNFbXB0eShhKXx8YS5sZW5ndGg8PXUsYSl9O2QuJHBhcnNlcnMucHVzaChlKTtcbmQuJGZvcm1hdHRlcnMucHVzaChlKX19ZnVuY3Rpb24gWWIoYixhKXtiPVwibmdDbGFzc1wiK2I7cmV0dXJuW1wiJGFuaW1hdGVcIixmdW5jdGlvbihjKXtmdW5jdGlvbiBkKGEsYil7dmFyIGM9W10sZD0wO2E6Zm9yKDtkPGEubGVuZ3RoO2QrKyl7Zm9yKHZhciBlPWFbZF0sbD0wO2w8Yi5sZW5ndGg7bCsrKWlmKGU9PWJbbF0pY29udGludWUgYTtjLnB1c2goZSl9cmV0dXJuIGN9ZnVuY3Rpb24gZShhKXtpZighSihhKSl7aWYodihhKSlyZXR1cm4gYS5zcGxpdChcIiBcIik7aWYoVChhKSl7dmFyIGI9W107cihhLGZ1bmN0aW9uKGEsYyl7YSYmKGI9Yi5jb25jYXQoYy5zcGxpdChcIiBcIikpKX0pO3JldHVybiBifX1yZXR1cm4gYX1yZXR1cm57cmVzdHJpY3Q6XCJBQ1wiLGxpbms6ZnVuY3Rpb24oZixnLGspe2Z1bmN0aW9uIG0oYSxiKXt2YXIgYz1nLmRhdGEoXCIkY2xhc3NDb3VudHNcIil8fHt9LGQ9W107cihhLGZ1bmN0aW9uKGEpe2lmKDA8Ynx8Y1thXSljW2FdPShjW2FdfHwwKStiLGNbYV09PT0rKDA8XG5iKSYmZC5wdXNoKGEpfSk7Zy5kYXRhKFwiJGNsYXNzQ291bnRzXCIsYyk7cmV0dXJuIGQuam9pbihcIiBcIil9ZnVuY3Rpb24gaChiKXtpZighMD09PWF8fGYuJGluZGV4JTI9PT1hKXt2YXIgaD1lKGJ8fFtdKTtpZighbCl7dmFyIHE9bShoLDEpO2suJGFkZENsYXNzKHEpfWVsc2UgaWYoIUFhKGIsbCkpe3ZhciBzPWUobCkscT1kKGgscyksaD1kKHMsaCksaD1tKGgsLTEpLHE9bShxLDEpOzA9PT1xLmxlbmd0aD9jLnJlbW92ZUNsYXNzKGcsaCk6MD09PWgubGVuZ3RoP2MuYWRkQ2xhc3MoZyxxKTpjLnNldENsYXNzKGcscSxoKX19bD1oYShiKX12YXIgbDtmLiR3YXRjaChrW2JdLGgsITApO2suJG9ic2VydmUoXCJjbGFzc1wiLGZ1bmN0aW9uKGEpe2goZi4kZXZhbChrW2JdKSl9KTtcIm5nQ2xhc3NcIiE9PWImJmYuJHdhdGNoKFwiJGluZGV4XCIsZnVuY3Rpb24oYyxkKXt2YXIgZz1jJjE7aWYoZyE9PShkJjEpKXt2YXIgaD1lKGYuJGV2YWwoa1tiXSkpO2c9PT1hPyhnPW0oaCwxKSxrLiRhZGRDbGFzcyhnKSk6XG4oZz1tKGgsLTEpLGsuJHJlbW92ZUNsYXNzKGcpKX19KX19fV19dmFyIExlPVwidmFsaWRpdHlcIixLPWZ1bmN0aW9uKGIpe3JldHVybiB2KGIpP2IudG9Mb3dlckNhc2UoKTpifSxrYj1PYmplY3QucHJvdG90eXBlLmhhc093blByb3BlcnR5LElhPWZ1bmN0aW9uKGIpe3JldHVybiB2KGIpP2IudG9VcHBlckNhc2UoKTpifSxRLHcsRWEsQmE9W10uc2xpY2UsTWU9W10ucHVzaCx6YT1PYmplY3QucHJvdG90eXBlLnRvU3RyaW5nLFRhPUMoXCJuZ1wiKSxWYT1XLmFuZ3VsYXJ8fChXLmFuZ3VsYXI9e30pLFlhLE1hLG1hPVtcIjBcIixcIjBcIixcIjBcIl07UT1VKCgvbXNpZSAoXFxkKykvLmV4ZWMoSyhuYXZpZ2F0b3IudXNlckFnZW50KSl8fFtdKVsxXSk7aXNOYU4oUSkmJihRPVUoKC90cmlkZW50XFwvLio7IHJ2OihcXGQrKS8uZXhlYyhLKG5hdmlnYXRvci51c2VyQWdlbnQpKXx8W10pWzFdKSk7RS4kaW5qZWN0PVtdO1FhLiRpbmplY3Q9W107dmFyIEo9ZnVuY3Rpb24oKXtyZXR1cm4gUChBcnJheS5pc0FycmF5KT9cbkFycmF5LmlzQXJyYXk6ZnVuY3Rpb24oYil7cmV0dXJuXCJbb2JqZWN0IEFycmF5XVwiPT09emEuY2FsbChiKX19KCksYWE9ZnVuY3Rpb24oKXtyZXR1cm4gU3RyaW5nLnByb3RvdHlwZS50cmltP2Z1bmN0aW9uKGIpe3JldHVybiB2KGIpP2IudHJpbSgpOmJ9OmZ1bmN0aW9uKGIpe3JldHVybiB2KGIpP2IucmVwbGFjZSgvXlxcc1xccyovLFwiXCIpLnJlcGxhY2UoL1xcc1xccyokLyxcIlwiKTpifX0oKTtNYT05PlE/ZnVuY3Rpb24oYil7Yj1iLm5vZGVOYW1lP2I6YlswXTtyZXR1cm4gYi5zY29wZU5hbWUmJlwiSFRNTFwiIT1iLnNjb3BlTmFtZT9JYShiLnNjb3BlTmFtZStcIjpcIitiLm5vZGVOYW1lKTpiLm5vZGVOYW1lfTpmdW5jdGlvbihiKXtyZXR1cm4gYi5ub2RlTmFtZT9iLm5vZGVOYW1lOmJbMF0ubm9kZU5hbWV9O3ZhciBYYT1mdW5jdGlvbigpe2lmKHkoWGEuaXNBY3RpdmVfKSlyZXR1cm4gWGEuaXNBY3RpdmVfO3ZhciBiPSEoIVgucXVlcnlTZWxlY3RvcihcIltuZy1jc3BdXCIpJiYhWC5xdWVyeVNlbGVjdG9yKFwiW2RhdGEtbmctY3NwXVwiKSk7XG5pZighYil0cnl7bmV3IEZ1bmN0aW9uKFwiXCIpfWNhdGNoKGEpe2I9ITB9cmV0dXJuIFhhLmlzQWN0aXZlXz1ifSxZYz0vW0EtWl0vZyxhZD17ZnVsbDpcIjEuMi4yNlwiLG1ham9yOjEsbWlub3I6Mixkb3Q6MjYsY29kZU5hbWU6XCJjYXB0aXZhdGluZy1kaXNpbnRlcmVzdFwifTtTLmV4cGFuZG89XCJuZzMzOVwiO3ZhciBhYj1TLmNhY2hlPXt9LG5lPTEsc2I9Vy5kb2N1bWVudC5hZGRFdmVudExpc3RlbmVyP2Z1bmN0aW9uKGIsYSxjKXtiLmFkZEV2ZW50TGlzdGVuZXIoYSxjLCExKX06ZnVuY3Rpb24oYixhLGMpe2IuYXR0YWNoRXZlbnQoXCJvblwiK2EsYyl9LCRhPVcuZG9jdW1lbnQucmVtb3ZlRXZlbnRMaXN0ZW5lcj9mdW5jdGlvbihiLGEsYyl7Yi5yZW1vdmVFdmVudExpc3RlbmVyKGEsYywhMSl9OmZ1bmN0aW9uKGIsYSxjKXtiLmRldGFjaEV2ZW50KFwib25cIithLGMpfTtTLl9kYXRhPWZ1bmN0aW9uKGIpe3JldHVybiB0aGlzLmNhY2hlW2JbdGhpcy5leHBhbmRvXV18fHt9fTt2YXIgaWU9LyhbXFw6XFwtXFxfXSsoLikpL2csXG5qZT0vXm1veihbQS1aXSkvLEhiPUMoXCJqcUxpdGVcIiksa2U9L148KFxcdyspXFxzKlxcLz8+KD86PFxcL1xcMT58KSQvLEliPS88fCYjP1xcdys7LyxsZT0vPChbXFx3Ol0rKS8sbWU9LzwoPyFhcmVhfGJyfGNvbHxlbWJlZHxocnxpbWd8aW5wdXR8bGlua3xtZXRhfHBhcmFtKSgoW1xcdzpdKylbXj5dKilcXC8+L2dpLGVhPXtvcHRpb246WzEsJzxzZWxlY3QgbXVsdGlwbGU9XCJtdWx0aXBsZVwiPicsXCI8L3NlbGVjdD5cIl0sdGhlYWQ6WzEsXCI8dGFibGU+XCIsXCI8L3RhYmxlPlwiXSxjb2w6WzIsXCI8dGFibGU+PGNvbGdyb3VwPlwiLFwiPC9jb2xncm91cD48L3RhYmxlPlwiXSx0cjpbMixcIjx0YWJsZT48dGJvZHk+XCIsXCI8L3Rib2R5PjwvdGFibGU+XCJdLHRkOlszLFwiPHRhYmxlPjx0Ym9keT48dHI+XCIsXCI8L3RyPjwvdGJvZHk+PC90YWJsZT5cIl0sX2RlZmF1bHQ6WzAsXCJcIixcIlwiXX07ZWEub3B0Z3JvdXA9ZWEub3B0aW9uO2VhLnRib2R5PWVhLnRmb290PWVhLmNvbGdyb3VwPWVhLmNhcHRpb249ZWEudGhlYWQ7ZWEudGg9XG5lYS50ZDt2YXIgTGE9Uy5wcm90b3R5cGU9e3JlYWR5OmZ1bmN0aW9uKGIpe2Z1bmN0aW9uIGEoKXtjfHwoYz0hMCxiKCkpfXZhciBjPSExO1wiY29tcGxldGVcIj09PVgucmVhZHlTdGF0ZT9zZXRUaW1lb3V0KGEpOih0aGlzLm9uKFwiRE9NQ29udGVudExvYWRlZFwiLGEpLFMoVykub24oXCJsb2FkXCIsYSkpfSx0b1N0cmluZzpmdW5jdGlvbigpe3ZhciBiPVtdO3IodGhpcyxmdW5jdGlvbihhKXtiLnB1c2goXCJcIithKX0pO3JldHVyblwiW1wiK2Iuam9pbihcIiwgXCIpK1wiXVwifSxlcTpmdW5jdGlvbihiKXtyZXR1cm4gMDw9Yj93KHRoaXNbYl0pOncodGhpc1t0aGlzLmxlbmd0aCtiXSl9LGxlbmd0aDowLHB1c2g6TWUsc29ydDpbXS5zb3J0LHNwbGljZTpbXS5zcGxpY2V9LHFiPXt9O3IoXCJtdWx0aXBsZSBzZWxlY3RlZCBjaGVja2VkIGRpc2FibGVkIHJlYWRPbmx5IHJlcXVpcmVkIG9wZW5cIi5zcGxpdChcIiBcIiksZnVuY3Rpb24oYil7cWJbSyhiKV09Yn0pO3ZhciByYz17fTtyKFwiaW5wdXQgc2VsZWN0IG9wdGlvbiB0ZXh0YXJlYSBidXR0b24gZm9ybSBkZXRhaWxzXCIuc3BsaXQoXCIgXCIpLFxuZnVuY3Rpb24oYil7cmNbSWEoYildPSEwfSk7cih7ZGF0YTpNYixyZW1vdmVEYXRhOkxifSxmdW5jdGlvbihiLGEpe1NbYV09Yn0pO3Ioe2RhdGE6TWIsaW5oZXJpdGVkRGF0YTpwYixzY29wZTpmdW5jdGlvbihiKXtyZXR1cm4gdy5kYXRhKGIsXCIkc2NvcGVcIil8fHBiKGIucGFyZW50Tm9kZXx8YixbXCIkaXNvbGF0ZVNjb3BlXCIsXCIkc2NvcGVcIl0pfSxpc29sYXRlU2NvcGU6ZnVuY3Rpb24oYil7cmV0dXJuIHcuZGF0YShiLFwiJGlzb2xhdGVTY29wZVwiKXx8dy5kYXRhKGIsXCIkaXNvbGF0ZVNjb3BlTm9UZW1wbGF0ZVwiKX0sY29udHJvbGxlcjpvYyxpbmplY3RvcjpmdW5jdGlvbihiKXtyZXR1cm4gcGIoYixcIiRpbmplY3RvclwiKX0scmVtb3ZlQXR0cjpmdW5jdGlvbihiLGEpe2IucmVtb3ZlQXR0cmlidXRlKGEpfSxoYXNDbGFzczpOYixjc3M6ZnVuY3Rpb24oYixhLGMpe2E9WmEoYSk7aWYoeShjKSliLnN0eWxlW2FdPWM7ZWxzZXt2YXIgZDs4Pj1RJiYoZD1iLmN1cnJlbnRTdHlsZSYmYi5jdXJyZW50U3R5bGVbYV0sXG5cIlwiPT09ZCYmKGQ9XCJhdXRvXCIpKTtkPWR8fGIuc3R5bGVbYV07OD49USYmKGQ9XCJcIj09PWQ/dDpkKTtyZXR1cm4gZH19LGF0dHI6ZnVuY3Rpb24oYixhLGMpe3ZhciBkPUsoYSk7aWYocWJbZF0paWYoeShjKSljPyhiW2FdPSEwLGIuc2V0QXR0cmlidXRlKGEsZCkpOihiW2FdPSExLGIucmVtb3ZlQXR0cmlidXRlKGQpKTtlbHNlIHJldHVybiBiW2FdfHwoYi5hdHRyaWJ1dGVzLmdldE5hbWVkSXRlbShhKXx8RSkuc3BlY2lmaWVkP2Q6dDtlbHNlIGlmKHkoYykpYi5zZXRBdHRyaWJ1dGUoYSxjKTtlbHNlIGlmKGIuZ2V0QXR0cmlidXRlKXJldHVybiBiPWIuZ2V0QXR0cmlidXRlKGEsMiksbnVsbD09PWI/dDpifSxwcm9wOmZ1bmN0aW9uKGIsYSxjKXtpZih5KGMpKWJbYV09YztlbHNlIHJldHVybiBiW2FdfSx0ZXh0OmZ1bmN0aW9uKCl7ZnVuY3Rpb24gYihiLGQpe3ZhciBlPWFbYi5ub2RlVHlwZV07aWYoeChkKSlyZXR1cm4gZT9iW2VdOlwiXCI7YltlXT1kfXZhciBhPVtdOzk+UT8oYVsxXT1cblwiaW5uZXJUZXh0XCIsYVszXT1cIm5vZGVWYWx1ZVwiKTphWzFdPWFbM109XCJ0ZXh0Q29udGVudFwiO2IuJGR2PVwiXCI7cmV0dXJuIGJ9KCksdmFsOmZ1bmN0aW9uKGIsYSl7aWYoeChhKSl7aWYoXCJTRUxFQ1RcIj09PU1hKGIpJiZiLm11bHRpcGxlKXt2YXIgYz1bXTtyKGIub3B0aW9ucyxmdW5jdGlvbihhKXthLnNlbGVjdGVkJiZjLnB1c2goYS52YWx1ZXx8YS50ZXh0KX0pO3JldHVybiAwPT09Yy5sZW5ndGg/bnVsbDpjfXJldHVybiBiLnZhbHVlfWIudmFsdWU9YX0saHRtbDpmdW5jdGlvbihiLGEpe2lmKHgoYSkpcmV0dXJuIGIuaW5uZXJIVE1MO2Zvcih2YXIgYz0wLGQ9Yi5jaGlsZE5vZGVzO2M8ZC5sZW5ndGg7YysrKUphKGRbY10pO2IuaW5uZXJIVE1MPWF9LGVtcHR5OnBjfSxmdW5jdGlvbihiLGEpe1MucHJvdG90eXBlW2FdPWZ1bmN0aW9uKGEsZCl7dmFyIGUsZixnPXRoaXMubGVuZ3RoO2lmKGIhPT1wYyYmKDI9PWIubGVuZ3RoJiZiIT09TmImJmIhPT1vYz9hOmQpPT09dCl7aWYoVChhKSl7Zm9yKGU9XG4wO2U8ZztlKyspaWYoYj09PU1iKWIodGhpc1tlXSxhKTtlbHNlIGZvcihmIGluIGEpYih0aGlzW2VdLGYsYVtmXSk7cmV0dXJuIHRoaXN9ZT1iLiRkdjtnPWU9PT10P01hdGgubWluKGcsMSk6Zztmb3IoZj0wO2Y8ZztmKyspe3ZhciBrPWIodGhpc1tmXSxhLGQpO2U9ZT9lK2s6a31yZXR1cm4gZX1mb3IoZT0wO2U8ZztlKyspYih0aGlzW2VdLGEsZCk7cmV0dXJuIHRoaXN9fSk7cih7cmVtb3ZlRGF0YTpMYixkZWFsb2M6SmEsb246ZnVuY3Rpb24gYShjLGQsZSxmKXtpZih5KGYpKXRocm93IEhiKFwib25hcmdzXCIpO3ZhciBnPW9hKGMsXCJldmVudHNcIiksaz1vYShjLFwiaGFuZGxlXCIpO2d8fG9hKGMsXCJldmVudHNcIixnPXt9KTtrfHxvYShjLFwiaGFuZGxlXCIsaz1vZShjLGcpKTtyKGQuc3BsaXQoXCIgXCIpLGZ1bmN0aW9uKGQpe3ZhciBmPWdbZF07aWYoIWYpe2lmKFwibW91c2VlbnRlclwiPT1kfHxcIm1vdXNlbGVhdmVcIj09ZCl7dmFyIGw9WC5ib2R5LmNvbnRhaW5zfHxYLmJvZHkuY29tcGFyZURvY3VtZW50UG9zaXRpb24/XG5mdW5jdGlvbihhLGMpe3ZhciBkPTk9PT1hLm5vZGVUeXBlP2EuZG9jdW1lbnRFbGVtZW50OmEsZT1jJiZjLnBhcmVudE5vZGU7cmV0dXJuIGE9PT1lfHwhIShlJiYxPT09ZS5ub2RlVHlwZSYmKGQuY29udGFpbnM/ZC5jb250YWlucyhlKTphLmNvbXBhcmVEb2N1bWVudFBvc2l0aW9uJiZhLmNvbXBhcmVEb2N1bWVudFBvc2l0aW9uKGUpJjE2KSl9OmZ1bmN0aW9uKGEsYyl7aWYoYylmb3IoO2M9Yy5wYXJlbnROb2RlOylpZihjPT09YSlyZXR1cm4hMDtyZXR1cm4hMX07Z1tkXT1bXTthKGMse21vdXNlbGVhdmU6XCJtb3VzZW91dFwiLG1vdXNlZW50ZXI6XCJtb3VzZW92ZXJcIn1bZF0sZnVuY3Rpb24oYSl7dmFyIGM9YS5yZWxhdGVkVGFyZ2V0O2MmJihjPT09dGhpc3x8bCh0aGlzLGMpKXx8ayhhLGQpfSl9ZWxzZSBzYihjLGQsayksZ1tkXT1bXTtmPWdbZF19Zi5wdXNoKGUpfSl9LG9mZjpuYyxvbmU6ZnVuY3Rpb24oYSxjLGQpe2E9dyhhKTthLm9uKGMsZnVuY3Rpb24gZigpe2Eub2ZmKGMsXG5kKTthLm9mZihjLGYpfSk7YS5vbihjLGQpfSxyZXBsYWNlV2l0aDpmdW5jdGlvbihhLGMpe3ZhciBkLGU9YS5wYXJlbnROb2RlO0phKGEpO3IobmV3IFMoYyksZnVuY3Rpb24oYyl7ZD9lLmluc2VydEJlZm9yZShjLGQubmV4dFNpYmxpbmcpOmUucmVwbGFjZUNoaWxkKGMsYSk7ZD1jfSl9LGNoaWxkcmVuOmZ1bmN0aW9uKGEpe3ZhciBjPVtdO3IoYS5jaGlsZE5vZGVzLGZ1bmN0aW9uKGEpezE9PT1hLm5vZGVUeXBlJiZjLnB1c2goYSl9KTtyZXR1cm4gY30sY29udGVudHM6ZnVuY3Rpb24oYSl7cmV0dXJuIGEuY29udGVudERvY3VtZW50fHxhLmNoaWxkTm9kZXN8fFtdfSxhcHBlbmQ6ZnVuY3Rpb24oYSxjKXtyKG5ldyBTKGMpLGZ1bmN0aW9uKGMpezEhPT1hLm5vZGVUeXBlJiYxMSE9PWEubm9kZVR5cGV8fGEuYXBwZW5kQ2hpbGQoYyl9KX0scHJlcGVuZDpmdW5jdGlvbihhLGMpe2lmKDE9PT1hLm5vZGVUeXBlKXt2YXIgZD1hLmZpcnN0Q2hpbGQ7cihuZXcgUyhjKSxmdW5jdGlvbihjKXthLmluc2VydEJlZm9yZShjLFxuZCl9KX19LHdyYXA6ZnVuY3Rpb24oYSxjKXtjPXcoYylbMF07dmFyIGQ9YS5wYXJlbnROb2RlO2QmJmQucmVwbGFjZUNoaWxkKGMsYSk7Yy5hcHBlbmRDaGlsZChhKX0scmVtb3ZlOmZ1bmN0aW9uKGEpe0phKGEpO3ZhciBjPWEucGFyZW50Tm9kZTtjJiZjLnJlbW92ZUNoaWxkKGEpfSxhZnRlcjpmdW5jdGlvbihhLGMpe3ZhciBkPWEsZT1hLnBhcmVudE5vZGU7cihuZXcgUyhjKSxmdW5jdGlvbihhKXtlLmluc2VydEJlZm9yZShhLGQubmV4dFNpYmxpbmcpO2Q9YX0pfSxhZGRDbGFzczpvYixyZW1vdmVDbGFzczpuYix0b2dnbGVDbGFzczpmdW5jdGlvbihhLGMsZCl7YyYmcihjLnNwbGl0KFwiIFwiKSxmdW5jdGlvbihjKXt2YXIgZj1kO3goZikmJihmPSFOYihhLGMpKTsoZj9vYjpuYikoYSxjKX0pfSxwYXJlbnQ6ZnVuY3Rpb24oYSl7cmV0dXJuKGE9YS5wYXJlbnROb2RlKSYmMTEhPT1hLm5vZGVUeXBlP2E6bnVsbH0sbmV4dDpmdW5jdGlvbihhKXtpZihhLm5leHRFbGVtZW50U2libGluZylyZXR1cm4gYS5uZXh0RWxlbWVudFNpYmxpbmc7XG5mb3IoYT1hLm5leHRTaWJsaW5nO251bGwhPWEmJjEhPT1hLm5vZGVUeXBlOylhPWEubmV4dFNpYmxpbmc7cmV0dXJuIGF9LGZpbmQ6ZnVuY3Rpb24oYSxjKXtyZXR1cm4gYS5nZXRFbGVtZW50c0J5VGFnTmFtZT9hLmdldEVsZW1lbnRzQnlUYWdOYW1lKGMpOltdfSxjbG9uZTpLYix0cmlnZ2VySGFuZGxlcjpmdW5jdGlvbihhLGMsZCl7dmFyIGUsZjtlPWMudHlwZXx8Yzt2YXIgZz0ob2EoYSxcImV2ZW50c1wiKXx8e30pW2VdO2cmJihlPXtwcmV2ZW50RGVmYXVsdDpmdW5jdGlvbigpe3RoaXMuZGVmYXVsdFByZXZlbnRlZD0hMH0saXNEZWZhdWx0UHJldmVudGVkOmZ1bmN0aW9uKCl7cmV0dXJuITA9PT10aGlzLmRlZmF1bHRQcmV2ZW50ZWR9LHN0b3BQcm9wYWdhdGlvbjpFLHR5cGU6ZSx0YXJnZXQ6YX0sYy50eXBlJiYoZT1EKGUsYykpLGM9aGEoZyksZj1kP1tlXS5jb25jYXQoZCk6W2VdLHIoYyxmdW5jdGlvbihjKXtjLmFwcGx5KGEsZil9KSl9fSxmdW5jdGlvbihhLGMpe1MucHJvdG90eXBlW2NdPVxuZnVuY3Rpb24oYyxlLGYpe2Zvcih2YXIgZyxrPTA7azx0aGlzLmxlbmd0aDtrKyspeChnKT8oZz1hKHRoaXNba10sYyxlLGYpLHkoZykmJihnPXcoZykpKTpKYihnLGEodGhpc1trXSxjLGUsZikpO3JldHVybiB5KGcpP2c6dGhpc307Uy5wcm90b3R5cGUuYmluZD1TLnByb3RvdHlwZS5vbjtTLnByb3RvdHlwZS51bmJpbmQ9Uy5wcm90b3R5cGUub2ZmfSk7YmIucHJvdG90eXBlPXtwdXQ6ZnVuY3Rpb24oYSxjKXt0aGlzW0thKGEsdGhpcy5uZXh0VWlkKV09Y30sZ2V0OmZ1bmN0aW9uKGEpe3JldHVybiB0aGlzW0thKGEsdGhpcy5uZXh0VWlkKV19LHJlbW92ZTpmdW5jdGlvbihhKXt2YXIgYz10aGlzW2E9S2EoYSx0aGlzLm5leHRVaWQpXTtkZWxldGUgdGhpc1thXTtyZXR1cm4gY319O3ZhciBxZT0vXmZ1bmN0aW9uXFxzKlteXFwoXSpcXChcXHMqKFteXFwpXSopXFwpL20scmU9LywvLHNlPS9eXFxzKihfPykoXFxTKz8pXFwxXFxzKiQvLHBlPS8oKFxcL1xcLy4qJCl8KFxcL1xcKltcXHNcXFNdKj9cXCpcXC8pKS9tZyxcbmNiPUMoXCIkaW5qZWN0b3JcIiksTmU9QyhcIiRhbmltYXRlXCIpLE1kPVtcIiRwcm92aWRlXCIsZnVuY3Rpb24oYSl7dGhpcy4kJHNlbGVjdG9ycz17fTt0aGlzLnJlZ2lzdGVyPWZ1bmN0aW9uKGMsZCl7dmFyIGU9YytcIi1hbmltYXRpb25cIjtpZihjJiZcIi5cIiE9Yy5jaGFyQXQoMCkpdGhyb3cgTmUoXCJub3Rjc2VsXCIsYyk7dGhpcy4kJHNlbGVjdG9yc1tjLnN1YnN0cigxKV09ZTthLmZhY3RvcnkoZSxkKX07dGhpcy5jbGFzc05hbWVGaWx0ZXI9ZnVuY3Rpb24oYSl7MT09PWFyZ3VtZW50cy5sZW5ndGgmJih0aGlzLiQkY2xhc3NOYW1lRmlsdGVyPWEgaW5zdGFuY2VvZiBSZWdFeHA/YTpudWxsKTtyZXR1cm4gdGhpcy4kJGNsYXNzTmFtZUZpbHRlcn07dGhpcy4kZ2V0PVtcIiR0aW1lb3V0XCIsXCIkJGFzeW5jQ2FsbGJhY2tcIixmdW5jdGlvbihhLGQpe3JldHVybntlbnRlcjpmdW5jdGlvbihhLGMsZyxrKXtnP2cuYWZ0ZXIoYSk6KGMmJmNbMF18fChjPWcucGFyZW50KCkpLGMuYXBwZW5kKGEpKTtrJiZcbmQoayl9LGxlYXZlOmZ1bmN0aW9uKGEsYyl7YS5yZW1vdmUoKTtjJiZkKGMpfSxtb3ZlOmZ1bmN0aW9uKGEsYyxkLGspe3RoaXMuZW50ZXIoYSxjLGQsayl9LGFkZENsYXNzOmZ1bmN0aW9uKGEsYyxnKXtjPXYoYyk/YzpKKGMpP2Muam9pbihcIiBcIik6XCJcIjtyKGEsZnVuY3Rpb24oYSl7b2IoYSxjKX0pO2cmJmQoZyl9LHJlbW92ZUNsYXNzOmZ1bmN0aW9uKGEsYyxnKXtjPXYoYyk/YzpKKGMpP2Muam9pbihcIiBcIik6XCJcIjtyKGEsZnVuY3Rpb24oYSl7bmIoYSxjKX0pO2cmJmQoZyl9LHNldENsYXNzOmZ1bmN0aW9uKGEsYyxnLGspe3IoYSxmdW5jdGlvbihhKXtvYihhLGMpO25iKGEsZyl9KTtrJiZkKGspfSxlbmFibGVkOkV9fV19XSxqYT1DKFwiJGNvbXBpbGVcIik7aWMuJGluamVjdD1bXCIkcHJvdmlkZVwiLFwiJCRzYW5pdGl6ZVVyaVByb3ZpZGVyXCJdO3ZhciB3ZT0vXih4W1xcOlxcLV9dfGRhdGFbXFw6XFwtX10pL2kseWM9QyhcIiRpbnRlcnBvbGF0ZVwiKSxPZT0vXihbXlxcPyNdKikoXFw/KFteI10qKSk/KCMoLiopKT8kLyxcbnplPXtodHRwOjgwLGh0dHBzOjQ0MyxmdHA6MjF9LFNiPUMoXCIkbG9jYXRpb25cIik7VWIucHJvdG90eXBlPVRiLnByb3RvdHlwZT1CYy5wcm90b3R5cGU9eyQkaHRtbDU6ITEsJCRyZXBsYWNlOiExLGFic1VybDp0YihcIiQkYWJzVXJsXCIpLHVybDpmdW5jdGlvbihhKXtpZih4KGEpKXJldHVybiB0aGlzLiQkdXJsO2E9T2UuZXhlYyhhKTthWzFdJiZ0aGlzLnBhdGgoZGVjb2RlVVJJQ29tcG9uZW50KGFbMV0pKTsoYVsyXXx8YVsxXSkmJnRoaXMuc2VhcmNoKGFbM118fFwiXCIpO3RoaXMuaGFzaChhWzVdfHxcIlwiKTtyZXR1cm4gdGhpc30scHJvdG9jb2w6dGIoXCIkJHByb3RvY29sXCIpLGhvc3Q6dGIoXCIkJGhvc3RcIikscG9ydDp0YihcIiQkcG9ydFwiKSxwYXRoOkNjKFwiJCRwYXRoXCIsZnVuY3Rpb24oYSl7YT1hP2EudG9TdHJpbmcoKTpcIlwiO3JldHVyblwiL1wiPT1hLmNoYXJBdCgwKT9hOlwiL1wiK2F9KSxzZWFyY2g6ZnVuY3Rpb24oYSxjKXtzd2l0Y2goYXJndW1lbnRzLmxlbmd0aCl7Y2FzZSAwOnJldHVybiB0aGlzLiQkc2VhcmNoO1xuY2FzZSAxOmlmKHYoYSl8fGliKGEpKWE9YS50b1N0cmluZygpLHRoaXMuJCRzZWFyY2g9ZWMoYSk7ZWxzZSBpZihUKGEpKXIoYSxmdW5jdGlvbihjLGUpe251bGw9PWMmJmRlbGV0ZSBhW2VdfSksdGhpcy4kJHNlYXJjaD1hO2Vsc2UgdGhyb3cgU2IoXCJpc3JjaGFyZ1wiKTticmVhaztkZWZhdWx0OngoYyl8fG51bGw9PT1jP2RlbGV0ZSB0aGlzLiQkc2VhcmNoW2FdOnRoaXMuJCRzZWFyY2hbYV09Y310aGlzLiQkY29tcG9zZSgpO3JldHVybiB0aGlzfSxoYXNoOkNjKFwiJCRoYXNoXCIsZnVuY3Rpb24oYSl7cmV0dXJuIGE/YS50b1N0cmluZygpOlwiXCJ9KSxyZXBsYWNlOmZ1bmN0aW9uKCl7dGhpcy4kJHJlcGxhY2U9ITA7cmV0dXJuIHRoaXN9fTt2YXIgbGE9QyhcIiRwYXJzZVwiKSxGYz17fSx3YSxQZT1GdW5jdGlvbi5wcm90b3R5cGUuY2FsbCxRZT1GdW5jdGlvbi5wcm90b3R5cGUuYXBwbHksUWM9RnVuY3Rpb24ucHJvdG90eXBlLmJpbmQsZ2I9e1wibnVsbFwiOmZ1bmN0aW9uKCl7cmV0dXJuIG51bGx9LFxuXCJ0cnVlXCI6ZnVuY3Rpb24oKXtyZXR1cm4hMH0sXCJmYWxzZVwiOmZ1bmN0aW9uKCl7cmV0dXJuITF9LHVuZGVmaW5lZDpFLFwiK1wiOmZ1bmN0aW9uKGEsYyxkLGUpe2Q9ZChhLGMpO2U9ZShhLGMpO3JldHVybiB5KGQpP3koZSk/ZCtlOmQ6eShlKT9lOnR9LFwiLVwiOmZ1bmN0aW9uKGEsYyxkLGUpe2Q9ZChhLGMpO2U9ZShhLGMpO3JldHVybih5KGQpP2Q6MCktKHkoZSk/ZTowKX0sXCIqXCI6ZnVuY3Rpb24oYSxjLGQsZSl7cmV0dXJuIGQoYSxjKSplKGEsYyl9LFwiL1wiOmZ1bmN0aW9uKGEsYyxkLGUpe3JldHVybiBkKGEsYykvZShhLGMpfSxcIiVcIjpmdW5jdGlvbihhLGMsZCxlKXtyZXR1cm4gZChhLGMpJWUoYSxjKX0sXCJeXCI6ZnVuY3Rpb24oYSxjLGQsZSl7cmV0dXJuIGQoYSxjKV5lKGEsYyl9LFwiPVwiOkUsXCI9PT1cIjpmdW5jdGlvbihhLGMsZCxlKXtyZXR1cm4gZChhLGMpPT09ZShhLGMpfSxcIiE9PVwiOmZ1bmN0aW9uKGEsYyxkLGUpe3JldHVybiBkKGEsYykhPT1lKGEsYyl9LFwiPT1cIjpmdW5jdGlvbihhLFxuYyxkLGUpe3JldHVybiBkKGEsYyk9PWUoYSxjKX0sXCIhPVwiOmZ1bmN0aW9uKGEsYyxkLGUpe3JldHVybiBkKGEsYykhPWUoYSxjKX0sXCI8XCI6ZnVuY3Rpb24oYSxjLGQsZSl7cmV0dXJuIGQoYSxjKTxlKGEsYyl9LFwiPlwiOmZ1bmN0aW9uKGEsYyxkLGUpe3JldHVybiBkKGEsYyk+ZShhLGMpfSxcIjw9XCI6ZnVuY3Rpb24oYSxjLGQsZSl7cmV0dXJuIGQoYSxjKTw9ZShhLGMpfSxcIj49XCI6ZnVuY3Rpb24oYSxjLGQsZSl7cmV0dXJuIGQoYSxjKT49ZShhLGMpfSxcIiYmXCI6ZnVuY3Rpb24oYSxjLGQsZSl7cmV0dXJuIGQoYSxjKSYmZShhLGMpfSxcInx8XCI6ZnVuY3Rpb24oYSxjLGQsZSl7cmV0dXJuIGQoYSxjKXx8ZShhLGMpfSxcIiZcIjpmdW5jdGlvbihhLGMsZCxlKXtyZXR1cm4gZChhLGMpJmUoYSxjKX0sXCJ8XCI6ZnVuY3Rpb24oYSxjLGQsZSl7cmV0dXJuIGUoYSxjKShhLGMsZChhLGMpKX0sXCIhXCI6ZnVuY3Rpb24oYSxjLGQpe3JldHVybiFkKGEsYyl9fSxSZT17bjpcIlxcblwiLGY6XCJcXGZcIixyOlwiXFxyXCIsXG50OlwiXFx0XCIsdjpcIlxcdlwiLFwiJ1wiOlwiJ1wiLCdcIic6J1wiJ30sV2I9ZnVuY3Rpb24oYSl7dGhpcy5vcHRpb25zPWF9O1diLnByb3RvdHlwZT17Y29uc3RydWN0b3I6V2IsbGV4OmZ1bmN0aW9uKGEpe3RoaXMudGV4dD1hO3RoaXMuaW5kZXg9MDt0aGlzLmNoPXQ7dGhpcy5sYXN0Q2g9XCI6XCI7Zm9yKHRoaXMudG9rZW5zPVtdO3RoaXMuaW5kZXg8dGhpcy50ZXh0Lmxlbmd0aDspe3RoaXMuY2g9dGhpcy50ZXh0LmNoYXJBdCh0aGlzLmluZGV4KTtpZih0aGlzLmlzKFwiXFxcIidcIikpdGhpcy5yZWFkU3RyaW5nKHRoaXMuY2gpO2Vsc2UgaWYodGhpcy5pc051bWJlcih0aGlzLmNoKXx8dGhpcy5pcyhcIi5cIikmJnRoaXMuaXNOdW1iZXIodGhpcy5wZWVrKCkpKXRoaXMucmVhZE51bWJlcigpO2Vsc2UgaWYodGhpcy5pc0lkZW50KHRoaXMuY2gpKXRoaXMucmVhZElkZW50KCk7ZWxzZSBpZih0aGlzLmlzKFwiKCl7fVtdLiw7Oj9cIikpdGhpcy50b2tlbnMucHVzaCh7aW5kZXg6dGhpcy5pbmRleCx0ZXh0OnRoaXMuY2h9KSxcbnRoaXMuaW5kZXgrKztlbHNlIGlmKHRoaXMuaXNXaGl0ZXNwYWNlKHRoaXMuY2gpKXt0aGlzLmluZGV4Kys7Y29udGludWV9ZWxzZXthPXRoaXMuY2grdGhpcy5wZWVrKCk7dmFyIGM9YSt0aGlzLnBlZWsoMiksZD1nYlt0aGlzLmNoXSxlPWdiW2FdLGY9Z2JbY107Zj8odGhpcy50b2tlbnMucHVzaCh7aW5kZXg6dGhpcy5pbmRleCx0ZXh0OmMsZm46Zn0pLHRoaXMuaW5kZXgrPTMpOmU/KHRoaXMudG9rZW5zLnB1c2goe2luZGV4OnRoaXMuaW5kZXgsdGV4dDphLGZuOmV9KSx0aGlzLmluZGV4Kz0yKTpkPyh0aGlzLnRva2Vucy5wdXNoKHtpbmRleDp0aGlzLmluZGV4LHRleHQ6dGhpcy5jaCxmbjpkfSksdGhpcy5pbmRleCs9MSk6dGhpcy50aHJvd0Vycm9yKFwiVW5leHBlY3RlZCBuZXh0IGNoYXJhY3RlciBcIix0aGlzLmluZGV4LHRoaXMuaW5kZXgrMSl9dGhpcy5sYXN0Q2g9dGhpcy5jaH1yZXR1cm4gdGhpcy50b2tlbnN9LGlzOmZ1bmN0aW9uKGEpe3JldHVybi0xIT09YS5pbmRleE9mKHRoaXMuY2gpfSxcbndhczpmdW5jdGlvbihhKXtyZXR1cm4tMSE9PWEuaW5kZXhPZih0aGlzLmxhc3RDaCl9LHBlZWs6ZnVuY3Rpb24oYSl7YT1hfHwxO3JldHVybiB0aGlzLmluZGV4K2E8dGhpcy50ZXh0Lmxlbmd0aD90aGlzLnRleHQuY2hhckF0KHRoaXMuaW5kZXgrYSk6ITF9LGlzTnVtYmVyOmZ1bmN0aW9uKGEpe3JldHVyblwiMFwiPD1hJiZcIjlcIj49YX0saXNXaGl0ZXNwYWNlOmZ1bmN0aW9uKGEpe3JldHVyblwiIFwiPT09YXx8XCJcXHJcIj09PWF8fFwiXFx0XCI9PT1hfHxcIlxcblwiPT09YXx8XCJcXHZcIj09PWF8fFwiXFx1MDBhMFwiPT09YX0saXNJZGVudDpmdW5jdGlvbihhKXtyZXR1cm5cImFcIjw9YSYmXCJ6XCI+PWF8fFwiQVwiPD1hJiZcIlpcIj49YXx8XCJfXCI9PT1hfHxcIiRcIj09PWF9LGlzRXhwT3BlcmF0b3I6ZnVuY3Rpb24oYSl7cmV0dXJuXCItXCI9PT1hfHxcIitcIj09PWF8fHRoaXMuaXNOdW1iZXIoYSl9LHRocm93RXJyb3I6ZnVuY3Rpb24oYSxjLGQpe2Q9ZHx8dGhpcy5pbmRleDtjPXkoYyk/XCJzIFwiK2MrXCItXCIrdGhpcy5pbmRleCtcIiBbXCIrXG50aGlzLnRleHQuc3Vic3RyaW5nKGMsZCkrXCJdXCI6XCIgXCIrZDt0aHJvdyBsYShcImxleGVyclwiLGEsYyx0aGlzLnRleHQpO30scmVhZE51bWJlcjpmdW5jdGlvbigpe2Zvcih2YXIgYT1cIlwiLGM9dGhpcy5pbmRleDt0aGlzLmluZGV4PHRoaXMudGV4dC5sZW5ndGg7KXt2YXIgZD1LKHRoaXMudGV4dC5jaGFyQXQodGhpcy5pbmRleCkpO2lmKFwiLlwiPT1kfHx0aGlzLmlzTnVtYmVyKGQpKWErPWQ7ZWxzZXt2YXIgZT10aGlzLnBlZWsoKTtpZihcImVcIj09ZCYmdGhpcy5pc0V4cE9wZXJhdG9yKGUpKWErPWQ7ZWxzZSBpZih0aGlzLmlzRXhwT3BlcmF0b3IoZCkmJmUmJnRoaXMuaXNOdW1iZXIoZSkmJlwiZVwiPT1hLmNoYXJBdChhLmxlbmd0aC0xKSlhKz1kO2Vsc2UgaWYoIXRoaXMuaXNFeHBPcGVyYXRvcihkKXx8ZSYmdGhpcy5pc051bWJlcihlKXx8XCJlXCIhPWEuY2hhckF0KGEubGVuZ3RoLTEpKWJyZWFrO2Vsc2UgdGhpcy50aHJvd0Vycm9yKFwiSW52YWxpZCBleHBvbmVudFwiKX10aGlzLmluZGV4Kyt9YSo9XG4xO3RoaXMudG9rZW5zLnB1c2goe2luZGV4OmMsdGV4dDphLGxpdGVyYWw6ITAsY29uc3RhbnQ6ITAsZm46ZnVuY3Rpb24oKXtyZXR1cm4gYX19KX0scmVhZElkZW50OmZ1bmN0aW9uKCl7Zm9yKHZhciBhPXRoaXMsYz1cIlwiLGQ9dGhpcy5pbmRleCxlLGYsZyxrO3RoaXMuaW5kZXg8dGhpcy50ZXh0Lmxlbmd0aDspe2s9dGhpcy50ZXh0LmNoYXJBdCh0aGlzLmluZGV4KTtpZihcIi5cIj09PWt8fHRoaXMuaXNJZGVudChrKXx8dGhpcy5pc051bWJlcihrKSlcIi5cIj09PWsmJihlPXRoaXMuaW5kZXgpLGMrPWs7ZWxzZSBicmVhazt0aGlzLmluZGV4Kyt9aWYoZSlmb3IoZj10aGlzLmluZGV4O2Y8dGhpcy50ZXh0Lmxlbmd0aDspe2s9dGhpcy50ZXh0LmNoYXJBdChmKTtpZihcIihcIj09PWspe2c9Yy5zdWJzdHIoZS1kKzEpO2M9Yy5zdWJzdHIoMCxlLWQpO3RoaXMuaW5kZXg9ZjticmVha31pZih0aGlzLmlzV2hpdGVzcGFjZShrKSlmKys7ZWxzZSBicmVha31kPXtpbmRleDpkLHRleHQ6Y307aWYoZ2IuaGFzT3duUHJvcGVydHkoYykpZC5mbj1cbmdiW2NdLGQubGl0ZXJhbD0hMCxkLmNvbnN0YW50PSEwO2Vsc2V7dmFyIG09RWMoYyx0aGlzLm9wdGlvbnMsdGhpcy50ZXh0KTtkLmZuPUQoZnVuY3Rpb24oYSxjKXtyZXR1cm4gbShhLGMpfSx7YXNzaWduOmZ1bmN0aW9uKGQsZSl7cmV0dXJuIHViKGQsYyxlLGEudGV4dCxhLm9wdGlvbnMpfX0pfXRoaXMudG9rZW5zLnB1c2goZCk7ZyYmKHRoaXMudG9rZW5zLnB1c2goe2luZGV4OmUsdGV4dDpcIi5cIn0pLHRoaXMudG9rZW5zLnB1c2goe2luZGV4OmUrMSx0ZXh0Omd9KSl9LHJlYWRTdHJpbmc6ZnVuY3Rpb24oYSl7dmFyIGM9dGhpcy5pbmRleDt0aGlzLmluZGV4Kys7Zm9yKHZhciBkPVwiXCIsZT1hLGY9ITE7dGhpcy5pbmRleDx0aGlzLnRleHQubGVuZ3RoOyl7dmFyIGc9dGhpcy50ZXh0LmNoYXJBdCh0aGlzLmluZGV4KSxlPWUrZztpZihmKVwidVwiPT09Zz8oZj10aGlzLnRleHQuc3Vic3RyaW5nKHRoaXMuaW5kZXgrMSx0aGlzLmluZGV4KzUpLGYubWF0Y2goL1tcXGRhLWZdezR9L2kpfHxcbnRoaXMudGhyb3dFcnJvcihcIkludmFsaWQgdW5pY29kZSBlc2NhcGUgW1xcXFx1XCIrZitcIl1cIiksdGhpcy5pbmRleCs9NCxkKz1TdHJpbmcuZnJvbUNoYXJDb2RlKHBhcnNlSW50KGYsMTYpKSk6ZCs9UmVbZ118fGcsZj0hMTtlbHNlIGlmKFwiXFxcXFwiPT09ZylmPSEwO2Vsc2V7aWYoZz09PWEpe3RoaXMuaW5kZXgrKzt0aGlzLnRva2Vucy5wdXNoKHtpbmRleDpjLHRleHQ6ZSxzdHJpbmc6ZCxsaXRlcmFsOiEwLGNvbnN0YW50OiEwLGZuOmZ1bmN0aW9uKCl7cmV0dXJuIGR9fSk7cmV0dXJufWQrPWd9dGhpcy5pbmRleCsrfXRoaXMudGhyb3dFcnJvcihcIlVudGVybWluYXRlZCBxdW90ZVwiLGMpfX07dmFyIGZiPWZ1bmN0aW9uKGEsYyxkKXt0aGlzLmxleGVyPWE7dGhpcy4kZmlsdGVyPWM7dGhpcy5vcHRpb25zPWR9O2ZiLlpFUk89RChmdW5jdGlvbigpe3JldHVybiAwfSx7Y29uc3RhbnQ6ITB9KTtmYi5wcm90b3R5cGU9e2NvbnN0cnVjdG9yOmZiLHBhcnNlOmZ1bmN0aW9uKGEpe3RoaXMudGV4dD1cbmE7dGhpcy50b2tlbnM9dGhpcy5sZXhlci5sZXgoYSk7YT10aGlzLnN0YXRlbWVudHMoKTswIT09dGhpcy50b2tlbnMubGVuZ3RoJiZ0aGlzLnRocm93RXJyb3IoXCJpcyBhbiB1bmV4cGVjdGVkIHRva2VuXCIsdGhpcy50b2tlbnNbMF0pO2EubGl0ZXJhbD0hIWEubGl0ZXJhbDthLmNvbnN0YW50PSEhYS5jb25zdGFudDtyZXR1cm4gYX0scHJpbWFyeTpmdW5jdGlvbigpe3ZhciBhO2lmKHRoaXMuZXhwZWN0KFwiKFwiKSlhPXRoaXMuZmlsdGVyQ2hhaW4oKSx0aGlzLmNvbnN1bWUoXCIpXCIpO2Vsc2UgaWYodGhpcy5leHBlY3QoXCJbXCIpKWE9dGhpcy5hcnJheURlY2xhcmF0aW9uKCk7ZWxzZSBpZih0aGlzLmV4cGVjdChcIntcIikpYT10aGlzLm9iamVjdCgpO2Vsc2V7dmFyIGM9dGhpcy5leHBlY3QoKTsoYT1jLmZuKXx8dGhpcy50aHJvd0Vycm9yKFwibm90IGEgcHJpbWFyeSBleHByZXNzaW9uXCIsYyk7YS5saXRlcmFsPSEhYy5saXRlcmFsO2EuY29uc3RhbnQ9ISFjLmNvbnN0YW50fWZvcih2YXIgZDtjPVxudGhpcy5leHBlY3QoXCIoXCIsXCJbXCIsXCIuXCIpOylcIihcIj09PWMudGV4dD8oYT10aGlzLmZ1bmN0aW9uQ2FsbChhLGQpLGQ9bnVsbCk6XCJbXCI9PT1jLnRleHQ/KGQ9YSxhPXRoaXMub2JqZWN0SW5kZXgoYSkpOlwiLlwiPT09Yy50ZXh0PyhkPWEsYT10aGlzLmZpZWxkQWNjZXNzKGEpKTp0aGlzLnRocm93RXJyb3IoXCJJTVBPU1NJQkxFXCIpO3JldHVybiBhfSx0aHJvd0Vycm9yOmZ1bmN0aW9uKGEsYyl7dGhyb3cgbGEoXCJzeW50YXhcIixjLnRleHQsYSxjLmluZGV4KzEsdGhpcy50ZXh0LHRoaXMudGV4dC5zdWJzdHJpbmcoYy5pbmRleCkpO30scGVla1Rva2VuOmZ1bmN0aW9uKCl7aWYoMD09PXRoaXMudG9rZW5zLmxlbmd0aCl0aHJvdyBsYShcInVlb2VcIix0aGlzLnRleHQpO3JldHVybiB0aGlzLnRva2Vuc1swXX0scGVlazpmdW5jdGlvbihhLGMsZCxlKXtpZigwPHRoaXMudG9rZW5zLmxlbmd0aCl7dmFyIGY9dGhpcy50b2tlbnNbMF0sZz1mLnRleHQ7aWYoZz09PWF8fGc9PT1jfHxnPT09ZHx8Zz09PVxuZXx8IShhfHxjfHxkfHxlKSlyZXR1cm4gZn1yZXR1cm4hMX0sZXhwZWN0OmZ1bmN0aW9uKGEsYyxkLGUpe3JldHVybihhPXRoaXMucGVlayhhLGMsZCxlKSk/KHRoaXMudG9rZW5zLnNoaWZ0KCksYSk6ITF9LGNvbnN1bWU6ZnVuY3Rpb24oYSl7dGhpcy5leHBlY3QoYSl8fHRoaXMudGhyb3dFcnJvcihcImlzIHVuZXhwZWN0ZWQsIGV4cGVjdGluZyBbXCIrYStcIl1cIix0aGlzLnBlZWsoKSl9LHVuYXJ5Rm46ZnVuY3Rpb24oYSxjKXtyZXR1cm4gRChmdW5jdGlvbihkLGUpe3JldHVybiBhKGQsZSxjKX0se2NvbnN0YW50OmMuY29uc3RhbnR9KX0sdGVybmFyeUZuOmZ1bmN0aW9uKGEsYyxkKXtyZXR1cm4gRChmdW5jdGlvbihlLGYpe3JldHVybiBhKGUsZik/YyhlLGYpOmQoZSxmKX0se2NvbnN0YW50OmEuY29uc3RhbnQmJmMuY29uc3RhbnQmJmQuY29uc3RhbnR9KX0sYmluYXJ5Rm46ZnVuY3Rpb24oYSxjLGQpe3JldHVybiBEKGZ1bmN0aW9uKGUsZil7cmV0dXJuIGMoZSxmLGEsZCl9LHtjb25zdGFudDphLmNvbnN0YW50JiZcbmQuY29uc3RhbnR9KX0sc3RhdGVtZW50czpmdW5jdGlvbigpe2Zvcih2YXIgYT1bXTs7KWlmKDA8dGhpcy50b2tlbnMubGVuZ3RoJiYhdGhpcy5wZWVrKFwifVwiLFwiKVwiLFwiO1wiLFwiXVwiKSYmYS5wdXNoKHRoaXMuZmlsdGVyQ2hhaW4oKSksIXRoaXMuZXhwZWN0KFwiO1wiKSlyZXR1cm4gMT09PWEubGVuZ3RoP2FbMF06ZnVuY3Rpb24oYyxkKXtmb3IodmFyIGUsZj0wO2Y8YS5sZW5ndGg7ZisrKXt2YXIgZz1hW2ZdO2cmJihlPWcoYyxkKSl9cmV0dXJuIGV9fSxmaWx0ZXJDaGFpbjpmdW5jdGlvbigpe2Zvcih2YXIgYT10aGlzLmV4cHJlc3Npb24oKSxjOzspaWYoYz10aGlzLmV4cGVjdChcInxcIikpYT10aGlzLmJpbmFyeUZuKGEsYy5mbix0aGlzLmZpbHRlcigpKTtlbHNlIHJldHVybiBhfSxmaWx0ZXI6ZnVuY3Rpb24oKXtmb3IodmFyIGE9dGhpcy5leHBlY3QoKSxjPXRoaXMuJGZpbHRlcihhLnRleHQpLGQ9W107OylpZihhPXRoaXMuZXhwZWN0KFwiOlwiKSlkLnB1c2godGhpcy5leHByZXNzaW9uKCkpO1xuZWxzZXt2YXIgZT1mdW5jdGlvbihhLGUsayl7az1ba107Zm9yKHZhciBtPTA7bTxkLmxlbmd0aDttKyspay5wdXNoKGRbbV0oYSxlKSk7cmV0dXJuIGMuYXBwbHkoYSxrKX07cmV0dXJuIGZ1bmN0aW9uKCl7cmV0dXJuIGV9fX0sZXhwcmVzc2lvbjpmdW5jdGlvbigpe3JldHVybiB0aGlzLmFzc2lnbm1lbnQoKX0sYXNzaWdubWVudDpmdW5jdGlvbigpe3ZhciBhPXRoaXMudGVybmFyeSgpLGMsZDtyZXR1cm4oZD10aGlzLmV4cGVjdChcIj1cIikpPyhhLmFzc2lnbnx8dGhpcy50aHJvd0Vycm9yKFwiaW1wbGllcyBhc3NpZ25tZW50IGJ1dCBbXCIrdGhpcy50ZXh0LnN1YnN0cmluZygwLGQuaW5kZXgpK1wiXSBjYW4gbm90IGJlIGFzc2lnbmVkIHRvXCIsZCksYz10aGlzLnRlcm5hcnkoKSxmdW5jdGlvbihkLGYpe3JldHVybiBhLmFzc2lnbihkLGMoZCxmKSxmKX0pOmF9LHRlcm5hcnk6ZnVuY3Rpb24oKXt2YXIgYT10aGlzLmxvZ2ljYWxPUigpLGMsZDtpZih0aGlzLmV4cGVjdChcIj9cIikpe2M9dGhpcy5hc3NpZ25tZW50KCk7XG5pZihkPXRoaXMuZXhwZWN0KFwiOlwiKSlyZXR1cm4gdGhpcy50ZXJuYXJ5Rm4oYSxjLHRoaXMuYXNzaWdubWVudCgpKTt0aGlzLnRocm93RXJyb3IoXCJleHBlY3RlZCA6XCIsZCl9ZWxzZSByZXR1cm4gYX0sbG9naWNhbE9SOmZ1bmN0aW9uKCl7Zm9yKHZhciBhPXRoaXMubG9naWNhbEFORCgpLGM7OylpZihjPXRoaXMuZXhwZWN0KFwifHxcIikpYT10aGlzLmJpbmFyeUZuKGEsYy5mbix0aGlzLmxvZ2ljYWxBTkQoKSk7ZWxzZSByZXR1cm4gYX0sbG9naWNhbEFORDpmdW5jdGlvbigpe3ZhciBhPXRoaXMuZXF1YWxpdHkoKSxjO2lmKGM9dGhpcy5leHBlY3QoXCImJlwiKSlhPXRoaXMuYmluYXJ5Rm4oYSxjLmZuLHRoaXMubG9naWNhbEFORCgpKTtyZXR1cm4gYX0sZXF1YWxpdHk6ZnVuY3Rpb24oKXt2YXIgYT10aGlzLnJlbGF0aW9uYWwoKSxjO2lmKGM9dGhpcy5leHBlY3QoXCI9PVwiLFwiIT1cIixcIj09PVwiLFwiIT09XCIpKWE9dGhpcy5iaW5hcnlGbihhLGMuZm4sdGhpcy5lcXVhbGl0eSgpKTtyZXR1cm4gYX0sXG5yZWxhdGlvbmFsOmZ1bmN0aW9uKCl7dmFyIGE9dGhpcy5hZGRpdGl2ZSgpLGM7aWYoYz10aGlzLmV4cGVjdChcIjxcIixcIj5cIixcIjw9XCIsXCI+PVwiKSlhPXRoaXMuYmluYXJ5Rm4oYSxjLmZuLHRoaXMucmVsYXRpb25hbCgpKTtyZXR1cm4gYX0sYWRkaXRpdmU6ZnVuY3Rpb24oKXtmb3IodmFyIGE9dGhpcy5tdWx0aXBsaWNhdGl2ZSgpLGM7Yz10aGlzLmV4cGVjdChcIitcIixcIi1cIik7KWE9dGhpcy5iaW5hcnlGbihhLGMuZm4sdGhpcy5tdWx0aXBsaWNhdGl2ZSgpKTtyZXR1cm4gYX0sbXVsdGlwbGljYXRpdmU6ZnVuY3Rpb24oKXtmb3IodmFyIGE9dGhpcy51bmFyeSgpLGM7Yz10aGlzLmV4cGVjdChcIipcIixcIi9cIixcIiVcIik7KWE9dGhpcy5iaW5hcnlGbihhLGMuZm4sdGhpcy51bmFyeSgpKTtyZXR1cm4gYX0sdW5hcnk6ZnVuY3Rpb24oKXt2YXIgYTtyZXR1cm4gdGhpcy5leHBlY3QoXCIrXCIpP3RoaXMucHJpbWFyeSgpOihhPXRoaXMuZXhwZWN0KFwiLVwiKSk/dGhpcy5iaW5hcnlGbihmYi5aRVJPLGEuZm4sXG50aGlzLnVuYXJ5KCkpOihhPXRoaXMuZXhwZWN0KFwiIVwiKSk/dGhpcy51bmFyeUZuKGEuZm4sdGhpcy51bmFyeSgpKTp0aGlzLnByaW1hcnkoKX0sZmllbGRBY2Nlc3M6ZnVuY3Rpb24oYSl7dmFyIGM9dGhpcyxkPXRoaXMuZXhwZWN0KCkudGV4dCxlPUVjKGQsdGhpcy5vcHRpb25zLHRoaXMudGV4dCk7cmV0dXJuIEQoZnVuY3Rpb24oYyxkLGspe3JldHVybiBlKGt8fGEoYyxkKSl9LHthc3NpZ246ZnVuY3Rpb24oZSxnLGspeyhrPWEoZSxrKSl8fGEuYXNzaWduKGUsaz17fSk7cmV0dXJuIHViKGssZCxnLGMudGV4dCxjLm9wdGlvbnMpfX0pfSxvYmplY3RJbmRleDpmdW5jdGlvbihhKXt2YXIgYz10aGlzLGQ9dGhpcy5leHByZXNzaW9uKCk7dGhpcy5jb25zdW1lKFwiXVwiKTtyZXR1cm4gRChmdW5jdGlvbihlLGYpe3ZhciBnPWEoZSxmKSxrPWQoZSxmKSxtO2thKGssYy50ZXh0KTtpZighZylyZXR1cm4gdDsoZz12YShnW2tdLGMudGV4dCkpJiYoZy50aGVuJiZjLm9wdGlvbnMudW53cmFwUHJvbWlzZXMpJiZcbihtPWcsXCIkJHZcImluIGd8fChtLiQkdj10LG0udGhlbihmdW5jdGlvbihhKXttLiQkdj1hfSkpLGc9Zy4kJHYpO3JldHVybiBnfSx7YXNzaWduOmZ1bmN0aW9uKGUsZixnKXt2YXIgaz1rYShkKGUsZyksYy50ZXh0KTsoZz12YShhKGUsZyksYy50ZXh0KSl8fGEuYXNzaWduKGUsZz17fSk7cmV0dXJuIGdba109Zn19KX0sZnVuY3Rpb25DYWxsOmZ1bmN0aW9uKGEsYyl7dmFyIGQ9W107aWYoXCIpXCIhPT10aGlzLnBlZWtUb2tlbigpLnRleHQpe2RvIGQucHVzaCh0aGlzLmV4cHJlc3Npb24oKSk7d2hpbGUodGhpcy5leHBlY3QoXCIsXCIpKX10aGlzLmNvbnN1bWUoXCIpXCIpO3ZhciBlPXRoaXM7cmV0dXJuIGZ1bmN0aW9uKGYsZyl7Zm9yKHZhciBrPVtdLG09Yz9jKGYsZyk6ZixoPTA7aDxkLmxlbmd0aDtoKyspay5wdXNoKHZhKGRbaF0oZixnKSxlLnRleHQpKTtoPWEoZixnLG0pfHxFO3ZhKG0sZS50ZXh0KTt2YXIgbD1lLnRleHQ7aWYoaCl7aWYoaC5jb25zdHJ1Y3Rvcj09PWgpdGhyb3cgbGEoXCJpc2VjZm5cIixcbmwpO2lmKGg9PT1QZXx8aD09PVFlfHxRYyYmaD09PVFjKXRocm93IGxhKFwiaXNlY2ZmXCIsbCk7fWs9aC5hcHBseT9oLmFwcGx5KG0sayk6aChrWzBdLGtbMV0sa1syXSxrWzNdLGtbNF0pO3JldHVybiB2YShrLGUudGV4dCl9fSxhcnJheURlY2xhcmF0aW9uOmZ1bmN0aW9uKCl7dmFyIGE9W10sYz0hMDtpZihcIl1cIiE9PXRoaXMucGVla1Rva2VuKCkudGV4dCl7ZG97aWYodGhpcy5wZWVrKFwiXVwiKSlicmVhazt2YXIgZD10aGlzLmV4cHJlc3Npb24oKTthLnB1c2goZCk7ZC5jb25zdGFudHx8KGM9ITEpfXdoaWxlKHRoaXMuZXhwZWN0KFwiLFwiKSl9dGhpcy5jb25zdW1lKFwiXVwiKTtyZXR1cm4gRChmdW5jdGlvbihjLGQpe2Zvcih2YXIgZz1bXSxrPTA7azxhLmxlbmd0aDtrKyspZy5wdXNoKGFba10oYyxkKSk7cmV0dXJuIGd9LHtsaXRlcmFsOiEwLGNvbnN0YW50OmN9KX0sb2JqZWN0OmZ1bmN0aW9uKCl7dmFyIGE9W10sYz0hMDtpZihcIn1cIiE9PXRoaXMucGVla1Rva2VuKCkudGV4dCl7ZG97aWYodGhpcy5wZWVrKFwifVwiKSlicmVhaztcbnZhciBkPXRoaXMuZXhwZWN0KCksZD1kLnN0cmluZ3x8ZC50ZXh0O3RoaXMuY29uc3VtZShcIjpcIik7dmFyIGU9dGhpcy5leHByZXNzaW9uKCk7YS5wdXNoKHtrZXk6ZCx2YWx1ZTplfSk7ZS5jb25zdGFudHx8KGM9ITEpfXdoaWxlKHRoaXMuZXhwZWN0KFwiLFwiKSl9dGhpcy5jb25zdW1lKFwifVwiKTtyZXR1cm4gRChmdW5jdGlvbihjLGQpe2Zvcih2YXIgZT17fSxtPTA7bTxhLmxlbmd0aDttKyspe3ZhciBoPWFbbV07ZVtoLmtleV09aC52YWx1ZShjLGQpfXJldHVybiBlfSx7bGl0ZXJhbDohMCxjb25zdGFudDpjfSl9fTt2YXIgVmI9e30seGE9QyhcIiRzY2VcIiksZ2E9e0hUTUw6XCJodG1sXCIsQ1NTOlwiY3NzXCIsVVJMOlwidXJsXCIsUkVTT1VSQ0VfVVJMOlwicmVzb3VyY2VVcmxcIixKUzpcImpzXCJ9LFk9WC5jcmVhdGVFbGVtZW50KFwiYVwiKSxIYz11YShXLmxvY2F0aW9uLmhyZWYsITApO21jLiRpbmplY3Q9W1wiJHByb3ZpZGVcIl07SWMuJGluamVjdD1bXCIkbG9jYWxlXCJdO0tjLiRpbmplY3Q9W1wiJGxvY2FsZVwiXTtcbnZhciBOYz1cIi5cIixKZT17eXl5eTokKFwiRnVsbFllYXJcIiw0KSx5eTokKFwiRnVsbFllYXJcIiwyLDAsITApLHk6JChcIkZ1bGxZZWFyXCIsMSksTU1NTTp2YihcIk1vbnRoXCIpLE1NTTp2YihcIk1vbnRoXCIsITApLE1NOiQoXCJNb250aFwiLDIsMSksTTokKFwiTW9udGhcIiwxLDEpLGRkOiQoXCJEYXRlXCIsMiksZDokKFwiRGF0ZVwiLDEpLEhIOiQoXCJIb3Vyc1wiLDIpLEg6JChcIkhvdXJzXCIsMSksaGg6JChcIkhvdXJzXCIsMiwtMTIpLGg6JChcIkhvdXJzXCIsMSwtMTIpLG1tOiQoXCJNaW51dGVzXCIsMiksbTokKFwiTWludXRlc1wiLDEpLHNzOiQoXCJTZWNvbmRzXCIsMiksczokKFwiU2Vjb25kc1wiLDEpLHNzczokKFwiTWlsbGlzZWNvbmRzXCIsMyksRUVFRTp2YihcIkRheVwiKSxFRUU6dmIoXCJEYXlcIiwhMCksYTpmdW5jdGlvbihhLGMpe3JldHVybiAxMj5hLmdldEhvdXJzKCk/Yy5BTVBNU1swXTpjLkFNUE1TWzFdfSxaOmZ1bmN0aW9uKGEpe2E9LTEqYS5nZXRUaW1lem9uZU9mZnNldCgpO3JldHVybiBhPSgwPD1hP1wiK1wiOlwiXCIpKyhYYihNYXRoWzA8XG5hP1wiZmxvb3JcIjpcImNlaWxcIl0oYS82MCksMikrWGIoTWF0aC5hYnMoYSU2MCksMikpfX0sSWU9LygoPzpbXnlNZEhobXNhWkUnXSspfCg/OicoPzpbXiddfCcnKSonKXwoPzpFK3x5K3xNK3xkK3xIK3xoK3xtK3xzK3xhfFopKSguKikvLEhlPS9eXFwtP1xcZCskLztKYy4kaW5qZWN0PVtcIiRsb2NhbGVcIl07dmFyIEZlPWJhKEspLEdlPWJhKElhKTtMYy4kaW5qZWN0PVtcIiRwYXJzZVwiXTt2YXIgZGQ9YmEoe3Jlc3RyaWN0OlwiRVwiLGNvbXBpbGU6ZnVuY3Rpb24oYSxjKXs4Pj1RJiYoYy5ocmVmfHxjLm5hbWV8fGMuJHNldChcImhyZWZcIixcIlwiKSxhLmFwcGVuZChYLmNyZWF0ZUNvbW1lbnQoXCJJRSBmaXhcIikpKTtpZighYy5ocmVmJiYhYy54bGlua0hyZWYmJiFjLm5hbWUpcmV0dXJuIGZ1bmN0aW9uKGEsYyl7dmFyIGY9XCJbb2JqZWN0IFNWR0FuaW1hdGVkU3RyaW5nXVwiPT09emEuY2FsbChjLnByb3AoXCJocmVmXCIpKT9cInhsaW5rOmhyZWZcIjpcImhyZWZcIjtjLm9uKFwiY2xpY2tcIixmdW5jdGlvbihhKXtjLmF0dHIoZil8fFxuYS5wcmV2ZW50RGVmYXVsdCgpfSl9fX0pLEZiPXt9O3IocWIsZnVuY3Rpb24oYSxjKXtpZihcIm11bHRpcGxlXCIhPWEpe3ZhciBkPXBhKFwibmctXCIrYyk7RmJbZF09ZnVuY3Rpb24oKXtyZXR1cm57cHJpb3JpdHk6MTAwLGxpbms6ZnVuY3Rpb24oYSxmLGcpe2EuJHdhdGNoKGdbZF0sZnVuY3Rpb24oYSl7Zy4kc2V0KGMsISFhKX0pfX19fX0pO3IoW1wic3JjXCIsXCJzcmNzZXRcIixcImhyZWZcIl0sZnVuY3Rpb24oYSl7dmFyIGM9cGEoXCJuZy1cIithKTtGYltjXT1mdW5jdGlvbigpe3JldHVybntwcmlvcml0eTo5OSxsaW5rOmZ1bmN0aW9uKGQsZSxmKXt2YXIgZz1hLGs9YTtcImhyZWZcIj09PWEmJlwiW29iamVjdCBTVkdBbmltYXRlZFN0cmluZ11cIj09PXphLmNhbGwoZS5wcm9wKFwiaHJlZlwiKSkmJihrPVwieGxpbmtIcmVmXCIsZi4kYXR0cltrXT1cInhsaW5rOmhyZWZcIixnPW51bGwpO2YuJG9ic2VydmUoYyxmdW5jdGlvbihjKXtjPyhmLiRzZXQoayxjKSxRJiZnJiZlLnByb3AoZyxmW2tdKSk6XCJocmVmXCI9PT1cbmEmJmYuJHNldChrLG51bGwpfSl9fX19KTt2YXIgeWI9eyRhZGRDb250cm9sOkUsJHJlbW92ZUNvbnRyb2w6RSwkc2V0VmFsaWRpdHk6RSwkc2V0RGlydHk6RSwkc2V0UHJpc3RpbmU6RX07T2MuJGluamVjdD1bXCIkZWxlbWVudFwiLFwiJGF0dHJzXCIsXCIkc2NvcGVcIixcIiRhbmltYXRlXCJdO3ZhciBSYz1mdW5jdGlvbihhKXtyZXR1cm5bXCIkdGltZW91dFwiLGZ1bmN0aW9uKGMpe3JldHVybntuYW1lOlwiZm9ybVwiLHJlc3RyaWN0OmE/XCJFQUNcIjpcIkVcIixjb250cm9sbGVyOk9jLGNvbXBpbGU6ZnVuY3Rpb24oKXtyZXR1cm57cHJlOmZ1bmN0aW9uKGEsZSxmLGcpe2lmKCFmLmFjdGlvbil7dmFyIGs9ZnVuY3Rpb24oYSl7YS5wcmV2ZW50RGVmYXVsdD9hLnByZXZlbnREZWZhdWx0KCk6YS5yZXR1cm5WYWx1ZT0hMX07c2IoZVswXSxcInN1Ym1pdFwiLGspO2Uub24oXCIkZGVzdHJveVwiLGZ1bmN0aW9uKCl7YyhmdW5jdGlvbigpeyRhKGVbMF0sXCJzdWJtaXRcIixrKX0sMCwhMSl9KX12YXIgbT1lLnBhcmVudCgpLmNvbnRyb2xsZXIoXCJmb3JtXCIpLFxuaD1mLm5hbWV8fGYubmdGb3JtO2gmJnViKGEsaCxnLGgpO2lmKG0pZS5vbihcIiRkZXN0cm95XCIsZnVuY3Rpb24oKXttLiRyZW1vdmVDb250cm9sKGcpO2gmJnViKGEsaCx0LGgpO0QoZyx5Yil9KX19fX19XX0sZWQ9UmMoKSxyZD1SYyghMCksU2U9L14oZnRwfGh0dHB8aHR0cHMpOlxcL1xcLyhcXHcrOnswLDF9XFx3KkApPyhcXFMrKSg6WzAtOV0rKT8oXFwvfFxcLyhbXFx3IyE6Lj8rPSYlQCFcXC1cXC9dKSk/JC8sVGU9L15bYS16MC05ISMkJSYnKitcXC89P15fYHt8fX4uLV0rQFthLXowLTldKFthLXowLTktXSpbYS16MC05XSk/KFxcLlthLXowLTldKFthLXowLTktXSpbYS16MC05XSk/KSokL2ksVWU9L15cXHMqKFxcLXxcXCspPyhcXGQrfChcXGQqKFxcLlxcZCopKSlcXHMqJC8sU2M9e3RleHQ6QWIsbnVtYmVyOmZ1bmN0aW9uKGEsYyxkLGUsZixnKXtBYihhLGMsZCxlLGYsZyk7ZS4kcGFyc2Vycy5wdXNoKGZ1bmN0aW9uKGEpe3ZhciBjPWUuJGlzRW1wdHkoYSk7aWYoY3x8VWUudGVzdChhKSlyZXR1cm4gZS4kc2V0VmFsaWRpdHkoXCJudW1iZXJcIixcbiEwKSxcIlwiPT09YT9udWxsOmM/YTpwYXJzZUZsb2F0KGEpO2UuJHNldFZhbGlkaXR5KFwibnVtYmVyXCIsITEpO3JldHVybiB0fSk7S2UoZSxcIm51bWJlclwiLFZlLG51bGwsZS4kJHZhbGlkaXR5U3RhdGUpO2UuJGZvcm1hdHRlcnMucHVzaChmdW5jdGlvbihhKXtyZXR1cm4gZS4kaXNFbXB0eShhKT9cIlwiOlwiXCIrYX0pO2QubWluJiYoYT1mdW5jdGlvbihhKXt2YXIgYz1wYXJzZUZsb2F0KGQubWluKTtyZXR1cm4gc2EoZSxcIm1pblwiLGUuJGlzRW1wdHkoYSl8fGE+PWMsYSl9LGUuJHBhcnNlcnMucHVzaChhKSxlLiRmb3JtYXR0ZXJzLnB1c2goYSkpO2QubWF4JiYoYT1mdW5jdGlvbihhKXt2YXIgYz1wYXJzZUZsb2F0KGQubWF4KTtyZXR1cm4gc2EoZSxcIm1heFwiLGUuJGlzRW1wdHkoYSl8fGE8PWMsYSl9LGUuJHBhcnNlcnMucHVzaChhKSxlLiRmb3JtYXR0ZXJzLnB1c2goYSkpO2UuJGZvcm1hdHRlcnMucHVzaChmdW5jdGlvbihhKXtyZXR1cm4gc2EoZSxcIm51bWJlclwiLGUuJGlzRW1wdHkoYSl8fFxuaWIoYSksYSl9KX0sdXJsOmZ1bmN0aW9uKGEsYyxkLGUsZixnKXtBYihhLGMsZCxlLGYsZyk7YT1mdW5jdGlvbihhKXtyZXR1cm4gc2EoZSxcInVybFwiLGUuJGlzRW1wdHkoYSl8fFNlLnRlc3QoYSksYSl9O2UuJGZvcm1hdHRlcnMucHVzaChhKTtlLiRwYXJzZXJzLnB1c2goYSl9LGVtYWlsOmZ1bmN0aW9uKGEsYyxkLGUsZixnKXtBYihhLGMsZCxlLGYsZyk7YT1mdW5jdGlvbihhKXtyZXR1cm4gc2EoZSxcImVtYWlsXCIsZS4kaXNFbXB0eShhKXx8VGUudGVzdChhKSxhKX07ZS4kZm9ybWF0dGVycy5wdXNoKGEpO2UuJHBhcnNlcnMucHVzaChhKX0scmFkaW86ZnVuY3Rpb24oYSxjLGQsZSl7eChkLm5hbWUpJiZjLmF0dHIoXCJuYW1lXCIsaGIoKSk7Yy5vbihcImNsaWNrXCIsZnVuY3Rpb24oKXtjWzBdLmNoZWNrZWQmJmEuJGFwcGx5KGZ1bmN0aW9uKCl7ZS4kc2V0Vmlld1ZhbHVlKGQudmFsdWUpfSl9KTtlLiRyZW5kZXI9ZnVuY3Rpb24oKXtjWzBdLmNoZWNrZWQ9ZC52YWx1ZT09ZS4kdmlld1ZhbHVlfTtcbmQuJG9ic2VydmUoXCJ2YWx1ZVwiLGUuJHJlbmRlcil9LGNoZWNrYm94OmZ1bmN0aW9uKGEsYyxkLGUpe3ZhciBmPWQubmdUcnVlVmFsdWUsZz1kLm5nRmFsc2VWYWx1ZTt2KGYpfHwoZj0hMCk7dihnKXx8KGc9ITEpO2Mub24oXCJjbGlja1wiLGZ1bmN0aW9uKCl7YS4kYXBwbHkoZnVuY3Rpb24oKXtlLiRzZXRWaWV3VmFsdWUoY1swXS5jaGVja2VkKX0pfSk7ZS4kcmVuZGVyPWZ1bmN0aW9uKCl7Y1swXS5jaGVja2VkPWUuJHZpZXdWYWx1ZX07ZS4kaXNFbXB0eT1mdW5jdGlvbihhKXtyZXR1cm4gYSE9PWZ9O2UuJGZvcm1hdHRlcnMucHVzaChmdW5jdGlvbihhKXtyZXR1cm4gYT09PWZ9KTtlLiRwYXJzZXJzLnB1c2goZnVuY3Rpb24oYSl7cmV0dXJuIGE/ZjpnfSl9LGhpZGRlbjpFLGJ1dHRvbjpFLHN1Ym1pdDpFLHJlc2V0OkUsZmlsZTpFfSxWZT1bXCJiYWRJbnB1dFwiXSxqYz1bXCIkYnJvd3NlclwiLFwiJHNuaWZmZXJcIixmdW5jdGlvbihhLGMpe3JldHVybntyZXN0cmljdDpcIkVcIixyZXF1aXJlOlwiP25nTW9kZWxcIixcbmxpbms6ZnVuY3Rpb24oZCxlLGYsZyl7ZyYmKFNjW0soZi50eXBlKV18fFNjLnRleHQpKGQsZSxmLGcsYyxhKX19fV0sd2I9XCJuZy12YWxpZFwiLHhiPVwibmctaW52YWxpZFwiLE9hPVwibmctcHJpc3RpbmVcIix6Yj1cIm5nLWRpcnR5XCIsV2U9W1wiJHNjb3BlXCIsXCIkZXhjZXB0aW9uSGFuZGxlclwiLFwiJGF0dHJzXCIsXCIkZWxlbWVudFwiLFwiJHBhcnNlXCIsXCIkYW5pbWF0ZVwiLGZ1bmN0aW9uKGEsYyxkLGUsZixnKXtmdW5jdGlvbiBrKGEsYyl7Yz1jP1wiLVwiK21iKGMsXCItXCIpOlwiXCI7Zy5yZW1vdmVDbGFzcyhlLChhP3hiOndiKStjKTtnLmFkZENsYXNzKGUsKGE/d2I6eGIpK2MpfXRoaXMuJG1vZGVsVmFsdWU9dGhpcy4kdmlld1ZhbHVlPU51bWJlci5OYU47dGhpcy4kcGFyc2Vycz1bXTt0aGlzLiRmb3JtYXR0ZXJzPVtdO3RoaXMuJHZpZXdDaGFuZ2VMaXN0ZW5lcnM9W107dGhpcy4kcHJpc3RpbmU9ITA7dGhpcy4kZGlydHk9ITE7dGhpcy4kdmFsaWQ9ITA7dGhpcy4kaW52YWxpZD0hMTt0aGlzLiRuYW1lPVxuZC5uYW1lO3ZhciBtPWYoZC5uZ01vZGVsKSxoPW0uYXNzaWduO2lmKCFoKXRocm93IEMoXCJuZ01vZGVsXCIpKFwibm9uYXNzaWduXCIsZC5uZ01vZGVsLGlhKGUpKTt0aGlzLiRyZW5kZXI9RTt0aGlzLiRpc0VtcHR5PWZ1bmN0aW9uKGEpe3JldHVybiB4KGEpfHxcIlwiPT09YXx8bnVsbD09PWF8fGEhPT1hfTt2YXIgbD1lLmluaGVyaXRlZERhdGEoXCIkZm9ybUNvbnRyb2xsZXJcIil8fHliLG49MCxwPXRoaXMuJGVycm9yPXt9O2UuYWRkQ2xhc3MoT2EpO2soITApO3RoaXMuJHNldFZhbGlkaXR5PWZ1bmN0aW9uKGEsYyl7cFthXSE9PSFjJiYoYz8ocFthXSYmbi0tLG58fChrKCEwKSx0aGlzLiR2YWxpZD0hMCx0aGlzLiRpbnZhbGlkPSExKSk6KGsoITEpLHRoaXMuJGludmFsaWQ9ITAsdGhpcy4kdmFsaWQ9ITEsbisrKSxwW2FdPSFjLGsoYyxhKSxsLiRzZXRWYWxpZGl0eShhLGMsdGhpcykpfTt0aGlzLiRzZXRQcmlzdGluZT1mdW5jdGlvbigpe3RoaXMuJGRpcnR5PSExO3RoaXMuJHByaXN0aW5lPVxuITA7Zy5yZW1vdmVDbGFzcyhlLHpiKTtnLmFkZENsYXNzKGUsT2EpfTt0aGlzLiRzZXRWaWV3VmFsdWU9ZnVuY3Rpb24oZCl7dGhpcy4kdmlld1ZhbHVlPWQ7dGhpcy4kcHJpc3RpbmUmJih0aGlzLiRkaXJ0eT0hMCx0aGlzLiRwcmlzdGluZT0hMSxnLnJlbW92ZUNsYXNzKGUsT2EpLGcuYWRkQ2xhc3MoZSx6YiksbC4kc2V0RGlydHkoKSk7cih0aGlzLiRwYXJzZXJzLGZ1bmN0aW9uKGEpe2Q9YShkKX0pO3RoaXMuJG1vZGVsVmFsdWUhPT1kJiYodGhpcy4kbW9kZWxWYWx1ZT1kLGgoYSxkKSxyKHRoaXMuJHZpZXdDaGFuZ2VMaXN0ZW5lcnMsZnVuY3Rpb24oYSl7dHJ5e2EoKX1jYXRjaChkKXtjKGQpfX0pKX07dmFyIHE9dGhpczthLiR3YXRjaChmdW5jdGlvbigpe3ZhciBjPW0oYSk7aWYocS4kbW9kZWxWYWx1ZSE9PWMpe3ZhciBkPXEuJGZvcm1hdHRlcnMsZT1kLmxlbmd0aDtmb3IocS4kbW9kZWxWYWx1ZT1jO2UtLTspYz1kW2VdKGMpO3EuJHZpZXdWYWx1ZSE9PWMmJihxLiR2aWV3VmFsdWU9XG5jLHEuJHJlbmRlcigpKX1yZXR1cm4gY30pfV0sR2Q9ZnVuY3Rpb24oKXtyZXR1cm57cmVxdWlyZTpbXCJuZ01vZGVsXCIsXCJeP2Zvcm1cIl0sY29udHJvbGxlcjpXZSxsaW5rOmZ1bmN0aW9uKGEsYyxkLGUpe3ZhciBmPWVbMF0sZz1lWzFdfHx5YjtnLiRhZGRDb250cm9sKGYpO2EuJG9uKFwiJGRlc3Ryb3lcIixmdW5jdGlvbigpe2cuJHJlbW92ZUNvbnRyb2woZil9KX19fSxJZD1iYSh7cmVxdWlyZTpcIm5nTW9kZWxcIixsaW5rOmZ1bmN0aW9uKGEsYyxkLGUpe2UuJHZpZXdDaGFuZ2VMaXN0ZW5lcnMucHVzaChmdW5jdGlvbigpe2EuJGV2YWwoZC5uZ0NoYW5nZSl9KX19KSxrYz1mdW5jdGlvbigpe3JldHVybntyZXF1aXJlOlwiP25nTW9kZWxcIixsaW5rOmZ1bmN0aW9uKGEsYyxkLGUpe2lmKGUpe2QucmVxdWlyZWQ9ITA7dmFyIGY9ZnVuY3Rpb24oYSl7aWYoZC5yZXF1aXJlZCYmZS4kaXNFbXB0eShhKSllLiRzZXRWYWxpZGl0eShcInJlcXVpcmVkXCIsITEpO2Vsc2UgcmV0dXJuIGUuJHNldFZhbGlkaXR5KFwicmVxdWlyZWRcIixcbiEwKSxhfTtlLiRmb3JtYXR0ZXJzLnB1c2goZik7ZS4kcGFyc2Vycy51bnNoaWZ0KGYpO2QuJG9ic2VydmUoXCJyZXF1aXJlZFwiLGZ1bmN0aW9uKCl7ZihlLiR2aWV3VmFsdWUpfSl9fX19LEhkPWZ1bmN0aW9uKCl7cmV0dXJue3JlcXVpcmU6XCJuZ01vZGVsXCIsbGluazpmdW5jdGlvbihhLGMsZCxlKXt2YXIgZj0oYT0vXFwvKC4qKVxcLy8uZXhlYyhkLm5nTGlzdCkpJiZSZWdFeHAoYVsxXSl8fGQubmdMaXN0fHxcIixcIjtlLiRwYXJzZXJzLnB1c2goZnVuY3Rpb24oYSl7aWYoIXgoYSkpe3ZhciBjPVtdO2EmJnIoYS5zcGxpdChmKSxmdW5jdGlvbihhKXthJiZjLnB1c2goYWEoYSkpfSk7cmV0dXJuIGN9fSk7ZS4kZm9ybWF0dGVycy5wdXNoKGZ1bmN0aW9uKGEpe3JldHVybiBKKGEpP2Euam9pbihcIiwgXCIpOnR9KTtlLiRpc0VtcHR5PWZ1bmN0aW9uKGEpe3JldHVybiFhfHwhYS5sZW5ndGh9fX19LFhlPS9eKHRydWV8ZmFsc2V8XFxkKykkLyxKZD1mdW5jdGlvbigpe3JldHVybntwcmlvcml0eToxMDAsXG5jb21waWxlOmZ1bmN0aW9uKGEsYyl7cmV0dXJuIFhlLnRlc3QoYy5uZ1ZhbHVlKT9mdW5jdGlvbihhLGMsZil7Zi4kc2V0KFwidmFsdWVcIixhLiRldmFsKGYubmdWYWx1ZSkpfTpmdW5jdGlvbihhLGMsZil7YS4kd2F0Y2goZi5uZ1ZhbHVlLGZ1bmN0aW9uKGEpe2YuJHNldChcInZhbHVlXCIsYSl9KX19fX0samQ9eWEoe2NvbXBpbGU6ZnVuY3Rpb24oYSl7YS5hZGRDbGFzcyhcIm5nLWJpbmRpbmdcIik7cmV0dXJuIGZ1bmN0aW9uKGEsZCxlKXtkLmRhdGEoXCIkYmluZGluZ1wiLGUubmdCaW5kKTthLiR3YXRjaChlLm5nQmluZCxmdW5jdGlvbihhKXtkLnRleHQoYT09dD9cIlwiOmEpfSl9fX0pLGxkPVtcIiRpbnRlcnBvbGF0ZVwiLGZ1bmN0aW9uKGEpe3JldHVybiBmdW5jdGlvbihjLGQsZSl7Yz1hKGQuYXR0cihlLiRhdHRyLm5nQmluZFRlbXBsYXRlKSk7ZC5hZGRDbGFzcyhcIm5nLWJpbmRpbmdcIikuZGF0YShcIiRiaW5kaW5nXCIsYyk7ZS4kb2JzZXJ2ZShcIm5nQmluZFRlbXBsYXRlXCIsZnVuY3Rpb24oYSl7ZC50ZXh0KGEpfSl9fV0sXG5rZD1bXCIkc2NlXCIsXCIkcGFyc2VcIixmdW5jdGlvbihhLGMpe3JldHVybntjb21waWxlOmZ1bmN0aW9uKGQpe2QuYWRkQ2xhc3MoXCJuZy1iaW5kaW5nXCIpO3JldHVybiBmdW5jdGlvbihkLGYsZyl7Zi5kYXRhKFwiJGJpbmRpbmdcIixnLm5nQmluZEh0bWwpO3ZhciBrPWMoZy5uZ0JpbmRIdG1sKTtkLiR3YXRjaChmdW5jdGlvbigpe3JldHVybihrKGQpfHxcIlwiKS50b1N0cmluZygpfSxmdW5jdGlvbihjKXtmLmh0bWwoYS5nZXRUcnVzdGVkSHRtbChrKGQpKXx8XCJcIil9KX19fX1dLG1kPVliKFwiXCIsITApLG9kPVliKFwiT2RkXCIsMCksbmQ9WWIoXCJFdmVuXCIsMSkscGQ9eWEoe2NvbXBpbGU6ZnVuY3Rpb24oYSxjKXtjLiRzZXQoXCJuZ0Nsb2FrXCIsdCk7YS5yZW1vdmVDbGFzcyhcIm5nLWNsb2FrXCIpfX0pLHFkPVtmdW5jdGlvbigpe3JldHVybntzY29wZTohMCxjb250cm9sbGVyOlwiQFwiLHByaW9yaXR5OjUwMH19XSxsYz17fSxZZT17Ymx1cjohMCxmb2N1czohMH07cihcImNsaWNrIGRibGNsaWNrIG1vdXNlZG93biBtb3VzZXVwIG1vdXNlb3ZlciBtb3VzZW91dCBtb3VzZW1vdmUgbW91c2VlbnRlciBtb3VzZWxlYXZlIGtleWRvd24ga2V5dXAga2V5cHJlc3Mgc3VibWl0IGZvY3VzIGJsdXIgY29weSBjdXQgcGFzdGVcIi5zcGxpdChcIiBcIiksXG5mdW5jdGlvbihhKXt2YXIgYz1wYShcIm5nLVwiK2EpO2xjW2NdPVtcIiRwYXJzZVwiLFwiJHJvb3RTY29wZVwiLGZ1bmN0aW9uKGQsZSl7cmV0dXJue2NvbXBpbGU6ZnVuY3Rpb24oZixnKXt2YXIgaz1kKGdbY10pO3JldHVybiBmdW5jdGlvbihjLGQpe2Qub24oYSxmdW5jdGlvbihkKXt2YXIgZj1mdW5jdGlvbigpe2soYyx7JGV2ZW50OmR9KX07WWVbYV0mJmUuJCRwaGFzZT9jLiRldmFsQXN5bmMoZik6Yy4kYXBwbHkoZil9KX19fX1dfSk7dmFyIHRkPVtcIiRhbmltYXRlXCIsZnVuY3Rpb24oYSl7cmV0dXJue3RyYW5zY2x1ZGU6XCJlbGVtZW50XCIscHJpb3JpdHk6NjAwLHRlcm1pbmFsOiEwLHJlc3RyaWN0OlwiQVwiLCQkdGxiOiEwLGxpbms6ZnVuY3Rpb24oYyxkLGUsZixnKXt2YXIgayxtLGg7Yy4kd2F0Y2goZS5uZ0lmLGZ1bmN0aW9uKGYpe1VhKGYpP218fChtPWMuJG5ldygpLGcobSxmdW5jdGlvbihjKXtjW2MubGVuZ3RoKytdPVguY3JlYXRlQ29tbWVudChcIiBlbmQgbmdJZjogXCIrZS5uZ0lmK1xuXCIgXCIpO2s9e2Nsb25lOmN9O2EuZW50ZXIoYyxkLnBhcmVudCgpLGQpfSkpOihoJiYoaC5yZW1vdmUoKSxoPW51bGwpLG0mJihtLiRkZXN0cm95KCksbT1udWxsKSxrJiYoaD1FYihrLmNsb25lKSxhLmxlYXZlKGgsZnVuY3Rpb24oKXtoPW51bGx9KSxrPW51bGwpKX0pfX19XSx1ZD1bXCIkaHR0cFwiLFwiJHRlbXBsYXRlQ2FjaGVcIixcIiRhbmNob3JTY3JvbGxcIixcIiRhbmltYXRlXCIsXCIkc2NlXCIsZnVuY3Rpb24oYSxjLGQsZSxmKXtyZXR1cm57cmVzdHJpY3Q6XCJFQ0FcIixwcmlvcml0eTo0MDAsdGVybWluYWw6ITAsdHJhbnNjbHVkZTpcImVsZW1lbnRcIixjb250cm9sbGVyOlZhLm5vb3AsY29tcGlsZTpmdW5jdGlvbihnLGspe3ZhciBtPWsubmdJbmNsdWRlfHxrLnNyYyxoPWsub25sb2FkfHxcIlwiLGw9ay5hdXRvc2Nyb2xsO3JldHVybiBmdW5jdGlvbihnLGsscSxyLEYpe3ZhciB1PTAsdCx3LFIsej1mdW5jdGlvbigpe3cmJih3LnJlbW92ZSgpLHc9bnVsbCk7dCYmKHQuJGRlc3Ryb3koKSx0PW51bGwpO1xuUiYmKGUubGVhdmUoUixmdW5jdGlvbigpe3c9bnVsbH0pLHc9UixSPW51bGwpfTtnLiR3YXRjaChmLnBhcnNlQXNSZXNvdXJjZVVybChtKSxmdW5jdGlvbihmKXt2YXIgbT1mdW5jdGlvbigpeyF5KGwpfHxsJiYhZy4kZXZhbChsKXx8ZCgpfSxxPSsrdTtmPyhhLmdldChmLHtjYWNoZTpjfSkuc3VjY2VzcyhmdW5jdGlvbihhKXtpZihxPT09dSl7dmFyIGM9Zy4kbmV3KCk7ci50ZW1wbGF0ZT1hO2E9RihjLGZ1bmN0aW9uKGEpe3ooKTtlLmVudGVyKGEsbnVsbCxrLG0pfSk7dD1jO1I9YTt0LiRlbWl0KFwiJGluY2x1ZGVDb250ZW50TG9hZGVkXCIpO2cuJGV2YWwoaCl9fSkuZXJyb3IoZnVuY3Rpb24oKXtxPT09dSYmeigpfSksZy4kZW1pdChcIiRpbmNsdWRlQ29udGVudFJlcXVlc3RlZFwiKSk6KHooKSxyLnRlbXBsYXRlPW51bGwpfSl9fX19XSxLZD1bXCIkY29tcGlsZVwiLGZ1bmN0aW9uKGEpe3JldHVybntyZXN0cmljdDpcIkVDQVwiLHByaW9yaXR5Oi00MDAscmVxdWlyZTpcIm5nSW5jbHVkZVwiLFxubGluazpmdW5jdGlvbihjLGQsZSxmKXtkLmh0bWwoZi50ZW1wbGF0ZSk7YShkLmNvbnRlbnRzKCkpKGMpfX19XSx2ZD15YSh7cHJpb3JpdHk6NDUwLGNvbXBpbGU6ZnVuY3Rpb24oKXtyZXR1cm57cHJlOmZ1bmN0aW9uKGEsYyxkKXthLiRldmFsKGQubmdJbml0KX19fX0pLHdkPXlhKHt0ZXJtaW5hbDohMCxwcmlvcml0eToxRTN9KSx4ZD1bXCIkbG9jYWxlXCIsXCIkaW50ZXJwb2xhdGVcIixmdW5jdGlvbihhLGMpe3ZhciBkPS97fS9nO3JldHVybntyZXN0cmljdDpcIkVBXCIsbGluazpmdW5jdGlvbihlLGYsZyl7dmFyIGs9Zy5jb3VudCxtPWcuJGF0dHIud2hlbiYmZi5hdHRyKGcuJGF0dHIud2hlbiksaD1nLm9mZnNldHx8MCxsPWUuJGV2YWwobSl8fHt9LG49e30scD1jLnN0YXJ0U3ltYm9sKCkscT1jLmVuZFN5bWJvbCgpLHM9L153aGVuKE1pbnVzKT8oLispJC87cihnLGZ1bmN0aW9uKGEsYyl7cy50ZXN0KGMpJiYobFtLKGMucmVwbGFjZShcIndoZW5cIixcIlwiKS5yZXBsYWNlKFwiTWludXNcIixcIi1cIikpXT1cbmYuYXR0cihnLiRhdHRyW2NdKSl9KTtyKGwsZnVuY3Rpb24oYSxlKXtuW2VdPWMoYS5yZXBsYWNlKGQscCtrK1wiLVwiK2grcSkpfSk7ZS4kd2F0Y2goZnVuY3Rpb24oKXt2YXIgYz1wYXJzZUZsb2F0KGUuJGV2YWwoaykpO2lmKGlzTmFOKGMpKXJldHVyblwiXCI7YyBpbiBsfHwoYz1hLnBsdXJhbENhdChjLWgpKTtyZXR1cm4gbltjXShlLGYsITApfSxmdW5jdGlvbihhKXtmLnRleHQoYSl9KX19fV0seWQ9W1wiJHBhcnNlXCIsXCIkYW5pbWF0ZVwiLGZ1bmN0aW9uKGEsYyl7dmFyIGQ9QyhcIm5nUmVwZWF0XCIpO3JldHVybnt0cmFuc2NsdWRlOlwiZWxlbWVudFwiLHByaW9yaXR5OjFFMyx0ZXJtaW5hbDohMCwkJHRsYjohMCxsaW5rOmZ1bmN0aW9uKGUsZixnLGssbSl7dmFyIGg9Zy5uZ1JlcGVhdCxsPWgubWF0Y2goL15cXHMqKFtcXHNcXFNdKz8pXFxzK2luXFxzKyhbXFxzXFxTXSs/KSg/Olxccyt0cmFja1xccytieVxccysoW1xcc1xcU10rPykpP1xccyokLyksbixwLHEscyx0LHUsQT17JGlkOkthfTtpZighbCl0aHJvdyBkKFwiaWV4cFwiLFxuaCk7Zz1sWzFdO2s9bFsyXTsobD1sWzNdKT8obj1hKGwpLHA9ZnVuY3Rpb24oYSxjLGQpe3UmJihBW3VdPWEpO0FbdF09YztBLiRpbmRleD1kO3JldHVybiBuKGUsQSl9KToocT1mdW5jdGlvbihhLGMpe3JldHVybiBLYShjKX0scz1mdW5jdGlvbihhKXtyZXR1cm4gYX0pO2w9Zy5tYXRjaCgvXig/OihbXFwkXFx3XSspfFxcKChbXFwkXFx3XSspXFxzKixcXHMqKFtcXCRcXHddKylcXCkpJC8pO2lmKCFsKXRocm93IGQoXCJpaWRleHBcIixnKTt0PWxbM118fGxbMV07dT1sWzJdO3ZhciB5PXt9O2UuJHdhdGNoQ29sbGVjdGlvbihrLGZ1bmN0aW9uKGEpe3ZhciBnLGssbD1mWzBdLG4sQT17fSxCLEksSCx2LEUsQyx4LEo9W107aWYoUGEoYSkpQz1hLEU9cHx8cTtlbHNle0U9cHx8cztDPVtdO2ZvcihIIGluIGEpYS5oYXNPd25Qcm9wZXJ0eShIKSYmXCIkXCIhPUguY2hhckF0KDApJiZDLnB1c2goSCk7Qy5zb3J0KCl9Qj1DLmxlbmd0aDtrPUoubGVuZ3RoPUMubGVuZ3RoO2ZvcihnPTA7ZzxrO2crKylpZihIPWE9PT1cbkM/ZzpDW2ddLHY9YVtIXSxuPUUoSCx2LGcpLERhKG4sXCJgdHJhY2sgYnlgIGlkXCIpLHkuaGFzT3duUHJvcGVydHkobikpeD15W25dLGRlbGV0ZSB5W25dLEFbbl09eCxKW2ddPXg7ZWxzZXtpZihBLmhhc093blByb3BlcnR5KG4pKXRocm93IHIoSixmdW5jdGlvbihhKXthJiZhLnNjb3BlJiYoeVthLmlkXT1hKX0pLGQoXCJkdXBlc1wiLGgsbixuYSh2KSk7SltnXT17aWQ6bn07QVtuXT0hMX1mb3IoSCBpbiB5KXkuaGFzT3duUHJvcGVydHkoSCkmJih4PXlbSF0sZz1FYih4LmNsb25lKSxjLmxlYXZlKGcpLHIoZyxmdW5jdGlvbihhKXthLiQkTkdfUkVNT1ZFRD0hMH0pLHguc2NvcGUuJGRlc3Ryb3koKSk7Zz0wO2ZvcihrPUMubGVuZ3RoO2c8aztnKyspe0g9YT09PUM/ZzpDW2ddO3Y9YVtIXTt4PUpbZ107SltnLTFdJiYobD1KW2ctMV0uY2xvbmVbSltnLTFdLmNsb25lLmxlbmd0aC0xXSk7aWYoeC5zY29wZSl7ST14LnNjb3BlO249bDtkbyBuPW4ubmV4dFNpYmxpbmc7d2hpbGUobiYmbi4kJE5HX1JFTU9WRUQpO1xueC5jbG9uZVswXSE9biYmYy5tb3ZlKEViKHguY2xvbmUpLG51bGwsdyhsKSk7bD14LmNsb25lW3guY2xvbmUubGVuZ3RoLTFdfWVsc2UgST1lLiRuZXcoKTtJW3RdPXY7dSYmKElbdV09SCk7SS4kaW5kZXg9ZztJLiRmaXJzdD0wPT09ZztJLiRsYXN0PWc9PT1CLTE7SS4kbWlkZGxlPSEoSS4kZmlyc3R8fEkuJGxhc3QpO0kuJG9kZD0hKEkuJGV2ZW49MD09PShnJjEpKTt4LnNjb3BlfHxtKEksZnVuY3Rpb24oYSl7YVthLmxlbmd0aCsrXT1YLmNyZWF0ZUNvbW1lbnQoXCIgZW5kIG5nUmVwZWF0OiBcIitoK1wiIFwiKTtjLmVudGVyKGEsbnVsbCx3KGwpKTtsPWE7eC5zY29wZT1JO3guY2xvbmU9YTtBW3guaWRdPXh9KX15PUF9KX19fV0semQ9W1wiJGFuaW1hdGVcIixmdW5jdGlvbihhKXtyZXR1cm4gZnVuY3Rpb24oYyxkLGUpe2MuJHdhdGNoKGUubmdTaG93LGZ1bmN0aW9uKGMpe2FbVWEoYyk/XCJyZW1vdmVDbGFzc1wiOlwiYWRkQ2xhc3NcIl0oZCxcIm5nLWhpZGVcIil9KX19XSxzZD1bXCIkYW5pbWF0ZVwiLFxuZnVuY3Rpb24oYSl7cmV0dXJuIGZ1bmN0aW9uKGMsZCxlKXtjLiR3YXRjaChlLm5nSGlkZSxmdW5jdGlvbihjKXthW1VhKGMpP1wiYWRkQ2xhc3NcIjpcInJlbW92ZUNsYXNzXCJdKGQsXCJuZy1oaWRlXCIpfSl9fV0sQWQ9eWEoZnVuY3Rpb24oYSxjLGQpe2EuJHdhdGNoKGQubmdTdHlsZSxmdW5jdGlvbihhLGQpe2QmJmEhPT1kJiZyKGQsZnVuY3Rpb24oYSxkKXtjLmNzcyhkLFwiXCIpfSk7YSYmYy5jc3MoYSl9LCEwKX0pLEJkPVtcIiRhbmltYXRlXCIsZnVuY3Rpb24oYSl7cmV0dXJue3Jlc3RyaWN0OlwiRUFcIixyZXF1aXJlOlwibmdTd2l0Y2hcIixjb250cm9sbGVyOltcIiRzY29wZVwiLGZ1bmN0aW9uKCl7dGhpcy5jYXNlcz17fX1dLGxpbms6ZnVuY3Rpb24oYyxkLGUsZil7dmFyIGc9W10saz1bXSxtPVtdLGg9W107Yy4kd2F0Y2goZS5uZ1N3aXRjaHx8ZS5vbixmdW5jdGlvbihkKXt2YXIgbixwO249MDtmb3IocD1tLmxlbmd0aDtuPHA7KytuKW1bbl0ucmVtb3ZlKCk7bj1tLmxlbmd0aD0wO2ZvcihwPVxuaC5sZW5ndGg7bjxwOysrbil7dmFyIHE9a1tuXTtoW25dLiRkZXN0cm95KCk7bVtuXT1xO2EubGVhdmUocSxmdW5jdGlvbigpe20uc3BsaWNlKG4sMSl9KX1rLmxlbmd0aD0wO2gubGVuZ3RoPTA7aWYoZz1mLmNhc2VzW1wiIVwiK2RdfHxmLmNhc2VzW1wiP1wiXSljLiRldmFsKGUuY2hhbmdlKSxyKGcsZnVuY3Rpb24oZCl7dmFyIGU9Yy4kbmV3KCk7aC5wdXNoKGUpO2QudHJhbnNjbHVkZShlLGZ1bmN0aW9uKGMpe3ZhciBlPWQuZWxlbWVudDtrLnB1c2goYyk7YS5lbnRlcihjLGUucGFyZW50KCksZSl9KX0pfSl9fX1dLENkPXlhKHt0cmFuc2NsdWRlOlwiZWxlbWVudFwiLHByaW9yaXR5OjgwMCxyZXF1aXJlOlwiXm5nU3dpdGNoXCIsbGluazpmdW5jdGlvbihhLGMsZCxlLGYpe2UuY2FzZXNbXCIhXCIrZC5uZ1N3aXRjaFdoZW5dPWUuY2FzZXNbXCIhXCIrZC5uZ1N3aXRjaFdoZW5dfHxbXTtlLmNhc2VzW1wiIVwiK2QubmdTd2l0Y2hXaGVuXS5wdXNoKHt0cmFuc2NsdWRlOmYsZWxlbWVudDpjfSl9fSksRGQ9XG55YSh7dHJhbnNjbHVkZTpcImVsZW1lbnRcIixwcmlvcml0eTo4MDAscmVxdWlyZTpcIl5uZ1N3aXRjaFwiLGxpbms6ZnVuY3Rpb24oYSxjLGQsZSxmKXtlLmNhc2VzW1wiP1wiXT1lLmNhc2VzW1wiP1wiXXx8W107ZS5jYXNlc1tcIj9cIl0ucHVzaCh7dHJhbnNjbHVkZTpmLGVsZW1lbnQ6Y30pfX0pLEZkPXlhKHtsaW5rOmZ1bmN0aW9uKGEsYyxkLGUsZil7aWYoIWYpdGhyb3cgQyhcIm5nVHJhbnNjbHVkZVwiKShcIm9ycGhhblwiLGlhKGMpKTtmKGZ1bmN0aW9uKGEpe2MuZW1wdHkoKTtjLmFwcGVuZChhKX0pfX0pLGZkPVtcIiR0ZW1wbGF0ZUNhY2hlXCIsZnVuY3Rpb24oYSl7cmV0dXJue3Jlc3RyaWN0OlwiRVwiLHRlcm1pbmFsOiEwLGNvbXBpbGU6ZnVuY3Rpb24oYyxkKXtcInRleHQvbmctdGVtcGxhdGVcIj09ZC50eXBlJiZhLnB1dChkLmlkLGNbMF0udGV4dCl9fX1dLFplPUMoXCJuZ09wdGlvbnNcIiksRWQ9YmEoe3Rlcm1pbmFsOiEwfSksZ2Q9W1wiJGNvbXBpbGVcIixcIiRwYXJzZVwiLGZ1bmN0aW9uKGEsYyl7dmFyIGQ9XG4vXlxccyooW1xcc1xcU10rPykoPzpcXHMrYXNcXHMrKFtcXHNcXFNdKz8pKT8oPzpcXHMrZ3JvdXBcXHMrYnlcXHMrKFtcXHNcXFNdKz8pKT9cXHMrZm9yXFxzKyg/OihbXFwkXFx3XVtcXCRcXHddKil8KD86XFwoXFxzKihbXFwkXFx3XVtcXCRcXHddKilcXHMqLFxccyooW1xcJFxcd11bXFwkXFx3XSopXFxzKlxcKSkpXFxzK2luXFxzKyhbXFxzXFxTXSs/KSg/Olxccyt0cmFja1xccytieVxccysoW1xcc1xcU10rPykpPyQvLGU9eyRzZXRWaWV3VmFsdWU6RX07cmV0dXJue3Jlc3RyaWN0OlwiRVwiLHJlcXVpcmU6W1wic2VsZWN0XCIsXCI/bmdNb2RlbFwiXSxjb250cm9sbGVyOltcIiRlbGVtZW50XCIsXCIkc2NvcGVcIixcIiRhdHRyc1wiLGZ1bmN0aW9uKGEsYyxkKXt2YXIgbT10aGlzLGg9e30sbD1lLG47bS5kYXRhYm91bmQ9ZC5uZ01vZGVsO20uaW5pdD1mdW5jdGlvbihhLGMsZCl7bD1hO249ZH07bS5hZGRPcHRpb249ZnVuY3Rpb24oYyl7RGEoYywnXCJvcHRpb24gdmFsdWVcIicpO2hbY109ITA7bC4kdmlld1ZhbHVlPT1jJiYoYS52YWwoYyksbi5wYXJlbnQoKSYmbi5yZW1vdmUoKSl9O1xubS5yZW1vdmVPcHRpb249ZnVuY3Rpb24oYSl7dGhpcy5oYXNPcHRpb24oYSkmJihkZWxldGUgaFthXSxsLiR2aWV3VmFsdWU9PWEmJnRoaXMucmVuZGVyVW5rbm93bk9wdGlvbihhKSl9O20ucmVuZGVyVW5rbm93bk9wdGlvbj1mdW5jdGlvbihjKXtjPVwiPyBcIitLYShjKStcIiA/XCI7bi52YWwoYyk7YS5wcmVwZW5kKG4pO2EudmFsKGMpO24ucHJvcChcInNlbGVjdGVkXCIsITApfTttLmhhc09wdGlvbj1mdW5jdGlvbihhKXtyZXR1cm4gaC5oYXNPd25Qcm9wZXJ0eShhKX07Yy4kb24oXCIkZGVzdHJveVwiLGZ1bmN0aW9uKCl7bS5yZW5kZXJVbmtub3duT3B0aW9uPUV9KX1dLGxpbms6ZnVuY3Rpb24oZSxnLGssbSl7ZnVuY3Rpb24gaChhLGMsZCxlKXtkLiRyZW5kZXI9ZnVuY3Rpb24oKXt2YXIgYT1kLiR2aWV3VmFsdWU7ZS5oYXNPcHRpb24oYSk/KHYucGFyZW50KCkmJnYucmVtb3ZlKCksYy52YWwoYSksXCJcIj09PWEmJnUucHJvcChcInNlbGVjdGVkXCIsITApKTp4KGEpJiZ1P2MudmFsKFwiXCIpOmUucmVuZGVyVW5rbm93bk9wdGlvbihhKX07XG5jLm9uKFwiY2hhbmdlXCIsZnVuY3Rpb24oKXthLiRhcHBseShmdW5jdGlvbigpe3YucGFyZW50KCkmJnYucmVtb3ZlKCk7ZC4kc2V0Vmlld1ZhbHVlKGMudmFsKCkpfSl9KX1mdW5jdGlvbiBsKGEsYyxkKXt2YXIgZTtkLiRyZW5kZXI9ZnVuY3Rpb24oKXt2YXIgYT1uZXcgYmIoZC4kdmlld1ZhbHVlKTtyKGMuZmluZChcIm9wdGlvblwiKSxmdW5jdGlvbihjKXtjLnNlbGVjdGVkPXkoYS5nZXQoYy52YWx1ZSkpfSl9O2EuJHdhdGNoKGZ1bmN0aW9uKCl7QWEoZSxkLiR2aWV3VmFsdWUpfHwoZT1oYShkLiR2aWV3VmFsdWUpLGQuJHJlbmRlcigpKX0pO2Mub24oXCJjaGFuZ2VcIixmdW5jdGlvbigpe2EuJGFwcGx5KGZ1bmN0aW9uKCl7dmFyIGE9W107cihjLmZpbmQoXCJvcHRpb25cIiksZnVuY3Rpb24oYyl7Yy5zZWxlY3RlZCYmYS5wdXNoKGMudmFsdWUpfSk7ZC4kc2V0Vmlld1ZhbHVlKGEpfSl9KX1mdW5jdGlvbiBuKGUsZixnKXtmdW5jdGlvbiBrKCl7dmFyIGE9e1wiXCI6W119LGM9W1wiXCJdLGQsaCxcbnMsdCx2O3M9Zy4kbW9kZWxWYWx1ZTt0PXcoZSl8fFtdO3ZhciBFPW4/WmIodCk6dCxJLE0sQjtNPXt9O0I9ITE7aWYocSlpZihoPWcuJG1vZGVsVmFsdWUseCYmSihoKSlmb3IoQj1uZXcgYmIoW10pLGQ9e30sdj0wO3Y8aC5sZW5ndGg7disrKWRbbV09aFt2XSxCLnB1dCh4KGUsZCksaFt2XSk7ZWxzZSBCPW5ldyBiYihoKTt2PUI7dmFyIEQsSztmb3IoQj0wO0k9RS5sZW5ndGgsQjxJO0IrKyl7aD1CO2lmKG4pe2g9RVtCXTtpZihcIiRcIj09PWguY2hhckF0KDApKWNvbnRpbnVlO01bbl09aH1NW21dPXRbaF07ZD1yKGUsTSl8fFwiXCI7KGg9YVtkXSl8fChoPWFbZF09W10sYy5wdXNoKGQpKTtxP2Q9eSh2LnJlbW92ZSh4P3goZSxNKTp1KGUsTSkpKTooeD8oZD17fSxkW21dPXMsZD14KGUsZCk9PT14KGUsTSkpOmQ9cz09PXUoZSxNKSx2PXZ8fGQpO0Q9bChlLE0pO0Q9eShEKT9EOlwiXCI7aC5wdXNoKHtpZDp4P3goZSxNKTpuP0VbQl06QixsYWJlbDpELHNlbGVjdGVkOmR9KX1xfHwoRnx8bnVsbD09PVxucz9hW1wiXCJdLnVuc2hpZnQoe2lkOlwiXCIsbGFiZWw6XCJcIixzZWxlY3RlZDohdn0pOnZ8fGFbXCJcIl0udW5zaGlmdCh7aWQ6XCI/XCIsbGFiZWw6XCJcIixzZWxlY3RlZDohMH0pKTtNPTA7Zm9yKEU9Yy5sZW5ndGg7TTxFO00rKyl7ZD1jW01dO2g9YVtkXTt6Lmxlbmd0aDw9TT8ocz17ZWxlbWVudDpDLmNsb25lKCkuYXR0cihcImxhYmVsXCIsZCksbGFiZWw6aC5sYWJlbH0sdD1bc10sei5wdXNoKHQpLGYuYXBwZW5kKHMuZWxlbWVudCkpOih0PXpbTV0scz10WzBdLHMubGFiZWwhPWQmJnMuZWxlbWVudC5hdHRyKFwibGFiZWxcIixzLmxhYmVsPWQpKTtEPW51bGw7Qj0wO2ZvcihJPWgubGVuZ3RoO0I8STtCKyspZD1oW0JdLCh2PXRbQisxXSk/KEQ9di5lbGVtZW50LHYubGFiZWwhPT1kLmxhYmVsJiZELnRleHQodi5sYWJlbD1kLmxhYmVsKSx2LmlkIT09ZC5pZCYmRC52YWwodi5pZD1kLmlkKSxEWzBdLnNlbGVjdGVkIT09ZC5zZWxlY3RlZCYmKEQucHJvcChcInNlbGVjdGVkXCIsdi5zZWxlY3RlZD1kLnNlbGVjdGVkKSxcblEmJkQucHJvcChcInNlbGVjdGVkXCIsdi5zZWxlY3RlZCkpKTooXCJcIj09PWQuaWQmJkY/Sz1GOihLPUEuY2xvbmUoKSkudmFsKGQuaWQpLnByb3AoXCJzZWxlY3RlZFwiLGQuc2VsZWN0ZWQpLmF0dHIoXCJzZWxlY3RlZFwiLGQuc2VsZWN0ZWQpLnRleHQoZC5sYWJlbCksdC5wdXNoKHtlbGVtZW50OkssbGFiZWw6ZC5sYWJlbCxpZDpkLmlkLHNlbGVjdGVkOmQuc2VsZWN0ZWR9KSxwLmFkZE9wdGlvbihkLmxhYmVsLEspLEQ/RC5hZnRlcihLKTpzLmVsZW1lbnQuYXBwZW5kKEspLEQ9Syk7Zm9yKEIrKzt0Lmxlbmd0aD5COylkPXQucG9wKCkscC5yZW1vdmVPcHRpb24oZC5sYWJlbCksZC5lbGVtZW50LnJlbW92ZSgpfWZvcig7ei5sZW5ndGg+TTspei5wb3AoKVswXS5lbGVtZW50LnJlbW92ZSgpfXZhciBoO2lmKCEoaD1zLm1hdGNoKGQpKSl0aHJvdyBaZShcImlleHBcIixzLGlhKGYpKTt2YXIgbD1jKGhbMl18fGhbMV0pLG09aFs0XXx8aFs2XSxuPWhbNV0scj1jKGhbM118fFwiXCIpLHU9YyhoWzJdP1xuaFsxXTptKSx3PWMoaFs3XSkseD1oWzhdP2MoaFs4XSk6bnVsbCx6PVtbe2VsZW1lbnQ6ZixsYWJlbDpcIlwifV1dO0YmJihhKEYpKGUpLEYucmVtb3ZlQ2xhc3MoXCJuZy1zY29wZVwiKSxGLnJlbW92ZSgpKTtmLmVtcHR5KCk7Zi5vbihcImNoYW5nZVwiLGZ1bmN0aW9uKCl7ZS4kYXBwbHkoZnVuY3Rpb24oKXt2YXIgYSxjPXcoZSl8fFtdLGQ9e30saCxsLHAscixzLHYseTtpZihxKWZvcihsPVtdLHI9MCx2PXoubGVuZ3RoO3I8djtyKyspZm9yKGE9eltyXSxwPTEscz1hLmxlbmd0aDtwPHM7cCsrKXtpZigoaD1hW3BdLmVsZW1lbnQpWzBdLnNlbGVjdGVkKXtoPWgudmFsKCk7biYmKGRbbl09aCk7aWYoeClmb3IoeT0wO3k8Yy5sZW5ndGgmJihkW21dPWNbeV0seChlLGQpIT1oKTt5KyspO2Vsc2UgZFttXT1jW2hdO2wucHVzaCh1KGUsZCkpfX1lbHNlIGlmKGg9Zi52YWwoKSxcIj9cIj09aClsPXQ7ZWxzZSBpZihcIlwiPT09aClsPW51bGw7ZWxzZSBpZih4KWZvcih5PTA7eTxjLmxlbmd0aDt5Kyspe2lmKGRbbV09XG5jW3ldLHgoZSxkKT09aCl7bD11KGUsZCk7YnJlYWt9fWVsc2UgZFttXT1jW2hdLG4mJihkW25dPWgpLGw9dShlLGQpO2cuJHNldFZpZXdWYWx1ZShsKTtrKCl9KX0pO2cuJHJlbmRlcj1rO2UuJHdhdGNoQ29sbGVjdGlvbih3LGspO2UuJHdhdGNoQ29sbGVjdGlvbihmdW5jdGlvbigpe3ZhciBhPXt9LGM9dyhlKTtpZihjKXtmb3IodmFyIGQ9QXJyYXkoYy5sZW5ndGgpLGY9MCxnPWMubGVuZ3RoO2Y8ZztmKyspYVttXT1jW2ZdLGRbZl09bChlLGEpO3JldHVybiBkfX0sayk7cSYmZS4kd2F0Y2hDb2xsZWN0aW9uKGZ1bmN0aW9uKCl7cmV0dXJuIGcuJG1vZGVsVmFsdWV9LGspfWlmKG1bMV0pe3ZhciBwPW1bMF07bT1tWzFdO3ZhciBxPWsubXVsdGlwbGUscz1rLm5nT3B0aW9ucyxGPSExLHUsQT13KFguY3JlYXRlRWxlbWVudChcIm9wdGlvblwiKSksQz13KFguY3JlYXRlRWxlbWVudChcIm9wdGdyb3VwXCIpKSx2PUEuY2xvbmUoKTtrPTA7Zm9yKHZhciB6PWcuY2hpbGRyZW4oKSxFPXoubGVuZ3RoO2s8XG5FO2srKylpZihcIlwiPT09eltrXS52YWx1ZSl7dT1GPXouZXEoayk7YnJlYWt9cC5pbml0KG0sRix2KTtxJiYobS4kaXNFbXB0eT1mdW5jdGlvbihhKXtyZXR1cm4hYXx8MD09PWEubGVuZ3RofSk7cz9uKGUsZyxtKTpxP2woZSxnLG0pOmgoZSxnLG0scCl9fX19XSxpZD1bXCIkaW50ZXJwb2xhdGVcIixmdW5jdGlvbihhKXt2YXIgYz17YWRkT3B0aW9uOkUscmVtb3ZlT3B0aW9uOkV9O3JldHVybntyZXN0cmljdDpcIkVcIixwcmlvcml0eToxMDAsY29tcGlsZTpmdW5jdGlvbihkLGUpe2lmKHgoZS52YWx1ZSkpe3ZhciBmPWEoZC50ZXh0KCksITApO2Z8fGUuJHNldChcInZhbHVlXCIsZC50ZXh0KCkpfXJldHVybiBmdW5jdGlvbihhLGQsZSl7dmFyIGg9ZC5wYXJlbnQoKSxsPWguZGF0YShcIiRzZWxlY3RDb250cm9sbGVyXCIpfHxoLnBhcmVudCgpLmRhdGEoXCIkc2VsZWN0Q29udHJvbGxlclwiKTtsJiZsLmRhdGFib3VuZD9kLnByb3AoXCJzZWxlY3RlZFwiLCExKTpsPWM7Zj9hLiR3YXRjaChmLGZ1bmN0aW9uKGEsXG5jKXtlLiRzZXQoXCJ2YWx1ZVwiLGEpO2EhPT1jJiZsLnJlbW92ZU9wdGlvbihjKTtsLmFkZE9wdGlvbihhKX0pOmwuYWRkT3B0aW9uKGUudmFsdWUpO2Qub24oXCIkZGVzdHJveVwiLGZ1bmN0aW9uKCl7bC5yZW1vdmVPcHRpb24oZS52YWx1ZSl9KX19fX1dLGhkPWJhKHtyZXN0cmljdDpcIkVcIix0ZXJtaW5hbDohMH0pO1cuYW5ndWxhci5ib290c3RyYXA/Y29uc29sZS5sb2coXCJXQVJOSU5HOiBUcmllZCB0byBsb2FkIGFuZ3VsYXIgbW9yZSB0aGFuIG9uY2UuXCIpOigoRWE9Vy5qUXVlcnkpJiZFYS5mbi5vbj8odz1FYSxEKEVhLmZuLHtzY29wZTpMYS5zY29wZSxpc29sYXRlU2NvcGU6TGEuaXNvbGF0ZVNjb3BlLGNvbnRyb2xsZXI6TGEuY29udHJvbGxlcixpbmplY3RvcjpMYS5pbmplY3Rvcixpbmhlcml0ZWREYXRhOkxhLmluaGVyaXRlZERhdGF9KSxHYihcInJlbW92ZVwiLCEwLCEwLCExKSxHYihcImVtcHR5XCIsITEsITEsITEpLEdiKFwiaHRtbFwiLCExLCExLCEwKSk6dz1TLFZhLmVsZW1lbnQ9dyxcbiRjKFZhKSx3KFgpLnJlYWR5KGZ1bmN0aW9uKCl7WGMoWCxmYyl9KSl9KSh3aW5kb3csZG9jdW1lbnQpOyF3aW5kb3cuYW5ndWxhci4kJGNzcCgpJiZ3aW5kb3cuYW5ndWxhci5lbGVtZW50KGRvY3VtZW50KS5maW5kKFwiaGVhZFwiKS5wcmVwZW5kKCc8c3R5bGUgdHlwZT1cInRleHQvY3NzXCI+QGNoYXJzZXQgXCJVVEYtOFwiO1tuZ1xcXFw6Y2xvYWtdLFtuZy1jbG9ha10sW2RhdGEtbmctY2xvYWtdLFt4LW5nLWNsb2FrXSwubmctY2xvYWssLngtbmctY2xvYWssLm5nLWhpZGV7ZGlzcGxheTpub25lICFpbXBvcnRhbnQ7fW5nXFxcXDpmb3Jte2Rpc3BsYXk6YmxvY2s7fS5uZy1hbmltYXRlLWJsb2NrLXRyYW5zaXRpb25ze3RyYW5zaXRpb246MHMgYWxsIWltcG9ydGFudDstd2Via2l0LXRyYW5zaXRpb246MHMgYWxsIWltcG9ydGFudDt9Lm5nLWhpZGUtYWRkLWFjdGl2ZSwubmctaGlkZS1yZW1vdmV7ZGlzcGxheTpibG9jayFpbXBvcnRhbnQ7fTwvc3R5bGU+Jyk7XG4vLyMgc291cmNlTWFwcGluZ1VSTD1hbmd1bGFyLm1pbi5qcy5tYXBcblxuOyBicm93c2VyaWZ5X3NoaW1fX2RlZmluZV9fbW9kdWxlX19leHBvcnRfXyh0eXBlb2YgYW5ndWxhciAhPSBcInVuZGVmaW5lZFwiID8gYW5ndWxhciA6IHdpbmRvdy5hbmd1bGFyKTtcblxufSkuY2FsbChnbG9iYWwsIHVuZGVmaW5lZCwgdW5kZWZpbmVkLCB1bmRlZmluZWQsIHVuZGVmaW5lZCwgZnVuY3Rpb24gZGVmaW5lRXhwb3J0KGV4KSB7IG1vZHVsZS5leHBvcnRzID0gZXg7IH0pO1xuXG59KS5jYWxsKHRoaXMsdHlwZW9mIGdsb2JhbCAhPT0gXCJ1bmRlZmluZWRcIiA/IGdsb2JhbCA6IHR5cGVvZiBzZWxmICE9PSBcInVuZGVmaW5lZFwiID8gc2VsZiA6IHR5cGVvZiB3aW5kb3cgIT09IFwidW5kZWZpbmVkXCIgPyB3aW5kb3cgOiB7fSkiLCIoZnVuY3Rpb24gKGdsb2JhbCl7XG5cbjsgcmVxdWlyZShcImZhbW91cy1wb2x5ZmlsbHNcIik7XG5yZXF1aXJlKFwiL2hvbWUvdWJ1bnR1L3dvcmtzcGFjZS9ib3dlcl9jb21wb25lbnRzL2ZhbW91cy9kaXN0L2ZhbW91cy1nbG9iYWwubWluLmpzXCIpO1xucmVxdWlyZShcIi9ob21lL3VidW50dS93b3Jrc3BhY2UvYm93ZXJfY29tcG9uZW50cy9hbmd1bGFyL2FuZ3VsYXIubWluLmpzXCIpO1xucmVxdWlyZShcIi9ob21lL3VidW50dS93b3Jrc3BhY2UvYm93ZXJfY29tcG9uZW50cy9hbmd1bGFyLWFuaW1hdGUvYW5ndWxhci1hbmltYXRlLm1pbi5qc1wiKTtcbnJlcXVpcmUoXCIvaG9tZS91YnVudHUvd29ya3NwYWNlL2Jvd2VyX2NvbXBvbmVudHMvYW5ndWxhci1zYW5pdGl6ZS9hbmd1bGFyLXNhbml0aXplLm1pbi5qc1wiKTtcbnJlcXVpcmUoXCIvaG9tZS91YnVudHUvd29ya3NwYWNlL2Jvd2VyX2NvbXBvbmVudHMvYW5ndWxhci11aS1yb3V0ZXIvcmVsZWFzZS9hbmd1bGFyLXVpLXJvdXRlci5taW4uanNcIik7XG47X19icm93c2VyaWZ5X3NoaW1fcmVxdWlyZV9fPXJlcXVpcmU7KGZ1bmN0aW9uIGJyb3dzZXJpZnlTaGltKG1vZHVsZSwgZGVmaW5lLCByZXF1aXJlKSB7XG4vKipcbiAqIGZhbW91cy1hbmd1bGFyIC0gQnJpbmcgc3RydWN0dXJlIHRvIHlvdXIgRmFtby51cyBhcHBzIHdpdGggdGhlIHBvd2VyIG9mIEFuZ3VsYXJKUy4gRmFtby51cy9Bbmd1bGFyIGludGVncmF0ZXMgc2VhbWxlc3NseSB3aXRoIGV4aXN0aW5nIEFuZ3VsYXIgYW5kIEZhbW8udXMgYXBwcy5cbiAqIEB2ZXJzaW9uIHYwLjUuMFxuICogQGxpbmsgaHR0cHM6Ly9naXRodWIuY29tL0ZhbW91cy9mYW1vdXMtYW5ndWxhclxuICogQGxpY2Vuc2UgTVBMIHYyLjBcbiAqL1xuXCJ1c2Ugc3RyaWN0XCI7dmFyIG5nRmFtZUFwcD1hbmd1bGFyLm1vZHVsZShcImZhbW91cy5hbmd1bGFyXCIsW10pO25nRmFtZUFwcC5wcm92aWRlcihcIiRmYW1vdXNcIixmdW5jdGlvbigpe3ZhciBlPXtcImZhbW91cy9jb3JlL0NvbnRleHRcIjpmYW1vdXMuY29yZS5Db250ZXh0LFwiZmFtb3VzL2NvcmUvRWxlbWVudEFsbG9jYXRvclwiOmZhbW91cy5jb3JlLkVsZW1lbnRBbGxvY2F0b3IsXCJmYW1vdXMvY29yZS9FbmdpbmVcIjpmYW1vdXMuY29yZS5FbmdpbmUsXCJmYW1vdXMvY29yZS9FbnRpdHlcIjpmYW1vdXMuY29yZS5FbnRpdHksXCJmYW1vdXMvY29yZS9FdmVudEVtaXR0ZXJcIjpmYW1vdXMuY29yZS5FdmVudEVtaXR0ZXIsXCJmYW1vdXMvY29yZS9FdmVudEhhbmRsZXJcIjpmYW1vdXMuY29yZS5FdmVudEhhbmRsZXIsXCJmYW1vdXMvY29yZS9Hcm91cFwiOmZhbW91cy5jb3JlLkdyb3VwLFwiZmFtb3VzL2NvcmUvTW9kaWZpZXJcIjpmYW1vdXMuY29yZS5Nb2RpZmllcixcImZhbW91cy9jb3JlL09wdGlvbnNNYW5hZ2VyXCI6ZmFtb3VzLmNvcmUuT3B0aW9uc01hbmFnZXIsXCJmYW1vdXMvY29yZS9SZW5kZXJOb2RlXCI6ZmFtb3VzLmNvcmUuUmVuZGVyTm9kZSxcImZhbW91cy9jb3JlL1NjZW5lXCI6ZmFtb3VzLmNvcmUuU2NlbmUsXCJmYW1vdXMvY29yZS9TcGVjUGFyc2VyXCI6ZmFtb3VzLmNvcmUuU3BlY1BhcnNlcixcImZhbW91cy9jb3JlL1N1cmZhY2VcIjpmYW1vdXMuY29yZS5TdXJmYWNlLFwiZmFtb3VzL2NvcmUvVHJhbnNmb3JtXCI6ZmFtb3VzLmNvcmUuVHJhbnNmb3JtLFwiZmFtb3VzL2NvcmUvVmlld1wiOmZhbW91cy5jb3JlLlZpZXcsXCJmYW1vdXMvY29yZS9WaWV3U2VxdWVuY2VcIjpmYW1vdXMuY29yZS5WaWV3U2VxdWVuY2UsXCJmYW1vdXMvZXZlbnRzL0V2ZW50QXJiaXRlclwiOmZhbW91cy5ldmVudHMuRXZlbnRBcmJpdGVyLFwiZmFtb3VzL2V2ZW50cy9FdmVudEZpbHRlclwiOmZhbW91cy5ldmVudHMuRXZlbnRGaWx0ZXIsXCJmYW1vdXMvZXZlbnRzL0V2ZW50TWFwcGVyXCI6ZmFtb3VzLmV2ZW50cy5FdmVudE1hcHBlcixcImZhbW91cy9pbnB1dHMvRmFzdENsaWNrXCI6ZmFtb3VzLmlucHV0cy5GYXN0Q2xpY2ssXCJmYW1vdXMvaW5wdXRzL0dlbmVyaWNTeW5jXCI6ZmFtb3VzLmlucHV0cy5HZW5lcmljU3luYyxcImZhbW91cy9pbnB1dHMvTW91c2VTeW5jXCI6ZmFtb3VzLmlucHV0cy5Nb3VzZVN5bmMsXCJmYW1vdXMvaW5wdXRzL1BpbmNoU3luY1wiOmZhbW91cy5pbnB1dHMuUGluY2hTeW5jLFwiZmFtb3VzL2lucHV0cy9Sb3RhdGVTeW5jXCI6ZmFtb3VzLmlucHV0cy5Sb3RhdGVTeW5jLFwiZmFtb3VzL2lucHV0cy9TY2FsZVN5bmNcIjpmYW1vdXMuaW5wdXRzLlNjYWxlU3luYyxcImZhbW91cy9pbnB1dHMvU2Nyb2xsU3luY1wiOmZhbW91cy5pbnB1dHMuU2Nyb2xsU3luYyxcImZhbW91cy9pbnB1dHMvVG91Y2hTeW5jXCI6ZmFtb3VzLmlucHV0cy5Ub3VjaFN5bmMsXCJmYW1vdXMvaW5wdXRzL1RvdWNoVHJhY2tlclwiOmZhbW91cy5pbnB1dHMuVG91Y2hUcmFja2VyLFwiZmFtb3VzL2lucHV0cy9Ud29GaW5nZXJTeW5jXCI6ZmFtb3VzLmlucHV0cy5Ud29GaW5nZXJTeW5jLFwiZmFtb3VzL21hdGgvTWF0cml4XCI6ZmFtb3VzLm1hdGguTWF0cml4LFwiZmFtb3VzL21hdGgvUXVhdGVybmlvblwiOmZhbW91cy5tYXRoLlF1YXRlcm5pb24sXCJmYW1vdXMvbWF0aC9SYW5kb21cIjpmYW1vdXMubWF0aC5SYW5kb20sXCJmYW1vdXMvbWF0aC9VdGlsaXRpZXNcIjpmYW1vdXMubWF0aC5VdGlsaXRpZXMsXCJmYW1vdXMvbWF0aC9WZWN0b3JcIjpmYW1vdXMubWF0aC5WZWN0b3IsXCJmYW1vdXMvbW9kaWZpZXJzL0RyYWdnYWJsZVwiOmZhbW91cy5tb2RpZmllcnMuRHJhZ2dhYmxlLFwiZmFtb3VzL21vZGlmaWVycy9GYWRlclwiOmZhbW91cy5tb2RpZmllcnMuRmFkZXIsXCJmYW1vdXMvbW9kaWZpZXJzL01vZGlmaWVyQ2hhaW5cIjpmYW1vdXMubW9kaWZpZXJzLk1vZGlmaWVyQ2hhaW4sXCJmYW1vdXMvbW9kaWZpZXJzL1N0YXRlTW9kaWZpZXJcIjpmYW1vdXMubW9kaWZpZXJzLlN0YXRlTW9kaWZpZXIsXCJmYW1vdXMvc3VyZmFjZXMvQ2FudmFzU3VyZmFjZVwiOmZhbW91cy5zdXJmYWNlcy5DYW52YXNTdXJmYWNlLFwiZmFtb3VzL3N1cmZhY2VzL0NvbnRhaW5lclN1cmZhY2VcIjpmYW1vdXMuc3VyZmFjZXMuQ29udGFpbmVyU3VyZmFjZSxcImZhbW91cy9zdXJmYWNlcy9Gb3JtQ29udGFpbmVyU3VyZmFjZVwiOmZhbW91cy5zdXJmYWNlcy5Gb3JtQ29udGFpbmVyU3VyZmFjZSxcImZhbW91cy9zdXJmYWNlcy9JbWFnZVN1cmZhY2VcIjpmYW1vdXMuc3VyZmFjZXMuSW1hZ2VTdXJmYWNlLFwiZmFtb3VzL3N1cmZhY2VzL0lucHV0U3VyZmFjZVwiOmZhbW91cy5zdXJmYWNlcy5JbnB1dFN1cmZhY2UsXCJmYW1vdXMvc3VyZmFjZXMvU3VibWl0SW5wdXRTdXJmYWNlXCI6ZmFtb3VzLnN1cmZhY2VzLlN1Ym1pdElucHV0U3VyZmFjZSxcImZhbW91cy9zdXJmYWNlcy9UZXh0YXJlYVN1cmZhY2VcIjpmYW1vdXMuc3VyZmFjZXMuVGV4dGFyZWFTdXJmYWNlLFwiZmFtb3VzL3N1cmZhY2VzL1ZpZGVvU3VyZmFjZVwiOmZhbW91cy5zdXJmYWNlcy5WaWRlb1N1cmZhY2UsXCJmYW1vdXMvdHJhbnNpdGlvbnMvQ2FjaGVkTWFwXCI6ZmFtb3VzLnRyYW5zaXRpb25zLkNhY2hlZE1hcCxcImZhbW91cy90cmFuc2l0aW9ucy9FYXNpbmdcIjpmYW1vdXMudHJhbnNpdGlvbnMuRWFzaW5nLFwiZmFtb3VzL3RyYW5zaXRpb25zL011bHRpcGxlVHJhbnNpdGlvblwiOmZhbW91cy50cmFuc2l0aW9ucy5NdWx0aXBsZVRyYW5zaXRpb24sXCJmYW1vdXMvdHJhbnNpdGlvbnMvU25hcFRyYW5zaXRpb25cIjpmYW1vdXMudHJhbnNpdGlvbnMuU25hcFRyYW5zaXRpb24sXCJmYW1vdXMvdHJhbnNpdGlvbnMvU3ByaW5nVHJhbnNpdGlvblwiOmZhbW91cy50cmFuc2l0aW9ucy5TcHJpbmdUcmFuc2l0aW9uLFwiZmFtb3VzL3RyYW5zaXRpb25zL1RyYW5zaXRpb25hYmxlXCI6ZmFtb3VzLnRyYW5zaXRpb25zLlRyYW5zaXRpb25hYmxlLFwiZmFtb3VzL3RyYW5zaXRpb25zL1RyYW5zaXRpb25hYmxlVHJhbnNmb3JtXCI6ZmFtb3VzLnRyYW5zaXRpb25zLlRyYW5zaXRpb25hYmxlVHJhbnNmb3JtLFwiZmFtb3VzL3RyYW5zaXRpb25zL1R3ZWVuVHJhbnNpdGlvblwiOmZhbW91cy50cmFuc2l0aW9ucy5Ud2VlblRyYW5zaXRpb24sXCJmYW1vdXMvdHJhbnNpdGlvbnMvV2FsbFRyYW5zaXRpb25cIjpmYW1vdXMudHJhbnNpdGlvbnMuV2FsbFRyYW5zaXRpb24sXCJmYW1vdXMvdXRpbGl0aWVzL0tleUNvZGVzXCI6ZmFtb3VzLnV0aWxpdGllcy5LZXlDb2RlcyxcImZhbW91cy91dGlsaXRpZXMvVGltZXJcIjpmYW1vdXMudXRpbGl0aWVzLlRpbWVyLFwiZmFtb3VzL3V0aWxpdGllcy9VdGlsaXR5XCI6ZmFtb3VzLnV0aWxpdGllcy5VdGlsaXR5LFwiZmFtb3VzL3ZpZXdzL0RlY2tcIjpmYW1vdXMudmlld3MuRGVjayxcImZhbW91cy92aWV3cy9FZGdlU3dhcHBlclwiOmZhbW91cy52aWV3cy5FZGdlU3dhcHBlcixcImZhbW91cy92aWV3cy9GbGV4aWJsZUxheW91dFwiOmZhbW91cy52aWV3cy5GbGV4aWJsZUxheW91dCxcImZhbW91cy92aWV3cy9GbGlwcGVyXCI6ZmFtb3VzLnZpZXdzLkZsaXBwZXIsXCJmYW1vdXMvdmlld3MvR3JpZExheW91dFwiOmZhbW91cy52aWV3cy5HcmlkTGF5b3V0LFwiZmFtb3VzL3ZpZXdzL0hlYWRlckZvb3RlckxheW91dFwiOmZhbW91cy52aWV3cy5IZWFkZXJGb290ZXJMYXlvdXQsXCJmYW1vdXMvdmlld3MvTGlnaHRib3hcIjpmYW1vdXMudmlld3MuTGlnaHRib3gsXCJmYW1vdXMvdmlld3MvUmVuZGVyQ29udHJvbGxlclwiOmZhbW91cy52aWV3cy5SZW5kZXJDb250cm9sbGVyLFwiZmFtb3VzL3ZpZXdzL1Njcm9sbENvbnRhaW5lclwiOmZhbW91cy52aWV3cy5TY3JvbGxDb250YWluZXIsXCJmYW1vdXMvdmlld3MvU2Nyb2xsZXJcIjpmYW1vdXMudmlld3MuU2Nyb2xsZXIsXCJmYW1vdXMvdmlld3MvU2Nyb2xsdmlld1wiOmZhbW91cy52aWV3cy5TY3JvbGx2aWV3LFwiZmFtb3VzL3ZpZXdzL1NlcXVlbnRpYWxMYXlvdXRcIjpmYW1vdXMudmlld3MuU2VxdWVudGlhbExheW91dCxcImZhbW91cy93aWRnZXRzL05hdmlnYXRpb25CYXJcIjpmYW1vdXMud2lkZ2V0cy5OYXZpZ2F0aW9uQmFyLFwiZmFtb3VzL3dpZGdldHMvU2xpZGVyXCI6ZmFtb3VzLndpZGdldHMuU2xpZGVyLFwiZmFtb3VzL3dpZGdldHMvVGFiQmFyXCI6ZmFtb3VzLndpZGdldHMuVGFiQmFyLFwiZmFtb3VzL3dpZGdldHMvVG9nZ2xlQnV0dG9uXCI6ZmFtb3VzLndpZGdldHMuVG9nZ2xlQnV0dG9uLFwiZmFtb3VzL3BoeXNpY3MvUGh5c2ljc0VuZ2luZVwiOmZhbW91cy5waHlzaWNzLlBoeXNpY3NFbmdpbmUsXCJmYW1vdXMvcGh5c2ljcy9ib2RpZXMvQm9keVwiOmZhbW91cy5waHlzaWNzLmJvZGllcy5Cb2R5LFwiZmFtb3VzL3BoeXNpY3MvYm9kaWVzL0NpcmNsZVwiOmZhbW91cy5waHlzaWNzLmJvZGllcy5DaXJjbGUsXCJmYW1vdXMvcGh5c2ljcy9ib2RpZXMvUGFydGljbGVcIjpmYW1vdXMucGh5c2ljcy5ib2RpZXMuUGFydGljbGUsXCJmYW1vdXMvcGh5c2ljcy9ib2RpZXMvUmVjdGFuZ2xlXCI6ZmFtb3VzLnBoeXNpY3MuYm9kaWVzLlJlY3RhbmdsZSxcImZhbW91cy9waHlzaWNzL2NvbnN0cmFpbnRzL0NvbGxpc2lvblwiOmZhbW91cy5waHlzaWNzLmNvbnN0cmFpbnRzLkNvbGxpc2lvbixcImZhbW91cy9waHlzaWNzL2NvbnN0cmFpbnRzL0NvbnN0cmFpbnRcIjpmYW1vdXMucGh5c2ljcy5jb25zdHJhaW50cy5Db25zdHJhaW50LFwiZmFtb3VzL3BoeXNpY3MvY29uc3RyYWludHMvQ3VydmVcIjpmYW1vdXMucGh5c2ljcy5jb25zdHJhaW50cy5DdXJ2ZSxcImZhbW91cy9waHlzaWNzL2NvbnN0cmFpbnRzL0Rpc3RhbmNlXCI6ZmFtb3VzLnBoeXNpY3MuY29uc3RyYWludHMuRGlzdGFuY2UsXCJmYW1vdXMvcGh5c2ljcy9jb25zdHJhaW50cy9TbmFwXCI6ZmFtb3VzLnBoeXNpY3MuY29uc3RyYWludHMuU25hcCxcImZhbW91cy9waHlzaWNzL2NvbnN0cmFpbnRzL1N1cmZhY2VcIjpmYW1vdXMucGh5c2ljcy5jb25zdHJhaW50cy5TdXJmYWNlLFwiZmFtb3VzL3BoeXNpY3MvY29uc3RyYWludHMvV2FsbFwiOmZhbW91cy5waHlzaWNzLmNvbnN0cmFpbnRzLldhbGwsXCJmYW1vdXMvcGh5c2ljcy9jb25zdHJhaW50cy9XYWxsc1wiOmZhbW91cy5waHlzaWNzLmNvbnN0cmFpbnRzLldhbGxzLFwiZmFtb3VzL3BoeXNpY3MvZm9yY2VzL0RyYWdcIjpmYW1vdXMucGh5c2ljcy5mb3JjZXMuRHJhZyxcImZhbW91cy9waHlzaWNzL2ZvcmNlcy9Gb3JjZVwiOmZhbW91cy5waHlzaWNzLmZvcmNlcy5Gb3JjZSxcImZhbW91cy9waHlzaWNzL2ZvcmNlcy9SZXB1bHNpb25cIjpmYW1vdXMucGh5c2ljcy5mb3JjZXMuUmVwdWxzaW9uLFwiZmFtb3VzL3BoeXNpY3MvZm9yY2VzL1JvdGF0aW9uYWxEcmFnXCI6ZmFtb3VzLnBoeXNpY3MuZm9yY2VzLlJvdGF0aW9uYWxEcmFnLFwiZmFtb3VzL3BoeXNpY3MvZm9yY2VzL1JvdGF0aW9uYWxTcHJpbmdcIjpmYW1vdXMucGh5c2ljcy5mb3JjZXMuUm90YXRpb25hbFNwcmluZyxcImZhbW91cy9waHlzaWNzL2ZvcmNlcy9TcHJpbmdcIjpmYW1vdXMucGh5c2ljcy5mb3JjZXMuU3ByaW5nLFwiZmFtb3VzL3BoeXNpY3MvZm9yY2VzL1ZlY3RvckZpZWxkXCI6ZmFtb3VzLnBoeXNpY3MuZm9yY2VzLlZlY3RvckZpZWxkLFwiZmFtb3VzL3BoeXNpY3MvaW50ZWdyYXRvcnMvU3ltcGxlY3RpY0V1bGVyXCI6ZmFtb3VzLnBoeXNpY3MuaW50ZWdyYXRvcnMuU3ltcGxlY3RpY0V1bGVyfTt0aGlzLnJlZ2lzdGVyTW9kdWxlPWZ1bmN0aW9uKG4scil7ZVtuXT1yfSxlLmdldElzb2xhdGU9ZnVuY3Rpb24oZSl7cmV0dXJuIGUmJlwiaXNvbGF0ZVwiaW4gZT9lLmlzb2xhdGVbZS4kaWRdOnt9fSxlLmZpbmQ9ZnVuY3Rpb24obil7dmFyIHI9YW5ndWxhci5lbGVtZW50KHdpbmRvdy5kb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKG4pKSxhPWZ1bmN0aW9uKGUpe3ZhciBuPVtdO3JldHVybiBhbmd1bGFyLmZvckVhY2goZSxmdW5jdGlvbihlLHIpe25bcl09YW5ndWxhci5lbGVtZW50KGUpLnNjb3BlKCl9KSxufShyKSxvPWZ1bmN0aW9uKG4pe3ZhciByPVtdO3JldHVybiBhbmd1bGFyLmZvckVhY2gobixmdW5jdGlvbihuLGEpe3JbYV09ZS5nZXRJc29sYXRlKG4pfSkscn0oYSk7cmV0dXJuIG99O3ZhciBuPS8oW1xcOlxcLVxcX10rKC4pKS9nLHI9L15tb3ooW0EtWl0pLyxhPS9eKHhbXFw6XFwtX118ZGF0YVtcXDpcXC1fXSkvaSxvPS9eRkFcXC0uKlNVUkZBQ0UvLHQ9L15GQVxcLS4qLzt3aW5kb3cuJGZhbW91c1V0aWw9ZS51dGlsPXtpc0FTdXJmYWNlOmZ1bmN0aW9uKGUpe3JldHVybiBvLnRlc3QoZVswXS50YWdOYW1lKX0saXNGYUVsZW1lbnQ6ZnVuY3Rpb24oZSl7aWYodC50ZXN0KGVbMF0udGFnTmFtZSkpcmV0dXJuITA7dmFyIG49ITE7cmV0dXJuIGFuZ3VsYXIuZm9yRWFjaChlWzBdLmF0dHJpYnV0ZXMsZnVuY3Rpb24oZSl7bj1ufHx0LnRlc3QoZSl9KSxufSxjYW1lbENhc2U6ZnVuY3Rpb24oZSl7cmV0dXJuIGUucmVwbGFjZShuLGZ1bmN0aW9uKGUsbixyLGEpe3JldHVybiBhP3IudG9VcHBlckNhc2UoKTpyfSkucmVwbGFjZShyLFwiTW96JDFcIil9LGRpcmVjdGl2ZU5vcm1hbGl6ZTpmdW5jdGlvbihuKXtyZXR1cm4gZS51dGlsLmNhbWVsQ2FzZShuLnJlcGxhY2UoYSxcIlwiKSl9fSx0aGlzLiRnZXQ9ZnVuY3Rpb24oKXtyZXR1cm4gZX19KSxhbmd1bGFyLm1vZHVsZShcImZhbW91cy5hbmd1bGFyXCIpLmNvbmZpZyhbXCIkcHJvdmlkZVwiLGZ1bmN0aW9uKGUpe2UuZGVjb3JhdG9yKFwiJGFuaW1hdGVcIixbXCIkZGVsZWdhdGVcIixcIiRyb290U2NvcGVcIixcIiRmYW1vdXNcIixcIiRwYXJzZVwiLFwiJGZhbW91c0RlY29yYXRvclwiLGZ1bmN0aW9uKGUsbixyLGEsbyl7dmFyIHQ9cltcImZhbW91cy91dGlsaXRpZXMvVGltZXJcIl0saT1cIiQkZmFBbmltYXRpb25BY3RpdmVcIixzPXt9LHU9ZnVuY3Rpb24oZSl7dmFyIG49ci5nZXRJc29sYXRlKGUpO3JldHVybiFuJiZlJiYobj1vLiQkZ2V0SXNvbGF0ZUJ5SWQoc1tlLiRpZF0pKSxufSxjPXtlbmFibGVkOmUuZW5hYmxlZH07cmV0dXJuIGFuZ3VsYXIuZm9yRWFjaChbXCJhZGRDbGFzc1wiLFwicmVtb3ZlQ2xhc3NcIl0sZnVuY3Rpb24obil7dmFyIGE9YW5ndWxhci5lbGVtZW50LnByb3RvdHlwZVtuXTthbmd1bGFyLmVsZW1lbnQucHJvdG90eXBlW25dPWZ1bmN0aW9uKGUpe3JldHVybiBhLmFwcGx5KHRoaXMsYXJndW1lbnRzKSxyLnV0aWwuaXNBU3VyZmFjZSh0aGlzKSYmXCJzdHJpbmdcIj09dHlwZW9mIGUmJlwiXCIhPT1lLnRyaW0oKSYmdSh0aGlzLnNjb3BlKCkpLnJlbmRlck5vZGVbbl0oZSksdGhpc30sY1tuXT1mdW5jdGlvbihhLG8sdCl7aWYoZVtuXShhLG8sdCksci51dGlsLmlzRmFFbGVtZW50KGEpKXt2YXIgaT11KGEuc2NvcGUoKSk7aWYoci51dGlsLmlzQVN1cmZhY2UoYSkpe3ZhciBzPWkucmVuZGVyTm9kZTthbmd1bGFyLmZvckVhY2goby5zcGxpdChcIiBcIiksZnVuY3Rpb24oZSl7XCJuZy1oaWRlXCI9PT1lP1wiYWRkQ2xhc3NcIj09PW4/aS5oaWRlKCk6XCJyZW1vdmVDbGFzc1wiPT09biYmaS5zaG93KCk6c1tuXShlKX0pfWVsc2UgYW5ndWxhci5mb3JFYWNoKG8uc3BsaXQoXCIgXCIpLGZ1bmN0aW9uKGUpe1wibmctaGlkZVwiPT09ZSYmKFwiYWRkQ2xhc3NcIj09PW4/aS5oaWRlKCk6XCJyZW1vdmVDbGFzc1wiPT09biYmaS5zaG93KCkpfSl9fX0pLGMuc2V0Q2xhc3M9ZnVuY3Rpb24obixhLG8sdCl7aWYoZS5zZXRDbGFzcyhuLGEsbyx0KSxyLnV0aWwuaXNBU3VyZmFjZShuKSl7dmFyIGk9dShuLnNjb3BlKCkpLnJlbmRlck5vZGU7YW5ndWxhci5mb3JFYWNoKGEuc3BsaXQoXCIgXCIpLGZ1bmN0aW9uKGUpe2kuYWRkQ2xhc3MoZSl9KSxhbmd1bGFyLmZvckVhY2goby5zcGxpdChcIiBcIiksZnVuY3Rpb24oZSl7aS5yZW1vdmVDbGFzcyhlKX0pfX0sYW5ndWxhci5mb3JFYWNoKFtcImVudGVyXCIsXCJsZWF2ZVwiLFwibW92ZVwiXSxmdW5jdGlvbihhKXt2YXIgbz1hWzBdLnRvVXBwZXJDYXNlKCkrYS5zbGljZSgxKTtjW2FdPWZ1bmN0aW9uKGMpe3ZhciBmPXRoaXMsbD1hcmd1bWVudHMsZD1cImVudGVyXCI9PT1hLG09Yy5zY29wZSgpO20mJm0uJHBhcmVudCYmKHNbbS4kaWRdPW0uJHBhcmVudC4kaWQpO3ZhciBwPXUobSk7ZD09PSEwJiZlW2FdLmFwcGx5KHRoaXMsYXJndW1lbnRzKSxjLmRhdGEoaSk9PT0hMCYmcCYmcC4kJGFuaW1hdGVIYWx0SGFuZGxlciYmcC4kJGFuaW1hdGVIYWx0SGFuZGxlcihjLnNjb3BlKCkpLGMuZGF0YShpLCEwKTt2YXIgdj1mdW5jdGlvbigpe20mJm0uJGlkO2lmKFwibGVhdmVcIj09PWEmJnIudXRpbC5pc0ZhRWxlbWVudChjKSl7dmFyIG49dShtKTtuJiZuLmlkJiZuLmhpZGUoKX1jLmRhdGEoaSkhPT0hMSYmKGMuZGF0YShpLCExKSxkPT09ITEmJmVbYV0uYXBwbHkoZixsKSl9O24uJCRwb3N0RGlnZXN0KGZ1bmN0aW9uKCl7dmFyIGUsbj1jLnNjb3BlKCkscj11KG4pO2lmKHImJihlPXJbXCIkJGFuaW1hdGVcIitvK1wiSGFuZGxlclwiXSksdm9pZCAwPT09ZSlyZXR1cm4gdm9pZCB2KCk7dmFyIGE9ZShuLHskZG9uZTp2fSk7XCJudW1iZXJcIj09dHlwZW9mIGEmJnQuc2V0VGltZW91dCh2LGEpfSl9fSksY31dKX1dKSxhbmd1bGFyLm1vZHVsZShcImZhbW91cy5hbmd1bGFyXCIpLmZhY3RvcnkoXCIkZmFtb3VzRGVjb3JhdG9yXCIsW1wiJGZhbW91c1wiLGZ1bmN0aW9uKGUpe3ZhciBuPXtjaGlsZDp7fSxwYXJlbnQ6e30scmVuZGVyYWJsZTpmdW5jdGlvbihuKXt2YXIgcj1lW1wiZmFtb3VzL2NvcmUvUmVuZGVyTm9kZVwiXTtuLnJlbmRlckdhdGU9bmV3IHIsbi5lbXB0eU5vZGU9bmV3IHIsbi5zaG93PWZ1bmN0aW9uKCl7bi5yZW5kZXJHYXRlJiZuLnJlbmRlckdhdGUuc2V0KG4ucmVuZGVyTm9kZSl9LG4uaGlkZT1mdW5jdGlvbigpe24ucmVuZGVyR2F0ZS5zZXQobi5lbXB0eU5vZGUpfX19LHI9e307cmV0dXJue2FkZFJvbGU6ZnVuY3Rpb24oZSxyKXtuW2VdKHIpfSxlbnN1cmVJc29sYXRlOmZ1bmN0aW9uKGUsbil7aWYobil7dmFyIGE9W1wiZmEtZWRnZS1zd2FwcGVyXCIsXCJmYS1yZW5kZXItY29udHJvbGxlclwiLFwiZmEtZGVja1wiLFwiZmEtbGlnaHQtYm94XCJdLG89ITE7YW5ndWxhci5mb3JFYWNoKGEsZnVuY3Rpb24oZSl7cmV0dXJuIGUudG9VcHBlckNhc2UoKT09PW5bMF0udGFnTmFtZT92b2lkKG89ITApOnZvaWQgMCE9PW5bMF0uYXR0cmlidXRlc1tlXT92b2lkKG89ITApOnZvaWQgMH0pLG8mJihlPWUuJHBhcmVudCl9ZS5pc29sYXRlPWUuaXNvbGF0ZXx8e30sZS5pc29sYXRlW2UuJGlkXT1lLmlzb2xhdGVbZS4kaWRdfHx7fTt2YXIgdD1lLmlzb2xhdGVbZS4kaWRdO3QuaWQ9ZS4kaWQ7dmFyIGk9ZS4kZXZhbChcIiRpbmRleFwiKTtyZXR1cm4gaSYmXCIkaW5kZXhcIiE9PWkmJiF0LmluZGV4JiYodC5pbmRleD1pKSxyW3QuaWRdPXQsdH0sJCRnZXRJc29sYXRlQnlJZDpmdW5jdGlvbihlKXtyZXR1cm4gcltlXX0scmVnaXN0ZXJDaGlsZDpmdW5jdGlvbihlLG4scixhKXtlLiRlbWl0KFwicmVnaXN0ZXJDaGlsZFwiLHIpLG4ub25lKFwiJGRlc3Ryb3lcIixmdW5jdGlvbigpe1wicmVtb3ZlTWV0aG9kXCJpbiByJiZyLnJlbW92ZU1ldGhvZChyLmlkKSxyJiZyLmhpZGUmJnIuaGlkZSgpLGEmJmEoKX0pfSxzZXF1ZW5jZVdpdGg6ZnVuY3Rpb24obixyLGEsbyl7bi4kb24oXCJyZWdpc3RlckNoaWxkXCIsZnVuY3Rpb24odCxpKXtpZih0LnRhcmdldFNjb3BlLiRpZCE9PW4uJGlkKXt2YXIgcz1lLmdldElzb2xhdGUobik7aS4kcGFyZW50PXMscy4kY2hpbGRyZW49cy4kY2hpbGRyZW58fFtdLHMuJGNoaWxkcmVuLnB1c2goaSkscihpKSx0LnN0b3BQcm9wYWdhdGlvbigpLGEmJihpLnJlbW92ZU1ldGhvZD1hKSxvJiYoaS51cGRhdGVNZXRob2Q9byl9fSl9fX1dKSxhbmd1bGFyLm1vZHVsZShcImZhbW91cy5hbmd1bGFyXCIpLnNlcnZpY2UoXCIkZmFtb3VzUGlwZVwiLGZ1bmN0aW9uKCl7ZnVuY3Rpb24gZShlLG4scil7ZSBpbnN0YW5jZW9mIEFycmF5fHwoZT1bZV0pLG4gaW5zdGFuY2VvZiBBcnJheXx8KG49W25dKTtmb3IodmFyIGE9MDthPGUubGVuZ3RoO2ErKylmb3IodmFyIG89MDtvPG4ubGVuZ3RoO28rKyl2b2lkIDAhPT1uW29dJiZ2b2lkIDAhPT1lW2FdJiZuW29dW3JdKGVbYV0pfXRoaXMudW5waXBlc0Zyb21UYXJnZXRzPWZ1bmN0aW9uKG4scil7ZShuLHIsXCJ1bnBpcGVcIil9LHRoaXMucGlwZXNUb1RhcmdldHM9ZnVuY3Rpb24obixyKXtlKG4scixcInBpcGVcIil9fSksYW5ndWxhci5tb2R1bGUoXCJmYW1vdXMuYW5ndWxhclwiKS5mYWN0b3J5KFwiJHRpbWVsaW5lXCIsZnVuY3Rpb24oKXt2YXIgZT1mdW5jdGlvbihlLG4pe3JldHVyblwibnVtYmVyXCI9PXR5cGVvZiBlP2UrbjplLm1hcChmdW5jdGlvbihlLHIpe3JldHVybiBlK25bcl19KX0sbj1mdW5jdGlvbihlLG4pe3JldHVyblwibnVtYmVyXCI9PXR5cGVvZiBlP2UtbjplLm1hcChmdW5jdGlvbihlLHIpe3JldHVybiBlLW5bcl19KX0scj1mdW5jdGlvbihlLG4pe3JldHVyblwibnVtYmVyXCI9PXR5cGVvZiBlP2UqbjplLm1hcChmdW5jdGlvbihlKXtyZXR1cm4gZSpufSl9LGE9ZnVuY3Rpb24oYSxvLHQsaSxzKXtyZXR1cm4gZnVuY3Rpb24odSl7dmFyIGM9aSxmPS1vLGw9MS8odC1vKSxkPW4ocyxpKTtyZXR1cm4gZShyKGQsYShsKih1K2YpKSksYyl9fTtyZXR1cm4gZnVuY3Rpb24oZSl7dmFyIG49ZnVuY3Rpb24oZSl7cmV0dXJuIGV9O3JldHVybiBmdW5jdGlvbihyKXtpZihyPGVbMF1bMF0pcmV0dXJuIGVbMF1bMV07Zm9yKHZhciBvPTA7bzxlLmxlbmd0aC0xO28rKylpZihlW29dWzBdPD1yJiZyPGVbbysxXVswXSl7dmFyIHQ9YShlW29dWzJdfHxuLGVbb11bMF0sZVtvKzFdWzBdLGVbb11bMV0sZVtvKzFdWzFdKTtyZXR1cm4gdChyKX1yZXR1cm4gZVtlLmxlbmd0aC0xXVsxXX19fSksYW5ndWxhci5tb2R1bGUoXCJmYW1vdXMuYW5ndWxhclwiKS5kaXJlY3RpdmUoXCJmYUFuaW1hdGVFbnRlclwiLFtcIiRwYXJzZVwiLFwiJGZhbW91c0RlY29yYXRvclwiLGZ1bmN0aW9uKGUsbil7cmV0dXJue3Jlc3RyaWN0OlwiQVwiLHNjb3BlOiExLHByaW9yaXR5OjE2LGNvbXBpbGU6ZnVuY3Rpb24oKXtyZXR1cm57cG9zdDpmdW5jdGlvbihyLGEsbyl7dmFyIHQ9bi5lbnN1cmVJc29sYXRlKHIpO3QuJCRhbmltYXRlRW50ZXJIYW5kbGVyPWUoby5mYUFuaW1hdGVFbnRlciksby4kb2JzZXJ2ZShcImZhQW5pbWF0ZUVudGVyXCIsZnVuY3Rpb24oKXt0LiQkYW5pbWF0ZUVudGVySGFuZGxlcj1lKG8uZmFBbmltYXRlRW50ZXIpfSl9fX19fV0pLGFuZ3VsYXIubW9kdWxlKFwiZmFtb3VzLmFuZ3VsYXJcIikuZGlyZWN0aXZlKFwiZmFBbmltYXRlSGFsdFwiLFtcIiRwYXJzZVwiLFwiJGZhbW91c0RlY29yYXRvclwiLGZ1bmN0aW9uKGUsbil7cmV0dXJue3Jlc3RyaWN0OlwiQVwiLHNjb3BlOiExLHByaW9yaXR5OjE2LGNvbXBpbGU6ZnVuY3Rpb24oKXtyZXR1cm57cG9zdDpmdW5jdGlvbihyLGEsbyl7dmFyIHQ9bi5lbnN1cmVJc29sYXRlKHIpO3QuJCRhbmltYXRlSGFsdEhhbmRsZXI9ZShvLmZhQW5pbWF0ZUhhbHQpLG8uJG9ic2VydmUoXCJmYUFuaW1hdGVIYWx0XCIsZnVuY3Rpb24oKXt0LiQkYW5pbWF0ZUhhbHRIYW5kbGVyPWUoby5mYUFuaW1hdGVIYWx0KX0pfX19fX1dKSxhbmd1bGFyLm1vZHVsZShcImZhbW91cy5hbmd1bGFyXCIpLmRpcmVjdGl2ZShcImZhQW5pbWF0ZUxlYXZlXCIsW1wiJHBhcnNlXCIsXCIkZmFtb3VzRGVjb3JhdG9yXCIsZnVuY3Rpb24oZSxuKXtyZXR1cm57cmVzdHJpY3Q6XCJBXCIsc2NvcGU6ITEscHJpb3JpdHk6MTYsY29tcGlsZTpmdW5jdGlvbigpe3JldHVybntwb3N0OmZ1bmN0aW9uKHIsYSxvKXt2YXIgdD1uLmVuc3VyZUlzb2xhdGUocik7dC4kJGFuaW1hdGVMZWF2ZUhhbmRsZXI9ZShvLmZhQW5pbWF0ZUxlYXZlKSxvLiRvYnNlcnZlKFwiZmFBbmltYXRlTGVhdmVcIixmdW5jdGlvbigpe3QuJCRhbmltYXRlTGVhdmVIYW5kbGVyPWUoby5mYUFuaW1hdGVMZWF2ZSl9KX19fX19XSksYW5ndWxhci5tb2R1bGUoXCJmYW1vdXMuYW5ndWxhclwiKS5kaXJlY3RpdmUoXCJmYUFuaW1hdGVNb3ZlXCIsW1wiJHBhcnNlXCIsXCIkZmFtb3VzRGVjb3JhdG9yXCIsZnVuY3Rpb24oZSxuKXtyZXR1cm57cmVzdHJpY3Q6XCJBXCIsc2NvcGU6ITEscHJpb3JpdHk6MTYsY29tcGlsZTpmdW5jdGlvbigpe3JldHVybntwb3N0OmZ1bmN0aW9uKHIsYSxvKXt2YXIgdD1uLmVuc3VyZUlzb2xhdGUocik7dC4kJGFuaW1hdGVNb3ZlSGFuZGxlcj1lKG8uZmFBbmltYXRlTW92ZSksby4kb2JzZXJ2ZShcImZhQW5pbWF0ZU1vdmVcIixmdW5jdGlvbigpe3QuJCRhbmltYXRlTW92ZUhhbmRsZXI9ZShvLmZhQW5pbWF0ZU1vdmUpfSl9fX19fV0pLGFuZ3VsYXIubW9kdWxlKFwiZmFtb3VzLmFuZ3VsYXJcIikuZGlyZWN0aXZlKFwiZmFBbmltYXRpb25cIixbXCIkZmFtb3VzXCIsXCIkZmFtb3VzRGVjb3JhdG9yXCIsZnVuY3Rpb24oZSxuKXtyZXR1cm57cmVzdHJpY3Q6XCJFQVwiLHNjb3BlOiEwLGNvbXBpbGU6ZnVuY3Rpb24oKXt2YXIgcj1lW1wiZmFtb3VzL2NvcmUvVHJhbnNmb3JtXCJdLGE9ZVtcImZhbW91cy90cmFuc2l0aW9ucy9UcmFuc2l0aW9uYWJsZVwiXSxvPWVbXCJmYW1vdXMvdHJhbnNpdGlvbnMvRWFzaW5nXCJdO3JldHVybntwcmU6ZnVuY3Rpb24oZSl7bi5lbnN1cmVJc29sYXRlKGUpfSxwb3N0OmZ1bmN0aW9uKGUsdCxpKXt2YXIgcz1uLmVuc3VyZUlzb2xhdGUoZSk7c2V0VGltZW91dChmdW5jdGlvbigpe3MudGltZWxpbmU9ZS4kZXZhbChpLnRpbWVsaW5lKSxzLl90cmFucz1uZXcgYSgwKSxzLnBsYXk9ZnVuY3Rpb24obil7dmFyIHI9e2R1cmF0aW9uOmUuJGV2YWwoaS5kdXJhdGlvbiksY3VydmU6ZS4kZXZhbChpLmN1cnZlKXx8XCJsaW5lYXJcIn07cy5fdHJhbnMuc2V0KDEscixmdW5jdGlvbigpe24mJm4oKSxpLmxvb3AmJnNldFRpbWVvdXQoZnVuY3Rpb24oKXtzLnJlcGxheShuKX0sMCl9KX0scy5yZXNldD1mdW5jdGlvbigpe3MuX3RyYW5zLnNldCgwKX0scy5yZXBsYXk9ZnVuY3Rpb24oZSl7cy5yZXNldCgpLHMucGxheShlKX07dmFyIG49bnVsbDtpLmV2ZW50JiYobiYmbigpLG49ZS4kb24oaS5ldmVudCxmdW5jdGlvbihlLG4pe3ZhciByPW4mJm4uY2FsbGJhY2s/bi5jYWxsYmFjazp2b2lkIDA7cy5yZXBsYXkocil9KSk7aS5pZDtpZih2b2lkIDA9PT1zLnRpbWVsaW5lJiYocy50aW1lbGluZT1zLl90cmFucy5nZXQuYmluZChzLl90cmFucyksaS5hdXRvcGxheSYmcy5wbGF5KCkpLCFzLnRpbWVsaW5lIGluc3RhbmNlb2YgRnVuY3Rpb24pdGhyb3cgbmV3IEVycm9yKFwidGltZWxpbmUgbXVzdCBiZSBhIHJlZmVyZW5jZSB0byBhIGZ1bmN0aW9uIG9yIGR1cmF0aW9uIG11c3QgYmUgcHJvdmlkZWRcIik7Zm9yKHZhciB1PXRbMF0ucXVlcnlTZWxlY3RvckFsbChcImFuaW1hdGVcIiksYz17fSxmPTA7Zjx1Lmxlbmd0aDtmKyspIWZ1bmN0aW9uKCl7dmFyIG49dVtmXTtpZihuLmF0dHJpYnV0ZXMudGFyZ2V0bW9kc2VsZWN0b3Ipe3ZhciBhPWFuZ3VsYXIuZWxlbWVudCh0WzBdLnBhcmVudE5vZGUpWzBdLnF1ZXJ5U2VsZWN0b3JBbGwobi5hdHRyaWJ1dGVzLnRhcmdldG1vZHNlbGVjdG9yLnZhbHVlKTthbmd1bGFyLmZvckVhY2goYSxmdW5jdGlvbihhKXt2YXIgdD1hbmd1bGFyLmVsZW1lbnQoYSkuc2NvcGUoKSxpPXQuaXNvbGF0ZVt0LiRpZF0ubW9kaWZpZXIsdT10Lmlzb2xhdGVbdC4kaWRdLmdldFRyYW5zZm9ybSxmPW4uYXR0cmlidXRlcy5jdXJ2ZSYmXCJsaW5lYXJcIiE9PW4uYXR0cmlidXRlcy5jdXJ2ZS52YWx1ZT9vW24uYXR0cmlidXRlcy5jdXJ2ZS52YWx1ZV06ZnVuY3Rpb24oZSl7cmV0dXJuIGV9O2lmKG4uYXR0cmlidXRlcy5maWVsZCl7dmFyIGw9bi5hdHRyaWJ1dGVzLmZpZWxkLnZhbHVlLGQ9bi5hdHRyaWJ1dGVzLnRpbWVsaW5lbG93ZXJib3VuZD9wYXJzZUZsb2F0KG4uYXR0cmlidXRlcy50aW1lbGluZWxvd2VyYm91bmQudmFsdWUpOjAsbT1uLmF0dHJpYnV0ZXMudGltZWxpbmV1cHBlcmJvdW5kP3BhcnNlRmxvYXQobi5hdHRyaWJ1dGVzLnRpbWVsaW5ldXBwZXJib3VuZC52YWx1ZSk6MTtpZighbi5hdHRyaWJ1dGVzLnN0YXJ0dmFsdWUpdGhyb3cgbmV3IEVycm9yKFwieW91IG11c3QgcHJvdmlkZSBhIHN0YXJ0IHZhbHVlIGZvciB0aGUgYW5pbWF0aW9uXCIpO3ZhciBwPWUuJGV2YWwobi5hdHRyaWJ1dGVzLnN0YXJ0dmFsdWUudmFsdWUpO2lmKCFuLmF0dHJpYnV0ZXMuZW5kdmFsdWUpdGhyb3cgbmV3IEVycm9yKFwieW91IG11c3QgcHJvdmlkZSBhbiBlbmQgdmFsdWUgZm9yIHRoZSBhbmltYXRpb25cIik7dmFyIHY9ZS4kZXZhbChuLmF0dHJpYnV0ZXMuZW5kVmFsdWUudmFsdWUpLGc9Y1t0LiRpZF09Y1t0LiRpZF18fHt9LGg9Z1tsXT1nW2xdfHxbXTtoLnB1c2goe2ZpZWxkOmwsbG93ZXJCb3VuZDpkLHVwcGVyQm91bmQ6bSxzdGFydFZhbHVlOnAsZW5kVmFsdWU6dixjdXJ2ZTpmfSksaC5zb3J0KGZ1bmN0aW9uKGUsbil7cmV0dXJuIGUubG93ZXJCb3VuZC1uLmxvd2VyQm91bmR9KTtmb3IodmFyICQ9MTskPGgubGVuZ3RoOyQrKylmb3IodmFyIHk9aFskXS5sb3dlckJvdW5kLHc9MDskPnc7dysrKWlmKHk8aFt3XS51cHBlckJvdW5kKXRocm93IG5ldyBFcnJvcihcIkFuaW1hdGUgc2VnbWVudHMgaGF2ZSBvdmVybGFwcGluZ2RvbWFpbnMgZm9yIHRoZSBzYW1lIGZpZWxkIChcIitsK1wiKS5BdCBhbnkgcG9pbnQgaW4gdGhlIHRpbWVsaW5lLCBvbmx5IG9uZSA8YW5pbWF0ZT5jYW4gYWZmZWN0IGEgZ2l2ZW4gZmllbGQgb24gdGhlIHNhbWUgbW9kaWZpZXIuXCIpO3ZhciBTPWZ1bmN0aW9uKCl7Zm9yKHZhciBlPXMudGltZWxpbmUoKXx8MCxuPTAscj1oW25dLGE9MDthPGgubGVuZ3RoO2ErKyl7aWYoZT49aFthXS5sb3dlckJvdW5kJiZlPD1oW2FdLnVwcGVyQm91bmQpe3I9aFthXTticmVha31pZihhPT09aC5sZW5ndGgtMSl7cj1oW2FdO2JyZWFrfWlmKGU+PWhbYV0udXBwZXJCb3VuZCYmZTxoW2ErMV0ubG93ZXJCb3VuZCl7cj1oW2FdO2JyZWFrfX1pZihlPD1yLmxvd2VyQm91bmQpcmV0dXJuIHIuc3RhcnRWYWx1ZTtpZihlPj1yLnVwcGVyQm91bmQpcmV0dXJuIHIuZW5kVmFsdWU7dmFyIG89ci51cHBlckJvdW5kLXIubG93ZXJCb3VuZCx0PShlLXIubG93ZXJCb3VuZCkvbztpZihBcnJheS5pc0FycmF5KHIuc3RhcnRWYWx1ZSkpe2Zvcih2YXIgaT1bXSx1PTA7dTxyLnN0YXJ0VmFsdWUubGVuZ3RoO3UrKylpLnB1c2goci5zdGFydFZhbHVlW3VdK3IuY3VydmUodCkqKHIuZW5kVmFsdWVbdV0tci5zdGFydFZhbHVlW3VdKSk7cmV0dXJuIGl9cmV0dXJuIHIuc3RhcnRWYWx1ZStyLmN1cnZlKHQpKihyLmVuZFZhbHVlLXIuc3RhcnRWYWx1ZSl9LGI9Zy50cmFuc2Zvcm1Db21wb25lbnRzPWcudHJhbnNmb3JtQ29tcG9uZW50c3x8W107XCJvcGFjaXR5XCI9PT1sP2kub3BhY2l0eUZyb20oZnVuY3Rpb24oKXtyZXR1cm4gUygpfSk6XCJvcmlnaW5cIj09PWw/aS5vcmlnaW5Gcm9tKGZ1bmN0aW9uKCl7cmV0dXJuIFMoKX0pOlwic2l6ZVwiPT09bD9pLnNpemVGcm9tKGZ1bmN0aW9uKCl7cmV0dXJuIFMoKX0pOihiLnB1c2goe2ZpZWxkOmwsZm46U30pLGkudHJhbnNmb3JtRnJvbShmdW5jdGlvbigpe2Zvcih2YXIgZT17fSxuPXUmJnUoKT9bdSgpXTpbXSxhPTA7YTxiLmxlbmd0aDthKyspIWZ1bmN0aW9uKCl7dmFyIG89YlthXS5maWVsZDtpZighZVtvXSl7dmFyIHQ9YlthXS5mbigpO24ucHVzaChBcnJheS5pc0FycmF5KHQpP3Jbb10uYXBwbHkodGhpcyx0KTpyW29dKHQpKSxlW29dPSEwfX0oKTtyZXR1cm4gMT09PW4ubGVuZ3RoP25bMF06ci5tdWx0aXBseS5hcHBseSh0aGlzLG4pfSkpfX0pfX0oKX0sMSl9fX19fV0pLGFuZ3VsYXIubW9kdWxlKFwiZmFtb3VzLmFuZ3VsYXJcIikuZGlyZWN0aXZlKFwiZmFBcHBcIixbXCIkZmFtb3VzXCIsXCIkZmFtb3VzRGVjb3JhdG9yXCIsZnVuY3Rpb24oZSxuKXtyZXR1cm57dGVtcGxhdGU6JzxkaXYgc3R5bGU9XCJkaXNwbGF5OiBub25lO1wiPjxkaXY+PC9kaXY+PC9kaXY+Jyx0cmFuc2NsdWRlOiEwLHNjb3BlOiEwLHJlc3RyaWN0OlwiRUFcIixjb21waWxlOmZ1bmN0aW9uKHIsYSxvKXtyZXR1cm57cHJlOmZ1bmN0aW9uKHIsYSxvKXtmdW5jdGlvbiB0KCl7cy5hcHBseSh0aGlzLGFyZ3VtZW50cyl9e3ZhciBpPW4uZW5zdXJlSXNvbGF0ZShyKSxzPWVbXCJmYW1vdXMvY29yZS9WaWV3XCJdLHU9ZVtcImZhbW91cy9jb3JlL0VuZ2luZVwiXTtlW1wiZmFtb3VzL2NvcmUvVHJhbnNmb3JtXCJdfWEuYXBwZW5kKCc8ZGl2IGNsYXNzPVwiZmFtb3VzLWFuZ3VsYXItY2xpcHBpbmctY29udGFpbmVyXCI+PGRpdiBjbGFzcz1cImZhbW91cy1hbmd1bGFyLWNvbnRhaW5lclwiPjwvZGl2PjwvZGl2PicpLGkuY29udGV4dD11LmNyZWF0ZUNvbnRleHQoYVswXS5xdWVyeVNlbGVjdG9yKFwiLmZhbW91cy1hbmd1bGFyLWNvbnRhaW5lclwiKSksd2luZG93LmNvbnRleHQ9aS5jb250ZXh0O3ZhciBjPWZ1bmN0aW9uKCl7dmFyIGU9cGFyc2VJbnQoby5mYVBlcnNwZWN0aXZlKTtlJiZpLmNvbnRleHQuc2V0UGVyc3BlY3RpdmUoZSl9O28uJG9ic2VydmUoXCJmYVBlcnNwZWN0aXZlXCIsYyksYygpLHQucHJvdG90eXBlPU9iamVjdC5jcmVhdGUocy5wcm90b3R5cGUpLHQucHJvdG90eXBlLmNvbnN0cnVjdG9yPXQ7aS52aWV3PW5ldyB0LGkuY29udGV4dC5hZGQoaS52aWV3KSxyLiRvbihcIiRkZXN0cm95XCIsZnVuY3Rpb24oKXtpLmNvbnRleHQudXBkYXRlPWFuZ3VsYXIubm9vcH0pLHIuJG9uKFwicmVnaXN0ZXJDaGlsZFwiLGZ1bmN0aW9uKGUsbil7aS52aWV3LmFkZChuLnJlbmRlck5vZGUpLGUuc3RvcFByb3BhZ2F0aW9uKCl9KX0scG9zdDpmdW5jdGlvbihlLHIpe3ZhciBhPW4uZW5zdXJlSXNvbGF0ZShlKTtvKGUsZnVuY3Rpb24oZSl7YW5ndWxhci5lbGVtZW50KHJbMF0ucXVlcnlTZWxlY3RvckFsbChcImRpdiBkaXZcIilbMF0pLmFwcGVuZChlKX0pLGEucmVhZHlUb1JlbmRlcj0hMH19fX19XSksYW5ndWxhci5tb2R1bGUoXCJmYW1vdXMuYW5ndWxhclwiKS5kaXJlY3RpdmUoXCJmYUNhbnZhc1N1cmZhY2VcIixbXCIkZmFtb3VzXCIsXCIkZmFtb3VzRGVjb3JhdG9yXCIsXCIkaW50ZXJwb2xhdGVcIixcIiRjb250cm9sbGVyXCIsXCIkY29tcGlsZVwiLGZ1bmN0aW9uKGUsbil7cmV0dXJue3Njb3BlOiEwLHRyYW5zY2x1ZGU6ITAsdGVtcGxhdGU6JzxjYW52YXMgY2xhc3M9XCJmYS1jYW52YXMtc3VyZmFjZVwiPjwvY2FudmFzPicscmVzdHJpY3Q6XCJFQVwiLGNvbXBpbGU6ZnVuY3Rpb24ocixhLG8pe3JldHVybntwcmU6ZnVuY3Rpb24ocixhLG8pe3t2YXIgdD1uLmVuc3VyZUlzb2xhdGUociksaT1lW1wiZmFtb3VzL3N1cmZhY2VzL0NhbnZhc1N1cmZhY2VcIl07ZVtcImZhbW91cy9jb3JlL1RyYW5zZm9ybVwiXSxlW1wiZmFtb3VzL2NvcmUvRXZlbnRIYW5kbGVyXCJdfXQucmVuZGVyTm9kZT1uZXcgaSh7c2l6ZTpyLiRldmFsKG8uZmFTaXplKX0pLG4uYWRkUm9sZShcInJlbmRlcmFibGVcIix0KSx0LnNob3coKSxvLmNsYXNzJiZ0LnJlbmRlck5vZGUuc2V0Q2xhc3NlcyhvW1wiY2xhc3NcIl0uc3BsaXQoXCIgXCIpKSxuLnNlcXVlbmNlV2l0aChyLGZ1bmN0aW9uKCl7dGhyb3cgbmV3IEVycm9yKFwiU3VyZmFjZXMgYXJlIGxlYWYgbm9kZXMgb2YgdGhlIEZhbW8udXMgcmVuZGVyIHRyZWUgYW5kIGNhbm5vdCBhY2NlcHQgcmVuZGVybm9kZSBjaGlsZHJlbi4gIFRvIGluY2x1ZGUgYWRkaXRpb25hbCBGYW1vLnVzIGNvbnRlbnQgaW5zaWRlIG9mIGEgZmEtc3VyZmFjZSwgdGhhdCBjb250ZW50IG11c3QgYmUgZW5jbG9zZWQgaW4gYW4gYWRkaXRpb25hbCBmYS1hcHAuXCIpfSl9LHBvc3Q6ZnVuY3Rpb24oZSxyKXt2YXIgYT1uLmVuc3VyZUlzb2xhdGUoZSksdD1mdW5jdGlvbigpe2EucmVuZGVyTm9kZS5zZXRDb250ZW50KHJbMF0ucXVlcnlTZWxlY3RvcihcImNhbnZhcy5mYS1jYW52YXMtc3VyZmFjZVwiKSl9O3QoKSxvKGUsZnVuY3Rpb24oZSl7YW5ndWxhci5lbGVtZW50KHJbMF0ucXVlcnlTZWxlY3RvckFsbChcImNhbnZhcy5mYS1jYW52YXMtc3VyZmFjZVwiKSkuYXBwZW5kKGUpfSksbi5yZWdpc3RlckNoaWxkKGUscixhLGZ1bmN0aW9uKCl7fSl9fX19fV0pLGFuZ3VsYXIubW9kdWxlKFwiZmFtb3VzLmFuZ3VsYXJcIikuZGlyZWN0aXZlKFwiZmFDbGlja1wiLFtcIiRwYXJzZVwiLFwiJGZhbW91c0RlY29yYXRvclwiLGZ1bmN0aW9uKGUsbil7cmV0dXJue3Jlc3RyaWN0OlwiQVwiLGNvbXBpbGU6ZnVuY3Rpb24oKXtyZXR1cm57cG9zdDpmdW5jdGlvbihyLGEsbyl7dmFyIHQ9bi5lbnN1cmVJc29sYXRlKHIpO2lmKG8uZmFDbGljayl7dmFyIGk9dC5yZW5kZXJOb2RlLl9ldmVudElucHV0fHx0LnJlbmRlck5vZGU7aS5vbihcImNsaWNrXCIsZnVuY3Rpb24obil7dmFyIGE9ZShvLmZhQ2xpY2spO2Eocix7JGV2ZW50Om59KSxyLiQkcGhhc2V8fHIuJGFwcGx5KCl9KX19fX19fV0pLGFuZ3VsYXIubW9kdWxlKFwiZmFtb3VzLmFuZ3VsYXJcIikuZGlyZWN0aXZlKFwiZmFDb250YWluZXJTdXJmYWNlXCIsW1wiJGZhbW91c1wiLFwiJGZhbW91c0RlY29yYXRvclwiLGZ1bmN0aW9uKGUsbil7cmV0dXJue3RlbXBsYXRlOlwiPGRpdj48L2Rpdj5cIixyZXN0cmljdDpcIkVcIix0cmFuc2NsdWRlOiEwLHNjb3BlOiEwLGNvbXBpbGU6ZnVuY3Rpb24ocixhLG8pe3JldHVybntwcmU6ZnVuY3Rpb24ocixhLG8pe3ZhciB0PW4uZW5zdXJlSXNvbGF0ZShyKSxpPWVbXCJmYW1vdXMvc3VyZmFjZXMvQ29udGFpbmVyU3VyZmFjZVwiXSxzPXIuJGV2YWwoby5mYU9wdGlvbnMpfHx7fTt0LnJlbmRlck5vZGU9bmV3IGkocyksbi5hZGRSb2xlKFwicmVuZGVyYWJsZVwiLHQpLHQuc2hvdygpLG4uc2VxdWVuY2VXaXRoKHIsZnVuY3Rpb24oZSl7dC5yZW5kZXJOb2RlLmFkZChlLnJlbmRlckdhdGUpfSl9LHBvc3Q6ZnVuY3Rpb24oZSxyKXt2YXIgYT1uLmVuc3VyZUlzb2xhdGUoZSk7byhlLGZ1bmN0aW9uKGUpe3IuZmluZChcImRpdlwiKS5hcHBlbmQoZSl9KSxuLnJlZ2lzdGVyQ2hpbGQoZSxyLGEpfX19fX1dKSxhbmd1bGFyLm1vZHVsZShcImZhbW91cy5hbmd1bGFyXCIpLmRpcmVjdGl2ZShcImZhRHJhZ2dhYmxlXCIsW1wiJGZhbW91c1wiLFwiJGZhbW91c0RlY29yYXRvclwiLFwiJHBhcnNlXCIsXCIkcm9vdFNjb3BlXCIsZnVuY3Rpb24oZSxuLHIsYSl7cmV0dXJue3RlbXBsYXRlOlwiPGRpdj48L2Rpdj5cIix0cmFuc2NsdWRlOiEwLHJlc3RyaWN0OlwiRUFcIixwcmlvcml0eToyLHNjb3BlOiEwLGNvbXBpbGU6ZnVuY3Rpb24ocixvLHQpe3JldHVybntwb3N0OmZ1bmN0aW9uKHIsbyxpKXt2YXIgcz1uLmVuc3VyZUlzb2xhdGUociksdT1lW1wiZmFtb3VzL2NvcmUvUmVuZGVyTm9kZVwiXSxjPWVbXCJmYW1vdXMvbW9kaWZpZXJzL0RyYWdnYWJsZVwiXSxmPXIuJGV2YWwoaS5mYU9wdGlvbnMpfHx7fTtyLiR3YXRjaChmdW5jdGlvbigpe3JldHVybiByLiRldmFsKGkuZmFPcHRpb25zKX0sZnVuY3Rpb24oZSl7ZT1lfHx7fSxzLm1vZGlmaWVyLnNldE9wdGlvbnMoZSl9LCEwKSxzLm1vZGlmaWVyPW5ldyBjKGYpLHMucmVuZGVyTm9kZT0obmV3IHUpLmFkZChzLm1vZGlmaWVyKSxuLmFkZFJvbGUoXCJyZW5kZXJhYmxlXCIscykscy5zaG93KCksbi5zZXF1ZW5jZVdpdGgocixmdW5jdGlvbihlKXtzLnJlbmRlck5vZGUuYWRkKGUucmVuZGVyR2F0ZSl9KSx0KHIsZnVuY3Rpb24oZSl7by5maW5kKFwiZGl2XCIpLmFwcGVuZChlKX0pLG4ucmVnaXN0ZXJDaGlsZChyLG8scyxmdW5jdGlvbigpe3MubW9kaWZpZXIuZGVhY3RpdmF0ZSgpfSksci4kJHBoYXNlfHxhLiQkcGhhc2V8fHIuJGFwcGx5KCl9fX19fV0pLGFuZ3VsYXIubW9kdWxlKFwiZmFtb3VzLmFuZ3VsYXJcIikuZGlyZWN0aXZlKFwiZmFFZGdlU3dhcHBlclwiLFtcIiRmYW1vdXNcIixcIiRmYW1vdXNEZWNvcmF0b3JcIixmdW5jdGlvbihlLG4pe3JldHVybntzY29wZTohMCxyZXN0cmljdDpcIkFcIixwcmlvcml0eTo1MTIsY29tcGlsZTpmdW5jdGlvbigpe3ZhciByPWVbXCJmYW1vdXMvdmlld3MvRWRnZVN3YXBwZXJcIl07cmV0dXJue3ByZTpmdW5jdGlvbihlLGEsbyl7dmFyIHQsaT1uLmVuc3VyZUlzb2xhdGUoZSk7aS4kJGFuaW1hdGVFbnRlckhhbmRsZXI9ZnVuY3Rpb24oZSxuKXtpLnJlbmRlck5vZGUuc2hvdyh0LGZ1bmN0aW9uKCl7aS4kJGxlYXZlRG9uZUNhbGxiYWNrJiZpLiQkbGVhdmVEb25lQ2FsbGJhY2soKSxuLiRkb25lKCl9KX0saS4kJGFuaW1hdGVMZWF2ZUhhbmRsZXI9ZnVuY3Rpb24oZSxuKXtpLiQkbGVhdmVEb25lQ2FsbGJhY2s9bi4kZG9uZX07dmFyIHM9ZS4kZXZhbChvLmZhT3B0aW9ucyk7aS5yZW5kZXJOb2RlPW5ldyByKHMpLG4uYWRkUm9sZShcInJlbmRlcmFibGVcIixpKSxpLnNob3coKSxuLnNlcXVlbmNlV2l0aChlLGZ1bmN0aW9uKGUpe3Q9ZS5yZW5kZXJHYXRlfSl9LHBvc3Q6ZnVuY3Rpb24oZSxyKXt2YXIgYT1uLmVuc3VyZUlzb2xhdGUoZSk7bi5yZWdpc3RlckNoaWxkKGUscixhKX19fX19XSksYW5ndWxhci5tb2R1bGUoXCJmYW1vdXMuYW5ndWxhclwiKS5kaXJlY3RpdmUoXCJmYUZsZXhpYmxlTGF5b3V0XCIsW1wiJGZhbW91c1wiLFwiJGZhbW91c0RlY29yYXRvclwiLGZ1bmN0aW9uKGUsbil7cmV0dXJue3RlbXBsYXRlOlwiPGRpdj48L2Rpdj5cIixyZXN0cmljdDpcIkVcIix0cmFuc2NsdWRlOiEwLHNjb3BlOiEwLGNvbXBpbGU6ZnVuY3Rpb24ocixhLG8pe3JldHVybntwcmU6ZnVuY3Rpb24ocixhLG8pe3ZhciB0PW4uZW5zdXJlSXNvbGF0ZShyKSxpPWVbXCJmYW1vdXMvdmlld3MvRmxleGlibGVMYXlvdXRcIl0scz0oZVtcImZhbW91cy9jb3JlL1ZpZXdTZXF1ZW5jZVwiXSxlW1wiZmFtb3VzL2NvcmUvUmVuZGVyTm9kZVwiXSxbXSksdT1yLiRldmFsKG8uZmFPcHRpb25zKXx8e307dC5yZW5kZXJOb2RlPW5ldyBpKHUpLG4uYWRkUm9sZShcInJlbmRlcmFibGVcIix0KSx0LnNob3coKTt2YXIgYz1mdW5jdGlvbigpe3Muc29ydChmdW5jdGlvbihlLG4pe3JldHVybiBlLmluZGV4LW4uaW5kZXh9KSx0LnJlbmRlck5vZGUuc2VxdWVuY2VGcm9tKGZ1bmN0aW9uKGUpe3ZhciBuPVtdO3JldHVybiBhbmd1bGFyLmZvckVhY2goZSxmdW5jdGlvbihlLHIpe25bcl09ZS5yZW5kZXJHYXRlfSksbn0ocykpfTtuLnNlcXVlbmNlV2l0aChyLGZ1bmN0aW9uKGUpe3MucHVzaChlKSxjKCl9LGZ1bmN0aW9uKGUpe3M9ZnVuY3Rpb24obil7dmFyIHI9W107cmV0dXJuIGFuZ3VsYXIuZm9yRWFjaChuLGZ1bmN0aW9uKG4pe24uaWQhPT1lJiZyLnB1c2gobil9KSxyfShzKSxjKCl9KX0scG9zdDpmdW5jdGlvbihlLHIpe3ZhciBhPW4uZW5zdXJlSXNvbGF0ZShlKTtvKGUsZnVuY3Rpb24oZSl7ci5maW5kKFwiZGl2XCIpLmFwcGVuZChlKX0pLGUuJGVtaXQoXCJyZWdpc3RlckNoaWxkXCIsYSl9fX19fV0pLGFuZ3VsYXIubW9kdWxlKFwiZmFtb3VzLmFuZ3VsYXJcIikuZGlyZWN0aXZlKFwiZmFGbGlwcGVyXCIsW1wiJGZhbW91c1wiLFwiJGZhbW91c0RlY29yYXRvclwiLGZ1bmN0aW9uKGUsbil7cmV0dXJue3RlbXBsYXRlOlwiPGRpdj48L2Rpdj5cIixyZXN0cmljdDpcIkVcIix0cmFuc2NsdWRlOiEwLHNjb3BlOiEwLGNvbXBpbGU6ZnVuY3Rpb24ocixhLG8pe3JldHVybntwcmU6ZnVuY3Rpb24ocixhLG8pe3ZhciB0PW4uZW5zdXJlSXNvbGF0ZShyKSxpPWVbXCJmYW1vdXMvdmlld3MvRmxpcHBlclwiXSxzPXIuJGV2YWwoby5mYU9wdGlvbnMpfHx7fTt0LnJlbmRlck5vZGU9bmV3IGkocyksbi5hZGRSb2xlKFwicmVuZGVyYWJsZVwiLHQpLHQuc2hvdygpLHQuY2hpbGRyZW49W10sdC5mbGlwPWZ1bmN0aW9uKGUpe3QucmVuZGVyTm9kZS5mbGlwKGV8fHIuJGV2YWwoby5mYU9wdGlvbnMpKX0sbi5zZXF1ZW5jZVdpdGgocixmdW5jdGlvbihlKXt2YXIgbj10LmNoaWxkcmVuLmxlbmd0aDtpZigwPT09bil0LnJlbmRlck5vZGUuc2V0RnJvbnQoZS5yZW5kZXJHYXRlKTtlbHNle2lmKDEhPT1uKXRocm93IG5ldyBFcnJvcihcImZhLWZsaXBwZXIgYWNjZXB0cyBvbmx5IHR3byBjaGlsZCBlbGVtZW50czsgbW9yZSB0aGFuIHR3byBoYXZlIGJlZW4gcHJvdmlkZWRcIik7dC5yZW5kZXJOb2RlLnNldEJhY2soZS5yZW5kZXJHYXRlKX10LmNoaWxkcmVuLnB1c2goZS5yZW5kZXJHYXRlKX0sZnVuY3Rpb24oKXt0LmNoaWxkcmVuLnNwbGljZSh0LmNoaWxkcmVuLmxlbmd0aC0xLDEpfSl9LHBvc3Q6ZnVuY3Rpb24oZSxyKXt2YXIgYT1uLmVuc3VyZUlzb2xhdGUoZSk7byhlLGZ1bmN0aW9uKGUpe3IuZmluZChcImRpdlwiKS5hcHBlbmQoZSl9KSxuLnJlZ2lzdGVyQ2hpbGQoZSxyLGEpfX19fX1dKSxhbmd1bGFyLm1vZHVsZShcImZhbW91cy5hbmd1bGFyXCIpLmRpcmVjdGl2ZShcImZhR3JpZExheW91dFwiLFtcIiRmYW1vdXNcIixcIiRmYW1vdXNEZWNvcmF0b3JcIixmdW5jdGlvbihlLG4pe3JldHVybnt0ZW1wbGF0ZTpcIjxkaXY+PC9kaXY+XCIscmVzdHJpY3Q6XCJFXCIsdHJhbnNjbHVkZTohMCxzY29wZTohMCxjb21waWxlOmZ1bmN0aW9uKHIsYSxvKXtyZXR1cm57cHJlOmZ1bmN0aW9uKHIsYSxvKXt2YXIgdD1uLmVuc3VyZUlzb2xhdGUociksaT1lW1wiZmFtb3VzL3ZpZXdzL0dyaWRMYXlvdXRcIl0scz0oZVtcImZhbW91cy9jb3JlL1ZpZXdTZXF1ZW5jZVwiXSxbXSksdT1yLiRldmFsKG8uZmFPcHRpb25zKXx8e307dC5yZW5kZXJOb2RlPW5ldyBpKHUpLG4uYWRkUm9sZShcInJlbmRlcmFibGVcIix0KSx0LnNob3coKTt2YXIgYz1mdW5jdGlvbigpe3IuJCRwb3N0RGlnZXN0KGZ1bmN0aW9uKCl7cy5zb3J0KGZ1bmN0aW9uKGUsbil7cmV0dXJuIGUuaW5kZXgtbi5pbmRleH0pLHQucmVuZGVyTm9kZS5zZXF1ZW5jZUZyb20oZnVuY3Rpb24oZSl7dmFyIG49W107cmV0dXJuIGFuZ3VsYXIuZm9yRWFjaChlLGZ1bmN0aW9uKGUscil7bltyXT1lLnJlbmRlckdhdGV9KSxufShzKSl9KX07bi5zZXF1ZW5jZVdpdGgocixmdW5jdGlvbihlKXtzLnB1c2goZSksYygpfSxmdW5jdGlvbihlKXtzPWZ1bmN0aW9uKG4pe3ZhciByPVtdO3JldHVybiBhbmd1bGFyLmZvckVhY2gobixmdW5jdGlvbihuKXtuLmlkIT09ZSYmci5wdXNoKG4pfSkscn0ocyksYygpfSxjKX0scG9zdDpmdW5jdGlvbihlLHIpe3ZhciBhPW4uZW5zdXJlSXNvbGF0ZShlKTtvKGUsZnVuY3Rpb24oZSl7ci5maW5kKFwiZGl2XCIpLmFwcGVuZChlKX0pLG4ucmVnaXN0ZXJDaGlsZChlLHIsYSl9fX19fV0pLGFuZ3VsYXIubW9kdWxlKFwiZmFtb3VzLmFuZ3VsYXJcIikuZGlyZWN0aXZlKFwiZmFIZWFkZXJGb290ZXJMYXlvdXRcIixbXCIkZmFtb3VzXCIsXCIkZmFtb3VzRGVjb3JhdG9yXCIsZnVuY3Rpb24oZSxuKXtyZXR1cm57dGVtcGxhdGU6XCI8ZGl2PjwvZGl2PlwiLHJlc3RyaWN0OlwiRVwiLHRyYW5zY2x1ZGU6ITAsc2NvcGU6ITAsY29tcGlsZTpmdW5jdGlvbihyLGEsbyl7dmFyIHQ9ZVtcImZhbW91cy92aWV3cy9IZWFkZXJGb290ZXJMYXlvdXRcIl0saT1lW1wiZmFtb3VzL2NvcmUvUmVuZGVyTm9kZVwiXTtyZXR1cm57cHJlOmZ1bmN0aW9uKGUscixhKXt2YXIgbz1uLmVuc3VyZUlzb2xhdGUoZSkscz0obmV3IGksbmV3IGksbmV3IGksZS4kZXZhbChhLmZhT3B0aW9ucyl8fHt9KTtvLnJlbmRlck5vZGU9bmV3IHQocyksbi5hZGRSb2xlKFwicmVuZGVyYWJsZVwiLG8pLG8uc2hvdygpO3ZhciB1PTA7bi5zZXF1ZW5jZVdpdGgoZSxmdW5jdGlvbihlKXtpZih1KyssMT09PXUpby5yZW5kZXJOb2RlLmhlYWRlci5hZGQoZS5yZW5kZXJHYXRlKTtlbHNlIGlmKDI9PT11KW8ucmVuZGVyTm9kZS5jb250ZW50LmFkZChlLnJlbmRlckdhdGUpO2Vsc2V7aWYoMyE9PXUpdGhyb3cgbmV3IEVycm9yKFwiZmEtaGVhZGVyLWZvb3Rlci1sYXlvdXQgY2FuIGFjY2VwdCBubyBtb3JlIHRoYW4gMyBjaGlsZHJlblwiKTtvLnJlbmRlck5vZGUuZm9vdGVyLmFkZChlLnJlbmRlckdhdGUpfX0sZnVuY3Rpb24oKXsxPT09dT9vLnJlbmRlck5vZGUuaGVhZGVyLnNldCh7fSk6Mj09PXU/by5yZW5kZXJOb2RlLmNvbnRlbnQuc2V0KHt9KTozPT09dSYmby5yZW5kZXJOb2RlLmZvb3Rlci5zZXQoe30pLHUtLX0pfSxwb3N0OmZ1bmN0aW9uKGUscil7dmFyIGE9bi5lbnN1cmVJc29sYXRlKGUpO28oZSxmdW5jdGlvbihlKXtyLmZpbmQoXCJkaXZcIikuYXBwZW5kKGUpfSksbi5yZWdpc3RlckNoaWxkKGUscixhKX19fX19XSksYW5ndWxhci5tb2R1bGUoXCJmYW1vdXMuYW5ndWxhclwiKS5kaXJlY3RpdmUoXCJmYUltYWdlU3VyZmFjZVwiLFtcIiRmYW1vdXNcIixcIiRmYW1vdXNEZWNvcmF0b3JcIixmdW5jdGlvbihlLG4pe3JldHVybntzY29wZTohMCx0ZW1wbGF0ZTonPGRpdiBjbGFzcz1cImZhLWltYWdlLXN1cmZhY2VcIj48L2Rpdj4nLHJlc3RyaWN0OlwiRUFcIixjb21waWxlOmZ1bmN0aW9uKCl7cmV0dXJue3ByZTpmdW5jdGlvbihyLGEsbyl7e3ZhciB0PW4uZW5zdXJlSXNvbGF0ZShyKSxpPWVbXCJmYW1vdXMvc3VyZmFjZXMvSW1hZ2VTdXJmYWNlXCJdO2VbXCJmYW1vdXMvY29yZS9UcmFuc2Zvcm1cIl0sZVtcImZhbW91cy9jb3JlL0V2ZW50SGFuZGxlclwiXX1yLiR3YXRjaChmdW5jdGlvbigpe3JldHVybiB0LmdldFByb3BlcnRpZXMoKX0sZnVuY3Rpb24oKXt0LnJlbmRlck5vZGUmJnQucmVuZGVyTm9kZS5zZXRQcm9wZXJ0aWVzKHQuZ2V0UHJvcGVydGllcygpKX0sITApO3ZhciBzPWZ1bmN0aW9uKGUpe3JldHVyblwiZmFcIitlLmNoYXJBdCgwKS50b1VwcGVyQ2FzZSgpK2Uuc2xpY2UoMSl9O3QuZ2V0UHJvcGVydGllcz1mdW5jdGlvbigpe2Zvcih2YXIgZT1yLiRldmFsKG8uZmFQcm9wZXJ0aWVzKXx8e30sbj1bXCJiYWNrZ3JvdW5kQ29sb3JcIixcImNvbG9yXCJdLGE9MDthPG4ubGVuZ3RoO2ErKyl7dmFyIHQ9blthXSxpPXModCk7b1tpXSYmKGVbdF09ci4kZXZhbChvW2ldKSl9cmV0dXJuIGV9LHQucmVuZGVyTm9kZT1uZXcgaSh7c2l6ZTpyLiRldmFsKG8uZmFTaXplKSxcImNsYXNzXCI6ci4kZXZhbChvLmNsYXNzKSxwcm9wZXJ0aWVzOnQuZ2V0UHJvcGVydGllcygpfSksbi5hZGRSb2xlKFwicmVuZGVyYWJsZVwiLHQpLHQuc2hvdygpLG8uY2xhc3MmJnQucmVuZGVyTm9kZS5zZXRDbGFzc2VzKG9bXCJjbGFzc1wiXS5zcGxpdChcIiBcIikpfSxwb3N0OmZ1bmN0aW9uKGUscixhKXt2YXIgbz1uLmVuc3VyZUlzb2xhdGUoZSksdD1mdW5jdGlvbigpe28ucmVuZGVyTm9kZS5zZXRDb250ZW50KGEuZmFJbWFnZVVybCl9O3QoKSxhLiRvYnNlcnZlKFwiZmFJbWFnZVVybFwiLHQpLG4ucmVnaXN0ZXJDaGlsZChlLHIsbyl9fX19fV0pLGFuZ3VsYXIubW9kdWxlKFwiZmFtb3VzLmFuZ3VsYXJcIikuZGlyZWN0aXZlKFwiZmFJbmRleFwiLFtcIiRwYXJzZVwiLFwiJGZhbW91c0RlY29yYXRvclwiLGZ1bmN0aW9uKGUsbil7cmV0dXJue3Jlc3RyaWN0OlwiQVwiLHNjb3BlOiExLHByaW9yaXR5OjE2LGNvbXBpbGU6ZnVuY3Rpb24oKXtyZXR1cm57cG9zdDpmdW5jdGlvbihlLHIsYSl7dmFyIG89bi5lbnN1cmVJc29sYXRlKGUscik7by5pbmRleD1lLiRldmFsKGEuZmFJbmRleCksZS4kd2F0Y2goZnVuY3Rpb24oKXtyZXR1cm4gZS4kZXZhbChhLmZhSW5kZXgpfSxmdW5jdGlvbigpe28uaW5kZXg9ZS4kZXZhbChhLmZhSW5kZXgpLG8udXBkYXRlTWV0aG9kJiZvLnVwZGF0ZU1ldGhvZCgpfSl9fX19fV0pLGFuZ3VsYXIubW9kdWxlKFwiZmFtb3VzLmFuZ3VsYXJcIikuY29uZmlnKFtcIiRwcm92aWRlXCIsZnVuY3Rpb24oZSl7ZS5kZWNvcmF0b3IoXCJuZ0NsaWNrRGlyZWN0aXZlXCIsW1wiJGRlbGVnYXRlXCIsXCIkZmFtb3VzRGVjb3JhdG9yXCIsXCIkcGFyc2VcIixcIiRyb290RWxlbWVudFwiLFwiJGZhbW91c1wiLFwiJHRpbWVvdXRcIixmdW5jdGlvbihlLG4scixhLG8sdCl7ZnVuY3Rpb24gaShlLG4scixhKXtyZXR1cm4gTWF0aC5hYnMoZS1yKTwkJiZNYXRoLmFicyhuLWEpPCR9ZnVuY3Rpb24gcyhlLG4scil7Zm9yKHZhciBhPTA7YTxlLmxlbmd0aDthKz0yKWlmKGkoZVthXSxlW2ErMV0sbixyKSlyZXR1cm4gZS5zcGxpY2UoYSxhKzIpLCEwO3JldHVybiExfWZ1bmN0aW9uIHUoZSl7aWYoIShEYXRlLm5vdygpLWw+aCkpe3ZhciBuPWUudG91Y2hlcyYmZS50b3VjaGVzLmxlbmd0aD9lLnRvdWNoZXM6W2VdLHI9blswXS5jbGllbnRYLGE9blswXS5jbGllbnRZO3MoZCxyLGEpfHwoZS5zdG9wUHJvcGFnYXRpb24oKSxlLnByZXZlbnREZWZhdWx0KCksZS50YXJnZXQmJmUudGFyZ2V0LmJsdXIoKSl9fWZ1bmN0aW9uIGMoZSl7dmFyIG49ZS50b3VjaGVzJiZlLnRvdWNoZXMubGVuZ3RoP2UudG91Y2hlczpbZV0scj1uWzBdLmNsaWVudFgsYT1uWzBdLmNsaWVudFk7ZC5wdXNoKHIsYSksdChmdW5jdGlvbigpe2Zvcih2YXIgZT0wO2U8ZC5sZW5ndGg7ZSs9MilpZihkW2VdPT09ciYmZFtlKzFdPT09YSlyZXR1cm4gdm9pZCBkLnNwbGljZShlLGUrMil9LGgsITEpfWZ1bmN0aW9uIGYoZSxuKXtkfHwoYVswXS5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIix1LCEwKSxhWzBdLmFkZEV2ZW50TGlzdGVuZXIoXCJ0b3VjaHN0YXJ0XCIsYywhMCksZD1bXSksbD1EYXRlLm5vdygpLHMoZCxlLG4pfXt2YXIgbCxkLG09ZVswXSxwPW0uY29tcGlsZSx2PTc1MCxnPTEyLGg9MjUwMCwkPTI1LHk9XCJuZy1jbGljay1hY3RpdmVcIjtvW1wiZmFtb3VzL2NvcmUvRW5naW5lXCJdfXJldHVybiBtLmNvbXBpbGU9ZnVuY3Rpb24oZSxuLGEpe3JldHVybiBvLnV0aWwuaXNGYUVsZW1lbnQoZSk/by51dGlsLmlzQVN1cmZhY2UoZSk/e3Bvc3Q6ZnVuY3Rpb24oZSxuLGEpe2Z1bmN0aW9uIHQoKXtkPSExLHAucmVtb3ZlQ2xhc3MoeSl9dmFyIGkscyx1LGMsbD1yKGEubmdDbGljayksZD0hMSxtPW8uZ2V0SXNvbGF0ZShlKSxwPW0ucmVuZGVyTm9kZTtwLm9uKFwidG91Y2hzdGFydFwiLGZ1bmN0aW9uKGUpe2Q9ITAsaT1lLnRhcmdldD9lLnRhcmdldDplLnNyY0VsZW1lbnQsMz09PWkubm9kZVR5cGUmJihpPWkucGFyZW50Tm9kZSkscC5hZGRDbGFzcyh5KSxzPURhdGUubm93KCk7dmFyIG49ZS50b3VjaGVzJiZlLnRvdWNoZXMubGVuZ3RoP2UudG91Y2hlczpbZV0scj1uWzBdLm9yaWdpbmFsRXZlbnR8fG5bMF07dT1yLmNsaWVudFgsYz1yLmNsaWVudFl9KSxwLm9uKFwidG91Y2htb3ZlXCIsZnVuY3Rpb24oKXt0KCl9KSxwLm9uKFwidG91Y2hjYW5jZWxcIixmdW5jdGlvbigpe3QoKX0pLHAub24oXCJ0b3VjaGVuZFwiLGZ1bmN0aW9uKGUpe3ZhciBuPURhdGUubm93KCktcyxyPWUuY2hhbmdlZFRvdWNoZXMmJmUuY2hhbmdlZFRvdWNoZXMubGVuZ3RoP2UuY2hhbmdlZFRvdWNoZXM6ZS50b3VjaGVzJiZlLnRvdWNoZXMubGVuZ3RoP2UudG91Y2hlczpbZV0sbz1yWzBdLm9yaWdpbmFsRXZlbnR8fHJbMF0saT1vLmNsaWVudFgsbD1vLmNsaWVudFksbT1NYXRoLnNxcnQoTWF0aC5wb3coaS11LDIpK01hdGgucG93KGwtYywyKSk7ZCYmdj5uJiZnPm0mJihmKGksbCksYW5ndWxhci5pc0RlZmluZWQoYS5kaXNhYmxlZCkmJlwiZmFsc2VcIiE9PWEuZGlzYWJsZWR8fHAuZW1pdChcImNsaWNrXCIsW2VdKSksdCgpfSkscC5vbihcImNsaWNrXCIsZnVuY3Rpb24obixyKXtlLiRhcHBseShmdW5jdGlvbigpe2woZSx7JGV2ZW50OnJ8fG59KX0pfSkscC5vbihcIm1vdXNlZG93blwiLGZ1bmN0aW9uKCl7cC5hZGRDbGFzcyh5KX0pLHAub24oXCJtb3VzZW1vdmUgbW91c2V1cFwiLGZ1bmN0aW9uKCl7cC5yZW1vdmVDbGFzcyh5KX0pfX06dm9pZCAwOnAoZSxuLGEpfSxlfV0pLGFuZ3VsYXIuZm9yRWFjaChcImRibGNsaWNrIG1vdXNlZG93biBtb3VzZXVwIG1vdXNlb3ZlciBtb3VzZW91dCBtb3VzZW1vdmUgbW91c2VlbnRlciBtb3VzZWxlYXZlIGtleWRvd24ga2V5dXAga2V5cHJlc3Mgc3VibWl0IGZvY3VzIGJsdXIgY29weSBjdXQgcGFzdGVcIi5zcGxpdChcIiBcIiksZnVuY3Rpb24obil7dmFyIHI9d2luZG93LiRmYW1vdXNVdGlsLmRpcmVjdGl2ZU5vcm1hbGl6ZShcIm5nLVwiK24pO2UuZGVjb3JhdG9yKHIrXCJEaXJlY3RpdmVcIixbXCIkZGVsZWdhdGVcIixcIiRmYW1vdXNEZWNvcmF0b3JcIixcIiRwYXJzZVwiLFwiJGZhbW91c1wiLGZ1bmN0aW9uKGUsYSxvLHQpe3ZhciBpPWVbMF0scz1pLmNvbXBpbGU7cmV0dXJuIGkuY29tcGlsZT1mdW5jdGlvbihlLGksdSl7cmV0dXJuIHQudXRpbC5pc0ZhRWxlbWVudChlKT97cG9zdDpmdW5jdGlvbihlLHQsaSl7dmFyIHM9YS5lbnN1cmVJc29sYXRlKGUpO2lmKGlbcl0pe3ZhciB1PXMucmVuZGVyTm9kZS5fZXZlbnRJbnB1dHx8cy5yZW5kZXJOb2RlO3Uub24obixmdW5jdGlvbihuKXt2YXIgYT1vKGlbcl0pO2EoZSx7JGV2ZW50Om59KSxlLiQkcGhhc2V8fGUuJGFwcGx5KCl9KX19fTpzKGUsaSx1KX0sZX1dKX0pfV0pLGFuZ3VsYXIubW9kdWxlKFwiZmFtb3VzLmFuZ3VsYXJcIikuZGlyZWN0aXZlKFwiZmFNb2RpZmllclwiLFtcIiRmYW1vdXNcIixcIiRmYW1vdXNEZWNvcmF0b3JcIixcIiRwYXJzZVwiLFwiJHJvb3RTY29wZVwiLGZ1bmN0aW9uKGUsbixyLGEpe3JldHVybnt0ZW1wbGF0ZTpcIjxkaXY+PC9kaXY+XCIsdHJhbnNjbHVkZTohMCxyZXN0cmljdDpcIkVBXCIscHJpb3JpdHk6MixzY29wZTohMCxjb21waWxlOmZ1bmN0aW9uKG8sdCxpKXtyZXR1cm57cG9zdDpmdW5jdGlvbihvLHQscyl7dmFyIHU9bi5lbnN1cmVJc29sYXRlKG8pLGM9ZVtcImZhbW91cy9jb3JlL1JlbmRlck5vZGVcIl0sZj1lW1wiZmFtb3VzL2NvcmUvTW9kaWZpZXJcIl0sbD1lW1wiZmFtb3VzL2NvcmUvVHJhbnNmb3JtXCJdLGQ9ZVtcImZhbW91cy9waHlzaWNzL2JvZGllcy9QYXJ0aWNsZVwiXSxtPWZ1bmN0aW9uKGUpe3JldHVybiBlLmdldFBvc2l0aW9uKCl9LHA9W1wiYWJvdXRPcmlnaW5cIixcInBlcnNwZWN0aXZlXCIsXCJyb3RhdGVcIixcInJvdGF0ZUF4aXNcIixcInJvdGF0ZVhcIixcInJvdGF0ZVlcIixcInJvdGF0ZVpcIixcInNjYWxlXCIsXCJza2V3XCIsXCJ0cmFuc2xhdGVcIl07cy4kb2JzZXJ2ZShcImZhVHJhbnNmb3JtT3JkZXJcIixmdW5jdGlvbigpe3ZhciBlPW8uJGV2YWwocy5mYVRyYW5zZm9ybU9yZGVyKTt2b2lkIDAhPT1lJiYocD1lKX0pO3ZhciB2PXt9O2FuZ3VsYXIuZm9yRWFjaChwLGZ1bmN0aW9uKG4pe3ZhciBhPWUudXRpbC5kaXJlY3RpdmVOb3JtYWxpemUoXCJmYS1cIituKTtzLiRvYnNlcnZlKGEsZnVuY3Rpb24oKXt2W25dPXIoc1thXSl9KX0pO3ZhciBnPWFuZ3VsYXIubm9vcDtzLiRvYnNlcnZlKFwiZmFUcmFuc2Zvcm1cIixmdW5jdGlvbigpe2c9cihzLmZhVHJhbnNmb3JtKX0pLHUuZ2V0VHJhbnNmb3JtPWZ1bmN0aW9uKCl7dmFyIGU9ZyhvKTtpZih2b2lkIDAhPT1lKXJldHVybiBlIGluc3RhbmNlb2YgRnVuY3Rpb24/ZSgpOmUgaW5zdGFuY2VvZiBPYmplY3QmJnZvaWQgMCE9PWUuZ2V0P2UuZ2V0KCk6ZTt2YXIgbj1bXTtyZXR1cm4gYW5ndWxhci5mb3JFYWNoKHAsZnVuY3Rpb24oZSl7dmFyIHI9dltlXT92W2VdKG8pOnZvaWQgMDt2b2lkIDAhPT1yJiYociBpbnN0YW5jZW9mIEZ1bmN0aW9uJiYocj1yKCkpLG4ucHVzaChyIGluc3RhbmNlb2YgQXJyYXk/bFtlXS5hcHBseSh0aGlzLHIpOnIgaW5zdGFuY2VvZiBkP2xbZV0uYXBwbHkodGhpcyxtKHIpKTpsW2VdLmNhbGwodGhpcyxyKSkpfSksbi5sZW5ndGg/MT09PW4ubGVuZ3RoP25bMF06bC5tdWx0aXBseS5hcHBseSh0aGlzLG4pOnZvaWQgMH07dmFyIGg9YW5ndWxhci5ub29wO3MuJG9ic2VydmUoXCJmYUFsaWduXCIsZnVuY3Rpb24oKXtoPXIocy5mYUFsaWduKX0pLHUuZ2V0QWxpZ249ZnVuY3Rpb24oKXt2YXIgZT1oKG8pO3JldHVybiBlIGluc3RhbmNlb2YgRnVuY3Rpb24/ZSgpOmUgaW5zdGFuY2VvZiBPYmplY3QmJnZvaWQgMCE9PWUuZ2V0P2UuZ2V0KCk6ZSBpbnN0YW5jZW9mIGQ/bShlKTplfTt2YXIgJD1hbmd1bGFyLm5vb3A7cy4kb2JzZXJ2ZShcImZhT3BhY2l0eVwiLGZ1bmN0aW9uKCl7JD1yKHMuZmFPcGFjaXR5KX0pLHUuZ2V0T3BhY2l0eT1mdW5jdGlvbigpe3ZhciBlPSQobyk7cmV0dXJuIHZvaWQgMD09PWU/MTplIGluc3RhbmNlb2YgRnVuY3Rpb24/ZSgpOmUgaW5zdGFuY2VvZiBPYmplY3QmJnZvaWQgMCE9PWUuZ2V0P2UuZ2V0KCk6ZSBpbnN0YW5jZW9mIGQ/bShlKTplfTt2YXIgeT1hbmd1bGFyLm5vb3A7cy4kb2JzZXJ2ZShcImZhU2l6ZVwiLGZ1bmN0aW9uKCl7eT1yKHMuZmFTaXplKX0pLHUuZ2V0U2l6ZT1mdW5jdGlvbigpe3ZhciBlPXkobyk7cmV0dXJuIGUgaW5zdGFuY2VvZiBGdW5jdGlvbj9lKCk6ZSBpbnN0YW5jZW9mIE9iamVjdCYmdm9pZCAwIT09ZS5nZXQ/ZS5nZXQoKTplIGluc3RhbmNlb2YgZD9tKGUpOmV9O3ZhciB3PWFuZ3VsYXIubm9vcDtzLiRvYnNlcnZlKFwiZmFPcmlnaW5cIixmdW5jdGlvbigpe3c9cihzLmZhT3JpZ2luKX0pLHUuZ2V0T3JpZ2luPWZ1bmN0aW9uKCl7dmFyIGU9dyhvKTtyZXR1cm4gZSBpbnN0YW5jZW9mIEZ1bmN0aW9uP2UoKTplIGluc3RhbmNlb2YgT2JqZWN0JiZ2b2lkIDAhPT1lLmdldD9lLmdldCgpOmUgaW5zdGFuY2VvZiBkP20oZSk6ZX0sdS5tb2RpZmllcj1uZXcgZih7dHJhbnNmb3JtOnUuZ2V0VHJhbnNmb3JtLHNpemU6dS5nZXRTaXplLG9wYWNpdHk6dS5nZXRPcGFjaXR5LG9yaWdpbjp1LmdldE9yaWdpbixhbGlnbjp1LmdldEFsaWdufSksdS5yZW5kZXJOb2RlPShuZXcgYykuYWRkKHUubW9kaWZpZXIpLG4uYWRkUm9sZShcInJlbmRlcmFibGVcIix1KSx1LnNob3coKSxuLnNlcXVlbmNlV2l0aChvLGZ1bmN0aW9uKGUpe3UucmVuZGVyTm9kZS5hZGQoZS5yZW5kZXJHYXRlKX0pLGkobyxmdW5jdGlvbihlKXt0LmZpbmQoXCJkaXZcIikuYXBwZW5kKGUpfSksbi5yZWdpc3RlckNoaWxkKG8sdCx1LGZ1bmN0aW9uKCl7dS5tb2RpZmllci5zZXRPcGFjaXR5KDApfSksby4kJHBoYXNlfHxhLiQkcGhhc2V8fG8uJGFwcGx5KCl9fX19fV0pLGFuZ3VsYXIubW9kdWxlKFwiZmFtb3VzLmFuZ3VsYXJcIikuZGlyZWN0aXZlKFwiZmFNb3VzZW92ZXJcIixbXCIkcGFyc2VcIixcIiRmYW1vdXNEZWNvcmF0b3JcIixmdW5jdGlvbihlLG4pe3JldHVybntyZXN0cmljdDpcIkFcIixzY29wZTohMSxjb21waWxlOmZ1bmN0aW9uKCl7cmV0dXJue3Bvc3Q6ZnVuY3Rpb24ocixhLG8pe3ZhciB0PW4uZW5zdXJlSXNvbGF0ZShyKTtpZihvLmZhTW91c2VvdmVyKXt2YXIgaT10LnJlbmRlck5vZGUuX2V2ZW50SW5wdXR8fHQucmVuZGVyTm9kZTtpLm9uKFwibW91c2VvdmVyXCIsZnVuY3Rpb24obil7dmFyIGE9ZShvLmZhTW91c2VvdmVyKTthKHIseyRldmVudDpufSksci4kJHBoYXNlfHxyLiRhcHBseSgpfSl9fX19fX1dKSxhbmd1bGFyLm1vZHVsZShcImZhbW91cy5hbmd1bGFyXCIpLmRpcmVjdGl2ZShcImZhT3B0aW9uc1wiLFtcIiRwYXJzZVwiLFwiJGZhbW91c0RlY29yYXRvclwiLGZ1bmN0aW9uKGUsbil7cmV0dXJue3Jlc3RyaWN0OlwiQVwiLHNjb3BlOiExLHByaW9yaXR5Oi0xNixjb21waWxlOmZ1bmN0aW9uKCl7cmV0dXJue3Bvc3Q6ZnVuY3Rpb24oZSxyLGEpe3ZhciBvPW4uZW5zdXJlSXNvbGF0ZShlLHIpO2UuJHdhdGNoKGZ1bmN0aW9uKCl7cmV0dXJuIGUuJGV2YWwoYS5mYU9wdGlvbnMpfSxmdW5jdGlvbigpe28ucmVuZGVyTm9kZS5zZXRPcHRpb25zKGUuJGV2YWwoYS5mYU9wdGlvbnMpKX0sITApfX19fX1dKSxhbmd1bGFyLm1vZHVsZShcImZhbW91cy5hbmd1bGFyXCIpLmRpcmVjdGl2ZShcImZhUGlwZUZyb21cIixbXCIkZmFtb3VzXCIsXCIkZmFtb3VzRGVjb3JhdG9yXCIsXCIkZmFtb3VzUGlwZVwiLGZ1bmN0aW9uKGUsbixyKXtyZXR1cm57cmVzdHJpY3Q6XCJBXCIsc2NvcGU6ITEscHJpb3JpdHk6MTYsY29tcGlsZTpmdW5jdGlvbigpe3ZhciBhPWVbXCJmYW1vdXMvY29yZS9FbmdpbmVcIl07cmV0dXJue3Bvc3Q6ZnVuY3Rpb24oZSxvLHQpe3ZhciBpPW4uZW5zdXJlSXNvbGF0ZShlKTtlLiR3YXRjaChmdW5jdGlvbigpe3JldHVybiBlLiRldmFsKHQuZmFQaXBlRnJvbSl9LGZ1bmN0aW9uKGUsbil7dmFyIG87bz1pLnJlbmRlck5vZGUmJmkucmVuZGVyTm9kZS5faXNNb2RpZmllcj9pLnJlbmRlck5vZGUuX29iamVjdDppLnJlbmRlck5vZGU/aS5yZW5kZXJOb2RlLl9ldmVudElucHV0fHxpLnJlbmRlck5vZGU6YSxyLnVucGlwZXNGcm9tVGFyZ2V0cyhvLG4pLHIucGlwZXNUb1RhcmdldHMobyxlKX0pLGUuJG9uKFwiJGRlc3Ryb3lcIixmdW5jdGlvbigpe3IudW5waXBlc0Zyb21UYXJnZXRzKGkucmVuZGVyTm9kZXx8YSxlLiRldmFsKHQuZmFQaXBlRnJvbSkpfSl9fX19fV0pLGFuZ3VsYXIubW9kdWxlKFwiZmFtb3VzLmFuZ3VsYXJcIikuZGlyZWN0aXZlKFwiZmFQaXBlVG9cIixbXCIkZmFtb3VzXCIsXCIkZmFtb3VzRGVjb3JhdG9yXCIsXCIkZmFtb3VzUGlwZVwiLGZ1bmN0aW9uKGUsbixyKXtyZXR1cm57cmVzdHJpY3Q6XCJBXCIsc2NvcGU6ITEscHJpb3JpdHk6MTYsY29tcGlsZTpmdW5jdGlvbigpe3ZhciBhPWVbXCJmYW1vdXMvY29yZS9FbmdpbmVcIl07cmV0dXJue3Bvc3Q6ZnVuY3Rpb24oZSxvLHQpe3ZhciBpPW4uZW5zdXJlSXNvbGF0ZShlKTtlLiR3YXRjaChmdW5jdGlvbigpe3JldHVybiBlLiRldmFsKHQuZmFQaXBlVG8pfSxmdW5jdGlvbihlLG4pe3ZhciBvO289aS5yZW5kZXJOb2RlJiZpLnJlbmRlck5vZGUuX2lzTW9kaWZpZXI/aS5yZW5kZXJOb2RlLl9vYmplY3Q6aS5yZW5kZXJOb2RlP2kucmVuZGVyTm9kZS5fZXZlbnRPdXRwdXR8fGkucmVuZGVyTm9kZTphLHIudW5waXBlc0Zyb21UYXJnZXRzKG4sbyksci5waXBlc1RvVGFyZ2V0cyhlLG8pfSksZS4kb24oXCIkZGVzdHJveVwiLGZ1bmN0aW9uKCl7ci51bnBpcGVzRnJvbVRhcmdldHMoZS4kZXZhbCh0LmZhUGlwZVRvKSxpLnJlbmRlck5vZGV8fGEpfSl9fX19fV0pLGFuZ3VsYXIubW9kdWxlKFwiZmFtb3VzLmFuZ3VsYXJcIikuZGlyZWN0aXZlKFwiZmFSZW5kZXJOb2RlXCIsW1wiJGZhbW91c1wiLFwiJGZhbW91c0RlY29yYXRvclwiLGZ1bmN0aW9uKGUsbil7cmV0dXJue3RlbXBsYXRlOlwiPGRpdj48L2Rpdj5cIix0cmFuc2NsdWRlOiEwLHNjb3BlOiEwLHJlc3RyaWN0OlwiRUFcIixjb21waWxlOmZ1bmN0aW9uKHIsYSxvKXtyZXR1cm57cHJlOmZ1bmN0aW9uKHIsYSxvKXt7dmFyIHQ9bi5lbnN1cmVJc29sYXRlKHIpLGk9ZVtcImZhbW91cy9jb3JlL0VuZ2luZVwiXTtcbmVbXCJmYW1vdXMvY29yZS9SZW5kZXJOb2RlXCJdfXQuY2hpbGRyZW49W10sby4kb2JzZXJ2ZShcImZhUGlwZVRvXCIsZnVuY3Rpb24oZSl7dmFyIG49ci4kZXZhbChlKTtuJiZpLnBpcGUobil9KSx0LnJlbmRlck5vZGU9ci4kZXZhbChvLmZhTm9kZSksbi5hZGRSb2xlKFwicmVuZGVyYWJsZVwiLHQpLHQuc2hvdygpLG4uc2VxdWVuY2VXaXRoKHIsZnVuY3Rpb24oZSl7dC5yZW5kZXJOb2RlLmFkZChlLnJlbmRlckdhdGUpLHQuY2hpbGRyZW4ucHVzaChlKX0pfSxwb3N0OmZ1bmN0aW9uKGUscil7dmFyIGE9bi5lbnN1cmVJc29sYXRlKGUpO28oZSxmdW5jdGlvbihlKXtyLmZpbmQoXCJkaXZcIikuYXBwZW5kKGUpfSksbi5yZWdpc3RlckNoaWxkKGUscixhKX19fX19XSksYW5ndWxhci5tb2R1bGUoXCJmYW1vdXMuYW5ndWxhclwiKS5kaXJlY3RpdmUoXCJmYVNjcm9sbFZpZXdcIixbXCIkZmFtb3VzXCIsXCIkZmFtb3VzRGVjb3JhdG9yXCIsZnVuY3Rpb24oZSxuKXtyZXR1cm57dGVtcGxhdGU6XCI8ZGl2PjwvZGl2PlwiLHJlc3RyaWN0OlwiRVwiLHRyYW5zY2x1ZGU6ITAsc2NvcGU6ITAsY29tcGlsZTpmdW5jdGlvbihyLGEsbyl7cmV0dXJue3ByZTpmdW5jdGlvbihyLGEsbyl7dmFyIHQ9bi5lbnN1cmVJc29sYXRlKHIpLGk9ZVtcImZhbW91cy92aWV3cy9TY3JvbGx2aWV3XCJdLHM9ZVtcImZhbW91cy9jb3JlL1ZpZXdTZXF1ZW5jZVwiXSx1PShlW1wiZmFtb3VzL2NvcmUvU3VyZmFjZVwiXSxbXSksYz1yLiRldmFsKG8uZmFPcHRpb25zKXx8e307dC5yZW5kZXJOb2RlPW5ldyBpKGMpLG4uYWRkUm9sZShcInJlbmRlcmFibGVcIix0KSx0LnNob3coKTt2YXIgZj1mdW5jdGlvbihlKXtyLiQkcG9zdERpZ2VzdChmdW5jdGlvbigpe3Uuc29ydChmdW5jdGlvbihlLG4pe3JldHVybiBlLmluZGV4LW4uaW5kZXh9KTt2YXIgbj17YXJyYXk6ZnVuY3Rpb24oZSl7dmFyIG49W107cmV0dXJuIGFuZ3VsYXIuZm9yRWFjaChlLGZ1bmN0aW9uKGUscil7bltyXT1lLnJlbmRlckdhdGV9KSxufSh1KX07ZSYmKG4uaW5kZXg9ci4kZXZhbChvLmZhU3RhcnRJbmRleCkpO3ZhciBhPW5ldyBzKG4pO3QucmVuZGVyTm9kZS5zZXF1ZW5jZUZyb20oYSl9KX07bi5zZXF1ZW5jZVdpdGgocixmdW5jdGlvbihlKXt1LnB1c2goZSksZighMCl9LGZ1bmN0aW9uKGUpe3U9ZnVuY3Rpb24obil7dmFyIHI9W107cmV0dXJuIGFuZ3VsYXIuZm9yRWFjaChuLGZ1bmN0aW9uKG4pe24uaWQhPT1lJiZyLnB1c2gobil9KSxyfSh1KSxmKCl9LGYpfSxwb3N0OmZ1bmN0aW9uKGUscil7dmFyIGE9bi5lbnN1cmVJc29sYXRlKGUpO28oZSxmdW5jdGlvbihlKXtyLmZpbmQoXCJkaXZcIikuYXBwZW5kKGUpfSksbi5yZWdpc3RlckNoaWxkKGUscixhKX19fX19XSksYW5ndWxhci5tb2R1bGUoXCJmYW1vdXMuYW5ndWxhclwiKS5kaXJlY3RpdmUoXCJmYVNlcXVlbnRpYWxMYXlvdXRcIixbXCIkZmFtb3VzXCIsXCIkZmFtb3VzRGVjb3JhdG9yXCIsZnVuY3Rpb24oZSxuKXtyZXR1cm57dGVtcGxhdGU6XCI8ZGl2PjwvZGl2PlwiLHJlc3RyaWN0OlwiRVwiLHRyYW5zY2x1ZGU6ITAsc2NvcGU6ITAsY29tcGlsZTpmdW5jdGlvbihyLGEsbyl7cmV0dXJuIHdpbmRvdy4kZj1lLHtwcmU6ZnVuY3Rpb24ocixhLG8pe3ZhciB0PW4uZW5zdXJlSXNvbGF0ZShyKSxpPWVbXCJmYW1vdXMvdmlld3MvU2VxdWVudGlhbExheW91dFwiXSxzPVtdLHU9ci4kZXZhbChvLmZhT3B0aW9ucyl8fHt9O3QucmVuZGVyTm9kZT1uZXcgaSh1KSxuLmFkZFJvbGUoXCJyZW5kZXJhYmxlXCIsdCksdC5zaG93KCk7dmFyIGM9ZnVuY3Rpb24oKXtzLnNvcnQoZnVuY3Rpb24oZSxuKXtyZXR1cm4gZS5pbmRleC1uLmluZGV4fSksdC5yZW5kZXJOb2RlLnNlcXVlbmNlRnJvbShmdW5jdGlvbihlKXt2YXIgbj1bXTtyZXR1cm4gYW5ndWxhci5mb3JFYWNoKGUsZnVuY3Rpb24oZSxyKXtuW3JdPWUucmVuZGVyR2F0ZX0pLG59KHMpKX07bi5zZXF1ZW5jZVdpdGgocixmdW5jdGlvbihlKXtzLnB1c2goZSksYygpfSxmdW5jdGlvbihlKXtzPWZ1bmN0aW9uKG4pe3ZhciByPVtdO3JldHVybiBhbmd1bGFyLmZvckVhY2gobixmdW5jdGlvbihuKXtuLmlkIT09ZSYmci5wdXNoKG4pfSkscn0ocyksYygpfSl9LHBvc3Q6ZnVuY3Rpb24oZSxyKXt2YXIgYT1uLmVuc3VyZUlzb2xhdGUoZSk7byhlLGZ1bmN0aW9uKGUpe3IuZmluZChcImRpdlwiKS5hcHBlbmQoZSl9KSxuLnJlZ2lzdGVyQ2hpbGQoZSxyLGEpfX19fX1dKSxhbmd1bGFyLm1vZHVsZShcImZhbW91cy5hbmd1bGFyXCIpLmRpcmVjdGl2ZShcImZhU3VyZmFjZVwiLFtcIiRmYW1vdXNcIixcIiRmYW1vdXNEZWNvcmF0b3JcIixcIiRpbnRlcnBvbGF0ZVwiLFwiJGNvbnRyb2xsZXJcIixcIiRjb21waWxlXCIsZnVuY3Rpb24oZSxuKXtyZXR1cm57c2NvcGU6ITAsdHJhbnNjbHVkZTohMCx0ZW1wbGF0ZTonPGRpdiBjbGFzcz1cImZhLXN1cmZhY2VcIj48L2Rpdj4nLHJlc3RyaWN0OlwiRUFcIixjb21waWxlOmZ1bmN0aW9uKHIsYSxvKXtyZXR1cm57cHJlOmZ1bmN0aW9uKHIsYSxvKXt7dmFyIHQ9bi5lbnN1cmVJc29sYXRlKHIpLGk9ZVtcImZhbW91cy9jb3JlL1N1cmZhY2VcIl07ZVtcImZhbW91cy9jb3JlL1RyYW5zZm9ybVwiXSxlW1wiZmFtb3VzL2NvcmUvRXZlbnRIYW5kbGVyXCJdfXIuJHdhdGNoKGZ1bmN0aW9uKCl7cmV0dXJuIHQuZ2V0UHJvcGVydGllcygpfSxmdW5jdGlvbigpe3QucmVuZGVyTm9kZSYmdC5yZW5kZXJOb2RlLnNldFByb3BlcnRpZXModC5nZXRQcm9wZXJ0aWVzKCkpfSwhMCk7dmFyIHM9ZnVuY3Rpb24oZSl7cmV0dXJuXCJmYVwiK2UuY2hhckF0KDApLnRvVXBwZXJDYXNlKCkrZS5zbGljZSgxKX07dC5nZXRQcm9wZXJ0aWVzPWZ1bmN0aW9uKCl7Zm9yKHZhciBlPXIuJGV2YWwoby5mYVByb3BlcnRpZXMpfHx7fSxuPVtcImJhY2tncm91bmRDb2xvclwiLFwibWFyZ2luXCIsXCJwYWRkaW5nXCIsXCJjb2xvclwiLFwicG9pbnRlckV2ZW50c1wiLFwiekluZGV4XCJdLGE9MDthPG4ubGVuZ3RoO2ErKyl7dmFyIHQ9blthXSxpPXModCk7b1tpXSYmKGVbdF09ci4kZXZhbChvW2ldKSl9cmV0dXJuIGV9O3ZhciB1PVtdO28uJG9ic2VydmUoXCJmYVNpemVcIixmdW5jdGlvbigpe3QucmVuZGVyTm9kZS5zZXRTaXplKHIuJGV2YWwoby5mYVNpemUpKSx1LnB1c2gobmV3IERhdGUpLHUubGVuZ3RoPjUmJih1WzRdLXVbMF08PTFlMyYmY29uc29sZS53YXJuKFwiVXNpbmcgZmEtc2l6ZSBvbiBmYS1zdXJmYWNlIHRvIGFuaW1hdGUgaXMgc2lnbmlmaWNhbnRseSBub24tcGVyZm9ybWFudCwgcHJlZmVyIHRvIHVzZSBmYS1zaXplIG9uIGFuIGZhLW1vZGlmaWVyIHN1cnJvdW5kaW5nIGEgZmEtc3VyZmFjZVwiKSx1LnNoaWZ0KCkpfSksdC5yZW5kZXJOb2RlPW5ldyBpKHtzaXplOnIuJGV2YWwoby5mYVNpemUpLHByb3BlcnRpZXM6dC5nZXRQcm9wZXJ0aWVzKCl9KSxuLmFkZFJvbGUoXCJyZW5kZXJhYmxlXCIsdCksdC5zaG93KCksby5jbGFzcyYmdC5yZW5kZXJOb2RlLnNldENsYXNzZXMob1tcImNsYXNzXCJdLnNwbGl0KFwiIFwiKSksbi5zZXF1ZW5jZVdpdGgocixmdW5jdGlvbigpe3Rocm93IG5ldyBFcnJvcihcIlN1cmZhY2VzIGFyZSBsZWFmIG5vZGVzIG9mIHRoZSBGYW1vLnVzIHJlbmRlciB0cmVlIGFuZCBjYW5ub3QgYWNjZXB0IHJlbmRlcm5vZGUgY2hpbGRyZW4uICBUbyBpbmNsdWRlIGFkZGl0aW9uYWwgRmFtby51cyBjb250ZW50IGluc2lkZSBvZiBhIGZhLXN1cmZhY2UsIHRoYXQgY29udGVudCBtdXN0IGJlIGVuY2xvc2VkIGluIGFuIGFkZGl0aW9uYWwgZmEtYXBwLlwiKX0pfSxwb3N0OmZ1bmN0aW9uKGUscil7dmFyIGE9bi5lbnN1cmVJc29sYXRlKGUpLHQ9ZnVuY3Rpb24oKXthLnJlbmRlck5vZGUuc2V0Q29udGVudChyWzBdLnF1ZXJ5U2VsZWN0b3IoXCJkaXYuZmEtc3VyZmFjZVwiKSl9O3QoKSxvKGUsZnVuY3Rpb24oZSl7YW5ndWxhci5lbGVtZW50KHJbMF0ucXVlcnlTZWxlY3RvckFsbChcImRpdi5mYS1zdXJmYWNlXCIpKS5hcHBlbmQoZSl9KSxuLnJlZ2lzdGVyQ2hpbGQoZSxyLGEsZnVuY3Rpb24oKXt9KX19fX19XSksYW5ndWxhci5tb2R1bGUoXCJmYW1vdXMuYW5ndWxhclwiKS5kaXJlY3RpdmUoXCJmYVRhcFwiLFtcIiRwYXJzZVwiLFwiJGZhbW91c0RlY29yYXRvclwiLGZ1bmN0aW9uKGUsbil7cmV0dXJue3Jlc3RyaWN0OlwiQVwiLGNvbXBpbGU6ZnVuY3Rpb24oKXtyZXR1cm57cG9zdDpmdW5jdGlvbihyLGEsbyl7dmFyIHQ9bi5lbnN1cmVJc29sYXRlKHIpO2lmKG8uZmFUYXApe3ZhciBpPXQucmVuZGVyTm9kZS5fZXZlbnRJbnB1dHx8dC5yZW5kZXJOb2RlLHM9ITE7aS5vbihcInRvdWNobW92ZVwiLGZ1bmN0aW9uKGUpe3JldHVybiBzPSEwLGV9KSxpLm9uKFwidGFwXCIsZnVuY3Rpb24obil7aWYoIXMpe3ZhciBhPWUoby5mYVRhcCk7YShyLHskZXZlbnQ6bn0pLHIuJCRwaGFzZXx8ci4kYXBwbHkoKX1zPSExfSl9fX19fX1dKSxhbmd1bGFyLm1vZHVsZShcImZhbW91cy5hbmd1bGFyXCIpLmRpcmVjdGl2ZShcImZhVG91Y2hlbmRcIixbXCIkcGFyc2VcIixcIiRmYW1vdXNEZWNvcmF0b3JcIixmdW5jdGlvbihlLG4pe3JldHVybntyZXN0cmljdDpcIkFcIixzY29wZTohMSxjb21waWxlOmZ1bmN0aW9uKCl7cmV0dXJue3Bvc3Q6ZnVuY3Rpb24ocixhLG8pe3ZhciB0PW4uZW5zdXJlSXNvbGF0ZShyKTtpZihvLmZhVG91Y2hlbmQpe3ZhciBpPXQucmVuZGVyTm9kZS5fZXZlbnRJbnB1dHx8dC5yZW5kZXJOb2RlO2kub24oXCJ0b3VjaGVuZFwiLGZ1bmN0aW9uKG4pe3ZhciBhPWUoby5mYVRvdWNoZW5kKTthKHIseyRldmVudDpufSksci4kJHBoYXNlfHxyLiRhcHBseSgpfSl9fX19fX1dKSxhbmd1bGFyLm1vZHVsZShcImZhbW91cy5hbmd1bGFyXCIpLmRpcmVjdGl2ZShcImZhVG91Y2htb3ZlXCIsW1wiJHBhcnNlXCIsXCIkZmFtb3VzRGVjb3JhdG9yXCIsZnVuY3Rpb24oZSxuKXtyZXR1cm57cmVzdHJpY3Q6XCJBXCIsc2NvcGU6ITEsY29tcGlsZTpmdW5jdGlvbigpe3JldHVybntwb3N0OmZ1bmN0aW9uKHIsYSxvKXt2YXIgdD1uLmVuc3VyZUlzb2xhdGUocik7aWYoby5mYVRvdWNobW92ZSl7dmFyIGk9dC5yZW5kZXJOb2RlLl9ldmVudElucHV0fHx0LnJlbmRlck5vZGU7aS5vbihcInRvdWNobW92ZVwiLGZ1bmN0aW9uKG4pe3ZhciBhPWUoby5mYVRvdWNobW92ZSk7YShyLHskZXZlbnQ6bn0pLHIuJCRwaGFzZXx8ci4kYXBwbHkoKX0pfX19fX19XSksYW5ndWxhci5tb2R1bGUoXCJmYW1vdXMuYW5ndWxhclwiKS5kaXJlY3RpdmUoXCJmYVRvdWNoc3RhcnRcIixbXCIkcGFyc2VcIixcIiRmYW1vdXNEZWNvcmF0b3JcIixmdW5jdGlvbihlLG4pe3JldHVybntyZXN0cmljdDpcIkFcIixzY29wZTohMSxjb21waWxlOmZ1bmN0aW9uKCl7cmV0dXJue3Bvc3Q6ZnVuY3Rpb24ocixhLG8pe3ZhciB0PW4uZW5zdXJlSXNvbGF0ZShyKTtpZihvLmZhVG91Y2hzdGFydCl7dmFyIGk9dC5yZW5kZXJOb2RlLl9ldmVudElucHV0fHx0LnJlbmRlck5vZGU7aS5vbihcInRvdWNoc3RhcnRcIixmdW5jdGlvbihuKXt2YXIgYT1lKG8uZmFUb3VjaHN0YXJ0KTthKHIseyRldmVudDpufSksci4kJHBoYXNlfHxyLiRhcHBseSgpfSl9fX19fX1dKSxhbmd1bGFyLm1vZHVsZShcImZhbW91cy5hbmd1bGFyXCIpLmRpcmVjdGl2ZShcImZhVmlkZW9TdXJmYWNlXCIsW1wiJGZhbW91c1wiLFwiJGZhbW91c0RlY29yYXRvclwiLGZ1bmN0aW9uKGUsbil7cmV0dXJue3Njb3BlOiEwLHRyYW5zY2x1ZGU6ITAsdGVtcGxhdGU6JzxkaXYgY2xhc3M9XCJmYS12aWRlby1zdXJmYWNlXCI+PC9kaXY+JyxyZXN0cmljdDpcIkVBXCIsY29tcGlsZTpmdW5jdGlvbigpe3JldHVybntwcmU6ZnVuY3Rpb24ocixhLG8pe3ZhciB0PW4uZW5zdXJlSXNvbGF0ZShyKSxpPWVbXCJmYW1vdXMvc3VyZmFjZXMvVmlkZW9TdXJmYWNlXCJdO3IuJHdhdGNoKGZ1bmN0aW9uKCl7cmV0dXJuIHIuJGV2YWwoby5mYU9wdGlvbnMpfSxmdW5jdGlvbihlLG4pe3QucmVuZGVyTm9kZS5zZXRPcHRpb25zKG4pfSwhMCksdC5yZW5kZXJOb2RlPW5ldyBpKHtcImNsYXNzXCI6ci4kZXZhbChvLmNsYXNzKX0pLG4uYWRkUm9sZShcInJlbmRlcmFibGVcIix0KSx0LnNob3coKSxvLmNsYXNzJiZ0LnJlbmRlck5vZGUuc2V0Q2xhc3NlcyhvW1wiY2xhc3NcIl0uc3BsaXQoXCIgXCIpKSxuLnNlcXVlbmNlV2l0aChyLGZ1bmN0aW9uKCl7dGhyb3cgbmV3IEVycm9yKFwiU3VyZmFjZXMgYXJlIGxlYWYgbm9kZXMgb2YgdGhlIEZhbW8udXMgcmVuZGVyIHRyZWUgYW5kIGNhbm5vdCBhY2NlcHQgcmVuZGVybm9kZSBjaGlsZHJlbi4gIFRvIGluY2x1ZGUgYWRkaXRpb25hbCBGYW1vLnVzIGNvbnRlbnQgaW5zaWRlIG9mIGEgZmEtc3VyZmFjZSwgdGhhdCBjb250ZW50IG11c3QgYmUgZW5jbG9zZWQgaW4gYW4gYWRkaXRpb25hbCBmYS1hcHAuXCIpfSl9LHBvc3Q6ZnVuY3Rpb24oZSxyLGEpe3ZhciBvPW4uZW5zdXJlSXNvbGF0ZShlKSx0PWZ1bmN0aW9uKCl7by5yZW5kZXJOb2RlLnNldENvbnRlbnQoYS5mYVZpZGVvVXJsKX07dCgpLGEuJG9ic2VydmUoXCJmYVZpZGVvVXJsXCIsdCksbi5yZWdpc3RlckNoaWxkKGUscixvKX19fX19XSksYW5ndWxhci5tb2R1bGUoXCJmYW1vdXMuYW5ndWxhclwiKS5kaXJlY3RpdmUoXCJmYVZpZXdcIixbXCIkZmFtb3VzXCIsXCIkZmFtb3VzRGVjb3JhdG9yXCIsZnVuY3Rpb24oZSxuKXtyZXR1cm57dGVtcGxhdGU6XCI8ZGl2PjwvZGl2PlwiLHRyYW5zY2x1ZGU6ITAsc2NvcGU6ITAscmVzdHJpY3Q6XCJFQVwiLGNvbXBpbGU6ZnVuY3Rpb24ocixhLG8pe3ZhciB0PWVbXCJmYW1vdXMvY29yZS9WaWV3XCJdO3JldHVybntwcmU6ZnVuY3Rpb24oZSxyLGEpe3ZhciBvPW4uZW5zdXJlSXNvbGF0ZShlKTtvLmNoaWxkcmVuPVtdLG8ucmVuZGVyTm9kZT1uZXcgdCh7c2l6ZTplLiRldmFsKGEuZmFTaXplKXx8W3ZvaWQgMCx2b2lkIDBdfSksbi5hZGRSb2xlKFwicmVuZGVyYWJsZVwiLG8pLG8uc2hvdygpLG4uc2VxdWVuY2VXaXRoKGUsZnVuY3Rpb24oZSl7by5yZW5kZXJOb2RlLmFkZChlLnJlbmRlckdhdGUpLG8uY2hpbGRyZW4ucHVzaChlKX0pfSxwb3N0OmZ1bmN0aW9uKGUscil7dmFyIGE9bi5lbnN1cmVJc29sYXRlKGUpO28oZSxmdW5jdGlvbihlKXtyLmZpbmQoXCJkaXZcIikuYXBwZW5kKGUpfSksbi5yZWdpc3RlckNoaWxkKGUscixhKX19fX19XSk7XG59KS5jYWxsKGdsb2JhbCwgbW9kdWxlLCB1bmRlZmluZWQsIHVuZGVmaW5lZCk7XG5cbn0pLmNhbGwodGhpcyx0eXBlb2YgZ2xvYmFsICE9PSBcInVuZGVmaW5lZFwiID8gZ2xvYmFsIDogdHlwZW9mIHNlbGYgIT09IFwidW5kZWZpbmVkXCIgPyBzZWxmIDogdHlwZW9mIHdpbmRvdyAhPT0gXCJ1bmRlZmluZWRcIiA/IHdpbmRvdyA6IHt9KSIsIihmdW5jdGlvbiAoZ2xvYmFsKXtcbjtfX2Jyb3dzZXJpZnlfc2hpbV9yZXF1aXJlX189cmVxdWlyZTsoZnVuY3Rpb24gYnJvd3NlcmlmeVNoaW0obW9kdWxlLCBleHBvcnRzLCByZXF1aXJlLCBkZWZpbmUsIGJyb3dzZXJpZnlfc2hpbV9fZGVmaW5lX19tb2R1bGVfX2V4cG9ydF9fKSB7XG4vKiBUaGlzIFNvdXJjZSBDb2RlIEZvcm0gaXMgc3ViamVjdCB0byB0aGUgdGVybXMgb2YgdGhlIE1vemlsbGEgUHVibGljXG4gKiBMaWNlbnNlLCB2LiAyLjAuIElmIGEgY29weSBvZiB0aGUgTVBMIHdhcyBub3QgZGlzdHJpYnV0ZWQgd2l0aCB0aGlzXG4gKiBmaWxlLCBZb3UgY2FuIG9idGFpbiBvbmUgYXQgaHR0cDovL21vemlsbGEub3JnL01QTC8yLjAvLlxuICpcbiAqIEBjb3B5cmlnaHQgRmFtb3VzIEluZHVzdHJpZXMsIEluYy4gMjAxNFxuICovXG4hZnVuY3Rpb24odCl7aWYoXCJvYmplY3RcIj09dHlwZW9mIGV4cG9ydHMmJlwidW5kZWZpbmVkXCIhPXR5cGVvZiBtb2R1bGUpbW9kdWxlLmV4cG9ydHM9dCgpO2Vsc2UgaWYoXCJmdW5jdGlvblwiPT10eXBlb2YgZGVmaW5lJiZkZWZpbmUuYW1kKWRlZmluZShbXSx0KTtlbHNle3ZhciBpO1widW5kZWZpbmVkXCIhPXR5cGVvZiB3aW5kb3c/aT13aW5kb3c6XCJ1bmRlZmluZWRcIiE9dHlwZW9mIGdsb2JhbD9pPWdsb2JhbDpcInVuZGVmaW5lZFwiIT10eXBlb2Ygc2VsZiYmKGk9c2VsZiksaS5mYW1vdXM9dCgpfX0oZnVuY3Rpb24oKXtyZXR1cm4gZnVuY3Rpb24gdChpLGUsbil7ZnVuY3Rpb24gbyhyLGEpe2lmKCFlW3JdKXtpZighaVtyXSl7dmFyIGg9XCJmdW5jdGlvblwiPT10eXBlb2YgcmVxdWlyZSYmcmVxdWlyZTtpZighYSYmaClyZXR1cm4gaChyLCEwKTtpZihzKXJldHVybiBzKHIsITApO3ZhciBjPW5ldyBFcnJvcihcIkNhbm5vdCBmaW5kIG1vZHVsZSAnXCIrcitcIidcIik7dGhyb3cgYy5jb2RlPVwiTU9EVUxFX05PVF9GT1VORFwiLGN9dmFyIHA9ZVtyXT17ZXhwb3J0czp7fX07aVtyXVswXS5jYWxsKHAuZXhwb3J0cyxmdW5jdGlvbih0KXt2YXIgZT1pW3JdWzFdW3RdO3JldHVybiBvKGU/ZTp0KX0scCxwLmV4cG9ydHMsdCxpLGUsbil9cmV0dXJuIGVbcl0uZXhwb3J0c31mb3IodmFyIHM9XCJmdW5jdGlvblwiPT10eXBlb2YgcmVxdWlyZSYmcmVxdWlyZSxyPTA7cjxuLmxlbmd0aDtyKyspbyhuW3JdKTtyZXR1cm4gb30oezE6W2Z1bmN0aW9uKHQsaSl7ZnVuY3Rpb24gZSh0KXtyZXR1cm5bdC5jbGllbnRXaWR0aCx0LmNsaWVudEhlaWdodF19ZnVuY3Rpb24gbih0KXt0aGlzLmNvbnRhaW5lcj10LHRoaXMuX2FsbG9jYXRvcj1uZXcgcih0KSx0aGlzLl9ub2RlPW5ldyBvLHRoaXMuX2V2ZW50T3V0cHV0PW5ldyBzLHRoaXMuX3NpemU9ZSh0aGlzLmNvbnRhaW5lciksdGhpcy5fcGVyc3BlY3RpdmVTdGF0ZT1uZXcgaCgwKSx0aGlzLl9wZXJzcGVjdGl2ZT12b2lkIDAsdGhpcy5fbm9kZUNvbnRleHQ9e2FsbG9jYXRvcjp0aGlzLl9hbGxvY2F0b3IsdHJhbnNmb3JtOmEuaWRlbnRpdHksb3BhY2l0eToxLG9yaWdpbjpjLGFsaWduOmMsc2l6ZTp0aGlzLl9zaXplfSx0aGlzLl9ldmVudE91dHB1dC5vbihcInJlc2l6ZVwiLGZ1bmN0aW9uKCl7dGhpcy5zZXRTaXplKGUodGhpcy5jb250YWluZXIpKX0uYmluZCh0aGlzKSl9dmFyIG89dChcIi4vUmVuZGVyTm9kZVwiKSxzPXQoXCIuL0V2ZW50SGFuZGxlclwiKSxyPXQoXCIuL0VsZW1lbnRBbGxvY2F0b3JcIiksYT10KFwiLi9UcmFuc2Zvcm1cIiksaD10KFwiLi4vdHJhbnNpdGlvbnMvVHJhbnNpdGlvbmFibGVcIiksYz1bMCwwXSxwPSEoXCJwZXJzcGVjdGl2ZVwiaW4gZG9jdW1lbnQuZG9jdW1lbnRFbGVtZW50LnN0eWxlKSx1PXA/ZnVuY3Rpb24odCxpKXt0LnN0eWxlLndlYmtpdFBlcnNwZWN0aXZlPWk/aS50b0ZpeGVkKCkrXCJweFwiOlwiXCJ9OmZ1bmN0aW9uKHQsaSl7dC5zdHlsZS5wZXJzcGVjdGl2ZT1pP2kudG9GaXhlZCgpK1wicHhcIjpcIlwifTtuLnByb3RvdHlwZS5nZXRBbGxvY2F0b3I9ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5fYWxsb2NhdG9yfSxuLnByb3RvdHlwZS5hZGQ9ZnVuY3Rpb24odCl7cmV0dXJuIHRoaXMuX25vZGUuYWRkKHQpfSxuLnByb3RvdHlwZS5taWdyYXRlPWZ1bmN0aW9uKHQpe3QhPT10aGlzLmNvbnRhaW5lciYmKHRoaXMuY29udGFpbmVyPXQsdGhpcy5fYWxsb2NhdG9yLm1pZ3JhdGUodCkpfSxuLnByb3RvdHlwZS5nZXRTaXplPWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuX3NpemV9LG4ucHJvdG90eXBlLnNldFNpemU9ZnVuY3Rpb24odCl7dHx8KHQ9ZSh0aGlzLmNvbnRhaW5lcikpLHRoaXMuX3NpemVbMF09dFswXSx0aGlzLl9zaXplWzFdPXRbMV19LG4ucHJvdG90eXBlLnVwZGF0ZT1mdW5jdGlvbih0KXt0JiYodC50cmFuc2Zvcm0mJih0aGlzLl9ub2RlQ29udGV4dC50cmFuc2Zvcm09dC50cmFuc2Zvcm0pLHQub3BhY2l0eSYmKHRoaXMuX25vZGVDb250ZXh0Lm9wYWNpdHk9dC5vcGFjaXR5KSx0Lm9yaWdpbiYmKHRoaXMuX25vZGVDb250ZXh0Lm9yaWdpbj10Lm9yaWdpbiksdC5hbGlnbiYmKHRoaXMuX25vZGVDb250ZXh0LmFsaWduPXQuYWxpZ24pLHQuc2l6ZSYmKHRoaXMuX25vZGVDb250ZXh0LnNpemU9dC5zaXplKSk7dmFyIGk9dGhpcy5fcGVyc3BlY3RpdmVTdGF0ZS5nZXQoKTtpIT09dGhpcy5fcGVyc3BlY3RpdmUmJih1KHRoaXMuY29udGFpbmVyLGkpLHRoaXMuX3BlcnNwZWN0aXZlPWkpLHRoaXMuX25vZGUuY29tbWl0KHRoaXMuX25vZGVDb250ZXh0KX0sbi5wcm90b3R5cGUuZ2V0UGVyc3BlY3RpdmU9ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5fcGVyc3BlY3RpdmVTdGF0ZS5nZXQoKX0sbi5wcm90b3R5cGUuc2V0UGVyc3BlY3RpdmU9ZnVuY3Rpb24odCxpLGUpe3JldHVybiB0aGlzLl9wZXJzcGVjdGl2ZVN0YXRlLnNldCh0LGksZSl9LG4ucHJvdG90eXBlLmVtaXQ9ZnVuY3Rpb24odCxpKXtyZXR1cm4gdGhpcy5fZXZlbnRPdXRwdXQuZW1pdCh0LGkpfSxuLnByb3RvdHlwZS5vbj1mdW5jdGlvbih0LGkpe3JldHVybiB0aGlzLl9ldmVudE91dHB1dC5vbih0LGkpfSxuLnByb3RvdHlwZS5yZW1vdmVMaXN0ZW5lcj1mdW5jdGlvbih0LGkpe3JldHVybiB0aGlzLl9ldmVudE91dHB1dC5yZW1vdmVMaXN0ZW5lcih0LGkpfSxuLnByb3RvdHlwZS5waXBlPWZ1bmN0aW9uKHQpe3JldHVybiB0aGlzLl9ldmVudE91dHB1dC5waXBlKHQpfSxuLnByb3RvdHlwZS51bnBpcGU9ZnVuY3Rpb24odCl7cmV0dXJuIHRoaXMuX2V2ZW50T3V0cHV0LnVucGlwZSh0KX0saS5leHBvcnRzPW59LHtcIi4uL3RyYW5zaXRpb25zL1RyYW5zaXRpb25hYmxlXCI6ODgsXCIuL0VsZW1lbnRBbGxvY2F0b3JcIjoyLFwiLi9FdmVudEhhbmRsZXJcIjo3LFwiLi9SZW5kZXJOb2RlXCI6MTEsXCIuL1RyYW5zZm9ybVwiOjE1fV0sMjpbZnVuY3Rpb24odCxpKXtmdW5jdGlvbiBlKHQpe3R8fCh0PWRvY3VtZW50LmNyZWF0ZURvY3VtZW50RnJhZ21lbnQoKSksdGhpcy5jb250YWluZXI9dCx0aGlzLmRldGFjaGVkTm9kZXM9e30sdGhpcy5ub2RlQ291bnQ9MH1lLnByb3RvdHlwZS5taWdyYXRlPWZ1bmN0aW9uKHQpe3ZhciBpPXRoaXMuY29udGFpbmVyO2lmKHQhPT1pKXtpZihpIGluc3RhbmNlb2YgRG9jdW1lbnRGcmFnbWVudCl0LmFwcGVuZENoaWxkKGkpO2Vsc2UgZm9yKDtpLmhhc0NoaWxkTm9kZXMoKTspdC5hcHBlbmRDaGlsZChpLnJlbW92ZUNoaWxkKGkuZmlyc3RDaGlsZCkpO3RoaXMuY29udGFpbmVyPXR9fSxlLnByb3RvdHlwZS5hbGxvY2F0ZT1mdW5jdGlvbih0KXt0PXQudG9Mb3dlckNhc2UoKSx0IGluIHRoaXMuZGV0YWNoZWROb2Rlc3x8KHRoaXMuZGV0YWNoZWROb2Rlc1t0XT1bXSk7dmFyIGksZT10aGlzLmRldGFjaGVkTm9kZXNbdF07cmV0dXJuIGUubGVuZ3RoPjA/aT1lLnBvcCgpOihpPWRvY3VtZW50LmNyZWF0ZUVsZW1lbnQodCksdGhpcy5jb250YWluZXIuYXBwZW5kQ2hpbGQoaSkpLHRoaXMubm9kZUNvdW50KyssaX0sZS5wcm90b3R5cGUuZGVhbGxvY2F0ZT1mdW5jdGlvbih0KXt2YXIgaT10Lm5vZGVOYW1lLnRvTG93ZXJDYXNlKCksZT10aGlzLmRldGFjaGVkTm9kZXNbaV07ZS5wdXNoKHQpLHRoaXMubm9kZUNvdW50LS19LGUucHJvdG90eXBlLmdldE5vZGVDb3VudD1mdW5jdGlvbigpe3JldHVybiB0aGlzLm5vZGVDb3VudH0saS5leHBvcnRzPWV9LHt9XSwzOltmdW5jdGlvbih0LGkpe2Z1bmN0aW9uIGUodCl7dGhpcy5fbWF0cml4PW51bGwsdGhpcy5fb3BhY2l0eT0xLHRoaXMuX29yaWdpbj1udWxsLHRoaXMuX3NpemU9bnVsbCx0aGlzLl9ldmVudE91dHB1dD1uZXcgYyx0aGlzLl9ldmVudE91dHB1dC5iaW5kVGhpcyh0aGlzKSx0aGlzLmV2ZW50Rm9yd2FyZGVyPWZ1bmN0aW9uKHQpe3RoaXMuX2V2ZW50T3V0cHV0LmVtaXQodC50eXBlLHQpfS5iaW5kKHRoaXMpLHRoaXMuaWQ9aC5yZWdpc3Rlcih0aGlzKSx0aGlzLl9lbGVtZW50PW51bGwsdGhpcy5fc2l6ZURpcnR5PSExLHRoaXMuX29yaWdpbkRpcnR5PSExLHRoaXMuX3RyYW5zZm9ybURpcnR5PSExLHRoaXMuX2ludmlzaWJsZT0hMSx0JiZ0aGlzLmF0dGFjaCh0KX1mdW5jdGlvbiBuKHQpe2Zvcih2YXIgaSBpbiB0aGlzLl9ldmVudE91dHB1dC5saXN0ZW5lcnMpdC5hZGRFdmVudExpc3RlbmVyKGksdGhpcy5ldmVudEZvcndhcmRlcil9ZnVuY3Rpb24gbyh0KXtmb3IodmFyIGkgaW4gdGhpcy5fZXZlbnRPdXRwdXQubGlzdGVuZXJzKXQucmVtb3ZlRXZlbnRMaXN0ZW5lcihpLHRoaXMuZXZlbnRGb3J3YXJkZXIpfWZ1bmN0aW9uIHModCl7dFsxMl09TWF0aC5yb3VuZCh0WzEyXSpsKS9sLHRbMTNdPU1hdGgucm91bmQodFsxM10qbCkvbDtmb3IodmFyIGk9XCJtYXRyaXgzZChcIixlPTA7MTU+ZTtlKyspaSs9dFtlXTwxZS02JiZ0W2VdPi0xZS02P1wiMCxcIjp0W2VdK1wiLFwiO3JldHVybiBpKz10WzE1XStcIilcIn1mdW5jdGlvbiByKHQpe3JldHVybiAxMDAqdFswXStcIiUgXCIrMTAwKnRbMV0rXCIlXCJ9ZnVuY3Rpb24gYSh0LGkpe3JldHVybiB0JiZpP3RbMF0hPT1pWzBdfHx0WzFdIT09aVsxXTp0IT09aX12YXIgaD10KFwiLi9FbnRpdHlcIiksYz10KFwiLi9FdmVudEhhbmRsZXJcIikscD10KFwiLi9UcmFuc2Zvcm1cIiksdT0hKFwidHJhbnNmb3JtXCJpbiBkb2N1bWVudC5kb2N1bWVudEVsZW1lbnQuc3R5bGUpLGw9d2luZG93LmRldmljZVBpeGVsUmF0aW98fDE7ZS5wcm90b3R5cGUub249ZnVuY3Rpb24odCxpKXt0aGlzLl9lbGVtZW50JiZ0aGlzLl9lbGVtZW50LmFkZEV2ZW50TGlzdGVuZXIodCx0aGlzLmV2ZW50Rm9yd2FyZGVyKSx0aGlzLl9ldmVudE91dHB1dC5vbih0LGkpfSxlLnByb3RvdHlwZS5yZW1vdmVMaXN0ZW5lcj1mdW5jdGlvbih0LGkpe3RoaXMuX2V2ZW50T3V0cHV0LnJlbW92ZUxpc3RlbmVyKHQsaSl9LGUucHJvdG90eXBlLmVtaXQ9ZnVuY3Rpb24odCxpKXtpJiYhaS5vcmlnaW4mJihpLm9yaWdpbj10aGlzKTt2YXIgZT10aGlzLl9ldmVudE91dHB1dC5lbWl0KHQsaSk7cmV0dXJuIGUmJmkmJmkuc3RvcFByb3BhZ2F0aW9uJiZpLnN0b3BQcm9wYWdhdGlvbigpLGV9LGUucHJvdG90eXBlLnBpcGU9ZnVuY3Rpb24odCl7cmV0dXJuIHRoaXMuX2V2ZW50T3V0cHV0LnBpcGUodCl9LGUucHJvdG90eXBlLnVucGlwZT1mdW5jdGlvbih0KXtyZXR1cm4gdGhpcy5fZXZlbnRPdXRwdXQudW5waXBlKHQpfSxlLnByb3RvdHlwZS5yZW5kZXI9ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5pZH07dmFyIGY7Zj1uYXZpZ2F0b3IudXNlckFnZW50LnRvTG93ZXJDYXNlKCkuaW5kZXhPZihcImZpcmVmb3hcIik+LTE/ZnVuY3Rpb24odCxpKXt0LnN0eWxlLnpJbmRleD0xZTYqaVsxNF18MCx0LnN0eWxlLnRyYW5zZm9ybT1zKGkpfTp1P2Z1bmN0aW9uKHQsaSl7dC5zdHlsZS53ZWJraXRUcmFuc2Zvcm09cyhpKX06ZnVuY3Rpb24odCxpKXt0LnN0eWxlLnRyYW5zZm9ybT1zKGkpfTt2YXIgZD11P2Z1bmN0aW9uKHQsaSl7dC5zdHlsZS53ZWJraXRUcmFuc2Zvcm1PcmlnaW49cihpKX06ZnVuY3Rpb24odCxpKXt0LnN0eWxlLnRyYW5zZm9ybU9yaWdpbj1yKGkpfSxfPXU/ZnVuY3Rpb24odCl7dC5zdHlsZS53ZWJraXRUcmFuc2Zvcm09XCJzY2FsZTNkKDAuMDAwMSwwLjAwMDEsMC4wMDAxKVwiLHQuc3R5bGUub3BhY2l0eT0wfTpmdW5jdGlvbih0KXt0LnN0eWxlLnRyYW5zZm9ybT1cInNjYWxlM2QoMC4wMDAxLDAuMDAwMSwwLjAwMDEpXCIsdC5zdHlsZS5vcGFjaXR5PTB9O2UucHJvdG90eXBlLmNvbW1pdD1mdW5jdGlvbih0KXt2YXIgaT10aGlzLl9lbGVtZW50O2lmKGkpe3t2YXIgZT10LnRyYW5zZm9ybSxuPXQub3BhY2l0eSxvPXQub3JpZ2luO3Quc2l6ZX1pZighZSYmdGhpcy5fbWF0cml4KXJldHVybiB0aGlzLl9tYXRyaXg9bnVsbCx0aGlzLl9vcGFjaXR5PTAsdm9pZCBfKGkpO2lmKGEodGhpcy5fb3JpZ2luLG8pJiYodGhpcy5fb3JpZ2luRGlydHk9ITApLHAubm90RXF1YWxzKHRoaXMuX21hdHJpeCxlKSYmKHRoaXMuX3RyYW5zZm9ybURpcnR5PSEwKSx0aGlzLl9pbnZpc2libGUmJih0aGlzLl9pbnZpc2libGU9ITEsdGhpcy5fZWxlbWVudC5zdHlsZS5kaXNwbGF5PVwiXCIpLHRoaXMuX29wYWNpdHkhPT1uJiYodGhpcy5fb3BhY2l0eT1uLGkuc3R5bGUub3BhY2l0eT1uPj0xP1wiMC45OTk5OTlcIjpuKSx0aGlzLl90cmFuc2Zvcm1EaXJ0eXx8dGhpcy5fb3JpZ2luRGlydHl8fHRoaXMuX3NpemVEaXJ0eSl7dGhpcy5fc2l6ZURpcnR5JiYodGhpcy5fc2l6ZURpcnR5PSExKSx0aGlzLl9vcmlnaW5EaXJ0eSYmKG8/KHRoaXMuX29yaWdpbnx8KHRoaXMuX29yaWdpbj1bMCwwXSksdGhpcy5fb3JpZ2luWzBdPW9bMF0sdGhpcy5fb3JpZ2luWzFdPW9bMV0pOnRoaXMuX29yaWdpbj1udWxsLGQoaSx0aGlzLl9vcmlnaW4pLHRoaXMuX29yaWdpbkRpcnR5PSExKSxlfHwoZT1wLmlkZW50aXR5KSx0aGlzLl9tYXRyaXg9ZTt2YXIgcz10aGlzLl9zaXplP3AudGhlbk1vdmUoZSxbLXRoaXMuX3NpemVbMF0qb1swXSwtdGhpcy5fc2l6ZVsxXSpvWzFdLDBdKTplO2YoaSxzKSx0aGlzLl90cmFuc2Zvcm1EaXJ0eT0hMX19fSxlLnByb3RvdHlwZS5jbGVhbnVwPWZ1bmN0aW9uKCl7dGhpcy5fZWxlbWVudCYmKHRoaXMuX2ludmlzaWJsZT0hMCx0aGlzLl9lbGVtZW50LnN0eWxlLmRpc3BsYXk9XCJub25lXCIpfSxlLnByb3RvdHlwZS5hdHRhY2g9ZnVuY3Rpb24odCl7dGhpcy5fZWxlbWVudD10LG4uY2FsbCh0aGlzLHQpfSxlLnByb3RvdHlwZS5kZXRhY2g9ZnVuY3Rpb24oKXt2YXIgdD10aGlzLl9lbGVtZW50O3JldHVybiB0JiYoby5jYWxsKHRoaXMsdCksdGhpcy5faW52aXNpYmxlJiYodGhpcy5faW52aXNpYmxlPSExLHRoaXMuX2VsZW1lbnQuc3R5bGUuZGlzcGxheT1cIlwiKSksdGhpcy5fZWxlbWVudD1udWxsLHR9LGkuZXhwb3J0cz1lfSx7XCIuL0VudGl0eVwiOjUsXCIuL0V2ZW50SGFuZGxlclwiOjcsXCIuL1RyYW5zZm9ybVwiOjE1fV0sNDpbZnVuY3Rpb24odCxpKXtmdW5jdGlvbiBlKCl7di5ydW5Mb29wPyhwLnN0ZXAoKSx3aW5kb3cucmVxdWVzdEFuaW1hdGlvbkZyYW1lKGUpKTpfPSExfWZ1bmN0aW9uIG4oKXtmb3IodmFyIHQ9MDt0PHUubGVuZ3RoO3QrKyl1W3RdLmVtaXQoXCJyZXNpemVcIik7Zy5lbWl0KFwicmVzaXplXCIpfWZ1bmN0aW9uIG8oKXt3aW5kb3cuYWRkRXZlbnRMaXN0ZW5lcihcInRvdWNobW92ZVwiLGZ1bmN0aW9uKHQpe3QucHJldmVudERlZmF1bHQoKX0sITApLGRvY3VtZW50LmJvZHkuY2xhc3NMaXN0LmFkZChcImZhbW91cy1yb290XCIpLGRvY3VtZW50LmRvY3VtZW50RWxlbWVudC5jbGFzc0xpc3QuYWRkKFwiZmFtb3VzLXJvb3RcIil9dmFyIHMscixhPXQoXCIuL0NvbnRleHRcIiksaD10KFwiLi9FdmVudEhhbmRsZXJcIiksYz10KFwiLi9PcHRpb25zTWFuYWdlclwiKSxwPXt9LHU9W10sbD1bXSxmPVtdLGQ9RGF0ZS5ub3coKSxfPSEwLHk9e30sZz1uZXcgaCx2PXtjb250YWluZXJUeXBlOlwiZGl2XCIsY29udGFpbmVyQ2xhc3M6XCJmYW1vdXMtY29udGFpbmVyXCIsZnBzQ2FwOnZvaWQgMCxydW5Mb29wOiEwLGFwcE1vZGU6ITB9LG09bmV3IGModiksTz0xMDtwLnN0ZXA9ZnVuY3Rpb24oKXt2YXIgdD1EYXRlLm5vdygpO2lmKCEociYmcj50LWQpKXt2YXIgaT0wO2ZvcihzPXQtZCxkPXQsZy5lbWl0KFwicHJlcmVuZGVyXCIpLGk9MDtpPGwubGVuZ3RoO2krKylsW2ldLmNhbGwodGhpcyk7Zm9yKGwuc3BsaWNlKDApO2YubGVuZ3RoJiZEYXRlLm5vdygpLXQ8TzspZi5zaGlmdCgpLmNhbGwodGhpcyk7Zm9yKGk9MDtpPHUubGVuZ3RoO2krKyl1W2ldLnVwZGF0ZSgpO2cuZW1pdChcInBvc3RyZW5kZXJcIil9fSx3aW5kb3cucmVxdWVzdEFuaW1hdGlvbkZyYW1lKGUpLHdpbmRvdy5hZGRFdmVudExpc3RlbmVyKFwicmVzaXplXCIsbiwhMSksbigpO3ZhciBTPSExO3AucGlwZT1mdW5jdGlvbih0KXtyZXR1cm4gdC5zdWJzY3JpYmUgaW5zdGFuY2VvZiBGdW5jdGlvbj90LnN1YnNjcmliZShwKTpnLnBpcGUodCl9LHAudW5waXBlPWZ1bmN0aW9uKHQpe3JldHVybiB0LnVuc3Vic2NyaWJlIGluc3RhbmNlb2YgRnVuY3Rpb24/dC51bnN1YnNjcmliZShwKTpnLnVucGlwZSh0KX0scC5vbj1mdW5jdGlvbih0LGkpe3JldHVybiB0IGluIHl8fCh5W3RdPWcuZW1pdC5iaW5kKGcsdCksZG9jdW1lbnQuYm9keT9kb2N1bWVudC5ib2R5LmFkZEV2ZW50TGlzdGVuZXIodCx5W3RdKTpwLm5leHRUaWNrKGZ1bmN0aW9uKHQsaSl7ZG9jdW1lbnQuYm9keS5hZGRFdmVudExpc3RlbmVyKHQsaSl9LmJpbmQodGhpcyx0LHlbdF0pKSksZy5vbih0LGkpfSxwLmVtaXQ9ZnVuY3Rpb24odCxpKXtyZXR1cm4gZy5lbWl0KHQsaSl9LHAucmVtb3ZlTGlzdGVuZXI9ZnVuY3Rpb24odCxpKXtyZXR1cm4gZy5yZW1vdmVMaXN0ZW5lcih0LGkpfSxwLmdldEZQUz1mdW5jdGlvbigpe3JldHVybiAxZTMvc30scC5zZXRGUFNDYXA9ZnVuY3Rpb24odCl7cj1NYXRoLmZsb29yKDFlMy90KX0scC5nZXRPcHRpb25zPWZ1bmN0aW9uKHQpe3JldHVybiBtLmdldE9wdGlvbnModCl9LHAuc2V0T3B0aW9ucz1mdW5jdGlvbigpe3JldHVybiBtLnNldE9wdGlvbnMuYXBwbHkobSxhcmd1bWVudHMpfSxwLmNyZWF0ZUNvbnRleHQ9ZnVuY3Rpb24odCl7IVMmJnYuYXBwTW9kZSYmcC5uZXh0VGljayhvKTt2YXIgaT0hMTt0fHwodD1kb2N1bWVudC5jcmVhdGVFbGVtZW50KHYuY29udGFpbmVyVHlwZSksdC5jbGFzc0xpc3QuYWRkKHYuY29udGFpbmVyQ2xhc3MpLGk9ITApO3ZhciBlPW5ldyBhKHQpO3JldHVybiBwLnJlZ2lzdGVyQ29udGV4dChlKSxpJiZwLm5leHRUaWNrKGZ1bmN0aW9uKHQsaSl7ZG9jdW1lbnQuYm9keS5hcHBlbmRDaGlsZChpKSx0LmVtaXQoXCJyZXNpemVcIil9LmJpbmQodGhpcyxlLHQpKSxlfSxwLnJlZ2lzdGVyQ29udGV4dD1mdW5jdGlvbih0KXtyZXR1cm4gdS5wdXNoKHQpLHR9LHAuZ2V0Q29udGV4dHM9ZnVuY3Rpb24oKXtyZXR1cm4gdX0scC5kZXJlZ2lzdGVyQ29udGV4dD1mdW5jdGlvbih0KXt2YXIgaT11LmluZGV4T2YodCk7aT49MCYmdS5zcGxpY2UoaSwxKX0scC5uZXh0VGljaz1mdW5jdGlvbih0KXtsLnB1c2godCl9LHAuZGVmZXI9ZnVuY3Rpb24odCl7Zi5wdXNoKHQpfSxtLm9uKFwiY2hhbmdlXCIsZnVuY3Rpb24odCl7XCJmcHNDYXBcIj09PXQuaWQ/cC5zZXRGUFNDYXAodC52YWx1ZSk6XCJydW5Mb29wXCI9PT10LmlkJiYhXyYmdC52YWx1ZSYmKF89ITAsd2luZG93LnJlcXVlc3RBbmltYXRpb25GcmFtZShlKSl9KSxpLmV4cG9ydHM9cH0se1wiLi9Db250ZXh0XCI6MSxcIi4vRXZlbnRIYW5kbGVyXCI6NyxcIi4vT3B0aW9uc01hbmFnZXJcIjoxMH1dLDU6W2Z1bmN0aW9uKHQsaSl7ZnVuY3Rpb24gZSh0KXtyZXR1cm4gclt0XX1mdW5jdGlvbiBuKHQsaSl7clt0XT1pfWZ1bmN0aW9uIG8odCl7dmFyIGk9ci5sZW5ndGg7cmV0dXJuIG4oaSx0KSxpfWZ1bmN0aW9uIHModCl7bih0LG51bGwpfXZhciByPVtdO2kuZXhwb3J0cz17cmVnaXN0ZXI6byx1bnJlZ2lzdGVyOnMsZ2V0OmUsc2V0Om59fSx7fV0sNjpbZnVuY3Rpb24odCxpKXtmdW5jdGlvbiBlKCl7dGhpcy5saXN0ZW5lcnM9e30sdGhpcy5fb3duZXI9dGhpc31lLnByb3RvdHlwZS5lbWl0PWZ1bmN0aW9uKHQsaSl7dmFyIGU9dGhpcy5saXN0ZW5lcnNbdF07aWYoZSlmb3IodmFyIG49MDtuPGUubGVuZ3RoO24rKyllW25dLmNhbGwodGhpcy5fb3duZXIsaSk7cmV0dXJuIHRoaXN9LGUucHJvdG90eXBlLm9uPWZ1bmN0aW9uKHQsaSl7dCBpbiB0aGlzLmxpc3RlbmVyc3x8KHRoaXMubGlzdGVuZXJzW3RdPVtdKTt2YXIgZT10aGlzLmxpc3RlbmVyc1t0XS5pbmRleE9mKGkpO3JldHVybiAwPmUmJnRoaXMubGlzdGVuZXJzW3RdLnB1c2goaSksdGhpc30sZS5wcm90b3R5cGUuYWRkTGlzdGVuZXI9ZS5wcm90b3R5cGUub24sZS5wcm90b3R5cGUucmVtb3ZlTGlzdGVuZXI9ZnVuY3Rpb24odCxpKXt2YXIgZT10aGlzLmxpc3RlbmVyc1t0XTtpZih2b2lkIDAhPT1lKXt2YXIgbj1lLmluZGV4T2YoaSk7bj49MCYmZS5zcGxpY2UobiwxKX1yZXR1cm4gdGhpc30sZS5wcm90b3R5cGUuYmluZFRoaXM9ZnVuY3Rpb24odCl7dGhpcy5fb3duZXI9dH0saS5leHBvcnRzPWV9LHt9XSw3OltmdW5jdGlvbih0LGkpe2Z1bmN0aW9uIGUoKXtuLmFwcGx5KHRoaXMsYXJndW1lbnRzKSx0aGlzLmRvd25zdHJlYW09W10sdGhpcy5kb3duc3RyZWFtRm49W10sdGhpcy51cHN0cmVhbT1bXSx0aGlzLnVwc3RyZWFtTGlzdGVuZXJzPXt9fXZhciBuPXQoXCIuL0V2ZW50RW1pdHRlclwiKTtlLnByb3RvdHlwZT1PYmplY3QuY3JlYXRlKG4ucHJvdG90eXBlKSxlLnByb3RvdHlwZS5jb25zdHJ1Y3Rvcj1lLGUuc2V0SW5wdXRIYW5kbGVyPWZ1bmN0aW9uKHQsaSl7dC50cmlnZ2VyPWkudHJpZ2dlci5iaW5kKGkpLGkuc3Vic2NyaWJlJiZpLnVuc3Vic2NyaWJlJiYodC5zdWJzY3JpYmU9aS5zdWJzY3JpYmUuYmluZChpKSx0LnVuc3Vic2NyaWJlPWkudW5zdWJzY3JpYmUuYmluZChpKSl9LGUuc2V0T3V0cHV0SGFuZGxlcj1mdW5jdGlvbih0LGkpe2kgaW5zdGFuY2VvZiBlJiZpLmJpbmRUaGlzKHQpLHQucGlwZT1pLnBpcGUuYmluZChpKSx0LnVucGlwZT1pLnVucGlwZS5iaW5kKGkpLHQub249aS5vbi5iaW5kKGkpLHQuYWRkTGlzdGVuZXI9dC5vbix0LnJlbW92ZUxpc3RlbmVyPWkucmVtb3ZlTGlzdGVuZXIuYmluZChpKX0sZS5wcm90b3R5cGUuZW1pdD1mdW5jdGlvbih0LGkpe24ucHJvdG90eXBlLmVtaXQuYXBwbHkodGhpcyxhcmd1bWVudHMpO3ZhciBlPTA7Zm9yKGU9MDtlPHRoaXMuZG93bnN0cmVhbS5sZW5ndGg7ZSsrKXRoaXMuZG93bnN0cmVhbVtlXS50cmlnZ2VyJiZ0aGlzLmRvd25zdHJlYW1bZV0udHJpZ2dlcih0LGkpO2ZvcihlPTA7ZTx0aGlzLmRvd25zdHJlYW1Gbi5sZW5ndGg7ZSsrKXRoaXMuZG93bnN0cmVhbUZuW2VdKHQsaSk7cmV0dXJuIHRoaXN9LGUucHJvdG90eXBlLnRyaWdnZXI9ZS5wcm90b3R5cGUuZW1pdCxlLnByb3RvdHlwZS5waXBlPWZ1bmN0aW9uKHQpe2lmKHQuc3Vic2NyaWJlIGluc3RhbmNlb2YgRnVuY3Rpb24pcmV0dXJuIHQuc3Vic2NyaWJlKHRoaXMpO3ZhciBpPXQgaW5zdGFuY2VvZiBGdW5jdGlvbj90aGlzLmRvd25zdHJlYW1Gbjp0aGlzLmRvd25zdHJlYW0sZT1pLmluZGV4T2YodCk7cmV0dXJuIDA+ZSYmaS5wdXNoKHQpLHQgaW5zdGFuY2VvZiBGdW5jdGlvbj90KFwicGlwZVwiLG51bGwpOnQudHJpZ2dlciYmdC50cmlnZ2VyKFwicGlwZVwiLG51bGwpLHR9LGUucHJvdG90eXBlLnVucGlwZT1mdW5jdGlvbih0KXtpZih0LnVuc3Vic2NyaWJlIGluc3RhbmNlb2YgRnVuY3Rpb24pcmV0dXJuIHQudW5zdWJzY3JpYmUodGhpcyk7dmFyIGk9dCBpbnN0YW5jZW9mIEZ1bmN0aW9uP3RoaXMuZG93bnN0cmVhbUZuOnRoaXMuZG93bnN0cmVhbSxlPWkuaW5kZXhPZih0KTtyZXR1cm4gZT49MD8oaS5zcGxpY2UoZSwxKSx0IGluc3RhbmNlb2YgRnVuY3Rpb24/dChcInVucGlwZVwiLG51bGwpOnQudHJpZ2dlciYmdC50cmlnZ2VyKFwidW5waXBlXCIsbnVsbCksdCk6ITF9LGUucHJvdG90eXBlLm9uPWZ1bmN0aW9uKHQpe2lmKG4ucHJvdG90eXBlLm9uLmFwcGx5KHRoaXMsYXJndW1lbnRzKSwhKHQgaW4gdGhpcy51cHN0cmVhbUxpc3RlbmVycykpe3ZhciBpPXRoaXMudHJpZ2dlci5iaW5kKHRoaXMsdCk7dGhpcy51cHN0cmVhbUxpc3RlbmVyc1t0XT1pO2Zvcih2YXIgZT0wO2U8dGhpcy51cHN0cmVhbS5sZW5ndGg7ZSsrKXRoaXMudXBzdHJlYW1bZV0ub24odCxpKX1yZXR1cm4gdGhpc30sZS5wcm90b3R5cGUuYWRkTGlzdGVuZXI9ZS5wcm90b3R5cGUub24sZS5wcm90b3R5cGUuc3Vic2NyaWJlPWZ1bmN0aW9uKHQpe3ZhciBpPXRoaXMudXBzdHJlYW0uaW5kZXhPZih0KTtpZigwPmkpe3RoaXMudXBzdHJlYW0ucHVzaCh0KTtmb3IodmFyIGUgaW4gdGhpcy51cHN0cmVhbUxpc3RlbmVycyl0Lm9uKGUsdGhpcy51cHN0cmVhbUxpc3RlbmVyc1tlXSl9cmV0dXJuIHRoaXN9LGUucHJvdG90eXBlLnVuc3Vic2NyaWJlPWZ1bmN0aW9uKHQpe3ZhciBpPXRoaXMudXBzdHJlYW0uaW5kZXhPZih0KTtpZihpPj0wKXt0aGlzLnVwc3RyZWFtLnNwbGljZShpLDEpO2Zvcih2YXIgZSBpbiB0aGlzLnVwc3RyZWFtTGlzdGVuZXJzKXQucmVtb3ZlTGlzdGVuZXIoZSx0aGlzLnVwc3RyZWFtTGlzdGVuZXJzW2VdKX1yZXR1cm4gdGhpc30saS5leHBvcnRzPWV9LHtcIi4vRXZlbnRFbWl0dGVyXCI6Nn1dLDg6W2Z1bmN0aW9uKHQsaSl7ZnVuY3Rpb24gZSh0KXtzLmNhbGwodGhpcyx0KSx0aGlzLl9zaG91bGRSZWNhbGN1bGF0ZVNpemU9ITEsdGhpcy5fY29udGFpbmVyPWRvY3VtZW50LmNyZWF0ZURvY3VtZW50RnJhZ21lbnQoKSx0aGlzLmNvbnRleHQ9bmV3IG4odGhpcy5fY29udGFpbmVyKSx0aGlzLnNldENvbnRlbnQodGhpcy5fY29udGFpbmVyKSx0aGlzLl9ncm91cFNpemU9W3ZvaWQgMCx2b2lkIDBdfXZhciBuPXQoXCIuL0NvbnRleHRcIiksbz10KFwiLi9UcmFuc2Zvcm1cIikscz10KFwiLi9TdXJmYWNlXCIpO2UuU0laRV9aRVJPPVswLDBdLGUucHJvdG90eXBlPU9iamVjdC5jcmVhdGUocy5wcm90b3R5cGUpLGUucHJvdG90eXBlLmVsZW1lbnRUeXBlPVwiZGl2XCIsZS5wcm90b3R5cGUuZWxlbWVudENsYXNzPVwiZmFtb3VzLWdyb3VwXCIsZS5wcm90b3R5cGUuYWRkPWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuY29udGV4dC5hZGQuYXBwbHkodGhpcy5jb250ZXh0LGFyZ3VtZW50cyl9LGUucHJvdG90eXBlLnJlbmRlcj1mdW5jdGlvbigpe3JldHVybiBzLnByb3RvdHlwZS5yZW5kZXIuY2FsbCh0aGlzKX0sZS5wcm90b3R5cGUuZGVwbG95PWZ1bmN0aW9uKHQpe3RoaXMuY29udGV4dC5taWdyYXRlKHQpfSxlLnByb3RvdHlwZS5yZWNhbGw9ZnVuY3Rpb24oKXt0aGlzLl9jb250YWluZXI9ZG9jdW1lbnQuY3JlYXRlRG9jdW1lbnRGcmFnbWVudCgpLHRoaXMuY29udGV4dC5taWdyYXRlKHRoaXMuX2NvbnRhaW5lcil9LGUucHJvdG90eXBlLmNvbW1pdD1mdW5jdGlvbih0KXt2YXIgaT10LnRyYW5zZm9ybSxuPXQub3JpZ2luLHI9dC5vcGFjaXR5LGE9dC5zaXplLGg9cy5wcm90b3R5cGUuY29tbWl0LmNhbGwodGhpcyx7YWxsb2NhdG9yOnQuYWxsb2NhdG9yLHRyYW5zZm9ybTpvLnRoZW5Nb3ZlKGksWy1uWzBdKmFbMF0sLW5bMV0qYVsxXSwwXSksb3BhY2l0eTpyLG9yaWdpbjpuLHNpemU6ZS5TSVpFX1pFUk99KTtyZXR1cm4oYVswXSE9PXRoaXMuX2dyb3VwU2l6ZVswXXx8YVsxXSE9PXRoaXMuX2dyb3VwU2l6ZVsxXSkmJih0aGlzLl9ncm91cFNpemVbMF09YVswXSx0aGlzLl9ncm91cFNpemVbMV09YVsxXSx0aGlzLmNvbnRleHQuc2V0U2l6ZShhKSksdGhpcy5jb250ZXh0LnVwZGF0ZSh7dHJhbnNmb3JtOm8udHJhbnNsYXRlKC1uWzBdKmFbMF0sLW5bMV0qYVsxXSwwKSxvcmlnaW46bixzaXplOmF9KSxofSxpLmV4cG9ydHM9ZX0se1wiLi9Db250ZXh0XCI6MSxcIi4vU3VyZmFjZVwiOjE0LFwiLi9UcmFuc2Zvcm1cIjoxNX1dLDk6W2Z1bmN0aW9uKHQsaSl7ZnVuY3Rpb24gZSh0KXt0aGlzLl90cmFuc2Zvcm1HZXR0ZXI9bnVsbCx0aGlzLl9vcGFjaXR5R2V0dGVyPW51bGwsdGhpcy5fb3JpZ2luR2V0dGVyPW51bGwsdGhpcy5fYWxpZ25HZXR0ZXI9bnVsbCx0aGlzLl9zaXplR2V0dGVyPW51bGwsdGhpcy5fcHJvcG9ydGlvbkdldHRlcj1udWxsLHRoaXMuX2xlZ2FjeVN0YXRlcz17fSx0aGlzLl9vdXRwdXQ9e3RyYW5zZm9ybTpvLmlkZW50aXR5LG9wYWNpdHk6MSxvcmlnaW46bnVsbCxhbGlnbjpudWxsLHNpemU6bnVsbCxwcm9wb3J0aW9uczpudWxsLHRhcmdldDpudWxsfSx0JiYodC50cmFuc2Zvcm0mJnRoaXMudHJhbnNmb3JtRnJvbSh0LnRyYW5zZm9ybSksdm9pZCAwIT09dC5vcGFjaXR5JiZ0aGlzLm9wYWNpdHlGcm9tKHQub3BhY2l0eSksdC5vcmlnaW4mJnRoaXMub3JpZ2luRnJvbSh0Lm9yaWdpbiksdC5hbGlnbiYmdGhpcy5hbGlnbkZyb20odC5hbGlnbiksdC5zaXplJiZ0aGlzLnNpemVGcm9tKHQuc2l6ZSksdC5wcm9wb3J0aW9ucyYmdGhpcy5wcm9wb3J0aW9uc0Zyb20odC5wcm9wb3J0aW9ucykpfWZ1bmN0aW9uIG4oKXt0aGlzLl90cmFuc2Zvcm1HZXR0ZXImJih0aGlzLl9vdXRwdXQudHJhbnNmb3JtPXRoaXMuX3RyYW5zZm9ybUdldHRlcigpKSx0aGlzLl9vcGFjaXR5R2V0dGVyJiYodGhpcy5fb3V0cHV0Lm9wYWNpdHk9dGhpcy5fb3BhY2l0eUdldHRlcigpKSx0aGlzLl9vcmlnaW5HZXR0ZXImJih0aGlzLl9vdXRwdXQub3JpZ2luPXRoaXMuX29yaWdpbkdldHRlcigpKSx0aGlzLl9hbGlnbkdldHRlciYmKHRoaXMuX291dHB1dC5hbGlnbj10aGlzLl9hbGlnbkdldHRlcigpKSx0aGlzLl9zaXplR2V0dGVyJiYodGhpcy5fb3V0cHV0LnNpemU9dGhpcy5fc2l6ZUdldHRlcigpKSx0aGlzLl9wcm9wb3J0aW9uR2V0dGVyJiYodGhpcy5fb3V0cHV0LnByb3BvcnRpb25zPXRoaXMuX3Byb3BvcnRpb25HZXR0ZXIoKSl9dmFyIG89dChcIi4vVHJhbnNmb3JtXCIpLHM9dChcIi4uL3RyYW5zaXRpb25zL1RyYW5zaXRpb25hYmxlXCIpLHI9dChcIi4uL3RyYW5zaXRpb25zL1RyYW5zaXRpb25hYmxlVHJhbnNmb3JtXCIpO2UucHJvdG90eXBlLnRyYW5zZm9ybUZyb209ZnVuY3Rpb24odCl7cmV0dXJuIHQgaW5zdGFuY2VvZiBGdW5jdGlvbj90aGlzLl90cmFuc2Zvcm1HZXR0ZXI9dDp0IGluc3RhbmNlb2YgT2JqZWN0JiZ0LmdldD90aGlzLl90cmFuc2Zvcm1HZXR0ZXI9dC5nZXQuYmluZCh0KToodGhpcy5fdHJhbnNmb3JtR2V0dGVyPW51bGwsdGhpcy5fb3V0cHV0LnRyYW5zZm9ybT10KSx0aGlzfSxlLnByb3RvdHlwZS5vcGFjaXR5RnJvbT1mdW5jdGlvbih0KXtyZXR1cm4gdCBpbnN0YW5jZW9mIEZ1bmN0aW9uP3RoaXMuX29wYWNpdHlHZXR0ZXI9dDp0IGluc3RhbmNlb2YgT2JqZWN0JiZ0LmdldD90aGlzLl9vcGFjaXR5R2V0dGVyPXQuZ2V0LmJpbmQodCk6KHRoaXMuX29wYWNpdHlHZXR0ZXI9bnVsbCx0aGlzLl9vdXRwdXQub3BhY2l0eT10KSx0aGlzfSxlLnByb3RvdHlwZS5vcmlnaW5Gcm9tPWZ1bmN0aW9uKHQpe3JldHVybiB0IGluc3RhbmNlb2YgRnVuY3Rpb24/dGhpcy5fb3JpZ2luR2V0dGVyPXQ6dCBpbnN0YW5jZW9mIE9iamVjdCYmdC5nZXQ/dGhpcy5fb3JpZ2luR2V0dGVyPXQuZ2V0LmJpbmQodCk6KHRoaXMuX29yaWdpbkdldHRlcj1udWxsLHRoaXMuX291dHB1dC5vcmlnaW49dCksdGhpc30sZS5wcm90b3R5cGUuYWxpZ25Gcm9tPWZ1bmN0aW9uKHQpe3JldHVybiB0IGluc3RhbmNlb2YgRnVuY3Rpb24/dGhpcy5fYWxpZ25HZXR0ZXI9dDp0IGluc3RhbmNlb2YgT2JqZWN0JiZ0LmdldD90aGlzLl9hbGlnbkdldHRlcj10LmdldC5iaW5kKHQpOih0aGlzLl9hbGlnbkdldHRlcj1udWxsLHRoaXMuX291dHB1dC5hbGlnbj10KSx0aGlzfSxlLnByb3RvdHlwZS5zaXplRnJvbT1mdW5jdGlvbih0KXtyZXR1cm4gdCBpbnN0YW5jZW9mIEZ1bmN0aW9uP3RoaXMuX3NpemVHZXR0ZXI9dDp0IGluc3RhbmNlb2YgT2JqZWN0JiZ0LmdldD90aGlzLl9zaXplR2V0dGVyPXQuZ2V0LmJpbmQodCk6KHRoaXMuX3NpemVHZXR0ZXI9bnVsbCx0aGlzLl9vdXRwdXQuc2l6ZT10KSx0aGlzfSxlLnByb3RvdHlwZS5wcm9wb3J0aW9uc0Zyb209ZnVuY3Rpb24odCl7cmV0dXJuIHQgaW5zdGFuY2VvZiBGdW5jdGlvbj90aGlzLl9wcm9wb3J0aW9uR2V0dGVyPXQ6dCBpbnN0YW5jZW9mIE9iamVjdCYmdC5nZXQ/dGhpcy5fcHJvcG9ydGlvbkdldHRlcj10LmdldC5iaW5kKHQpOih0aGlzLl9wcm9wb3J0aW9uR2V0dGVyPW51bGwsdGhpcy5fb3V0cHV0LnByb3BvcnRpb25zPXQpLHRoaXN9LGUucHJvdG90eXBlLnNldFRyYW5zZm9ybT1mdW5jdGlvbih0LGksZSl7cmV0dXJuIGl8fHRoaXMuX2xlZ2FjeVN0YXRlcy50cmFuc2Zvcm0/KHRoaXMuX2xlZ2FjeVN0YXRlcy50cmFuc2Zvcm18fCh0aGlzLl9sZWdhY3lTdGF0ZXMudHJhbnNmb3JtPW5ldyByKHRoaXMuX291dHB1dC50cmFuc2Zvcm0pKSx0aGlzLl90cmFuc2Zvcm1HZXR0ZXJ8fHRoaXMudHJhbnNmb3JtRnJvbSh0aGlzLl9sZWdhY3lTdGF0ZXMudHJhbnNmb3JtKSx0aGlzLl9sZWdhY3lTdGF0ZXMudHJhbnNmb3JtLnNldCh0LGksZSksdGhpcyk6dGhpcy50cmFuc2Zvcm1Gcm9tKHQpfSxlLnByb3RvdHlwZS5zZXRPcGFjaXR5PWZ1bmN0aW9uKHQsaSxlKXtyZXR1cm4gaXx8dGhpcy5fbGVnYWN5U3RhdGVzLm9wYWNpdHk/KHRoaXMuX2xlZ2FjeVN0YXRlcy5vcGFjaXR5fHwodGhpcy5fbGVnYWN5U3RhdGVzLm9wYWNpdHk9bmV3IHModGhpcy5fb3V0cHV0Lm9wYWNpdHkpKSx0aGlzLl9vcGFjaXR5R2V0dGVyfHx0aGlzLm9wYWNpdHlGcm9tKHRoaXMuX2xlZ2FjeVN0YXRlcy5vcGFjaXR5KSx0aGlzLl9sZWdhY3lTdGF0ZXMub3BhY2l0eS5zZXQodCxpLGUpKTp0aGlzLm9wYWNpdHlGcm9tKHQpfSxlLnByb3RvdHlwZS5zZXRPcmlnaW49ZnVuY3Rpb24odCxpLGUpe3JldHVybiBpfHx0aGlzLl9sZWdhY3lTdGF0ZXMub3JpZ2luPyh0aGlzLl9sZWdhY3lTdGF0ZXMub3JpZ2lufHwodGhpcy5fbGVnYWN5U3RhdGVzLm9yaWdpbj1uZXcgcyh0aGlzLl9vdXRwdXQub3JpZ2lufHxbMCwwXSkpLHRoaXMuX29yaWdpbkdldHRlcnx8dGhpcy5vcmlnaW5Gcm9tKHRoaXMuX2xlZ2FjeVN0YXRlcy5vcmlnaW4pLHRoaXMuX2xlZ2FjeVN0YXRlcy5vcmlnaW4uc2V0KHQsaSxlKSx0aGlzKTp0aGlzLm9yaWdpbkZyb20odCl9LGUucHJvdG90eXBlLnNldEFsaWduPWZ1bmN0aW9uKHQsaSxlKXtyZXR1cm4gaXx8dGhpcy5fbGVnYWN5U3RhdGVzLmFsaWduPyh0aGlzLl9sZWdhY3lTdGF0ZXMuYWxpZ258fCh0aGlzLl9sZWdhY3lTdGF0ZXMuYWxpZ249bmV3IHModGhpcy5fb3V0cHV0LmFsaWdufHxbMCwwXSkpLHRoaXMuX2FsaWduR2V0dGVyfHx0aGlzLmFsaWduRnJvbSh0aGlzLl9sZWdhY3lTdGF0ZXMuYWxpZ24pLHRoaXMuX2xlZ2FjeVN0YXRlcy5hbGlnbi5zZXQodCxpLGUpLHRoaXMpOnRoaXMuYWxpZ25Gcm9tKHQpfSxlLnByb3RvdHlwZS5zZXRTaXplPWZ1bmN0aW9uKHQsaSxlKXtyZXR1cm4gdCYmKGl8fHRoaXMuX2xlZ2FjeVN0YXRlcy5zaXplKT8odGhpcy5fbGVnYWN5U3RhdGVzLnNpemV8fCh0aGlzLl9sZWdhY3lTdGF0ZXMuc2l6ZT1uZXcgcyh0aGlzLl9vdXRwdXQuc2l6ZXx8WzAsMF0pKSx0aGlzLl9zaXplR2V0dGVyfHx0aGlzLnNpemVGcm9tKHRoaXMuX2xlZ2FjeVN0YXRlcy5zaXplKSx0aGlzLl9sZWdhY3lTdGF0ZXMuc2l6ZS5zZXQodCxpLGUpLHRoaXMpOnRoaXMuc2l6ZUZyb20odCl9LGUucHJvdG90eXBlLnNldFByb3BvcnRpb25zPWZ1bmN0aW9uKHQsaSxlKXtyZXR1cm4gdCYmKGl8fHRoaXMuX2xlZ2FjeVN0YXRlcy5wcm9wb3J0aW9ucyk/KHRoaXMuX2xlZ2FjeVN0YXRlcy5wcm9wb3J0aW9uc3x8KHRoaXMuX2xlZ2FjeVN0YXRlcy5wcm9wb3J0aW9ucz1uZXcgcyh0aGlzLl9vdXRwdXQucHJvcG9ydGlvbnN8fFswLDBdKSksdGhpcy5fcHJvcG9ydGlvbkdldHRlcnx8dGhpcy5wcm9wb3J0aW9uc0Zyb20odGhpcy5fbGVnYWN5U3RhdGVzLnByb3BvcnRpb25zKSx0aGlzLl9sZWdhY3lTdGF0ZXMucHJvcG9ydGlvbnMuc2V0KHQsaSxlKSx0aGlzKTp0aGlzLnByb3BvcnRpb25zRnJvbSh0KX0sZS5wcm90b3R5cGUuaGFsdD1mdW5jdGlvbigpe3RoaXMuX2xlZ2FjeVN0YXRlcy50cmFuc2Zvcm0mJnRoaXMuX2xlZ2FjeVN0YXRlcy50cmFuc2Zvcm0uaGFsdCgpLHRoaXMuX2xlZ2FjeVN0YXRlcy5vcGFjaXR5JiZ0aGlzLl9sZWdhY3lTdGF0ZXMub3BhY2l0eS5oYWx0KCksdGhpcy5fbGVnYWN5U3RhdGVzLm9yaWdpbiYmdGhpcy5fbGVnYWN5U3RhdGVzLm9yaWdpbi5oYWx0KCksdGhpcy5fbGVnYWN5U3RhdGVzLmFsaWduJiZ0aGlzLl9sZWdhY3lTdGF0ZXMuYWxpZ24uaGFsdCgpLHRoaXMuX2xlZ2FjeVN0YXRlcy5zaXplJiZ0aGlzLl9sZWdhY3lTdGF0ZXMuc2l6ZS5oYWx0KCksdGhpcy5fbGVnYWN5U3RhdGVzLnByb3BvcnRpb25zJiZ0aGlzLl9sZWdhY3lTdGF0ZXMucHJvcG9ydGlvbnMuaGFsdCgpLHRoaXMuX3RyYW5zZm9ybUdldHRlcj1udWxsLHRoaXMuX29wYWNpdHlHZXR0ZXI9bnVsbCx0aGlzLl9vcmlnaW5HZXR0ZXI9bnVsbCx0aGlzLl9hbGlnbkdldHRlcj1udWxsLHRoaXMuX3NpemVHZXR0ZXI9bnVsbCx0aGlzLl9wcm9wb3J0aW9uR2V0dGVyPW51bGx9LGUucHJvdG90eXBlLmdldFRyYW5zZm9ybT1mdW5jdGlvbigpe3JldHVybiB0aGlzLl90cmFuc2Zvcm1HZXR0ZXIoKX0sZS5wcm90b3R5cGUuZ2V0RmluYWxUcmFuc2Zvcm09ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5fbGVnYWN5U3RhdGVzLnRyYW5zZm9ybT90aGlzLl9sZWdhY3lTdGF0ZXMudHJhbnNmb3JtLmdldEZpbmFsKCk6dGhpcy5fb3V0cHV0LnRyYW5zZm9ybX0sZS5wcm90b3R5cGUuZ2V0T3BhY2l0eT1mdW5jdGlvbigpe3JldHVybiB0aGlzLl9vcGFjaXR5R2V0dGVyKCl9LGUucHJvdG90eXBlLmdldE9yaWdpbj1mdW5jdGlvbigpe3JldHVybiB0aGlzLl9vcmlnaW5HZXR0ZXIoKX0sZS5wcm90b3R5cGUuZ2V0QWxpZ249ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5fYWxpZ25HZXR0ZXIoKX0sZS5wcm90b3R5cGUuZ2V0U2l6ZT1mdW5jdGlvbigpe3JldHVybiB0aGlzLl9zaXplR2V0dGVyP3RoaXMuX3NpemVHZXR0ZXIoKTp0aGlzLl9vdXRwdXQuc2l6ZX0sZS5wcm90b3R5cGUuZ2V0UHJvcG9ydGlvbnM9ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5fcHJvcG9ydGlvbkdldHRlcj90aGlzLl9wcm9wb3J0aW9uR2V0dGVyKCk6dGhpcy5fb3V0cHV0LnByb3BvcnRpb25zfSxlLnByb3RvdHlwZS5tb2RpZnk9ZnVuY3Rpb24odCl7cmV0dXJuIG4uY2FsbCh0aGlzKSx0aGlzLl9vdXRwdXQudGFyZ2V0PXQsdGhpcy5fb3V0cHV0fSxpLmV4cG9ydHM9ZX0se1wiLi4vdHJhbnNpdGlvbnMvVHJhbnNpdGlvbmFibGVcIjo4OCxcIi4uL3RyYW5zaXRpb25zL1RyYW5zaXRpb25hYmxlVHJhbnNmb3JtXCI6ODksXCIuL1RyYW5zZm9ybVwiOjE1fV0sMTA6W2Z1bmN0aW9uKHQsaSl7ZnVuY3Rpb24gZSh0KXt0aGlzLl92YWx1ZT10LHRoaXMuZXZlbnRPdXRwdXQ9bnVsbH1mdW5jdGlvbiBuKCl7dGhpcy5ldmVudE91dHB1dD1uZXcgbyx0aGlzLmV2ZW50T3V0cHV0LmJpbmRUaGlzKHRoaXMpLG8uc2V0T3V0cHV0SGFuZGxlcih0aGlzLHRoaXMuZXZlbnRPdXRwdXQpfXZhciBvPXQoXCIuL0V2ZW50SGFuZGxlclwiKTtlLnBhdGNoPWZ1bmN0aW9uKHQpe2Zvcih2YXIgaT1uZXcgZSh0KSxuPTE7bjxhcmd1bWVudHMubGVuZ3RoO24rKylpLnBhdGNoKGFyZ3VtZW50c1tuXSk7cmV0dXJuIHR9LGUucHJvdG90eXBlLnBhdGNoPWZ1bmN0aW9uKCl7Zm9yKHZhciB0PXRoaXMuX3ZhbHVlLGk9MDtpPGFyZ3VtZW50cy5sZW5ndGg7aSsrKXt2YXIgZT1hcmd1bWVudHNbaV07Zm9yKHZhciBuIGluIGUpbiBpbiB0JiZlW25dJiZlW25dLmNvbnN0cnVjdG9yPT09T2JqZWN0JiZ0W25dJiZ0W25dLmNvbnN0cnVjdG9yPT09T2JqZWN0Pyh0Lmhhc093blByb3BlcnR5KG4pfHwodFtuXT1PYmplY3QuY3JlYXRlKHRbbl0pKSx0aGlzLmtleShuKS5wYXRjaChlW25dKSx0aGlzLmV2ZW50T3V0cHV0JiZ0aGlzLmV2ZW50T3V0cHV0LmVtaXQoXCJjaGFuZ2VcIix7aWQ6bix2YWx1ZTp0aGlzLmtleShuKS52YWx1ZSgpfSkpOnRoaXMuc2V0KG4sZVtuXSl9cmV0dXJuIHRoaXN9LGUucHJvdG90eXBlLnNldE9wdGlvbnM9ZS5wcm90b3R5cGUucGF0Y2gsZS5wcm90b3R5cGUua2V5PWZ1bmN0aW9uKHQpe3ZhciBpPW5ldyBlKHRoaXMuX3ZhbHVlW3RdKTtyZXR1cm4oIShpLl92YWx1ZSBpbnN0YW5jZW9mIE9iamVjdCl8fGkuX3ZhbHVlIGluc3RhbmNlb2YgQXJyYXkpJiYoaS5fdmFsdWU9e30pLGl9LGUucHJvdG90eXBlLmdldD1mdW5jdGlvbih0KXtyZXR1cm4gdD90aGlzLl92YWx1ZVt0XTp0aGlzLl92YWx1ZX0sZS5wcm90b3R5cGUuZ2V0T3B0aW9ucz1lLnByb3RvdHlwZS5nZXQsZS5wcm90b3R5cGUuc2V0PWZ1bmN0aW9uKHQsaSl7dmFyIGU9dGhpcy5nZXQodCk7cmV0dXJuIHRoaXMuX3ZhbHVlW3RdPWksdGhpcy5ldmVudE91dHB1dCYmaSE9PWUmJnRoaXMuZXZlbnRPdXRwdXQuZW1pdChcImNoYW5nZVwiLHtpZDp0LHZhbHVlOml9KSx0aGlzfSxlLnByb3RvdHlwZS5vbj1mdW5jdGlvbigpe3JldHVybiBuLmNhbGwodGhpcyksdGhpcy5vbi5hcHBseSh0aGlzLGFyZ3VtZW50cyl9LGUucHJvdG90eXBlLnJlbW92ZUxpc3RlbmVyPWZ1bmN0aW9uKCl7cmV0dXJuIG4uY2FsbCh0aGlzKSx0aGlzLnJlbW92ZUxpc3RlbmVyLmFwcGx5KHRoaXMsYXJndW1lbnRzKX0sZS5wcm90b3R5cGUucGlwZT1mdW5jdGlvbigpe3JldHVybiBuLmNhbGwodGhpcyksdGhpcy5waXBlLmFwcGx5KHRoaXMsYXJndW1lbnRzKX0sZS5wcm90b3R5cGUudW5waXBlPWZ1bmN0aW9uKCl7cmV0dXJuIG4uY2FsbCh0aGlzKSx0aGlzLnVucGlwZS5hcHBseSh0aGlzLGFyZ3VtZW50cyl9LGkuZXhwb3J0cz1lfSx7XCIuL0V2ZW50SGFuZGxlclwiOjd9XSwxMTpbZnVuY3Rpb24odCxpKXtmdW5jdGlvbiBlKHQpe3RoaXMuX29iamVjdD1udWxsLHRoaXMuX2NoaWxkPW51bGwsdGhpcy5faGFzTXVsdGlwbGVDaGlsZHJlbj0hMSx0aGlzLl9pc1JlbmRlcmFibGU9ITEsdGhpcy5faXNNb2RpZmllcj0hMSx0aGlzLl9yZXN1bHRDYWNoZT17fSx0aGlzLl9wcmV2UmVzdWx0cz17fSx0aGlzLl9jaGlsZFJlc3VsdD1udWxsLHQmJnRoaXMuc2V0KHQpfWZ1bmN0aW9uIG4odCxpLGUpe2Zvcih2YXIgcj1zLnBhcnNlKHQsaSksYT1PYmplY3Qua2V5cyhyKSxoPTA7aDxhLmxlbmd0aDtoKyspe3ZhciBjPWFbaF0scD1vLmdldChjKSx1PXJbY107dS5hbGxvY2F0b3I9aS5hbGxvY2F0b3I7dmFyIGw9cC5jb21taXQodSk7bD9uKGwsaSxlKTplW2NdPXV9fXZhciBvPXQoXCIuL0VudGl0eVwiKSxzPXQoXCIuL1NwZWNQYXJzZXJcIik7ZS5wcm90b3R5cGUuYWRkPWZ1bmN0aW9uKHQpe3ZhciBpPXQgaW5zdGFuY2VvZiBlP3Q6bmV3IGUodCk7cmV0dXJuIHRoaXMuX2NoaWxkIGluc3RhbmNlb2YgQXJyYXk/dGhpcy5fY2hpbGQucHVzaChpKTp0aGlzLl9jaGlsZD8odGhpcy5fY2hpbGQ9W3RoaXMuX2NoaWxkLGldLHRoaXMuX2hhc011bHRpcGxlQ2hpbGRyZW49ITAsdGhpcy5fY2hpbGRSZXN1bHQ9W10pOnRoaXMuX2NoaWxkPWksaX0sZS5wcm90b3R5cGUuZ2V0PWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuX29iamVjdHx8KHRoaXMuX2hhc011bHRpcGxlQ2hpbGRyZW4/bnVsbDp0aGlzLl9jaGlsZD90aGlzLl9jaGlsZC5nZXQoKTpudWxsKX0sZS5wcm90b3R5cGUuc2V0PWZ1bmN0aW9uKHQpe3JldHVybiB0aGlzLl9jaGlsZFJlc3VsdD1udWxsLHRoaXMuX2hhc011bHRpcGxlQ2hpbGRyZW49ITEsdGhpcy5faXNSZW5kZXJhYmxlPXQucmVuZGVyPyEwOiExLHRoaXMuX2lzTW9kaWZpZXI9dC5tb2RpZnk/ITA6ITEsdGhpcy5fb2JqZWN0PXQsdGhpcy5fY2hpbGQ9bnVsbCx0IGluc3RhbmNlb2YgZT90OnRoaXN9LGUucHJvdG90eXBlLmdldFNpemU9ZnVuY3Rpb24oKXt2YXIgdD1udWxsLGk9dGhpcy5nZXQoKTtyZXR1cm4gaSYmaS5nZXRTaXplJiYodD1pLmdldFNpemUoKSksIXQmJnRoaXMuX2NoaWxkJiZ0aGlzLl9jaGlsZC5nZXRTaXplJiYodD10aGlzLl9jaGlsZC5nZXRTaXplKCkpLHR9LGUucHJvdG90eXBlLmNvbW1pdD1mdW5jdGlvbih0KXtmb3IodmFyIGk9T2JqZWN0LmtleXModGhpcy5fcHJldlJlc3VsdHMpLGU9MDtlPGkubGVuZ3RoO2UrKyl7dmFyIHM9aVtlXTtpZih2b2lkIDA9PT10aGlzLl9yZXN1bHRDYWNoZVtzXSl7dmFyIHI9by5nZXQocyk7ci5jbGVhbnVwJiZyLmNsZWFudXAodC5hbGxvY2F0b3IpfX10aGlzLl9wcmV2UmVzdWx0cz10aGlzLl9yZXN1bHRDYWNoZSx0aGlzLl9yZXN1bHRDYWNoZT17fSxuKHRoaXMucmVuZGVyKCksdCx0aGlzLl9yZXN1bHRDYWNoZSl9LGUucHJvdG90eXBlLnJlbmRlcj1mdW5jdGlvbigpe2lmKHRoaXMuX2lzUmVuZGVyYWJsZSlyZXR1cm4gdGhpcy5fb2JqZWN0LnJlbmRlcigpO3ZhciB0PW51bGw7aWYodGhpcy5faGFzTXVsdGlwbGVDaGlsZHJlbil7dD10aGlzLl9jaGlsZFJlc3VsdDtmb3IodmFyIGk9dGhpcy5fY2hpbGQsZT0wO2U8aS5sZW5ndGg7ZSsrKXRbZV09aVtlXS5yZW5kZXIoKX1lbHNlIHRoaXMuX2NoaWxkJiYodD10aGlzLl9jaGlsZC5yZW5kZXIoKSk7cmV0dXJuIHRoaXMuX2lzTW9kaWZpZXI/dGhpcy5fb2JqZWN0Lm1vZGlmeSh0KTp0fSxpLmV4cG9ydHM9ZX0se1wiLi9FbnRpdHlcIjo1LFwiLi9TcGVjUGFyc2VyXCI6MTN9XSwxMjpbZnVuY3Rpb24odCxpKXtmdW5jdGlvbiBlKHQpe3RoaXMuaWQ9bnVsbCx0aGlzLl9vYmplY3RzPW51bGwsdGhpcy5ub2RlPW5ldyBjLHRoaXMuX2RlZmluaXRpb249bnVsbCx0JiZ0aGlzLmxvYWQodCl9ZnVuY3Rpb24gbih0KXtmb3IodmFyIGkgaW4gcClpZihpIGluIHQpe3ZhciBlPXRbaV07cmV0dXJuIGUgaW5zdGFuY2VvZiBBcnJheXx8KGU9W2VdKSxwW2ldLmFwcGx5KHRoaXMsZSl9fWZ1bmN0aW9uIG8odCl7dmFyIGk9dC50cmFuc2Zvcm0sZT10Lm9wYWNpdHksbz10Lm9yaWdpbixzPXQuYWxpZ24scj10LnNpemUsYz1hLmlkZW50aXR5O2lmKGkgaW5zdGFuY2VvZiBBcnJheSlpZigxNj09PWkubGVuZ3RoJiZcIm51bWJlclwiPT10eXBlb2YgaVswXSljPWk7ZWxzZSBmb3IodmFyIHA9MDtwPGkubGVuZ3RoO3ArKyljPWEubXVsdGlwbHkoYyxuKGlbcF0pKTtlbHNlIGkgaW5zdGFuY2VvZiBGdW5jdGlvbj9jPWk6aSBpbnN0YW5jZW9mIE9iamVjdCYmKGM9bihpKSk7dmFyIHU9bmV3IGgoe3RyYW5zZm9ybTpjLG9wYWNpdHk6ZSxvcmlnaW46byxhbGlnbjpzLHNpemU6cn0pO3JldHVybiB1fWZ1bmN0aW9uIHModCl7Zm9yKHZhciBpPW5ldyBjLGU9MDtlPHQubGVuZ3RoO2UrKyl7dmFyIG49ci5jYWxsKHRoaXMsdFtlXSk7biYmaS5hZGQobil9cmV0dXJuIGl9ZnVuY3Rpb24gcih0KXt2YXIgaSxlO2lmKHQgaW5zdGFuY2VvZiBBcnJheSlpPXMuY2FsbCh0aGlzLHQpO2Vsc2UgaWYoZT10aGlzLl9vYmplY3RzLmxlbmd0aCx0LnJlbmRlciYmdC5yZW5kZXIgaW5zdGFuY2VvZiBGdW5jdGlvbilpPXQ7ZWxzZSBpZih0LnRhcmdldCl7dmFyIG49ci5jYWxsKHRoaXMsdC50YXJnZXQpLGE9by5jYWxsKHRoaXMsdCk7aT1uZXcgYyhhKSxpLmFkZChuKSx0LmlkJiYodGhpcy5pZFt0LmlkXT1hKX1lbHNlIHQuaWQmJihpPW5ldyBjLHRoaXMuaWRbdC5pZF09aSk7cmV0dXJuIHRoaXMuX29iamVjdHNbZV09aSxpfXZhciBhPXQoXCIuL1RyYW5zZm9ybVwiKSxoPXQoXCIuL01vZGlmaWVyXCIpLGM9dChcIi4vUmVuZGVyTm9kZVwiKSxwPXt0cmFuc2xhdGU6YS50cmFuc2xhdGUscm90YXRlOmEucm90YXRlLHJvdGF0ZVg6YS5yb3RhdGVYLHJvdGF0ZVk6YS5yb3RhdGVZLHJvdGF0ZVo6YS5yb3RhdGVaLHJvdGF0ZUF4aXM6YS5yb3RhdGVBeGlzLHNjYWxlOmEuc2NhbGUsc2tldzphLnNrZXcsbWF0cml4M2Q6ZnVuY3Rpb24oKXtyZXR1cm4gYXJndW1lbnRzfX07ZS5wcm90b3R5cGUuY3JlYXRlPWZ1bmN0aW9uKCl7cmV0dXJuIG5ldyBlKHRoaXMuX2RlZmluaXRpb24pfSxlLnByb3RvdHlwZS5sb2FkPWZ1bmN0aW9uKHQpe3RoaXMuX2RlZmluaXRpb249dCx0aGlzLmlkPXt9LHRoaXMuX29iamVjdHM9W10sdGhpcy5ub2RlLnNldChyLmNhbGwodGhpcyx0KSl9LGUucHJvdG90eXBlLmFkZD1mdW5jdGlvbigpe3JldHVybiB0aGlzLm5vZGUuYWRkLmFwcGx5KHRoaXMubm9kZSxhcmd1bWVudHMpfSxlLnByb3RvdHlwZS5yZW5kZXI9ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5ub2RlLnJlbmRlci5hcHBseSh0aGlzLm5vZGUsYXJndW1lbnRzKX0saS5leHBvcnRzPWV9LHtcIi4vTW9kaWZpZXJcIjo5LFwiLi9SZW5kZXJOb2RlXCI6MTEsXCIuL1RyYW5zZm9ybVwiOjE1fV0sMTM6W2Z1bmN0aW9uKHQsaSl7ZnVuY3Rpb24gZSgpe3RoaXMucmVzdWx0PXt9fWZ1bmN0aW9uIG4odCxpKXtyZXR1cm5bdFswXSppWzBdK3RbMV0qaVs0XSt0WzJdKmlbOF0sdFswXSppWzFdK3RbMV0qaVs1XSt0WzJdKmlbOV0sdFswXSppWzJdK3RbMV0qaVs2XSt0WzJdKmlbMTBdXX12YXIgbz10KFwiLi9UcmFuc2Zvcm1cIik7ZS5faW5zdGFuY2U9bmV3IGUsZS5wYXJzZT1mdW5jdGlvbih0LGkpe3JldHVybiBlLl9pbnN0YW5jZS5wYXJzZSh0LGkpfSxlLnByb3RvdHlwZS5wYXJzZT1mdW5jdGlvbih0LGkpe3JldHVybiB0aGlzLnJlc2V0KCksdGhpcy5fcGFyc2VTcGVjKHQsaSxvLmlkZW50aXR5KSx0aGlzLnJlc3VsdH0sZS5wcm90b3R5cGUucmVzZXQ9ZnVuY3Rpb24oKXt0aGlzLnJlc3VsdD17fX07dmFyIHM9WzAsMF07ZS5wcm90b3R5cGUuX3BhcnNlU3BlYz1mdW5jdGlvbih0LGksZSl7dmFyIHIsYSxoLGMscCx1LGw7aWYoXCJudW1iZXJcIj09dHlwZW9mIHQpe2lmKHI9dCxoPWkudHJhbnNmb3JtLHU9aS5hbGlnbnx8cyxpLnNpemUmJnUmJih1WzBdfHx1WzFdKSl7dmFyIGY9W3VbMF0qaS5zaXplWzBdLHVbMV0qaS5zaXplWzFdLDBdO2g9by50aGVuTW92ZShoLG4oZixlKSl9dGhpcy5yZXN1bHRbcl09e3RyYW5zZm9ybTpoLG9wYWNpdHk6aS5vcGFjaXR5LG9yaWdpbjppLm9yaWdpbnx8cyxhbGlnbjppLmFsaWdufHxzLHNpemU6aS5zaXplfX1lbHNle2lmKCF0KXJldHVybjtpZih0IGluc3RhbmNlb2YgQXJyYXkpZm9yKHZhciBkPTA7ZDx0Lmxlbmd0aDtkKyspdGhpcy5fcGFyc2VTcGVjKHRbZF0saSxlKTtlbHNle2E9dC50YXJnZXQsaD1pLnRyYW5zZm9ybSxjPWkub3BhY2l0eSxwPWkub3JpZ2luLHU9aS5hbGlnbixsPWkuc2l6ZTt2YXIgXz1lO2lmKHZvaWQgMCE9PXQub3BhY2l0eSYmKGM9aS5vcGFjaXR5KnQub3BhY2l0eSksdC50cmFuc2Zvcm0mJihoPW8ubXVsdGlwbHkoaS50cmFuc2Zvcm0sdC50cmFuc2Zvcm0pKSx0Lm9yaWdpbiYmKHA9dC5vcmlnaW4sXz1pLnRyYW5zZm9ybSksdC5hbGlnbiYmKHU9dC5hbGlnbiksdC5zaXplfHx0LnByb3BvcnRpb25zKXt2YXIgeT1sO2w9W2xbMF0sbFsxXV0sdC5zaXplJiYodm9pZCAwIT09dC5zaXplWzBdJiYobFswXT10LnNpemVbMF0pLHZvaWQgMCE9PXQuc2l6ZVsxXSYmKGxbMV09dC5zaXplWzFdKSksdC5wcm9wb3J0aW9ucyYmKHZvaWQgMCE9PXQucHJvcG9ydGlvbnNbMF0mJihsWzBdPWxbMF0qdC5wcm9wb3J0aW9uc1swXSksdm9pZCAwIT09dC5wcm9wb3J0aW9uc1sxXSYmKGxbMV09bFsxXSp0LnByb3BvcnRpb25zWzFdKSkseSYmKHUmJih1WzBdfHx1WzFdKSYmKGg9by50aGVuTW92ZShoLG4oW3VbMF0qeVswXSx1WzFdKnlbMV0sMF0sZSkpKSxwJiYocFswXXx8cFsxXSkmJihoPW8ubW92ZVRoZW4oWy1wWzBdKmxbMF0sLXBbMV0qbFsxXSwwXSxoKSkpLF89aS50cmFuc2Zvcm0scD1udWxsLHU9bnVsbH10aGlzLl9wYXJzZVNwZWMoYSx7dHJhbnNmb3JtOmgsb3BhY2l0eTpjLG9yaWdpbjpwLGFsaWduOnUsc2l6ZTpsfSxfKX19fSxpLmV4cG9ydHM9ZX0se1wiLi9UcmFuc2Zvcm1cIjoxNX1dLDE0OltmdW5jdGlvbih0LGkpe2Z1bmN0aW9uIGUodCl7Yy5jYWxsKHRoaXMpLHRoaXMub3B0aW9ucz17fSx0aGlzLnByb3BlcnRpZXM9e30sdGhpcy5hdHRyaWJ1dGVzPXt9LHRoaXMuY29udGVudD1cIlwiLHRoaXMuY2xhc3NMaXN0PVtdLHRoaXMuc2l6ZT1udWxsLHRoaXMuX2NsYXNzZXNEaXJ0eT0hMCx0aGlzLl9zdHlsZXNEaXJ0eT0hMCx0aGlzLl9hdHRyaWJ1dGVzRGlydHk9ITAsdGhpcy5fc2l6ZURpcnR5PSEwLHRoaXMuX2NvbnRlbnREaXJ0eT0hMCx0aGlzLl90cnVlU2l6ZUNoZWNrPSEwLHRoaXMuX2RpcnR5Q2xhc3Nlcz1bXSx0JiZ0aGlzLnNldE9wdGlvbnModCksdGhpcy5fY3VycmVudFRhcmdldD1udWxsfWZ1bmN0aW9uIG4odCl7Zm9yKHZhciBpPTA7aTx0aGlzLl9kaXJ0eUNsYXNzZXMubGVuZ3RoO2krKyl0LmNsYXNzTGlzdC5yZW1vdmUodGhpcy5fZGlydHlDbGFzc2VzW2ldKTt0aGlzLl9kaXJ0eUNsYXNzZXM9W119ZnVuY3Rpb24gbyh0KXtmb3IodmFyIGkgaW4gdGhpcy5wcm9wZXJ0aWVzKXQuc3R5bGVbaV09dGhpcy5wcm9wZXJ0aWVzW2ldfWZ1bmN0aW9uIHModCl7Zm9yKHZhciBpIGluIHRoaXMucHJvcGVydGllcyl0LnN0eWxlW2ldPVwiXCJ9ZnVuY3Rpb24gcih0KXtmb3IodmFyIGkgaW4gdGhpcy5hdHRyaWJ1dGVzKXQuc2V0QXR0cmlidXRlKGksdGhpcy5hdHRyaWJ1dGVzW2ldKX1mdW5jdGlvbiBhKHQpe2Zvcih2YXIgaSBpbiB0aGlzLmF0dHJpYnV0ZXMpdC5yZW1vdmVBdHRyaWJ1dGUoaSl9ZnVuY3Rpb24gaCh0LGkpe3JldHVybiB0JiZpP3RbMF0hPT1pWzBdfHx0WzFdIT09aVsxXTp0IT09aX12YXIgYz10KFwiLi9FbGVtZW50T3V0cHV0XCIpO2UucHJvdG90eXBlPU9iamVjdC5jcmVhdGUoYy5wcm90b3R5cGUpLGUucHJvdG90eXBlLmNvbnN0cnVjdG9yPWUsZS5wcm90b3R5cGUuZWxlbWVudFR5cGU9XCJkaXZcIixlLnByb3RvdHlwZS5lbGVtZW50Q2xhc3M9XCJmYW1vdXMtc3VyZmFjZVwiLGUucHJvdG90eXBlLnNldEF0dHJpYnV0ZXM9ZnVuY3Rpb24odCl7Zm9yKHZhciBpIGluIHQpe2lmKFwic3R5bGVcIj09PWkpdGhyb3cgbmV3IEVycm9yKCdDYW5ub3Qgc2V0IHN0eWxlcyB2aWEgXCJzZXRBdHRyaWJ1dGVzXCIgYXMgaXQgd2lsbCBicmVhayBGYW1vLnVzLiAgVXNlIFwic2V0UHJvcGVydGllc1wiIGluc3RlYWQuJyk7dGhpcy5hdHRyaWJ1dGVzW2ldPXRbaV19dGhpcy5fYXR0cmlidXRlc0RpcnR5PSEwfSxlLnByb3RvdHlwZS5nZXRBdHRyaWJ1dGVzPWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuYXR0cmlidXRlc30sZS5wcm90b3R5cGUuc2V0UHJvcGVydGllcz1mdW5jdGlvbih0KXtmb3IodmFyIGkgaW4gdCl0aGlzLnByb3BlcnRpZXNbaV09dFtpXTtyZXR1cm4gdGhpcy5fc3R5bGVzRGlydHk9ITAsdGhpc30sZS5wcm90b3R5cGUuZ2V0UHJvcGVydGllcz1mdW5jdGlvbigpe3JldHVybiB0aGlzLnByb3BlcnRpZXN9LGUucHJvdG90eXBlLmFkZENsYXNzPWZ1bmN0aW9uKHQpe3JldHVybiB0aGlzLmNsYXNzTGlzdC5pbmRleE9mKHQpPDAmJih0aGlzLmNsYXNzTGlzdC5wdXNoKHQpLHRoaXMuX2NsYXNzZXNEaXJ0eT0hMCksdGhpc30sZS5wcm90b3R5cGUucmVtb3ZlQ2xhc3M9ZnVuY3Rpb24odCl7dmFyIGk9dGhpcy5jbGFzc0xpc3QuaW5kZXhPZih0KTtyZXR1cm4gaT49MCYmKHRoaXMuX2RpcnR5Q2xhc3Nlcy5wdXNoKHRoaXMuY2xhc3NMaXN0LnNwbGljZShpLDEpWzBdKSx0aGlzLl9jbGFzc2VzRGlydHk9ITApLHRoaXN9LGUucHJvdG90eXBlLnRvZ2dsZUNsYXNzPWZ1bmN0aW9uKHQpe3ZhciBpPXRoaXMuY2xhc3NMaXN0LmluZGV4T2YodCk7cmV0dXJuIGk+PTA/dGhpcy5yZW1vdmVDbGFzcyh0KTp0aGlzLmFkZENsYXNzKHQpLHRoaXN9LGUucHJvdG90eXBlLnNldENsYXNzZXM9ZnVuY3Rpb24odCl7dmFyIGk9MCxlPVtdO2ZvcihpPTA7aTx0aGlzLmNsYXNzTGlzdC5sZW5ndGg7aSsrKXQuaW5kZXhPZih0aGlzLmNsYXNzTGlzdFtpXSk8MCYmZS5wdXNoKHRoaXMuY2xhc3NMaXN0W2ldKTtmb3IoaT0wO2k8ZS5sZW5ndGg7aSsrKXRoaXMucmVtb3ZlQ2xhc3MoZVtpXSk7Zm9yKGk9MDtpPHQubGVuZ3RoO2krKyl0aGlzLmFkZENsYXNzKHRbaV0pO3JldHVybiB0aGlzfSxlLnByb3RvdHlwZS5nZXRDbGFzc0xpc3Q9ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5jbGFzc0xpc3R9LGUucHJvdG90eXBlLnNldENvbnRlbnQ9ZnVuY3Rpb24odCl7cmV0dXJuIHRoaXMuY29udGVudCE9PXQmJih0aGlzLmNvbnRlbnQ9dCx0aGlzLl9jb250ZW50RGlydHk9ITApLHRoaXN9LGUucHJvdG90eXBlLmdldENvbnRlbnQ9ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5jb250ZW50fSxlLnByb3RvdHlwZS5zZXRPcHRpb25zPWZ1bmN0aW9uKHQpe3JldHVybiB0LnNpemUmJnRoaXMuc2V0U2l6ZSh0LnNpemUpLHQuY2xhc3NlcyYmdGhpcy5zZXRDbGFzc2VzKHQuY2xhc3NlcyksdC5wcm9wZXJ0aWVzJiZ0aGlzLnNldFByb3BlcnRpZXModC5wcm9wZXJ0aWVzKSx0LmF0dHJpYnV0ZXMmJnRoaXMuc2V0QXR0cmlidXRlcyh0LmF0dHJpYnV0ZXMpLHQuY29udGVudCYmdGhpcy5zZXRDb250ZW50KHQuY29udGVudCksdGhpc30sZS5wcm90b3R5cGUuc2V0dXA9ZnVuY3Rpb24odCl7dmFyIGk9dC5hbGxvY2F0ZSh0aGlzLmVsZW1lbnRUeXBlKTtpZih0aGlzLmVsZW1lbnRDbGFzcylpZih0aGlzLmVsZW1lbnRDbGFzcyBpbnN0YW5jZW9mIEFycmF5KWZvcih2YXIgZT0wO2U8dGhpcy5lbGVtZW50Q2xhc3MubGVuZ3RoO2UrKylpLmNsYXNzTGlzdC5hZGQodGhpcy5lbGVtZW50Q2xhc3NbZV0pO2Vsc2UgaS5jbGFzc0xpc3QuYWRkKHRoaXMuZWxlbWVudENsYXNzKTtpLnN0eWxlLmRpc3BsYXk9XCJcIix0aGlzLmF0dGFjaChpKSx0aGlzLl9vcGFjaXR5PW51bGwsdGhpcy5fY3VycmVudFRhcmdldD1pLHRoaXMuX3N0eWxlc0RpcnR5PSEwLHRoaXMuX2NsYXNzZXNEaXJ0eT0hMCx0aGlzLl9hdHRyaWJ1dGVzRGlydHk9ITAsdGhpcy5fc2l6ZURpcnR5PSEwLHRoaXMuX2NvbnRlbnREaXJ0eT0hMCx0aGlzLl9vcmlnaW5EaXJ0eT0hMCx0aGlzLl90cmFuc2Zvcm1EaXJ0eT0hMH0sZS5wcm90b3R5cGUuY29tbWl0PWZ1bmN0aW9uKHQpe3RoaXMuX2N1cnJlbnRUYXJnZXR8fHRoaXMuc2V0dXAodC5hbGxvY2F0b3IpO3ZhciBpPXRoaXMuX2N1cnJlbnRUYXJnZXQsZT10LnNpemU7aWYodGhpcy5fY2xhc3Nlc0RpcnR5KXtuLmNhbGwodGhpcyxpKTtmb3IodmFyIHM9dGhpcy5nZXRDbGFzc0xpc3QoKSxhPTA7YTxzLmxlbmd0aDthKyspaS5jbGFzc0xpc3QuYWRkKHNbYV0pO3RoaXMuX2NsYXNzZXNEaXJ0eT0hMSx0aGlzLl90cnVlU2l6ZUNoZWNrPSEwfWlmKHRoaXMuX3N0eWxlc0RpcnR5JiYoby5jYWxsKHRoaXMsaSksdGhpcy5fc3R5bGVzRGlydHk9ITEsdGhpcy5fdHJ1ZVNpemVDaGVjaz0hMCksdGhpcy5fYXR0cmlidXRlc0RpcnR5JiYoci5jYWxsKHRoaXMsaSksdGhpcy5fYXR0cmlidXRlc0RpcnR5PSExLHRoaXMuX3RydWVTaXplQ2hlY2s9ITApLHRoaXMuc2l6ZSl7dmFyIHA9dC5zaXplO2lmKGU9W3RoaXMuc2l6ZVswXSx0aGlzLnNpemVbMV1dLHZvaWQgMD09PWVbMF0mJihlWzBdPXBbMF0pLHZvaWQgMD09PWVbMV0mJihlWzFdPXBbMV0pLGVbMF09PT0hMHx8ZVsxXT09PSEwKXtpZihlWzBdIT09ITB8fCF0aGlzLl90cnVlU2l6ZUNoZWNrJiYwIT09dGhpcy5fc2l6ZVswXSl0aGlzLl9zaXplJiYoZVswXT10aGlzLl9zaXplWzBdKTtlbHNle3ZhciB1PWkub2Zmc2V0V2lkdGg7dGhpcy5fc2l6ZSYmdGhpcy5fc2l6ZVswXSE9PXUmJih0aGlzLl9zaXplWzBdPXUsdGhpcy5fc2l6ZURpcnR5PSEwKSxlWzBdPXV9aWYoZVsxXSE9PSEwfHwhdGhpcy5fdHJ1ZVNpemVDaGVjayYmMCE9PXRoaXMuX3NpemVbMV0pdGhpcy5fc2l6ZSYmKGVbMV09dGhpcy5fc2l6ZVsxXSk7ZWxzZXt2YXIgbD1pLm9mZnNldEhlaWdodDt0aGlzLl9zaXplJiZ0aGlzLl9zaXplWzFdIT09bCYmKHRoaXMuX3NpemVbMV09bCx0aGlzLl9zaXplRGlydHk9ITApLGVbMV09bH10aGlzLl90cnVlU2l6ZUNoZWNrPSExfX1oKHRoaXMuX3NpemUsZSkmJih0aGlzLl9zaXplfHwodGhpcy5fc2l6ZT1bMCwwXSksdGhpcy5fc2l6ZVswXT1lWzBdLHRoaXMuX3NpemVbMV09ZVsxXSx0aGlzLl9zaXplRGlydHk9ITApLHRoaXMuX3NpemVEaXJ0eSYmKHRoaXMuX3NpemUmJihpLnN0eWxlLndpZHRoPXRoaXMuc2l6ZSYmdGhpcy5zaXplWzBdPT09ITA/XCJcIjp0aGlzLl9zaXplWzBdK1wicHhcIixpLnN0eWxlLmhlaWdodD10aGlzLnNpemUmJnRoaXMuc2l6ZVsxXT09PSEwP1wiXCI6dGhpcy5fc2l6ZVsxXStcInB4XCIpLHRoaXMuX2V2ZW50T3V0cHV0LmVtaXQoXCJyZXNpemVcIikpLHRoaXMuX2NvbnRlbnREaXJ0eSYmKHRoaXMuZGVwbG95KGkpLHRoaXMuX2V2ZW50T3V0cHV0LmVtaXQoXCJkZXBsb3lcIiksdGhpcy5fY29udGVudERpcnR5PSExLHRoaXMuX3RydWVTaXplQ2hlY2s9ITApLGMucHJvdG90eXBlLmNvbW1pdC5jYWxsKHRoaXMsdCl9LGUucHJvdG90eXBlLmNsZWFudXA9ZnVuY3Rpb24odCl7dmFyIGk9MCxlPXRoaXMuX2N1cnJlbnRUYXJnZXQ7dGhpcy5fZXZlbnRPdXRwdXQuZW1pdChcInJlY2FsbFwiKSx0aGlzLnJlY2FsbChlKSxlLnN0eWxlLmRpc3BsYXk9XCJub25lXCIsZS5zdHlsZS5vcGFjaXR5PVwiXCIsZS5zdHlsZS53aWR0aD1cIlwiLGUuc3R5bGUuaGVpZ2h0PVwiXCIscy5jYWxsKHRoaXMsZSksYS5jYWxsKHRoaXMsZSk7dmFyIG89dGhpcy5nZXRDbGFzc0xpc3QoKTtmb3Iobi5jYWxsKHRoaXMsZSksaT0wO2k8by5sZW5ndGg7aSsrKWUuY2xhc3NMaXN0LnJlbW92ZShvW2ldKTtpZih0aGlzLmVsZW1lbnRDbGFzcylpZih0aGlzLmVsZW1lbnRDbGFzcyBpbnN0YW5jZW9mIEFycmF5KWZvcihpPTA7aTx0aGlzLmVsZW1lbnRDbGFzcy5sZW5ndGg7aSsrKWUuY2xhc3NMaXN0LnJlbW92ZSh0aGlzLmVsZW1lbnRDbGFzc1tpXSk7ZWxzZSBlLmNsYXNzTGlzdC5yZW1vdmUodGhpcy5lbGVtZW50Q2xhc3MpO3RoaXMuZGV0YWNoKGUpLHRoaXMuX2N1cnJlbnRUYXJnZXQ9bnVsbCx0LmRlYWxsb2NhdGUoZSl9LGUucHJvdG90eXBlLmRlcGxveT1mdW5jdGlvbih0KXt2YXIgaT10aGlzLmdldENvbnRlbnQoKTtpZihpIGluc3RhbmNlb2YgTm9kZSl7Zm9yKDt0Lmhhc0NoaWxkTm9kZXMoKTspdC5yZW1vdmVDaGlsZCh0LmZpcnN0Q2hpbGQpO3QuYXBwZW5kQ2hpbGQoaSl9ZWxzZSB0LmlubmVySFRNTD1pfSxlLnByb3RvdHlwZS5yZWNhbGw9ZnVuY3Rpb24odCl7Zm9yKHZhciBpPWRvY3VtZW50LmNyZWF0ZURvY3VtZW50RnJhZ21lbnQoKTt0Lmhhc0NoaWxkTm9kZXMoKTspaS5hcHBlbmRDaGlsZCh0LmZpcnN0Q2hpbGQpO3RoaXMuc2V0Q29udGVudChpKX0sZS5wcm90b3R5cGUuZ2V0U2l6ZT1mdW5jdGlvbigpe3JldHVybiB0aGlzLl9zaXplP3RoaXMuX3NpemU6dGhpcy5zaXplfSxlLnByb3RvdHlwZS5zZXRTaXplPWZ1bmN0aW9uKHQpe3JldHVybiB0aGlzLnNpemU9dD9bdFswXSx0WzFdXTpudWxsLHRoaXMuX3NpemVEaXJ0eT0hMCx0aGlzfSxpLmV4cG9ydHM9ZX0se1wiLi9FbGVtZW50T3V0cHV0XCI6M31dLDE1OltmdW5jdGlvbih0LGkpe2Z1bmN0aW9uIGUodCl7cmV0dXJuIDI9PT10Lmxlbmd0aD90WzBdKnRbMF0rdFsxXSp0WzFdOnRbMF0qdFswXSt0WzFdKnRbMV0rdFsyXSp0WzJdfWZ1bmN0aW9uIG4odCl7cmV0dXJuIE1hdGguc3FydChlKHQpKX1mdW5jdGlvbiBvKHQpe3JldHVybiAwPnQ/LTE6MX12YXIgcz17fTtzLnByZWNpc2lvbj0xZS02LHMuaWRlbnRpdHk9WzEsMCwwLDAsMCwxLDAsMCwwLDAsMSwwLDAsMCwwLDFdLHMubXVsdGlwbHk0eDQ9ZnVuY3Rpb24odCxpKXtyZXR1cm5bdFswXSppWzBdK3RbNF0qaVsxXSt0WzhdKmlbMl0rdFsxMl0qaVszXSx0WzFdKmlbMF0rdFs1XSppWzFdK3RbOV0qaVsyXSt0WzEzXSppWzNdLHRbMl0qaVswXSt0WzZdKmlbMV0rdFsxMF0qaVsyXSt0WzE0XSppWzNdLHRbM10qaVswXSt0WzddKmlbMV0rdFsxMV0qaVsyXSt0WzE1XSppWzNdLHRbMF0qaVs0XSt0WzRdKmlbNV0rdFs4XSppWzZdK3RbMTJdKmlbN10sdFsxXSppWzRdK3RbNV0qaVs1XSt0WzldKmlbNl0rdFsxM10qaVs3XSx0WzJdKmlbNF0rdFs2XSppWzVdK3RbMTBdKmlbNl0rdFsxNF0qaVs3XSx0WzNdKmlbNF0rdFs3XSppWzVdK3RbMTFdKmlbNl0rdFsxNV0qaVs3XSx0WzBdKmlbOF0rdFs0XSppWzldK3RbOF0qaVsxMF0rdFsxMl0qaVsxMV0sdFsxXSppWzhdK3RbNV0qaVs5XSt0WzldKmlbMTBdK3RbMTNdKmlbMTFdLHRbMl0qaVs4XSt0WzZdKmlbOV0rdFsxMF0qaVsxMF0rdFsxNF0qaVsxMV0sdFszXSppWzhdK3RbN10qaVs5XSt0WzExXSppWzEwXSt0WzE1XSppWzExXSx0WzBdKmlbMTJdK3RbNF0qaVsxM10rdFs4XSppWzE0XSt0WzEyXSppWzE1XSx0WzFdKmlbMTJdK3RbNV0qaVsxM10rdFs5XSppWzE0XSt0WzEzXSppWzE1XSx0WzJdKmlbMTJdK3RbNl0qaVsxM10rdFsxMF0qaVsxNF0rdFsxNF0qaVsxNV0sdFszXSppWzEyXSt0WzddKmlbMTNdK3RbMTFdKmlbMTRdK3RbMTVdKmlbMTVdXX0scy5tdWx0aXBseT1mdW5jdGlvbih0LGkpe3JldHVyblt0WzBdKmlbMF0rdFs0XSppWzFdK3RbOF0qaVsyXSx0WzFdKmlbMF0rdFs1XSppWzFdK3RbOV0qaVsyXSx0WzJdKmlbMF0rdFs2XSppWzFdK3RbMTBdKmlbMl0sMCx0WzBdKmlbNF0rdFs0XSppWzVdK3RbOF0qaVs2XSx0WzFdKmlbNF0rdFs1XSppWzVdK3RbOV0qaVs2XSx0WzJdKmlbNF0rdFs2XSppWzVdK3RbMTBdKmlbNl0sMCx0WzBdKmlbOF0rdFs0XSppWzldK3RbOF0qaVsxMF0sdFsxXSppWzhdK3RbNV0qaVs5XSt0WzldKmlbMTBdLHRbMl0qaVs4XSt0WzZdKmlbOV0rdFsxMF0qaVsxMF0sMCx0WzBdKmlbMTJdK3RbNF0qaVsxM10rdFs4XSppWzE0XSt0WzEyXSx0WzFdKmlbMTJdK3RbNV0qaVsxM10rdFs5XSppWzE0XSt0WzEzXSx0WzJdKmlbMTJdK3RbNl0qaVsxM10rdFsxMF0qaVsxNF0rdFsxNF0sMV1cbn0scy50aGVuTW92ZT1mdW5jdGlvbih0LGkpe3JldHVybiBpWzJdfHwoaVsyXT0wKSxbdFswXSx0WzFdLHRbMl0sMCx0WzRdLHRbNV0sdFs2XSwwLHRbOF0sdFs5XSx0WzEwXSwwLHRbMTJdK2lbMF0sdFsxM10raVsxXSx0WzE0XStpWzJdLDFdfSxzLm1vdmVUaGVuPWZ1bmN0aW9uKHQsaSl7dFsyXXx8KHRbMl09MCk7dmFyIGU9dFswXSppWzBdK3RbMV0qaVs0XSt0WzJdKmlbOF0sbj10WzBdKmlbMV0rdFsxXSppWzVdK3RbMl0qaVs5XSxvPXRbMF0qaVsyXSt0WzFdKmlbNl0rdFsyXSppWzEwXTtyZXR1cm4gcy50aGVuTW92ZShpLFtlLG4sb10pfSxzLnRyYW5zbGF0ZT1mdW5jdGlvbih0LGksZSl7cmV0dXJuIHZvaWQgMD09PWUmJihlPTApLFsxLDAsMCwwLDAsMSwwLDAsMCwwLDEsMCx0LGksZSwxXX0scy50aGVuU2NhbGU9ZnVuY3Rpb24odCxpKXtyZXR1cm5baVswXSp0WzBdLGlbMV0qdFsxXSxpWzJdKnRbMl0sMCxpWzBdKnRbNF0saVsxXSp0WzVdLGlbMl0qdFs2XSwwLGlbMF0qdFs4XSxpWzFdKnRbOV0saVsyXSp0WzEwXSwwLGlbMF0qdFsxMl0saVsxXSp0WzEzXSxpWzJdKnRbMTRdLDFdfSxzLnNjYWxlPWZ1bmN0aW9uKHQsaSxlKXtyZXR1cm4gdm9pZCAwPT09ZSYmKGU9MSksdm9pZCAwPT09aSYmKGk9dCksW3QsMCwwLDAsMCxpLDAsMCwwLDAsZSwwLDAsMCwwLDFdfSxzLnJvdGF0ZVg9ZnVuY3Rpb24odCl7dmFyIGk9TWF0aC5jb3ModCksZT1NYXRoLnNpbih0KTtyZXR1cm5bMSwwLDAsMCwwLGksZSwwLDAsLWUsaSwwLDAsMCwwLDFdfSxzLnJvdGF0ZVk9ZnVuY3Rpb24odCl7dmFyIGk9TWF0aC5jb3ModCksZT1NYXRoLnNpbih0KTtyZXR1cm5baSwwLC1lLDAsMCwxLDAsMCxlLDAsaSwwLDAsMCwwLDFdfSxzLnJvdGF0ZVo9ZnVuY3Rpb24odCl7dmFyIGk9TWF0aC5jb3ModCksZT1NYXRoLnNpbih0KTtyZXR1cm5baSxlLDAsMCwtZSxpLDAsMCwwLDAsMSwwLDAsMCwwLDFdfSxzLnJvdGF0ZT1mdW5jdGlvbih0LGksZSl7dmFyIG49TWF0aC5jb3ModCksbz1NYXRoLnNpbih0KSxzPU1hdGguY29zKGkpLHI9TWF0aC5zaW4oaSksYT1NYXRoLmNvcyhlKSxoPU1hdGguc2luKGUpLGM9W3MqYSxuKmgrbypyKmEsbypoLW4qciphLDAsLXMqaCxuKmEtbypyKmgsbyphK24qcipoLDAsciwtbypzLG4qcywwLDAsMCwwLDFdO3JldHVybiBjfSxzLnJvdGF0ZUF4aXM9ZnVuY3Rpb24odCxpKXt2YXIgZT1NYXRoLnNpbihpKSxuPU1hdGguY29zKGkpLG89MS1uLHM9dFswXSp0WzBdKm8scj10WzBdKnRbMV0qbyxhPXRbMF0qdFsyXSpvLGg9dFsxXSp0WzFdKm8sYz10WzFdKnRbMl0qbyxwPXRbMl0qdFsyXSpvLHU9dFswXSplLGw9dFsxXSplLGY9dFsyXSplLGQ9W3MrbixyK2YsYS1sLDAsci1mLGgrbixjK3UsMCxhK2wsYy11LHArbiwwLDAsMCwwLDFdO3JldHVybiBkfSxzLmFib3V0T3JpZ2luPWZ1bmN0aW9uKHQsaSl7dmFyIGU9dFswXS0odFswXSppWzBdK3RbMV0qaVs0XSt0WzJdKmlbOF0pLG49dFsxXS0odFswXSppWzFdK3RbMV0qaVs1XSt0WzJdKmlbOV0pLG89dFsyXS0odFswXSppWzJdK3RbMV0qaVs2XSt0WzJdKmlbMTBdKTtyZXR1cm4gcy50aGVuTW92ZShpLFtlLG4sb10pfSxzLnNrZXc9ZnVuY3Rpb24odCxpLGUpe3JldHVyblsxLE1hdGgudGFuKGkpLDAsMCxNYXRoLnRhbihlKSwxLDAsMCwwLE1hdGgudGFuKHQpLDEsMCwwLDAsMCwxXX0scy5za2V3WD1mdW5jdGlvbih0KXtyZXR1cm5bMSwwLDAsMCxNYXRoLnRhbih0KSwxLDAsMCwwLDAsMSwwLDAsMCwwLDFdfSxzLnNrZXdZPWZ1bmN0aW9uKHQpe3JldHVyblsxLE1hdGgudGFuKHQpLDAsMCwwLDEsMCwwLDAsMCwxLDAsMCwwLDAsMV19LHMucGVyc3BlY3RpdmU9ZnVuY3Rpb24odCl7cmV0dXJuWzEsMCwwLDAsMCwxLDAsMCwwLDAsMSwtMS90LDAsMCwwLDFdfSxzLmdldFRyYW5zbGF0ZT1mdW5jdGlvbih0KXtyZXR1cm5bdFsxMl0sdFsxM10sdFsxNF1dfSxzLmludmVyc2U9ZnVuY3Rpb24odCl7dmFyIGk9dFs1XSp0WzEwXS10WzZdKnRbOV0sZT10WzRdKnRbMTBdLXRbNl0qdFs4XSxuPXRbNF0qdFs5XS10WzVdKnRbOF0sbz10WzFdKnRbMTBdLXRbMl0qdFs5XSxzPXRbMF0qdFsxMF0tdFsyXSp0WzhdLHI9dFswXSp0WzldLXRbMV0qdFs4XSxhPXRbMV0qdFs2XS10WzJdKnRbNV0saD10WzBdKnRbNl0tdFsyXSp0WzRdLGM9dFswXSp0WzVdLXRbMV0qdFs0XSxwPXRbMF0qaS10WzFdKmUrdFsyXSpuLHU9MS9wLGw9W3UqaSwtdSpvLHUqYSwwLC11KmUsdSpzLC11KmgsMCx1Km4sLXUqcix1KmMsMCwwLDAsMCwxXTtyZXR1cm4gbFsxMl09LXRbMTJdKmxbMF0tdFsxM10qbFs0XS10WzE0XSpsWzhdLGxbMTNdPS10WzEyXSpsWzFdLXRbMTNdKmxbNV0tdFsxNF0qbFs5XSxsWzE0XT0tdFsxMl0qbFsyXS10WzEzXSpsWzZdLXRbMTRdKmxbMTBdLGx9LHMudHJhbnNwb3NlPWZ1bmN0aW9uKHQpe3JldHVyblt0WzBdLHRbNF0sdFs4XSx0WzEyXSx0WzFdLHRbNV0sdFs5XSx0WzEzXSx0WzJdLHRbNl0sdFsxMF0sdFsxNF0sdFszXSx0WzddLHRbMTFdLHRbMTVdXX0scy5pbnRlcnByZXQ9ZnVuY3Rpb24odCl7dmFyIGk9W3RbMF0sdFsxXSx0WzJdXSxyPW8oaVswXSksYT1uKGkpLGg9W2lbMF0rciphLGlbMV0saVsyXV0sYz0yL2UoaCk7aWYoYz49MS8wKXJldHVybnt0cmFuc2xhdGU6cy5nZXRUcmFuc2xhdGUodCkscm90YXRlOlswLDAsMF0sc2NhbGU6WzAsMCwwXSxza2V3OlswLDAsMF19O3ZhciBwPVswLDAsMCwwLDAsMCwwLDAsMCwwLDAsMCwwLDAsMCwxXTtwWzBdPTEtYypoWzBdKmhbMF0scFs1XT0xLWMqaFsxXSpoWzFdLHBbMTBdPTEtYypoWzJdKmhbMl0scFsxXT0tYypoWzBdKmhbMV0scFsyXT0tYypoWzBdKmhbMl0scFs2XT0tYypoWzFdKmhbMl0scFs0XT1wWzFdLHBbOF09cFsyXSxwWzldPXBbNl07dmFyIHU9cy5tdWx0aXBseShwLHQpLGw9W3VbNV0sdVs2XV0sZj1vKGxbMF0pLGQ9bihsKSxfPVtsWzBdK2YqZCxsWzFdXSx5PTIvZShfKSxnPVsxLDAsMCwwLDAsMCwwLDAsMCwwLDAsMCwwLDAsMCwxXTtnWzVdPTEteSpfWzBdKl9bMF0sZ1sxMF09MS15Kl9bMV0qX1sxXSxnWzZdPS15Kl9bMF0qX1sxXSxnWzldPWdbNl07dmFyIHY9cy5tdWx0aXBseShnLHApLG09cy5tdWx0aXBseSh2LHQpLE89cy5zY2FsZShtWzBdPDA/LTE6MSxtWzVdPDA/LTE6MSxtWzEwXTwwPy0xOjEpO209cy5tdWx0aXBseShtLE8pLHY9cy5tdWx0aXBseShPLHYpO3ZhciBTPXt9O3JldHVybiBTLnRyYW5zbGF0ZT1zLmdldFRyYW5zbGF0ZSh0KSxTLnJvdGF0ZT1bTWF0aC5hdGFuMigtdls2XSx2WzEwXSksTWF0aC5hc2luKHZbMl0pLE1hdGguYXRhbjIoLXZbMV0sdlswXSldLFMucm90YXRlWzBdfHwoUy5yb3RhdGVbMF09MCxTLnJvdGF0ZVsyXT1NYXRoLmF0YW4yKHZbNF0sdls1XSkpLFMuc2NhbGU9W21bMF0sbVs1XSxtWzEwXV0sUy5za2V3PVtNYXRoLmF0YW4yKG1bOV0sUy5zY2FsZVsyXSksTWF0aC5hdGFuMihtWzhdLFMuc2NhbGVbMl0pLE1hdGguYXRhbjIobVs0XSxTLnNjYWxlWzBdKV0sTWF0aC5hYnMoUy5yb3RhdGVbMF0pK01hdGguYWJzKFMucm90YXRlWzJdKT4xLjUqTWF0aC5QSSYmKFMucm90YXRlWzFdPU1hdGguUEktUy5yb3RhdGVbMV0sUy5yb3RhdGVbMV0+TWF0aC5QSSYmKFMucm90YXRlWzFdLT0yKk1hdGguUEkpLFMucm90YXRlWzFdPC1NYXRoLlBJJiYoUy5yb3RhdGVbMV0rPTIqTWF0aC5QSSksUy5yb3RhdGVbMF08MD9TLnJvdGF0ZVswXSs9TWF0aC5QSTpTLnJvdGF0ZVswXS09TWF0aC5QSSxTLnJvdGF0ZVsyXTwwP1Mucm90YXRlWzJdKz1NYXRoLlBJOlMucm90YXRlWzJdLT1NYXRoLlBJKSxTfSxzLmF2ZXJhZ2U9ZnVuY3Rpb24odCxpLGUpe2U9dm9pZCAwPT09ZT8uNTplO2Zvcih2YXIgbj1zLmludGVycHJldCh0KSxvPXMuaW50ZXJwcmV0KGkpLHI9e3RyYW5zbGF0ZTpbMCwwLDBdLHJvdGF0ZTpbMCwwLDBdLHNjYWxlOlswLDAsMF0sc2tldzpbMCwwLDBdfSxhPTA7Mz5hO2ErKylyLnRyYW5zbGF0ZVthXT0oMS1lKSpuLnRyYW5zbGF0ZVthXStlKm8udHJhbnNsYXRlW2FdLHIucm90YXRlW2FdPSgxLWUpKm4ucm90YXRlW2FdK2Uqby5yb3RhdGVbYV0sci5zY2FsZVthXT0oMS1lKSpuLnNjYWxlW2FdK2Uqby5zY2FsZVthXSxyLnNrZXdbYV09KDEtZSkqbi5za2V3W2FdK2Uqby5za2V3W2FdO3JldHVybiBzLmJ1aWxkKHIpfSxzLmJ1aWxkPWZ1bmN0aW9uKHQpe3ZhciBpPXMuc2NhbGUodC5zY2FsZVswXSx0LnNjYWxlWzFdLHQuc2NhbGVbMl0pLGU9cy5za2V3KHQuc2tld1swXSx0LnNrZXdbMV0sdC5za2V3WzJdKSxuPXMucm90YXRlKHQucm90YXRlWzBdLHQucm90YXRlWzFdLHQucm90YXRlWzJdKTtyZXR1cm4gcy50aGVuTW92ZShzLm11bHRpcGx5KHMubXVsdGlwbHkobixlKSxpKSx0LnRyYW5zbGF0ZSl9LHMuZXF1YWxzPWZ1bmN0aW9uKHQsaSl7cmV0dXJuIXMubm90RXF1YWxzKHQsaSl9LHMubm90RXF1YWxzPWZ1bmN0aW9uKHQsaSl7cmV0dXJuIHQ9PT1pPyExOiEodCYmaSl8fHRbMTJdIT09aVsxMl18fHRbMTNdIT09aVsxM118fHRbMTRdIT09aVsxNF18fHRbMF0hPT1pWzBdfHx0WzFdIT09aVsxXXx8dFsyXSE9PWlbMl18fHRbNF0hPT1pWzRdfHx0WzVdIT09aVs1XXx8dFs2XSE9PWlbNl18fHRbOF0hPT1pWzhdfHx0WzldIT09aVs5XXx8dFsxMF0hPT1pWzEwXX0scy5ub3JtYWxpemVSb3RhdGlvbj1mdW5jdGlvbih0KXt2YXIgaT10LnNsaWNlKDApO2ZvcigoaVswXT09PS41Kk1hdGguUEl8fGlbMF09PT0uNSotTWF0aC5QSSkmJihpWzBdPS1pWzBdLGlbMV09TWF0aC5QSS1pWzFdLGlbMl0tPU1hdGguUEkpLGlbMF0+LjUqTWF0aC5QSSYmKGlbMF09aVswXS1NYXRoLlBJLGlbMV09TWF0aC5QSS1pWzFdLGlbMl0tPU1hdGguUEkpLGlbMF08LjUqLU1hdGguUEkmJihpWzBdPWlbMF0rTWF0aC5QSSxpWzFdPS1NYXRoLlBJLWlbMV0saVsyXS09TWF0aC5QSSk7aVsxXTwtTWF0aC5QSTspaVsxXSs9MipNYXRoLlBJO2Zvcig7aVsxXT49TWF0aC5QSTspaVsxXS09MipNYXRoLlBJO2Zvcig7aVsyXTwtTWF0aC5QSTspaVsyXSs9MipNYXRoLlBJO2Zvcig7aVsyXT49TWF0aC5QSTspaVsyXS09MipNYXRoLlBJO3JldHVybiBpfSxzLmluRnJvbnQ9WzEsMCwwLDAsMCwxLDAsMCwwLDAsMSwwLDAsMCwuMDAxLDFdLHMuYmVoaW5kPVsxLDAsMCwwLDAsMSwwLDAsMCwwLDEsMCwwLDAsLS4wMDEsMV0saS5leHBvcnRzPXN9LHt9XSwxNjpbZnVuY3Rpb24odCxpKXtmdW5jdGlvbiBlKHQpe3RoaXMuX25vZGU9bmV3IHMsdGhpcy5fZXZlbnRJbnB1dD1uZXcgbix0aGlzLl9ldmVudE91dHB1dD1uZXcgbixuLnNldElucHV0SGFuZGxlcih0aGlzLHRoaXMuX2V2ZW50SW5wdXQpLG4uc2V0T3V0cHV0SGFuZGxlcih0aGlzLHRoaXMuX2V2ZW50T3V0cHV0KSx0aGlzLm9wdGlvbnM9ci5jbG9uZSh0aGlzLmNvbnN0cnVjdG9yLkRFRkFVTFRfT1BUSU9OU3x8ZS5ERUZBVUxUX09QVElPTlMpLHRoaXMuX29wdGlvbnNNYW5hZ2VyPW5ldyBvKHRoaXMub3B0aW9ucyksdCYmdGhpcy5zZXRPcHRpb25zKHQpfXZhciBuPXQoXCIuL0V2ZW50SGFuZGxlclwiKSxvPXQoXCIuL09wdGlvbnNNYW5hZ2VyXCIpLHM9dChcIi4vUmVuZGVyTm9kZVwiKSxyPXQoXCIuLi91dGlsaXRpZXMvVXRpbGl0eVwiKTtlLkRFRkFVTFRfT1BUSU9OUz17fSxlLnByb3RvdHlwZS5nZXRPcHRpb25zPWZ1bmN0aW9uKHQpe3JldHVybiB0aGlzLl9vcHRpb25zTWFuYWdlci5nZXRPcHRpb25zKHQpfSxlLnByb3RvdHlwZS5zZXRPcHRpb25zPWZ1bmN0aW9uKHQpe3RoaXMuX29wdGlvbnNNYW5hZ2VyLnBhdGNoKHQpfSxlLnByb3RvdHlwZS5hZGQ9ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5fbm9kZS5hZGQuYXBwbHkodGhpcy5fbm9kZSxhcmd1bWVudHMpfSxlLnByb3RvdHlwZS5fYWRkPWUucHJvdG90eXBlLmFkZCxlLnByb3RvdHlwZS5yZW5kZXI9ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5fbm9kZS5yZW5kZXIoKX0sZS5wcm90b3R5cGUuZ2V0U2l6ZT1mdW5jdGlvbigpe3JldHVybiB0aGlzLl9ub2RlJiZ0aGlzLl9ub2RlLmdldFNpemU/dGhpcy5fbm9kZS5nZXRTaXplLmFwcGx5KHRoaXMuX25vZGUsYXJndW1lbnRzKXx8dGhpcy5vcHRpb25zLnNpemU6dGhpcy5vcHRpb25zLnNpemV9LGkuZXhwb3J0cz1lfSx7XCIuLi91dGlsaXRpZXMvVXRpbGl0eVwiOjk1LFwiLi9FdmVudEhhbmRsZXJcIjo3LFwiLi9PcHRpb25zTWFuYWdlclwiOjEwLFwiLi9SZW5kZXJOb2RlXCI6MTF9XSwxNzpbZnVuY3Rpb24odCxpKXtmdW5jdGlvbiBlKHQpe3R8fCh0PVtdKSx0IGluc3RhbmNlb2YgQXJyYXkmJih0PXthcnJheTp0fSksdGhpcy5fPW51bGwsdGhpcy5pbmRleD10LmluZGV4fHwwLHQuYXJyYXk/dGhpcy5fPW5ldyB0aGlzLmNvbnN0cnVjdG9yLkJhY2tpbmcodC5hcnJheSk6dC5fJiYodGhpcy5fPXQuXyksdGhpcy5pbmRleD09PXRoaXMuXy5maXJzdEluZGV4JiYodGhpcy5fLmZpcnN0Tm9kZT10aGlzKSx0aGlzLmluZGV4PT09dGhpcy5fLmZpcnN0SW5kZXgrdGhpcy5fLmFycmF5Lmxlbmd0aC0xJiYodGhpcy5fLmxhc3ROb2RlPXRoaXMpLHZvaWQgMCE9PXQubG9vcCYmKHRoaXMuXy5sb29wPXQubG9vcCksdm9pZCAwIT09dC50cmFja1NpemUmJih0aGlzLl8udHJhY2tTaXplPXQudHJhY2tTaXplKSx0aGlzLl9wcmV2aW91c05vZGU9bnVsbCx0aGlzLl9uZXh0Tm9kZT1udWxsfWUuQmFja2luZz1mdW5jdGlvbih0KXt0aGlzLmFycmF5PXQsdGhpcy5maXJzdEluZGV4PTAsdGhpcy5sb29wPSExLHRoaXMuZmlyc3ROb2RlPW51bGwsdGhpcy5sYXN0Tm9kZT1udWxsLHRoaXMuY3VtdWxhdGl2ZVNpemVzPVtbMCwwXV0sdGhpcy5zaXplRGlydHk9ITAsdGhpcy50cmFja1NpemU9ITF9LGUuQmFja2luZy5wcm90b3R5cGUuZ2V0VmFsdWU9ZnVuY3Rpb24odCl7dmFyIGk9dC10aGlzLmZpcnN0SW5kZXg7cmV0dXJuIDA+aXx8aT49dGhpcy5hcnJheS5sZW5ndGg/bnVsbDp0aGlzLmFycmF5W2ldfSxlLkJhY2tpbmcucHJvdG90eXBlLnNldFZhbHVlPWZ1bmN0aW9uKHQsaSl7dGhpcy5hcnJheVt0LXRoaXMuZmlyc3RJbmRleF09aX0sZS5CYWNraW5nLnByb3RvdHlwZS5nZXRTaXplPWZ1bmN0aW9uKHQpe3JldHVybiB0aGlzLmN1bXVsYXRpdmVTaXplc1t0XX0sZS5CYWNraW5nLnByb3RvdHlwZS5jYWxjdWxhdGVTaXplPWZ1bmN0aW9uKHQpe3Q9dHx8dGhpcy5hcnJheS5sZW5ndGg7Zm9yKHZhciBpPVswLDBdLGU9MDt0PmU7ZSsrKXt2YXIgbj10aGlzLmFycmF5W2VdLmdldFNpemUoKTtpZighbilyZXR1cm4gdm9pZCAwO3ZvaWQgMCE9PWlbMF0mJih2b2lkIDA9PT1uWzBdP2lbMF09dm9pZCAwOmlbMF0rPW5bMF0pLHZvaWQgMCE9PWlbMV0mJih2b2lkIDA9PT1uWzFdP2lbMV09dm9pZCAwOmlbMV0rPW5bMV0pLHRoaXMuY3VtdWxhdGl2ZVNpemVzW2UrMV09aS5zbGljZSgpfXJldHVybiB0aGlzLnNpemVEaXJ0eT0hMSxpfSxlLkJhY2tpbmcucHJvdG90eXBlLnJlaW5kZXg9ZnVuY3Rpb24odCxpLGUpe2lmKHRoaXMuYXJyYXlbMF0pe2Zvcih2YXIgbj0wLG89dGhpcy5maXJzdEluZGV4LHM9ZS1pLHI9dGhpcy5maXJzdE5vZGU7dC0xPm87KXI9ci5nZXROZXh0KCksbysrO3ZhciBhPXI7Zm9yKG49MDtpPm47bisrKXI9ci5nZXROZXh0KCksciYmKHIuX3ByZXZpb3VzTm9kZT1hKTt2YXIgaD1yP3IuZ2V0TmV4dCgpOm51bGw7Zm9yKGEuX25leHROb2RlPW51bGwscj1hLG49MDtlPm47bisrKXI9ci5nZXROZXh0KCk7aWYobys9ZSxyIT09aCYmKHIuX25leHROb2RlPWgsaCYmKGguX3ByZXZpb3VzTm9kZT1yKSksaClmb3Iocj1oLG8rKztyJiZvPHRoaXMuYXJyYXkubGVuZ3RoK3RoaXMuZmlyc3RJbmRleDspci5fbmV4dE5vZGU/ci5pbmRleCs9czpyLmluZGV4PW8scj1yLmdldE5leHQoKSxvKys7dGhpcy50cmFja1NpemUmJih0aGlzLnNpemVEaXJ0eT0hMCl9fSxlLnByb3RvdHlwZS5nZXRQcmV2aW91cz1mdW5jdGlvbigpe3ZhciB0PXRoaXMuXy5hcnJheS5sZW5ndGg7cmV0dXJuIHQ/dGhpcy5pbmRleD09PXRoaXMuXy5maXJzdEluZGV4P3RoaXMuXy5sb29wPyh0aGlzLl9wcmV2aW91c05vZGU9dGhpcy5fLmxhc3ROb2RlfHxuZXcgdGhpcy5jb25zdHJ1Y3Rvcih7Xzp0aGlzLl8saW5kZXg6dGhpcy5fLmZpcnN0SW5kZXgrdC0xfSksdGhpcy5fcHJldmlvdXNOb2RlLl9uZXh0Tm9kZT10aGlzKTp0aGlzLl9wcmV2aW91c05vZGU9bnVsbDp0aGlzLl9wcmV2aW91c05vZGV8fCh0aGlzLl9wcmV2aW91c05vZGU9bmV3IHRoaXMuY29uc3RydWN0b3Ioe186dGhpcy5fLGluZGV4OnRoaXMuaW5kZXgtMX0pLHRoaXMuX3ByZXZpb3VzTm9kZS5fbmV4dE5vZGU9dGhpcyk6dGhpcy5fcHJldmlvdXNOb2RlPW51bGwsdGhpcy5fcHJldmlvdXNOb2RlfSxlLnByb3RvdHlwZS5nZXROZXh0PWZ1bmN0aW9uKCl7dmFyIHQ9dGhpcy5fLmFycmF5Lmxlbmd0aDtyZXR1cm4gdD90aGlzLmluZGV4PT09dGhpcy5fLmZpcnN0SW5kZXgrdC0xP3RoaXMuXy5sb29wPyh0aGlzLl9uZXh0Tm9kZT10aGlzLl8uZmlyc3ROb2RlfHxuZXcgdGhpcy5jb25zdHJ1Y3Rvcih7Xzp0aGlzLl8saW5kZXg6dGhpcy5fLmZpcnN0SW5kZXh9KSx0aGlzLl9uZXh0Tm9kZS5fcHJldmlvdXNOb2RlPXRoaXMpOnRoaXMuX25leHROb2RlPW51bGw6dGhpcy5fbmV4dE5vZGV8fCh0aGlzLl9uZXh0Tm9kZT1uZXcgdGhpcy5jb25zdHJ1Y3Rvcih7Xzp0aGlzLl8saW5kZXg6dGhpcy5pbmRleCsxfSksdGhpcy5fbmV4dE5vZGUuX3ByZXZpb3VzTm9kZT10aGlzKTp0aGlzLl9uZXh0Tm9kZT1udWxsLHRoaXMuX25leHROb2RlfSxlLnByb3RvdHlwZS5pbmRleE9mPWZ1bmN0aW9uKHQpe3JldHVybiB0aGlzLl8uYXJyYXkuaW5kZXhPZih0KX0sZS5wcm90b3R5cGUuZ2V0SW5kZXg9ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5pbmRleH0sZS5wcm90b3R5cGUudG9TdHJpbmc9ZnVuY3Rpb24oKXtyZXR1cm5cIlwiK3RoaXMuaW5kZXh9LGUucHJvdG90eXBlLnVuc2hpZnQ9ZnVuY3Rpb24oKXt0aGlzLl8uYXJyYXkudW5zaGlmdC5hcHBseSh0aGlzLl8uYXJyYXksYXJndW1lbnRzKSx0aGlzLl8uZmlyc3RJbmRleC09YXJndW1lbnRzLmxlbmd0aCx0aGlzLl8udHJhY2tTaXplJiYodGhpcy5fLnNpemVEaXJ0eT0hMCl9LGUucHJvdG90eXBlLnB1c2g9ZnVuY3Rpb24oKXt0aGlzLl8uYXJyYXkucHVzaC5hcHBseSh0aGlzLl8uYXJyYXksYXJndW1lbnRzKSx0aGlzLl8udHJhY2tTaXplJiYodGhpcy5fLnNpemVEaXJ0eT0hMCl9LGUucHJvdG90eXBlLnNwbGljZT1mdW5jdGlvbih0LGkpe3ZhciBlPUFycmF5LnByb3RvdHlwZS5zbGljZS5jYWxsKGFyZ3VtZW50cywyKTt0aGlzLl8uYXJyYXkuc3BsaWNlLmFwcGx5KHRoaXMuXy5hcnJheSxbdC10aGlzLl8uZmlyc3RJbmRleCxpXS5jb25jYXQoZSkpLHRoaXMuXy5yZWluZGV4KHQsaSxlLmxlbmd0aCl9LGUucHJvdG90eXBlLnN3YXA9ZnVuY3Rpb24odCl7dmFyIGk9dC5nZXQoKSxlPXRoaXMuZ2V0KCk7dGhpcy5fLnNldFZhbHVlKHRoaXMuaW5kZXgsaSksdGhpcy5fLnNldFZhbHVlKHQuaW5kZXgsZSk7dmFyIG49dGhpcy5fcHJldmlvdXNOb2RlLG89dGhpcy5fbmV4dE5vZGUscz10aGlzLmluZGV4LHI9dC5fcHJldmlvdXNOb2RlLGE9dC5fbmV4dE5vZGUsaD10LmluZGV4O3RoaXMuaW5kZXg9aCx0aGlzLl9wcmV2aW91c05vZGU9cj09PXRoaXM/dDpyLHRoaXMuX3ByZXZpb3VzTm9kZSYmKHRoaXMuX3ByZXZpb3VzTm9kZS5fbmV4dE5vZGU9dGhpcyksdGhpcy5fbmV4dE5vZGU9YT09PXRoaXM/dDphLHRoaXMuX25leHROb2RlJiYodGhpcy5fbmV4dE5vZGUuX3ByZXZpb3VzTm9kZT10aGlzKSx0LmluZGV4PXMsdC5fcHJldmlvdXNOb2RlPW49PT10P3RoaXM6bix0Ll9wcmV2aW91c05vZGUmJih0Ll9wcmV2aW91c05vZGUuX25leHROb2RlPXQpLHQuX25leHROb2RlPW89PT10P3RoaXM6byx0Ll9uZXh0Tm9kZSYmKHQuX25leHROb2RlLl9wcmV2aW91c05vZGU9dCksdGhpcy5pbmRleD09PXRoaXMuXy5maXJzdEluZGV4P3RoaXMuXy5maXJzdE5vZGU9dGhpczp0aGlzLmluZGV4PT09dGhpcy5fLmZpcnN0SW5kZXgrdGhpcy5fLmFycmF5Lmxlbmd0aC0xJiYodGhpcy5fLmxhc3ROb2RlPXRoaXMpLHQuaW5kZXg9PT10aGlzLl8uZmlyc3RJbmRleD90aGlzLl8uZmlyc3ROb2RlPXQ6dC5pbmRleD09PXRoaXMuXy5maXJzdEluZGV4K3RoaXMuXy5hcnJheS5sZW5ndGgtMSYmKHRoaXMuXy5sYXN0Tm9kZT10KSx0aGlzLl8udHJhY2tTaXplJiYodGhpcy5fLnNpemVEaXJ0eT0hMCl9LGUucHJvdG90eXBlLmdldD1mdW5jdGlvbigpe3JldHVybiB0aGlzLl8uZ2V0VmFsdWUodGhpcy5pbmRleCl9LGUucHJvdG90eXBlLmdldFNpemU9ZnVuY3Rpb24oKXt2YXIgdD10aGlzLmdldCgpO3JldHVybiB0P3QuZ2V0U2l6ZSgpOm51bGx9LGUucHJvdG90eXBlLnJlbmRlcj1mdW5jdGlvbigpe3RoaXMuXy50cmFja1NpemUmJnRoaXMuXy5zaXplRGlydHkmJnRoaXMuXy5jYWxjdWxhdGVTaXplKCk7dmFyIHQ9dGhpcy5nZXQoKTtyZXR1cm4gdD90LnJlbmRlci5hcHBseSh0LGFyZ3VtZW50cyk6bnVsbH0saS5leHBvcnRzPWV9LHt9XSwxODpbZnVuY3Rpb24odCxpKXtpLmV4cG9ydHM9e0NvbnRleHQ6dChcIi4vQ29udGV4dFwiKSxFbGVtZW50QWxsb2NhdG9yOnQoXCIuL0VsZW1lbnRBbGxvY2F0b3JcIiksRWxlbWVudE91dHB1dDp0KFwiLi9FbGVtZW50T3V0cHV0XCIpLEVuZ2luZTp0KFwiLi9FbmdpbmVcIiksRW50aXR5OnQoXCIuL0VudGl0eVwiKSxFdmVudEVtaXR0ZXI6dChcIi4vRXZlbnRFbWl0dGVyXCIpLEV2ZW50SGFuZGxlcjp0KFwiLi9FdmVudEhhbmRsZXJcIiksR3JvdXA6dChcIi4vR3JvdXBcIiksTW9kaWZpZXI6dChcIi4vTW9kaWZpZXJcIiksT3B0aW9uc01hbmFnZXI6dChcIi4vT3B0aW9uc01hbmFnZXJcIiksUmVuZGVyTm9kZTp0KFwiLi9SZW5kZXJOb2RlXCIpLFNjZW5lOnQoXCIuL1NjZW5lXCIpLFNwZWNQYXJzZXI6dChcIi4vU3BlY1BhcnNlclwiKSxTdXJmYWNlOnQoXCIuL1N1cmZhY2VcIiksVHJhbnNmb3JtOnQoXCIuL1RyYW5zZm9ybVwiKSxWaWV3OnQoXCIuL1ZpZXdcIiksVmlld1NlcXVlbmNlOnQoXCIuL1ZpZXdTZXF1ZW5jZVwiKX19LHtcIi4vQ29udGV4dFwiOjEsXCIuL0VsZW1lbnRBbGxvY2F0b3JcIjoyLFwiLi9FbGVtZW50T3V0cHV0XCI6MyxcIi4vRW5naW5lXCI6NCxcIi4vRW50aXR5XCI6NSxcIi4vRXZlbnRFbWl0dGVyXCI6NixcIi4vRXZlbnRIYW5kbGVyXCI6NyxcIi4vR3JvdXBcIjo4LFwiLi9Nb2RpZmllclwiOjksXCIuL09wdGlvbnNNYW5hZ2VyXCI6MTAsXCIuL1JlbmRlck5vZGVcIjoxMSxcIi4vU2NlbmVcIjoxMixcIi4vU3BlY1BhcnNlclwiOjEzLFwiLi9TdXJmYWNlXCI6MTQsXCIuL1RyYW5zZm9ybVwiOjE1LFwiLi9WaWV3XCI6MTYsXCIuL1ZpZXdTZXF1ZW5jZVwiOjE3fV0sMTk6W2Z1bmN0aW9uKHQsaSl7ZnVuY3Rpb24gZSh0KXt0aGlzLmRpc3BhdGNoZXJzPXt9LHRoaXMuY3Vyck1vZGU9dm9pZCAwLHRoaXMuc2V0TW9kZSh0KX12YXIgbj10KFwiLi4vY29yZS9FdmVudEhhbmRsZXJcIik7ZS5wcm90b3R5cGUuc2V0TW9kZT1mdW5jdGlvbih0KXtpZih0IT09dGhpcy5jdXJyTW9kZSl7dmFyIGk9dGhpcy5jdXJyTW9kZTt0aGlzLmRpc3BhdGNoZXJzW3RoaXMuY3Vyck1vZGVdJiZ0aGlzLmRpc3BhdGNoZXJzW3RoaXMuY3Vyck1vZGVdLnRyaWdnZXIoXCJ1bnBpcGVcIiksdGhpcy5jdXJyTW9kZT10LHRoaXMuZGlzcGF0Y2hlcnNbdF0mJnRoaXMuZGlzcGF0Y2hlcnNbdF0uZW1pdChcInBpcGVcIiksdGhpcy5lbWl0KFwiY2hhbmdlXCIse2Zyb206aSx0bzp0fSl9fSxlLnByb3RvdHlwZS5mb3JNb2RlPWZ1bmN0aW9uKHQpe3JldHVybiB0aGlzLmRpc3BhdGNoZXJzW3RdfHwodGhpcy5kaXNwYXRjaGVyc1t0XT1uZXcgbiksdGhpcy5kaXNwYXRjaGVyc1t0XX0sZS5wcm90b3R5cGUuZW1pdD1mdW5jdGlvbih0LGkpe2lmKHZvaWQgMD09PXRoaXMuY3Vyck1vZGUpcmV0dXJuITE7aXx8KGk9e30pO3ZhciBlPXRoaXMuZGlzcGF0Y2hlcnNbdGhpcy5jdXJyTW9kZV07cmV0dXJuIGU/ZS50cmlnZ2VyKHQsaSk6dm9pZCAwfSxpLmV4cG9ydHM9ZX0se1wiLi4vY29yZS9FdmVudEhhbmRsZXJcIjo3fV0sMjA6W2Z1bmN0aW9uKHQsaSl7ZnVuY3Rpb24gZSh0KXtuLmNhbGwodGhpcyksdGhpcy5fY29uZGl0aW9uPXR9dmFyIG49dChcIi4uL2NvcmUvRXZlbnRIYW5kbGVyXCIpO2UucHJvdG90eXBlPU9iamVjdC5jcmVhdGUobi5wcm90b3R5cGUpLGUucHJvdG90eXBlLmNvbnN0cnVjdG9yPWUsZS5wcm90b3R5cGUuZW1pdD1mdW5jdGlvbih0LGkpe3JldHVybiB0aGlzLl9jb25kaXRpb24odCxpKT9uLnByb3RvdHlwZS5lbWl0LmFwcGx5KHRoaXMsYXJndW1lbnRzKTp2b2lkIDB9LGUucHJvdG90eXBlLnRyaWdnZXI9ZS5wcm90b3R5cGUuZW1pdCxpLmV4cG9ydHM9ZX0se1wiLi4vY29yZS9FdmVudEhhbmRsZXJcIjo3fV0sMjE6W2Z1bmN0aW9uKHQsaSl7ZnVuY3Rpb24gZSh0KXtuLmNhbGwodGhpcyksdGhpcy5fbWFwcGluZ0Z1bmN0aW9uPXR9dmFyIG49dChcIi4uL2NvcmUvRXZlbnRIYW5kbGVyXCIpO2UucHJvdG90eXBlPU9iamVjdC5jcmVhdGUobi5wcm90b3R5cGUpLGUucHJvdG90eXBlLmNvbnN0cnVjdG9yPWUsZS5wcm90b3R5cGUuc3Vic2NyaWJlPW51bGwsZS5wcm90b3R5cGUudW5zdWJzY3JpYmU9bnVsbCxlLnByb3RvdHlwZS5lbWl0PWZ1bmN0aW9uKHQsaSl7dmFyIGU9dGhpcy5fbWFwcGluZ0Z1bmN0aW9uLmFwcGx5KHRoaXMsYXJndW1lbnRzKTtlJiZlLmVtaXQgaW5zdGFuY2VvZiBGdW5jdGlvbiYmZS5lbWl0KHQsaSl9LGUucHJvdG90eXBlLnRyaWdnZXI9ZS5wcm90b3R5cGUuZW1pdCxpLmV4cG9ydHM9ZX0se1wiLi4vY29yZS9FdmVudEhhbmRsZXJcIjo3fV0sMjI6W2Z1bmN0aW9uKHQsaSl7aS5leHBvcnRzPXtFdmVudEFyYml0ZXI6dChcIi4vRXZlbnRBcmJpdGVyXCIpLEV2ZW50RmlsdGVyOnQoXCIuL0V2ZW50RmlsdGVyXCIpLEV2ZW50TWFwcGVyOnQoXCIuL0V2ZW50TWFwcGVyXCIpfX0se1wiLi9FdmVudEFyYml0ZXJcIjoxOSxcIi4vRXZlbnRGaWx0ZXJcIjoyMCxcIi4vRXZlbnRNYXBwZXJcIjoyMX1dLDIzOltmdW5jdGlvbih0LGkpe2kuZXhwb3J0cz17ZXZlbnRzOnQoXCIuL2V2ZW50c1wiKSxjb3JlOnQoXCIuL2NvcmVcIiksbWF0aDp0KFwiLi9tYXRoXCIpLGlucHV0czp0KFwiLi9pbnB1dHNcIikscGh5c2ljczp0KFwiLi9waHlzaWNzXCIpLG1vZGlmaWVyczp0KFwiLi9tb2RpZmllcnNcIiksc3VyZmFjZXM6dChcIi4vc3VyZmFjZXNcIiksdHJhbnNpdGlvbnM6dChcIi4vdHJhbnNpdGlvbnNcIiksdXRpbGl0aWVzOnQoXCIuL3V0aWxpdGllc1wiKSx2aWV3czp0KFwiLi92aWV3c1wiKSx3aWRnZXRzOnQoXCIuL3dpZGdldHNcIil9fSx7XCIuL2NvcmVcIjoxOCxcIi4vZXZlbnRzXCI6MjIsXCIuL2lucHV0c1wiOjM2LFwiLi9tYXRoXCI6NDIsXCIuL21vZGlmaWVyc1wiOjQ3LFwiLi9waHlzaWNzXCI6NzEsXCIuL3N1cmZhY2VzXCI6ODIsXCIuL3RyYW5zaXRpb25zXCI6OTIsXCIuL3V0aWxpdGllc1wiOjk2LFwiLi92aWV3c1wiOjExMSxcIi4vd2lkZ2V0c1wiOjExNn1dLDI0OltmdW5jdGlvbih0LGkpe2Z1bmN0aW9uIGUodCxpKXt2b2lkIDA9PT1pJiYoaT1cInVwZGF0ZVwiKSx0aGlzLl9zdGF0ZT10JiZ0LmdldCYmdC5zZXQ/dDpuZXcgcyh0fHwwKSx0aGlzLl9ldmVudElucHV0PW5ldyBvLG8uc2V0SW5wdXRIYW5kbGVyKHRoaXMsdGhpcy5fZXZlbnRJbnB1dCksdGhpcy5fZXZlbnRJbnB1dC5vbihpLG4uYmluZCh0aGlzKSl9ZnVuY3Rpb24gbih0KXt2YXIgaT10LmRlbHRhLGU9dGhpcy5nZXQoKTtpZihpLmNvbnN0cnVjdG9yPT09ZS5jb25zdHJ1Y3Rvcil7dmFyIG49aSBpbnN0YW5jZW9mIEFycmF5P1tlWzBdK2lbMF0sZVsxXStpWzFdXTplK2k7dGhpcy5zZXQobil9fXZhciBvPXQoXCIuLi9jb3JlL0V2ZW50SGFuZGxlclwiKSxzPXQoXCIuLi90cmFuc2l0aW9ucy9UcmFuc2l0aW9uYWJsZVwiKTtlLnByb3RvdHlwZS5nZXQ9ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5fc3RhdGUuZ2V0KCl9LGUucHJvdG90eXBlLnNldD1mdW5jdGlvbih0KXt0aGlzLl9zdGF0ZS5zZXQodCl9LGkuZXhwb3J0cz1lfSx7XCIuLi9jb3JlL0V2ZW50SGFuZGxlclwiOjcsXCIuLi90cmFuc2l0aW9ucy9UcmFuc2l0aW9uYWJsZVwiOjg4fV0sMjU6W2Z1bmN0aW9uKCl7ZnVuY3Rpb24gdCh0KXt3aW5kb3cuYWRkRXZlbnRMaXN0ZW5lcih0LGZ1bmN0aW9uKHQpe3JldHVybiB0LnN0b3BQcm9wYWdhdGlvbigpLCExfSwhMCl9dmFyIGk9XCJvbnRvdWNoc3RhcnRcImluIHdpbmRvdztpJiYodChcIm1vdXNlZG93blwiKSx0KFwibW91c2Vtb3ZlXCIpLHQoXCJtb3VzZXVwXCIpLHQoXCJtb3VzZWxlYXZlXCIpKX0se31dLDI2OltmdW5jdGlvbigpeyFmdW5jdGlvbigpe2lmKHdpbmRvdy5DdXN0b21FdmVudCl7dmFyIHQ9MzAwLGk9NTAwLGU9e30sbj17fSxvPURhdGUubm93O3dpbmRvdy5hZGRFdmVudExpc3RlbmVyKFwidG91Y2hzdGFydFwiLGZ1bmN0aW9uKHQpe2Zvcih2YXIgaT1vKCksbj0wO248dC5jaGFuZ2VkVG91Y2hlcy5sZW5ndGg7bisrKXt2YXIgcz10LmNoYW5nZWRUb3VjaGVzW25dO2Vbcy5pZGVudGlmaWVyXT1pfX0pLHdpbmRvdy5hZGRFdmVudExpc3RlbmVyKFwidG91Y2htb3ZlXCIsZnVuY3Rpb24odCl7Zm9yKHZhciBpPTA7aTx0LmNoYW5nZWRUb3VjaGVzLmxlbmd0aDtpKyspe3ZhciBuPXQuY2hhbmdlZFRvdWNoZXNbaV07ZGVsZXRlIGVbbi5pZGVudGlmaWVyXX19KSx3aW5kb3cuYWRkRXZlbnRMaXN0ZW5lcihcInRvdWNoZW5kXCIsZnVuY3Rpb24oaSl7Zm9yKHZhciBzPW8oKSxyPTA7cjxpLmNoYW5nZWRUb3VjaGVzLmxlbmd0aDtyKyspe3ZhciBhPWkuY2hhbmdlZFRvdWNoZXNbcl0saD1lW2EuaWRlbnRpZmllcl07aWYoaCYmdD5zLWgpe3ZhciBjPW5ldyB3aW5kb3cuQ3VzdG9tRXZlbnQoXCJjbGlja1wiLHtidWJibGVzOiEwLGRldGFpbDphfSk7bltzXT1pLGkudGFyZ2V0LmRpc3BhdGNoRXZlbnQoYyl9ZGVsZXRlIGVbYS5pZGVudGlmaWVyXX19KSx3aW5kb3cuYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsZnVuY3Rpb24odCl7dmFyIGU9bygpO2Zvcih2YXIgcyBpbiBuKXt2YXIgcj1uW3NdO2k+ZS1zP3QgaW5zdGFuY2VvZiB3aW5kb3cuTW91c2VFdmVudCYmdC50YXJnZXQ9PT1yLnRhcmdldCYmdC5zdG9wUHJvcGFnYXRpb24oKTpkZWxldGUgbltzXX19LCEwKX19KCl9LHt9XSwyNzpbZnVuY3Rpb24odCxpKXtmdW5jdGlvbiBlKHQsaSl7dGhpcy5fZXZlbnRJbnB1dD1uZXcgbyx0aGlzLl9ldmVudE91dHB1dD1uZXcgbyxvLnNldElucHV0SGFuZGxlcih0aGlzLHRoaXMuX2V2ZW50SW5wdXQpLG8uc2V0T3V0cHV0SGFuZGxlcih0aGlzLHRoaXMuX2V2ZW50T3V0cHV0KSx0aGlzLl9zeW5jcz17fSx0JiZ0aGlzLmFkZFN5bmModCksaSYmdGhpcy5zZXRPcHRpb25zKGkpfWZ1bmN0aW9uIG4odCxpKXtzW3RdJiYodGhpcy5fc3luY3NbdF09bmV3IHNbdF0oaSksdGhpcy5waXBlU3luYyh0KSl9dmFyIG89dChcIi4uL2NvcmUvRXZlbnRIYW5kbGVyXCIpO2UuRElSRUNUSU9OX1g9MCxlLkRJUkVDVElPTl9ZPTEsZS5ESVJFQ1RJT05fWj0yO3ZhciBzPXt9O2UucmVnaXN0ZXI9ZnVuY3Rpb24odCl7Zm9yKHZhciBpIGluIHQpe2lmKHNbaV0pe2lmKHNbaV09PT10W2ldKXJldHVybjt0aHJvdyBuZXcgRXJyb3IoXCJ0aGlzIGtleSBpcyByZWdpc3RlcmVkIHRvIGEgZGlmZmVyZW50IHN5bmMgY2xhc3NcIil9c1tpXT10W2ldfX0sZS5wcm90b3R5cGUuc2V0T3B0aW9ucz1mdW5jdGlvbih0KXtmb3IodmFyIGkgaW4gdGhpcy5fc3luY3MpdGhpcy5fc3luY3NbaV0uc2V0T3B0aW9ucyh0KX0sZS5wcm90b3R5cGUucGlwZVN5bmM9ZnVuY3Rpb24odCl7dmFyIGk9dGhpcy5fc3luY3NbdF07dGhpcy5fZXZlbnRJbnB1dC5waXBlKGkpLGkucGlwZSh0aGlzLl9ldmVudE91dHB1dCl9LGUucHJvdG90eXBlLnVucGlwZVN5bmM9ZnVuY3Rpb24odCl7dmFyIGk9dGhpcy5fc3luY3NbdF07dGhpcy5fZXZlbnRJbnB1dC51bnBpcGUoaSksaS51bnBpcGUodGhpcy5fZXZlbnRPdXRwdXQpfSxlLnByb3RvdHlwZS5hZGRTeW5jPWZ1bmN0aW9uKHQpe2lmKHQgaW5zdGFuY2VvZiBBcnJheSlmb3IodmFyIGk9MDtpPHQubGVuZ3RoO2krKyluLmNhbGwodGhpcyx0W2ldKTtlbHNlIGlmKHQgaW5zdGFuY2VvZiBPYmplY3QpZm9yKHZhciBlIGluIHQpbi5jYWxsKHRoaXMsZSx0W2VdKX0saS5leHBvcnRzPWV9LHtcIi4uL2NvcmUvRXZlbnRIYW5kbGVyXCI6N31dLDI4OltmdW5jdGlvbih0LGkpe2Z1bmN0aW9uIGUodCl7dGhpcy5vcHRpb25zPU9iamVjdC5jcmVhdGUoZS5ERUZBVUxUX09QVElPTlMpLHRoaXMuX29wdGlvbnNNYW5hZ2VyPW5ldyBoKHRoaXMub3B0aW9ucyksdCYmdGhpcy5zZXRPcHRpb25zKHQpLHRoaXMuX2V2ZW50SW5wdXQ9bmV3IGEsdGhpcy5fZXZlbnRPdXRwdXQ9bmV3IGEsYS5zZXRJbnB1dEhhbmRsZXIodGhpcyx0aGlzLl9ldmVudElucHV0KSxhLnNldE91dHB1dEhhbmRsZXIodGhpcyx0aGlzLl9ldmVudE91dHB1dCksdGhpcy5fZXZlbnRJbnB1dC5vbihcIm1vdXNlZG93blwiLG4uYmluZCh0aGlzKSksdGhpcy5fZXZlbnRJbnB1dC5vbihcIm1vdXNlbW92ZVwiLG8uYmluZCh0aGlzKSksdGhpcy5fZXZlbnRJbnB1dC5vbihcIm1vdXNldXBcIixzLmJpbmQodGhpcykpLHRoaXMub3B0aW9ucy5wcm9wb2dhdGU/dGhpcy5fZXZlbnRJbnB1dC5vbihcIm1vdXNlbGVhdmVcIixyLmJpbmQodGhpcykpOnRoaXMuX2V2ZW50SW5wdXQub24oXCJtb3VzZWxlYXZlXCIscy5iaW5kKHRoaXMpKSx0aGlzLl9wYXlsb2FkPXtkZWx0YTpudWxsLHBvc2l0aW9uOm51bGwsdmVsb2NpdHk6bnVsbCxjbGllbnRYOjAsY2xpZW50WTowLG9mZnNldFg6MCxvZmZzZXRZOjB9LHRoaXMuX3Bvc2l0aW9uSGlzdG9yeT1bXSx0aGlzLl9wb3NpdGlvbj1udWxsLHRoaXMuX3ByZXZDb29yZD12b2lkIDAsdGhpcy5fcHJldlRpbWU9dm9pZCAwLHRoaXMuX2Rvd249ITEsdGhpcy5fbW92ZWQ9ITEsdGhpcy5fZG9jdW1lbnRBY3RpdmU9ITF9ZnVuY3Rpb24gbih0KXt2YXIgaSxlO3RoaXMub3B0aW9ucy5wcmV2ZW50RGVmYXVsdCYmdC5wcmV2ZW50RGVmYXVsdCgpO3ZhciBuPXQuY2xpZW50WCxvPXQuY2xpZW50WTt0aGlzLl9wcmV2Q29vcmQ9W24sb10sdGhpcy5fcHJldlRpbWU9RGF0ZS5ub3coKSx0aGlzLl9kb3duPSEwLHRoaXMuX21vdmU9ITEsdm9pZCAwIT09dGhpcy5vcHRpb25zLmRpcmVjdGlvbj8odGhpcy5fcG9zaXRpb249MCxpPTAsZT0wKToodGhpcy5fcG9zaXRpb249WzAsMF0saT1bMCwwXSxlPVswLDBdKTt2YXIgcz10aGlzLl9wYXlsb2FkO3MuZGVsdGE9aSxzLnBvc2l0aW9uPXRoaXMuX3Bvc2l0aW9uLHMudmVsb2NpdHk9ZSxzLmNsaWVudFg9bixzLmNsaWVudFk9byxzLm9mZnNldFg9dC5vZmZzZXRYLHMub2Zmc2V0WT10Lm9mZnNldFksdGhpcy5fcG9zaXRpb25IaXN0b3J5LnB1c2goe3Bvc2l0aW9uOnMucG9zaXRpb24uc2xpY2U/cy5wb3NpdGlvbi5zbGljZSgwKTpzLnBvc2l0aW9uLHRpbWU6dGhpcy5fcHJldlRpbWV9KSx0aGlzLl9ldmVudE91dHB1dC5lbWl0KFwic3RhcnRcIixzKSx0aGlzLl9kb2N1bWVudEFjdGl2ZT0hMX1mdW5jdGlvbiBvKHQpe2lmKHRoaXMuX3ByZXZDb29yZCl7dmFyIGk9dGhpcy5fcHJldkNvb3JkLG49KHRoaXMuX3ByZXZUaW1lLHQuY2xpZW50WCksbz10LmNsaWVudFkscz1EYXRlLm5vdygpLHI9bi1pWzBdLGE9by1pWzFdO3RoaXMub3B0aW9ucy5yYWlscyYmKE1hdGguYWJzKHIpPk1hdGguYWJzKGEpP2E9MDpyPTApO3ZhciBoLHAsdT1NYXRoLm1heChzLXRoaXMuX3Bvc2l0aW9uSGlzdG9yeVswXS50aW1lLGMpLGw9dGhpcy5vcHRpb25zLnNjYWxlO3RoaXMub3B0aW9ucy5kaXJlY3Rpb249PT1lLkRJUkVDVElPTl9YPyhwPWwqcix0aGlzLl9wb3NpdGlvbis9cCxoPWwqKHRoaXMuX3Bvc2l0aW9uLXRoaXMuX3Bvc2l0aW9uSGlzdG9yeVswXS5wb3NpdGlvbikvdSk6dGhpcy5vcHRpb25zLmRpcmVjdGlvbj09PWUuRElSRUNUSU9OX1k/KHA9bCphLHRoaXMuX3Bvc2l0aW9uKz1wLGg9bCoodGhpcy5fcG9zaXRpb24tdGhpcy5fcG9zaXRpb25IaXN0b3J5WzBdLnBvc2l0aW9uKS91KToocD1bbCpyLGwqYV0saD1bbCoodGhpcy5fcG9zaXRpb25bMF0tdGhpcy5fcG9zaXRpb25IaXN0b3J5WzBdLnBvc2l0aW9uWzBdKS91LGwqKHRoaXMuX3Bvc2l0aW9uWzFdLXRoaXMuX3Bvc2l0aW9uSGlzdG9yeVswXS5wb3NpdGlvblsxXSkvdV0sdGhpcy5fcG9zaXRpb25bMF0rPXBbMF0sdGhpcy5fcG9zaXRpb25bMV0rPXBbMV0pO3ZhciBmPXRoaXMuX3BheWxvYWQ7Zi5kZWx0YT1wLGYucG9zaXRpb249dGhpcy5fcG9zaXRpb24sZi52ZWxvY2l0eT1oLGYuY2xpZW50WD1uLGYuY2xpZW50WT1vLGYub2Zmc2V0WD10Lm9mZnNldFgsZi5vZmZzZXRZPXQub2Zmc2V0WSx0aGlzLl9wb3NpdGlvbkhpc3RvcnkubGVuZ3RoPT09dGhpcy5vcHRpb25zLnZlbG9jaXR5U2FtcGxlTGVuZ3RoJiZ0aGlzLl9wb3NpdGlvbkhpc3Rvcnkuc2hpZnQoKSx0aGlzLl9wb3NpdGlvbkhpc3RvcnkucHVzaCh7cG9zaXRpb246Zi5wb3NpdGlvbi5zbGljZT9mLnBvc2l0aW9uLnNsaWNlKDApOmYucG9zaXRpb24sdGltZTpzfSksdGhpcy5fZXZlbnRPdXRwdXQuZW1pdChcInVwZGF0ZVwiLGYpLHRoaXMuX3ByZXZDb29yZD1bbixvXSx0aGlzLl9wcmV2VGltZT1zLHRoaXMuX21vdmU9ITB9fWZ1bmN0aW9uIHMoKXt0aGlzLl9kb3duJiYodGhpcy5fZXZlbnRPdXRwdXQuZW1pdChcImVuZFwiLHRoaXMuX3BheWxvYWQpLHRoaXMuX3ByZXZDb29yZD12b2lkIDAsdGhpcy5fcHJldlRpbWU9dm9pZCAwLHRoaXMuX2Rvd249ITEsdGhpcy5fbW92ZT0hMSx0aGlzLl9wb3NpdGlvbkhpc3Rvcnk9W10pfWZ1bmN0aW9uIHIodCl7aWYodGhpcy5fZG93biYmdGhpcy5fbW92ZSYmIXRoaXMuX2RvY3VtZW50QWN0aXZlKXt2YXIgaT1vLmJpbmQodGhpcyksZT1mdW5jdGlvbih0KXtzLmNhbGwodGhpcyx0KSxkb2N1bWVudC5yZW1vdmVFdmVudExpc3RlbmVyKFwibW91c2Vtb3ZlXCIsaSksZG9jdW1lbnQucmVtb3ZlRXZlbnRMaXN0ZW5lcihcIm1vdXNldXBcIixlKX0uYmluZCh0aGlzLHQpO2RvY3VtZW50LmFkZEV2ZW50TGlzdGVuZXIoXCJtb3VzZW1vdmVcIixpKSxkb2N1bWVudC5hZGRFdmVudExpc3RlbmVyKFwibW91c2V1cFwiLGUpLHRoaXMuX2RvY3VtZW50QWN0aXZlPSEwfX12YXIgYT10KFwiLi4vY29yZS9FdmVudEhhbmRsZXJcIiksaD10KFwiLi4vY29yZS9PcHRpb25zTWFuYWdlclwiKTtlLkRFRkFVTFRfT1BUSU9OUz17ZGlyZWN0aW9uOnZvaWQgMCxyYWlsczohMSxzY2FsZToxLHByb3BvZ2F0ZTohMCx2ZWxvY2l0eVNhbXBsZUxlbmd0aDoxMCxwcmV2ZW50RGVmYXVsdDohMH0sZS5ESVJFQ1RJT05fWD0wLGUuRElSRUNUSU9OX1k9MTt2YXIgYz04O2UucHJvdG90eXBlLmdldE9wdGlvbnM9ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5vcHRpb25zfSxlLnByb3RvdHlwZS5zZXRPcHRpb25zPWZ1bmN0aW9uKHQpe3JldHVybiB0aGlzLl9vcHRpb25zTWFuYWdlci5zZXRPcHRpb25zKHQpfSxpLmV4cG9ydHM9ZX0se1wiLi4vY29yZS9FdmVudEhhbmRsZXJcIjo3LFwiLi4vY29yZS9PcHRpb25zTWFuYWdlclwiOjEwfV0sMjk6W2Z1bmN0aW9uKHQsaSl7ZnVuY3Rpb24gZSh0KXtuLmNhbGwodGhpcyksdGhpcy5vcHRpb25zPU9iamVjdC5jcmVhdGUoZS5ERUZBVUxUX09QVElPTlMpLHRoaXMuX29wdGlvbnNNYW5hZ2VyPW5ldyBvKHRoaXMub3B0aW9ucyksdCYmdGhpcy5zZXRPcHRpb25zKHQpLHRoaXMuX2Rpc3BsYWNlbWVudD0wLHRoaXMuX3ByZXZpb3VzRGlzdGFuY2U9MH12YXIgbj10KFwiLi9Ud29GaW5nZXJTeW5jXCIpLG89dChcIi4uL2NvcmUvT3B0aW9uc01hbmFnZXJcIik7ZS5wcm90b3R5cGU9T2JqZWN0LmNyZWF0ZShuLnByb3RvdHlwZSksZS5wcm90b3R5cGUuY29uc3RydWN0b3I9ZSxlLkRFRkFVTFRfT1BUSU9OUz17c2NhbGU6MX0sZS5wcm90b3R5cGUuX3N0YXJ0VXBkYXRlPWZ1bmN0aW9uKHQpe3RoaXMuX3ByZXZpb3VzRGlzdGFuY2U9bi5jYWxjdWxhdGVEaXN0YW5jZSh0aGlzLnBvc0EsdGhpcy5wb3NCKSx0aGlzLl9kaXNwbGFjZW1lbnQ9MCx0aGlzLl9ldmVudE91dHB1dC5lbWl0KFwic3RhcnRcIix7Y291bnQ6dC50b3VjaGVzLmxlbmd0aCx0b3VjaGVzOlt0aGlzLnRvdWNoQUlkLHRoaXMudG91Y2hCSWRdLGRpc3RhbmNlOnRoaXMuX2Rpc3QsY2VudGVyOm4uY2FsY3VsYXRlQ2VudGVyKHRoaXMucG9zQSx0aGlzLnBvc0IpfSl9LGUucHJvdG90eXBlLl9tb3ZlVXBkYXRlPWZ1bmN0aW9uKHQpe3ZhciBpPW4uY2FsY3VsYXRlRGlzdGFuY2UodGhpcy5wb3NBLHRoaXMucG9zQiksZT1uLmNhbGN1bGF0ZUNlbnRlcih0aGlzLnBvc0EsdGhpcy5wb3NCKSxvPXRoaXMub3B0aW9ucy5zY2FsZSxzPW8qKGktdGhpcy5fcHJldmlvdXNEaXN0YW5jZSkscj1zL3Q7dGhpcy5fcHJldmlvdXNEaXN0YW5jZT1pLHRoaXMuX2Rpc3BsYWNlbWVudCs9cyx0aGlzLl9ldmVudE91dHB1dC5lbWl0KFwidXBkYXRlXCIse2RlbHRhOnMsdmVsb2NpdHk6cixkaXN0YW5jZTppLGRpc3BsYWNlbWVudDp0aGlzLl9kaXNwbGFjZW1lbnQsY2VudGVyOmUsdG91Y2hlczpbdGhpcy50b3VjaEFJZCx0aGlzLnRvdWNoQklkXX0pfSxlLnByb3RvdHlwZS5nZXRPcHRpb25zPWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMub3B0aW9uc30sZS5wcm90b3R5cGUuc2V0T3B0aW9ucz1mdW5jdGlvbih0KXtyZXR1cm4gdGhpcy5fb3B0aW9uc01hbmFnZXIuc2V0T3B0aW9ucyh0KX0saS5leHBvcnRzPWV9LHtcIi4uL2NvcmUvT3B0aW9uc01hbmFnZXJcIjoxMCxcIi4vVHdvRmluZ2VyU3luY1wiOjM1fV0sMzA6W2Z1bmN0aW9uKHQsaSl7ZnVuY3Rpb24gZSh0KXtuLmNhbGwodGhpcyksdGhpcy5vcHRpb25zPU9iamVjdC5jcmVhdGUoZS5ERUZBVUxUX09QVElPTlMpLHRoaXMuX29wdGlvbnNNYW5hZ2VyPW5ldyBvKHRoaXMub3B0aW9ucyksdCYmdGhpcy5zZXRPcHRpb25zKHQpLHRoaXMuX2FuZ2xlPTAsdGhpcy5fcHJldmlvdXNBbmdsZT0wfXZhciBuPXQoXCIuL1R3b0ZpbmdlclN5bmNcIiksbz10KFwiLi4vY29yZS9PcHRpb25zTWFuYWdlclwiKTtlLnByb3RvdHlwZT1PYmplY3QuY3JlYXRlKG4ucHJvdG90eXBlKSxlLnByb3RvdHlwZS5jb25zdHJ1Y3Rvcj1lLGUuREVGQVVMVF9PUFRJT05TPXtzY2FsZToxfSxlLnByb3RvdHlwZS5fc3RhcnRVcGRhdGU9ZnVuY3Rpb24odCl7dGhpcy5fYW5nbGU9MCx0aGlzLl9wcmV2aW91c0FuZ2xlPW4uY2FsY3VsYXRlQW5nbGUodGhpcy5wb3NBLHRoaXMucG9zQik7dmFyIGk9bi5jYWxjdWxhdGVDZW50ZXIodGhpcy5wb3NBLHRoaXMucG9zQik7dGhpcy5fZXZlbnRPdXRwdXQuZW1pdChcInN0YXJ0XCIse2NvdW50OnQudG91Y2hlcy5sZW5ndGgsYW5nbGU6dGhpcy5fYW5nbGUsY2VudGVyOmksdG91Y2hlczpbdGhpcy50b3VjaEFJZCx0aGlzLnRvdWNoQklkXX0pfSxlLnByb3RvdHlwZS5fbW92ZVVwZGF0ZT1mdW5jdGlvbih0KXt2YXIgaT10aGlzLm9wdGlvbnMuc2NhbGUsZT1uLmNhbGN1bGF0ZUFuZ2xlKHRoaXMucG9zQSx0aGlzLnBvc0IpLG89bi5jYWxjdWxhdGVDZW50ZXIodGhpcy5wb3NBLHRoaXMucG9zQikscz1pKihlLXRoaXMuX3ByZXZpb3VzQW5nbGUpLHI9cy90O3RoaXMuX2FuZ2xlKz1zLHRoaXMuX2V2ZW50T3V0cHV0LmVtaXQoXCJ1cGRhdGVcIix7ZGVsdGE6cyx2ZWxvY2l0eTpyLGFuZ2xlOnRoaXMuX2FuZ2xlLGNlbnRlcjpvLHRvdWNoZXM6W3RoaXMudG91Y2hBSWQsdGhpcy50b3VjaEJJZF19KSx0aGlzLl9wcmV2aW91c0FuZ2xlPWV9LGUucHJvdG90eXBlLmdldE9wdGlvbnM9ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5vcHRpb25zfSxlLnByb3RvdHlwZS5zZXRPcHRpb25zPWZ1bmN0aW9uKHQpe3JldHVybiB0aGlzLl9vcHRpb25zTWFuYWdlci5zZXRPcHRpb25zKHQpfSxpLmV4cG9ydHM9ZX0se1wiLi4vY29yZS9PcHRpb25zTWFuYWdlclwiOjEwLFwiLi9Ud29GaW5nZXJTeW5jXCI6MzV9XSwzMTpbZnVuY3Rpb24odCxpKXtmdW5jdGlvbiBlKHQpe28uY2FsbCh0aGlzKSx0aGlzLm9wdGlvbnM9T2JqZWN0LmNyZWF0ZShlLkRFRkFVTFRfT1BUSU9OUyksdGhpcy5fb3B0aW9uc01hbmFnZXI9bmV3IHModGhpcy5vcHRpb25zKSx0JiZ0aGlzLnNldE9wdGlvbnModCksdGhpcy5fc2NhbGVGYWN0b3I9MSx0aGlzLl9zdGFydERpc3Q9MCx0aGlzLl9ldmVudElucHV0Lm9uKFwicGlwZVwiLG4uYmluZCh0aGlzKSl9ZnVuY3Rpb24gbigpe3RoaXMudG91Y2hBSWQ9dm9pZCAwLHRoaXMudG91Y2hCSWQ9dm9pZCAwfXZhciBvPXQoXCIuL1R3b0ZpbmdlclN5bmNcIikscz10KFwiLi4vY29yZS9PcHRpb25zTWFuYWdlclwiKTtlLnByb3RvdHlwZT1PYmplY3QuY3JlYXRlKG8ucHJvdG90eXBlKSxlLnByb3RvdHlwZS5jb25zdHJ1Y3Rvcj1lLGUuREVGQVVMVF9PUFRJT05TPXtzY2FsZToxfSxlLnByb3RvdHlwZS5fc3RhcnRVcGRhdGU9ZnVuY3Rpb24odCl7dGhpcy5fc2NhbGVGYWN0b3I9MSx0aGlzLl9zdGFydERpc3Q9by5jYWxjdWxhdGVEaXN0YW5jZSh0aGlzLnBvc0EsdGhpcy5wb3NCKSx0aGlzLl9ldmVudE91dHB1dC5lbWl0KFwic3RhcnRcIix7Y291bnQ6dC50b3VjaGVzLmxlbmd0aCx0b3VjaGVzOlt0aGlzLnRvdWNoQUlkLHRoaXMudG91Y2hCSWRdLGRpc3RhbmNlOnRoaXMuX3N0YXJ0RGlzdCxjZW50ZXI6by5jYWxjdWxhdGVDZW50ZXIodGhpcy5wb3NBLHRoaXMucG9zQil9KX0sZS5wcm90b3R5cGUuX21vdmVVcGRhdGU9ZnVuY3Rpb24odCl7dmFyIGk9dGhpcy5vcHRpb25zLnNjYWxlLGU9by5jYWxjdWxhdGVEaXN0YW5jZSh0aGlzLnBvc0EsdGhpcy5wb3NCKSxuPW8uY2FsY3VsYXRlQ2VudGVyKHRoaXMucG9zQSx0aGlzLnBvc0IpLHM9KGUtdGhpcy5fc3RhcnREaXN0KS90aGlzLl9zdGFydERpc3Qscj1NYXRoLm1heCgxK2kqcywwKSxhPShyLXRoaXMuX3NjYWxlRmFjdG9yKS90O3RoaXMuX2V2ZW50T3V0cHV0LmVtaXQoXCJ1cGRhdGVcIix7ZGVsdGE6cyxzY2FsZTpyLHZlbG9jaXR5OmEsZGlzdGFuY2U6ZSxjZW50ZXI6bix0b3VjaGVzOlt0aGlzLnRvdWNoQUlkLHRoaXMudG91Y2hCSWRdfSksdGhpcy5fc2NhbGVGYWN0b3I9cn0sZS5wcm90b3R5cGUuZ2V0T3B0aW9ucz1mdW5jdGlvbigpe3JldHVybiB0aGlzLm9wdGlvbnN9LGUucHJvdG90eXBlLnNldE9wdGlvbnM9ZnVuY3Rpb24odCl7cmV0dXJuIHRoaXMuX29wdGlvbnNNYW5hZ2VyLnNldE9wdGlvbnModCl9LGkuZXhwb3J0cz1lfSx7XCIuLi9jb3JlL09wdGlvbnNNYW5hZ2VyXCI6MTAsXCIuL1R3b0ZpbmdlclN5bmNcIjozNX1dLDMyOltmdW5jdGlvbih0LGkpe2Z1bmN0aW9uIGUodCl7dGhpcy5vcHRpb25zPU9iamVjdC5jcmVhdGUoZS5ERUZBVUxUX09QVElPTlMpLHRoaXMuX29wdGlvbnNNYW5hZ2VyPW5ldyBhKHRoaXMub3B0aW9ucyksdCYmdGhpcy5zZXRPcHRpb25zKHQpLHRoaXMuX3BheWxvYWQ9e2RlbHRhOm51bGwscG9zaXRpb246bnVsbCx2ZWxvY2l0eTpudWxsLHNsaXA6ITB9LHRoaXMuX2V2ZW50SW5wdXQ9bmV3IHMsdGhpcy5fZXZlbnRPdXRwdXQ9bmV3IHMscy5zZXRJbnB1dEhhbmRsZXIodGhpcyx0aGlzLl9ldmVudElucHV0KSxzLnNldE91dHB1dEhhbmRsZXIodGhpcyx0aGlzLl9ldmVudE91dHB1dCksdGhpcy5fcG9zaXRpb249dm9pZCAwPT09dGhpcy5vcHRpb25zLmRpcmVjdGlvbj9bMCwwXTowLHRoaXMuX3ByZXZUaW1lPXZvaWQgMCx0aGlzLl9wcmV2VmVsPXZvaWQgMCx0aGlzLl9ldmVudElucHV0Lm9uKFwibW91c2V3aGVlbFwiLG8uYmluZCh0aGlzKSksdGhpcy5fZXZlbnRJbnB1dC5vbihcIndoZWVsXCIsby5iaW5kKHRoaXMpKSx0aGlzLl9pblByb2dyZXNzPSExLHRoaXMuX2xvb3BCb3VuZD0hMX1mdW5jdGlvbiBuKCl7aWYodGhpcy5faW5Qcm9ncmVzcyYmYygpLXRoaXMuX3ByZXZUaW1lPnRoaXMub3B0aW9ucy5zdGFsbFRpbWUpe3RoaXMuX2luUHJvZ3Jlc3M9ITE7dmFyIHQ9TWF0aC5hYnModGhpcy5fcHJldlZlbCk+PXRoaXMub3B0aW9ucy5taW5pbXVtRW5kU3BlZWQ/dGhpcy5fcHJldlZlbDowLGk9dGhpcy5fcGF5bG9hZDtpLnBvc2l0aW9uPXRoaXMuX3Bvc2l0aW9uLGkudmVsb2NpdHk9dCxpLnNsaXA9ITAsdGhpcy5fZXZlbnRPdXRwdXQuZW1pdChcImVuZFwiLGkpfX1mdW5jdGlvbiBvKHQpe3RoaXMub3B0aW9ucy5wcmV2ZW50RGVmYXVsdCYmdC5wcmV2ZW50RGVmYXVsdCgpLHRoaXMuX2luUHJvZ3Jlc3N8fCh0aGlzLl9pblByb2dyZXNzPSEwLHRoaXMuX3Bvc2l0aW9uPXZvaWQgMD09PXRoaXMub3B0aW9ucy5kaXJlY3Rpb24/WzAsMF06MCx5PXRoaXMuX3BheWxvYWQseS5zbGlwPSEwLHkucG9zaXRpb249dGhpcy5fcG9zaXRpb24seS5jbGllbnRYPXQuY2xpZW50WCx5LmNsaWVudFk9dC5jbGllbnRZLHkub2Zmc2V0WD10Lm9mZnNldFgseS5vZmZzZXRZPXQub2Zmc2V0WSx0aGlzLl9ldmVudE91dHB1dC5lbWl0KFwic3RhcnRcIix5KSx0aGlzLl9sb29wQm91bmR8fChyLm9uKFwicHJlcmVuZGVyXCIsbi5iaW5kKHRoaXMpKSx0aGlzLl9sb29wQm91bmQ9ITApKTt2YXIgaT1jKCksbz10aGlzLl9wcmV2VGltZXx8aSxzPXZvaWQgMCE9PXQud2hlZWxEZWx0YVg/dC53aGVlbERlbHRhWDotdC5kZWx0YVgsYT12b2lkIDAhPT10LndoZWVsRGVsdGFZP3Qud2hlZWxEZWx0YVk6LXQuZGVsdGFZOzE9PT10LmRlbHRhTW9kZSYmKHMqPXRoaXMub3B0aW9ucy5saW5lSGVpZ2h0LGEqPXRoaXMub3B0aW9ucy5saW5lSGVpZ2h0KSx0aGlzLm9wdGlvbnMucmFpbHMmJihNYXRoLmFicyhzKT5NYXRoLmFicyhhKT9hPTA6cz0wKTt2YXIgcCx1LGw9TWF0aC5tYXgoaS1vLGgpLGY9cy9sLGQ9YS9sLF89dGhpcy5vcHRpb25zLnNjYWxlO3RoaXMub3B0aW9ucy5kaXJlY3Rpb249PT1lLkRJUkVDVElPTl9YPyh1PV8qcyxwPV8qZix0aGlzLl9wb3NpdGlvbis9dSk6dGhpcy5vcHRpb25zLmRpcmVjdGlvbj09PWUuRElSRUNUSU9OX1k/KHU9XyphLHA9XypkLHRoaXMuX3Bvc2l0aW9uKz11KToodT1bXypzLF8qYV0scD1bXypmLF8qZF0sdGhpcy5fcG9zaXRpb25bMF0rPXVbMF0sdGhpcy5fcG9zaXRpb25bMV0rPXVbMV0pO3ZhciB5PXRoaXMuX3BheWxvYWQ7eS5kZWx0YT11LHkudmVsb2NpdHk9cCx5LnBvc2l0aW9uPXRoaXMuX3Bvc2l0aW9uLHkuc2xpcD0hMCx0aGlzLl9ldmVudE91dHB1dC5lbWl0KFwidXBkYXRlXCIseSksdGhpcy5fcHJldlRpbWU9aSx0aGlzLl9wcmV2VmVsPXB9dmFyIHM9dChcIi4uL2NvcmUvRXZlbnRIYW5kbGVyXCIpLHI9dChcIi4uL2NvcmUvRW5naW5lXCIpLGE9dChcIi4uL2NvcmUvT3B0aW9uc01hbmFnZXJcIik7ZS5ERUZBVUxUX09QVElPTlM9e2RpcmVjdGlvbjp2b2lkIDAsbWluaW11bUVuZFNwZWVkOjEvMCxyYWlsczohMSxzY2FsZToxLHN0YWxsVGltZTo1MCxsaW5lSGVpZ2h0OjQwLHByZXZlbnREZWZhdWx0OiEwfSxlLkRJUkVDVElPTl9YPTAsZS5ESVJFQ1RJT05fWT0xO3ZhciBoPTgsYz1EYXRlLm5vdztlLnByb3RvdHlwZS5nZXRPcHRpb25zPWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMub3B0aW9uc30sZS5wcm90b3R5cGUuc2V0T3B0aW9ucz1mdW5jdGlvbih0KXtyZXR1cm4gdGhpcy5fb3B0aW9uc01hbmFnZXIuc2V0T3B0aW9ucyh0KX0saS5leHBvcnRzPWV9LHtcIi4uL2NvcmUvRW5naW5lXCI6NCxcIi4uL2NvcmUvRXZlbnRIYW5kbGVyXCI6NyxcIi4uL2NvcmUvT3B0aW9uc01hbmFnZXJcIjoxMH1dLDMzOltmdW5jdGlvbih0LGkpe2Z1bmN0aW9uIGUodCl7dGhpcy5vcHRpb25zPU9iamVjdC5jcmVhdGUoZS5ERUZBVUxUX09QVElPTlMpLHRoaXMuX29wdGlvbnNNYW5hZ2VyPW5ldyBoKHRoaXMub3B0aW9ucyksdCYmdGhpcy5zZXRPcHRpb25zKHQpLHRoaXMuX2V2ZW50T3V0cHV0PW5ldyBhLHRoaXMuX3RvdWNoVHJhY2tlcj1uZXcgcih7dG91Y2hMaW1pdDp0aGlzLm9wdGlvbnMudG91Y2hMaW1pdH0pLGEuc2V0T3V0cHV0SGFuZGxlcih0aGlzLHRoaXMuX2V2ZW50T3V0cHV0KSxhLnNldElucHV0SGFuZGxlcih0aGlzLHRoaXMuX3RvdWNoVHJhY2tlciksdGhpcy5fdG91Y2hUcmFja2VyLm9uKFwidHJhY2tzdGFydFwiLG4uYmluZCh0aGlzKSksdGhpcy5fdG91Y2hUcmFja2VyLm9uKFwidHJhY2ttb3ZlXCIsby5iaW5kKHRoaXMpKSx0aGlzLl90b3VjaFRyYWNrZXIub24oXCJ0cmFja2VuZFwiLHMuYmluZCh0aGlzKSksdGhpcy5fcGF5bG9hZD17ZGVsdGE6bnVsbCxwb3NpdGlvbjpudWxsLHZlbG9jaXR5Om51bGwsY2xpZW50WDp2b2lkIDAsY2xpZW50WTp2b2lkIDAsY291bnQ6MCx0b3VjaDp2b2lkIDB9LHRoaXMuX3Bvc2l0aW9uPW51bGx9ZnVuY3Rpb24gbih0KXt2YXIgaSxlO3ZvaWQgMCE9PXRoaXMub3B0aW9ucy5kaXJlY3Rpb24/KHRoaXMuX3Bvc2l0aW9uPTAsaT0wLGU9MCk6KHRoaXMuX3Bvc2l0aW9uPVswLDBdLGk9WzAsMF0sZT1bMCwwXSk7dmFyIG49dGhpcy5fcGF5bG9hZDtuLmRlbHRhPWUsbi5wb3NpdGlvbj10aGlzLl9wb3NpdGlvbixuLnZlbG9jaXR5PWksbi5jbGllbnRYPXQueCxuLmNsaWVudFk9dC55LG4uY291bnQ9dC5jb3VudCxuLnRvdWNoPXQuaWRlbnRpZmllcix0aGlzLl9ldmVudE91dHB1dC5lbWl0KFwic3RhcnRcIixuKX1mdW5jdGlvbiBvKHQpe3ZhciBpPXQuaGlzdG9yeSxuPWlbaS5sZW5ndGgtMV0sbz1pW2kubGVuZ3RoLTJdLHM9aVtpLmxlbmd0aC10aGlzLm9wdGlvbnMudmVsb2NpdHlTYW1wbGVMZW5ndGhdP2lbaS5sZW5ndGgtdGhpcy5vcHRpb25zLnZlbG9jaXR5U2FtcGxlTGVuZ3RoXTppW2kubGVuZ3RoLTJdLHI9cy50aW1lc3RhbXAsYT1uLnRpbWVzdGFtcCxoPW4ueC1vLngscD1uLnktby55LHU9bi54LXMueCxsPW4ueS1zLnk7dGhpcy5vcHRpb25zLnJhaWxzJiYoTWF0aC5hYnMoaCk+TWF0aC5hYnMocCk/cD0wOmg9MCxNYXRoLmFicyh1KT5NYXRoLmFicyhsKT9sPTA6dT0wKTt2YXIgZixkLF89TWF0aC5tYXgoYS1yLGMpLHk9dS9fLGc9bC9fLHY9dGhpcy5vcHRpb25zLnNjYWxlO3RoaXMub3B0aW9ucy5kaXJlY3Rpb249PT1lLkRJUkVDVElPTl9YPyhkPXYqaCxmPXYqeSx0aGlzLl9wb3NpdGlvbis9ZCk6dGhpcy5vcHRpb25zLmRpcmVjdGlvbj09PWUuRElSRUNUSU9OX1k/KGQ9dipwLGY9dipnLHRoaXMuX3Bvc2l0aW9uKz1kKTooZD1bdipoLHYqcF0sZj1bdip5LHYqZ10sdGhpcy5fcG9zaXRpb25bMF0rPWRbMF0sdGhpcy5fcG9zaXRpb25bMV0rPWRbMV0pO3ZhciBtPXRoaXMuX3BheWxvYWQ7bS5kZWx0YT1kLG0udmVsb2NpdHk9ZixtLnBvc2l0aW9uPXRoaXMuX3Bvc2l0aW9uLG0uY2xpZW50WD10LngsbS5jbGllbnRZPXQueSxtLmNvdW50PXQuY291bnQsbS50b3VjaD10LmlkZW50aWZpZXIsdGhpcy5fZXZlbnRPdXRwdXQuZW1pdChcInVwZGF0ZVwiLG0pfWZ1bmN0aW9uIHModCl7dGhpcy5fcGF5bG9hZC5jb3VudD10LmNvdW50LHRoaXMuX2V2ZW50T3V0cHV0LmVtaXQoXCJlbmRcIix0aGlzLl9wYXlsb2FkKX12YXIgcj10KFwiLi9Ub3VjaFRyYWNrZXJcIiksYT10KFwiLi4vY29yZS9FdmVudEhhbmRsZXJcIiksaD10KFwiLi4vY29yZS9PcHRpb25zTWFuYWdlclwiKTtlLkRFRkFVTFRfT1BUSU9OUz17ZGlyZWN0aW9uOnZvaWQgMCxyYWlsczohMSx0b3VjaExpbWl0OjEsdmVsb2NpdHlTYW1wbGVMZW5ndGg6MTAsc2NhbGU6MX0sZS5ESVJFQ1RJT05fWD0wLGUuRElSRUNUSU9OX1k9MTt2YXIgYz04O2UucHJvdG90eXBlLnNldE9wdGlvbnM9ZnVuY3Rpb24odCl7cmV0dXJuIHRoaXMuX29wdGlvbnNNYW5hZ2VyLnNldE9wdGlvbnModCl9LGUucHJvdG90eXBlLmdldE9wdGlvbnM9ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5vcHRpb25zfSxpLmV4cG9ydHM9ZX0se1wiLi4vY29yZS9FdmVudEhhbmRsZXJcIjo3LFwiLi4vY29yZS9PcHRpb25zTWFuYWdlclwiOjEwLFwiLi9Ub3VjaFRyYWNrZXJcIjozNH1dLDM0OltmdW5jdGlvbih0LGkpe2Z1bmN0aW9uIGUodCxpLGUpe3JldHVybnt4OnQuY2xpZW50WCx5OnQuY2xpZW50WSxpZGVudGlmaWVyOnQuaWRlbnRpZmllcixvcmlnaW46aS5vcmlnaW4sdGltZXN0YW1wOmMoKSxjb3VudDppLnRvdWNoZXMubGVuZ3RoLGhpc3Rvcnk6ZX19ZnVuY3Rpb24gbih0KXtpZighKHQudG91Y2hlcy5sZW5ndGg+dGhpcy50b3VjaExpbWl0KSl7dGhpcy5pc1RvdWNoZWQ9ITA7Zm9yKHZhciBpPTA7aTx0LmNoYW5nZWRUb3VjaGVzLmxlbmd0aDtpKyspe3ZhciBuPXQuY2hhbmdlZFRvdWNoZXNbaV0sbz1lKG4sdCxudWxsKTt0aGlzLmV2ZW50T3V0cHV0LmVtaXQoXCJ0cmFja3N0YXJ0XCIsbyksdGhpcy5zZWxlY3RpdmV8fHRoaXMudG91Y2hIaXN0b3J5W24uaWRlbnRpZmllcl18fHRoaXMudHJhY2sobyl9fX1mdW5jdGlvbiBvKHQpe2lmKCEodC50b3VjaGVzLmxlbmd0aD50aGlzLnRvdWNoTGltaXQpKWZvcih2YXIgaT0wO2k8dC5jaGFuZ2VkVG91Y2hlcy5sZW5ndGg7aSsrKXt2YXIgbj10LmNoYW5nZWRUb3VjaGVzW2ldLG89dGhpcy50b3VjaEhpc3Rvcnlbbi5pZGVudGlmaWVyXTtpZihvKXt2YXIgcz1lKG4sdCxvKTt0aGlzLnRvdWNoSGlzdG9yeVtuLmlkZW50aWZpZXJdLnB1c2gocyksdGhpcy5ldmVudE91dHB1dC5lbWl0KFwidHJhY2ttb3ZlXCIscyl9fX1mdW5jdGlvbiBzKHQpe2lmKHRoaXMuaXNUb3VjaGVkKXtmb3IodmFyIGk9MDtpPHQuY2hhbmdlZFRvdWNoZXMubGVuZ3RoO2krKyl7dmFyIG49dC5jaGFuZ2VkVG91Y2hlc1tpXSxvPXRoaXMudG91Y2hIaXN0b3J5W24uaWRlbnRpZmllcl07aWYobyl7dmFyIHM9ZShuLHQsbyk7dGhpcy5ldmVudE91dHB1dC5lbWl0KFwidHJhY2tlbmRcIixzKSxkZWxldGUgdGhpcy50b3VjaEhpc3Rvcnlbbi5pZGVudGlmaWVyXX19dGhpcy5pc1RvdWNoZWQ9ITF9fWZ1bmN0aW9uIHIoKXtmb3IodmFyIHQgaW4gdGhpcy50b3VjaEhpc3Rvcnkpe3ZhciBpPXRoaXMudG91Y2hIaXN0b3J5W3RdO3RoaXMuZXZlbnRPdXRwdXQuZW1pdChcInRyYWNrZW5kXCIse3RvdWNoOmlbaS5sZW5ndGgtMV0udG91Y2gsdGltZXN0YW1wOkRhdGUubm93KCksY291bnQ6MCxoaXN0b3J5Oml9KSxkZWxldGUgdGhpcy50b3VjaEhpc3RvcnlbdF19fWZ1bmN0aW9uIGEodCl7dGhpcy5zZWxlY3RpdmU9dC5zZWxlY3RpdmUsdGhpcy50b3VjaExpbWl0PXQudG91Y2hMaW1pdHx8MSx0aGlzLnRvdWNoSGlzdG9yeT17fSx0aGlzLmV2ZW50SW5wdXQ9bmV3IGgsdGhpcy5ldmVudE91dHB1dD1uZXcgaCxoLnNldElucHV0SGFuZGxlcih0aGlzLHRoaXMuZXZlbnRJbnB1dCksaC5zZXRPdXRwdXRIYW5kbGVyKHRoaXMsdGhpcy5ldmVudE91dHB1dCksdGhpcy5ldmVudElucHV0Lm9uKFwidG91Y2hzdGFydFwiLG4uYmluZCh0aGlzKSksdGhpcy5ldmVudElucHV0Lm9uKFwidG91Y2htb3ZlXCIsby5iaW5kKHRoaXMpKSx0aGlzLmV2ZW50SW5wdXQub24oXCJ0b3VjaGVuZFwiLHMuYmluZCh0aGlzKSksdGhpcy5ldmVudElucHV0Lm9uKFwidG91Y2hjYW5jZWxcIixzLmJpbmQodGhpcykpLHRoaXMuZXZlbnRJbnB1dC5vbihcInVucGlwZVwiLHIuYmluZCh0aGlzKSksdGhpcy5pc1RvdWNoZWQ9ITF9dmFyIGg9dChcIi4uL2NvcmUvRXZlbnRIYW5kbGVyXCIpLGM9RGF0ZS5ub3c7YS5wcm90b3R5cGUudHJhY2s9ZnVuY3Rpb24odCl7dGhpcy50b3VjaEhpc3RvcnlbdC5pZGVudGlmaWVyXT1bdF19LGkuZXhwb3J0cz1hfSx7XCIuLi9jb3JlL0V2ZW50SGFuZGxlclwiOjd9XSwzNTpbZnVuY3Rpb24odCxpKXtmdW5jdGlvbiBlKCl7dGhpcy5fZXZlbnRJbnB1dD1uZXcgbix0aGlzLl9ldmVudE91dHB1dD1uZXcgbixuLnNldElucHV0SGFuZGxlcih0aGlzLHRoaXMuX2V2ZW50SW5wdXQpLG4uc2V0T3V0cHV0SGFuZGxlcih0aGlzLHRoaXMuX2V2ZW50T3V0cHV0KSx0aGlzLnRvdWNoQUVuYWJsZWQ9ITEsdGhpcy50b3VjaEFJZD0wLHRoaXMucG9zQT1udWxsLHRoaXMudGltZXN0YW1wQT0wLHRoaXMudG91Y2hCRW5hYmxlZD0hMSx0aGlzLnRvdWNoQklkPTAsdGhpcy5wb3NCPW51bGwsdGhpcy50aW1lc3RhbXBCPTAsdGhpcy5fZXZlbnRJbnB1dC5vbihcInRvdWNoc3RhcnRcIix0aGlzLmhhbmRsZVN0YXJ0LmJpbmQodGhpcykpLHRoaXMuX2V2ZW50SW5wdXQub24oXCJ0b3VjaG1vdmVcIix0aGlzLmhhbmRsZU1vdmUuYmluZCh0aGlzKSksdGhpcy5fZXZlbnRJbnB1dC5vbihcInRvdWNoZW5kXCIsdGhpcy5oYW5kbGVFbmQuYmluZCh0aGlzKSksdGhpcy5fZXZlbnRJbnB1dC5vbihcInRvdWNoY2FuY2VsXCIsdGhpcy5oYW5kbGVFbmQuYmluZCh0aGlzKSl9dmFyIG49dChcIi4uL2NvcmUvRXZlbnRIYW5kbGVyXCIpO2UuY2FsY3VsYXRlQW5nbGU9ZnVuY3Rpb24odCxpKXt2YXIgZT1pWzBdLXRbMF0sbj1pWzFdLXRbMV07cmV0dXJuIE1hdGguYXRhbjIobixlKX0sZS5jYWxjdWxhdGVEaXN0YW5jZT1mdW5jdGlvbih0LGkpe3ZhciBlPWlbMF0tdFswXSxuPWlbMV0tdFsxXTtyZXR1cm4gTWF0aC5zcXJ0KGUqZStuKm4pfSxlLmNhbGN1bGF0ZUNlbnRlcj1mdW5jdGlvbih0LGkpe3JldHVyblsodFswXStpWzBdKS8yLCh0WzFdK2lbMV0pLzJdfTt2YXIgbz1EYXRlLm5vdztlLnByb3RvdHlwZS5oYW5kbGVTdGFydD1mdW5jdGlvbih0KXtmb3IodmFyIGk9MDtpPHQuY2hhbmdlZFRvdWNoZXMubGVuZ3RoO2krKyl7dmFyIGU9dC5jaGFuZ2VkVG91Y2hlc1tpXTt0aGlzLnRvdWNoQUVuYWJsZWQ/dGhpcy50b3VjaEJFbmFibGVkfHwodGhpcy50b3VjaEJJZD1lLmlkZW50aWZpZXIsdGhpcy50b3VjaEJFbmFibGVkPSEwLHRoaXMucG9zQj1bZS5wYWdlWCxlLnBhZ2VZXSx0aGlzLnRpbWVzdGFtcEI9bygpLHRoaXMuX3N0YXJ0VXBkYXRlKHQpKToodGhpcy50b3VjaEFJZD1lLmlkZW50aWZpZXIsdGhpcy50b3VjaEFFbmFibGVkPSEwLHRoaXMucG9zQT1bZS5wYWdlWCxlLnBhZ2VZXSx0aGlzLnRpbWVzdGFtcEE9bygpKX19LGUucHJvdG90eXBlLmhhbmRsZU1vdmU9ZnVuY3Rpb24odCl7aWYodGhpcy50b3VjaEFFbmFibGVkJiZ0aGlzLnRvdWNoQkVuYWJsZWQpe2Zvcih2YXIgaSxlPXRoaXMudGltZXN0YW1wQSxuPXRoaXMudGltZXN0YW1wQixzPTA7czx0LmNoYW5nZWRUb3VjaGVzLmxlbmd0aDtzKyspe3ZhciByPXQuY2hhbmdlZFRvdWNoZXNbc107ci5pZGVudGlmaWVyPT09dGhpcy50b3VjaEFJZD8odGhpcy5wb3NBPVtyLnBhZ2VYLHIucGFnZVldLHRoaXMudGltZXN0YW1wQT1vKCksaT10aGlzLnRpbWVzdGFtcEEtZSk6ci5pZGVudGlmaWVyPT09dGhpcy50b3VjaEJJZCYmKHRoaXMucG9zQj1bci5wYWdlWCxyLnBhZ2VZXSx0aGlzLnRpbWVzdGFtcEI9bygpLGk9dGhpcy50aW1lc3RhbXBCLW4pfWkmJnRoaXMuX21vdmVVcGRhdGUoaSl9fSxlLnByb3RvdHlwZS5oYW5kbGVFbmQ9ZnVuY3Rpb24odCl7Zm9yKHZhciBpPTA7aTx0LmNoYW5nZWRUb3VjaGVzLmxlbmd0aDtpKyspe3ZhciBlPXQuY2hhbmdlZFRvdWNoZXNbaV07KGUuaWRlbnRpZmllcj09PXRoaXMudG91Y2hBSWR8fGUuaWRlbnRpZmllcj09PXRoaXMudG91Y2hCSWQpJiYodGhpcy50b3VjaEFFbmFibGVkJiZ0aGlzLnRvdWNoQkVuYWJsZWQmJnRoaXMuX2V2ZW50T3V0cHV0LmVtaXQoXCJlbmRcIix7dG91Y2hlczpbdGhpcy50b3VjaEFJZCx0aGlzLnRvdWNoQklkXSxhbmdsZTp0aGlzLl9hbmdsZX0pLHRoaXMudG91Y2hBRW5hYmxlZD0hMSx0aGlzLnRvdWNoQUlkPTAsdGhpcy50b3VjaEJFbmFibGVkPSExLHRoaXMudG91Y2hCSWQ9MCl9fSxpLmV4cG9ydHM9ZX0se1wiLi4vY29yZS9FdmVudEhhbmRsZXJcIjo3fV0sMzY6W2Z1bmN0aW9uKHQsaSl7aS5leHBvcnRzPXtBY2N1bXVsYXRvcjp0KFwiLi9BY2N1bXVsYXRvclwiKSxEZXNrdG9wRW11bGF0aW9uTW9kZTp0KFwiLi9EZXNrdG9wRW11bGF0aW9uTW9kZVwiKSxGYXN0Q2xpY2s6dChcIi4vRmFzdENsaWNrXCIpLEdlbmVyaWNTeW5jOnQoXCIuL0dlbmVyaWNTeW5jXCIpLE1vdXNlU3luYzp0KFwiLi9Nb3VzZVN5bmNcIiksUGluY2hTeW5jOnQoXCIuL1BpbmNoU3luY1wiKSxSb3RhdGVTeW5jOnQoXCIuL1JvdGF0ZVN5bmNcIiksU2NhbGVTeW5jOnQoXCIuL1NjYWxlU3luY1wiKSxTY3JvbGxTeW5jOnQoXCIuL1Njcm9sbFN5bmNcIiksVG91Y2hTeW5jOnQoXCIuL1RvdWNoU3luY1wiKSxUb3VjaFRyYWNrZXI6dChcIi4vVG91Y2hUcmFja2VyXCIpLFR3b0ZpbmdlclN5bmM6dChcIi4vVHdvRmluZ2VyU3luY1wiKX19LHtcIi4vQWNjdW11bGF0b3JcIjoyNCxcIi4vRGVza3RvcEVtdWxhdGlvbk1vZGVcIjoyNSxcIi4vRmFzdENsaWNrXCI6MjYsXCIuL0dlbmVyaWNTeW5jXCI6MjcsXCIuL01vdXNlU3luY1wiOjI4LFwiLi9QaW5jaFN5bmNcIjoyOSxcIi4vUm90YXRlU3luY1wiOjMwLFwiLi9TY2FsZVN5bmNcIjozMSxcIi4vU2Nyb2xsU3luY1wiOjMyLFwiLi9Ub3VjaFN5bmNcIjozMyxcIi4vVG91Y2hUcmFja2VyXCI6MzQsXCIuL1R3b0ZpbmdlclN5bmNcIjozNX1dLDM3OltmdW5jdGlvbih0LGkpe2Z1bmN0aW9uIGUodCl7cmV0dXJuIHRoaXMudmFsdWVzPXR8fFtbMSwwLDBdLFswLDEsMF0sWzAsMCwxXV0sdGhpc312YXIgbj10KFwiLi9WZWN0b3JcIiksbz1uZXcgZSxzPW5ldyBuO1xuZS5wcm90b3R5cGUuZ2V0PWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMudmFsdWVzfSxlLnByb3RvdHlwZS5zZXQ9ZnVuY3Rpb24odCl7dGhpcy52YWx1ZXM9dH0sZS5wcm90b3R5cGUudmVjdG9yTXVsdGlwbHk9ZnVuY3Rpb24odCl7dmFyIGk9dGhpcy5nZXQoKSxlPXQueCxuPXQueSxvPXQueixyPWlbMF0sYT1pWzFdLGg9aVsyXSxjPXJbMF0scD1yWzFdLHU9clsyXSxsPWFbMF0sZj1hWzFdLGQ9YVsyXSxfPWhbMF0seT1oWzFdLGc9aFsyXTtyZXR1cm4gcy5zZXRYWVooYyplK3Aqbit1Km8sbCplK2YqbitkKm8sXyplK3kqbitnKm8pfSxlLnByb3RvdHlwZS5tdWx0aXBseT1mdW5jdGlvbih0KXtmb3IodmFyIGk9dGhpcy5nZXQoKSxlPVtbXV0sbj0wOzM+bjtuKyspe2Vbbl09W107Zm9yKHZhciBzPTA7Mz5zO3MrKyl7Zm9yKHZhciByPTAsYT0wOzM+YTthKyspcis9aVtuXVthXSp0W2FdW3NdO2Vbbl1bc109cn19cmV0dXJuIG8uc2V0KGUpfSxlLnByb3RvdHlwZS50cmFuc3Bvc2U9ZnVuY3Rpb24oKXtmb3IodmFyIHQ9W10saT10aGlzLmdldCgpLGU9MDszPmU7ZSsrKWZvcih2YXIgbj0wOzM+bjtuKyspdFtlXVtuXT1pW25dW2VdO3JldHVybiBvLnNldCh0KX0sZS5wcm90b3R5cGUuY2xvbmU9ZnVuY3Rpb24oKXtmb3IodmFyIHQ9dGhpcy5nZXQoKSxpPVtdLG49MDszPm47bisrKWlbbl09dFtuXS5zbGljZSgpO3JldHVybiBuZXcgZShpKX0saS5leHBvcnRzPWV9LHtcIi4vVmVjdG9yXCI6NDF9XSwzODpbZnVuY3Rpb24odCxpKXtmdW5jdGlvbiBlKHQsaSxlLG4pe3JldHVybiAxPT09YXJndW1lbnRzLmxlbmd0aD90aGlzLnNldCh0KToodGhpcy53PXZvaWQgMCE9PXQ/dDoxLHRoaXMueD12b2lkIDAhPT1pP2k6MCx0aGlzLnk9dm9pZCAwIT09ZT9lOjAsdGhpcy56PXZvaWQgMCE9PW4/bjowKSx0aGlzfXZhciBuPXQoXCIuL01hdHJpeFwiKSxvPW5ldyBlKDEsMCwwLDApO2UucHJvdG90eXBlLmFkZD1mdW5jdGlvbih0KXtyZXR1cm4gby5zZXRXWFlaKHRoaXMudyt0LncsdGhpcy54K3QueCx0aGlzLnkrdC55LHRoaXMueit0LnopfSxlLnByb3RvdHlwZS5zdWI9ZnVuY3Rpb24odCl7cmV0dXJuIG8uc2V0V1hZWih0aGlzLnctdC53LHRoaXMueC10LngsdGhpcy55LXQueSx0aGlzLnotdC56KX0sZS5wcm90b3R5cGUuc2NhbGFyRGl2aWRlPWZ1bmN0aW9uKHQpe3JldHVybiB0aGlzLnNjYWxhck11bHRpcGx5KDEvdCl9LGUucHJvdG90eXBlLnNjYWxhck11bHRpcGx5PWZ1bmN0aW9uKHQpe3JldHVybiBvLnNldFdYWVoodGhpcy53KnQsdGhpcy54KnQsdGhpcy55KnQsdGhpcy56KnQpfSxlLnByb3RvdHlwZS5tdWx0aXBseT1mdW5jdGlvbih0KXt2YXIgaT10aGlzLngsZT10aGlzLnksbj10aGlzLnoscz10aGlzLncscj10LngsYT10LnksaD10LnosYz10Lnd8fDA7cmV0dXJuIG8uc2V0V1hZWihzKmMtaSpyLWUqYS1uKmgsaSpjK3IqcythKm4tZSpoLGUqYythKnMraSpoLXIqbixuKmMraCpzK3IqZS1pKmEpfTt2YXIgcz1uZXcgZSgxLDAsMCwwKTtlLnByb3RvdHlwZS5yb3RhdGVWZWN0b3I9ZnVuY3Rpb24odCl7cmV0dXJuIHMuc2V0KHRoaXMuY29uaigpKSxvLnNldCh0aGlzLm11bHRpcGx5KHQpLm11bHRpcGx5KHMpKX0sZS5wcm90b3R5cGUuaW52ZXJzZT1mdW5jdGlvbigpe3JldHVybiBvLnNldCh0aGlzLmNvbmooKS5zY2FsYXJEaXZpZGUodGhpcy5ub3JtU3F1YXJlZCgpKSl9LGUucHJvdG90eXBlLm5lZ2F0ZT1mdW5jdGlvbigpe3JldHVybiB0aGlzLnNjYWxhck11bHRpcGx5KC0xKX0sZS5wcm90b3R5cGUuY29uaj1mdW5jdGlvbigpe3JldHVybiBvLnNldFdYWVoodGhpcy53LC10aGlzLngsLXRoaXMueSwtdGhpcy56KX0sZS5wcm90b3R5cGUubm9ybWFsaXplPWZ1bmN0aW9uKHQpe3JldHVybiB0PXZvaWQgMD09PXQ/MTp0LHRoaXMuc2NhbGFyRGl2aWRlKHQqdGhpcy5ub3JtKCkpfSxlLnByb3RvdHlwZS5tYWtlRnJvbUFuZ2xlQW5kQXhpcz1mdW5jdGlvbih0LGkpe3ZhciBlPWkubm9ybWFsaXplKCksbj0uNSp0LG89LU1hdGguc2luKG4pO3JldHVybiB0aGlzLng9byplLngsdGhpcy55PW8qZS55LHRoaXMuej1vKmUueix0aGlzLnc9TWF0aC5jb3MobiksdGhpc30sZS5wcm90b3R5cGUuc2V0V1hZWj1mdW5jdGlvbih0LGksZSxuKXtyZXR1cm4gby5jbGVhcigpLHRoaXMudz10LHRoaXMueD1pLHRoaXMueT1lLHRoaXMuej1uLHRoaXN9LGUucHJvdG90eXBlLnNldD1mdW5jdGlvbih0KXtyZXR1cm4gdCBpbnN0YW5jZW9mIEFycmF5Pyh0aGlzLnc9MCx0aGlzLng9dFswXSx0aGlzLnk9dFsxXSx0aGlzLno9dFsyXSk6KHRoaXMudz10LncsdGhpcy54PXQueCx0aGlzLnk9dC55LHRoaXMuej10LnopLHRoaXMhPT1vJiZvLmNsZWFyKCksdGhpc30sZS5wcm90b3R5cGUucHV0PWZ1bmN0aW9uKHQpe3Quc2V0KG8pfSxlLnByb3RvdHlwZS5jbG9uZT1mdW5jdGlvbigpe3JldHVybiBuZXcgZSh0aGlzKX0sZS5wcm90b3R5cGUuY2xlYXI9ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy53PTEsdGhpcy54PTAsdGhpcy55PTAsdGhpcy56PTAsdGhpc30sZS5wcm90b3R5cGUuaXNFcXVhbD1mdW5jdGlvbih0KXtyZXR1cm4gdC53PT09dGhpcy53JiZ0Lng9PT10aGlzLngmJnQueT09PXRoaXMueSYmdC56PT09dGhpcy56fSxlLnByb3RvdHlwZS5kb3Q9ZnVuY3Rpb24odCl7cmV0dXJuIHRoaXMudyp0LncrdGhpcy54KnQueCt0aGlzLnkqdC55K3RoaXMueip0Lnp9LGUucHJvdG90eXBlLm5vcm1TcXVhcmVkPWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuZG90KHRoaXMpfSxlLnByb3RvdHlwZS5ub3JtPWZ1bmN0aW9uKCl7cmV0dXJuIE1hdGguc3FydCh0aGlzLm5vcm1TcXVhcmVkKCkpfSxlLnByb3RvdHlwZS5pc1plcm89ZnVuY3Rpb24oKXtyZXR1cm4hKHRoaXMueHx8dGhpcy55fHx0aGlzLnopfSxlLnByb3RvdHlwZS5nZXRUcmFuc2Zvcm09ZnVuY3Rpb24oKXt2YXIgdD10aGlzLm5vcm1hbGl6ZSgxKSxpPXQueCxlPXQueSxuPXQueixvPXQudztyZXR1cm5bMS0yKmUqZS0yKm4qbiwyKmkqZS0yKm4qbywyKmkqbisyKmUqbywwLDIqaSplKzIqbipvLDEtMippKmktMipuKm4sMiplKm4tMippKm8sMCwyKmkqbi0yKmUqbywyKmUqbisyKmkqbywxLTIqaSppLTIqZSplLDAsMCwwLDAsMV19O3ZhciByPW5ldyBuO2UucHJvdG90eXBlLmdldE1hdHJpeD1mdW5jdGlvbigpe3ZhciB0PXRoaXMubm9ybWFsaXplKDEpLGk9dC54LGU9dC55LG49dC56LG89dC53O3JldHVybiByLnNldChbWzEtMiplKmUtMipuKm4sMippKmUrMipuKm8sMippKm4tMiplKm9dLFsyKmkqZS0yKm4qbywxLTIqaSppLTIqbipuLDIqZSpuKzIqaSpvXSxbMippKm4rMiplKm8sMiplKm4tMippKm8sMS0yKmkqaS0yKmUqZV1dKX07dmFyIGE9MWUtNTtlLnByb3RvdHlwZS5zbGVycD1mdW5jdGlvbih0LGkpe3ZhciBlLG4scyxyLGg7cmV0dXJuIG49dGhpcy5kb3QodCksMS1uPmE/KGU9TWF0aC5hY29zKG4pLHM9TWF0aC5zaW4oZSkscj1NYXRoLnNpbigoMS1pKSplKS9zLGg9TWF0aC5zaW4oaSplKS9zKToocj0xLWksaD1pKSxvLnNldCh0aGlzLnNjYWxhck11bHRpcGx5KHIvaCkuYWRkKHQpLm11bHRpcGx5KGgpKX0saS5leHBvcnRzPWV9LHtcIi4vTWF0cml4XCI6Mzd9XSwzOTpbZnVuY3Rpb24odCxpKXtmdW5jdGlvbiBlKHQsaSl7cmV0dXJuIHQrbygpKihpLXQpfWZ1bmN0aW9uIG4odCxpKXtyZXR1cm4gdCtvKCkqKGktdCsxKT4+MH12YXIgbz1NYXRoLnJhbmRvbSxzPXt9O3MuaW50ZWdlcj1mdW5jdGlvbih0LGksZSl7aWYodD12b2lkIDAhPT10P3Q6MCxpPXZvaWQgMCE9PWk/aToxLHZvaWQgMCE9PWUpe2Zvcih2YXIgbz1bXSxzPTA7ZT5zO3MrKylvLnB1c2gobih0LGkpKTtyZXR1cm4gb31yZXR1cm4gbih0LGkpfSxzLnJhbmdlPWZ1bmN0aW9uKHQsaSxuKXtpZih0PXZvaWQgMCE9PXQ/dDowLGk9dm9pZCAwIT09aT9pOjEsdm9pZCAwIT09bil7Zm9yKHZhciBvPVtdLHM9MDtuPnM7cysrKW8ucHVzaChlKHQsaSkpO3JldHVybiBvfXJldHVybiBlKHQsaSl9LHMuc2lnbj1mdW5jdGlvbih0KXtyZXR1cm4gdD12b2lkIDAhPT10P3Q6LjUsbygpPHQ/MTotMX0scy5ib29sPWZ1bmN0aW9uKHQpe3JldHVybiB0PXZvaWQgMCE9PXQ/dDouNSxvKCk8dH0saS5leHBvcnRzPXN9LHt9XSw0MDpbZnVuY3Rpb24odCxpKXt2YXIgZT17fTtlLmNsYW1wPWZ1bmN0aW9uKHQsaSl7cmV0dXJuIE1hdGgubWF4KE1hdGgubWluKHQsaVsxXSksaVswXSl9LGUubGVuZ3RoPWZ1bmN0aW9uKHQpe2Zvcih2YXIgaT0wLGU9MDtlPHQubGVuZ3RoO2UrKylpKz10W2VdKnRbZV07cmV0dXJuIE1hdGguc3FydChpKX0saS5leHBvcnRzPWV9LHt9XSw0MTpbZnVuY3Rpb24odCxpKXtmdW5jdGlvbiBlKHQsaSxlKXtyZXR1cm4gMT09PWFyZ3VtZW50cy5sZW5ndGgmJnZvaWQgMCE9PXQ/dGhpcy5zZXQodCk6KHRoaXMueD10fHwwLHRoaXMueT1pfHwwLHRoaXMuej1lfHwwKSx0aGlzfWZ1bmN0aW9uIG4odCxpLGUpe3JldHVybiB0aGlzLng9dCx0aGlzLnk9aSx0aGlzLno9ZSx0aGlzfWZ1bmN0aW9uIG8odCl7cmV0dXJuIG4uY2FsbCh0aGlzLHRbMF0sdFsxXSx0WzJdfHwwKX1mdW5jdGlvbiBzKHQpe3JldHVybiBuLmNhbGwodGhpcyx0LngsdC55LHQueil9ZnVuY3Rpb24gcih0KXtyZXR1cm4gbi5jYWxsKHRoaXMsdCwwLDApfXZhciBhPW5ldyBlKDAsMCwwKTtlLnByb3RvdHlwZS5hZGQ9ZnVuY3Rpb24odCl7cmV0dXJuIG4uY2FsbChhLHRoaXMueCt0LngsdGhpcy55K3QueSx0aGlzLnordC56KX0sZS5wcm90b3R5cGUuc3ViPWZ1bmN0aW9uKHQpe3JldHVybiBuLmNhbGwoYSx0aGlzLngtdC54LHRoaXMueS10LnksdGhpcy56LXQueil9LGUucHJvdG90eXBlLm11bHQ9ZnVuY3Rpb24odCl7cmV0dXJuIG4uY2FsbChhLHQqdGhpcy54LHQqdGhpcy55LHQqdGhpcy56KX0sZS5wcm90b3R5cGUuZGl2PWZ1bmN0aW9uKHQpe3JldHVybiB0aGlzLm11bHQoMS90KX0sZS5wcm90b3R5cGUuY3Jvc3M9ZnVuY3Rpb24odCl7dmFyIGk9dGhpcy54LGU9dGhpcy55LG89dGhpcy56LHM9dC54LHI9dC55LGg9dC56O3JldHVybiBuLmNhbGwoYSxvKnItZSpoLGkqaC1vKnMsZSpzLWkqcil9LGUucHJvdG90eXBlLmVxdWFscz1mdW5jdGlvbih0KXtyZXR1cm4gdC54PT09dGhpcy54JiZ0Lnk9PT10aGlzLnkmJnQuej09PXRoaXMuen0sZS5wcm90b3R5cGUucm90YXRlWD1mdW5jdGlvbih0KXt2YXIgaT10aGlzLngsZT10aGlzLnksbz10aGlzLnoscz1NYXRoLmNvcyh0KSxyPU1hdGguc2luKHQpO3JldHVybiBuLmNhbGwoYSxpLGUqcy1vKnIsZSpyK28qcyl9LGUucHJvdG90eXBlLnJvdGF0ZVk9ZnVuY3Rpb24odCl7dmFyIGk9dGhpcy54LGU9dGhpcy55LG89dGhpcy56LHM9TWF0aC5jb3ModCkscj1NYXRoLnNpbih0KTtyZXR1cm4gbi5jYWxsKGEsbypyK2kqcyxlLG8qcy1pKnIpfSxlLnByb3RvdHlwZS5yb3RhdGVaPWZ1bmN0aW9uKHQpe3ZhciBpPXRoaXMueCxlPXRoaXMueSxvPXRoaXMueixzPU1hdGguY29zKHQpLHI9TWF0aC5zaW4odCk7cmV0dXJuIG4uY2FsbChhLGkqcy1lKnIsaSpyK2UqcyxvKX0sZS5wcm90b3R5cGUuZG90PWZ1bmN0aW9uKHQpe3JldHVybiB0aGlzLngqdC54K3RoaXMueSp0LnkrdGhpcy56KnQuen0sZS5wcm90b3R5cGUubm9ybVNxdWFyZWQ9ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5kb3QodGhpcyl9LGUucHJvdG90eXBlLm5vcm09ZnVuY3Rpb24oKXtyZXR1cm4gTWF0aC5zcXJ0KHRoaXMubm9ybVNxdWFyZWQoKSl9LGUucHJvdG90eXBlLm5vcm1hbGl6ZT1mdW5jdGlvbih0KXswPT09YXJndW1lbnRzLmxlbmd0aCYmKHQ9MSk7dmFyIGk9dGhpcy5ub3JtKCk7cmV0dXJuIGk+MWUtNz9zLmNhbGwoYSx0aGlzLm11bHQodC9pKSk6bi5jYWxsKGEsdCwwLDApfSxlLnByb3RvdHlwZS5jbG9uZT1mdW5jdGlvbigpe3JldHVybiBuZXcgZSh0aGlzKX0sZS5wcm90b3R5cGUuaXNaZXJvPWZ1bmN0aW9uKCl7cmV0dXJuISh0aGlzLnh8fHRoaXMueXx8dGhpcy56KX0sZS5wcm90b3R5cGUuc2V0PWZ1bmN0aW9uKHQpe3JldHVybiB0IGluc3RhbmNlb2YgQXJyYXk/by5jYWxsKHRoaXMsdCk6XCJudW1iZXJcIj09dHlwZW9mIHQ/ci5jYWxsKHRoaXMsdCk6cy5jYWxsKHRoaXMsdCl9LGUucHJvdG90eXBlLnNldFhZWj1mdW5jdGlvbigpe3JldHVybiBuLmFwcGx5KHRoaXMsYXJndW1lbnRzKX0sZS5wcm90b3R5cGUuc2V0MUQ9ZnVuY3Rpb24odCl7cmV0dXJuIHIuY2FsbCh0aGlzLHQpfSxlLnByb3RvdHlwZS5wdXQ9ZnVuY3Rpb24odCl7dGhpcz09PWE/cy5jYWxsKHQsYSk6cy5jYWxsKHQsdGhpcyl9LGUucHJvdG90eXBlLmNsZWFyPWZ1bmN0aW9uKCl7cmV0dXJuIG4uY2FsbCh0aGlzLDAsMCwwKX0sZS5wcm90b3R5cGUuY2FwPWZ1bmN0aW9uIGgoaCl7aWYoMS8wPT09aClyZXR1cm4gcy5jYWxsKGEsdGhpcyk7dmFyIHQ9dGhpcy5ub3JtKCk7cmV0dXJuIHQ+aD9zLmNhbGwoYSx0aGlzLm11bHQoaC90KSk6cy5jYWxsKGEsdGhpcyl9LGUucHJvdG90eXBlLnByb2plY3Q9ZnVuY3Rpb24odCl7cmV0dXJuIHQubXVsdCh0aGlzLmRvdCh0KSl9LGUucHJvdG90eXBlLnJlZmxlY3RBY3Jvc3M9ZnVuY3Rpb24odCl7cmV0dXJuIHQubm9ybWFsaXplKCkucHV0KHQpLHMoYSx0aGlzLnN1Yih0aGlzLnByb2plY3QodCkubXVsdCgyKSkpfSxlLnByb3RvdHlwZS5nZXQ9ZnVuY3Rpb24oKXtyZXR1cm5bdGhpcy54LHRoaXMueSx0aGlzLnpdfSxlLnByb3RvdHlwZS5nZXQxRD1mdW5jdGlvbigpe3JldHVybiB0aGlzLnh9LGkuZXhwb3J0cz1lfSx7fV0sNDI6W2Z1bmN0aW9uKHQsaSl7aS5leHBvcnRzPXtNYXRyaXg6dChcIi4vTWF0cml4XCIpLFF1YXRlcm5pb246dChcIi4vUXVhdGVybmlvblwiKSxSYW5kb206dChcIi4vUmFuZG9tXCIpLFV0aWxpdGllczp0KFwiLi9VdGlsaXRpZXNcIiksVmVjdG9yOnQoXCIuL1ZlY3RvclwiKX19LHtcIi4vTWF0cml4XCI6MzcsXCIuL1F1YXRlcm5pb25cIjozOCxcIi4vUmFuZG9tXCI6MzksXCIuL1V0aWxpdGllc1wiOjQwLFwiLi9WZWN0b3JcIjo0MX1dLDQzOltmdW5jdGlvbih0LGkpe2Z1bmN0aW9uIGUodCl7dGhpcy5vcHRpb25zPU9iamVjdC5jcmVhdGUoZS5ERUZBVUxUX09QVElPTlMpLHQmJnRoaXMuc2V0T3B0aW9ucyh0KSx0aGlzLl9wb3NpdGlvblN0YXRlPW5ldyBjKFswLDBdKSx0aGlzLl9kaWZmZXJlbnRpYWw9WzAsMF0sdGhpcy5fYWN0aXZlPSEwLHRoaXMuc3luYz1uZXcgbChbXCJtb3VzZVwiLFwidG91Y2hcIl0se3NjYWxlOnRoaXMub3B0aW9ucy5zY2FsZX0pLHRoaXMuZXZlbnRPdXRwdXQ9bmV3IHAscC5zZXRJbnB1dEhhbmRsZXIodGhpcyx0aGlzLnN5bmMpLHAuc2V0T3V0cHV0SGFuZGxlcih0aGlzLHRoaXMuZXZlbnRPdXRwdXQpLGEuY2FsbCh0aGlzKX1mdW5jdGlvbiBuKHQpe3ZhciBpPXRoaXMub3B0aW9ucyxlPWkucHJvamVjdGlvbixuPWkuc25hcFgsbz1pLnNuYXBZLHM9ZSZfLng/dFswXTowLHI9ZSZfLnk/dFsxXTowO3JldHVybiBuPjAmJihzLT1zJW4pLG8+MCYmKHItPXIlbyksW3Mscl19ZnVuY3Rpb24gbygpe3RoaXMuX2FjdGl2ZSYmKHRoaXMuX3Bvc2l0aW9uU3RhdGUuaXNBY3RpdmUoKSYmdGhpcy5fcG9zaXRpb25TdGF0ZS5oYWx0KCksdGhpcy5ldmVudE91dHB1dC5lbWl0KFwic3RhcnRcIix7cG9zaXRpb246dGhpcy5nZXRQb3NpdGlvbigpfSkpfWZ1bmN0aW9uIHModCl7aWYodGhpcy5fYWN0aXZlKXt2YXIgaT10aGlzLm9wdGlvbnM7dGhpcy5fZGlmZmVyZW50aWFsPXQucG9zaXRpb247dmFyIGU9bi5jYWxsKHRoaXMsdGhpcy5fZGlmZmVyZW50aWFsKTt0aGlzLl9kaWZmZXJlbnRpYWxbMF0tPWVbMF0sdGhpcy5fZGlmZmVyZW50aWFsWzFdLT1lWzFdO3ZhciBvPXRoaXMuZ2V0UG9zaXRpb24oKTtpZihvWzBdKz1lWzBdLG9bMV0rPWVbMV0saS54UmFuZ2Upe3ZhciBzPVtpLnhSYW5nZVswXSsuNSppLnNuYXBYLGkueFJhbmdlWzFdLS41Kmkuc25hcFhdO29bMF09eShvWzBdLHMpfWlmKGkueVJhbmdlKXt2YXIgcj1baS55UmFuZ2VbMF0rLjUqaS5zbmFwWSxpLnlSYW5nZVsxXS0uNSppLnNuYXBZXTtvWzFdPXkob1sxXSxyKX10aGlzLmV2ZW50T3V0cHV0LmVtaXQoXCJ1cGRhdGVcIix7cG9zaXRpb246b30pfX1mdW5jdGlvbiByKCl7dGhpcy5fYWN0aXZlJiZ0aGlzLmV2ZW50T3V0cHV0LmVtaXQoXCJlbmRcIix7cG9zaXRpb246dGhpcy5nZXRQb3NpdGlvbigpfSl9ZnVuY3Rpb24gYSgpe3RoaXMuc3luYy5vbihcInN0YXJ0XCIsby5iaW5kKHRoaXMpKSx0aGlzLnN5bmMub24oXCJ1cGRhdGVcIixzLmJpbmQodGhpcykpLHRoaXMuc3luYy5vbihcImVuZFwiLHIuYmluZCh0aGlzKSl9dmFyIGg9dChcIi4uL2NvcmUvVHJhbnNmb3JtXCIpLGM9dChcIi4uL3RyYW5zaXRpb25zL1RyYW5zaXRpb25hYmxlXCIpLHA9dChcIi4uL2NvcmUvRXZlbnRIYW5kbGVyXCIpLHU9dChcIi4uL21hdGgvVXRpbGl0aWVzXCIpLGw9dChcIi4uL2lucHV0cy9HZW5lcmljU3luY1wiKSxmPXQoXCIuLi9pbnB1dHMvTW91c2VTeW5jXCIpLGQ9dChcIi4uL2lucHV0cy9Ub3VjaFN5bmNcIik7bC5yZWdpc3Rlcih7bW91c2U6Zix0b3VjaDpkfSk7dmFyIF89e3g6MSx5OjJ9O2UuRElSRUNUSU9OX1g9Xy54LGUuRElSRUNUSU9OX1k9Xy55O3ZhciB5PXUuY2xhbXA7ZS5ERUZBVUxUX09QVElPTlM9e3Byb2plY3Rpb246Xy54fF8ueSxzY2FsZToxLHhSYW5nZTpudWxsLHlSYW5nZTpudWxsLHNuYXBYOjAsc25hcFk6MCx0cmFuc2l0aW9uOntkdXJhdGlvbjowfX0sZS5wcm90b3R5cGUuc2V0T3B0aW9ucz1mdW5jdGlvbih0KXt2YXIgaT10aGlzLm9wdGlvbnM7aWYodm9pZCAwIT09dC5wcm9qZWN0aW9uKXt2YXIgZT10LnByb2plY3Rpb247dGhpcy5vcHRpb25zLnByb2plY3Rpb249MCxbXCJ4XCIsXCJ5XCJdLmZvckVhY2goZnVuY3Rpb24odCl7LTEhPT1lLmluZGV4T2YodCkmJihpLnByb2plY3Rpb258PV9bdF0pfSl9dm9pZCAwIT09dC5zY2FsZSYmKGkuc2NhbGU9dC5zY2FsZSx0aGlzLnN5bmMuc2V0T3B0aW9ucyh7c2NhbGU6dC5zY2FsZX0pKSx2b2lkIDAhPT10LnhSYW5nZSYmKGkueFJhbmdlPXQueFJhbmdlKSx2b2lkIDAhPT10LnlSYW5nZSYmKGkueVJhbmdlPXQueVJhbmdlKSx2b2lkIDAhPT10LnNuYXBYJiYoaS5zbmFwWD10LnNuYXBYKSx2b2lkIDAhPT10LnNuYXBZJiYoaS5zbmFwWT10LnNuYXBZKX0sZS5wcm90b3R5cGUuZ2V0UG9zaXRpb249ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5fcG9zaXRpb25TdGF0ZS5nZXQoKX0sZS5wcm90b3R5cGUuc2V0UmVsYXRpdmVQb3NpdGlvbj1mdW5jdGlvbih0LGksZSl7dmFyIG49dGhpcy5nZXRQb3NpdGlvbigpLG89W25bMF0rdFswXSxuWzFdK3RbMV1dO3RoaXMuc2V0UG9zaXRpb24obyxpLGUpfSxlLnByb3RvdHlwZS5zZXRQb3NpdGlvbj1mdW5jdGlvbih0LGksZSl7dGhpcy5fcG9zaXRpb25TdGF0ZS5pc0FjdGl2ZSgpJiZ0aGlzLl9wb3NpdGlvblN0YXRlLmhhbHQoKSx0aGlzLl9wb3NpdGlvblN0YXRlLnNldCh0LGksZSl9LGUucHJvdG90eXBlLmFjdGl2YXRlPWZ1bmN0aW9uKCl7dGhpcy5fYWN0aXZlPSEwfSxlLnByb3RvdHlwZS5kZWFjdGl2YXRlPWZ1bmN0aW9uKCl7dGhpcy5fYWN0aXZlPSExfSxlLnByb3RvdHlwZS50b2dnbGU9ZnVuY3Rpb24oKXt0aGlzLl9hY3RpdmU9IXRoaXMuX2FjdGl2ZX0sZS5wcm90b3R5cGUubW9kaWZ5PWZ1bmN0aW9uKHQpe3ZhciBpPXRoaXMuZ2V0UG9zaXRpb24oKTtyZXR1cm57dHJhbnNmb3JtOmgudHJhbnNsYXRlKGlbMF0saVsxXSksdGFyZ2V0OnR9fSxpLmV4cG9ydHM9ZX0se1wiLi4vY29yZS9FdmVudEhhbmRsZXJcIjo3LFwiLi4vY29yZS9UcmFuc2Zvcm1cIjoxNSxcIi4uL2lucHV0cy9HZW5lcmljU3luY1wiOjI3LFwiLi4vaW5wdXRzL01vdXNlU3luY1wiOjI4LFwiLi4vaW5wdXRzL1RvdWNoU3luY1wiOjMzLFwiLi4vbWF0aC9VdGlsaXRpZXNcIjo0MCxcIi4uL3RyYW5zaXRpb25zL1RyYW5zaXRpb25hYmxlXCI6ODh9XSw0NDpbZnVuY3Rpb24odCxpKXtmdW5jdGlvbiBlKHQsaSl7dGhpcy5vcHRpb25zPU9iamVjdC5jcmVhdGUoZS5ERUZBVUxUX09QVElPTlMpLHRoaXMuX29wdGlvbnNNYW5hZ2VyPW5ldyBvKHRoaXMub3B0aW9ucyksdCYmdGhpcy5zZXRPcHRpb25zKHQpLGl8fChpPTApLHRoaXMudHJhbnNpdGlvbkhlbHBlcj1uZXcgbihpKX12YXIgbj10KFwiLi4vdHJhbnNpdGlvbnMvVHJhbnNpdGlvbmFibGVcIiksbz10KFwiLi4vY29yZS9PcHRpb25zTWFuYWdlclwiKTtlLkRFRkFVTFRfT1BUSU9OUz17Y3VsbDohMSx0cmFuc2l0aW9uOiEwLHB1bHNlSW5UcmFuc2l0aW9uOiEwLHB1bHNlT3V0VHJhbnNpdGlvbjohMH0sZS5wcm90b3R5cGUuc2V0T3B0aW9ucz1mdW5jdGlvbih0KXtyZXR1cm4gdGhpcy5fb3B0aW9uc01hbmFnZXIuc2V0T3B0aW9ucyh0KX0sZS5wcm90b3R5cGUuc2hvdz1mdW5jdGlvbih0LGkpe3Q9dHx8dGhpcy5vcHRpb25zLnRyYW5zaXRpb24sdGhpcy5zZXQoMSx0LGkpfSxlLnByb3RvdHlwZS5oaWRlPWZ1bmN0aW9uKHQsaSl7dD10fHx0aGlzLm9wdGlvbnMudHJhbnNpdGlvbix0aGlzLnNldCgwLHQsaSl9LGUucHJvdG90eXBlLnNldD1mdW5jdGlvbih0LGksZSl7dGhpcy5oYWx0KCksdGhpcy50cmFuc2l0aW9uSGVscGVyLnNldCh0LGksZSl9LGUucHJvdG90eXBlLmhhbHQ9ZnVuY3Rpb24oKXt0aGlzLnRyYW5zaXRpb25IZWxwZXIuaGFsdCgpfSxlLnByb3RvdHlwZS5pc1Zpc2libGU9ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy50cmFuc2l0aW9uSGVscGVyLmdldCgpPjB9LGUucHJvdG90eXBlLm1vZGlmeT1mdW5jdGlvbih0KXt2YXIgaT10aGlzLnRyYW5zaXRpb25IZWxwZXIuZ2V0KCk7cmV0dXJuIHRoaXMub3B0aW9ucy5jdWxsJiYhaT92b2lkIDA6e29wYWNpdHk6aSx0YXJnZXQ6dH19LGkuZXhwb3J0cz1lfSx7XCIuLi9jb3JlL09wdGlvbnNNYW5hZ2VyXCI6MTAsXCIuLi90cmFuc2l0aW9ucy9UcmFuc2l0aW9uYWJsZVwiOjg4fV0sNDU6W2Z1bmN0aW9uKHQsaSl7ZnVuY3Rpb24gZSgpe3RoaXMuX2NoYWluPVtdLGFyZ3VtZW50cy5sZW5ndGgmJnRoaXMuYWRkTW9kaWZpZXIuYXBwbHkodGhpcyxhcmd1bWVudHMpfWUucHJvdG90eXBlLmFkZE1vZGlmaWVyPWZ1bmN0aW9uKCl7QXJyYXkucHJvdG90eXBlLnB1c2guYXBwbHkodGhpcy5fY2hhaW4sYXJndW1lbnRzKX0sZS5wcm90b3R5cGUucmVtb3ZlTW9kaWZpZXI9ZnVuY3Rpb24odCl7dmFyIGk9dGhpcy5fY2hhaW4uaW5kZXhPZih0KTswPml8fHRoaXMuX2NoYWluLnNwbGljZShpLDEpfSxlLnByb3RvdHlwZS5tb2RpZnk9ZnVuY3Rpb24odCl7Zm9yKHZhciBpPXRoaXMuX2NoYWluLGU9dCxuPTA7bjxpLmxlbmd0aDtuKyspZT1pW25dLm1vZGlmeShlKTtyZXR1cm4gZX0saS5leHBvcnRzPWV9LHt9XSw0NjpbZnVuY3Rpb24odCxpKXtmdW5jdGlvbiBlKHQpe3RoaXMuX3RyYW5zZm9ybVN0YXRlPW5ldyByKG8uaWRlbnRpdHkpLHRoaXMuX29wYWNpdHlTdGF0ZT1uZXcgcygxKSx0aGlzLl9vcmlnaW5TdGF0ZT1uZXcgcyhbMCwwXSksdGhpcy5fYWxpZ25TdGF0ZT1uZXcgcyhbMCwwXSksdGhpcy5fc2l6ZVN0YXRlPW5ldyBzKFswLDBdKSx0aGlzLl9wcm9wb3J0aW9uc1N0YXRlPW5ldyBzKFswLDBdKSx0aGlzLl9tb2RpZmllcj1uZXcgbih7dHJhbnNmb3JtOnRoaXMuX3RyYW5zZm9ybVN0YXRlLG9wYWNpdHk6dGhpcy5fb3BhY2l0eVN0YXRlLG9yaWdpbjpudWxsLGFsaWduOm51bGwsc2l6ZTpudWxsLHByb3BvcnRpb25zOm51bGx9KSx0aGlzLl9oYXNPcmlnaW49ITEsdGhpcy5faGFzQWxpZ249ITEsdGhpcy5faGFzU2l6ZT0hMSx0aGlzLl9oYXNQcm9wb3J0aW9ucz0hMSx0JiYodC50cmFuc2Zvcm0mJnRoaXMuc2V0VHJhbnNmb3JtKHQudHJhbnNmb3JtKSx2b2lkIDAhPT10Lm9wYWNpdHkmJnRoaXMuc2V0T3BhY2l0eSh0Lm9wYWNpdHkpLHQub3JpZ2luJiZ0aGlzLnNldE9yaWdpbih0Lm9yaWdpbiksdC5hbGlnbiYmdGhpcy5zZXRBbGlnbih0LmFsaWduKSx0LnNpemUmJnRoaXMuc2V0U2l6ZSh0LnNpemUpLHQucHJvcG9ydGlvbnMmJnRoaXMuc2V0UHJvcG9ydGlvbnModC5wcm9wb3J0aW9ucykpfXZhciBuPXQoXCIuLi9jb3JlL01vZGlmaWVyXCIpLG89dChcIi4uL2NvcmUvVHJhbnNmb3JtXCIpLHM9dChcIi4uL3RyYW5zaXRpb25zL1RyYW5zaXRpb25hYmxlXCIpLHI9dChcIi4uL3RyYW5zaXRpb25zL1RyYW5zaXRpb25hYmxlVHJhbnNmb3JtXCIpO2UucHJvdG90eXBlLnNldFRyYW5zZm9ybT1mdW5jdGlvbih0LGksZSl7cmV0dXJuIHRoaXMuX3RyYW5zZm9ybVN0YXRlLnNldCh0LGksZSksdGhpc30sZS5wcm90b3R5cGUuc2V0T3BhY2l0eT1mdW5jdGlvbih0LGksZSl7cmV0dXJuIHRoaXMuX29wYWNpdHlTdGF0ZS5zZXQodCxpLGUpLHRoaXN9LGUucHJvdG90eXBlLnNldE9yaWdpbj1mdW5jdGlvbih0LGksZSl7cmV0dXJuIG51bGw9PT10Pyh0aGlzLl9oYXNPcmlnaW4mJih0aGlzLl9tb2RpZmllci5vcmlnaW5Gcm9tKG51bGwpLHRoaXMuX2hhc09yaWdpbj0hMSksdGhpcyk6KHRoaXMuX2hhc09yaWdpbnx8KHRoaXMuX2hhc09yaWdpbj0hMCx0aGlzLl9tb2RpZmllci5vcmlnaW5Gcm9tKHRoaXMuX29yaWdpblN0YXRlKSksdGhpcy5fb3JpZ2luU3RhdGUuc2V0KHQsaSxlKSx0aGlzKX0sZS5wcm90b3R5cGUuc2V0QWxpZ249ZnVuY3Rpb24odCxpLGUpe3JldHVybiBudWxsPT09dD8odGhpcy5faGFzQWxpZ24mJih0aGlzLl9tb2RpZmllci5hbGlnbkZyb20obnVsbCksdGhpcy5faGFzQWxpZ249ITEpLHRoaXMpOih0aGlzLl9oYXNBbGlnbnx8KHRoaXMuX2hhc0FsaWduPSEwLHRoaXMuX21vZGlmaWVyLmFsaWduRnJvbSh0aGlzLl9hbGlnblN0YXRlKSksdGhpcy5fYWxpZ25TdGF0ZS5zZXQodCxpLGUpLHRoaXMpfSxlLnByb3RvdHlwZS5zZXRTaXplPWZ1bmN0aW9uKHQsaSxlKXtyZXR1cm4gbnVsbD09PXQ/KHRoaXMuX2hhc1NpemUmJih0aGlzLl9tb2RpZmllci5zaXplRnJvbShudWxsKSx0aGlzLl9oYXNTaXplPSExKSx0aGlzKToodGhpcy5faGFzU2l6ZXx8KHRoaXMuX2hhc1NpemU9ITAsdGhpcy5fbW9kaWZpZXIuc2l6ZUZyb20odGhpcy5fc2l6ZVN0YXRlKSksdGhpcy5fc2l6ZVN0YXRlLnNldCh0LGksZSksdGhpcyl9LGUucHJvdG90eXBlLnNldFByb3BvcnRpb25zPWZ1bmN0aW9uKHQsaSxlKXtyZXR1cm4gbnVsbD09PXQ/KHRoaXMuX2hhc1Byb3BvcnRpb25zJiYodGhpcy5fbW9kaWZpZXIucHJvcG9ydGlvbnNGcm9tKG51bGwpLHRoaXMuX2hhc1Byb3BvcnRpb25zPSExKSx0aGlzKToodGhpcy5faGFzUHJvcG9ydGlvbnN8fCh0aGlzLl9oYXNQcm9wb3J0aW9ucz0hMCx0aGlzLl9tb2RpZmllci5wcm9wb3J0aW9uc0Zyb20odGhpcy5fcHJvcG9ydGlvbnNTdGF0ZSkpLHRoaXMuX3Byb3BvcnRpb25zU3RhdGUuc2V0KHQsaSxlKSx0aGlzKX0sZS5wcm90b3R5cGUuaGFsdD1mdW5jdGlvbigpe3RoaXMuX3RyYW5zZm9ybVN0YXRlLmhhbHQoKSx0aGlzLl9vcGFjaXR5U3RhdGUuaGFsdCgpLHRoaXMuX29yaWdpblN0YXRlLmhhbHQoKSx0aGlzLl9hbGlnblN0YXRlLmhhbHQoKSx0aGlzLl9zaXplU3RhdGUuaGFsdCgpLHRoaXMuX3Byb3BvcnRpb25zU3RhdGUuaGFsdCgpfSxlLnByb3RvdHlwZS5nZXRUcmFuc2Zvcm09ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5fdHJhbnNmb3JtU3RhdGUuZ2V0KCl9LGUucHJvdG90eXBlLmdldEZpbmFsVHJhbnNmb3JtPWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuX3RyYW5zZm9ybVN0YXRlLmdldEZpbmFsKCl9LGUucHJvdG90eXBlLmdldE9wYWNpdHk9ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5fb3BhY2l0eVN0YXRlLmdldCgpfSxlLnByb3RvdHlwZS5nZXRPcmlnaW49ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5faGFzT3JpZ2luP3RoaXMuX29yaWdpblN0YXRlLmdldCgpOm51bGx9LGUucHJvdG90eXBlLmdldEFsaWduPWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuX2hhc0FsaWduP3RoaXMuX2FsaWduU3RhdGUuZ2V0KCk6bnVsbH0sZS5wcm90b3R5cGUuZ2V0U2l6ZT1mdW5jdGlvbigpe3JldHVybiB0aGlzLl9oYXNTaXplP3RoaXMuX3NpemVTdGF0ZS5nZXQoKTpudWxsfSxlLnByb3RvdHlwZS5nZXRQcm9wb3J0aW9ucz1mdW5jdGlvbigpe3JldHVybiB0aGlzLl9oYXNQcm9wb3J0aW9ucz90aGlzLl9wcm9wb3J0aW9uc1N0YXRlLmdldCgpOm51bGx9LGUucHJvdG90eXBlLm1vZGlmeT1mdW5jdGlvbih0KXtyZXR1cm4gdGhpcy5fbW9kaWZpZXIubW9kaWZ5KHQpfSxpLmV4cG9ydHM9ZX0se1wiLi4vY29yZS9Nb2RpZmllclwiOjksXCIuLi9jb3JlL1RyYW5zZm9ybVwiOjE1LFwiLi4vdHJhbnNpdGlvbnMvVHJhbnNpdGlvbmFibGVcIjo4OCxcIi4uL3RyYW5zaXRpb25zL1RyYW5zaXRpb25hYmxlVHJhbnNmb3JtXCI6ODl9XSw0NzpbZnVuY3Rpb24odCxpKXtpLmV4cG9ydHM9e0RyYWdnYWJsZTp0KFwiLi9EcmFnZ2FibGVcIiksRmFkZXI6dChcIi4vRmFkZXJcIiksTW9kaWZpZXJDaGFpbjp0KFwiLi9Nb2RpZmllckNoYWluXCIpLFN0YXRlTW9kaWZpZXI6dChcIi4vU3RhdGVNb2RpZmllclwiKX19LHtcIi4vRHJhZ2dhYmxlXCI6NDMsXCIuL0ZhZGVyXCI6NDQsXCIuL01vZGlmaWVyQ2hhaW5cIjo0NSxcIi4vU3RhdGVNb2RpZmllclwiOjQ2fV0sNDg6W2Z1bmN0aW9uKHQsaSl7ZnVuY3Rpb24gZSh0KXt0aGlzLm9wdGlvbnM9T2JqZWN0LmNyZWF0ZShlLkRFRkFVTFRfT1BUSU9OUyksdCYmdGhpcy5zZXRPcHRpb25zKHQpLHRoaXMuX3BhcnRpY2xlcz1bXSx0aGlzLl9ib2RpZXM9W10sdGhpcy5fYWdlbnREYXRhPXt9LHRoaXMuX2ZvcmNlcz1bXSx0aGlzLl9jb25zdHJhaW50cz1bXSx0aGlzLl9idWZmZXI9MCx0aGlzLl9wcmV2VGltZT1TKCksdGhpcy5faXNTbGVlcGluZz0hMSx0aGlzLl9ldmVudEhhbmRsZXI9bnVsbCx0aGlzLl9jdXJyQWdlbnRJZD0wLHRoaXMuX2hhc0JvZGllcz0hMSx0aGlzLl9ldmVudEhhbmRsZXI9bnVsbH1mdW5jdGlvbiBuKHQpe3JldHVybiB0LmFwcGx5Rm9yY2U/dGhpcy5fZm9yY2VzOnQuYXBwbHlDb25zdHJhaW50P3RoaXMuX2NvbnN0cmFpbnRzOnZvaWQgMH1mdW5jdGlvbiBvKHQsaSxlKXtyZXR1cm4gdm9pZCAwPT09aSYmKGk9dGhpcy5nZXRQYXJ0aWNsZXNBbmRCb2RpZXMoKSksaSBpbnN0YW5jZW9mIEFycmF5fHwoaT1baV0pLHQub24oXCJjaGFuZ2VcIix0aGlzLndha2UuYmluZCh0aGlzKSksdGhpcy5fYWdlbnREYXRhW3RoaXMuX2N1cnJBZ2VudElkXT17YWdlbnQ6dCxpZDp0aGlzLl9jdXJyQWdlbnRJZCx0YXJnZXRzOmksc291cmNlOmV9LG4uY2FsbCh0aGlzLHQpLnB1c2godGhpcy5fY3VyckFnZW50SWQpLHRoaXMuX2N1cnJBZ2VudElkKyt9ZnVuY3Rpb24gcyh0KXtyZXR1cm4gdGhpcy5fYWdlbnREYXRhW3RdfWZ1bmN0aW9uIHIodCl7dmFyIGk9cy5jYWxsKHRoaXMsdGhpcy5fZm9yY2VzW3RdKTtpLmFnZW50LmFwcGx5Rm9yY2UoaS50YXJnZXRzLGkuc291cmNlKX1mdW5jdGlvbiBhKCl7Zm9yKHZhciB0PXRoaXMuX2ZvcmNlcy5sZW5ndGgtMTt0Pi0xO3QtLSlyLmNhbGwodGhpcyx0KX1mdW5jdGlvbiBoKHQsaSl7dmFyIGU9dGhpcy5fYWdlbnREYXRhW3RoaXMuX2NvbnN0cmFpbnRzW3RdXTtyZXR1cm4gZS5hZ2VudC5hcHBseUNvbnN0cmFpbnQoZS50YXJnZXRzLGUuc291cmNlLGkpfWZ1bmN0aW9uIGModCl7Zm9yKHZhciBpPTA7aTx0aGlzLm9wdGlvbnMuY29uc3RyYWludFN0ZXBzOyl7Zm9yKHZhciBlPXRoaXMuX2NvbnN0cmFpbnRzLmxlbmd0aC0xO2U+LTE7ZS0tKWguY2FsbCh0aGlzLGUsdCk7aSsrfX1mdW5jdGlvbiBwKHQsaSl7dC5pbnRlZ3JhdGVWZWxvY2l0eShpKSx0aGlzLm9wdGlvbnMudmVsb2NpdHlDYXAmJnQudmVsb2NpdHkuY2FwKHRoaXMub3B0aW9ucy52ZWxvY2l0eUNhcCkucHV0KHQudmVsb2NpdHkpfWZ1bmN0aW9uIHUodCxpKXt0LmludGVncmF0ZUFuZ3VsYXJNb21lbnR1bShpKSx0LnVwZGF0ZUFuZ3VsYXJWZWxvY2l0eSgpLHRoaXMub3B0aW9ucy5hbmd1bGFyVmVsb2NpdHlDYXAmJnQuYW5ndWxhclZlbG9jaXR5LmNhcCh0aGlzLm9wdGlvbnMuYW5ndWxhclZlbG9jaXR5Q2FwKS5wdXQodC5hbmd1bGFyVmVsb2NpdHkpfWZ1bmN0aW9uIGwodCxpKXt0LmludGVncmF0ZU9yaWVudGF0aW9uKGkpfWZ1bmN0aW9uIGYodCxpKXt0LmludGVncmF0ZVBvc2l0aW9uKGkpLHQuZW1pdChULnVwZGF0ZSx0KX1mdW5jdGlvbiBkKHQpe2EuY2FsbCh0aGlzLHQpLHRoaXMuZm9yRWFjaChwLHQpLHRoaXMuZm9yRWFjaEJvZHkodSx0KSxjLmNhbGwodGhpcyx0KSx0aGlzLmZvckVhY2hCb2R5KGwsdCksdGhpcy5mb3JFYWNoKGYsdCl9ZnVuY3Rpb24gXygpe3ZhciB0PTAsaT0wO3JldHVybiB0aGlzLmZvckVhY2goZnVuY3Rpb24oZSl7aT1lLmdldEVuZXJneSgpLHQrPWl9KSx0fWZ1bmN0aW9uIHkoKXt2YXIgdD0wO2Zvcih2YXIgaSBpbiB0aGlzLl9hZ2VudERhdGEpdCs9dGhpcy5nZXRBZ2VudEVuZXJneShpKTtyZXR1cm4gdH12YXIgZz10KFwiLi4vY29yZS9FdmVudEhhbmRsZXJcIiksdj0xNyxtPTFlMy8xMjAsTz0xNyxTPURhdGUubm93LFQ9e3N0YXJ0Olwic3RhcnRcIix1cGRhdGU6XCJ1cGRhdGVcIixlbmQ6XCJlbmRcIn07ZS5ERUZBVUxUX09QVElPTlM9e2NvbnN0cmFpbnRTdGVwczoxLHNsZWVwVG9sZXJhbmNlOjFlLTcsdmVsb2NpdHlDYXA6dm9pZCAwLGFuZ3VsYXJWZWxvY2l0eUNhcDp2b2lkIDB9LGUucHJvdG90eXBlLnNldE9wdGlvbnM9ZnVuY3Rpb24odCl7Zm9yKHZhciBpIGluIHQpdGhpcy5vcHRpb25zW2ldJiYodGhpcy5vcHRpb25zW2ldPXRbaV0pfSxlLnByb3RvdHlwZS5hZGRCb2R5PWZ1bmN0aW9uKHQpe3JldHVybiB0Ll9lbmdpbmU9dGhpcyx0LmlzQm9keT8odGhpcy5fYm9kaWVzLnB1c2godCksdGhpcy5faGFzQm9kaWVzPSEwKTp0aGlzLl9wYXJ0aWNsZXMucHVzaCh0KSx0Lm9uKFwic3RhcnRcIix0aGlzLndha2UuYmluZCh0aGlzKSksdH0sZS5wcm90b3R5cGUucmVtb3ZlQm9keT1mdW5jdGlvbih0KXt2YXIgaT10LmlzQm9keT90aGlzLl9ib2RpZXM6dGhpcy5fcGFydGljbGVzLGU9aS5pbmRleE9mKHQpO2lmKGU+LTEpe2Zvcih2YXIgbiBpbiB0aGlzLl9hZ2VudERhdGEpdGhpcy5kZXRhY2hGcm9tKG4uaWQsdCk7aS5zcGxpY2UoZSwxKX0wPT09dGhpcy5nZXRCb2RpZXMoKS5sZW5ndGgmJih0aGlzLl9oYXNCb2RpZXM9ITEpfSxlLnByb3RvdHlwZS5hdHRhY2g9ZnVuY3Rpb24odCxpLGUpe2lmKHRoaXMud2FrZSgpLHQgaW5zdGFuY2VvZiBBcnJheSl7Zm9yKHZhciBuPVtdLHM9MDtzPHQubGVuZ3RoO3MrKyluW3NdPW8uY2FsbCh0aGlzLHRbc10saSxlKTtyZXR1cm4gbn1yZXR1cm4gby5jYWxsKHRoaXMsdCxpLGUpfSxlLnByb3RvdHlwZS5hdHRhY2hUbz1mdW5jdGlvbih0LGkpe3MuY2FsbCh0aGlzLHQpLnRhcmdldHMucHVzaChpKX0sZS5wcm90b3R5cGUuZGV0YWNoPWZ1bmN0aW9uKHQpe3ZhciBpPXRoaXMuZ2V0QWdlbnQodCksZT1uLmNhbGwodGhpcyxpKSxvPWUuaW5kZXhPZih0KTtlLnNwbGljZShvLDEpLGRlbGV0ZSB0aGlzLl9hZ2VudERhdGFbdF19LGUucHJvdG90eXBlLmRldGFjaEZyb209ZnVuY3Rpb24odCxpKXt2YXIgZT1zLmNhbGwodGhpcyx0KTtpZihlLnNvdXJjZT09PWkpdGhpcy5kZXRhY2godCk7ZWxzZXt2YXIgbj1lLnRhcmdldHMsbz1uLmluZGV4T2YoaSk7bz4tMSYmbi5zcGxpY2UobywxKX19LGUucHJvdG90eXBlLmRldGFjaEFsbD1mdW5jdGlvbigpe3RoaXMuX2FnZW50RGF0YT17fSx0aGlzLl9mb3JjZXM9W10sdGhpcy5fY29uc3RyYWludHM9W10sdGhpcy5fY3VyckFnZW50SWQ9MH0sZS5wcm90b3R5cGUuZ2V0QWdlbnQ9ZnVuY3Rpb24odCl7cmV0dXJuIHMuY2FsbCh0aGlzLHQpLmFnZW50fSxlLnByb3RvdHlwZS5nZXRQYXJ0aWNsZXM9ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5fcGFydGljbGVzfSxlLnByb3RvdHlwZS5nZXRCb2RpZXM9ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5fYm9kaWVzfSxlLnByb3RvdHlwZS5nZXRQYXJ0aWNsZXNBbmRCb2RpZXM9ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5nZXRQYXJ0aWNsZXMoKS5jb25jYXQodGhpcy5nZXRCb2RpZXMoKSl9LGUucHJvdG90eXBlLmZvckVhY2hQYXJ0aWNsZT1mdW5jdGlvbih0LGkpe2Zvcih2YXIgZT10aGlzLmdldFBhcnRpY2xlcygpLG49MCxvPWUubGVuZ3RoO28+bjtuKyspdC5jYWxsKHRoaXMsZVtuXSxpKX0sZS5wcm90b3R5cGUuZm9yRWFjaEJvZHk9ZnVuY3Rpb24odCxpKXtpZih0aGlzLl9oYXNCb2RpZXMpZm9yKHZhciBlPXRoaXMuZ2V0Qm9kaWVzKCksbj0wLG89ZS5sZW5ndGg7bz5uO24rKyl0LmNhbGwodGhpcyxlW25dLGkpfSxlLnByb3RvdHlwZS5mb3JFYWNoPWZ1bmN0aW9uKHQsaSl7dGhpcy5mb3JFYWNoUGFydGljbGUodCxpKSx0aGlzLmZvckVhY2hCb2R5KHQsaSl9LGUucHJvdG90eXBlLmdldEFnZW50RW5lcmd5PWZ1bmN0aW9uKHQpe3ZhciBpPXMuY2FsbCh0aGlzLHQpO3JldHVybiBpLmFnZW50LmdldEVuZXJneShpLnRhcmdldHMsaS5zb3VyY2UpfSxlLnByb3RvdHlwZS5nZXRFbmVyZ3k9ZnVuY3Rpb24oKXtyZXR1cm4gXy5jYWxsKHRoaXMpK3kuY2FsbCh0aGlzKX0sZS5wcm90b3R5cGUuc3RlcD1mdW5jdGlvbigpe2lmKCF0aGlzLmlzU2xlZXBpbmcoKSl7dmFyIHQ9UygpLGk9dC10aGlzLl9wcmV2VGltZTt0aGlzLl9wcmV2VGltZT10LG0+aXx8KGk+TyYmKGk9TyksZC5jYWxsKHRoaXMsdiksdGhpcy5lbWl0KFQudXBkYXRlLHRoaXMpLHRoaXMuZ2V0RW5lcmd5KCk8dGhpcy5vcHRpb25zLnNsZWVwVG9sZXJhbmNlJiZ0aGlzLnNsZWVwKCkpfX0sZS5wcm90b3R5cGUuaXNTbGVlcGluZz1mdW5jdGlvbigpe3JldHVybiB0aGlzLl9pc1NsZWVwaW5nfSxlLnByb3RvdHlwZS5pc0FjdGl2ZT1mdW5jdGlvbigpe3JldHVybiF0aGlzLl9pc1NsZWVwaW5nfSxlLnByb3RvdHlwZS5zbGVlcD1mdW5jdGlvbigpe3RoaXMuX2lzU2xlZXBpbmd8fCh0aGlzLmZvckVhY2goZnVuY3Rpb24odCl7dC5zbGVlcCgpfSksdGhpcy5lbWl0KFQuZW5kLHRoaXMpLHRoaXMuX2lzU2xlZXBpbmc9ITApfSxlLnByb3RvdHlwZS53YWtlPWZ1bmN0aW9uKCl7dGhpcy5faXNTbGVlcGluZyYmKHRoaXMuX3ByZXZUaW1lPVMoKSx0aGlzLmVtaXQoVC5zdGFydCx0aGlzKSx0aGlzLl9pc1NsZWVwaW5nPSExKX0sZS5wcm90b3R5cGUuZW1pdD1mdW5jdGlvbih0LGkpe251bGwhPT10aGlzLl9ldmVudEhhbmRsZXImJnRoaXMuX2V2ZW50SGFuZGxlci5lbWl0KHQsaSl9LGUucHJvdG90eXBlLm9uPWZ1bmN0aW9uKHQsaSl7bnVsbD09PXRoaXMuX2V2ZW50SGFuZGxlciYmKHRoaXMuX2V2ZW50SGFuZGxlcj1uZXcgZyksdGhpcy5fZXZlbnRIYW5kbGVyLm9uKHQsaSl9LGkuZXhwb3J0cz1lfSx7XCIuLi9jb3JlL0V2ZW50SGFuZGxlclwiOjd9XSw0OTpbZnVuY3Rpb24odCxpKXtmdW5jdGlvbiBlKHQpe24uY2FsbCh0aGlzLHQpLHQ9dHx8e30sdGhpcy5vcmllbnRhdGlvbj1uZXcgcix0aGlzLmFuZ3VsYXJWZWxvY2l0eT1uZXcgcyx0aGlzLmFuZ3VsYXJNb21lbnR1bT1uZXcgcyx0aGlzLnRvcnF1ZT1uZXcgcyx0Lm9yaWVudGF0aW9uJiZ0aGlzLm9yaWVudGF0aW9uLnNldCh0Lm9yaWVudGF0aW9uKSx0LmFuZ3VsYXJWZWxvY2l0eSYmdGhpcy5hbmd1bGFyVmVsb2NpdHkuc2V0KHQuYW5ndWxhclZlbG9jaXR5KSx0LmFuZ3VsYXJNb21lbnR1bSYmdGhpcy5hbmd1bGFyTW9tZW50dW0uc2V0KHQuYW5ndWxhck1vbWVudHVtKSx0LnRvcnF1ZSYmdGhpcy50b3JxdWUuc2V0KHQudG9ycXVlKSx0aGlzLmFuZ3VsYXJWZWxvY2l0eS53PTAsdGhpcy5zZXRNb21lbnRzT2ZJbmVydGlhKCksdGhpcy5wV29ybGQ9bmV3IHN9dmFyIG49dChcIi4vUGFydGljbGVcIiksbz10KFwiLi4vLi4vY29yZS9UcmFuc2Zvcm1cIikscz10KFwiLi4vLi4vbWF0aC9WZWN0b3JcIikscj10KFwiLi4vLi4vbWF0aC9RdWF0ZXJuaW9uXCIpLGE9dChcIi4uLy4uL21hdGgvTWF0cml4XCIpLGg9dChcIi4uL2ludGVncmF0b3JzL1N5bXBsZWN0aWNFdWxlclwiKTtlLkRFRkFVTFRfT1BUSU9OUz1uLkRFRkFVTFRfT1BUSU9OUyxlLkRFRkFVTFRfT1BUSU9OUy5vcmllbnRhdGlvbj1bMCwwLDAsMV0sZS5ERUZBVUxUX09QVElPTlMuYW5ndWxhclZlbG9jaXR5PVswLDAsMF0sZS5wcm90b3R5cGU9T2JqZWN0LmNyZWF0ZShuLnByb3RvdHlwZSksZS5wcm90b3R5cGUuY29uc3RydWN0b3I9ZSxlLnByb3RvdHlwZS5pc0JvZHk9ITAsZS5wcm90b3R5cGUuc2V0TWFzcz1mdW5jdGlvbigpe24ucHJvdG90eXBlLnNldE1hc3MuYXBwbHkodGhpcyxhcmd1bWVudHMpLHRoaXMuc2V0TW9tZW50c09mSW5lcnRpYSgpfSxlLnByb3RvdHlwZS5zZXRNb21lbnRzT2ZJbmVydGlhPWZ1bmN0aW9uKCl7dGhpcy5pbmVydGlhPW5ldyBhLHRoaXMuaW52ZXJzZUluZXJ0aWE9bmV3IGF9LGUucHJvdG90eXBlLnVwZGF0ZUFuZ3VsYXJWZWxvY2l0eT1mdW5jdGlvbigpe3RoaXMuYW5ndWxhclZlbG9jaXR5LnNldCh0aGlzLmludmVyc2VJbmVydGlhLnZlY3Rvck11bHRpcGx5KHRoaXMuYW5ndWxhck1vbWVudHVtKSl9LGUucHJvdG90eXBlLnRvV29ybGRDb29yZGluYXRlcz1mdW5jdGlvbih0KXtyZXR1cm4gdGhpcy5wV29ybGQuc2V0KHRoaXMub3JpZW50YXRpb24ucm90YXRlVmVjdG9yKHQpKX0sZS5wcm90b3R5cGUuZ2V0RW5lcmd5PWZ1bmN0aW9uKCl7cmV0dXJuIG4ucHJvdG90eXBlLmdldEVuZXJneS5jYWxsKHRoaXMpKy41KnRoaXMuaW5lcnRpYS52ZWN0b3JNdWx0aXBseSh0aGlzLmFuZ3VsYXJWZWxvY2l0eSkuZG90KHRoaXMuYW5ndWxhclZlbG9jaXR5KX0sZS5wcm90b3R5cGUucmVzZXQ9ZnVuY3Rpb24odCxpLGUsbyl7bi5wcm90b3R5cGUucmVzZXQuY2FsbCh0aGlzLHQsaSksdGhpcy5hbmd1bGFyVmVsb2NpdHkuY2xlYXIoKSx0aGlzLnNldE9yaWVudGF0aW9uKGV8fFsxLDAsMCwwXSksdGhpcy5zZXRBbmd1bGFyTW9tZW50dW0ob3x8WzAsMCwwXSl9LGUucHJvdG90eXBlLnNldE9yaWVudGF0aW9uPWZ1bmN0aW9uKHQpe3RoaXMub3JpZW50YXRpb24uc2V0KHQpfSxlLnByb3RvdHlwZS5zZXRBbmd1bGFyVmVsb2NpdHk9ZnVuY3Rpb24odCl7dGhpcy53YWtlKCksdGhpcy5hbmd1bGFyVmVsb2NpdHkuc2V0KHQpfSxlLnByb3RvdHlwZS5zZXRBbmd1bGFyTW9tZW50dW09ZnVuY3Rpb24odCl7dGhpcy53YWtlKCksdGhpcy5hbmd1bGFyTW9tZW50dW0uc2V0KHQpfSxlLnByb3RvdHlwZS5hcHBseUZvcmNlPWZ1bmN0aW9uKHQsaSl7bi5wcm90b3R5cGUuYXBwbHlGb3JjZS5jYWxsKHRoaXMsdCksdm9pZCAwIT09aSYmdGhpcy5hcHBseVRvcnF1ZShpLmNyb3NzKHQpKX0sZS5wcm90b3R5cGUuYXBwbHlUb3JxdWU9ZnVuY3Rpb24odCl7dGhpcy53YWtlKCksdGhpcy50b3JxdWUuc2V0KHRoaXMudG9ycXVlLmFkZCh0KSl9LGUucHJvdG90eXBlLmdldFRyYW5zZm9ybT1mdW5jdGlvbigpe3JldHVybiBvLnRoZW5Nb3ZlKHRoaXMub3JpZW50YXRpb24uZ2V0VHJhbnNmb3JtKCksby5nZXRUcmFuc2xhdGUobi5wcm90b3R5cGUuZ2V0VHJhbnNmb3JtLmNhbGwodGhpcykpKX0sZS5wcm90b3R5cGUuX2ludGVncmF0ZT1mdW5jdGlvbih0KXtuLnByb3RvdHlwZS5faW50ZWdyYXRlLmNhbGwodGhpcyx0KSx0aGlzLmludGVncmF0ZUFuZ3VsYXJNb21lbnR1bSh0KSx0aGlzLnVwZGF0ZUFuZ3VsYXJWZWxvY2l0eSh0KSx0aGlzLmludGVncmF0ZU9yaWVudGF0aW9uKHQpfSxlLnByb3RvdHlwZS5pbnRlZ3JhdGVBbmd1bGFyTW9tZW50dW09ZnVuY3Rpb24odCl7aC5pbnRlZ3JhdGVBbmd1bGFyTW9tZW50dW0odGhpcyx0KX0sZS5wcm90b3R5cGUuaW50ZWdyYXRlT3JpZW50YXRpb249ZnVuY3Rpb24odCl7aC5pbnRlZ3JhdGVPcmllbnRhdGlvbih0aGlzLHQpfSxpLmV4cG9ydHM9ZX0se1wiLi4vLi4vY29yZS9UcmFuc2Zvcm1cIjoxNSxcIi4uLy4uL21hdGgvTWF0cml4XCI6MzcsXCIuLi8uLi9tYXRoL1F1YXRlcm5pb25cIjozOCxcIi4uLy4uL21hdGgvVmVjdG9yXCI6NDEsXCIuLi9pbnRlZ3JhdG9ycy9TeW1wbGVjdGljRXVsZXJcIjo3MixcIi4vUGFydGljbGVcIjo1MX1dLDUwOltmdW5jdGlvbih0LGkpe2Z1bmN0aW9uIGUodCl7dD10fHx7fSx0aGlzLnNldFJhZGl1cyh0LnJhZGl1c3x8MCksbi5jYWxsKHRoaXMsdCl9dmFyIG49dChcIi4vQm9keVwiKSxvPXQoXCIuLi8uLi9tYXRoL01hdHJpeFwiKTtlLnByb3RvdHlwZT1PYmplY3QuY3JlYXRlKG4ucHJvdG90eXBlKSxlLnByb3RvdHlwZS5jb25zdHJ1Y3Rvcj1lLGUucHJvdG90eXBlLnNldFJhZGl1cz1mdW5jdGlvbih0KXt0aGlzLnJhZGl1cz10LHRoaXMuc2l6ZT1bMip0aGlzLnJhZGl1cywyKnRoaXMucmFkaXVzXSx0aGlzLnNldE1vbWVudHNPZkluZXJ0aWEoKX0sZS5wcm90b3R5cGUuc2V0TW9tZW50c09mSW5lcnRpYT1mdW5jdGlvbigpe3ZhciB0PXRoaXMubWFzcyxpPXRoaXMucmFkaXVzO3RoaXMuaW5lcnRpYT1uZXcgbyhbWy4yNSp0KmkqaSwwLDBdLFswLC4yNSp0KmkqaSwwXSxbMCwwLC41KnQqaSppXV0pLHRoaXMuaW52ZXJzZUluZXJ0aWE9bmV3IG8oW1s0Lyh0KmkqaSksMCwwXSxbMCw0Lyh0KmkqaSksMF0sWzAsMCwyLyh0KmkqaSldXSl9LGkuZXhwb3J0cz1lfSx7XCIuLi8uLi9tYXRoL01hdHJpeFwiOjM3LFwiLi9Cb2R5XCI6NDl9XSw1MTpbZnVuY3Rpb24odCxpKXtmdW5jdGlvbiBlKHQpe3Q9dHx8e307dmFyIGk9ZS5ERUZBVUxUX09QVElPTlM7dGhpcy5wb3NpdGlvbj1uZXcgbyx0aGlzLnZlbG9jaXR5PW5ldyBvLHRoaXMuZm9yY2U9bmV3IG8sdGhpcy5fZW5naW5lPW51bGwsdGhpcy5faXNTbGVlcGluZz0hMCx0aGlzLl9ldmVudE91dHB1dD1udWxsLHRoaXMubWFzcz12b2lkIDAhPT10Lm1hc3M/dC5tYXNzOmkubWFzcyx0aGlzLmludmVyc2VNYXNzPTEvdGhpcy5tYXNzLHRoaXMuc2V0UG9zaXRpb24odC5wb3NpdGlvbnx8aS5wb3NpdGlvbiksdGhpcy5zZXRWZWxvY2l0eSh0LnZlbG9jaXR5fHxpLnZlbG9jaXR5KSx0aGlzLmZvcmNlLnNldCh0LmZvcmNlfHxbMCwwLDBdKSx0aGlzLnRyYW5zZm9ybT1zLmlkZW50aXR5LnNsaWNlKCksdGhpcy5fc3BlYz17c2l6ZTpbITAsITBdLHRhcmdldDp7dHJhbnNmb3JtOnRoaXMudHJhbnNmb3JtLG9yaWdpbjpbLjUsLjVdLHRhcmdldDpudWxsfX19ZnVuY3Rpb24gbigpe3RoaXMuX2V2ZW50T3V0cHV0PW5ldyByLHRoaXMuX2V2ZW50T3V0cHV0LmJpbmRUaGlzKHRoaXMpLHIuc2V0T3V0cHV0SGFuZGxlcih0aGlzLHRoaXMuX2V2ZW50T3V0cHV0KX12YXIgbz10KFwiLi4vLi4vbWF0aC9WZWN0b3JcIikscz10KFwiLi4vLi4vY29yZS9UcmFuc2Zvcm1cIikscj10KFwiLi4vLi4vY29yZS9FdmVudEhhbmRsZXJcIiksYT10KFwiLi4vaW50ZWdyYXRvcnMvU3ltcGxlY3RpY0V1bGVyXCIpO2UuREVGQVVMVF9PUFRJT05TPXtwb3NpdGlvbjpbMCwwLDBdLHZlbG9jaXR5OlswLDAsMF0sbWFzczoxfTt2YXIgaD17c3RhcnQ6XCJzdGFydFwiLHVwZGF0ZTpcInVwZGF0ZVwiLGVuZDpcImVuZFwifSxjPURhdGUubm93O2UucHJvdG90eXBlLmlzQm9keT0hMSxlLnByb3RvdHlwZS5pc0FjdGl2ZT1mdW5jdGlvbigpe3JldHVybiF0aGlzLl9pc1NsZWVwaW5nfSxlLnByb3RvdHlwZS5zbGVlcD1mdW5jdGlvbigpe3RoaXMuX2lzU2xlZXBpbmd8fCh0aGlzLmVtaXQoaC5lbmQsdGhpcyksdGhpcy5faXNTbGVlcGluZz0hMCl9LGUucHJvdG90eXBlLndha2U9ZnVuY3Rpb24oKXt0aGlzLl9pc1NsZWVwaW5nJiYodGhpcy5lbWl0KGguc3RhcnQsdGhpcyksdGhpcy5faXNTbGVlcGluZz0hMSx0aGlzLl9wcmV2VGltZT1jKCksdGhpcy5fZW5naW5lJiZ0aGlzLl9lbmdpbmUud2FrZSgpKX0sZS5wcm90b3R5cGUuc2V0UG9zaXRpb249ZnVuY3Rpb24odCl7dGhpcy5wb3NpdGlvbi5zZXQodCl9LGUucHJvdG90eXBlLnNldFBvc2l0aW9uMUQ9ZnVuY3Rpb24odCl7dGhpcy5wb3NpdGlvbi54PXR9LGUucHJvdG90eXBlLmdldFBvc2l0aW9uPWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuX2VuZ2luZS5zdGVwKCksdGhpcy5wb3NpdGlvbi5nZXQoKX0sZS5wcm90b3R5cGUuZ2V0UG9zaXRpb24xRD1mdW5jdGlvbigpe3JldHVybiB0aGlzLl9lbmdpbmUuc3RlcCgpLHRoaXMucG9zaXRpb24ueH0sZS5wcm90b3R5cGUuc2V0VmVsb2NpdHk9ZnVuY3Rpb24odCl7dGhpcy52ZWxvY2l0eS5zZXQodCksKDAhPT10WzBdfHwwIT09dFsxXXx8MCE9PXRbMl0pJiZ0aGlzLndha2UoKX0sZS5wcm90b3R5cGUuc2V0VmVsb2NpdHkxRD1mdW5jdGlvbih0KXt0aGlzLnZlbG9jaXR5Lng9dCwwIT09dCYmdGhpcy53YWtlKCl9LGUucHJvdG90eXBlLmdldFZlbG9jaXR5PWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMudmVsb2NpdHkuZ2V0KCl9LGUucHJvdG90eXBlLnNldEZvcmNlPWZ1bmN0aW9uKHQpe3RoaXMuZm9yY2Uuc2V0KHQpLHRoaXMud2FrZSgpfSxlLnByb3RvdHlwZS5nZXRWZWxvY2l0eTFEPWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMudmVsb2NpdHkueH0sZS5wcm90b3R5cGUuc2V0TWFzcz1mdW5jdGlvbih0KXt0aGlzLm1hc3M9dCx0aGlzLmludmVyc2VNYXNzPTEvdH0sZS5wcm90b3R5cGUuZ2V0TWFzcz1mdW5jdGlvbigpe3JldHVybiB0aGlzLm1hc3N9LGUucHJvdG90eXBlLnJlc2V0PWZ1bmN0aW9uKHQsaSl7dGhpcy5zZXRQb3NpdGlvbih0fHxbMCwwLDBdKSx0aGlzLnNldFZlbG9jaXR5KGl8fFswLDAsMF0pfSxlLnByb3RvdHlwZS5hcHBseUZvcmNlPWZ1bmN0aW9uKHQpe3QuaXNaZXJvKCl8fCh0aGlzLmZvcmNlLmFkZCh0KS5wdXQodGhpcy5mb3JjZSksdGhpcy53YWtlKCkpfSxlLnByb3RvdHlwZS5hcHBseUltcHVsc2U9ZnVuY3Rpb24odCl7aWYoIXQuaXNaZXJvKCkpe3ZhciBpPXRoaXMudmVsb2NpdHk7aS5hZGQodC5tdWx0KHRoaXMuaW52ZXJzZU1hc3MpKS5wdXQoaSl9fSxlLnByb3RvdHlwZS5pbnRlZ3JhdGVWZWxvY2l0eT1mdW5jdGlvbih0KXthLmludGVncmF0ZVZlbG9jaXR5KHRoaXMsdCl9LGUucHJvdG90eXBlLmludGVncmF0ZVBvc2l0aW9uPWZ1bmN0aW9uKHQpe2EuaW50ZWdyYXRlUG9zaXRpb24odGhpcyx0KX0sZS5wcm90b3R5cGUuX2ludGVncmF0ZT1mdW5jdGlvbih0KXt0aGlzLmludGVncmF0ZVZlbG9jaXR5KHQpLHRoaXMuaW50ZWdyYXRlUG9zaXRpb24odCl9LGUucHJvdG90eXBlLmdldEVuZXJneT1mdW5jdGlvbigpe3JldHVybi41KnRoaXMubWFzcyp0aGlzLnZlbG9jaXR5Lm5vcm1TcXVhcmVkKCl9LGUucHJvdG90eXBlLmdldFRyYW5zZm9ybT1mdW5jdGlvbigpe3RoaXMuX2VuZ2luZS5zdGVwKCk7dmFyIHQ9dGhpcy5wb3NpdGlvbixpPXRoaXMudHJhbnNmb3JtO3JldHVybiBpWzEyXT10LngsaVsxM109dC55LGlbMTRdPXQueixpfSxlLnByb3RvdHlwZS5tb2RpZnk9ZnVuY3Rpb24odCl7dmFyIGk9dGhpcy5fc3BlYy50YXJnZXQ7cmV0dXJuIGkudHJhbnNmb3JtPXRoaXMuZ2V0VHJhbnNmb3JtKCksaS50YXJnZXQ9dCx0aGlzLl9zcGVjfSxlLnByb3RvdHlwZS5lbWl0PWZ1bmN0aW9uKHQsaSl7dGhpcy5fZXZlbnRPdXRwdXQmJnRoaXMuX2V2ZW50T3V0cHV0LmVtaXQodCxpKX0sZS5wcm90b3R5cGUub249ZnVuY3Rpb24oKXtyZXR1cm4gbi5jYWxsKHRoaXMpLHRoaXMub24uYXBwbHkodGhpcyxhcmd1bWVudHMpfSxlLnByb3RvdHlwZS5yZW1vdmVMaXN0ZW5lcj1mdW5jdGlvbigpe3JldHVybiBuLmNhbGwodGhpcyksdGhpcy5yZW1vdmVMaXN0ZW5lci5hcHBseSh0aGlzLGFyZ3VtZW50cyl9LGUucHJvdG90eXBlLnBpcGU9ZnVuY3Rpb24oKXtyZXR1cm4gbi5jYWxsKHRoaXMpLHRoaXMucGlwZS5hcHBseSh0aGlzLGFyZ3VtZW50cyl9LGUucHJvdG90eXBlLnVucGlwZT1mdW5jdGlvbigpe3JldHVybiBuLmNhbGwodGhpcyksdGhpcy51bnBpcGUuYXBwbHkodGhpcyxhcmd1bWVudHMpfSxpLmV4cG9ydHM9ZX0se1wiLi4vLi4vY29yZS9FdmVudEhhbmRsZXJcIjo3LFwiLi4vLi4vY29yZS9UcmFuc2Zvcm1cIjoxNSxcIi4uLy4uL21hdGgvVmVjdG9yXCI6NDEsXCIuLi9pbnRlZ3JhdG9ycy9TeW1wbGVjdGljRXVsZXJcIjo3Mn1dLDUyOltmdW5jdGlvbih0LGkpe2Z1bmN0aW9uIGUodCl7dD10fHx7fSx0aGlzLnNpemU9dC5zaXplfHxbMCwwXSxuLmNhbGwodGhpcyx0KX12YXIgbj10KFwiLi9Cb2R5XCIpLG89dChcIi4uLy4uL21hdGgvTWF0cml4XCIpO2UucHJvdG90eXBlPU9iamVjdC5jcmVhdGUobi5wcm90b3R5cGUpLGUucHJvdG90eXBlLmNvbnN0cnVjdG9yPWUsZS5wcm90b3R5cGUuc2V0U2l6ZT1mdW5jdGlvbih0KXt0aGlzLnNpemU9dCx0aGlzLnNldE1vbWVudHNPZkluZXJ0aWEoKX0sZS5wcm90b3R5cGUuc2V0TW9tZW50c09mSW5lcnRpYT1mdW5jdGlvbigpe3ZhciB0PXRoaXMubWFzcyxpPXRoaXMuc2l6ZVswXSxlPXRoaXMuc2l6ZVsxXTt0aGlzLmluZXJ0aWE9bmV3IG8oW1t0KmUqZS8xMiwwLDBdLFswLHQqaSppLzEyLDBdLFswLDAsdCooaSppK2UqZSkvMTJdXSksdGhpcy5pbnZlcnNlSW5lcnRpYT1uZXcgbyhbWzEyLyh0KmUqZSksMCwwXSxbMCwxMi8odCppKmkpLDBdLFswLDAsMTIvKHQqKGkqaStlKmUpKV1dKX0saS5leHBvcnRzPWV9LHtcIi4uLy4uL21hdGgvTWF0cml4XCI6MzcsXCIuL0JvZHlcIjo0OX1dLDUzOltmdW5jdGlvbih0LGkpe2kuZXhwb3J0cz17Qm9keTp0KFwiLi9Cb2R5XCIpLENpcmNsZTp0KFwiLi9DaXJjbGVcIiksUGFydGljbGU6dChcIi4vUGFydGljbGVcIiksUmVjdGFuZ2xlOnQoXCIuL1JlY3RhbmdsZVwiKX19LHtcIi4vQm9keVwiOjQ5LFwiLi9DaXJjbGVcIjo1MCxcIi4vUGFydGljbGVcIjo1MSxcIi4vUmVjdGFuZ2xlXCI6NTJ9XSw1NDpbZnVuY3Rpb24odCxpKXtmdW5jdGlvbiBlKHQpe3RoaXMub3B0aW9ucz1PYmplY3QuY3JlYXRlKGUuREVGQVVMVF9PUFRJT05TKSx0JiZ0aGlzLnNldE9wdGlvbnModCksdGhpcy5ub3JtYWw9bmV3IG8sdGhpcy5wRGlmZj1uZXcgbyx0aGlzLnZEaWZmPW5ldyBvLHRoaXMuaW1wdWxzZTE9bmV3IG8sdGhpcy5pbXB1bHNlMj1uZXcgbyxuLmNhbGwodGhpcyl9dmFyIG49dChcIi4vQ29uc3RyYWludFwiKSxvPXQoXCIuLi8uLi9tYXRoL1ZlY3RvclwiKTtlLnByb3RvdHlwZT1PYmplY3QuY3JlYXRlKG4ucHJvdG90eXBlKSxlLnByb3RvdHlwZS5jb25zdHJ1Y3Rvcj1lLGUuREVGQVVMVF9PUFRJT05TPXtyZXN0aXR1dGlvbjouNSxkcmlmdDouNSxzbG9wOjB9LGUucHJvdG90eXBlLnNldE9wdGlvbnM9ZnVuY3Rpb24odCl7Zm9yKHZhciBpIGluIHQpdGhpcy5vcHRpb25zW2ldPXRbaV19LGUucHJvdG90eXBlLmFwcGx5Q29uc3RyYWludD1mdW5jdGlvbih0LGksZSl7aWYodm9pZCAwIT09aSlmb3IodmFyIG49aS52ZWxvY2l0eSxvPWkucG9zaXRpb24scz1pLmludmVyc2VNYXNzLHI9aS5yYWRpdXMsYT10aGlzLm9wdGlvbnMsaD1hLmRyaWZ0LGM9LWEuc2xvcCxwPWEucmVzdGl0dXRpb24sdT10aGlzLm5vcm1hbCxsPXRoaXMucERpZmYsZj10aGlzLnZEaWZmLGQ9dGhpcy5pbXB1bHNlMSxfPXRoaXMuaW1wdWxzZTIseT0wO3k8dC5sZW5ndGg7eSsrKXt2YXIgZz10W3ldO2lmKGchPT1pKXt2YXIgdj1nLnZlbG9jaXR5LG09Zy5wb3NpdGlvbixPPWcuaW52ZXJzZU1hc3MsUz1nLnJhZGl1cztsLnNldChtLnN1YihvKSksZi5zZXQodi5zdWIobikpO3ZhciBUPWwubm9ybSgpLHc9VC0ocitTKSxiPTEvKHMrTyksRT0wO2lmKDA+dyl7aWYodS5zZXQobC5ub3JtYWxpemUoKSksdGhpcy5fZXZlbnRPdXRwdXQpe3ZhciBJPXt0YXJnZXQ6Zyxzb3VyY2U6aSxvdmVybGFwOncsbm9ybWFsOnV9O3RoaXMuX2V2ZW50T3V0cHV0LmVtaXQoXCJwcmVDb2xsaXNpb25cIixJKSx0aGlzLl9ldmVudE91dHB1dC5lbWl0KFwiY29sbGlzaW9uXCIsSSl9dmFyIHg9Yz49dz8oKDErcCkqdS5kb3QoZikraC9lKih3LWMpKS8oRStlL2IpOigxK3ApKnUuZG90KGYpLyhFK2UvYik7dS5tdWx0KGUqeCkucHV0KGQpLGQubXVsdCgtMSkucHV0KF8pLGkuYXBwbHlJbXB1bHNlKGQpLGcuYXBwbHlJbXB1bHNlKF8pLHRoaXMuX2V2ZW50T3V0cHV0JiZ0aGlzLl9ldmVudE91dHB1dC5lbWl0KFwicG9zdENvbGxpc2lvblwiLEkpfX19fSxpLmV4cG9ydHM9ZX0se1wiLi4vLi4vbWF0aC9WZWN0b3JcIjo0MSxcIi4vQ29uc3RyYWludFwiOjU1fV0sNTU6W2Z1bmN0aW9uKHQsaSl7ZnVuY3Rpb24gZSgpe3RoaXMub3B0aW9ucz10aGlzLm9wdGlvbnN8fHt9LHRoaXMuX2V2ZW50T3V0cHV0PW5ldyBuLG4uc2V0T3V0cHV0SGFuZGxlcih0aGlzLHRoaXMuX2V2ZW50T3V0cHV0KX12YXIgbj10KFwiLi4vLi4vY29yZS9FdmVudEhhbmRsZXJcIik7ZS5wcm90b3R5cGUuc2V0T3B0aW9ucz1mdW5jdGlvbih0KXt0aGlzLl9ldmVudE91dHB1dC5lbWl0KFwiY2hhbmdlXCIsdCl9LGUucHJvdG90eXBlLmFwcGx5Q29uc3RyYWludD1mdW5jdGlvbigpe30sZS5wcm90b3R5cGUuZ2V0RW5lcmd5PWZ1bmN0aW9uKCl7cmV0dXJuIDB9LGkuZXhwb3J0cz1lfSx7XCIuLi8uLi9jb3JlL0V2ZW50SGFuZGxlclwiOjd9XSw1NjpbZnVuY3Rpb24odCxpKXtmdW5jdGlvbiBlKHQpe3RoaXMub3B0aW9ucz1PYmplY3QuY3JlYXRlKGUuREVGQVVMVF9PUFRJT05TKSx0JiZ0aGlzLnNldE9wdGlvbnModCksdGhpcy5KPW5ldyBvLHRoaXMuaW1wdWxzZT1uZXcgbyxuLmNhbGwodGhpcyl9dmFyIG49dChcIi4vQ29uc3RyYWludFwiKSxvPXQoXCIuLi8uLi9tYXRoL1ZlY3RvclwiKTtlLnByb3RvdHlwZT1PYmplY3QuY3JlYXRlKG4ucHJvdG90eXBlKSxlLnByb3RvdHlwZS5jb25zdHJ1Y3Rvcj1lO3ZhciBzPTFlLTcscj1NYXRoLlBJO2UuREVGQVVMVF9PUFRJT05TPXtlcXVhdGlvbjpmdW5jdGlvbigpe3JldHVybiAwfSxwbGFuZTpmdW5jdGlvbih0LGksZSl7cmV0dXJuIGV9LHBlcmlvZDowLGRhbXBpbmdSYXRpbzowfSxlLnByb3RvdHlwZS5zZXRPcHRpb25zPWZ1bmN0aW9uKHQpe2Zvcih2YXIgaSBpbiB0KXRoaXMub3B0aW9uc1tpXT10W2ldfSxlLnByb3RvdHlwZS5hcHBseUNvbnN0cmFpbnQ9ZnVuY3Rpb24odCxpLGUpe2Zvcih2YXIgbj10aGlzLm9wdGlvbnMsbz10aGlzLmltcHVsc2UsYT10aGlzLkosaD1uLmVxdWF0aW9uLGM9bi5wbGFuZSxwPW4uZGFtcGluZ1JhdGlvLHU9bi5wZXJpb2QsbD0wO2w8dC5sZW5ndGg7bCsrKXt2YXIgZixkLF89dFtsXSx5PV8udmVsb2NpdHksZz1fLnBvc2l0aW9uLHY9Xy5tYXNzO2lmKDA9PT11KWY9MCxkPTE7ZWxzZXt2YXIgbT00KnYqcipwL3UsTz00KnYqcipyLyh1KnUpO2Y9MS8obStlKk8pLGQ9ZSpPLyhtK2UqTyl9dmFyIFM9Zy54LFQ9Zy55LHc9Zy56LGI9aChTLFQsdyksRT0oaChTK3MsZyxnKS1iKS9zLEk9KGgoUyxUK3MsZyktYikvcyx4PShoKFMsVCxnK3MpLWIpL3MsTT1jKFMsVCx3KSx6PShjKFMrcyxULHcpLU0pL3MsQz0oYyhTLFQrcyx3KS1NKS9zLFA9KGMoUyxULHcrcyktTSkvczthLnNldFhZWihFK3osSStDLHgrUCk7dmFyIEY9ZC9lKihiK00pLEQ9LShhLmRvdCh5KStGKS8oZitlKmEubm9ybVNxdWFyZWQoKS92KTtvLnNldChhLm11bHQoZSpEKSksXy5hcHBseUltcHVsc2Uobyl9fSxpLmV4cG9ydHM9ZX0se1wiLi4vLi4vbWF0aC9WZWN0b3JcIjo0MSxcIi4vQ29uc3RyYWludFwiOjU1fV0sNTc6W2Z1bmN0aW9uKHQsaSl7ZnVuY3Rpb24gZSh0KXt0aGlzLm9wdGlvbnM9T2JqZWN0LmNyZWF0ZSh0aGlzLmNvbnN0cnVjdG9yLkRFRkFVTFRfT1BUSU9OUyksdCYmdGhpcy5zZXRPcHRpb25zKHQpLHRoaXMuaW1wdWxzZT1uZXcgbyx0aGlzLm5vcm1hbD1uZXcgbyx0aGlzLmRpZmZQPW5ldyBvLHRoaXMuZGlmZlY9bmV3IG8sbi5jYWxsKHRoaXMpfXZhciBuPXQoXCIuL0NvbnN0cmFpbnRcIiksbz10KFwiLi4vLi4vbWF0aC9WZWN0b3JcIik7ZS5wcm90b3R5cGU9T2JqZWN0LmNyZWF0ZShuLnByb3RvdHlwZSksZS5wcm90b3R5cGUuY29uc3RydWN0b3I9ZSxlLkRFRkFVTFRfT1BUSU9OUz17YW5jaG9yOm51bGwsbGVuZ3RoOjAsbWluTGVuZ3RoOjAscGVyaW9kOjAsZGFtcGluZ1JhdGlvOjB9O3ZhciBzPU1hdGguUEk7ZS5wcm90b3R5cGUuc2V0T3B0aW9ucz1mdW5jdGlvbih0KXt0LmFuY2hvciYmKHQuYW5jaG9yLnBvc2l0aW9uIGluc3RhbmNlb2YgbyYmKHRoaXMub3B0aW9ucy5hbmNob3I9dC5hbmNob3IucG9zaXRpb24pLHQuYW5jaG9yIGluc3RhbmNlb2YgbyYmKHRoaXMub3B0aW9ucy5hbmNob3I9dC5hbmNob3IpLHQuYW5jaG9yIGluc3RhbmNlb2YgQXJyYXkmJih0aGlzLm9wdGlvbnMuYW5jaG9yPW5ldyBvKHQuYW5jaG9yKSkpLHZvaWQgMCE9PXQubGVuZ3RoJiYodGhpcy5vcHRpb25zLmxlbmd0aD10Lmxlbmd0aCksdm9pZCAwIT09dC5kYW1waW5nUmF0aW8mJih0aGlzLm9wdGlvbnMuZGFtcGluZ1JhdGlvPXQuZGFtcGluZ1JhdGlvKSx2b2lkIDAhPT10LnBlcmlvZCYmKHRoaXMub3B0aW9ucy5wZXJpb2Q9dC5wZXJpb2QpLHZvaWQgMCE9PXQubWluTGVuZ3RoJiYodGhpcy5vcHRpb25zLm1pbkxlbmd0aD10Lm1pbkxlbmd0aCl9LGUucHJvdG90eXBlLnNldEFuY2hvcj1mdW5jdGlvbih0KXt0aGlzLm9wdGlvbnMuYW5jaG9yfHwodGhpcy5vcHRpb25zLmFuY2hvcj1uZXcgbyksdGhpcy5vcHRpb25zLmFuY2hvci5zZXQodCl9LGUucHJvdG90eXBlLmFwcGx5Q29uc3RyYWludD1mdW5jdGlvbih0LGksZSl7dmFyIG4sbyxyPXRoaXMubm9ybWFsLGE9dGhpcy5kaWZmUCxoPXRoaXMuZGlmZlYsYz10aGlzLmltcHVsc2UscD10aGlzLm9wdGlvbnMsdT1wLmRhbXBpbmdSYXRpbyxsPXAucGVyaW9kLGY9cC5taW5MZW5ndGg7aWYoaSl7dmFyIGQ9aS52ZWxvY2l0eTtuPWkucG9zaXRpb24sbz1pLmludmVyc2VNYXNzfWVsc2Ugbj10aGlzLm9wdGlvbnMuYW5jaG9yLG89MDtmb3IodmFyIF89dGhpcy5vcHRpb25zLmxlbmd0aCx5PTA7eTx0Lmxlbmd0aDt5Kyspe3ZhciBnPXRbeV0sdj1nLnZlbG9jaXR5LG09Zy5wb3NpdGlvbixPPWcuaW52ZXJzZU1hc3M7YS5zZXQobS5zdWIobikpLHIuc2V0KGEubm9ybWFsaXplKCkpO3ZhciBTPWEubm9ybSgpLV87aWYoTWF0aC5hYnMoUyk8ZilyZXR1cm47aC5zZXQoaT92LnN1YihkKTp2KTt2YXIgVCx3LGI9MS8oTytvKTtpZigwPT09bClUPTAsdz0xO2Vsc2V7dmFyIEU9NCpiKnMqdS9sLEk9NCpiKnMqcy8obCpsKTtUPTEvKEUrZSpJKSx3PWUqSS8oRStlKkkpfXZhciB4PXcvZSpTLE09LShyLmRvdChoKSt4KS8oVCtlL2IpO2Muc2V0KHIubXVsdChlKk0pKSxnLmFwcGx5SW1wdWxzZShjKSxpJiZpLmFwcGx5SW1wdWxzZShjLm11bHQoLTEpKX19LGkuZXhwb3J0cz1lfSx7XCIuLi8uLi9tYXRoL1ZlY3RvclwiOjQxLFwiLi9Db25zdHJhaW50XCI6NTV9XSw1ODpbZnVuY3Rpb24odCxpKXtmdW5jdGlvbiBlKHQpe24uY2FsbCh0aGlzKSx0aGlzLm9wdGlvbnM9T2JqZWN0LmNyZWF0ZSh0aGlzLmNvbnN0cnVjdG9yLkRFRkFVTFRfT1BUSU9OUyksdCYmdGhpcy5zZXRPcHRpb25zKHQpLHRoaXMucERpZmY9bmV3IG8sdGhpcy52RGlmZj1uZXcgbyx0aGlzLmltcHVsc2UxPW5ldyBvLHRoaXMuaW1wdWxzZTI9bmV3IG99dmFyIG49dChcIi4vQ29uc3RyYWludFwiKSxvPXQoXCIuLi8uLi9tYXRoL1ZlY3RvclwiKTtlLnByb3RvdHlwZT1PYmplY3QuY3JlYXRlKG4ucHJvdG90eXBlKSxlLnByb3RvdHlwZS5jb25zdHJ1Y3Rvcj1lLGUuREVGQVVMVF9PUFRJT05TPXtwZXJpb2Q6MzAwLGRhbXBpbmdSYXRpbzouMSxsZW5ndGg6MCxhbmNob3I6dm9pZCAwfTt2YXIgcz1NYXRoLlBJO2UucHJvdG90eXBlLnNldE9wdGlvbnM9ZnVuY3Rpb24odCl7dm9pZCAwIT09dC5hbmNob3ImJih0LmFuY2hvciBpbnN0YW5jZW9mIG8mJih0aGlzLm9wdGlvbnMuYW5jaG9yPXQuYW5jaG9yKSx0LmFuY2hvci5wb3NpdGlvbiBpbnN0YW5jZW9mIG8mJih0aGlzLm9wdGlvbnMuYW5jaG9yPXQuYW5jaG9yLnBvc2l0aW9uKSx0LmFuY2hvciBpbnN0YW5jZW9mIEFycmF5JiYodGhpcy5vcHRpb25zLmFuY2hvcj1uZXcgbyh0LmFuY2hvcikpKSx2b2lkIDAhPT10Lmxlbmd0aCYmKHRoaXMub3B0aW9ucy5sZW5ndGg9dC5sZW5ndGgpLHZvaWQgMCE9PXQuZGFtcGluZ1JhdGlvJiYodGhpcy5vcHRpb25zLmRhbXBpbmdSYXRpbz10LmRhbXBpbmdSYXRpbyksdm9pZCAwIT09dC5wZXJpb2QmJih0aGlzLm9wdGlvbnMucGVyaW9kPXQucGVyaW9kKSxuLnByb3RvdHlwZS5zZXRPcHRpb25zLmNhbGwodGhpcyx0KX0sZS5wcm90b3R5cGUuZ2V0RW5lcmd5PWZ1bmN0aW9uKHQsaSl7Zm9yKHZhciBlPXRoaXMub3B0aW9ucyxuPWUubGVuZ3RoLG89ZS5hbmNob3J8fGkucG9zaXRpb24scj1NYXRoLnBvdygyKnMvZS5wZXJpb2QsMiksYT0wLGg9MDtoPHQubGVuZ3RoO2grKyl7dmFyIGM9dFtoXSxwPW8uc3ViKGMucG9zaXRpb24pLm5vcm0oKS1uO2ErPS41KnIqcCpwfXJldHVybiBhfSxlLnByb3RvdHlwZS5hcHBseUNvbnN0cmFpbnQ9ZnVuY3Rpb24odCxpLGUpe2Zvcih2YXIgbj10aGlzLm9wdGlvbnMsbz10aGlzLnBEaWZmLHI9dGhpcy52RGlmZixhPXRoaXMuaW1wdWxzZTEsaD10aGlzLmltcHVsc2UyLGM9bi5sZW5ndGgscD1uLmFuY2hvcnx8aS5wb3NpdGlvbix1PW4ucGVyaW9kLGw9bi5kYW1waW5nUmF0aW8sZj0wO2Y8dC5sZW5ndGg7ZisrKXt2YXIgZD10W2ZdLF89ZC5wb3NpdGlvbix5PWQudmVsb2NpdHksZz1kLm1hc3Msdj1kLmludmVyc2VNYXNzO1xuby5zZXQoXy5zdWIocCkpO3ZhciBtLE89by5ub3JtKCktYztpZihpKXt2YXIgUz1pLmludmVyc2VNYXNzLFQ9aS52ZWxvY2l0eTtyLnNldCh5LnN1YihUKSksbT0xLyh2K1MpfWVsc2Ugci5zZXQoeSksbT1nO3ZhciB3LGI7aWYoMD09PXRoaXMub3B0aW9ucy5wZXJpb2Qpdz0wLGI9MTtlbHNle3ZhciBFPTQqbSpzKnMvKHUqdSksST00Km0qcypsL3U7Yj1lKkUvKEkrZSpFKSx3PTEvKEkrZSpFKX12YXIgeD1iL2UqTztvLm5vcm1hbGl6ZSgteCkuc3ViKHIpLm11bHQoZS8odytlL20pKS5wdXQoYSksZC5hcHBseUltcHVsc2UoYSksaSYmKGEubXVsdCgtMSkucHV0KGgpLGkuYXBwbHlJbXB1bHNlKGgpKX19LGkuZXhwb3J0cz1lfSx7XCIuLi8uLi9tYXRoL1ZlY3RvclwiOjQxLFwiLi9Db25zdHJhaW50XCI6NTV9XSw1OTpbZnVuY3Rpb24odCxpKXtmdW5jdGlvbiBlKHQpe3RoaXMub3B0aW9ucz1PYmplY3QuY3JlYXRlKGUuREVGQVVMVF9PUFRJT05TKSx0JiZ0aGlzLnNldE9wdGlvbnModCksdGhpcy5KPW5ldyBvLHRoaXMuaW1wdWxzZT1uZXcgbyxuLmNhbGwodGhpcyl9dmFyIG49dChcIi4vQ29uc3RyYWludFwiKSxvPXQoXCIuLi8uLi9tYXRoL1ZlY3RvclwiKTtlLnByb3RvdHlwZT1PYmplY3QuY3JlYXRlKG4ucHJvdG90eXBlKSxlLnByb3RvdHlwZS5jb25zdHJ1Y3Rvcj1lLGUuREVGQVVMVF9PUFRJT05TPXtlcXVhdGlvbjp2b2lkIDAscGVyaW9kOjAsZGFtcGluZ1JhdGlvOjB9O3ZhciBzPTFlLTcscj1NYXRoLlBJO2UucHJvdG90eXBlLnNldE9wdGlvbnM9ZnVuY3Rpb24odCl7Zm9yKHZhciBpIGluIHQpdGhpcy5vcHRpb25zW2ldPXRbaV19LGUucHJvdG90eXBlLmFwcGx5Q29uc3RyYWludD1mdW5jdGlvbih0LGksZSl7Zm9yKHZhciBuPXRoaXMuaW1wdWxzZSxvPXRoaXMuSixhPXRoaXMub3B0aW9ucyxoPWEuZXF1YXRpb24sYz1hLmRhbXBpbmdSYXRpbyxwPWEucGVyaW9kLHU9MDt1PHQubGVuZ3RoO3UrKyl7dmFyIGwsZixkPXRbdV0sXz1kLnZlbG9jaXR5LHk9ZC5wb3NpdGlvbixnPWQubWFzcztpZigwPT09cClsPTAsZj0xO2Vsc2V7dmFyIHY9NCpnKnIqYy9wLG09NCpnKnIqci8ocCpwKTtsPTEvKHYrZSptKSxmPWUqbS8oditlKm0pfXZhciBPPXkueCxTPXkueSxUPXkueix3PWgoTyxTLFQpLGI9KGgoTytzLHkseSktdykvcyxFPShoKE8sUytzLHkpLXcpL3MsST0oaChPLFMseStzKS13KS9zO28uc2V0WFlaKGIsRSxJKTt2YXIgeD1mL2UqdyxNPS0oby5kb3QoXykreCkvKGwrZSpvLm5vcm1TcXVhcmVkKCkvZyk7bi5zZXQoby5tdWx0KGUqTSkpLGQuYXBwbHlJbXB1bHNlKG4pfX0saS5leHBvcnRzPWV9LHtcIi4uLy4uL21hdGgvVmVjdG9yXCI6NDEsXCIuL0NvbnN0cmFpbnRcIjo1NX1dLDYwOltmdW5jdGlvbih0LGkpe2Z1bmN0aW9uIGUodCl7dGhpcy5vcHRpb25zPU9iamVjdC5jcmVhdGUoZS5ERUZBVUxUX09QVElPTlMpLHQmJnRoaXMuc2V0T3B0aW9ucyh0KSx0aGlzLmRpZmY9bmV3IGgsdGhpcy5pbXB1bHNlPW5ldyBoLGEuY2FsbCh0aGlzKX1mdW5jdGlvbiBuKHQsaSl7cmV0dXJuIGkuZG90KHQpfWZ1bmN0aW9uIG8odCl7dmFyIGk9dGhpcy5vcHRpb25zLm5vcm1hbCxlPXRoaXMub3B0aW9ucy5kaXN0YW5jZTtyZXR1cm4gdC5kb3QoaSkrZX1mdW5jdGlvbiBzKHQsaSxuKXt2YXIgbz10LnBvc2l0aW9uLHM9dC52ZWxvY2l0eSxyPXQubWFzcyxhPXRoaXMub3B0aW9ucy5ub3JtYWwsaD10aGlzLm9wdGlvbnMub25Db250YWN0LGM9dGhpcy5vcHRpb25zLnJlc3RpdHV0aW9uLHA9dGhpcy5pbXB1bHNlLHU9dGhpcy5vcHRpb25zLmRyaWZ0LGw9LXRoaXMub3B0aW9ucy5zbG9wLGY9MDtpZih0aGlzLl9ldmVudE91dHB1dCl7dmFyIGQ9e3BhcnRpY2xlOnQsd2FsbDp0aGlzLG92ZXJsYXA6aSxub3JtYWw6YX07dGhpcy5fZXZlbnRPdXRwdXQuZW1pdChcInByZUNvbGxpc2lvblwiLGQpLHRoaXMuX2V2ZW50T3V0cHV0LmVtaXQoXCJjb2xsaXNpb25cIixkKX1zd2l0Y2goaCl7Y2FzZSBlLk9OX0NPTlRBQ1QuUkVGTEVDVDp2YXIgXz1sPmk/LSgoMStjKSphLmRvdChzKSt1L24qKGktbCkpLyhyKm4rZik6LSgoMStjKSphLmRvdChzKSkvKHIqbitmKTtwLnNldChhLm11bHQobipfKSksdC5hcHBseUltcHVsc2UocCksdC5zZXRQb3NpdGlvbihvLmFkZChhLm11bHQoLWkpKSl9dGhpcy5fZXZlbnRPdXRwdXQmJnRoaXMuX2V2ZW50T3V0cHV0LmVtaXQoXCJwb3N0Q29sbGlzaW9uXCIsZCl9ZnVuY3Rpb24gcih0LGkpe3ZhciBuPXRoaXMub3B0aW9ucy5vbkNvbnRhY3Qsbz10LnBvc2l0aW9uLHM9dGhpcy5vcHRpb25zLm5vcm1hbDtuPT09ZS5PTl9DT05UQUNULlJFRkxFQ1QmJnQuc2V0UG9zaXRpb24oby5hZGQocy5tdWx0KC1pKSkpfXZhciBhPXQoXCIuL0NvbnN0cmFpbnRcIiksaD10KFwiLi4vLi4vbWF0aC9WZWN0b3JcIik7ZS5wcm90b3R5cGU9T2JqZWN0LmNyZWF0ZShhLnByb3RvdHlwZSksZS5wcm90b3R5cGUuY29uc3RydWN0b3I9ZSxlLk9OX0NPTlRBQ1Q9e1JFRkxFQ1Q6MCxTSUxFTlQ6MX0sZS5ERUZBVUxUX09QVElPTlM9e3Jlc3RpdHV0aW9uOi41LGRyaWZ0Oi41LHNsb3A6MCxub3JtYWw6WzEsMCwwXSxkaXN0YW5jZTowLG9uQ29udGFjdDplLk9OX0NPTlRBQ1QuUkVGTEVDVH0sZS5wcm90b3R5cGUuc2V0T3B0aW9ucz1mdW5jdGlvbih0KXt2b2lkIDAhPT10Lm5vcm1hbCYmKHQubm9ybWFsIGluc3RhbmNlb2YgaCYmKHRoaXMub3B0aW9ucy5ub3JtYWw9dC5ub3JtYWwuY2xvbmUoKSksdC5ub3JtYWwgaW5zdGFuY2VvZiBBcnJheSYmKHRoaXMub3B0aW9ucy5ub3JtYWw9bmV3IGgodC5ub3JtYWwpKSksdm9pZCAwIT09dC5yZXN0aXR1dGlvbiYmKHRoaXMub3B0aW9ucy5yZXN0aXR1dGlvbj10LnJlc3RpdHV0aW9uKSx2b2lkIDAhPT10LmRyaWZ0JiYodGhpcy5vcHRpb25zLmRyaWZ0PXQuZHJpZnQpLHZvaWQgMCE9PXQuc2xvcCYmKHRoaXMub3B0aW9ucy5zbG9wPXQuc2xvcCksdm9pZCAwIT09dC5kaXN0YW5jZSYmKHRoaXMub3B0aW9ucy5kaXN0YW5jZT10LmRpc3RhbmNlKSx2b2lkIDAhPT10Lm9uQ29udGFjdCYmKHRoaXMub3B0aW9ucy5vbkNvbnRhY3Q9dC5vbkNvbnRhY3QpfSxlLnByb3RvdHlwZS5hcHBseUNvbnN0cmFpbnQ9ZnVuY3Rpb24odCxpLGUpe2Zvcih2YXIgYT10aGlzLm9wdGlvbnMubm9ybWFsLGg9MDtoPHQubGVuZ3RoO2grKyl7dmFyIGM9dFtoXSxwPWMucG9zaXRpb24sdT1jLnZlbG9jaXR5LGw9Yy5yYWRpdXN8fDAsZj1vLmNhbGwodGhpcyxwLmFkZChhLm11bHQoLWwpKSksZD1uLmNhbGwodGhpcyxhLHUpOzA+PWYmJigwPmQ/cy5jYWxsKHRoaXMsYyxmLGUpOnIuY2FsbCh0aGlzLGMsZixlKSl9fSxpLmV4cG9ydHM9ZX0se1wiLi4vLi4vbWF0aC9WZWN0b3JcIjo0MSxcIi4vQ29uc3RyYWludFwiOjU1fV0sNjE6W2Z1bmN0aW9uKHQsaSl7ZnVuY3Rpb24gZSh0KXt0aGlzLm9wdGlvbnM9T2JqZWN0LmNyZWF0ZShlLkRFRkFVTFRfT1BUSU9OUyksdCYmdGhpcy5zZXRPcHRpb25zKHQpLG8uY2FsbCh0aGlzLHQuc2lkZXN8fHRoaXMub3B0aW9ucy5zaWRlcyksci5jYWxsKHRoaXMpfWZ1bmN0aW9uIG4odCxpLG4pe3ZhciBvLHM9ZS5TSURFUztzd2l0Y2gocGFyc2VJbnQodCkpe2Nhc2Ugcy5MRUZUOm89aVswXSpuWzBdO2JyZWFrO2Nhc2Ugcy5UT1A6bz1pWzFdKm5bMV07YnJlYWs7Y2FzZSBzLkZST05UOm89aVsyXSpuWzJdO2JyZWFrO2Nhc2Ugcy5SSUdIVDpvPWlbMF0qKDEtblswXSk7YnJlYWs7Y2FzZSBzLkJPVFRPTTpvPWlbMV0qKDEtblsxXSk7YnJlYWs7Y2FzZSBzLkJBQ0s6bz1pWzJdKigxLW5bMl0pfXJldHVybiBvfWZ1bmN0aW9uIG8odCl7dGhpcy5jb21wb25lbnRzPXt9O2Zvcih2YXIgaT10aGlzLmNvbXBvbmVudHMsZT0wO2U8dC5sZW5ndGg7ZSsrKXt2YXIgbz10W2VdO2lbZV09bmV3IGEoe25vcm1hbDpjW29dLmNsb25lKCksZGlzdGFuY2U6bihvLHRoaXMub3B0aW9ucy5zaXplLHRoaXMub3B0aW9ucy5vcmlnaW4pfSl9fWZ1bmN0aW9uIHModCl7dGhpcy5mb3JFYWNoKGZ1bmN0aW9uKGkpe2kuc2V0T3B0aW9ucyh0KX0pO2Zvcih2YXIgaSBpbiB0KXRoaXMub3B0aW9uc1tpXT10W2ldfXZhciByPXQoXCIuL0NvbnN0cmFpbnRcIiksYT10KFwiLi9XYWxsXCIpLGg9dChcIi4uLy4uL21hdGgvVmVjdG9yXCIpO2UucHJvdG90eXBlPU9iamVjdC5jcmVhdGUoci5wcm90b3R5cGUpLGUucHJvdG90eXBlLmNvbnN0cnVjdG9yPWUsZS5PTl9DT05UQUNUPWEuT05fQ09OVEFDVCxlLlNJREVTPXtMRUZUOjAsUklHSFQ6MSxUT1A6MixCT1RUT006MyxGUk9OVDo0LEJBQ0s6NSxUV09fRElNRU5TSU9OQUw6WzAsMSwyLDNdLFRIUkVFX0RJTUVOU0lPTkFMOlswLDEsMiwzLDQsNV19LGUuREVGQVVMVF9PUFRJT05TPXtzaWRlczplLlNJREVTLlRXT19ESU1FTlNJT05BTCxzaXplOlt3aW5kb3cuaW5uZXJXaWR0aCx3aW5kb3cuaW5uZXJIZWlnaHQsMF0sb3JpZ2luOlsuNSwuNSwuNV0sZHJpZnQ6LjUsc2xvcDowLHJlc3RpdHV0aW9uOi41LG9uQ29udGFjdDplLk9OX0NPTlRBQ1QuUkVGTEVDVH07dmFyIGM9ezA6bmV3IGgoMSwwLDApLDE6bmV3IGgoLTEsMCwwKSwyOm5ldyBoKDAsMSwwKSwzOm5ldyBoKDAsLTEsMCksNDpuZXcgaCgwLDAsMSksNTpuZXcgaCgwLDAsLTEpfTtlLnByb3RvdHlwZS5zZXRPcHRpb25zPWZ1bmN0aW9uKHQpe3ZhciBpPSExO3ZvaWQgMCE9PXQucmVzdGl0dXRpb24mJnMuY2FsbCh0aGlzLHtyZXN0aXR1dGlvbjp0LnJlc3RpdHV0aW9ufSksdm9pZCAwIT09dC5kcmlmdCYmcy5jYWxsKHRoaXMse2RyaWZ0OnQuZHJpZnR9KSx2b2lkIDAhPT10LnNsb3AmJnMuY2FsbCh0aGlzLHtzbG9wOnQuc2xvcH0pLHZvaWQgMCE9PXQub25Db250YWN0JiZzLmNhbGwodGhpcyx7b25Db250YWN0OnQub25Db250YWN0fSksdm9pZCAwIT09dC5zaXplJiYoaT0hMCksdm9pZCAwIT09dC5zaWRlcyYmKHRoaXMub3B0aW9ucy5zaWRlcz10LnNpZGVzKSx2b2lkIDAhPT10Lm9yaWdpbiYmKGk9ITApLGkmJnRoaXMuc2V0U2l6ZSh0LnNpemUsdC5vcmlnaW4pfSxlLnByb3RvdHlwZS5zZXRTaXplPWZ1bmN0aW9uKHQsaSl7aT1pfHx0aGlzLm9wdGlvbnMub3JpZ2luLGkubGVuZ3RoPDMmJihpWzJdPS41KSx0aGlzLmZvckVhY2goZnVuY3Rpb24oZSxvKXt2YXIgcz1uKG8sdCxpKTtlLnNldE9wdGlvbnMoe2Rpc3RhbmNlOnN9KX0pLHRoaXMub3B0aW9ucy5zaXplPXQsdGhpcy5vcHRpb25zLm9yaWdpbj1pfSxlLnByb3RvdHlwZS5hcHBseUNvbnN0cmFpbnQ9ZnVuY3Rpb24odCxpLGUpe3RoaXMuZm9yRWFjaChmdW5jdGlvbihuKXtuLmFwcGx5Q29uc3RyYWludCh0LGksZSl9KX0sZS5wcm90b3R5cGUuZm9yRWFjaD1mdW5jdGlvbih0KXt2YXIgaT10aGlzLm9wdGlvbnMuc2lkZXM7Zm9yKHZhciBlIGluIHRoaXMuc2lkZXMpdChpW2VdLGUpfSxlLnByb3RvdHlwZS5yb3RhdGVaPWZ1bmN0aW9uKHQpe3RoaXMuZm9yRWFjaChmdW5jdGlvbihpKXt2YXIgZT1pLm9wdGlvbnMubm9ybWFsO2Uucm90YXRlWih0KS5wdXQoZSl9KX0sZS5wcm90b3R5cGUucm90YXRlWD1mdW5jdGlvbih0KXt0aGlzLmZvckVhY2goZnVuY3Rpb24oaSl7dmFyIGU9aS5vcHRpb25zLm5vcm1hbDtlLnJvdGF0ZVgodCkucHV0KGUpfSl9LGUucHJvdG90eXBlLnJvdGF0ZVk9ZnVuY3Rpb24odCl7dGhpcy5mb3JFYWNoKGZ1bmN0aW9uKGkpe3ZhciBlPWkub3B0aW9ucy5ub3JtYWw7ZS5yb3RhdGVZKHQpLnB1dChlKX0pfSxpLmV4cG9ydHM9ZX0se1wiLi4vLi4vbWF0aC9WZWN0b3JcIjo0MSxcIi4vQ29uc3RyYWludFwiOjU1LFwiLi9XYWxsXCI6NjB9XSw2MjpbZnVuY3Rpb24odCxpKXtpLmV4cG9ydHM9e0NvbGxpc2lvbjp0KFwiLi9Db2xsaXNpb25cIiksQ29uc3RyYWludDp0KFwiLi9Db25zdHJhaW50XCIpLEN1cnZlOnQoXCIuL0N1cnZlXCIpLERpc3RhbmNlOnQoXCIuL0Rpc3RhbmNlXCIpLFNuYXA6dChcIi4vU25hcFwiKSxTdXJmYWNlOnQoXCIuL1N1cmZhY2VcIiksV2FsbDp0KFwiLi9XYWxsXCIpLFdhbGxzOnQoXCIuL1dhbGxzXCIpfX0se1wiLi9Db2xsaXNpb25cIjo1NCxcIi4vQ29uc3RyYWludFwiOjU1LFwiLi9DdXJ2ZVwiOjU2LFwiLi9EaXN0YW5jZVwiOjU3LFwiLi9TbmFwXCI6NTgsXCIuL1N1cmZhY2VcIjo1OSxcIi4vV2FsbFwiOjYwLFwiLi9XYWxsc1wiOjYxfV0sNjM6W2Z1bmN0aW9uKHQsaSl7ZnVuY3Rpb24gZSh0KXt0aGlzLm9wdGlvbnM9T2JqZWN0LmNyZWF0ZSh0aGlzLmNvbnN0cnVjdG9yLkRFRkFVTFRfT1BUSU9OUyksdCYmdGhpcy5zZXRPcHRpb25zKHQpLG4uY2FsbCh0aGlzKX12YXIgbj10KFwiLi9Gb3JjZVwiKTtlLnByb3RvdHlwZT1PYmplY3QuY3JlYXRlKG4ucHJvdG90eXBlKSxlLnByb3RvdHlwZS5jb25zdHJ1Y3Rvcj1lLGUuRk9SQ0VfRlVOQ1RJT05TPXtMSU5FQVI6ZnVuY3Rpb24odCl7cmV0dXJuIHR9LFFVQURSQVRJQzpmdW5jdGlvbih0KXtyZXR1cm4gdC5tdWx0KHQubm9ybSgpKX19LGUuREVGQVVMVF9PUFRJT05TPXtzdHJlbmd0aDouMDEsZm9yY2VGdW5jdGlvbjplLkZPUkNFX0ZVTkNUSU9OUy5MSU5FQVJ9LGUucHJvdG90eXBlLmFwcGx5Rm9yY2U9ZnVuY3Rpb24odCl7dmFyIGksZSxuPXRoaXMub3B0aW9ucy5zdHJlbmd0aCxvPXRoaXMub3B0aW9ucy5mb3JjZUZ1bmN0aW9uLHM9dGhpcy5mb3JjZTtmb3IoaT0wO2k8dC5sZW5ndGg7aSsrKWU9dFtpXSxvKGUudmVsb2NpdHkpLm11bHQoLW4pLnB1dChzKSxlLmFwcGx5Rm9yY2Uocyl9LGUucHJvdG90eXBlLnNldE9wdGlvbnM9ZnVuY3Rpb24odCl7Zm9yKHZhciBpIGluIHQpdGhpcy5vcHRpb25zW2ldPXRbaV19LGkuZXhwb3J0cz1lfSx7XCIuL0ZvcmNlXCI6NjR9XSw2NDpbZnVuY3Rpb24odCxpKXtmdW5jdGlvbiBlKHQpe3RoaXMuZm9yY2U9bmV3IG4odCksdGhpcy5fZXZlbnRPdXRwdXQ9bmV3IG8sby5zZXRPdXRwdXRIYW5kbGVyKHRoaXMsdGhpcy5fZXZlbnRPdXRwdXQpfXZhciBuPXQoXCIuLi8uLi9tYXRoL1ZlY3RvclwiKSxvPXQoXCIuLi8uLi9jb3JlL0V2ZW50SGFuZGxlclwiKTtlLnByb3RvdHlwZS5zZXRPcHRpb25zPWZ1bmN0aW9uKHQpe3RoaXMuX2V2ZW50T3V0cHV0LmVtaXQoXCJjaGFuZ2VcIix0KX0sZS5wcm90b3R5cGUuYXBwbHlGb3JjZT1mdW5jdGlvbih0KXtmb3IodmFyIGk9dC5sZW5ndGg7aS0tOyl0W2ldLmFwcGx5Rm9yY2UodGhpcy5mb3JjZSl9LGUucHJvdG90eXBlLmdldEVuZXJneT1mdW5jdGlvbigpe3JldHVybiAwfSxpLmV4cG9ydHM9ZX0se1wiLi4vLi4vY29yZS9FdmVudEhhbmRsZXJcIjo3LFwiLi4vLi4vbWF0aC9WZWN0b3JcIjo0MX1dLDY1OltmdW5jdGlvbih0LGkpe2Z1bmN0aW9uIGUodCl7dGhpcy5vcHRpb25zPU9iamVjdC5jcmVhdGUoZS5ERUZBVUxUX09QVElPTlMpLHQmJnRoaXMuc2V0T3B0aW9ucyh0KSx0aGlzLmRpc3A9bmV3IG8sbi5jYWxsKHRoaXMpfXZhciBuPXQoXCIuL0ZvcmNlXCIpLG89dChcIi4uLy4uL21hdGgvVmVjdG9yXCIpO2UucHJvdG90eXBlPU9iamVjdC5jcmVhdGUobi5wcm90b3R5cGUpLGUucHJvdG90eXBlLmNvbnN0cnVjdG9yPWUsZS5ERUNBWV9GVU5DVElPTlM9e0xJTkVBUjpmdW5jdGlvbih0LGkpe3JldHVybiBNYXRoLm1heCgxLTEvaSp0LDApfSxNT1JTRTpmdW5jdGlvbih0LGkpe3ZhciBlPTA9PT1pPzEwMDppLG49dCtlKigxLU1hdGgubG9nKDIpKTtyZXR1cm4gTWF0aC5tYXgoMS1NYXRoLnBvdygxLU1hdGguZXhwKG4vZS0xKSwyKSwwKX0sSU5WRVJTRTpmdW5jdGlvbih0LGkpe3JldHVybiAxLygxLWkrdCl9LEdSQVZJVFk6ZnVuY3Rpb24odCxpKXtyZXR1cm4gMS8oMS1pK3QqdCl9fSxlLkRFRkFVTFRfT1BUSU9OUz17c3RyZW5ndGg6MSxhbmNob3I6dm9pZCAwLHJhbmdlOlswLDEvMF0sY3V0b2ZmOjAsY2FwOjEvMCxkZWNheUZ1bmN0aW9uOmUuREVDQVlfRlVOQ1RJT05TLkdSQVZJVFl9LGUucHJvdG90eXBlLnNldE9wdGlvbnM9ZnVuY3Rpb24odCl7dm9pZCAwIT09dC5hbmNob3ImJih0LmFuY2hvci5wb3NpdGlvbiBpbnN0YW5jZW9mIG8mJih0aGlzLm9wdGlvbnMuYW5jaG9yPXQuYW5jaG9yLnBvc2l0aW9uKSx0LmFuY2hvciBpbnN0YW5jZW9mIEFycmF5JiYodGhpcy5vcHRpb25zLmFuY2hvcj1uZXcgbyh0LmFuY2hvcikpLGRlbGV0ZSB0LmFuY2hvcik7Zm9yKHZhciBpIGluIHQpdGhpcy5vcHRpb25zW2ldPXRbaV19LGUucHJvdG90eXBlLmFwcGx5Rm9yY2U9ZnVuY3Rpb24odCxpKXt2YXIgZT10aGlzLm9wdGlvbnMsbj10aGlzLmZvcmNlLG89dGhpcy5kaXNwLHM9ZS5zdHJlbmd0aCxyPWUuYW5jaG9yfHxpLnBvc2l0aW9uLGE9ZS5jYXAsaD1lLmN1dG9mZixjPWUucmFuZ2VbMF0scD1lLnJhbmdlWzFdLHU9ZS5kZWNheUZ1bmN0aW9uO2lmKDAhPT1zKWZvcih2YXIgbCxmLGQsXyx5PXQubGVuZ3RoO3ktLTspbD10W3ldLGwhPT1pJiYoZj1sLm1hc3MsZD1sLnBvc2l0aW9uLG8uc2V0KGQuc3ViKHIpKSxfPW8ubm9ybSgpLHA+XyYmXz5jJiYobi5zZXQoby5ub3JtYWxpemUocypmKnUoXyxoKSkuY2FwKGEpKSxsLmFwcGx5Rm9yY2UobikpKX0saS5leHBvcnRzPWV9LHtcIi4uLy4uL21hdGgvVmVjdG9yXCI6NDEsXCIuL0ZvcmNlXCI6NjR9XSw2NjpbZnVuY3Rpb24odCxpKXtmdW5jdGlvbiBlKHQpe24uY2FsbCh0aGlzLHQpfXZhciBuPXQoXCIuL0RyYWdcIik7ZS5wcm90b3R5cGU9T2JqZWN0LmNyZWF0ZShuLnByb3RvdHlwZSksZS5wcm90b3R5cGUuY29uc3RydWN0b3I9ZSxlLkRFRkFVTFRfT1BUSU9OUz1uLkRFRkFVTFRfT1BUSU9OUyxlLkZPUkNFX0ZVTkNUSU9OUz1uLkZPUkNFX0ZVTkNUSU9OUyxlLkZPUkNFX0ZVTkNUSU9OUz17TElORUFSOmZ1bmN0aW9uKHQpe3JldHVybiB0fSxRVUFEUkFUSUM6ZnVuY3Rpb24odCl7cmV0dXJuIHQubXVsdCh0Lm5vcm0oKSl9fSxlLnByb3RvdHlwZS5hcHBseUZvcmNlPWZ1bmN0aW9uKHQpe3ZhciBpLGUsbj10aGlzLm9wdGlvbnMuc3RyZW5ndGgsbz10aGlzLm9wdGlvbnMuZm9yY2VGdW5jdGlvbixzPXRoaXMuZm9yY2U7Zm9yKGk9MDtpPHQubGVuZ3RoO2krKyllPXRbaV0sbyhlLmFuZ3VsYXJWZWxvY2l0eSkubXVsdCgtMTAwKm4pLnB1dChzKSxlLmFwcGx5VG9ycXVlKHMpfSxlLnByb3RvdHlwZS5zZXRPcHRpb25zPWZ1bmN0aW9uKHQpe2Zvcih2YXIgaSBpbiB0KXRoaXMub3B0aW9uc1tpXT10W2ldfSxpLmV4cG9ydHM9ZX0se1wiLi9EcmFnXCI6NjN9XSw2NzpbZnVuY3Rpb24odCxpKXtmdW5jdGlvbiBlKHQpe2EuY2FsbCh0aGlzLHQpfWZ1bmN0aW9uIG4oKXt2YXIgdD10aGlzLm9wdGlvbnM7dC5zdGlmZm5lc3M9TWF0aC5wb3coMipjL3QucGVyaW9kLDIpfWZ1bmN0aW9uIG8oKXt2YXIgdD10aGlzLm9wdGlvbnM7dC5kYW1waW5nPTQqYyp0LmRhbXBpbmdSYXRpby90LnBlcmlvZH1mdW5jdGlvbiBzKCl7bi5jYWxsKHRoaXMpLG8uY2FsbCh0aGlzKX12YXIgcj10KFwiLi9Gb3JjZVwiKSxhPXQoXCIuL1NwcmluZ1wiKSxoPXQoXCIuLi8uLi9tYXRoL1F1YXRlcm5pb25cIik7ZS5wcm90b3R5cGU9T2JqZWN0LmNyZWF0ZShhLnByb3RvdHlwZSksZS5wcm90b3R5cGUuY29uc3RydWN0b3I9ZSxlLkRFRkFVTFRfT1BUSU9OUz1hLkRFRkFVTFRfT1BUSU9OUyxlLkZPUkNFX0ZVTkNUSU9OUz1hLkZPUkNFX0ZVTkNUSU9OUzt2YXIgYz1NYXRoLlBJO2UucHJvdG90eXBlLnNldE9wdGlvbnM9ZnVuY3Rpb24odCl7dm9pZCAwIT09dC5hbmNob3ImJih0LmFuY2hvciBpbnN0YW5jZW9mIGgmJih0aGlzLm9wdGlvbnMuYW5jaG9yPXQuYW5jaG9yKSx0LmFuY2hvciBpbnN0YW5jZW9mIEFycmF5JiYodGhpcy5vcHRpb25zLmFuY2hvcj1uZXcgaCh0LmFuY2hvcikpKSx2b2lkIDAhPT10LnBlcmlvZCYmKHRoaXMub3B0aW9ucy5wZXJpb2Q9dC5wZXJpb2QpLHZvaWQgMCE9PXQuZGFtcGluZ1JhdGlvJiYodGhpcy5vcHRpb25zLmRhbXBpbmdSYXRpbz10LmRhbXBpbmdSYXRpbyksdm9pZCAwIT09dC5sZW5ndGgmJih0aGlzLm9wdGlvbnMubGVuZ3RoPXQubGVuZ3RoKSx2b2lkIDAhPT10LmZvcmNlRnVuY3Rpb24mJih0aGlzLm9wdGlvbnMuZm9yY2VGdW5jdGlvbj10LmZvcmNlRnVuY3Rpb24pLHZvaWQgMCE9PXQubWF4TGVuZ3RoJiYodGhpcy5vcHRpb25zLm1heExlbmd0aD10Lm1heExlbmd0aCkscy5jYWxsKHRoaXMpLHIucHJvdG90eXBlLnNldE9wdGlvbnMuY2FsbCh0aGlzLHQpfSxlLnByb3RvdHlwZS5hcHBseUZvcmNlPWZ1bmN0aW9uKHQpe3ZhciBpLGUsbixvLHM9dGhpcy5mb3JjZSxyPXRoaXMub3B0aW9ucyxhPXRoaXMuZGlzcCxoPXIuc3RpZmZuZXNzLGM9ci5kYW1waW5nLHA9ci5sZW5ndGgsdT1yLmFuY2hvcixsPXIuZm9yY2VGdW5jdGlvbixmPXIubWF4TGVuZ3RoO2ZvcihpPTA7aTx0Lmxlbmd0aDtpKyspe2lmKGU9dFtpXSxhLnNldCh1LnN1YihlLm9yaWVudGF0aW9uKSksbj1hLm5vcm0oKS1wLDA9PT1uKXJldHVybjtvPWUubWFzcyxoKj1vLGMqPW8scy5zZXQoYS5ub3JtYWxpemUoaCpsKG4sZikpKSxjJiZzLmFkZChlLmFuZ3VsYXJWZWxvY2l0eS5tdWx0KC1jKSkucHV0KHMpLGUuYXBwbHlUb3JxdWUocyl9fSxlLnByb3RvdHlwZS5nZXRFbmVyZ3k9ZnVuY3Rpb24odCl7Zm9yKHZhciBpPXRoaXMub3B0aW9ucyxlPWkubGVuZ3RoLG49aS5hbmNob3Isbz1pLnN0aWZmbmVzcyxzPTAscj0wO3I8dC5sZW5ndGg7cisrKXt2YXIgYT10W3JdLGg9bi5zdWIoYS5vcmllbnRhdGlvbikubm9ybSgpLWU7cys9LjUqbypoKmh9cmV0dXJuIHN9LGkuZXhwb3J0cz1lfSx7XCIuLi8uLi9tYXRoL1F1YXRlcm5pb25cIjozOCxcIi4vRm9yY2VcIjo2NCxcIi4vU3ByaW5nXCI6Njh9XSw2ODpbZnVuY3Rpb24odCxpKXtmdW5jdGlvbiBlKHQpe3IuY2FsbCh0aGlzKSx0aGlzLm9wdGlvbnM9T2JqZWN0LmNyZWF0ZSh0aGlzLmNvbnN0cnVjdG9yLkRFRkFVTFRfT1BUSU9OUyksdCYmdGhpcy5zZXRPcHRpb25zKHQpLHRoaXMuZGlzcD1uZXcgYSgwLDAsMCkscy5jYWxsKHRoaXMpfWZ1bmN0aW9uIG4oKXt2YXIgdD10aGlzLm9wdGlvbnM7dC5zdGlmZm5lc3M9TWF0aC5wb3coMipoL3QucGVyaW9kLDIpfWZ1bmN0aW9uIG8oKXt2YXIgdD10aGlzLm9wdGlvbnM7dC5kYW1waW5nPTQqaCp0LmRhbXBpbmdSYXRpby90LnBlcmlvZH1mdW5jdGlvbiBzKCl7bi5jYWxsKHRoaXMpLG8uY2FsbCh0aGlzKX12YXIgcj10KFwiLi9Gb3JjZVwiKSxhPXQoXCIuLi8uLi9tYXRoL1ZlY3RvclwiKTtlLnByb3RvdHlwZT1PYmplY3QuY3JlYXRlKHIucHJvdG90eXBlKSxlLnByb3RvdHlwZS5jb25zdHJ1Y3Rvcj1lO3ZhciBoPU1hdGguUEksYz0xNTA7ZS5GT1JDRV9GVU5DVElPTlM9e0ZFTkU6ZnVuY3Rpb24odCxpKXt2YXIgZT0uOTkqaSxuPU1hdGgubWF4KE1hdGgubWluKHQsZSksLWUpO3JldHVybiBuLygxLW4qbi8oaSppKSl9LEhPT0s6ZnVuY3Rpb24odCl7cmV0dXJuIHR9fSxlLkRFRkFVTFRfT1BUSU9OUz17cGVyaW9kOjMwMCxkYW1waW5nUmF0aW86LjEsbGVuZ3RoOjAsbWF4TGVuZ3RoOjEvMCxhbmNob3I6dm9pZCAwLGZvcmNlRnVuY3Rpb246ZS5GT1JDRV9GVU5DVElPTlMuSE9PS30sZS5wcm90b3R5cGUuc2V0T3B0aW9ucz1mdW5jdGlvbih0KXt2b2lkIDAhPT10LmFuY2hvciYmKHQuYW5jaG9yLnBvc2l0aW9uIGluc3RhbmNlb2YgYSYmKHRoaXMub3B0aW9ucy5hbmNob3I9dC5hbmNob3IucG9zaXRpb24pLHQuYW5jaG9yIGluc3RhbmNlb2YgYSYmKHRoaXMub3B0aW9ucy5hbmNob3I9dC5hbmNob3IpLHQuYW5jaG9yIGluc3RhbmNlb2YgQXJyYXkmJih0aGlzLm9wdGlvbnMuYW5jaG9yPW5ldyBhKHQuYW5jaG9yKSkpLHZvaWQgMCE9PXQucGVyaW9kJiYodC5wZXJpb2Q8YyYmKHQucGVyaW9kPWMsY29uc29sZS53YXJuKFwiVGhlIHBlcmlvZCBvZiBhIFNwcmluZ1RyYW5zaXRpb24gaXMgY2FwcGVkIGF0IFwiK2MrXCIgbXMuIFVzZSBhIFNuYXBUcmFuc2l0aW9uIGZvciBmYXN0ZXIgdHJhbnNpdGlvbnNcIikpLHRoaXMub3B0aW9ucy5wZXJpb2Q9dC5wZXJpb2QpLHZvaWQgMCE9PXQuZGFtcGluZ1JhdGlvJiYodGhpcy5vcHRpb25zLmRhbXBpbmdSYXRpbz10LmRhbXBpbmdSYXRpbyksdm9pZCAwIT09dC5sZW5ndGgmJih0aGlzLm9wdGlvbnMubGVuZ3RoPXQubGVuZ3RoKSx2b2lkIDAhPT10LmZvcmNlRnVuY3Rpb24mJih0aGlzLm9wdGlvbnMuZm9yY2VGdW5jdGlvbj10LmZvcmNlRnVuY3Rpb24pLHZvaWQgMCE9PXQubWF4TGVuZ3RoJiYodGhpcy5vcHRpb25zLm1heExlbmd0aD10Lm1heExlbmd0aCkscy5jYWxsKHRoaXMpLHIucHJvdG90eXBlLnNldE9wdGlvbnMuY2FsbCh0aGlzLHQpfSxlLnByb3RvdHlwZS5hcHBseUZvcmNlPWZ1bmN0aW9uKHQsaSl7dmFyIGUsbixvLHMscixhLGg9dGhpcy5mb3JjZSxjPXRoaXMuZGlzcCxwPXRoaXMub3B0aW9ucyx1PXAuc3RpZmZuZXNzLGw9cC5kYW1waW5nLGY9cC5sZW5ndGgsZD1wLm1heExlbmd0aCxfPXAuYW5jaG9yfHxpLnBvc2l0aW9uLHk9cC5mb3JjZUZ1bmN0aW9uO2ZvcihlPTA7ZTx0Lmxlbmd0aDtlKyspe2lmKG49dFtlXSxvPW4ucG9zaXRpb24scz1uLnZlbG9jaXR5LF8uc3ViKG8pLnB1dChjKSxyPWMubm9ybSgpLWYsMD09PXIpcmV0dXJuO2E9bi5tYXNzLHUqPWEsbCo9YSxjLm5vcm1hbGl6ZSh1KnkocixkKSkucHV0KGgpLGwmJihpP2guYWRkKHMuc3ViKGkudmVsb2NpdHkpLm11bHQoLWwpKS5wdXQoaCk6aC5hZGQocy5tdWx0KC1sKSkucHV0KGgpKSxuLmFwcGx5Rm9yY2UoaCksaSYmaS5hcHBseUZvcmNlKGgubXVsdCgtMSkpfX0sZS5wcm90b3R5cGUuZ2V0RW5lcmd5PWZ1bmN0aW9uKHQsaSl7Zm9yKHZhciBlPXRoaXMub3B0aW9ucyxuPWUubGVuZ3RoLG89aT9pLnBvc2l0aW9uOmUuYW5jaG9yLHM9ZS5zdGlmZm5lc3Mscj0wLGE9MDthPHQubGVuZ3RoO2ErKyl7dmFyIGg9dFthXSxjPW8uc3ViKGgucG9zaXRpb24pLm5vcm0oKS1uO3IrPS41KnMqYypjfXJldHVybiByfSxpLmV4cG9ydHM9ZX0se1wiLi4vLi4vbWF0aC9WZWN0b3JcIjo0MSxcIi4vRm9yY2VcIjo2NH1dLDY5OltmdW5jdGlvbih0LGkpe2Z1bmN0aW9uIGUodCl7by5jYWxsKHRoaXMpLHRoaXMub3B0aW9ucz1PYmplY3QuY3JlYXRlKGUuREVGQVVMVF9PUFRJT05TKSx0JiZ0aGlzLnNldE9wdGlvbnModCksdGhpcy5ldmFsdWF0aW9uPW5ldyBzfWZ1bmN0aW9uIG4odCl7dmFyIGk9ZS5GSUVMRFM7c3dpdGNoKHQpe2Nhc2UgaS5DT05TVEFOVDp0aGlzLm9wdGlvbnMuZGlyZWN0aW9uP3RoaXMub3B0aW9ucy5kaXJlY3Rpb24gaW5zdGFuY2VvZiBBcnJheSYmKHRoaXMub3B0aW9ucy5kaXJlY3Rpb249bmV3IHModGhpcy5vcHRpb25zLmRpcmVjdGlvbikpOnRoaXMub3B0aW9ucy5kaXJlY3Rpb249bmV3IHMoMCwxLDApO2JyZWFrO2Nhc2UgaS5QT0lOVF9BVFRSQUNUT1I6dGhpcy5vcHRpb25zLnBvc2l0aW9uP3RoaXMub3B0aW9ucy5wb3NpdGlvbiBpbnN0YW5jZW9mIEFycmF5JiYodGhpcy5vcHRpb25zLnBvc2l0aW9uPW5ldyBzKHRoaXMub3B0aW9ucy5wb3NpdGlvbikpOnRoaXMub3B0aW9ucy5wb3NpdGlvbj1uZXcgcygwLDAsMCl9fXZhciBvPXQoXCIuL0ZvcmNlXCIpLHM9dChcIi4uLy4uL21hdGgvVmVjdG9yXCIpO2UucHJvdG90eXBlPU9iamVjdC5jcmVhdGUoby5wcm90b3R5cGUpLGUucHJvdG90eXBlLmNvbnN0cnVjdG9yPWUsZS5GSUVMRFM9e0NPTlNUQU5UOmZ1bmN0aW9uKHQsaSl7aS5kaXJlY3Rpb24ucHV0KHRoaXMuZXZhbHVhdGlvbil9LExJTkVBUjpmdW5jdGlvbih0KXt0LnB1dCh0aGlzLmV2YWx1YXRpb24pfSxSQURJQUw6ZnVuY3Rpb24odCl7dC5tdWx0KC0xKS5wdXQodGhpcy5ldmFsdWF0aW9uKX0sUE9JTlRfQVRUUkFDVE9SOmZ1bmN0aW9uKHQsaSl7aS5wb3NpdGlvbi5zdWIodCkucHV0KHRoaXMuZXZhbHVhdGlvbil9fSxlLkRFRkFVTFRfT1BUSU9OUz17c3RyZW5ndGg6LjAxLGZpZWxkOmUuRklFTERTLkNPTlNUQU5UfSxlLnByb3RvdHlwZS5zZXRPcHRpb25zPWZ1bmN0aW9uKHQpe3ZvaWQgMCE9PXQuc3RyZW5ndGgmJih0aGlzLm9wdGlvbnMuc3RyZW5ndGg9dC5zdHJlbmd0aCksdm9pZCAwIT09dC5maWVsZCYmKHRoaXMub3B0aW9ucy5maWVsZD10LmZpZWxkLG4uY2FsbCh0aGlzLHRoaXMub3B0aW9ucy5maWVsZCkpfSxlLnByb3RvdHlwZS5hcHBseUZvcmNlPWZ1bmN0aW9uKHQpe3ZhciBpLGUsbj10aGlzLmZvcmNlLG89dGhpcy5vcHRpb25zLnN0cmVuZ3RoLHM9dGhpcy5vcHRpb25zLmZpZWxkO2ZvcihpPTA7aTx0Lmxlbmd0aDtpKyspZT10W2ldLHMuY2FsbCh0aGlzLGUucG9zaXRpb24sdGhpcy5vcHRpb25zKSx0aGlzLmV2YWx1YXRpb24ubXVsdChlLm1hc3MqbykucHV0KG4pLGUuYXBwbHlGb3JjZShuKX0sZS5wcm90b3R5cGUuZ2V0RW5lcmd5PWZ1bmN0aW9uKHQpe3ZhciBpLG4sbz10aGlzLm9wdGlvbnMuZmllbGQscz1lLkZJRUxEUyxyPTA7c3dpdGNoKG8pe2Nhc2Ugcy5DT05TVEFOVDpyPXQubGVuZ3RoKnRoaXMub3B0aW9ucy5kaXJlY3Rpb24ubm9ybSgpO2JyZWFrO2Nhc2Ugcy5SQURJQUw6Zm9yKGk9MDtpPHQubGVuZ3RoO2krKyluPXRbaV0scis9bi5wb3NpdGlvbi5ub3JtKCk7YnJlYWs7Y2FzZSBzLlBPSU5UX0FUVFJBQ1RPUjpmb3IoaT0wO2k8dC5sZW5ndGg7aSsrKW49dFtpXSxyKz1uLnBvc2l0aW9uLnN1Yih0aGlzLm9wdGlvbnMucG9zaXRpb24pLm5vcm0oKX1yZXR1cm4gcio9dGhpcy5vcHRpb25zLnN0cmVuZ3RofSxpLmV4cG9ydHM9ZX0se1wiLi4vLi4vbWF0aC9WZWN0b3JcIjo0MSxcIi4vRm9yY2VcIjo2NH1dLDcwOltmdW5jdGlvbih0LGkpe2kuZXhwb3J0cz17RHJhZzp0KFwiLi9EcmFnXCIpLEZvcmNlOnQoXCIuL0ZvcmNlXCIpLFJlcHVsc2lvbjp0KFwiLi9SZXB1bHNpb25cIiksUm90YXRpb25hbERyYWc6dChcIi4vUm90YXRpb25hbERyYWdcIiksUm90YXRpb25hbFNwcmluZzp0KFwiLi9Sb3RhdGlvbmFsU3ByaW5nXCIpLFNwcmluZzp0KFwiLi9TcHJpbmdcIiksVmVjdG9yRmllbGQ6dChcIi4vVmVjdG9yRmllbGRcIil9fSx7XCIuL0RyYWdcIjo2MyxcIi4vRm9yY2VcIjo2NCxcIi4vUmVwdWxzaW9uXCI6NjUsXCIuL1JvdGF0aW9uYWxEcmFnXCI6NjYsXCIuL1JvdGF0aW9uYWxTcHJpbmdcIjo2NyxcIi4vU3ByaW5nXCI6NjgsXCIuL1ZlY3RvckZpZWxkXCI6Njl9XSw3MTpbZnVuY3Rpb24odCxpKXtpLmV4cG9ydHM9e1BoeXNpY3NFbmdpbmU6dChcIi4vUGh5c2ljc0VuZ2luZVwiKSxib2RpZXM6dChcIi4vYm9kaWVzXCIpLGNvbnN0cmFpbnRzOnQoXCIuL2NvbnN0cmFpbnRzXCIpLGZvcmNlczp0KFwiLi9mb3JjZXNcIiksaW50ZWdyYXRvcnM6dChcIi4vaW50ZWdyYXRvcnNcIil9fSx7XCIuL1BoeXNpY3NFbmdpbmVcIjo0OCxcIi4vYm9kaWVzXCI6NTMsXCIuL2NvbnN0cmFpbnRzXCI6NjIsXCIuL2ZvcmNlc1wiOjcwLFwiLi9pbnRlZ3JhdG9yc1wiOjczfV0sNzI6W2Z1bmN0aW9uKHQsaSl7dmFyIGU9e307ZS5pbnRlZ3JhdGVWZWxvY2l0eT1mdW5jdGlvbih0LGkpe3ZhciBlPXQudmVsb2NpdHksbj10LmludmVyc2VNYXNzLG89dC5mb3JjZTtvLmlzWmVybygpfHwoZS5hZGQoby5tdWx0KGkqbikpLnB1dChlKSxvLmNsZWFyKCkpfSxlLmludGVncmF0ZVBvc2l0aW9uPWZ1bmN0aW9uKHQsaSl7dmFyIGU9dC5wb3NpdGlvbixuPXQudmVsb2NpdHk7ZS5hZGQobi5tdWx0KGkpKS5wdXQoZSl9LGUuaW50ZWdyYXRlQW5ndWxhck1vbWVudHVtPWZ1bmN0aW9uKHQsaSl7dmFyIGU9dC5hbmd1bGFyTW9tZW50dW0sbj10LnRvcnF1ZTtuLmlzWmVybygpfHwoZS5hZGQobi5tdWx0KGkpKS5wdXQoZSksbi5jbGVhcigpKX0sZS5pbnRlZ3JhdGVPcmllbnRhdGlvbj1mdW5jdGlvbih0LGkpe3ZhciBlPXQub3JpZW50YXRpb24sbj10LmFuZ3VsYXJWZWxvY2l0eTtuLmlzWmVybygpfHxlLmFkZChlLm11bHRpcGx5KG4pLnNjYWxhck11bHRpcGx5KC41KmkpKS5wdXQoZSl9LGkuZXhwb3J0cz1lfSx7fV0sNzM6W2Z1bmN0aW9uKHQsaSl7aS5leHBvcnRzPXtTeW1wbGVjdGljRXVsZXI6dChcIi4vU3ltcGxlY3RpY0V1bGVyXCIpfX0se1wiLi9TeW1wbGVjdGljRXVsZXJcIjo3Mn1dLDc0OltmdW5jdGlvbih0LGkpe2Z1bmN0aW9uIGUodCl7dCYmdC5jYW52YXNTaXplJiYodGhpcy5fY2FudmFzU2l6ZT10LmNhbnZhc1NpemUpLG4uYXBwbHkodGhpcyxhcmd1bWVudHMpLHRoaXMuX2NhbnZhc1NpemV8fCh0aGlzLl9jYW52YXNTaXplPXRoaXMuZ2V0U2l6ZSgpKSx0aGlzLl9iYWNrQnVmZmVyPWRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJjYW52YXNcIiksdGhpcy5fY2FudmFzU2l6ZSYmKHRoaXMuX2JhY2tCdWZmZXIud2lkdGg9dGhpcy5fY2FudmFzU2l6ZVswXSx0aGlzLl9iYWNrQnVmZmVyLmhlaWdodD10aGlzLl9jYW52YXNTaXplWzFdKSx0aGlzLl9jb250ZXh0SWQ9dm9pZCAwfXZhciBuPXQoXCIuLi9jb3JlL1N1cmZhY2VcIik7ZS5wcm90b3R5cGU9T2JqZWN0LmNyZWF0ZShuLnByb3RvdHlwZSksZS5wcm90b3R5cGUuY29uc3RydWN0b3I9ZSxlLnByb3RvdHlwZS5lbGVtZW50VHlwZT1cImNhbnZhc1wiLGUucHJvdG90eXBlLmVsZW1lbnRDbGFzcz1cImZhbW91cy1zdXJmYWNlXCIsZS5wcm90b3R5cGUuc2V0Q29udGVudD1mdW5jdGlvbigpe30sZS5wcm90b3R5cGUuZGVwbG95PWZ1bmN0aW9uKHQpe3RoaXMuX2NhbnZhc1NpemUmJih0LndpZHRoPXRoaXMuX2NhbnZhc1NpemVbMF0sdC5oZWlnaHQ9dGhpcy5fY2FudmFzU2l6ZVsxXSksXCIyZFwiPT09dGhpcy5fY29udGV4dElkJiYodC5nZXRDb250ZXh0KHRoaXMuX2NvbnRleHRJZCkuZHJhd0ltYWdlKHRoaXMuX2JhY2tCdWZmZXIsMCwwKSx0aGlzLl9iYWNrQnVmZmVyLndpZHRoPTAsdGhpcy5fYmFja0J1ZmZlci5oZWlnaHQ9MCl9LGUucHJvdG90eXBlLnJlY2FsbD1mdW5jdGlvbih0KXt0aGlzLmdldFNpemUoKTt0aGlzLl9iYWNrQnVmZmVyLndpZHRoPXQud2lkdGgsdGhpcy5fYmFja0J1ZmZlci5oZWlnaHQ9dC5oZWlnaHQsXCIyZFwiPT09dGhpcy5fY29udGV4dElkJiYodGhpcy5fYmFja0J1ZmZlci5nZXRDb250ZXh0KHRoaXMuX2NvbnRleHRJZCkuZHJhd0ltYWdlKHQsMCwwKSx0LndpZHRoPTAsdC5oZWlnaHQ9MCl9LGUucHJvdG90eXBlLmdldENvbnRleHQ9ZnVuY3Rpb24odCl7cmV0dXJuIHRoaXMuX2NvbnRleHRJZD10LHRoaXMuX2N1cnJlbnRUYXJnZXQ/dGhpcy5fY3VycmVudFRhcmdldC5nZXRDb250ZXh0KHQpOnRoaXMuX2JhY2tCdWZmZXIuZ2V0Q29udGV4dCh0KX0sZS5wcm90b3R5cGUuc2V0U2l6ZT1mdW5jdGlvbih0LGkpe24ucHJvdG90eXBlLnNldFNpemUuYXBwbHkodGhpcyxhcmd1bWVudHMpLGkmJih0aGlzLl9jYW52YXNTaXplPVtpWzBdLGlbMV1dKSx0aGlzLl9jdXJyZW50VGFyZ2V0JiYodGhpcy5fY3VycmVudFRhcmdldC53aWR0aD10aGlzLl9jYW52YXNTaXplWzBdLHRoaXMuX2N1cnJlbnRUYXJnZXQuaGVpZ2h0PXRoaXMuX2NhbnZhc1NpemVbMV0pfSxpLmV4cG9ydHM9ZX0se1wiLi4vY29yZS9TdXJmYWNlXCI6MTR9XSw3NTpbZnVuY3Rpb24odCxpKXtmdW5jdGlvbiBlKHQpe24uY2FsbCh0aGlzLHQpLHRoaXMuX2NvbnRhaW5lcj1kb2N1bWVudC5jcmVhdGVFbGVtZW50KFwiZGl2XCIpLHRoaXMuX2NvbnRhaW5lci5jbGFzc0xpc3QuYWRkKFwiZmFtb3VzLWdyb3VwXCIpLHRoaXMuX2NvbnRhaW5lci5jbGFzc0xpc3QuYWRkKFwiZmFtb3VzLWNvbnRhaW5lci1ncm91cFwiKSx0aGlzLl9zaG91bGRSZWNhbGN1bGF0ZVNpemU9ITEsdGhpcy5jb250ZXh0PW5ldyBvKHRoaXMuX2NvbnRhaW5lciksdGhpcy5zZXRDb250ZW50KHRoaXMuX2NvbnRhaW5lcil9dmFyIG49dChcIi4uL2NvcmUvU3VyZmFjZVwiKSxvPXQoXCIuLi9jb3JlL0NvbnRleHRcIik7ZS5wcm90b3R5cGU9T2JqZWN0LmNyZWF0ZShuLnByb3RvdHlwZSksZS5wcm90b3R5cGUuY29uc3RydWN0b3I9ZSxlLnByb3RvdHlwZS5lbGVtZW50VHlwZT1cImRpdlwiLGUucHJvdG90eXBlLmVsZW1lbnRDbGFzcz1cImZhbW91cy1zdXJmYWNlXCIsZS5wcm90b3R5cGUuYWRkPWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuY29udGV4dC5hZGQuYXBwbHkodGhpcy5jb250ZXh0LGFyZ3VtZW50cyl9LGUucHJvdG90eXBlLnJlbmRlcj1mdW5jdGlvbigpe3JldHVybiB0aGlzLl9zaXplRGlydHkmJih0aGlzLl9zaG91bGRSZWNhbGN1bGF0ZVNpemU9ITApLG4ucHJvdG90eXBlLnJlbmRlci5hcHBseSh0aGlzLGFyZ3VtZW50cyl9LGUucHJvdG90eXBlLmRlcGxveT1mdW5jdGlvbigpe3JldHVybiB0aGlzLl9zaG91bGRSZWNhbGN1bGF0ZVNpemU9ITAsbi5wcm90b3R5cGUuZGVwbG95LmFwcGx5KHRoaXMsYXJndW1lbnRzKX0sZS5wcm90b3R5cGUuY29tbWl0PWZ1bmN0aW9uKCl7dmFyIHQ9dGhpcy5fc2l6ZT9bdGhpcy5fc2l6ZVswXSx0aGlzLl9zaXplWzFdXTpudWxsLGk9bi5wcm90b3R5cGUuY29tbWl0LmFwcGx5KHRoaXMsYXJndW1lbnRzKTtyZXR1cm4odGhpcy5fc2hvdWxkUmVjYWxjdWxhdGVTaXplfHx0JiYodGhpcy5fc2l6ZVswXSE9PXRbMF18fHRoaXMuX3NpemVbMV0hPT10WzFdKSkmJih0aGlzLmNvbnRleHQuc2V0U2l6ZSgpLHRoaXMuX3Nob3VsZFJlY2FsY3VsYXRlU2l6ZT0hMSksdGhpcy5jb250ZXh0LnVwZGF0ZSgpLGl9LGkuZXhwb3J0cz1lfSx7XCIuLi9jb3JlL0NvbnRleHRcIjoxLFwiLi4vY29yZS9TdXJmYWNlXCI6MTR9XSw3NjpbZnVuY3Rpb24odCxpKXtmdW5jdGlvbiBlKHQpe3QmJih0aGlzLl9tZXRob2Q9dC5tZXRob2R8fFwiXCIpLG4uYXBwbHkodGhpcyxhcmd1bWVudHMpfXZhciBuPXQoXCIuL0NvbnRhaW5lclN1cmZhY2VcIik7ZS5wcm90b3R5cGU9T2JqZWN0LmNyZWF0ZShuLnByb3RvdHlwZSksZS5wcm90b3R5cGUuY29uc3RydWN0b3I9ZSxlLnByb3RvdHlwZS5lbGVtZW50VHlwZT1cImZvcm1cIixlLnByb3RvdHlwZS5kZXBsb3k9ZnVuY3Rpb24odCl7cmV0dXJuIHRoaXMuX21ldGhvZCYmKHQubWV0aG9kPXRoaXMuX21ldGhvZCksbi5wcm90b3R5cGUuZGVwbG95LmFwcGx5KHRoaXMsYXJndW1lbnRzKX0saS5leHBvcnRzPWV9LHtcIi4vQ29udGFpbmVyU3VyZmFjZVwiOjc1fV0sNzc6W2Z1bmN0aW9uKHQsaSl7ZnVuY3Rpb24gZSgpe3RoaXMuX2ltYWdlVXJsPXZvaWQgMCxuLmFwcGx5KHRoaXMsYXJndW1lbnRzKX12YXIgbj10KFwiLi4vY29yZS9TdXJmYWNlXCIpLG89W10scz1bXSxyPVtdLGE9ITA7ZS5lbmFibGVDYWNoZT1mdW5jdGlvbigpe2E9ITB9LGUuZGlzYWJsZUNhY2hlPWZ1bmN0aW9uKCl7YT0hMX0sZS5jbGVhckNhY2hlPWZ1bmN0aW9uKCl7bz1bXSxzPVtdLHI9W119LGUuZ2V0Q2FjaGU9ZnVuY3Rpb24oKXtyZXR1cm57dXJsQ2FjaGU6byxjb3VudENhY2hlOnMsbm9kZUNhY2hlOnN9fSxlLnByb3RvdHlwZT1PYmplY3QuY3JlYXRlKG4ucHJvdG90eXBlKSxlLnByb3RvdHlwZS5jb25zdHJ1Y3Rvcj1lLGUucHJvdG90eXBlLmVsZW1lbnRUeXBlPVwiaW1nXCIsZS5wcm90b3R5cGUuZWxlbWVudENsYXNzPVwiZmFtb3VzLXN1cmZhY2VcIixlLnByb3RvdHlwZS5zZXRDb250ZW50PWZ1bmN0aW9uKHQpe3ZhciBpPW8uaW5kZXhPZih0aGlzLl9pbWFnZVVybCk7LTEhPT1pJiYoMT09PXNbaV0/KG8uc3BsaWNlKGksMSkscy5zcGxpY2UoaSwxKSxyLnNwbGljZShpLDEpKTpzW2ldLS0pLGk9by5pbmRleE9mKHQpLC0xPT09aT8oby5wdXNoKHQpLHMucHVzaCgxKSk6c1tpXSsrLHRoaXMuX2ltYWdlVXJsPXQsdGhpcy5fY29udGVudERpcnR5PSEwfSxlLnByb3RvdHlwZS5kZXBsb3k9ZnVuY3Rpb24odCl7dmFyIGk9by5pbmRleE9mKHRoaXMuX2ltYWdlVXJsKTtpZih2b2lkIDA9PT1yW2ldJiZhKXt2YXIgZT1uZXcgSW1hZ2U7ZS5zcmM9dGhpcy5faW1hZ2VVcmx8fFwiXCIscltpXT1lfXQuc3JjPXRoaXMuX2ltYWdlVXJsfHxcIlwifSxlLnByb3RvdHlwZS5yZWNhbGw9ZnVuY3Rpb24odCl7dC5zcmM9XCJcIn0saS5leHBvcnRzPWV9LHtcIi4uL2NvcmUvU3VyZmFjZVwiOjE0fV0sNzg6W2Z1bmN0aW9uKHQsaSl7ZnVuY3Rpb24gZSh0KXt0aGlzLl9wbGFjZWhvbGRlcj10LnBsYWNlaG9sZGVyfHxcIlwiLHRoaXMuX3ZhbHVlPXQudmFsdWV8fFwiXCIsdGhpcy5fdHlwZT10LnR5cGV8fFwidGV4dFwiLHRoaXMuX25hbWU9dC5uYW1lfHxcIlwiLG4uYXBwbHkodGhpcyxhcmd1bWVudHMpLHRoaXMub24oXCJjbGlja1wiLHRoaXMuZm9jdXMuYmluZCh0aGlzKSksd2luZG93LmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLGZ1bmN0aW9uKHQpe3QudGFyZ2V0IT09dGhpcy5fY3VycmVudFRhcmdldCYmdGhpcy5ibHVyKCl9LmJpbmQodGhpcykpfXZhciBuPXQoXCIuLi9jb3JlL1N1cmZhY2VcIik7ZS5wcm90b3R5cGU9T2JqZWN0LmNyZWF0ZShuLnByb3RvdHlwZSksZS5wcm90b3R5cGUuY29uc3RydWN0b3I9ZSxlLnByb3RvdHlwZS5lbGVtZW50VHlwZT1cImlucHV0XCIsZS5wcm90b3R5cGUuZWxlbWVudENsYXNzPVwiZmFtb3VzLXN1cmZhY2VcIixlLnByb3RvdHlwZS5zZXRQbGFjZWhvbGRlcj1mdW5jdGlvbih0KXtyZXR1cm4gdGhpcy5fcGxhY2Vob2xkZXI9dCx0aGlzLl9jb250ZW50RGlydHk9ITAsdGhpc30sZS5wcm90b3R5cGUuZm9jdXM9ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5fY3VycmVudFRhcmdldCYmdGhpcy5fY3VycmVudFRhcmdldC5mb2N1cygpLHRoaXN9LGUucHJvdG90eXBlLmJsdXI9ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5fY3VycmVudFRhcmdldCYmdGhpcy5fY3VycmVudFRhcmdldC5ibHVyKCksdGhpc30sZS5wcm90b3R5cGUuc2V0VmFsdWU9ZnVuY3Rpb24odCl7cmV0dXJuIHRoaXMuX3ZhbHVlPXQsdGhpcy5fY29udGVudERpcnR5PSEwLHRoaXN9LGUucHJvdG90eXBlLnNldFR5cGU9ZnVuY3Rpb24odCl7cmV0dXJuIHRoaXMuX3R5cGU9dCx0aGlzLl9jb250ZW50RGlydHk9ITAsdGhpc30sZS5wcm90b3R5cGUuZ2V0VmFsdWU9ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5fY3VycmVudFRhcmdldD90aGlzLl9jdXJyZW50VGFyZ2V0LnZhbHVlOnRoaXMuX3ZhbHVlfSxlLnByb3RvdHlwZS5zZXROYW1lPWZ1bmN0aW9uKHQpe3JldHVybiB0aGlzLl9uYW1lPXQsdGhpcy5fY29udGVudERpcnR5PSEwLHRoaXN9LGUucHJvdG90eXBlLmdldE5hbWU9ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5fbmFtZX0sZS5wcm90b3R5cGUuZGVwbG95PWZ1bmN0aW9uKHQpe1wiXCIhPT10aGlzLl9wbGFjZWhvbGRlciYmKHQucGxhY2Vob2xkZXI9dGhpcy5fcGxhY2Vob2xkZXIpLHQudmFsdWU9dGhpcy5fdmFsdWUsdC50eXBlPXRoaXMuX3R5cGUsdC5uYW1lPXRoaXMuX25hbWV9LGkuZXhwb3J0cz1lfSx7XCIuLi9jb3JlL1N1cmZhY2VcIjoxNH1dLDc5OltmdW5jdGlvbih0LGkpe2Z1bmN0aW9uIGUodCl7bi5hcHBseSh0aGlzLGFyZ3VtZW50cyksdGhpcy5fdHlwZT1cInN1Ym1pdFwiLHQmJnQub25DbGljayYmdGhpcy5zZXRPbkNsaWNrKHQub25DbGljayl9dmFyIG49dChcIi4vSW5wdXRTdXJmYWNlXCIpO2UucHJvdG90eXBlPU9iamVjdC5jcmVhdGUobi5wcm90b3R5cGUpLGUucHJvdG90eXBlLmNvbnN0cnVjdG9yPWUsZS5wcm90b3R5cGUuc2V0T25DbGljaz1mdW5jdGlvbih0KXt0aGlzLm9uQ2xpY2s9dH0sZS5wcm90b3R5cGUuZGVwbG95PWZ1bmN0aW9uKHQpe3RoaXMub25jbGljayYmKHQub25DbGljaz10aGlzLm9uQ2xpY2spLG4ucHJvdG90eXBlLmRlcGxveS5hcHBseSh0aGlzLGFyZ3VtZW50cyl9LGkuZXhwb3J0cz1lfSx7XCIuL0lucHV0U3VyZmFjZVwiOjc4fV0sODA6W2Z1bmN0aW9uKHQsaSl7ZnVuY3Rpb24gZSh0KXt0aGlzLl9wbGFjZWhvbGRlcj10LnBsYWNlaG9sZGVyfHxcIlwiLHRoaXMuX3ZhbHVlPXQudmFsdWV8fFwiXCIsdGhpcy5fbmFtZT10Lm5hbWV8fFwiXCIsdGhpcy5fd3JhcD10LndyYXB8fFwiXCIsdGhpcy5fY29scz10LmNvbHN8fFwiXCIsdGhpcy5fcm93cz10LnJvd3N8fFwiXCIsbi5hcHBseSh0aGlzLGFyZ3VtZW50cyksdGhpcy5vbihcImNsaWNrXCIsdGhpcy5mb2N1cy5iaW5kKHRoaXMpKX12YXIgbj10KFwiLi4vY29yZS9TdXJmYWNlXCIpO2UucHJvdG90eXBlPU9iamVjdC5jcmVhdGUobi5wcm90b3R5cGUpLGUucHJvdG90eXBlLmNvbnN0cnVjdG9yPWUsZS5wcm90b3R5cGUuZWxlbWVudFR5cGU9XCJ0ZXh0YXJlYVwiLGUucHJvdG90eXBlLmVsZW1lbnRDbGFzcz1cImZhbW91cy1zdXJmYWNlXCIsZS5wcm90b3R5cGUuc2V0UGxhY2Vob2xkZXI9ZnVuY3Rpb24odCl7cmV0dXJuIHRoaXMuX3BsYWNlaG9sZGVyPXQsdGhpcy5fY29udGVudERpcnR5PSEwLHRoaXN9LGUucHJvdG90eXBlLmZvY3VzPWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuX2N1cnJlbnRUYXJnZXQmJnRoaXMuX2N1cnJlbnRUYXJnZXQuZm9jdXMoKSx0aGlzfSxlLnByb3RvdHlwZS5ibHVyPWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuX2N1cnJlbnRUYXJnZXQmJnRoaXMuX2N1cnJlbnRUYXJnZXQuYmx1cigpLHRoaXN9LGUucHJvdG90eXBlLnNldFZhbHVlPWZ1bmN0aW9uKHQpe3JldHVybiB0aGlzLl92YWx1ZT10LHRoaXMuX2NvbnRlbnREaXJ0eT0hMCx0aGlzfSxlLnByb3RvdHlwZS5nZXRWYWx1ZT1mdW5jdGlvbigpe3JldHVybiB0aGlzLl9jdXJyZW50VGFyZ2V0P3RoaXMuX2N1cnJlbnRUYXJnZXQudmFsdWU6dGhpcy5fdmFsdWV9LGUucHJvdG90eXBlLnNldE5hbWU9ZnVuY3Rpb24odCl7cmV0dXJuIHRoaXMuX25hbWU9dCx0aGlzLl9jb250ZW50RGlydHk9ITAsdGhpc30sZS5wcm90b3R5cGUuZ2V0TmFtZT1mdW5jdGlvbigpe3JldHVybiB0aGlzLl9uYW1lfSxlLnByb3RvdHlwZS5zZXRXcmFwPWZ1bmN0aW9uKHQpe3JldHVybiB0aGlzLl93cmFwPXQsdGhpcy5fY29udGVudERpcnR5PSEwLHRoaXN9LGUucHJvdG90eXBlLnNldENvbHVtbnM9ZnVuY3Rpb24odCl7cmV0dXJuIHRoaXMuX2NvbHM9dCx0aGlzLl9jb250ZW50RGlydHk9ITAsdGhpc30sZS5wcm90b3R5cGUuc2V0Um93cz1mdW5jdGlvbih0KXtyZXR1cm4gdGhpcy5fcm93cz10LHRoaXMuX2NvbnRlbnREaXJ0eT0hMCx0aGlzfSxlLnByb3RvdHlwZS5kZXBsb3k9ZnVuY3Rpb24odCl7XCJcIiE9PXRoaXMuX3BsYWNlaG9sZGVyJiYodC5wbGFjZWhvbGRlcj10aGlzLl9wbGFjZWhvbGRlciksXCJcIiE9PXRoaXMuX3ZhbHVlJiYodC52YWx1ZT10aGlzLl92YWx1ZSksXCJcIiE9PXRoaXMuX25hbWUmJih0Lm5hbWU9dGhpcy5fbmFtZSksXCJcIiE9PXRoaXMuX3dyYXAmJih0LndyYXA9dGhpcy5fd3JhcCksXCJcIiE9PXRoaXMuX2NvbHMmJih0LmNvbHM9dGhpcy5fY29scyksXCJcIiE9PXRoaXMuX3Jvd3MmJih0LnJvd3M9dGhpcy5fcm93cyl9LGkuZXhwb3J0cz1lfSx7XCIuLi9jb3JlL1N1cmZhY2VcIjoxNH1dLDgxOltmdW5jdGlvbih0LGkpe2Z1bmN0aW9uIGUodCl7bi5hcHBseSh0aGlzLGFyZ3VtZW50cyksdGhpcy5fdmlkZW9Vcmw9dm9pZCAwLHRoaXMub3B0aW9ucz1PYmplY3QuY3JlYXRlKGUuREVGQVVMVF9PUFRJT05TKSx0JiZ0aGlzLnNldE9wdGlvbnModCl9dmFyIG49dChcIi4uL2NvcmUvU3VyZmFjZVwiKTtlLnByb3RvdHlwZT1PYmplY3QuY3JlYXRlKG4ucHJvdG90eXBlKSxlLnByb3RvdHlwZS5jb25zdHJ1Y3Rvcj1lLGUuREVGQVVMVF9PUFRJT05TPXthdXRvcGxheTohMX0sZS5wcm90b3R5cGUuZWxlbWVudFR5cGU9XCJ2aWRlb1wiLGUucHJvdG90eXBlLmVsZW1lbnRDbGFzcz1cImZhbW91cy1zdXJmYWNlXCIsZS5wcm90b3R5cGUuc2V0T3B0aW9ucz1mdW5jdGlvbih0KXt0LnNpemUmJnRoaXMuc2V0U2l6ZSh0LnNpemUpLHQuY2xhc3NlcyYmdGhpcy5zZXRDbGFzc2VzKHQuY2xhc3NlcyksdC5wcm9wZXJ0aWVzJiZ0aGlzLnNldFByb3BlcnRpZXModC5wcm9wZXJ0aWVzKSx0LmF1dG9wbGF5JiYodGhpcy5vcHRpb25zLmF1dG9wbGF5PXQuYXV0b3BsYXkpLHQuc3JjJiYodGhpcy5fdmlkZW9Vcmw9dC5zcmMsdGhpcy5fY29udGVudERpcnR5PSEwKX0sZS5wcm90b3R5cGUuc2V0Q29udGVudD1mdW5jdGlvbih0KXt0aGlzLl92aWRlb1VybD10LHRoaXMuX2NvbnRlbnREaXJ0eT0hMH0sZS5wcm90b3R5cGUuZGVwbG95PWZ1bmN0aW9uKHQpe3Quc3JjPXRoaXMuX3ZpZGVvVXJsLHQuYXV0b3BsYXk9dGhpcy5vcHRpb25zLmF1dG9wbGF5fSxlLnByb3RvdHlwZS5yZWNhbGw9ZnVuY3Rpb24odCl7dC5zcmM9XCJcIn0saS5leHBvcnRzPWV9LHtcIi4uL2NvcmUvU3VyZmFjZVwiOjE0fV0sODI6W2Z1bmN0aW9uKHQsaSl7aS5leHBvcnRzPXtDYW52YXNTdXJmYWNlOnQoXCIuL0NhbnZhc1N1cmZhY2VcIiksQ29udGFpbmVyU3VyZmFjZTp0KFwiLi9Db250YWluZXJTdXJmYWNlXCIpLEZvcm1Db250YWluZXJTdXJmYWNlOnQoXCIuL0Zvcm1Db250YWluZXJTdXJmYWNlXCIpLEltYWdlU3VyZmFjZTp0KFwiLi9JbWFnZVN1cmZhY2VcIiksSW5wdXRTdXJmYWNlOnQoXCIuL0lucHV0U3VyZmFjZVwiKSxTdWJtaXRJbnB1dFN1cmZhY2U6dChcIi4vU3VibWl0SW5wdXRTdXJmYWNlXCIpLFRleHRhcmVhU3VyZmFjZTp0KFwiLi9UZXh0YXJlYVN1cmZhY2VcIiksVmlkZW9TdXJmYWNlOnQoXCIuL1ZpZGVvU3VyZmFjZVwiKX19LHtcIi4vQ2FudmFzU3VyZmFjZVwiOjc0LFwiLi9Db250YWluZXJTdXJmYWNlXCI6NzUsXCIuL0Zvcm1Db250YWluZXJTdXJmYWNlXCI6NzYsXCIuL0ltYWdlU3VyZmFjZVwiOjc3LFwiLi9JbnB1dFN1cmZhY2VcIjo3OCxcIi4vU3VibWl0SW5wdXRTdXJmYWNlXCI6NzksXCIuL1RleHRhcmVhU3VyZmFjZVwiOjgwLFwiLi9WaWRlb1N1cmZhY2VcIjo4MX1dLDgzOltmdW5jdGlvbih0LGkpe2Z1bmN0aW9uIGUodCl7dGhpcy5fbWFwPXR8fG51bGwsdGhpcy5fY2FjaGVkT3V0cHV0PW51bGwsdGhpcy5fY2FjaGVkSW5wdXQ9TnVtYmVyLk5hTn1lLmNyZWF0ZT1mdW5jdGlvbih0KXt2YXIgaT1uZXcgZSh0KTtyZXR1cm4gaS5nZXQuYmluZChpKX0sZS5wcm90b3R5cGUuZ2V0PWZ1bmN0aW9uKHQpe3JldHVybiB0IT09dGhpcy5fY2FjaGVkSW5wdXQmJih0aGlzLl9jYWNoZWRJbnB1dD10LHRoaXMuX2NhY2hlZE91dHB1dD10aGlzLl9tYXAodCkpLHRoaXMuX2NhY2hlZE91dHB1dH0saS5leHBvcnRzPWV9LHt9XSw4NDpbZnVuY3Rpb24odCxpKXt2YXIgZT17aW5RdWFkOmZ1bmN0aW9uKHQpe3JldHVybiB0KnR9LG91dFF1YWQ6ZnVuY3Rpb24odCl7cmV0dXJuLSh0LT0xKSp0KzF9LGluT3V0UXVhZDpmdW5jdGlvbih0KXtyZXR1cm4odC89LjUpPDE/LjUqdCp0Oi0uNSooLS10Kih0LTIpLTEpfSxpbkN1YmljOmZ1bmN0aW9uKHQpe3JldHVybiB0KnQqdH0sb3V0Q3ViaWM6ZnVuY3Rpb24odCl7cmV0dXJuLS10KnQqdCsxfSxpbk91dEN1YmljOmZ1bmN0aW9uKHQpe3JldHVybih0Lz0uNSk8MT8uNSp0KnQqdDouNSooKHQtPTIpKnQqdCsyKX0saW5RdWFydDpmdW5jdGlvbih0KXtyZXR1cm4gdCp0KnQqdH0sb3V0UXVhcnQ6ZnVuY3Rpb24odCl7cmV0dXJuLSgtLXQqdCp0KnQtMSl9LGluT3V0UXVhcnQ6ZnVuY3Rpb24odCl7cmV0dXJuKHQvPS41KTwxPy41KnQqdCp0KnQ6LS41KigodC09MikqdCp0KnQtMil9LGluUXVpbnQ6ZnVuY3Rpb24odCl7cmV0dXJuIHQqdCp0KnQqdH0sb3V0UXVpbnQ6ZnVuY3Rpb24odCl7cmV0dXJuLS10KnQqdCp0KnQrMX0saW5PdXRRdWludDpmdW5jdGlvbih0KXtyZXR1cm4odC89LjUpPDE/LjUqdCp0KnQqdCp0Oi41KigodC09MikqdCp0KnQqdCsyKX0saW5TaW5lOmZ1bmN0aW9uKHQpe3JldHVybi0xKk1hdGguY29zKHQqKE1hdGguUEkvMikpKzF9LG91dFNpbmU6ZnVuY3Rpb24odCl7cmV0dXJuIE1hdGguc2luKHQqKE1hdGguUEkvMikpfSxpbk91dFNpbmU6ZnVuY3Rpb24odCl7cmV0dXJuLS41KihNYXRoLmNvcyhNYXRoLlBJKnQpLTEpfSxpbkV4cG86ZnVuY3Rpb24odCl7cmV0dXJuIDA9PT10PzA6TWF0aC5wb3coMiwxMCoodC0xKSl9LG91dEV4cG86ZnVuY3Rpb24odCl7cmV0dXJuIDE9PT10PzE6LU1hdGgucG93KDIsLTEwKnQpKzF9LGluT3V0RXhwbzpmdW5jdGlvbih0KXtyZXR1cm4gMD09PXQ/MDoxPT09dD8xOih0Lz0uNSk8MT8uNSpNYXRoLnBvdygyLDEwKih0LTEpKTouNSooLU1hdGgucG93KDIsLTEwKi0tdCkrMil9LGluQ2lyYzpmdW5jdGlvbih0KXtyZXR1cm4tKE1hdGguc3FydCgxLXQqdCktMSl9LG91dENpcmM6ZnVuY3Rpb24odCl7cmV0dXJuIE1hdGguc3FydCgxLSAtLXQqdCl9LGluT3V0Q2lyYzpmdW5jdGlvbih0KXtyZXR1cm4odC89LjUpPDE/LS41KihNYXRoLnNxcnQoMS10KnQpLTEpOi41KihNYXRoLnNxcnQoMS0odC09MikqdCkrMSl9LGluRWxhc3RpYzpmdW5jdGlvbih0KXt2YXIgaT0xLjcwMTU4LGU9MCxuPTE7cmV0dXJuIDA9PT10PzA6MT09PXQ/MTooZXx8KGU9LjMpLGk9ZS8oMipNYXRoLlBJKSpNYXRoLmFzaW4oMS9uKSwtKG4qTWF0aC5wb3coMiwxMCoodC09MSkpKk1hdGguc2luKDIqKHQtaSkqTWF0aC5QSS9lKSkpfSxvdXRFbGFzdGljOmZ1bmN0aW9uKHQpe3ZhciBpPTEuNzAxNTgsZT0wLG49MTtyZXR1cm4gMD09PXQ/MDoxPT09dD8xOihlfHwoZT0uMyksaT1lLygyKk1hdGguUEkpKk1hdGguYXNpbigxL24pLG4qTWF0aC5wb3coMiwtMTAqdCkqTWF0aC5zaW4oMioodC1pKSpNYXRoLlBJL2UpKzEpfSxpbk91dEVsYXN0aWM6ZnVuY3Rpb24odCl7dmFyIGk9MS43MDE1OCxlPTAsbj0xO3JldHVybiAwPT09dD8wOjI9PT0odC89LjUpPzE6KGV8fChlPS4zKjEuNSksaT1lLygyKk1hdGguUEkpKk1hdGguYXNpbigxL24pLDE+dD8tLjUqbipNYXRoLnBvdygyLDEwKih0LT0xKSkqTWF0aC5zaW4oMioodC1pKSpNYXRoLlBJL2UpOm4qTWF0aC5wb3coMiwtMTAqKHQtPTEpKSpNYXRoLnNpbigyKih0LWkpKk1hdGguUEkvZSkqLjUrMSl9LGluQmFjazpmdW5jdGlvbih0LGkpe3JldHVybiB2b2lkIDA9PT1pJiYoaT0xLjcwMTU4KSx0KnQqKChpKzEpKnQtaSl9LG91dEJhY2s6ZnVuY3Rpb24odCxpKXtyZXR1cm4gdm9pZCAwPT09aSYmKGk9MS43MDE1OCksLS10KnQqKChpKzEpKnQraSkrMX0saW5PdXRCYWNrOmZ1bmN0aW9uKHQsaSl7cmV0dXJuIHZvaWQgMD09PWkmJihpPTEuNzAxNTgpLCh0Lz0uNSk8MT8uNSp0KnQqKCgoaSo9MS41MjUpKzEpKnQtaSk6LjUqKCh0LT0yKSp0KigoKGkqPTEuNTI1KSsxKSp0K2kpKzIpfSxpbkJvdW5jZTpmdW5jdGlvbih0KXtyZXR1cm4gMS1lLm91dEJvdW5jZSgxLXQpfSxvdXRCb3VuY2U6ZnVuY3Rpb24odCl7cmV0dXJuIDEvMi43NT50PzcuNTYyNSp0KnQ6Mi8yLjc1PnQ/Ny41NjI1Kih0LT0xLjUvMi43NSkqdCsuNzU6Mi41LzIuNzU+dD83LjU2MjUqKHQtPTIuMjUvMi43NSkqdCsuOTM3NTo3LjU2MjUqKHQtPTIuNjI1LzIuNzUpKnQrLjk4NDM3NX0saW5PdXRCb3VuY2U6ZnVuY3Rpb24odCl7cmV0dXJuLjU+dD8uNSplLmluQm91bmNlKDIqdCk6LjUqZS5vdXRCb3VuY2UoMip0LTEpKy41fX07aS5leHBvcnRzPWV9LHt9XSw4NTpbZnVuY3Rpb24odCxpKXtmdW5jdGlvbiBlKHQpe3RoaXMubWV0aG9kPXQsdGhpcy5faW5zdGFuY2VzPVtdLHRoaXMuc3RhdGU9W119dmFyIG49dChcIi4uL3V0aWxpdGllcy9VdGlsaXR5XCIpO2UuU1VQUE9SVFNfTVVMVElQTEU9ITAsZS5wcm90b3R5cGUuZ2V0PWZ1bmN0aW9uKCl7Zm9yKHZhciB0PTA7dDx0aGlzLl9pbnN0YW5jZXMubGVuZ3RoO3QrKyl0aGlzLnN0YXRlW3RdPXRoaXMuX2luc3RhbmNlc1t0XS5nZXQoKTtyZXR1cm4gdGhpcy5zdGF0ZX0sZS5wcm90b3R5cGUuc2V0PWZ1bmN0aW9uKHQsaSxlKXtmb3IodmFyIG89bi5hZnRlcih0Lmxlbmd0aCxlKSxzPTA7czx0Lmxlbmd0aDtzKyspdGhpcy5faW5zdGFuY2VzW3NdfHwodGhpcy5faW5zdGFuY2VzW3NdPW5ldyB0aGlzLm1ldGhvZCksdGhpcy5faW5zdGFuY2VzW3NdLnNldCh0W3NdLGksbyl9LGUucHJvdG90eXBlLnJlc2V0PWZ1bmN0aW9uKHQpe2Zvcih2YXIgaT0wO2k8dC5sZW5ndGg7aSsrKXRoaXMuX2luc3RhbmNlc1tpXXx8KHRoaXMuX2luc3RhbmNlc1tpXT1uZXcgdGhpcy5tZXRob2QpLHRoaXMuX2luc3RhbmNlc1tpXS5yZXNldCh0W2ldKX0saS5leHBvcnRzPWV9LHtcIi4uL3V0aWxpdGllcy9VdGlsaXR5XCI6OTV9XSw4NjpbZnVuY3Rpb24odCxpKXtmdW5jdGlvbiBlKHQpe3Q9dHx8MCx0aGlzLmVuZFN0YXRlPW5ldyB2KHQpLHRoaXMuaW5pdFN0YXRlPW5ldyB2LHRoaXMuX2RpbWVuc2lvbnM9MSx0aGlzLl9yZXN0VG9sZXJhbmNlPTFlLTEwLHRoaXMuX2Fic1Jlc3RUb2xlcmFuY2U9dGhpcy5fcmVzdFRvbGVyYW5jZSx0aGlzLl9jYWxsYmFjaz12b2lkIDAsdGhpcy5QRT1uZXcgXyx0aGlzLnBhcnRpY2xlPW5ldyB5LHRoaXMuc3ByaW5nPW5ldyBnKHthbmNob3I6dGhpcy5lbmRTdGF0ZX0pLHRoaXMuUEUuYWRkQm9keSh0aGlzLnBhcnRpY2xlKSx0aGlzLlBFLmF0dGFjaCh0aGlzLnNwcmluZyx0aGlzLnBhcnRpY2xlKX1mdW5jdGlvbiBuKCl7cmV0dXJuIHRoaXMucGFydGljbGUuZ2V0RW5lcmd5KCkrdGhpcy5zcHJpbmcuZ2V0RW5lcmd5KFt0aGlzLnBhcnRpY2xlXSl9ZnVuY3Rpb24gbygpe3ZhciB0PXRoaXMuZW5kU3RhdGUuc3ViKHRoaXMuaW5pdFN0YXRlKS5ub3JtU3F1YXJlZCgpO3RoaXMuX2Fic1Jlc3RUb2xlcmFuY2U9MD09PXQ/dGhpcy5fcmVzdFRvbGVyYW5jZTp0aGlzLl9yZXN0VG9sZXJhbmNlKnR9ZnVuY3Rpb24gcyh0KXt0aGlzLmVuZFN0YXRlLnNldCh0KSxvLmNhbGwodGhpcyl9ZnVuY3Rpb24gcigpe3RoaXMuUEUud2FrZSgpfWZ1bmN0aW9uIGEoKXt0aGlzLlBFLnNsZWVwKCl9ZnVuY3Rpb24gaCh0KXt0aGlzLnBhcnRpY2xlLnBvc2l0aW9uLnNldCh0KX1mdW5jdGlvbiBjKHQpe3RoaXMucGFydGljbGUudmVsb2NpdHkuc2V0KHQpfWZ1bmN0aW9uIHAoKXtyZXR1cm4gMD09PXRoaXMuX2RpbWVuc2lvbnM/dGhpcy5wYXJ0aWNsZS5nZXRQb3NpdGlvbjFEKCk6dGhpcy5wYXJ0aWNsZS5nZXRQb3NpdGlvbigpfWZ1bmN0aW9uIHUoKXtyZXR1cm4gMD09PXRoaXMuX2RpbWVuc2lvbnM/dGhpcy5wYXJ0aWNsZS5nZXRWZWxvY2l0eTFEKCk6dGhpcy5wYXJ0aWNsZS5nZXRWZWxvY2l0eSgpfWZ1bmN0aW9uIGwodCl7dGhpcy5fY2FsbGJhY2s9dH1mdW5jdGlvbiBmKHQpe3ZhciBpPWUuREVGQVVMVF9PUFRJT05TO3ZvaWQgMD09PXQucGVyaW9kJiYodC5wZXJpb2Q9aS5wZXJpb2QpLHZvaWQgMD09PXQuZGFtcGluZ1JhdGlvJiYodC5kYW1waW5nUmF0aW89aS5kYW1waW5nUmF0aW8pLHZvaWQgMD09PXQudmVsb2NpdHkmJih0LnZlbG9jaXR5PWkudmVsb2NpdHkpLHRoaXMuc3ByaW5nLnNldE9wdGlvbnMoe3BlcmlvZDp0LnBlcmlvZCxkYW1waW5nUmF0aW86dC5kYW1waW5nUmF0aW99KSxjLmNhbGwodGhpcyx0LnZlbG9jaXR5KX1mdW5jdGlvbiBkKCl7aWYodGhpcy5QRS5pc1NsZWVwaW5nKCkpe2lmKHRoaXMuX2NhbGxiYWNrKXt2YXIgdD10aGlzLl9jYWxsYmFjazt0aGlzLl9jYWxsYmFjaz12b2lkIDAsdCgpfX1lbHNlIG4uY2FsbCh0aGlzKTx0aGlzLl9hYnNSZXN0VG9sZXJhbmNlJiYoaC5jYWxsKHRoaXMsdGhpcy5lbmRTdGF0ZSksYy5jYWxsKHRoaXMsWzAsMCwwXSksYS5jYWxsKHRoaXMpKX12YXIgXz10KFwiLi4vcGh5c2ljcy9QaHlzaWNzRW5naW5lXCIpLHk9dChcIi4uL3BoeXNpY3MvYm9kaWVzL1BhcnRpY2xlXCIpLGc9dChcIi4uL3BoeXNpY3MvY29uc3RyYWludHMvU25hcFwiKSx2PXQoXCIuLi9tYXRoL1ZlY3RvclwiKTtlLlNVUFBPUlRTX01VTFRJUExFPTMsZS5ERUZBVUxUX09QVElPTlM9e3BlcmlvZDoxMDAsZGFtcGluZ1JhdGlvOi4yLHZlbG9jaXR5OjB9LGUucHJvdG90eXBlLnJlc2V0PWZ1bmN0aW9uKHQsaSl7dGhpcy5fZGltZW5zaW9ucz10IGluc3RhbmNlb2YgQXJyYXk/dC5sZW5ndGg6MCx0aGlzLmluaXRTdGF0ZS5zZXQodCksaC5jYWxsKHRoaXMsdCkscy5jYWxsKHRoaXMsdCksaSYmYy5jYWxsKHRoaXMsaSksbC5jYWxsKHRoaXMsdm9pZCAwKX0sZS5wcm90b3R5cGUuZ2V0VmVsb2NpdHk9ZnVuY3Rpb24oKXtyZXR1cm4gdS5jYWxsKHRoaXMpfSxlLnByb3RvdHlwZS5zZXRWZWxvY2l0eT1mdW5jdGlvbih0KXt0aGlzLmNhbGwodGhpcyxjKHQpKX0sZS5wcm90b3R5cGUuaXNBY3RpdmU9ZnVuY3Rpb24oKXtyZXR1cm4hdGhpcy5QRS5pc1NsZWVwaW5nKCl9LGUucHJvdG90eXBlLmhhbHQ9ZnVuY3Rpb24oKXt0aGlzLnNldCh0aGlzLmdldCgpKX0sZS5wcm90b3R5cGUuZ2V0PWZ1bmN0aW9uKCl7cmV0dXJuIGQuY2FsbCh0aGlzKSxwLmNhbGwodGhpcyl9LGUucHJvdG90eXBlLnNldD1mdW5jdGlvbih0LGksZSl7cmV0dXJuIGk/KHRoaXMuX2RpbWVuc2lvbnM9dCBpbnN0YW5jZW9mIEFycmF5P3QubGVuZ3RoOjAsci5jYWxsKHRoaXMpLGYuY2FsbCh0aGlzLGkpLHMuY2FsbCh0aGlzLHQpLHZvaWQgbC5jYWxsKHRoaXMsZSkpOih0aGlzLnJlc2V0KHQpLHZvaWQoZSYmZSgpKSl9LGkuZXhwb3J0cz1lfSx7XCIuLi9tYXRoL1ZlY3RvclwiOjQxLFwiLi4vcGh5c2ljcy9QaHlzaWNzRW5naW5lXCI6NDgsXCIuLi9waHlzaWNzL2JvZGllcy9QYXJ0aWNsZVwiOjUxLFwiLi4vcGh5c2ljcy9jb25zdHJhaW50cy9TbmFwXCI6NTh9XSw4NzpbZnVuY3Rpb24odCxpKXtmdW5jdGlvbiBlKHQpe3Q9dHx8MCx0aGlzLmVuZFN0YXRlPW5ldyB2KHQpLHRoaXMuaW5pdFN0YXRlPW5ldyB2LHRoaXMuX2RpbWVuc2lvbnM9dm9pZCAwLHRoaXMuX3Jlc3RUb2xlcmFuY2U9MWUtMTAsdGhpcy5fYWJzUmVzdFRvbGVyYW5jZT10aGlzLl9yZXN0VG9sZXJhbmNlLHRoaXMuX2NhbGxiYWNrPXZvaWQgMCx0aGlzLlBFPW5ldyBfLHRoaXMuc3ByaW5nPW5ldyBnKHthbmNob3I6dGhpcy5lbmRTdGF0ZX0pLHRoaXMucGFydGljbGU9bmV3IHksdGhpcy5QRS5hZGRCb2R5KHRoaXMucGFydGljbGUpLHRoaXMuUEUuYXR0YWNoKHRoaXMuc3ByaW5nLHRoaXMucGFydGljbGUpfWZ1bmN0aW9uIG4oKXtyZXR1cm4gdGhpcy5wYXJ0aWNsZS5nZXRFbmVyZ3koKSt0aGlzLnNwcmluZy5nZXRFbmVyZ3koW3RoaXMucGFydGljbGVdKX1mdW5jdGlvbiBvKHQpe3RoaXMucGFydGljbGUuc2V0UG9zaXRpb24odCl9ZnVuY3Rpb24gcyh0KXt0aGlzLnBhcnRpY2xlLnNldFZlbG9jaXR5KHQpfWZ1bmN0aW9uIHIoKXtyZXR1cm4gMD09PXRoaXMuX2RpbWVuc2lvbnM/dGhpcy5wYXJ0aWNsZS5nZXRQb3NpdGlvbjFEKCk6dGhpcy5wYXJ0aWNsZS5nZXRQb3NpdGlvbigpfWZ1bmN0aW9uIGEoKXtyZXR1cm4gMD09PXRoaXMuX2RpbWVuc2lvbnM/dGhpcy5wYXJ0aWNsZS5nZXRWZWxvY2l0eTFEKCk6dGhpcy5wYXJ0aWNsZS5nZXRWZWxvY2l0eSgpfWZ1bmN0aW9uIGgodCl7dGhpcy5fY2FsbGJhY2s9dH1mdW5jdGlvbiBjKCl7dGhpcy5QRS53YWtlKCl9ZnVuY3Rpb24gcCgpe3RoaXMuUEUuc2xlZXAoKX1mdW5jdGlvbiB1KCl7aWYodGhpcy5QRS5pc1NsZWVwaW5nKCkpe2lmKHRoaXMuX2NhbGxiYWNrKXt2YXIgdD10aGlzLl9jYWxsYmFjazt0aGlzLl9jYWxsYmFjaz12b2lkIDAsdCgpfX1lbHNlIG4uY2FsbCh0aGlzKTx0aGlzLl9hYnNSZXN0VG9sZXJhbmNlJiYoby5jYWxsKHRoaXMsdGhpcy5lbmRTdGF0ZSkscy5jYWxsKHRoaXMsWzAsMCwwXSkscC5jYWxsKHRoaXMpKX1mdW5jdGlvbiBsKHQpe3ZhciBpPWUuREVGQVVMVF9PUFRJT05TO3ZvaWQgMD09PXQucGVyaW9kJiYodC5wZXJpb2Q9aS5wZXJpb2QpLHZvaWQgMD09PXQuZGFtcGluZ1JhdGlvJiYodC5kYW1waW5nUmF0aW89aS5kYW1waW5nUmF0aW8pLHZvaWQgMD09PXQudmVsb2NpdHkmJih0LnZlbG9jaXR5PWkudmVsb2NpdHkpLHQucGVyaW9kPDE1MCYmKHQucGVyaW9kPTE1MCxjb25zb2xlLndhcm4oXCJUaGUgcGVyaW9kIG9mIGEgU3ByaW5nVHJhbnNpdGlvbiBpcyBjYXBwZWQgYXQgMTUwIG1zLiBVc2UgYSBTbmFwVHJhbnNpdGlvbiBmb3IgZmFzdGVyIHRyYW5zaXRpb25zXCIpKSx0aGlzLnNwcmluZy5zZXRPcHRpb25zKHtwZXJpb2Q6dC5wZXJpb2QsZGFtcGluZ1JhdGlvOnQuZGFtcGluZ1JhdGlvfSkscy5jYWxsKHRoaXMsdC52ZWxvY2l0eSl9ZnVuY3Rpb24gZigpe3ZhciB0PXRoaXMuZW5kU3RhdGUuc3ViKHRoaXMuaW5pdFN0YXRlKS5ub3JtU3F1YXJlZCgpO3RoaXMuX2Fic1Jlc3RUb2xlcmFuY2U9MD09PXQ/dGhpcy5fcmVzdFRvbGVyYW5jZTp0aGlzLl9yZXN0VG9sZXJhbmNlKnR9ZnVuY3Rpb24gZCh0KXt0aGlzLmVuZFN0YXRlLnNldCh0KSxmLmNhbGwodGhpcyl9dmFyIF89dChcIi4uL3BoeXNpY3MvUGh5c2ljc0VuZ2luZVwiKSx5PXQoXCIuLi9waHlzaWNzL2JvZGllcy9QYXJ0aWNsZVwiKSxnPXQoXCIuLi9waHlzaWNzL2ZvcmNlcy9TcHJpbmdcIiksdj10KFwiLi4vbWF0aC9WZWN0b3JcIik7ZS5TVVBQT1JUU19NVUxUSVBMRT0zLGUuREVGQVVMVF9PUFRJT05TPXtwZXJpb2Q6MzAwLGRhbXBpbmdSYXRpbzouNSx2ZWxvY2l0eTowfSxlLnByb3RvdHlwZS5yZXNldD1mdW5jdGlvbih0LGkpe3RoaXMuX2RpbWVuc2lvbnM9dCBpbnN0YW5jZW9mIEFycmF5P3QubGVuZ3RoOjAsdGhpcy5pbml0U3RhdGUuc2V0KHQpLG8uY2FsbCh0aGlzLHQpLGQuY2FsbCh0aGlzLHQpLGkmJnMuY2FsbCh0aGlzLGkpLGguY2FsbCh0aGlzLHZvaWQgMCl9LGUucHJvdG90eXBlLmdldFZlbG9jaXR5PWZ1bmN0aW9uKCl7cmV0dXJuIGEuY2FsbCh0aGlzKX0sZS5wcm90b3R5cGUuc2V0VmVsb2NpdHk9ZnVuY3Rpb24odCl7dGhpcy5jYWxsKHRoaXMscyh0KSl9LGUucHJvdG90eXBlLmlzQWN0aXZlPWZ1bmN0aW9uKCl7cmV0dXJuIXRoaXMuUEUuaXNTbGVlcGluZygpXG59LGUucHJvdG90eXBlLmhhbHQ9ZnVuY3Rpb24oKXt0aGlzLnNldCh0aGlzLmdldCgpKX0sZS5wcm90b3R5cGUuZ2V0PWZ1bmN0aW9uKCl7cmV0dXJuIHUuY2FsbCh0aGlzKSxyLmNhbGwodGhpcyl9LGUucHJvdG90eXBlLnNldD1mdW5jdGlvbih0LGksZSl7cmV0dXJuIGk/KHRoaXMuX2RpbWVuc2lvbnM9dCBpbnN0YW5jZW9mIEFycmF5P3QubGVuZ3RoOjAsYy5jYWxsKHRoaXMpLGwuY2FsbCh0aGlzLGkpLGQuY2FsbCh0aGlzLHQpLHZvaWQgaC5jYWxsKHRoaXMsZSkpOih0aGlzLnJlc2V0KHQpLHZvaWQoZSYmZSgpKSl9LGkuZXhwb3J0cz1lfSx7XCIuLi9tYXRoL1ZlY3RvclwiOjQxLFwiLi4vcGh5c2ljcy9QaHlzaWNzRW5naW5lXCI6NDgsXCIuLi9waHlzaWNzL2JvZGllcy9QYXJ0aWNsZVwiOjUxLFwiLi4vcGh5c2ljcy9mb3JjZXMvU3ByaW5nXCI6Njh9XSw4ODpbZnVuY3Rpb24odCxpKXtmdW5jdGlvbiBlKHQpe3RoaXMuY3VycmVudEFjdGlvbj1udWxsLHRoaXMuYWN0aW9uUXVldWU9W10sdGhpcy5jYWxsYmFja1F1ZXVlPVtdLHRoaXMuc3RhdGU9MCx0aGlzLnZlbG9jaXR5PXZvaWQgMCx0aGlzLl9jYWxsYmFjaz12b2lkIDAsdGhpcy5fZW5naW5lSW5zdGFuY2U9bnVsbCx0aGlzLl9jdXJyZW50TWV0aG9kPW51bGwsdGhpcy5zZXQodCl9ZnVuY3Rpb24gbigpe2lmKHRoaXMuX2NhbGxiYWNrKXt2YXIgdD10aGlzLl9jYWxsYmFjazt0aGlzLl9jYWxsYmFjaz12b2lkIDAsdCgpfWlmKHRoaXMuYWN0aW9uUXVldWUubGVuZ3RoPD0wKXJldHVybiB2b2lkIHRoaXMuc2V0KHRoaXMuZ2V0KCkpO3RoaXMuY3VycmVudEFjdGlvbj10aGlzLmFjdGlvblF1ZXVlLnNoaWZ0KCksdGhpcy5fY2FsbGJhY2s9dGhpcy5jYWxsYmFja1F1ZXVlLnNoaWZ0KCk7dmFyIGk9bnVsbCxlPXRoaXMuY3VycmVudEFjdGlvblswXSxhPXRoaXMuY3VycmVudEFjdGlvblsxXTthIGluc3RhbmNlb2YgT2JqZWN0JiZhLm1ldGhvZD8oaT1hLm1ldGhvZCxcInN0cmluZ1wiPT10eXBlb2YgaSYmKGk9cltpXSkpOmk9cyx0aGlzLl9jdXJyZW50TWV0aG9kIT09aSYmKHRoaXMuX2VuZ2luZUluc3RhbmNlPSEoZSBpbnN0YW5jZW9mIE9iamVjdCl8fGkuU1VQUE9SVFNfTVVMVElQTEU9PT0hMHx8ZS5sZW5ndGg8PWkuU1VQUE9SVFNfTVVMVElQTEU/bmV3IGk6bmV3IG8oaSksdGhpcy5fY3VycmVudE1ldGhvZD1pKSx0aGlzLl9lbmdpbmVJbnN0YW5jZS5yZXNldCh0aGlzLnN0YXRlLHRoaXMudmVsb2NpdHkpLHZvaWQgMCE9PXRoaXMudmVsb2NpdHkmJihhLnZlbG9jaXR5PXRoaXMudmVsb2NpdHkpLHRoaXMuX2VuZ2luZUluc3RhbmNlLnNldChlLGEsbi5iaW5kKHRoaXMpKX12YXIgbz10KFwiLi9NdWx0aXBsZVRyYW5zaXRpb25cIikscz10KFwiLi9Ud2VlblRyYW5zaXRpb25cIikscj17fTtlLnJlZ2lzdGVyPWZ1bmN0aW9uKHQpe3ZhciBpPSEwO2Zvcih2YXIgbiBpbiB0KWUucmVnaXN0ZXJNZXRob2Qobix0W25dKXx8KGk9ITEpO3JldHVybiBpfSxlLnJlZ2lzdGVyTWV0aG9kPWZ1bmN0aW9uKHQsaSl7cmV0dXJuIHQgaW4gcj8hMTooclt0XT1pLCEwKX0sZS51bnJlZ2lzdGVyTWV0aG9kPWZ1bmN0aW9uKHQpe3JldHVybiB0IGluIHI/KGRlbGV0ZSByW3RdLCEwKTohMX0sZS5wcm90b3R5cGUuc2V0PWZ1bmN0aW9uKHQsaSxlKXtpZighaSlyZXR1cm4gdGhpcy5yZXNldCh0KSxlJiZlKCksdGhpczt2YXIgbz1bdCxpXTtyZXR1cm4gdGhpcy5hY3Rpb25RdWV1ZS5wdXNoKG8pLHRoaXMuY2FsbGJhY2tRdWV1ZS5wdXNoKGUpLHRoaXMuY3VycmVudEFjdGlvbnx8bi5jYWxsKHRoaXMpLHRoaXN9LGUucHJvdG90eXBlLnJlc2V0PWZ1bmN0aW9uKHQsaSl7dGhpcy5fY3VycmVudE1ldGhvZD1udWxsLHRoaXMuX2VuZ2luZUluc3RhbmNlPW51bGwsdGhpcy5fY2FsbGJhY2s9dm9pZCAwLHRoaXMuc3RhdGU9dCx0aGlzLnZlbG9jaXR5PWksdGhpcy5jdXJyZW50QWN0aW9uPW51bGwsdGhpcy5hY3Rpb25RdWV1ZT1bXSx0aGlzLmNhbGxiYWNrUXVldWU9W119LGUucHJvdG90eXBlLmRlbGF5PWZ1bmN0aW9uKHQsaSl7dGhpcy5zZXQodGhpcy5nZXQoKSx7ZHVyYXRpb246dCxjdXJ2ZTpmdW5jdGlvbigpe3JldHVybiAwfX0saSl9LGUucHJvdG90eXBlLmdldD1mdW5jdGlvbih0KXtyZXR1cm4gdGhpcy5fZW5naW5lSW5zdGFuY2UmJih0aGlzLl9lbmdpbmVJbnN0YW5jZS5nZXRWZWxvY2l0eSYmKHRoaXMudmVsb2NpdHk9dGhpcy5fZW5naW5lSW5zdGFuY2UuZ2V0VmVsb2NpdHkoKSksdGhpcy5zdGF0ZT10aGlzLl9lbmdpbmVJbnN0YW5jZS5nZXQodCkpLHRoaXMuc3RhdGV9LGUucHJvdG90eXBlLmlzQWN0aXZlPWZ1bmN0aW9uKCl7cmV0dXJuISF0aGlzLmN1cnJlbnRBY3Rpb259LGUucHJvdG90eXBlLmhhbHQ9ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5zZXQodGhpcy5nZXQoKSl9LGkuZXhwb3J0cz1lfSx7XCIuL011bHRpcGxlVHJhbnNpdGlvblwiOjg1LFwiLi9Ud2VlblRyYW5zaXRpb25cIjo5MH1dLDg5OltmdW5jdGlvbih0LGkpe2Z1bmN0aW9uIGUodCl7dGhpcy5fZmluYWw9ci5pZGVudGl0eS5zbGljZSgpLHRoaXMuX2ZpbmFsVHJhbnNsYXRlPVswLDAsMF0sdGhpcy5fZmluYWxSb3RhdGU9WzAsMCwwXSx0aGlzLl9maW5hbFNrZXc9WzAsMCwwXSx0aGlzLl9maW5hbFNjYWxlPVsxLDEsMV0sdGhpcy50cmFuc2xhdGU9bmV3IHModGhpcy5fZmluYWxUcmFuc2xhdGUpLHRoaXMucm90YXRlPW5ldyBzKHRoaXMuX2ZpbmFsUm90YXRlKSx0aGlzLnNrZXc9bmV3IHModGhpcy5fZmluYWxTa2V3KSx0aGlzLnNjYWxlPW5ldyBzKHRoaXMuX2ZpbmFsU2NhbGUpLHQmJnRoaXMuc2V0KHQpfWZ1bmN0aW9uIG4oKXtyZXR1cm4gci5idWlsZCh7dHJhbnNsYXRlOnRoaXMudHJhbnNsYXRlLmdldCgpLHJvdGF0ZTp0aGlzLnJvdGF0ZS5nZXQoKSxza2V3OnRoaXMuc2tldy5nZXQoKSxzY2FsZTp0aGlzLnNjYWxlLmdldCgpfSl9ZnVuY3Rpb24gbygpe3JldHVybiByLmJ1aWxkKHt0cmFuc2xhdGU6dGhpcy5fZmluYWxUcmFuc2xhdGUscm90YXRlOnRoaXMuX2ZpbmFsUm90YXRlLHNrZXc6dGhpcy5fZmluYWxTa2V3LHNjYWxlOnRoaXMuX2ZpbmFsU2NhbGV9KX12YXIgcz10KFwiLi9UcmFuc2l0aW9uYWJsZVwiKSxyPXQoXCIuLi9jb3JlL1RyYW5zZm9ybVwiKSxhPXQoXCIuLi91dGlsaXRpZXMvVXRpbGl0eVwiKTtlLnByb3RvdHlwZS5zZXRUcmFuc2xhdGU9ZnVuY3Rpb24odCxpLGUpe3JldHVybiB0aGlzLl9maW5hbFRyYW5zbGF0ZT10LHRoaXMuX2ZpbmFsPW8uY2FsbCh0aGlzKSx0aGlzLnRyYW5zbGF0ZS5zZXQodCxpLGUpLHRoaXN9LGUucHJvdG90eXBlLnNldFNjYWxlPWZ1bmN0aW9uKHQsaSxlKXtyZXR1cm4gdGhpcy5fZmluYWxTY2FsZT10LHRoaXMuX2ZpbmFsPW8uY2FsbCh0aGlzKSx0aGlzLnNjYWxlLnNldCh0LGksZSksdGhpc30sZS5wcm90b3R5cGUuc2V0Um90YXRlPWZ1bmN0aW9uKHQsaSxlKXtyZXR1cm4gdGhpcy5fZmluYWxSb3RhdGU9dCx0aGlzLl9maW5hbD1vLmNhbGwodGhpcyksdGhpcy5yb3RhdGUuc2V0KHQsaSxlKSx0aGlzfSxlLnByb3RvdHlwZS5zZXRTa2V3PWZ1bmN0aW9uKHQsaSxlKXtyZXR1cm4gdGhpcy5fZmluYWxTa2V3PXQsdGhpcy5fZmluYWw9by5jYWxsKHRoaXMpLHRoaXMuc2tldy5zZXQodCxpLGUpLHRoaXN9LGUucHJvdG90eXBlLnNldD1mdW5jdGlvbih0LGksZSl7dmFyIG49ci5pbnRlcnByZXQodCk7dGhpcy5fZmluYWxUcmFuc2xhdGU9bi50cmFuc2xhdGUsdGhpcy5fZmluYWxSb3RhdGU9bi5yb3RhdGUsdGhpcy5fZmluYWxTa2V3PW4uc2tldyx0aGlzLl9maW5hbFNjYWxlPW4uc2NhbGUsdGhpcy5fZmluYWw9dDt2YXIgbz1lP2EuYWZ0ZXIoNCxlKTpudWxsO3JldHVybiB0aGlzLnRyYW5zbGF0ZS5zZXQobi50cmFuc2xhdGUsaSxvKSx0aGlzLnJvdGF0ZS5zZXQobi5yb3RhdGUsaSxvKSx0aGlzLnNrZXcuc2V0KG4uc2tldyxpLG8pLHRoaXMuc2NhbGUuc2V0KG4uc2NhbGUsaSxvKSx0aGlzfSxlLnByb3RvdHlwZS5zZXREZWZhdWx0VHJhbnNpdGlvbj1mdW5jdGlvbih0KXt0aGlzLnRyYW5zbGF0ZS5zZXREZWZhdWx0KHQpLHRoaXMucm90YXRlLnNldERlZmF1bHQodCksdGhpcy5za2V3LnNldERlZmF1bHQodCksdGhpcy5zY2FsZS5zZXREZWZhdWx0KHQpfSxlLnByb3RvdHlwZS5nZXQ9ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5pc0FjdGl2ZSgpP24uY2FsbCh0aGlzKTp0aGlzLl9maW5hbH0sZS5wcm90b3R5cGUuZ2V0RmluYWw9ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5fZmluYWx9LGUucHJvdG90eXBlLmlzQWN0aXZlPWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMudHJhbnNsYXRlLmlzQWN0aXZlKCl8fHRoaXMucm90YXRlLmlzQWN0aXZlKCl8fHRoaXMuc2NhbGUuaXNBY3RpdmUoKXx8dGhpcy5za2V3LmlzQWN0aXZlKCl9LGUucHJvdG90eXBlLmhhbHQ9ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy50cmFuc2xhdGUuaGFsdCgpLHRoaXMucm90YXRlLmhhbHQoKSx0aGlzLnNrZXcuaGFsdCgpLHRoaXMuc2NhbGUuaGFsdCgpLHRoaXMuX2ZpbmFsPXRoaXMuZ2V0KCksdGhpcy5fZmluYWxUcmFuc2xhdGU9dGhpcy50cmFuc2xhdGUuZ2V0KCksdGhpcy5fZmluYWxSb3RhdGU9dGhpcy5yb3RhdGUuZ2V0KCksdGhpcy5fZmluYWxTa2V3PXRoaXMuc2tldy5nZXQoKSx0aGlzLl9maW5hbFNjYWxlPXRoaXMuc2NhbGUuZ2V0KCksdGhpc30saS5leHBvcnRzPWV9LHtcIi4uL2NvcmUvVHJhbnNmb3JtXCI6MTUsXCIuLi91dGlsaXRpZXMvVXRpbGl0eVwiOjk1LFwiLi9UcmFuc2l0aW9uYWJsZVwiOjg4fV0sOTA6W2Z1bmN0aW9uKHQsaSl7ZnVuY3Rpb24gZSh0KXt0aGlzLm9wdGlvbnM9T2JqZWN0LmNyZWF0ZShlLkRFRkFVTFRfT1BUSU9OUyksdCYmdGhpcy5zZXRPcHRpb25zKHQpLHRoaXMuX3N0YXJ0VGltZT0wLHRoaXMuX3N0YXJ0VmFsdWU9MCx0aGlzLl91cGRhdGVUaW1lPTAsdGhpcy5fZW5kVmFsdWU9MCx0aGlzLl9jdXJ2ZT12b2lkIDAsdGhpcy5fZHVyYXRpb249MCx0aGlzLl9hY3RpdmU9ITEsdGhpcy5fY2FsbGJhY2s9dm9pZCAwLHRoaXMuc3RhdGU9MCx0aGlzLnZlbG9jaXR5PXZvaWQgMH1mdW5jdGlvbiBuKHQsaSxlKXtyZXR1cm4oMS1lKSp0K2UqaX1mdW5jdGlvbiBvKHQpe3JldHVybiB0IGluc3RhbmNlb2YgT2JqZWN0P3QgaW5zdGFuY2VvZiBBcnJheT90LnNsaWNlKDApOk9iamVjdC5jcmVhdGUodCk6dH1mdW5jdGlvbiBzKHQsaSl7dmFyIG49e2N1cnZlOmkuY3VydmV9O3JldHVybiBpLmR1cmF0aW9uJiYobi5kdXJhdGlvbj1pLmR1cmF0aW9uKSxpLnNwZWVkJiYobi5zcGVlZD1pLnNwZWVkKSx0IGluc3RhbmNlb2YgT2JqZWN0JiYodm9pZCAwIT09dC5kdXJhdGlvbiYmKG4uZHVyYXRpb249dC5kdXJhdGlvbiksdC5jdXJ2ZSYmKG4uY3VydmU9dC5jdXJ2ZSksdC5zcGVlZCYmKG4uc3BlZWQ9dC5zcGVlZCkpLFwic3RyaW5nXCI9PXR5cGVvZiBuLmN1cnZlJiYobi5jdXJ2ZT1lLmdldEN1cnZlKG4uY3VydmUpKSxufWZ1bmN0aW9uIHIodCxpLGUsbixvKXt2YXIgcyxyPTFlLTcsYT0oZShvKS1lKG8tcikpL3I7aWYodCBpbnN0YW5jZW9mIEFycmF5KXtzPVtdO2Zvcih2YXIgaD0wO2g8dC5sZW5ndGg7aCsrKXNbaF09XCJudW1iZXJcIj09dHlwZW9mIHRbaF0/YSoodFtoXS1pW2hdKS9uOjB9ZWxzZSBzPWEqKHQtaSkvbjtyZXR1cm4gc31mdW5jdGlvbiBhKHQsaSxlKXt2YXIgbztpZih0IGluc3RhbmNlb2YgQXJyYXkpe289W107Zm9yKHZhciBzPTA7czx0Lmxlbmd0aDtzKyspb1tzXT1cIm51bWJlclwiPT10eXBlb2YgdFtzXT9uKHRbc10saVtzXSxlKTp0W3NdfWVsc2Ugbz1uKHQsaSxlKTtyZXR1cm4gb31lLkN1cnZlcz17bGluZWFyOmZ1bmN0aW9uKHQpe3JldHVybiB0fSxlYXNlSW46ZnVuY3Rpb24odCl7cmV0dXJuIHQqdH0sZWFzZU91dDpmdW5jdGlvbih0KXtyZXR1cm4gdCooMi10KX0sZWFzZUluT3V0OmZ1bmN0aW9uKHQpe3JldHVybi41Pj10PzIqdCp0Oi0yKnQqdCs0KnQtMX0sZWFzZU91dEJvdW5jZTpmdW5jdGlvbih0KXtyZXR1cm4gdCooMy0yKnQpfSxzcHJpbmc6ZnVuY3Rpb24odCl7cmV0dXJuKDEtdCkqTWF0aC5zaW4oNipNYXRoLlBJKnQpK3R9fSxlLlNVUFBPUlRTX01VTFRJUExFPSEwLGUuREVGQVVMVF9PUFRJT05TPXtjdXJ2ZTplLkN1cnZlcy5saW5lYXIsZHVyYXRpb246NTAwLHNwZWVkOjB9O3ZhciBoPXt9O2UucmVnaXN0ZXJDdXJ2ZT1mdW5jdGlvbih0LGkpe3JldHVybiBoW3RdPyExOihoW3RdPWksITApfSxlLnVucmVnaXN0ZXJDdXJ2ZT1mdW5jdGlvbih0KXtyZXR1cm4gaFt0XT8oZGVsZXRlIGhbdF0sITApOiExfSxlLmdldEN1cnZlPWZ1bmN0aW9uKHQpe3ZhciBpPWhbdF07aWYodm9pZCAwIT09aSlyZXR1cm4gaTt0aHJvdyBuZXcgRXJyb3IoXCJjdXJ2ZSBub3QgcmVnaXN0ZXJlZFwiKX0sZS5nZXRDdXJ2ZXM9ZnVuY3Rpb24oKXtyZXR1cm4gaH0sZS5wcm90b3R5cGUuc2V0T3B0aW9ucz1mdW5jdGlvbih0KXt2b2lkIDAhPT10LmN1cnZlJiYodGhpcy5vcHRpb25zLmN1cnZlPXQuY3VydmUpLHZvaWQgMCE9PXQuZHVyYXRpb24mJih0aGlzLm9wdGlvbnMuZHVyYXRpb249dC5kdXJhdGlvbiksdm9pZCAwIT09dC5zcGVlZCYmKHRoaXMub3B0aW9ucy5zcGVlZD10LnNwZWVkKX0sZS5wcm90b3R5cGUuc2V0PWZ1bmN0aW9uKHQsaSxlKXtpZighaSlyZXR1cm4gdGhpcy5yZXNldCh0KSx2b2lkKGUmJmUoKSk7aWYodGhpcy5fc3RhcnRWYWx1ZT1vKHRoaXMuZ2V0KCkpLGk9cyhpLHRoaXMub3B0aW9ucyksaS5zcGVlZCl7dmFyIG49dGhpcy5fc3RhcnRWYWx1ZTtpZihuIGluc3RhbmNlb2YgT2JqZWN0KXt2YXIgcj0wO2Zvcih2YXIgYSBpbiBuKXIrPSh0W2FdLW5bYV0pKih0W2FdLW5bYV0pO2kuZHVyYXRpb249TWF0aC5zcXJ0KHIpL2kuc3BlZWR9ZWxzZSBpLmR1cmF0aW9uPU1hdGguYWJzKHQtbikvaS5zcGVlZH10aGlzLl9zdGFydFRpbWU9RGF0ZS5ub3coKSx0aGlzLl9lbmRWYWx1ZT1vKHQpLHRoaXMuX3N0YXJ0VmVsb2NpdHk9byhpLnZlbG9jaXR5KSx0aGlzLl9kdXJhdGlvbj1pLmR1cmF0aW9uLHRoaXMuX2N1cnZlPWkuY3VydmUsdGhpcy5fYWN0aXZlPSEwLHRoaXMuX2NhbGxiYWNrPWV9LGUucHJvdG90eXBlLnJlc2V0PWZ1bmN0aW9uKHQsaSl7aWYodGhpcy5fY2FsbGJhY2spe3ZhciBlPXRoaXMuX2NhbGxiYWNrO3RoaXMuX2NhbGxiYWNrPXZvaWQgMCxlKCl9dGhpcy5zdGF0ZT1vKHQpLHRoaXMudmVsb2NpdHk9byhpKSx0aGlzLl9zdGFydFRpbWU9MCx0aGlzLl9kdXJhdGlvbj0wLHRoaXMuX3VwZGF0ZVRpbWU9MCx0aGlzLl9zdGFydFZhbHVlPXRoaXMuc3RhdGUsdGhpcy5fc3RhcnRWZWxvY2l0eT10aGlzLnZlbG9jaXR5LHRoaXMuX2VuZFZhbHVlPXRoaXMuc3RhdGUsdGhpcy5fYWN0aXZlPSExfSxlLnByb3RvdHlwZS5nZXRWZWxvY2l0eT1mdW5jdGlvbigpe3JldHVybiB0aGlzLnZlbG9jaXR5fSxlLnByb3RvdHlwZS5nZXQ9ZnVuY3Rpb24odCl7cmV0dXJuIHRoaXMudXBkYXRlKHQpLHRoaXMuc3RhdGV9LGUucHJvdG90eXBlLnVwZGF0ZT1mdW5jdGlvbih0KXtpZih0aGlzLl9hY3RpdmUpe2lmKHR8fCh0PURhdGUubm93KCkpLCEodGhpcy5fdXBkYXRlVGltZT49dCkpe3RoaXMuX3VwZGF0ZVRpbWU9dDt2YXIgaT10LXRoaXMuX3N0YXJ0VGltZTtpZihpPj10aGlzLl9kdXJhdGlvbil0aGlzLnN0YXRlPXRoaXMuX2VuZFZhbHVlLHRoaXMudmVsb2NpdHk9cih0aGlzLnN0YXRlLHRoaXMuX3N0YXJ0VmFsdWUsdGhpcy5fY3VydmUsdGhpcy5fZHVyYXRpb24sMSksdGhpcy5fYWN0aXZlPSExO2Vsc2UgaWYoMD5pKXRoaXMuc3RhdGU9dGhpcy5fc3RhcnRWYWx1ZSx0aGlzLnZlbG9jaXR5PXRoaXMuX3N0YXJ0VmVsb2NpdHk7ZWxzZXt2YXIgZT1pL3RoaXMuX2R1cmF0aW9uO3RoaXMuc3RhdGU9YSh0aGlzLl9zdGFydFZhbHVlLHRoaXMuX2VuZFZhbHVlLHRoaXMuX2N1cnZlKGUpKSx0aGlzLnZlbG9jaXR5PXIodGhpcy5zdGF0ZSx0aGlzLl9zdGFydFZhbHVlLHRoaXMuX2N1cnZlLHRoaXMuX2R1cmF0aW9uLGUpfX19ZWxzZSBpZih0aGlzLl9jYWxsYmFjayl7dmFyIG49dGhpcy5fY2FsbGJhY2s7dGhpcy5fY2FsbGJhY2s9dm9pZCAwLG4oKX19LGUucHJvdG90eXBlLmlzQWN0aXZlPWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuX2FjdGl2ZX0sZS5wcm90b3R5cGUuaGFsdD1mdW5jdGlvbigpe3RoaXMucmVzZXQodGhpcy5nZXQoKSl9LGUucmVnaXN0ZXJDdXJ2ZShcImxpbmVhclwiLGUuQ3VydmVzLmxpbmVhciksZS5yZWdpc3RlckN1cnZlKFwiZWFzZUluXCIsZS5DdXJ2ZXMuZWFzZUluKSxlLnJlZ2lzdGVyQ3VydmUoXCJlYXNlT3V0XCIsZS5DdXJ2ZXMuZWFzZU91dCksZS5yZWdpc3RlckN1cnZlKFwiZWFzZUluT3V0XCIsZS5DdXJ2ZXMuZWFzZUluT3V0KSxlLnJlZ2lzdGVyQ3VydmUoXCJlYXNlT3V0Qm91bmNlXCIsZS5DdXJ2ZXMuZWFzZU91dEJvdW5jZSksZS5yZWdpc3RlckN1cnZlKFwic3ByaW5nXCIsZS5DdXJ2ZXMuc3ByaW5nKSxlLmN1c3RvbUN1cnZlPWZ1bmN0aW9uKHQsaSl7cmV0dXJuIHQ9dHx8MCxpPWl8fDAsZnVuY3Rpb24oZSl7cmV0dXJuIHQqZSsoLTIqdC1pKzMpKmUqZSsodCtpLTIpKmUqZSplfX0saS5leHBvcnRzPWV9LHt9XSw5MTpbZnVuY3Rpb24odCxpKXtmdW5jdGlvbiBlKHQpe3Q9dHx8MCx0aGlzLmVuZFN0YXRlPW5ldyBtKHQpLHRoaXMuaW5pdFN0YXRlPW5ldyBtLHRoaXMuc3ByaW5nPW5ldyBnKHthbmNob3I6dGhpcy5lbmRTdGF0ZX0pLHRoaXMud2FsbD1uZXcgdix0aGlzLl9yZXN0VG9sZXJhbmNlPTFlLTEwLHRoaXMuX2RpbWVuc2lvbnM9MSx0aGlzLl9hYnNSZXN0VG9sZXJhbmNlPXRoaXMuX3Jlc3RUb2xlcmFuY2UsdGhpcy5fY2FsbGJhY2s9dm9pZCAwLHRoaXMuUEU9bmV3IF8sdGhpcy5wYXJ0aWNsZT1uZXcgeSx0aGlzLlBFLmFkZEJvZHkodGhpcy5wYXJ0aWNsZSksdGhpcy5QRS5hdHRhY2goW3RoaXMud2FsbCx0aGlzLnNwcmluZ10sdGhpcy5wYXJ0aWNsZSl9ZnVuY3Rpb24gbigpe3JldHVybiB0aGlzLnBhcnRpY2xlLmdldEVuZXJneSgpK3RoaXMuc3ByaW5nLmdldEVuZXJneShbdGhpcy5wYXJ0aWNsZV0pfWZ1bmN0aW9uIG8oKXt2YXIgdD10aGlzLmVuZFN0YXRlLnN1Yih0aGlzLmluaXRTdGF0ZSkubm9ybVNxdWFyZWQoKTt0aGlzLl9hYnNSZXN0VG9sZXJhbmNlPTA9PT10P3RoaXMuX3Jlc3RUb2xlcmFuY2U6dGhpcy5fcmVzdFRvbGVyYW5jZSp0fWZ1bmN0aW9uIHMoKXt0aGlzLlBFLndha2UoKX1mdW5jdGlvbiByKCl7dGhpcy5QRS5zbGVlcCgpfWZ1bmN0aW9uIGEodCl7dGhpcy5lbmRTdGF0ZS5zZXQodCk7dmFyIGk9dGhpcy5lbmRTdGF0ZS5zdWIodGhpcy5pbml0U3RhdGUpLm5vcm0oKTt0aGlzLndhbGwuc2V0T3B0aW9ucyh7ZGlzdGFuY2U6dGhpcy5lbmRTdGF0ZS5ub3JtKCksbm9ybWFsOjA9PT1pP3RoaXMucGFydGljbGUudmVsb2NpdHkubm9ybWFsaXplKC0xKTp0aGlzLmVuZFN0YXRlLnN1Yih0aGlzLmluaXRTdGF0ZSkubm9ybWFsaXplKC0xKX0pLG8uY2FsbCh0aGlzKX1mdW5jdGlvbiBoKHQpe3RoaXMucGFydGljbGUucG9zaXRpb24uc2V0KHQpfWZ1bmN0aW9uIGModCl7dGhpcy5wYXJ0aWNsZS52ZWxvY2l0eS5zZXQodCl9ZnVuY3Rpb24gcCgpe3JldHVybiAwPT09dGhpcy5fZGltZW5zaW9ucz90aGlzLnBhcnRpY2xlLmdldFBvc2l0aW9uMUQoKTp0aGlzLnBhcnRpY2xlLmdldFBvc2l0aW9uKCl9ZnVuY3Rpb24gdSgpe3JldHVybiAwPT09dGhpcy5fZGltZW5zaW9ucz90aGlzLnBhcnRpY2xlLmdldFZlbG9jaXR5MUQoKTp0aGlzLnBhcnRpY2xlLmdldFZlbG9jaXR5KCl9ZnVuY3Rpb24gbCh0KXt0aGlzLl9jYWxsYmFjaz10fWZ1bmN0aW9uIGYoKXtpZih0aGlzLlBFLmlzU2xlZXBpbmcoKSl7aWYodGhpcy5fY2FsbGJhY2spe3ZhciB0PXRoaXMuX2NhbGxiYWNrO3RoaXMuX2NhbGxiYWNrPXZvaWQgMCx0KCl9fWVsc2V7dmFyIGk9bi5jYWxsKHRoaXMpO2k8dGhpcy5fYWJzUmVzdFRvbGVyYW5jZSYmKHIuY2FsbCh0aGlzKSxoLmNhbGwodGhpcyx0aGlzLmVuZFN0YXRlKSxjLmNhbGwodGhpcyxbMCwwLDBdKSl9fWZ1bmN0aW9uIGQodCl7dmFyIGk9ZS5ERUZBVUxUX09QVElPTlM7dm9pZCAwPT09dC5wZXJpb2QmJih0LnBlcmlvZD1pLnBlcmlvZCksdm9pZCAwPT09dC5kYW1waW5nUmF0aW8mJih0LmRhbXBpbmdSYXRpbz1pLmRhbXBpbmdSYXRpbyksdm9pZCAwPT09dC52ZWxvY2l0eSYmKHQudmVsb2NpdHk9aS52ZWxvY2l0eSksdm9pZCAwPT09dC5yZXN0aXR1dGlvbiYmKHQucmVzdGl0dXRpb249aS5yZXN0aXR1dGlvbiksdGhpcy5zcHJpbmcuc2V0T3B0aW9ucyh7cGVyaW9kOnQucGVyaW9kLGRhbXBpbmdSYXRpbzp0LmRhbXBpbmdSYXRpb30pLHRoaXMud2FsbC5zZXRPcHRpb25zKHtyZXN0aXR1dGlvbjp0LnJlc3RpdHV0aW9ufSksYy5jYWxsKHRoaXMsdC52ZWxvY2l0eSl9dmFyIF89dChcIi4uL3BoeXNpY3MvUGh5c2ljc0VuZ2luZVwiKSx5PXQoXCIuLi9waHlzaWNzL2JvZGllcy9QYXJ0aWNsZVwiKSxnPXQoXCIuLi9waHlzaWNzL2ZvcmNlcy9TcHJpbmdcIiksdj10KFwiLi4vcGh5c2ljcy9jb25zdHJhaW50cy9XYWxsXCIpLG09dChcIi4uL21hdGgvVmVjdG9yXCIpO2UuU1VQUE9SVFNfTVVMVElQTEU9MyxlLkRFRkFVTFRfT1BUSU9OUz17cGVyaW9kOjMwMCxkYW1waW5nUmF0aW86LjUsdmVsb2NpdHk6MCxyZXN0aXR1dGlvbjouNX0sZS5wcm90b3R5cGUucmVzZXQ9ZnVuY3Rpb24odCxpKXt0aGlzLl9kaW1lbnNpb25zPXQgaW5zdGFuY2VvZiBBcnJheT90Lmxlbmd0aDowLHRoaXMuaW5pdFN0YXRlLnNldCh0KSxoLmNhbGwodGhpcyx0KSxpJiZjLmNhbGwodGhpcyxpKSxhLmNhbGwodGhpcyx0KSxsLmNhbGwodGhpcyx2b2lkIDApfSxlLnByb3RvdHlwZS5nZXRWZWxvY2l0eT1mdW5jdGlvbigpe3JldHVybiB1LmNhbGwodGhpcyl9LGUucHJvdG90eXBlLnNldFZlbG9jaXR5PWZ1bmN0aW9uKHQpe3RoaXMuY2FsbCh0aGlzLGModCkpfSxlLnByb3RvdHlwZS5pc0FjdGl2ZT1mdW5jdGlvbigpe3JldHVybiF0aGlzLlBFLmlzU2xlZXBpbmcoKX0sZS5wcm90b3R5cGUuaGFsdD1mdW5jdGlvbigpe3RoaXMuc2V0KHRoaXMuZ2V0KCkpfSxlLnByb3RvdHlwZS5nZXQ9ZnVuY3Rpb24oKXtyZXR1cm4gZi5jYWxsKHRoaXMpLHAuY2FsbCh0aGlzKX0sZS5wcm90b3R5cGUuc2V0PWZ1bmN0aW9uKHQsaSxlKXtyZXR1cm4gaT8odGhpcy5fZGltZW5zaW9ucz10IGluc3RhbmNlb2YgQXJyYXk/dC5sZW5ndGg6MCxzLmNhbGwodGhpcyksZC5jYWxsKHRoaXMsaSksYS5jYWxsKHRoaXMsdCksdm9pZCBsLmNhbGwodGhpcyxlKSk6KHRoaXMucmVzZXQodCksdm9pZChlJiZlKCkpKX0saS5leHBvcnRzPWV9LHtcIi4uL21hdGgvVmVjdG9yXCI6NDEsXCIuLi9waHlzaWNzL1BoeXNpY3NFbmdpbmVcIjo0OCxcIi4uL3BoeXNpY3MvYm9kaWVzL1BhcnRpY2xlXCI6NTEsXCIuLi9waHlzaWNzL2NvbnN0cmFpbnRzL1dhbGxcIjo2MCxcIi4uL3BoeXNpY3MvZm9yY2VzL1NwcmluZ1wiOjY4fV0sOTI6W2Z1bmN0aW9uKHQsaSl7aS5leHBvcnRzPXtDYWNoZWRNYXA6dChcIi4vQ2FjaGVkTWFwXCIpLEVhc2luZzp0KFwiLi9FYXNpbmdcIiksTXVsdGlwbGVUcmFuc2l0aW9uOnQoXCIuL011bHRpcGxlVHJhbnNpdGlvblwiKSxTbmFwVHJhbnNpdGlvbjp0KFwiLi9TbmFwVHJhbnNpdGlvblwiKSxTcHJpbmdUcmFuc2l0aW9uOnQoXCIuL1NwcmluZ1RyYW5zaXRpb25cIiksVHJhbnNpdGlvbmFibGU6dChcIi4vVHJhbnNpdGlvbmFibGVcIiksVHJhbnNpdGlvbmFibGVUcmFuc2Zvcm06dChcIi4vVHJhbnNpdGlvbmFibGVUcmFuc2Zvcm1cIiksVHdlZW5UcmFuc2l0aW9uOnQoXCIuL1R3ZWVuVHJhbnNpdGlvblwiKSxXYWxsVHJhbnNpdGlvbjp0KFwiLi9XYWxsVHJhbnNpdGlvblwiKX19LHtcIi4vQ2FjaGVkTWFwXCI6ODMsXCIuL0Vhc2luZ1wiOjg0LFwiLi9NdWx0aXBsZVRyYW5zaXRpb25cIjo4NSxcIi4vU25hcFRyYW5zaXRpb25cIjo4NixcIi4vU3ByaW5nVHJhbnNpdGlvblwiOjg3LFwiLi9UcmFuc2l0aW9uYWJsZVwiOjg4LFwiLi9UcmFuc2l0aW9uYWJsZVRyYW5zZm9ybVwiOjg5LFwiLi9Ud2VlblRyYW5zaXRpb25cIjo5MCxcIi4vV2FsbFRyYW5zaXRpb25cIjo5MX1dLDkzOltmdW5jdGlvbih0LGkpe3ZhciBlPXswOjQ4LDE6NDksMjo1MCwzOjUxLDQ6NTIsNTo1Myw2OjU0LDc6NTUsODo1Niw5OjU3LGE6OTcsYjo5OCxjOjk5LGQ6MTAwLGU6MTAxLGY6MTAyLGc6MTAzLGg6MTA0LGk6MTA1LGo6MTA2LGs6MTA3LGw6MTA4LG06MTA5LG46MTEwLG86MTExLHA6MTEyLHE6MTEzLHI6MTE0LHM6MTE1LHQ6MTE2LHU6MTE3LHY6MTE4LHc6MTE5LHg6MTIwLHk6MTIxLHo6MTIyLEE6NjUsQjo2NixDOjY3LEQ6NjgsRTo2OSxGOjcwLEc6NzEsSDo3MixJOjczLEo6NzQsSzo3NSxMOjc2LE06NzcsTjo3OCxPOjc5LFA6ODAsUTo4MSxSOjgyLFM6ODMsVDo4NCxVOjg1LFY6ODYsVzo4NyxYOjg4LFk6ODksWjo5MCxFTlRFUjoxMyxMRUZUX0FSUk9XOjM3LFJJR0hUX0FSUk9XOjM5LFVQX0FSUk9XOjM4LERPV05fQVJST1c6NDAsU1BBQ0U6MzIsU0hJRlQ6MTYsVEFCOjl9O2kuZXhwb3J0cz1lfSx7fV0sOTQ6W2Z1bmN0aW9uKHQsaSl7ZnVuY3Rpb24gZSh0KXtyZXR1cm4gYy5vbihwLHQpLHR9ZnVuY3Rpb24gbih0LGkpe3ZhciBuPXUoKSxvPWZ1bmN0aW9uKCl7dmFyIGU9dSgpO2Utbj49aSYmKHQuYXBwbHkodGhpcyxhcmd1bWVudHMpLGMucmVtb3ZlTGlzdGVuZXIocCxvKSl9O3JldHVybiBlKG8pfWZ1bmN0aW9uIG8odCxpKXt2YXIgbj11KCksbz1mdW5jdGlvbigpe3ZhciBlPXUoKTtlLW4+PWkmJih0LmFwcGx5KHRoaXMsYXJndW1lbnRzKSxuPXUoKSl9O3JldHVybiBlKG8pfWZ1bmN0aW9uIHModCxpKXtpZih2b2lkIDA9PT1pKXJldHVybiB2b2lkIDA7dmFyIG49ZnVuY3Rpb24oKXtpLS0sMD49aSYmKHQuYXBwbHkodGhpcyxhcmd1bWVudHMpLGEobikpfTtyZXR1cm4gZShuKX1mdW5jdGlvbiByKHQsaSl7aT1pfHwxO3ZhciBuPWksbz1mdW5jdGlvbigpe2ktLSwwPj1pJiYodC5hcHBseSh0aGlzLGFyZ3VtZW50cyksaT1uKX07cmV0dXJuIGUobyl9ZnVuY3Rpb24gYSh0KXtjLnJlbW92ZUxpc3RlbmVyKHAsdCl9ZnVuY3Rpb24gaCh0LGkpe3ZhciBlLG8scyxyLGg7cmV0dXJuIGZ1bmN0aW9uKCl7bz10aGlzLGg9YXJndW1lbnRzLHM9dSgpO3ZhciBjPWZ1bmN0aW9uKCl7dmFyIGE9dS1zO2k+YT9lPW4oYyxpLWEpOihlPW51bGwscj10LmFwcGx5KG8saCkpfTtyZXR1cm4gYShlKSxlPW4oYyxpKSxyfX12YXIgYz10KFwiLi4vY29yZS9FbmdpbmVcIikscD1cInByZXJlbmRlclwiLHU9d2luZG93LnBlcmZvcm1hbmNlJiZ3aW5kb3cucGVyZm9ybWFuY2Uubm93P2Z1bmN0aW9uKCl7cmV0dXJuIHdpbmRvdy5wZXJmb3JtYW5jZS5ub3coKX06ZnVuY3Rpb24oKXtyZXR1cm4gRGF0ZS5ub3coKX07aS5leHBvcnRzPXtzZXRUaW1lb3V0Om4sc2V0SW50ZXJ2YWw6byxkZWJvdW5jZTpoLGFmdGVyOnMsZXZlcnk6cixjbGVhcjphfX0se1wiLi4vY29yZS9FbmdpbmVcIjo0fV0sOTU6W2Z1bmN0aW9uKHQsaSl7dmFyIGU9e307ZS5EaXJlY3Rpb249e1g6MCxZOjEsWjoyfSxlLmFmdGVyPWZ1bmN0aW9uKHQsaSl7dmFyIGU9dDtyZXR1cm4gZnVuY3Rpb24oKXtlLS0sMD09PWUmJmkuYXBwbHkodGhpcyxhcmd1bWVudHMpfX0sZS5sb2FkVVJMPWZ1bmN0aW9uKHQsaSl7dmFyIGU9bmV3IFhNTEh0dHBSZXF1ZXN0O2Uub25yZWFkeXN0YXRlY2hhbmdlPWZ1bmN0aW9uKCl7ND09PXRoaXMucmVhZHlTdGF0ZSYmaSYmaSh0aGlzLnJlc3BvbnNlVGV4dCl9LGUub3BlbihcIkdFVFwiLHQpLGUuc2VuZCgpfSxlLmNyZWF0ZURvY3VtZW50RnJhZ21lbnRGcm9tSFRNTD1mdW5jdGlvbih0KXt2YXIgaT1kb2N1bWVudC5jcmVhdGVFbGVtZW50KFwiZGl2XCIpO2kuaW5uZXJIVE1MPXQ7Zm9yKHZhciBlPWRvY3VtZW50LmNyZWF0ZURvY3VtZW50RnJhZ21lbnQoKTtpLmhhc0NoaWxkTm9kZXMoKTspZS5hcHBlbmRDaGlsZChpLmZpcnN0Q2hpbGQpO3JldHVybiBlfSxlLmNsb25lPWZ1bmN0aW9uKHQpe3ZhciBpO2lmKFwib2JqZWN0XCI9PXR5cGVvZiB0KXtpPXQgaW5zdGFuY2VvZiBBcnJheT9bXTp7fTtmb3IodmFyIG4gaW4gdClpZihcIm9iamVjdFwiPT10eXBlb2YgdFtuXSYmbnVsbCE9PXRbbl0paWYodFtuXWluc3RhbmNlb2YgQXJyYXkpe2lbbl09bmV3IEFycmF5KHRbbl0ubGVuZ3RoKTtmb3IodmFyIG89MDtvPHRbbl0ubGVuZ3RoO28rKylpW25dW29dPWUuY2xvbmUodFtuXVtvXSl9ZWxzZSBpW25dPWUuY2xvbmUodFtuXSk7ZWxzZSBpW25dPXRbbl19ZWxzZSBpPXQ7cmV0dXJuIGl9LGkuZXhwb3J0cz1lfSx7fV0sOTY6W2Z1bmN0aW9uKHQsaSl7aS5leHBvcnRzPXtLZXlDb2Rlczp0KFwiLi9LZXlDb2Rlc1wiKSxUaW1lcjp0KFwiLi9UaW1lclwiKSxVdGlsaXR5OnQoXCIuL1V0aWxpdHlcIil9fSx7XCIuL0tleUNvZGVzXCI6OTMsXCIuL1RpbWVyXCI6OTQsXCIuL1V0aWxpdHlcIjo5NX1dLDk3OltmdW5jdGlvbih0LGkpe2Z1bmN0aW9uIGUodCl7dGhpcy5vcHRpb25zPU9iamVjdC5jcmVhdGUodGhpcy5jb25zdHJ1Y3Rvci5ERUZBVUxUX09QVElPTlN8fGUuREVGQVVMVF9PUFRJT05TKSx0aGlzLl9vcHRpb25zTWFuYWdlcj1uZXcgcyh0aGlzLm9wdGlvbnMpLHQmJnRoaXMuc2V0T3B0aW9ucyh0KSx0aGlzLl9ldmVudElucHV0PW5ldyBvLHRoaXMuX2V2ZW50T3V0cHV0PW5ldyBvLG8uc2V0SW5wdXRIYW5kbGVyKHRoaXMsdGhpcy5fZXZlbnRJbnB1dCksby5zZXRPdXRwdXRIYW5kbGVyKHRoaXMsdGhpcy5fZXZlbnRPdXRwdXQpLHRoaXMuX2lkPW4ucmVnaXN0ZXIodGhpcyl9dmFyIG49dChcIi4uL2NvcmUvRW50aXR5XCIpLG89KHQoXCIuLi9jb3JlL1RyYW5zZm9ybVwiKSx0KFwiLi4vY29yZS9FdmVudEhhbmRsZXJcIikpLHM9dChcIi4uL2NvcmUvT3B0aW9uc01hbmFnZXJcIik7ZS5ERUZBVUxUX09QVElPTlM9e30sZS5wcm90b3R5cGUuc2V0T3B0aW9ucz1mdW5jdGlvbih0KXtyZXR1cm4gdGhpcy5fb3B0aW9uc01hbmFnZXIuc2V0T3B0aW9ucyh0KX0sZS5wcm90b3R5cGUuZ2V0T3B0aW9ucz1mdW5jdGlvbih0KXtyZXR1cm4gdGhpcy5fb3B0aW9uc01hbmFnZXIuZ2V0T3B0aW9ucyh0KX0sZS5wcm90b3R5cGUucmVuZGVyPWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuX2lkfSxlLnByb3RvdHlwZS5jb21taXQ9ZnVuY3Rpb24oKXt9LGkuZXhwb3J0cz1lfSx7XCIuLi9jb3JlL0VudGl0eVwiOjUsXCIuLi9jb3JlL0V2ZW50SGFuZGxlclwiOjcsXCIuLi9jb3JlL09wdGlvbnNNYW5hZ2VyXCI6MTAsXCIuLi9jb3JlL1RyYW5zZm9ybVwiOjE1fV0sOTg6W2Z1bmN0aW9uKHQsaSl7ZnVuY3Rpb24gZSgpe2MuYXBwbHkodGhpcyxhcmd1bWVudHMpLHRoaXMuc3RhdGU9bmV3IGEoMCksdGhpcy5faXNPcGVuPSExLHRoaXMuc2V0T3V0cHV0RnVuY3Rpb24oZnVuY3Rpb24odCxpLGUpe3ZhciBvPW4uY2FsbCh0aGlzKSxyPXRoaXMub3B0aW9ucy5kaXJlY3Rpb249PT1oLkRpcmVjdGlvbi5YP3MudHJhbnNsYXRlKG8qaSwwLC4wMDEqKG8tMSkqaSk6cy50cmFuc2xhdGUoMCxvKmksLjAwMSooby0xKSppKSxhPXQucmVuZGVyKCk7aWYodGhpcy5vcHRpb25zLnN0YWNrUm90YXRpb24pe3ZhciBjPXRoaXMub3B0aW9ucy5zdGFja1JvdGF0aW9uKmUqKDEtbyk7YT17dHJhbnNmb3JtOnMucm90YXRlWihjKSxvcmlnaW46Wy41LC41XSx0YXJnZXQ6YX19cmV0dXJue3RyYW5zZm9ybTpyLHNpemU6dC5nZXRTaXplKCksdGFyZ2V0OmF9fSl9ZnVuY3Rpb24gbih0KXtyZXR1cm4gdD90aGlzLl9pc09wZW4/MTowOnRoaXMuc3RhdGUuZ2V0KCl9ZnVuY3Rpb24gbyh0LGksZSl7dGhpcy5zdGF0ZS5oYWx0KCksdGhpcy5zdGF0ZS5zZXQodCxpLGUpfXZhciBzPXQoXCIuLi9jb3JlL1RyYW5zZm9ybVwiKSxyPXQoXCIuLi9jb3JlL09wdGlvbnNNYW5hZ2VyXCIpLGE9dChcIi4uL3RyYW5zaXRpb25zL1RyYW5zaXRpb25hYmxlXCIpLGg9dChcIi4uL3V0aWxpdGllcy9VdGlsaXR5XCIpLGM9dChcIi4vU2VxdWVudGlhbExheW91dFwiKTtlLnByb3RvdHlwZT1PYmplY3QuY3JlYXRlKGMucHJvdG90eXBlKSxlLnByb3RvdHlwZS5jb25zdHJ1Y3Rvcj1lLGUuREVGQVVMVF9PUFRJT05TPXIucGF0Y2goYy5ERUZBVUxUX09QVElPTlMse3RyYW5zaXRpb246e2N1cnZlOlwiZWFzZU91dEJvdW5jZVwiLGR1cmF0aW9uOjUwMH0sc3RhY2tSb3RhdGlvbjowfSksZS5wcm90b3R5cGUuZ2V0U2l6ZT1mdW5jdGlvbigpe3ZhciB0PWMucHJvdG90eXBlLmdldFNpemUuYXBwbHkodGhpcyxhcmd1bWVudHMpLGk9dGhpcy5faXRlbXM/dGhpcy5faXRlbXMuZ2V0KCkuZ2V0U2l6ZSgpOlswLDBdO2l8fChpPVswLDBdKTt2YXIgZT1uLmNhbGwodGhpcyksbz0xLWU7cmV0dXJuW2lbMF0qbyt0WzBdKmUsaVsxXSpvK3RbMV0qZV19LGUucHJvdG90eXBlLmlzT3Blbj1mdW5jdGlvbigpe3JldHVybiB0aGlzLl9pc09wZW59LGUucHJvdG90eXBlLm9wZW49ZnVuY3Rpb24odCl7dGhpcy5faXNPcGVuPSEwLG8uY2FsbCh0aGlzLDEsdGhpcy5vcHRpb25zLnRyYW5zaXRpb24sdCl9LGUucHJvdG90eXBlLmNsb3NlPWZ1bmN0aW9uKHQpe3RoaXMuX2lzT3Blbj0hMSxvLmNhbGwodGhpcywwLHRoaXMub3B0aW9ucy50cmFuc2l0aW9uLHQpfSxlLnByb3RvdHlwZS50b2dnbGU9ZnVuY3Rpb24odCl7dGhpcy5faXNPcGVuP3RoaXMuY2xvc2UodCk6dGhpcy5vcGVuKHQpfSxpLmV4cG9ydHM9ZX0se1wiLi4vY29yZS9PcHRpb25zTWFuYWdlclwiOjEwLFwiLi4vY29yZS9UcmFuc2Zvcm1cIjoxNSxcIi4uL3RyYW5zaXRpb25zL1RyYW5zaXRpb25hYmxlXCI6ODgsXCIuLi91dGlsaXRpZXMvVXRpbGl0eVwiOjk1LFwiLi9TZXF1ZW50aWFsTGF5b3V0XCI6MTEwfV0sOTk6W2Z1bmN0aW9uKHQsaSl7ZnVuY3Rpb24gZSh0KXt0aGlzLm9wdGlvbnM9T2JqZWN0LmNyZWF0ZShlLkRFRkFVTFRfT1BUSU9OUyksdGhpcy5fb3B0aW9uc01hbmFnZXI9bmV3IHAodGhpcy5vcHRpb25zKSx0JiZ0aGlzLnNldE9wdGlvbnModCksdGhpcy5fcG9zaXRpb249bmV3IHUoMCksdGhpcy5fZGlyZWN0aW9uPW4odGhpcy5vcHRpb25zLnNpZGUpLHRoaXMuX29yaWVudGF0aW9uPW8odGhpcy5vcHRpb25zLnNpZGUpLHRoaXMuX2lzT3Blbj0hMSx0aGlzLl9jYWNoZWRMZW5ndGg9MCx0aGlzLmRyYXdlcj1uZXcgaCx0aGlzLmNvbnRlbnQ9bmV3IGgsdGhpcy5fZXZlbnRJbnB1dD1uZXcgbCx0aGlzLl9ldmVudE91dHB1dD1uZXcgbCxsLnNldElucHV0SGFuZGxlcih0aGlzLHRoaXMuX2V2ZW50SW5wdXQpLGwuc2V0T3V0cHV0SGFuZGxlcih0aGlzLHRoaXMuX2V2ZW50T3V0cHV0KSx0aGlzLl9ldmVudElucHV0Lm9uKFwidXBkYXRlXCIsci5iaW5kKHRoaXMpKSx0aGlzLl9ldmVudElucHV0Lm9uKFwiZW5kXCIsYS5iaW5kKHRoaXMpKX1mdW5jdGlvbiBuKHQpe3ZhciBpPWUuU0lERVM7cmV0dXJuIHQ9PT1pLkxFRlR8fHQ9PT1pLlJJR0hUP2Y6ZH1mdW5jdGlvbiBvKHQpe3ZhciBpPWUuU0lERVM7cmV0dXJuIHQ9PT1pLkxFRlR8fHQ9PT1pLlRPUD8xOi0xfWZ1bmN0aW9uIHModCl7dmFyIGksZT10aGlzLm9wdGlvbnM7aWYoZS5kcmF3ZXJMZW5ndGgpaT1lLmRyYXdlckxlbmd0aDtlbHNle3ZhciBuPXQuZ2V0U2l6ZSgpO2k9bj9uW3RoaXMuX2RpcmVjdGlvbl06ZS5kcmF3ZXJMZW5ndGh9cmV0dXJuIHRoaXMuX29yaWVudGF0aW9uKml9ZnVuY3Rpb24gcih0KXt2YXIgaSxlLG49dGhpcy5nZXRQb3NpdGlvbigpK3QuZGVsdGE7dGhpcy5fY2FjaGVkTGVuZ3RoPXMuY2FsbCh0aGlzLHRoaXMuZHJhd2VyKSwxPT09dGhpcy5fb3JpZW50YXRpb24/KGk9MCxlPXRoaXMuX2NhY2hlZExlbmd0aCk6KGk9dGhpcy5fY2FjaGVkTGVuZ3RoLGU9MCksbj5lP249ZTppPm4mJihuPWkpLHRoaXMuc2V0UG9zaXRpb24obil9ZnVuY3Rpb24gYSh0KXt2YXIgaT10LnZlbG9jaXR5LGU9dGhpcy5fb3JpZW50YXRpb24qdGhpcy5nZXRQb3NpdGlvbigpLG49dGhpcy5vcHRpb25zLG89dGhpcy5fb3JpZW50YXRpb24qdGhpcy5fY2FjaGVkTGVuZ3RoLHM9bi5wb3NpdGlvblRocmVzaG9sZHx8by8yLHI9bi52ZWxvY2l0eVRocmVzaG9sZDtpZihuLnRyYW5zaXRpb24gaW5zdGFuY2VvZiBPYmplY3QmJihuLnRyYW5zaXRpb24udmVsb2NpdHk9dC52ZWxvY2l0eSksMD09PWUpcmV0dXJuIHZvaWQodGhpcy5faXNPcGVuPSExKTtpZihlPT09bylyZXR1cm4gdm9pZCh0aGlzLl9pc09wZW49ITApO3ZhciBhPU1hdGguYWJzKGkpPnJ8fCF0aGlzLl9pc09wZW4mJmU+c3x8dGhpcy5faXNPcGVuJiZzPmU7YT90aGlzLnRvZ2dsZSgpOnRoaXMucmVzZXQoKX12YXIgaD10KFwiLi4vY29yZS9SZW5kZXJOb2RlXCIpLGM9dChcIi4uL2NvcmUvVHJhbnNmb3JtXCIpLHA9dChcIi4uL2NvcmUvT3B0aW9uc01hbmFnZXJcIiksdT10KFwiLi4vdHJhbnNpdGlvbnMvVHJhbnNpdGlvbmFibGVcIiksbD10KFwiLi4vY29yZS9FdmVudEhhbmRsZXJcIiksZj0wLGQ9MTtlLlNJREVTPXtMRUZUOjAsVE9QOjEsUklHSFQ6MixCT1RUT006M30sZS5ERUZBVUxUX09QVElPTlM9e3NpZGU6ZS5TSURFUy5MRUZULGRyYXdlckxlbmd0aDowLHZlbG9jaXR5VGhyZXNob2xkOjAscG9zaXRpb25UaHJlc2hvbGQ6MCx0cmFuc2l0aW9uOiEwfSxlLnByb3RvdHlwZS5zZXRPcHRpb25zPWZ1bmN0aW9uKHQpe3RoaXMuX29wdGlvbnNNYW5hZ2VyLnNldE9wdGlvbnModCksdm9pZCAwIT09dC5zaWRlJiYodGhpcy5fZGlyZWN0aW9uPW4odC5zaWRlKSx0aGlzLl9vcmllbnRhdGlvbj1vKHQuc2lkZSkpfSxlLnByb3RvdHlwZS5vcGVuPWZ1bmN0aW9uKHQsaSl7dCBpbnN0YW5jZW9mIEZ1bmN0aW9uJiYoaT10KSx2b2lkIDA9PT10JiYodD10aGlzLm9wdGlvbnMudHJhbnNpdGlvbiksdGhpcy5fY2FjaGVkTGVuZ3RoPXMuY2FsbCh0aGlzLHRoaXMuZHJhd2VyKSx0aGlzLnNldFBvc2l0aW9uKHRoaXMuX2NhY2hlZExlbmd0aCx0LGkpLHRoaXMuX2lzT3Blbnx8KHRoaXMuX2lzT3Blbj0hMCx0aGlzLl9ldmVudE91dHB1dC5lbWl0KFwib3BlblwiKSl9LGUucHJvdG90eXBlLmNsb3NlPWZ1bmN0aW9uKHQsaSl7dCBpbnN0YW5jZW9mIEZ1bmN0aW9uJiYoaT10KSx2b2lkIDA9PT10JiYodD10aGlzLm9wdGlvbnMudHJhbnNpdGlvbiksdGhpcy5zZXRQb3NpdGlvbigwLHQsaSksdGhpcy5faXNPcGVuJiYodGhpcy5faXNPcGVuPSExLHRoaXMuX2V2ZW50T3V0cHV0LmVtaXQoXCJjbG9zZVwiKSl9LGUucHJvdG90eXBlLnNldFBvc2l0aW9uPWZ1bmN0aW9uKHQsaSxlKXt0aGlzLl9wb3NpdGlvbi5pc0FjdGl2ZSgpJiZ0aGlzLl9wb3NpdGlvbi5oYWx0KCksdGhpcy5fcG9zaXRpb24uc2V0KHQsaSxlKX0sZS5wcm90b3R5cGUuZ2V0UG9zaXRpb249ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5fcG9zaXRpb24uZ2V0KCl9LGUucHJvdG90eXBlLnNldFByb2dyZXNzPWZ1bmN0aW9uKHQsaSxlKXtyZXR1cm4gdGhpcy5fcG9zaXRpb24uc2V0KHQqdGhpcy5fY2FjaGVkTGVuZ3RoLGksZSl9LGUucHJvdG90eXBlLmdldFByb2dyZXNzPWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuX3Bvc2l0aW9uLmdldCgpL3RoaXMuX2NhY2hlZExlbmd0aH0sZS5wcm90b3R5cGUudG9nZ2xlPWZ1bmN0aW9uKHQpe3RoaXMuX2lzT3Blbj90aGlzLmNsb3NlKHQpOnRoaXMub3Blbih0KX0sZS5wcm90b3R5cGUucmVzZXQ9ZnVuY3Rpb24odCl7dGhpcy5faXNPcGVuP3RoaXMub3Blbih0KTp0aGlzLmNsb3NlKHQpfSxlLnByb3RvdHlwZS5pc09wZW49ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5faXNPcGVufSxlLnByb3RvdHlwZS5yZW5kZXI9ZnVuY3Rpb24oKXt2YXIgdD10aGlzLmdldFBvc2l0aW9uKCk7KCF0aGlzLl9pc09wZW4mJjA+dCYmMT09PXRoaXMuX29yaWVudGF0aW9ufHx0PjAmJi0xPT09dGhpcy5fb3JpZW50YXRpb24pJiYodD0wLHRoaXMuc2V0UG9zaXRpb24odCkpO3ZhciBpPXRoaXMuX2RpcmVjdGlvbj09PWY/Yy50cmFuc2xhdGUodCwwLDApOmMudHJhbnNsYXRlKDAsdCwwKTtyZXR1cm5be3RyYW5zZm9ybTpjLmJlaGluZCx0YXJnZXQ6dGhpcy5kcmF3ZXIucmVuZGVyKCl9LHt0cmFuc2Zvcm06aSx0YXJnZXQ6dGhpcy5jb250ZW50LnJlbmRlcigpfV19LGkuZXhwb3J0cz1lfSx7XCIuLi9jb3JlL0V2ZW50SGFuZGxlclwiOjcsXCIuLi9jb3JlL09wdGlvbnNNYW5hZ2VyXCI6MTAsXCIuLi9jb3JlL1JlbmRlck5vZGVcIjoxMSxcIi4uL2NvcmUvVHJhbnNmb3JtXCI6MTUsXCIuLi90cmFuc2l0aW9ucy9UcmFuc2l0aW9uYWJsZVwiOjg4fV0sMTAwOltmdW5jdGlvbih0LGkpe2Z1bmN0aW9uIGUodCl7dGhpcy5fY3VycmVudFRhcmdldD1udWxsLHRoaXMuX3NpemU9W3ZvaWQgMCx2b2lkIDBdLHRoaXMuX2NvbnRyb2xsZXI9bmV3IGgodCksdGhpcy5fY29udHJvbGxlci5pblRyYW5zZm9ybUZyb20oby5jcmVhdGUobi5iaW5kKHRoaXMsMWUtNCkpKSx0aGlzLl9jb250cm9sbGVyLm91dFRyYW5zZm9ybUZyb20oby5jcmVhdGUobi5iaW5kKHRoaXMsLTFlLTQpKSksdGhpcy5fZXZlbnRJbnB1dD1uZXcgcixyLnNldElucHV0SGFuZGxlcih0aGlzLHRoaXMuX2V2ZW50SW5wdXQpLHRoaXMuX2VudGl0eUlkPXMucmVnaXN0ZXIodGhpcyksdCYmdGhpcy5zZXRPcHRpb25zKHQpfWZ1bmN0aW9uIG4odCxpKXtyZXR1cm4gYS50cmFuc2xhdGUodGhpcy5fc2l6ZVswXSooMS1pKSwwLHQqKDEtaSkpfXZhciBvPXQoXCIuLi90cmFuc2l0aW9ucy9DYWNoZWRNYXBcIikscz10KFwiLi4vY29yZS9FbnRpdHlcIikscj10KFwiLi4vY29yZS9FdmVudEhhbmRsZXJcIiksYT10KFwiLi4vY29yZS9UcmFuc2Zvcm1cIiksaD10KFwiLi9SZW5kZXJDb250cm9sbGVyXCIpO2UucHJvdG90eXBlLnNob3c9ZnVuY3Rpb24odCl7dGhpcy5fY3VycmVudFRhcmdldCYmdGhpcy5fZXZlbnRJbnB1dC51bnBpcGUodGhpcy5fY3VycmVudFRhcmdldCksdGhpcy5fY3VycmVudFRhcmdldD10LHRoaXMuX2N1cnJlbnRUYXJnZXQmJnRoaXMuX2N1cnJlbnRUYXJnZXQudHJpZ2dlciYmdGhpcy5fZXZlbnRJbnB1dC5waXBlKHRoaXMuX2N1cnJlbnRUYXJnZXQpLHRoaXMuX2NvbnRyb2xsZXIuc2hvdy5hcHBseSh0aGlzLl9jb250cm9sbGVyLGFyZ3VtZW50cyl9LGUucHJvdG90eXBlLnNldE9wdGlvbnM9ZnVuY3Rpb24odCl7dGhpcy5fY29udHJvbGxlci5zZXRPcHRpb25zKHQpfSxlLnByb3RvdHlwZS5yZW5kZXI9ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5fZW50aXR5SWR9LGUucHJvdG90eXBlLmNvbW1pdD1mdW5jdGlvbih0KXtyZXR1cm4gdGhpcy5fc2l6ZVswXT10LnNpemVbMF0sdGhpcy5fc2l6ZVsxXT10LnNpemVbMV0se3RyYW5zZm9ybTp0LnRyYW5zZm9ybSxvcGFjaXR5OnQub3BhY2l0eSxvcmlnaW46dC5vcmlnaW4sc2l6ZTp0LnNpemUsdGFyZ2V0OnRoaXMuX2NvbnRyb2xsZXIucmVuZGVyKCl9fSxpLmV4cG9ydHM9ZX0se1wiLi4vY29yZS9FbnRpdHlcIjo1LFwiLi4vY29yZS9FdmVudEhhbmRsZXJcIjo3LFwiLi4vY29yZS9UcmFuc2Zvcm1cIjoxNSxcIi4uL3RyYW5zaXRpb25zL0NhY2hlZE1hcFwiOjgzLFwiLi9SZW5kZXJDb250cm9sbGVyXCI6MTA2fV0sMTAxOltmdW5jdGlvbih0LGkpe2Z1bmN0aW9uIGUodCl7dGhpcy5vcHRpb25zPU9iamVjdC5jcmVhdGUoZS5ERUZBVUxUX09QVElPTlMpLHRoaXMub3B0aW9uc01hbmFnZXI9bmV3IGEodGhpcy5vcHRpb25zKSx0JiZ0aGlzLnNldE9wdGlvbnModCksdGhpcy5pZD1zLnJlZ2lzdGVyKHRoaXMpLHRoaXMuX3JhdGlvcz1uZXcgYyh0aGlzLm9wdGlvbnMucmF0aW9zKSx0aGlzLl9ub2Rlcz1bXSx0aGlzLl9zaXplPVswLDBdLHRoaXMuX2NhY2hlZERpcmVjdGlvbj1udWxsLHRoaXMuX2NhY2hlZExlbmd0aHM9W10sdGhpcy5fY2FjaGVkVHJhbnNmb3Jtcz1udWxsLHRoaXMuX3JhdGlvc0RpcnR5PSExLHRoaXMuX2V2ZW50T3V0cHV0PW5ldyBoLGguc2V0T3V0cHV0SGFuZGxlcih0aGlzLHRoaXMuX2V2ZW50T3V0cHV0KX1mdW5jdGlvbiBuKHQsaSxuKXt2YXIgbyxzLGEsaCxjPTAscD1pLHU9MDtmb3IodGhpcy5fY2FjaGVkTGVuZ3Rocz1bXSx0aGlzLl9jYWNoZWRUcmFuc2Zvcm1zPVtdLGg9MDtoPHQubGVuZ3RoO2grKylzPXRbaF0sYT10aGlzLl9ub2Rlc1toXSxcIm51bWJlclwiIT10eXBlb2Ygcz9wLT1hLmdldFNpemUoKVtuXXx8MDp1Kz1zO2ZvcihoPTA7aDx0Lmxlbmd0aDtoKyspYT10aGlzLl9ub2Rlc1toXSxzPXRbaF0saT1cIm51bWJlclwiPT10eXBlb2Ygcz9wKnMvdTphLmdldFNpemUoKVtuXSxvPW49PT1lLkRJUkVDVElPTl9YP3IudHJhbnNsYXRlKGMsMCwwKTpyLnRyYW5zbGF0ZSgwLGMsMCksdGhpcy5fY2FjaGVkVHJhbnNmb3Jtcy5wdXNoKG8pLHRoaXMuX2NhY2hlZExlbmd0aHMucHVzaChpKSxjKz1pfWZ1bmN0aW9uIG8odCxpKXtmb3IodmFyIGU9MDtlPHQubGVuZ3RoO2UrKylpZihcIm51bWJlclwiIT10eXBlb2YgdFtlXSYmdGhpcy5fbm9kZXNbZV0uZ2V0U2l6ZSgpW2ldIT09dGhpcy5fY2FjaGVkTGVuZ3Roc1tlXSlyZXR1cm4hMDtyZXR1cm4hMX12YXIgcz10KFwiLi4vY29yZS9FbnRpdHlcIikscj10KFwiLi4vY29yZS9UcmFuc2Zvcm1cIiksYT10KFwiLi4vY29yZS9PcHRpb25zTWFuYWdlclwiKSxoPXQoXCIuLi9jb3JlL0V2ZW50SGFuZGxlclwiKSxjPXQoXCIuLi90cmFuc2l0aW9ucy9UcmFuc2l0aW9uYWJsZVwiKTtlLkRJUkVDVElPTl9YPTAsZS5ESVJFQ1RJT05fWT0xLGUuREVGQVVMVF9PUFRJT05TPXtkaXJlY3Rpb246ZS5ESVJFQ1RJT05fWCx0cmFuc2l0aW9uOiExLHJhdGlvczpbXX0sZS5wcm90b3R5cGUucmVuZGVyPWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuaWR9LGUucHJvdG90eXBlLnNldE9wdGlvbnM9ZnVuY3Rpb24odCl7dGhpcy5vcHRpb25zTWFuYWdlci5zZXRPcHRpb25zKHQpfSxlLnByb3RvdHlwZS5zZXF1ZW5jZUZyb209ZnVuY3Rpb24odCl7aWYodGhpcy5fbm9kZXM9dCwwPT09dGhpcy5fcmF0aW9zLmdldCgpLmxlbmd0aCl7Zm9yKHZhciBpPVtdLGU9MDtlPHRoaXMuX25vZGVzLmxlbmd0aDtlKyspaS5wdXNoKDEpO3RoaXMuc2V0UmF0aW9zKGkpfX0sZS5wcm90b3R5cGUuc2V0UmF0aW9zPWZ1bmN0aW9uKHQsaSxlKXt2b2lkIDA9PT1pJiYoaT10aGlzLm9wdGlvbnMudHJhbnNpdGlvbik7dmFyIG49dGhpcy5fcmF0aW9zOzA9PT1uLmdldCgpLmxlbmd0aCYmKGk9dm9pZCAwKSxuLmlzQWN0aXZlKCkmJm4uaGFsdCgpLG4uc2V0KHQsaSxlKSx0aGlzLl9yYXRpb3NEaXJ0eT0hMH0sZS5wcm90b3R5cGUuZ2V0U2l6ZT1mdW5jdGlvbigpe3JldHVybiB0aGlzLl9zaXplfSxlLnByb3RvdHlwZS5jb21taXQ9ZnVuY3Rpb24odCl7dmFyIGksZT10LnNpemUscz10LnRyYW5zZm9ybSxhPXQub3JpZ2luLGg9dC5vcGFjaXR5LGM9dGhpcy5fcmF0aW9zLmdldCgpLHA9dGhpcy5vcHRpb25zLmRpcmVjdGlvbix1PWVbcF07KHUhPT10aGlzLl9zaXplW3BdfHx0aGlzLl9yYXRpb3NEaXJ0eXx8dGhpcy5fcmF0aW9zLmlzQWN0aXZlKCl8fHAhPT10aGlzLl9jYWNoZWREaXJlY3Rpb258fG8uY2FsbCh0aGlzLGMscCkpJiYobi5jYWxsKHRoaXMsYyx1LHApLHUhPT10aGlzLl9zaXplW3BdJiYodGhpcy5fc2l6ZVswXT1lWzBdLHRoaXMuX3NpemVbMV09ZVsxXSkscCE9PXRoaXMuX2NhY2hlZERpcmVjdGlvbiYmKHRoaXMuX2NhY2hlZERpcmVjdGlvbj1wKSx0aGlzLl9yYXRpb3NEaXJ0eSYmKHRoaXMuX3JhdGlvc0RpcnR5PSExKSk7Zm9yKHZhciBsPVtdLGY9MDtmPGMubGVuZ3RoO2YrKylpPVt2b2lkIDAsdm9pZCAwXSx1PXRoaXMuX2NhY2hlZExlbmd0aHNbZl0saVtwXT11LGwucHVzaCh7dHJhbnNmb3JtOnRoaXMuX2NhY2hlZFRyYW5zZm9ybXNbZl0sc2l6ZTppLHRhcmdldDp0aGlzLl9ub2Rlc1tmXS5yZW5kZXIoKX0pO3JldHVybiBlJiYwIT09YVswXSYmMCE9PWFbMV0mJihzPXIubW92ZVRoZW4oWy1lWzBdKmFbMF0sLWVbMV0qYVsxXSwwXSxzKSkse3RyYW5zZm9ybTpzLHNpemU6ZSxvcGFjaXR5OmgsdGFyZ2V0Omx9fSxpLmV4cG9ydHM9ZX0se1wiLi4vY29yZS9FbnRpdHlcIjo1LFwiLi4vY29yZS9FdmVudEhhbmRsZXJcIjo3LFwiLi4vY29yZS9PcHRpb25zTWFuYWdlclwiOjEwLFwiLi4vY29yZS9UcmFuc2Zvcm1cIjoxNSxcIi4uL3RyYW5zaXRpb25zL1RyYW5zaXRpb25hYmxlXCI6ODh9XSwxMDI6W2Z1bmN0aW9uKHQsaSl7ZnVuY3Rpb24gZSh0KXt0aGlzLm9wdGlvbnM9T2JqZWN0LmNyZWF0ZShlLkRFRkFVTFRfT1BUSU9OUyksdGhpcy5fb3B0aW9uc01hbmFnZXI9bmV3IHModGhpcy5vcHRpb25zKSx0JiZ0aGlzLnNldE9wdGlvbnModCksdGhpcy5hbmdsZT1uZXcgbygwKSx0aGlzLmZyb250Tm9kZT12b2lkIDAsdGhpcy5iYWNrTm9kZT12b2lkIDAsdGhpcy5mbGlwcGVkPSExfXZhciBuPXQoXCIuLi9jb3JlL1RyYW5zZm9ybVwiKSxvPXQoXCIuLi90cmFuc2l0aW9ucy9UcmFuc2l0aW9uYWJsZVwiKSxzPSh0KFwiLi4vY29yZS9SZW5kZXJOb2RlXCIpLHQoXCIuLi9jb3JlL09wdGlvbnNNYW5hZ2VyXCIpKTtlLkRJUkVDVElPTl9YPTAsZS5ESVJFQ1RJT05fWT0xO3ZhciByPTE7ZS5ERUZBVUxUX09QVElPTlM9e3RyYW5zaXRpb246ITAsZGlyZWN0aW9uOmUuRElSRUNUSU9OX1h9LGUucHJvdG90eXBlLmZsaXA9ZnVuY3Rpb24odCxpKXt2YXIgZT10aGlzLmZsaXBwZWQ/MDpNYXRoLlBJO3RoaXMuc2V0QW5nbGUoZSx0LGkpLHRoaXMuZmxpcHBlZD0hdGhpcy5mbGlwcGVkfSxlLnByb3RvdHlwZS5zZXRBbmdsZT1mdW5jdGlvbih0LGksZSl7dm9pZCAwPT09aSYmKGk9dGhpcy5vcHRpb25zLnRyYW5zaXRpb24pLHRoaXMuYW5nbGUuaXNBY3RpdmUoKSYmdGhpcy5hbmdsZS5oYWx0KCksdGhpcy5hbmdsZS5zZXQodCxpLGUpfSxlLnByb3RvdHlwZS5zZXRPcHRpb25zPWZ1bmN0aW9uKHQpe3JldHVybiB0aGlzLl9vcHRpb25zTWFuYWdlci5zZXRPcHRpb25zKHQpfSxlLnByb3RvdHlwZS5zZXRGcm9udD1mdW5jdGlvbih0KXt0aGlzLmZyb250Tm9kZT10fSxlLnByb3RvdHlwZS5zZXRCYWNrPWZ1bmN0aW9uKHQpe3RoaXMuYmFja05vZGU9dH0sZS5wcm90b3R5cGUucmVuZGVyPWZ1bmN0aW9uKCl7dmFyIHQsaSxvPXRoaXMuYW5nbGUuZ2V0KCk7dGhpcy5vcHRpb25zLmRpcmVjdGlvbj09PWUuRElSRUNUSU9OX1g/KHQ9bi5yb3RhdGVZKG8pLGk9bi5yb3RhdGVZKG8rTWF0aC5QSSkpOih0PW4ucm90YXRlWChvKSxpPW4ucm90YXRlWChvK01hdGguUEkpKTt2YXIgcz1bXTtyZXR1cm4gdGhpcy5mcm9udE5vZGUmJnMucHVzaCh7dHJhbnNmb3JtOnQsdGFyZ2V0OnRoaXMuZnJvbnROb2RlLnJlbmRlcigpfSksdGhpcy5iYWNrTm9kZSYmcy5wdXNoKHt0cmFuc2Zvcm06bi5tb3ZlVGhlbihbMCwwLHJdLGkpLHRhcmdldDp0aGlzLmJhY2tOb2RlLnJlbmRlcigpfSksc30saS5leHBvcnRzPWV9LHtcIi4uL2NvcmUvT3B0aW9uc01hbmFnZXJcIjoxMCxcIi4uL2NvcmUvUmVuZGVyTm9kZVwiOjExLFwiLi4vY29yZS9UcmFuc2Zvcm1cIjoxNSxcIi4uL3RyYW5zaXRpb25zL1RyYW5zaXRpb25hYmxlXCI6ODh9XSwxMDM6W2Z1bmN0aW9uKHQsaSl7ZnVuY3Rpb24gZSh0KXt0aGlzLm9wdGlvbnM9T2JqZWN0LmNyZWF0ZShlLkRFRkFVTFRfT1BUSU9OUyksdGhpcy5vcHRpb25zTWFuYWdlcj1uZXcgdSh0aGlzLm9wdGlvbnMpLHQmJnRoaXMuc2V0T3B0aW9ucyh0KSx0aGlzLmlkPXIucmVnaXN0ZXIodGhpcyksdGhpcy5fbW9kaWZpZXJzPVtdLHRoaXMuX3N0YXRlcz1bXSx0aGlzLl9jb250ZXh0U2l6ZUNhY2hlPVswLDBdLHRoaXMuX2RpbWVuc2lvbnNDYWNoZT1bMCwwXSx0aGlzLl9hY3RpdmVDb3VudD0wLHRoaXMuX2V2ZW50T3V0cHV0PW5ldyBjLGMuc2V0T3V0cHV0SGFuZGxlcih0aGlzLHRoaXMuX2V2ZW50T3V0cHV0KX1mdW5jdGlvbiBuKHQsaSxlKXt2YXIgbj1bdFswXSx0WzFdXTtuWzBdLT10aGlzLm9wdGlvbnMuZ3V0dGVyU2l6ZVswXSooaS0xKSxuWzFdLT10aGlzLm9wdGlvbnMuZ3V0dGVyU2l6ZVsxXSooZS0xKTtmb3IodmFyIHIsYT1NYXRoLnJvdW5kKG5bMV0vZSksaD1NYXRoLnJvdW5kKG5bMF0vaSksYz0wLHA9MCx1PTA7ZT51O3UrKyl7cj0wO2Zvcih2YXIgbD0wO2k+bDtsKyspdm9pZCAwPT09dGhpcy5fbW9kaWZpZXJzW3BdP28uY2FsbCh0aGlzLHAsW2gsYV0sW3IsYywwXSwxKTpzLmNhbGwodGhpcyxwLFtoLGFdLFtyLGMsMF0sMSkscCsrLHIrPWgrdGhpcy5vcHRpb25zLmd1dHRlclNpemVbMF07Yys9YSt0aGlzLm9wdGlvbnMuZ3V0dGVyU2l6ZVsxXX1mb3IodGhpcy5fZGltZW5zaW9uc0NhY2hlPVt0aGlzLm9wdGlvbnMuZGltZW5zaW9uc1swXSx0aGlzLm9wdGlvbnMuZGltZW5zaW9uc1sxXV0sdGhpcy5fY29udGV4dFNpemVDYWNoZT1bdFswXSx0WzFdXSx0aGlzLl9hY3RpdmVDb3VudD1lKmksdT10aGlzLl9hY3RpdmVDb3VudDt1PHRoaXMuX21vZGlmaWVycy5sZW5ndGg7dSsrKXMuY2FsbCh0aGlzLHUsW01hdGgucm91bmQoaCksTWF0aC5yb3VuZChhKV0sWzAsMF0sMCk7dGhpcy5fZXZlbnRPdXRwdXQuZW1pdChcInJlZmxvd1wiKX1mdW5jdGlvbiBvKHQsaSxlLG4pe3ZhciBvPXt0cmFuc2Zvcm06bmV3IGYoYS50cmFuc2xhdGUuYXBwbHkobnVsbCxlKSksb3BhY2l0eTpuZXcgbChuKSxzaXplOm5ldyBsKGkpfSxzPW5ldyBwKHt0cmFuc2Zvcm06by50cmFuc2Zvcm0sb3BhY2l0eTpvLm9wYWNpdHksc2l6ZTpvLnNpemV9KTt0aGlzLl9zdGF0ZXNbdF09byx0aGlzLl9tb2RpZmllcnNbdF09c31mdW5jdGlvbiBzKHQsaSxlLG4pe3ZhciBvPXRoaXMuX3N0YXRlc1t0XSxzPW8uc2l6ZSxyPW8ub3BhY2l0eSxhPW8udHJhbnNmb3JtLGg9dGhpcy5vcHRpb25zLnRyYW5zaXRpb247YS5oYWx0KCksci5oYWx0KCkscy5oYWx0KCksYS5zZXRUcmFuc2xhdGUoZSxoKSxzLnNldChpLGgpLHIuc2V0KG4saCl9dmFyIHI9dChcIi4uL2NvcmUvRW50aXR5XCIpLGE9KHQoXCIuLi9jb3JlL1JlbmRlck5vZGVcIiksdChcIi4uL2NvcmUvVHJhbnNmb3JtXCIpKSxoPXQoXCIuLi9jb3JlL1ZpZXdTZXF1ZW5jZVwiKSxjPXQoXCIuLi9jb3JlL0V2ZW50SGFuZGxlclwiKSxwPXQoXCIuLi9jb3JlL01vZGlmaWVyXCIpLHU9dChcIi4uL2NvcmUvT3B0aW9uc01hbmFnZXJcIiksbD10KFwiLi4vdHJhbnNpdGlvbnMvVHJhbnNpdGlvbmFibGVcIiksZj10KFwiLi4vdHJhbnNpdGlvbnMvVHJhbnNpdGlvbmFibGVUcmFuc2Zvcm1cIik7ZS5ERUZBVUxUX09QVElPTlM9e2RpbWVuc2lvbnM6WzEsMV0sdHJhbnNpdGlvbjohMSxndXR0ZXJTaXplOlswLDBdfSxlLnByb3RvdHlwZS5yZW5kZXI9ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5pZH0sZS5wcm90b3R5cGUuc2V0T3B0aW9ucz1mdW5jdGlvbih0KXtyZXR1cm4gdGhpcy5vcHRpb25zTWFuYWdlci5zZXRPcHRpb25zKHQpfSxlLnByb3RvdHlwZS5zZXF1ZW5jZUZyb209ZnVuY3Rpb24odCl7dCBpbnN0YW5jZW9mIEFycmF5JiYodD1uZXcgaCh0KSksdGhpcy5zZXF1ZW5jZT10fSxlLnByb3RvdHlwZS5jb21taXQ9ZnVuY3Rpb24odCl7dmFyIGk9dC50cmFuc2Zvcm0sZT10Lm9wYWNpdHksbz10Lm9yaWdpbixzPXQuc2l6ZSxyPXRoaXMub3B0aW9ucy5kaW1lbnNpb25zWzBdLGg9dGhpcy5vcHRpb25zLmRpbWVuc2lvbnNbMV07KHNbMF0hPT10aGlzLl9jb250ZXh0U2l6ZUNhY2hlWzBdfHxzWzFdIT09dGhpcy5fY29udGV4dFNpemVDYWNoZVsxXXx8ciE9PXRoaXMuX2RpbWVuc2lvbnNDYWNoZVswXXx8aCE9PXRoaXMuX2RpbWVuc2lvbnNDYWNoZVsxXSkmJm4uY2FsbCh0aGlzLHMscixoKTtmb3IodmFyIGM9dGhpcy5zZXF1ZW5jZSxwPVtdLHU9MDtjJiZ1PHRoaXMuX21vZGlmaWVycy5sZW5ndGg7KXt2YXIgbD1jLmdldCgpLGY9dGhpcy5fbW9kaWZpZXJzW3VdO3U+PXRoaXMuX2FjdGl2ZUNvdW50JiZ0aGlzLl9zdGF0ZXNbdV0ub3BhY2l0eS5pc0FjdGl2ZSgpJiYodGhpcy5fbW9kaWZpZXJzLnNwbGljZSh1LDEpLHRoaXMuX3N0YXRlcy5zcGxpY2UodSwxKSksbCYmcC5wdXNoKGYubW9kaWZ5KHtvcmlnaW46byx0YXJnZXQ6bC5yZW5kZXIoKX0pKSxjPWMuZ2V0TmV4dCgpLHUrK31yZXR1cm4gcyYmKGk9YS5tb3ZlVGhlbihbLXNbMF0qb1swXSwtc1sxXSpvWzFdLDBdLGkpKSx7dHJhbnNmb3JtOmksb3BhY2l0eTplLHNpemU6cyx0YXJnZXQ6cH19LGkuZXhwb3J0cz1lfSx7XCIuLi9jb3JlL0VudGl0eVwiOjUsXCIuLi9jb3JlL0V2ZW50SGFuZGxlclwiOjcsXCIuLi9jb3JlL01vZGlmaWVyXCI6OSxcIi4uL2NvcmUvT3B0aW9uc01hbmFnZXJcIjoxMCxcIi4uL2NvcmUvUmVuZGVyTm9kZVwiOjExLFwiLi4vY29yZS9UcmFuc2Zvcm1cIjoxNSxcIi4uL2NvcmUvVmlld1NlcXVlbmNlXCI6MTcsXCIuLi90cmFuc2l0aW9ucy9UcmFuc2l0aW9uYWJsZVwiOjg4LFwiLi4vdHJhbnNpdGlvbnMvVHJhbnNpdGlvbmFibGVUcmFuc2Zvcm1cIjo4OX1dLDEwNDpbZnVuY3Rpb24odCxpKXtmdW5jdGlvbiBlKHQpe3RoaXMub3B0aW9ucz1PYmplY3QuY3JlYXRlKGUuREVGQVVMVF9PUFRJT05TKSx0aGlzLl9vcHRpb25zTWFuYWdlcj1uZXcgYyh0aGlzLm9wdGlvbnMpLHQmJnRoaXMuc2V0T3B0aW9ucyh0KSx0aGlzLl9lbnRpdHlJZD1yLnJlZ2lzdGVyKHRoaXMpLHRoaXMuaGVhZGVyPW5ldyBhLHRoaXMuZm9vdGVyPW5ldyBhLHRoaXMuY29udGVudD1uZXcgYX1mdW5jdGlvbiBuKHQsaSl7dmFyIGU9dC5nZXRTaXplKCk7cmV0dXJuIGU/ZVt0aGlzLm9wdGlvbnMuZGlyZWN0aW9uXTppfWZ1bmN0aW9uIG8odCl7cmV0dXJuIHRoaXMub3B0aW9ucy5kaXJlY3Rpb249PT1lLkRJUkVDVElPTl9YP2gudHJhbnNsYXRlKHQsMCwwKTpoLnRyYW5zbGF0ZSgwLHQsMCl9ZnVuY3Rpb24gcyh0LGkpe3JldHVybiB0aGlzLm9wdGlvbnMuZGlyZWN0aW9uPT09ZS5ESVJFQ1RJT05fWD9bdCxpWzFdXTpbaVswXSx0XX12YXIgcj10KFwiLi4vY29yZS9FbnRpdHlcIiksYT10KFwiLi4vY29yZS9SZW5kZXJOb2RlXCIpLGg9dChcIi4uL2NvcmUvVHJhbnNmb3JtXCIpLGM9dChcIi4uL2NvcmUvT3B0aW9uc01hbmFnZXJcIik7ZS5ESVJFQ1RJT05fWD0wLGUuRElSRUNUSU9OX1k9MSxlLkRFRkFVTFRfT1BUSU9OUz17ZGlyZWN0aW9uOmUuRElSRUNUSU9OX1ksaGVhZGVyU2l6ZTp2b2lkIDAsZm9vdGVyU2l6ZTp2b2lkIDAsZGVmYXVsdEhlYWRlclNpemU6MCxkZWZhdWx0Rm9vdGVyU2l6ZTowfSxlLnByb3RvdHlwZS5yZW5kZXI9ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5fZW50aXR5SWR9LGUucHJvdG90eXBlLnNldE9wdGlvbnM9ZnVuY3Rpb24odCl7cmV0dXJuIHRoaXMuX29wdGlvbnNNYW5hZ2VyLnNldE9wdGlvbnModCl9LGUucHJvdG90eXBlLmNvbW1pdD1mdW5jdGlvbih0KXt2YXIgaT10LnRyYW5zZm9ybSxlPXQub3JpZ2luLHI9dC5zaXplLGE9dC5vcGFjaXR5LGM9dm9pZCAwIT09dGhpcy5vcHRpb25zLmhlYWRlclNpemU/dGhpcy5vcHRpb25zLmhlYWRlclNpemU6bi5jYWxsKHRoaXMsdGhpcy5oZWFkZXIsdGhpcy5vcHRpb25zLmRlZmF1bHRIZWFkZXJTaXplKSxwPXZvaWQgMCE9PXRoaXMub3B0aW9ucy5mb290ZXJTaXplP3RoaXMub3B0aW9ucy5mb290ZXJTaXplOm4uY2FsbCh0aGlzLHRoaXMuZm9vdGVyLHRoaXMub3B0aW9ucy5kZWZhdWx0Rm9vdGVyU2l6ZSksdT1yW3RoaXMub3B0aW9ucy5kaXJlY3Rpb25dLWMtcDtyJiYoaT1oLm1vdmVUaGVuKFstclswXSplWzBdLC1yWzFdKmVbMV0sMF0saSkpO3ZhciBsPVt7c2l6ZTpzLmNhbGwodGhpcyxjLHIpLHRhcmdldDp0aGlzLmhlYWRlci5yZW5kZXIoKX0se3RyYW5zZm9ybTpvLmNhbGwodGhpcyxjKSxzaXplOnMuY2FsbCh0aGlzLHUsciksdGFyZ2V0OnRoaXMuY29udGVudC5yZW5kZXIoKX0se3RyYW5zZm9ybTpvLmNhbGwodGhpcyxjK3UpLHNpemU6cy5jYWxsKHRoaXMscCxyKSx0YXJnZXQ6dGhpcy5mb290ZXIucmVuZGVyKCl9XTtyZXR1cm57dHJhbnNmb3JtOmksb3BhY2l0eTphLHNpemU6cix0YXJnZXQ6bH19LGkuZXhwb3J0cz1lfSx7XCIuLi9jb3JlL0VudGl0eVwiOjUsXCIuLi9jb3JlL09wdGlvbnNNYW5hZ2VyXCI6MTAsXCIuLi9jb3JlL1JlbmRlck5vZGVcIjoxMSxcIi4uL2NvcmUvVHJhbnNmb3JtXCI6MTV9XSwxMDU6W2Z1bmN0aW9uKHQsaSl7ZnVuY3Rpb24gZSh0KXt0aGlzLm9wdGlvbnM9T2JqZWN0LmNyZWF0ZShlLkRFRkFVTFRfT1BUSU9OUyksdGhpcy5fb3B0aW9uc01hbmFnZXI9bmV3IGEodGhpcy5vcHRpb25zKSx0JiZ0aGlzLnNldE9wdGlvbnModCksdGhpcy5fc2hvd2luZz0hMSx0aGlzLm5vZGVzPVtdLHRoaXMudHJhbnNmb3Jtcz1bXSx0aGlzLnN0YXRlcz1bXX12YXIgbj10KFwiLi4vY29yZS9UcmFuc2Zvcm1cIiksbz10KFwiLi4vY29yZS9Nb2RpZmllclwiKSxzPXQoXCIuLi9jb3JlL1JlbmRlck5vZGVcIikscj10KFwiLi4vdXRpbGl0aWVzL1V0aWxpdHlcIiksYT10KFwiLi4vY29yZS9PcHRpb25zTWFuYWdlclwiKSxoPXQoXCIuLi90cmFuc2l0aW9ucy9UcmFuc2l0aW9uYWJsZVwiKSxjPXQoXCIuLi90cmFuc2l0aW9ucy9UcmFuc2l0aW9uYWJsZVRyYW5zZm9ybVwiKTtlLkRFRkFVTFRfT1BUSU9OUz17aW5UcmFuc2Zvcm06bi5zY2FsZSguMDAxLC4wMDEsLjAwMSksaW5PcGFjaXR5OjAsaW5PcmlnaW46Wy41LC41XSxpbkFsaWduOlsuNSwuNV0sb3V0VHJhbnNmb3JtOm4uc2NhbGUoLjAwMSwuMDAxLC4wMDEpLG91dE9wYWNpdHk6MCxvdXRPcmlnaW46Wy41LC41XSxvdXRBbGlnbjpbLjUsLjVdLHNob3dUcmFuc2Zvcm06bi5pZGVudGl0eSxzaG93T3BhY2l0eToxLHNob3dPcmlnaW46Wy41LC41XSxzaG93QWxpZ246Wy41LC41XSxpblRyYW5zaXRpb246ITAsb3V0VHJhbnNpdGlvbjohMCxvdmVybGFwOiExfSxlLnByb3RvdHlwZS5zZXRPcHRpb25zPWZ1bmN0aW9uKHQpe3JldHVybiB0aGlzLl9vcHRpb25zTWFuYWdlci5zZXRPcHRpb25zKHQpfSxlLnByb3RvdHlwZS5zaG93PWZ1bmN0aW9uKHQsaSxlKXtpZighdClyZXR1cm4gdGhpcy5oaWRlKGUpO2lmKGkgaW5zdGFuY2VvZiBGdW5jdGlvbiYmKGU9aSxpPXZvaWQgMCksdGhpcy5fc2hvd2luZyl7aWYoIXRoaXMub3B0aW9ucy5vdmVybGFwKXJldHVybiB0aGlzLmhpZGUodGhpcy5zaG93LmJpbmQodGhpcyx0LGksZSkpO3RoaXMuaGlkZSgpfXRoaXMuX3Nob3dpbmc9ITA7dmFyIG49e3RyYW5zZm9ybTpuZXcgYyh0aGlzLm9wdGlvbnMuaW5UcmFuc2Zvcm0pLG9yaWdpbjpuZXcgaCh0aGlzLm9wdGlvbnMuaW5PcmlnaW4pLGFsaWduOm5ldyBoKHRoaXMub3B0aW9ucy5pbkFsaWduKSxvcGFjaXR5Om5ldyBoKHRoaXMub3B0aW9ucy5pbk9wYWNpdHkpfSxhPW5ldyBvKHt0cmFuc2Zvcm06bi50cmFuc2Zvcm0sb3BhY2l0eTpuLm9wYWNpdHksb3JpZ2luOm4ub3JpZ2luLGFsaWduOm4uYWxpZ259KSxwPW5ldyBzO3AuYWRkKGEpLmFkZCh0KSx0aGlzLm5vZGVzLnB1c2gocCksdGhpcy5zdGF0ZXMucHVzaChuKSx0aGlzLnRyYW5zZm9ybXMucHVzaChhKTt2YXIgdT1lP3IuYWZ0ZXIoMyxlKTp2b2lkIDA7aXx8KGk9dGhpcy5vcHRpb25zLmluVHJhbnNpdGlvbiksbi50cmFuc2Zvcm0uc2V0KHRoaXMub3B0aW9ucy5zaG93VHJhbnNmb3JtLGksdSksbi5vcGFjaXR5LnNldCh0aGlzLm9wdGlvbnMuc2hvd09wYWNpdHksaSx1KSxuLm9yaWdpbi5zZXQodGhpcy5vcHRpb25zLnNob3dPcmlnaW4saSx1KSxuLmFsaWduLnNldCh0aGlzLm9wdGlvbnMuc2hvd0FsaWduLGksdSl9LGUucHJvdG90eXBlLmhpZGU9ZnVuY3Rpb24odCxpKXtpZih0aGlzLl9zaG93aW5nKXt0aGlzLl9zaG93aW5nPSExLHQgaW5zdGFuY2VvZiBGdW5jdGlvbiYmKGk9dCx0PXZvaWQgMCk7dmFyIGU9dGhpcy5ub2Rlc1t0aGlzLm5vZGVzLmxlbmd0aC0xXSxuPXRoaXMudHJhbnNmb3Jtc1t0aGlzLnRyYW5zZm9ybXMubGVuZ3RoLTFdLG89dGhpcy5zdGF0ZXNbdGhpcy5zdGF0ZXMubGVuZ3RoLTFdLHM9ci5hZnRlcigzLGZ1bmN0aW9uKCl7dGhpcy5ub2Rlcy5zcGxpY2UodGhpcy5ub2Rlcy5pbmRleE9mKGUpLDEpLHRoaXMuc3RhdGVzLnNwbGljZSh0aGlzLnN0YXRlcy5pbmRleE9mKG8pLDEpLHRoaXMudHJhbnNmb3Jtcy5zcGxpY2UodGhpcy50cmFuc2Zvcm1zLmluZGV4T2YobiksMSksaSYmaS5jYWxsKHRoaXMpfS5iaW5kKHRoaXMpKTt0fHwodD10aGlzLm9wdGlvbnMub3V0VHJhbnNpdGlvbiksby50cmFuc2Zvcm0uc2V0KHRoaXMub3B0aW9ucy5vdXRUcmFuc2Zvcm0sdCxzKSxvLm9wYWNpdHkuc2V0KHRoaXMub3B0aW9ucy5vdXRPcGFjaXR5LHQscyksby5vcmlnaW4uc2V0KHRoaXMub3B0aW9ucy5vdXRPcmlnaW4sdCxzKSxvLmFsaWduLnNldCh0aGlzLm9wdGlvbnMub3V0QWxpZ24sdCxzKX19LGUucHJvdG90eXBlLnJlbmRlcj1mdW5jdGlvbigpe2Zvcih2YXIgdD1bXSxpPTA7aTx0aGlzLm5vZGVzLmxlbmd0aDtpKyspdC5wdXNoKHRoaXMubm9kZXNbaV0ucmVuZGVyKCkpO3JldHVybiB0fSxpLmV4cG9ydHM9ZX0se1wiLi4vY29yZS9Nb2RpZmllclwiOjksXCIuLi9jb3JlL09wdGlvbnNNYW5hZ2VyXCI6MTAsXCIuLi9jb3JlL1JlbmRlck5vZGVcIjoxMSxcIi4uL2NvcmUvVHJhbnNmb3JtXCI6MTUsXCIuLi90cmFuc2l0aW9ucy9UcmFuc2l0aW9uYWJsZVwiOjg4LFwiLi4vdHJhbnNpdGlvbnMvVHJhbnNpdGlvbmFibGVUcmFuc2Zvcm1cIjo4OSxcIi4uL3V0aWxpdGllcy9VdGlsaXR5XCI6OTV9XSwxMDY6W2Z1bmN0aW9uKHQsaSl7ZnVuY3Rpb24gZSgpe2guYXBwbHkodGhpcyxhcmd1bWVudHMpLHRoaXMuX3Nob3dpbmc9LTEsdGhpcy5fb3V0Z29pbmdSZW5kZXJhYmxlcz1bXSx0aGlzLl9uZXh0UmVuZGVyYWJsZT1udWxsLHRoaXMuX3JlbmRlcmFibGVzPVtdLHRoaXMuX25vZGVzPVtdLHRoaXMuX21vZGlmaWVycz1bXSx0aGlzLl9zdGF0ZXM9W10sdGhpcy5pblRyYW5zZm9ybU1hcD1lLkRlZmF1bHRNYXAudHJhbnNmb3JtLHRoaXMuaW5PcGFjaXR5TWFwPWUuRGVmYXVsdE1hcC5vcGFjaXR5LHRoaXMuaW5PcmlnaW5NYXA9ZS5EZWZhdWx0TWFwLm9yaWdpbix0aGlzLm91dFRyYW5zZm9ybU1hcD1lLkRlZmF1bHRNYXAudHJhbnNmb3JtLHRoaXMub3V0T3BhY2l0eU1hcD1lLkRlZmF1bHRNYXAub3BhY2l0eSx0aGlzLm91dE9yaWdpbk1hcD1lLkRlZmF1bHRNYXAub3JpZ2luLHRoaXMuX291dHB1dD1bXVxufWZ1bmN0aW9uIG4odCxpKXtyZXR1cm4gdChpLmdldCgpKX12YXIgbz10KFwiLi4vY29yZS9Nb2RpZmllclwiKSxzPXQoXCIuLi9jb3JlL1JlbmRlck5vZGVcIikscj10KFwiLi4vY29yZS9UcmFuc2Zvcm1cIiksYT10KFwiLi4vdHJhbnNpdGlvbnMvVHJhbnNpdGlvbmFibGVcIiksaD10KFwiLi4vY29yZS9WaWV3XCIpO2UucHJvdG90eXBlPU9iamVjdC5jcmVhdGUoaC5wcm90b3R5cGUpLGUucHJvdG90eXBlLmNvbnN0cnVjdG9yPWUsZS5ERUZBVUxUX09QVElPTlM9e2luVHJhbnNpdGlvbjohMCxvdXRUcmFuc2l0aW9uOiEwLG92ZXJsYXA6ITB9LGUuRGVmYXVsdE1hcD17dHJhbnNmb3JtOmZ1bmN0aW9uKCl7cmV0dXJuIHIuaWRlbnRpdHl9LG9wYWNpdHk6ZnVuY3Rpb24odCl7cmV0dXJuIHR9LG9yaWdpbjpudWxsfSxlLnByb3RvdHlwZS5pblRyYW5zZm9ybUZyb209ZnVuY3Rpb24odCl7aWYodCBpbnN0YW5jZW9mIEZ1bmN0aW9uKXRoaXMuaW5UcmFuc2Zvcm1NYXA9dDtlbHNle2lmKCF0fHwhdC5nZXQpdGhyb3cgbmV3IEVycm9yKFwiaW5UcmFuc2Zvcm1Gcm9tIHRha2VzIG9ubHkgZnVuY3Rpb24gb3IgZ2V0dGVyIG9iamVjdFwiKTt0aGlzLmluVHJhbnNmb3JtTWFwPXQuZ2V0LmJpbmQodCl9cmV0dXJuIHRoaXN9LGUucHJvdG90eXBlLmluT3BhY2l0eUZyb209ZnVuY3Rpb24odCl7aWYodCBpbnN0YW5jZW9mIEZ1bmN0aW9uKXRoaXMuaW5PcGFjaXR5TWFwPXQ7ZWxzZXtpZighdHx8IXQuZ2V0KXRocm93IG5ldyBFcnJvcihcImluT3BhY2l0eUZyb20gdGFrZXMgb25seSBmdW5jdGlvbiBvciBnZXR0ZXIgb2JqZWN0XCIpO3RoaXMuaW5PcGFjaXR5TWFwPXQuZ2V0LmJpbmQodCl9cmV0dXJuIHRoaXN9LGUucHJvdG90eXBlLmluT3JpZ2luRnJvbT1mdW5jdGlvbih0KXtpZih0IGluc3RhbmNlb2YgRnVuY3Rpb24pdGhpcy5pbk9yaWdpbk1hcD10O2Vsc2V7aWYoIXR8fCF0LmdldCl0aHJvdyBuZXcgRXJyb3IoXCJpbk9yaWdpbkZyb20gdGFrZXMgb25seSBmdW5jdGlvbiBvciBnZXR0ZXIgb2JqZWN0XCIpO3RoaXMuaW5PcmlnaW5NYXA9dC5nZXQuYmluZCh0KX1yZXR1cm4gdGhpc30sZS5wcm90b3R5cGUub3V0VHJhbnNmb3JtRnJvbT1mdW5jdGlvbih0KXtpZih0IGluc3RhbmNlb2YgRnVuY3Rpb24pdGhpcy5vdXRUcmFuc2Zvcm1NYXA9dDtlbHNle2lmKCF0fHwhdC5nZXQpdGhyb3cgbmV3IEVycm9yKFwib3V0VHJhbnNmb3JtRnJvbSB0YWtlcyBvbmx5IGZ1bmN0aW9uIG9yIGdldHRlciBvYmplY3RcIik7dGhpcy5vdXRUcmFuc2Zvcm1NYXA9dC5nZXQuYmluZCh0KX1yZXR1cm4gdGhpc30sZS5wcm90b3R5cGUub3V0T3BhY2l0eUZyb209ZnVuY3Rpb24odCl7aWYodCBpbnN0YW5jZW9mIEZ1bmN0aW9uKXRoaXMub3V0T3BhY2l0eU1hcD10O2Vsc2V7aWYoIXR8fCF0LmdldCl0aHJvdyBuZXcgRXJyb3IoXCJvdXRPcGFjaXR5RnJvbSB0YWtlcyBvbmx5IGZ1bmN0aW9uIG9yIGdldHRlciBvYmplY3RcIik7dGhpcy5vdXRPcGFjaXR5TWFwPXQuZ2V0LmJpbmQodCl9cmV0dXJuIHRoaXN9LGUucHJvdG90eXBlLm91dE9yaWdpbkZyb209ZnVuY3Rpb24odCl7aWYodCBpbnN0YW5jZW9mIEZ1bmN0aW9uKXRoaXMub3V0T3JpZ2luTWFwPXQ7ZWxzZXtpZighdHx8IXQuZ2V0KXRocm93IG5ldyBFcnJvcihcIm91dE9yaWdpbkZyb20gdGFrZXMgb25seSBmdW5jdGlvbiBvciBnZXR0ZXIgb2JqZWN0XCIpO3RoaXMub3V0T3JpZ2luTWFwPXQuZ2V0LmJpbmQodCl9cmV0dXJuIHRoaXN9LGUucHJvdG90eXBlLnNob3c9ZnVuY3Rpb24odCxpLGUpe2lmKCF0KXJldHVybiB0aGlzLmhpZGUoZSk7aWYoaSBpbnN0YW5jZW9mIEZ1bmN0aW9uJiYoZT1pLGk9bnVsbCksdGhpcy5fc2hvd2luZz49MCl7aWYoIXRoaXMub3B0aW9ucy5vdmVybGFwKXJldHVybiB2b2lkKHRoaXMuX25leHRSZW5kZXJhYmxlP3RoaXMuX25leHRSZW5kZXJhYmxlPXQ6KHRoaXMuX25leHRSZW5kZXJhYmxlPXQsdGhpcy5oaWRlKGZ1bmN0aW9uKCl7dGhpcy5fbmV4dFJlbmRlcmFibGU9PT10JiZ0aGlzLnNob3codGhpcy5fbmV4dFJlbmRlcmFibGUsZSksdGhpcy5fbmV4dFJlbmRlcmFibGU9bnVsbH0pKSk7dGhpcy5oaWRlKCl9dmFyIHI9bnVsbCxoPXRoaXMuX3JlbmRlcmFibGVzLmluZGV4T2YodCk7aWYoaD49MCl7dGhpcy5fc2hvd2luZz1oLHI9dGhpcy5fc3RhdGVzW2hdLHIuaGFsdCgpO3ZhciBjPXRoaXMuX291dGdvaW5nUmVuZGVyYWJsZXMuaW5kZXhPZih0KTtjPj0wJiZ0aGlzLl9vdXRnb2luZ1JlbmRlcmFibGVzLnNwbGljZShjLDEpfWVsc2V7cj1uZXcgYSgwKTt2YXIgcD1uZXcgbyh7dHJhbnNmb3JtOnRoaXMuaW5UcmFuc2Zvcm1NYXA/bi5iaW5kKHRoaXMsdGhpcy5pblRyYW5zZm9ybU1hcCxyKTpudWxsLG9wYWNpdHk6dGhpcy5pbk9wYWNpdHlNYXA/bi5iaW5kKHRoaXMsdGhpcy5pbk9wYWNpdHlNYXAscik6bnVsbCxvcmlnaW46dGhpcy5pbk9yaWdpbk1hcD9uLmJpbmQodGhpcyx0aGlzLmluT3JpZ2luTWFwLHIpOm51bGx9KSx1PW5ldyBzO3UuYWRkKHApLmFkZCh0KSx0aGlzLl9zaG93aW5nPXRoaXMuX25vZGVzLmxlbmd0aCx0aGlzLl9ub2Rlcy5wdXNoKHUpLHRoaXMuX21vZGlmaWVycy5wdXNoKHApLHRoaXMuX3N0YXRlcy5wdXNoKHIpLHRoaXMuX3JlbmRlcmFibGVzLnB1c2godCl9aXx8KGk9dGhpcy5vcHRpb25zLmluVHJhbnNpdGlvbiksci5zZXQoMSxpLGUpfSxlLnByb3RvdHlwZS5oaWRlPWZ1bmN0aW9uKHQsaSl7aWYoISh0aGlzLl9zaG93aW5nPDApKXt2YXIgZT10aGlzLl9zaG93aW5nO3RoaXMuX3Nob3dpbmc9LTEsdCBpbnN0YW5jZW9mIEZ1bmN0aW9uJiYoaT10LHQ9dm9pZCAwKTt2YXIgbz10aGlzLl9ub2Rlc1tlXSxzPXRoaXMuX21vZGlmaWVyc1tlXSxyPXRoaXMuX3N0YXRlc1tlXSxhPXRoaXMuX3JlbmRlcmFibGVzW2VdO3MudHJhbnNmb3JtRnJvbSh0aGlzLm91dFRyYW5zZm9ybU1hcD9uLmJpbmQodGhpcyx0aGlzLm91dFRyYW5zZm9ybU1hcCxyKTpudWxsKSxzLm9wYWNpdHlGcm9tKHRoaXMub3V0T3BhY2l0eU1hcD9uLmJpbmQodGhpcyx0aGlzLm91dE9wYWNpdHlNYXAscik6bnVsbCkscy5vcmlnaW5Gcm9tKHRoaXMub3V0T3JpZ2luTWFwP24uYmluZCh0aGlzLHRoaXMub3V0T3JpZ2luTWFwLHIpOm51bGwpLHRoaXMuX291dGdvaW5nUmVuZGVyYWJsZXMuaW5kZXhPZihhKTwwJiZ0aGlzLl9vdXRnb2luZ1JlbmRlcmFibGVzLnB1c2goYSksdHx8KHQ9dGhpcy5vcHRpb25zLm91dFRyYW5zaXRpb24pLHIuaGFsdCgpLHIuc2V0KDAsdCxmdW5jdGlvbih0LGUsbixvKXtpZih0aGlzLl9vdXRnb2luZ1JlbmRlcmFibGVzLmluZGV4T2Yobyk+PTApe3ZhciBzPXRoaXMuX25vZGVzLmluZGV4T2YodCk7dGhpcy5fbm9kZXMuc3BsaWNlKHMsMSksdGhpcy5fbW9kaWZpZXJzLnNwbGljZShzLDEpLHRoaXMuX3N0YXRlcy5zcGxpY2UocywxKSx0aGlzLl9yZW5kZXJhYmxlcy5zcGxpY2UocywxKSx0aGlzLl9vdXRnb2luZ1JlbmRlcmFibGVzLnNwbGljZSh0aGlzLl9vdXRnb2luZ1JlbmRlcmFibGVzLmluZGV4T2YobyksMSksdGhpcy5fc2hvd2luZz49cyYmdGhpcy5fc2hvd2luZy0tfWkmJmkuY2FsbCh0aGlzKX0uYmluZCh0aGlzLG8scyxyLGEpKX19LGUucHJvdG90eXBlLnJlbmRlcj1mdW5jdGlvbigpe3ZhciB0PXRoaXMuX291dHB1dDt0Lmxlbmd0aD50aGlzLl9ub2Rlcy5sZW5ndGgmJnQuc3BsaWNlKHRoaXMuX25vZGVzLmxlbmd0aCk7Zm9yKHZhciBpPTA7aTx0aGlzLl9ub2Rlcy5sZW5ndGg7aSsrKXRbaV09dGhpcy5fbm9kZXNbaV0ucmVuZGVyKCk7cmV0dXJuIHR9LGkuZXhwb3J0cz1lfSx7XCIuLi9jb3JlL01vZGlmaWVyXCI6OSxcIi4uL2NvcmUvUmVuZGVyTm9kZVwiOjExLFwiLi4vY29yZS9UcmFuc2Zvcm1cIjoxNSxcIi4uL2NvcmUvVmlld1wiOjE2LFwiLi4vdHJhbnNpdGlvbnMvVHJhbnNpdGlvbmFibGVcIjo4OH1dLDEwNzpbZnVuY3Rpb24odCxpKXtmdW5jdGlvbiBlKHQpe3RoaXMub3B0aW9ucz1PYmplY3QuY3JlYXRlKGUuREVGQVVMVF9PUFRJT05TKSx0aGlzLl9vcHRpb25zTWFuYWdlcj1uZXcgcih0aGlzLm9wdGlvbnMpLHQmJnRoaXMuc2V0T3B0aW9ucyh0KSx0aGlzLmNvbnRhaW5lcj1uZXcgbih0aGlzLm9wdGlvbnMuY29udGFpbmVyKSx0aGlzLnNjcm9sbHZpZXc9bmV3IHModGhpcy5vcHRpb25zLnNjcm9sbHZpZXcpLHRoaXMuY29udGFpbmVyLmFkZCh0aGlzLnNjcm9sbHZpZXcpLHRoaXMuX2V2ZW50SW5wdXQ9bmV3IG8sby5zZXRJbnB1dEhhbmRsZXIodGhpcyx0aGlzLl9ldmVudElucHV0KSx0aGlzLl9ldmVudElucHV0LnBpcGUodGhpcy5zY3JvbGx2aWV3KSx0aGlzLl9ldmVudE91dHB1dD1uZXcgbyxvLnNldE91dHB1dEhhbmRsZXIodGhpcyx0aGlzLl9ldmVudE91dHB1dCksdGhpcy5jb250YWluZXIucGlwZSh0aGlzLl9ldmVudE91dHB1dCksdGhpcy5zY3JvbGx2aWV3LnBpcGUodGhpcy5fZXZlbnRPdXRwdXQpfXZhciBuPXQoXCIuLi9zdXJmYWNlcy9Db250YWluZXJTdXJmYWNlXCIpLG89dChcIi4uL2NvcmUvRXZlbnRIYW5kbGVyXCIpLHM9dChcIi4vU2Nyb2xsdmlld1wiKSxyPSh0KFwiLi4vdXRpbGl0aWVzL1V0aWxpdHlcIiksdChcIi4uL2NvcmUvT3B0aW9uc01hbmFnZXJcIikpO2UuREVGQVVMVF9PUFRJT05TPXtjb250YWluZXI6e3Byb3BlcnRpZXM6e292ZXJmbG93OlwiaGlkZGVuXCJ9fSxzY3JvbGx2aWV3Ont9fSxlLnByb3RvdHlwZS5zZXRPcHRpb25zPWZ1bmN0aW9uKHQpe3JldHVybiB0aGlzLl9vcHRpb25zTWFuYWdlci5zZXRPcHRpb25zKHQpfSxlLnByb3RvdHlwZS5zZXF1ZW5jZUZyb209ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5zY3JvbGx2aWV3LnNlcXVlbmNlRnJvbS5hcHBseSh0aGlzLnNjcm9sbHZpZXcsYXJndW1lbnRzKX0sZS5wcm90b3R5cGUuZ2V0U2l6ZT1mdW5jdGlvbigpe3JldHVybiB0aGlzLmNvbnRhaW5lci5nZXRTaXplLmFwcGx5KHRoaXMuY29udGFpbmVyLGFyZ3VtZW50cyl9LGUucHJvdG90eXBlLnJlbmRlcj1mdW5jdGlvbigpe3JldHVybiB0aGlzLmNvbnRhaW5lci5yZW5kZXIoKX0saS5leHBvcnRzPWV9LHtcIi4uL2NvcmUvRXZlbnRIYW5kbGVyXCI6NyxcIi4uL2NvcmUvT3B0aW9uc01hbmFnZXJcIjoxMCxcIi4uL3N1cmZhY2VzL0NvbnRhaW5lclN1cmZhY2VcIjo3NSxcIi4uL3V0aWxpdGllcy9VdGlsaXR5XCI6OTUsXCIuL1Njcm9sbHZpZXdcIjoxMDl9XSwxMDg6W2Z1bmN0aW9uKHQsaSl7ZnVuY3Rpb24gZSh0KXt0aGlzLm9wdGlvbnM9T2JqZWN0LmNyZWF0ZSh0aGlzLmNvbnN0cnVjdG9yLkRFRkFVTFRfT1BUSU9OUyksdGhpcy5fb3B0aW9uc01hbmFnZXI9bmV3IGModGhpcy5vcHRpb25zKSx0JiZ0aGlzLl9vcHRpb25zTWFuYWdlci5zZXRPcHRpb25zKHQpLHRoaXMuX25vZGU9bnVsbCx0aGlzLl9wb3NpdGlvbj0wLHRoaXMuX3Bvc2l0aW9uT2Zmc2V0PTAsdGhpcy5fcG9zaXRpb25HZXR0ZXI9bnVsbCx0aGlzLl9vdXRwdXRGdW5jdGlvbj1udWxsLHRoaXMuX21hc3Rlck91dHB1dEZ1bmN0aW9uPW51bGwsdGhpcy5vdXRwdXRGcm9tKCksdGhpcy5fb25FZGdlPTAsdGhpcy5ncm91cD1uZXcgaCx0aGlzLmdyb3VwLmFkZCh7cmVuZGVyOnIuYmluZCh0aGlzKX0pLHRoaXMuX2VudGl0eUlkPWEucmVnaXN0ZXIodGhpcyksdGhpcy5fc2l6ZT1bdm9pZCAwLHZvaWQgMF0sdGhpcy5fY29udGV4dFNpemU9W3ZvaWQgMCx2b2lkIDBdLHRoaXMuX2V2ZW50SW5wdXQ9bmV3IGYsdGhpcy5fZXZlbnRPdXRwdXQ9bmV3IGYsZi5zZXRJbnB1dEhhbmRsZXIodGhpcyx0aGlzLl9ldmVudElucHV0KSxmLnNldE91dHB1dEhhbmRsZXIodGhpcyx0aGlzLl9ldmVudE91dHB1dCl9ZnVuY3Rpb24gbih0KXt0fHwodD10aGlzLl9jb250ZXh0U2l6ZSk7dmFyIGk9dGhpcy5vcHRpb25zLmRpcmVjdGlvbjtyZXR1cm4gdm9pZCAwPT09dFtpXT90aGlzLl9jb250ZXh0U2l6ZVtpXTp0W2ldfWZ1bmN0aW9uIG8odCxpLGUpe3ZhciBvPXQuZ2V0U2l6ZT90LmdldFNpemUoKTp0aGlzLl9jb250ZXh0U2l6ZSxzPXRoaXMuX291dHB1dEZ1bmN0aW9uKGkpO3JldHVybiBlLnB1c2goe3RyYW5zZm9ybTpzLHRhcmdldDp0LnJlbmRlcigpfSksbi5jYWxsKHRoaXMsbyl9ZnVuY3Rpb24gcygpe3JldHVybiB2b2lkIDAhPT10aGlzLm9wdGlvbnMuY2xpcFNpemU/dGhpcy5vcHRpb25zLmNsaXBTaXplOnRoaXMuX2NvbnRleHRTaXplW3RoaXMub3B0aW9ucy5kaXJlY3Rpb25dPnRoaXMuZ2V0Q3VtdWxhdGl2ZVNpemUoKVt0aGlzLm9wdGlvbnMuZGlyZWN0aW9uXT9uLmNhbGwodGhpcyx0aGlzLmdldEN1bXVsYXRpdmVTaXplKCkpOm4uY2FsbCh0aGlzLHRoaXMuX2NvbnRleHRTaXplKX1mdW5jdGlvbiByKCl7Zm9yKHZhciB0PW51bGwsaT10aGlzLl9wb3NpdGlvbixlPVtdLHI9LXRoaXMuX3Bvc2l0aW9uT2Zmc2V0LGE9cy5jYWxsKHRoaXMpLGg9dGhpcy5fbm9kZTtoJiZyLWk8YSt0aGlzLm9wdGlvbnMubWFyZ2luOylyKz1vLmNhbGwodGhpcyxoLHIsZSksaD1oLmdldE5leHQ/aC5nZXROZXh0KCk6bnVsbDt2YXIgYz10aGlzLl9ub2RlLHA9bi5jYWxsKHRoaXMsYy5nZXRTaXplKCkpO2lmKGE+cil7Zm9yKDtjJiZhPnA7KWM9Yy5nZXRQcmV2aW91cygpLGMmJihwKz1uLmNhbGwodGhpcyxjLmdldFNpemUoKSkpO2ZvcihjPXRoaXMuX25vZGU7YyYmYT5wOyljPWMuZ2V0TmV4dCgpLGMmJihwKz1uLmNhbGwodGhpcyxjLmdldFNpemUoKSkpfWZvcighaCYmYS1kPnItaT8xIT09dGhpcy5fb25FZGdlJiYodGhpcy5fb25FZGdlPTEsdGhpcy5fZXZlbnRPdXRwdXQuZW1pdChcIm9uRWRnZVwiLHtwb3NpdGlvbjpyLWF9KSk6IXRoaXMuX25vZGUuZ2V0UHJldmlvdXMoKSYmLWQ+aT8tMSE9PXRoaXMuX29uRWRnZSYmKHRoaXMuX29uRWRnZT0tMSx0aGlzLl9ldmVudE91dHB1dC5lbWl0KFwib25FZGdlXCIse3Bvc2l0aW9uOjB9KSk6MCE9PXRoaXMuX29uRWRnZSYmKHRoaXMuX29uRWRnZT0wLHRoaXMuX2V2ZW50T3V0cHV0LmVtaXQoXCJvZmZFZGdlXCIpKSxoPXRoaXMuX25vZGUmJnRoaXMuX25vZGUuZ2V0UHJldmlvdXM/dGhpcy5fbm9kZS5nZXRQcmV2aW91cygpOm51bGwscj0tdGhpcy5fcG9zaXRpb25PZmZzZXQsaCYmKHQ9aC5nZXRTaXplP2guZ2V0U2l6ZSgpOnRoaXMuX2NvbnRleHRTaXplLHItPW4uY2FsbCh0aGlzLHQpKTtoJiZyLWk+LShhK3RoaXMub3B0aW9ucy5tYXJnaW4pOylvLmNhbGwodGhpcyxoLHIsZSksaD1oLmdldFByZXZpb3VzP2guZ2V0UHJldmlvdXMoKTpudWxsLGgmJih0PWguZ2V0U2l6ZT9oLmdldFNpemUoKTp0aGlzLl9jb250ZXh0U2l6ZSxyLT1uLmNhbGwodGhpcyx0KSk7cmV0dXJuIGV9dmFyIGE9dChcIi4uL2NvcmUvRW50aXR5XCIpLGg9dChcIi4uL2NvcmUvR3JvdXBcIiksYz10KFwiLi4vY29yZS9PcHRpb25zTWFuYWdlclwiKSxwPXQoXCIuLi9jb3JlL1RyYW5zZm9ybVwiKSx1PXQoXCIuLi91dGlsaXRpZXMvVXRpbGl0eVwiKSxsPXQoXCIuLi9jb3JlL1ZpZXdTZXF1ZW5jZVwiKSxmPXQoXCIuLi9jb3JlL0V2ZW50SGFuZGxlclwiKTtlLkRFRkFVTFRfT1BUSU9OUz17ZGlyZWN0aW9uOnUuRGlyZWN0aW9uLlksbWFyZ2luOjAsY2xpcFNpemU6dm9pZCAwLGdyb3VwU2Nyb2xsOiExfTt2YXIgZD0wO2UucHJvdG90eXBlLmdldEN1bXVsYXRpdmVTaXplPWZ1bmN0aW9uKHQpe3JldHVybiB2b2lkIDA9PT10JiYodD10aGlzLl9ub2RlLl8uY3VtdWxhdGl2ZVNpemVzLmxlbmd0aC0xKSx0aGlzLl9ub2RlLl8uZ2V0U2l6ZSh0KX0sZS5wcm90b3R5cGUuc2V0T3B0aW9ucz1mdW5jdGlvbih0KXt0Lmdyb3VwU2Nyb2xsIT09dGhpcy5vcHRpb25zLmdyb3VwU2Nyb2xsJiYodC5ncm91cFNjcm9sbD90aGlzLmdyb3VwLnBpcGUodGhpcy5fZXZlbnRPdXRwdXQpOnRoaXMuZ3JvdXAudW5waXBlKHRoaXMuX2V2ZW50T3V0cHV0KSksdGhpcy5fb3B0aW9uc01hbmFnZXIuc2V0T3B0aW9ucyh0KX0sZS5wcm90b3R5cGUub25FZGdlPWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuX29uRWRnZX0sZS5wcm90b3R5cGUub3V0cHV0RnJvbT1mdW5jdGlvbih0LGkpe3R8fCh0PWZ1bmN0aW9uKHQpe3JldHVybiB0aGlzLm9wdGlvbnMuZGlyZWN0aW9uPT09dS5EaXJlY3Rpb24uWD9wLnRyYW5zbGF0ZSh0LDApOnAudHJhbnNsYXRlKDAsdCl9LmJpbmQodGhpcyksaXx8KGk9dCkpLHRoaXMuX291dHB1dEZ1bmN0aW9uPXQsdGhpcy5fbWFzdGVyT3V0cHV0RnVuY3Rpb249aT9pOmZ1bmN0aW9uKGkpe3JldHVybiBwLmludmVyc2UodCgtaSkpfX0sZS5wcm90b3R5cGUucG9zaXRpb25Gcm9tPWZ1bmN0aW9uKHQpe3QgaW5zdGFuY2VvZiBGdW5jdGlvbj90aGlzLl9wb3NpdGlvbkdldHRlcj10OnQmJnQuZ2V0P3RoaXMuX3Bvc2l0aW9uR2V0dGVyPXQuZ2V0LmJpbmQodCk6KHRoaXMuX3Bvc2l0aW9uR2V0dGVyPW51bGwsdGhpcy5fcG9zaXRpb249dCksdGhpcy5fcG9zaXRpb25HZXR0ZXImJih0aGlzLl9wb3NpdGlvbj10aGlzLl9wb3NpdGlvbkdldHRlci5jYWxsKHRoaXMpKX0sZS5wcm90b3R5cGUuc2VxdWVuY2VGcm9tPWZ1bmN0aW9uKHQpe3QgaW5zdGFuY2VvZiBBcnJheSYmKHQ9bmV3IGwoe2FycmF5OnR9KSksdGhpcy5fbm9kZT10LHRoaXMuX3Bvc2l0aW9uT2Zmc2V0PTB9LGUucHJvdG90eXBlLmdldFNpemU9ZnVuY3Rpb24odCl7cmV0dXJuIHQ/dGhpcy5fY29udGV4dFNpemU6dGhpcy5fc2l6ZX0sZS5wcm90b3R5cGUucmVuZGVyPWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuX25vZGU/KHRoaXMuX3Bvc2l0aW9uR2V0dGVyJiYodGhpcy5fcG9zaXRpb249dGhpcy5fcG9zaXRpb25HZXR0ZXIuY2FsbCh0aGlzKSksdGhpcy5fZW50aXR5SWQpOm51bGx9LGUucHJvdG90eXBlLmNvbW1pdD1mdW5jdGlvbih0KXt2YXIgaT10LnRyYW5zZm9ybSxlPXQub3BhY2l0eSxuPXQub3JpZ2luLG89dC5zaXplO3RoaXMub3B0aW9ucy5jbGlwU2l6ZXx8b1swXT09PXRoaXMuX2NvbnRleHRTaXplWzBdJiZvWzFdPT09dGhpcy5fY29udGV4dFNpemVbMV18fCh0aGlzLl9vbkVkZ2U9MCx0aGlzLl9jb250ZXh0U2l6ZVswXT1vWzBdLHRoaXMuX2NvbnRleHRTaXplWzFdPW9bMV0sdGhpcy5vcHRpb25zLmRpcmVjdGlvbj09PXUuRGlyZWN0aW9uLlg/KHRoaXMuX3NpemVbMF09cy5jYWxsKHRoaXMpLHRoaXMuX3NpemVbMV09dm9pZCAwKToodGhpcy5fc2l6ZVswXT12b2lkIDAsdGhpcy5fc2l6ZVsxXT1zLmNhbGwodGhpcykpKTt2YXIgcj10aGlzLl9tYXN0ZXJPdXRwdXRGdW5jdGlvbigtdGhpcy5fcG9zaXRpb24pO3JldHVybnt0cmFuc2Zvcm06cC5tdWx0aXBseShpLHIpLHNpemU6byxvcGFjaXR5OmUsb3JpZ2luOm4sdGFyZ2V0OnRoaXMuZ3JvdXAucmVuZGVyKCl9fSxpLmV4cG9ydHM9ZX0se1wiLi4vY29yZS9FbnRpdHlcIjo1LFwiLi4vY29yZS9FdmVudEhhbmRsZXJcIjo3LFwiLi4vY29yZS9Hcm91cFwiOjgsXCIuLi9jb3JlL09wdGlvbnNNYW5hZ2VyXCI6MTAsXCIuLi9jb3JlL1RyYW5zZm9ybVwiOjE1LFwiLi4vY29yZS9WaWV3U2VxdWVuY2VcIjoxNyxcIi4uL3V0aWxpdGllcy9VdGlsaXR5XCI6OTV9XSwxMDk6W2Z1bmN0aW9uKHQsaSl7ZnVuY3Rpb24gZSh0KXt0aGlzLm9wdGlvbnM9T2JqZWN0LmNyZWF0ZShlLkRFRkFVTFRfT1BUSU9OUyksdGhpcy5fb3B0aW9uc01hbmFnZXI9bmV3IE8odGhpcy5vcHRpb25zKSx0aGlzLl9zY3JvbGxlcj1uZXcgVCh0aGlzLm9wdGlvbnMpLHRoaXMuc3luYz1uZXcgYihbXCJzY3JvbGxcIixcInRvdWNoXCJdLHtkaXJlY3Rpb246dGhpcy5vcHRpb25zLmRpcmVjdGlvbixzY2FsZTp0aGlzLm9wdGlvbnMuc3luY1NjYWxlLHJhaWxzOnRoaXMub3B0aW9ucy5yYWlscyxwcmV2ZW50RGVmYXVsdDp2b2lkIDAhPT10aGlzLm9wdGlvbnMucHJldmVudERlZmF1bHQ/dGhpcy5vcHRpb25zLnByZXZlbnREZWZhdWx0OnRoaXMub3B0aW9ucy5kaXJlY3Rpb24hPT13LkRpcmVjdGlvbi5ZfSksdGhpcy5fcGh5c2ljc0VuZ2luZT1uZXcgXyx0aGlzLl9wYXJ0aWNsZT1uZXcgeSx0aGlzLl9waHlzaWNzRW5naW5lLmFkZEJvZHkodGhpcy5fcGFydGljbGUpLHRoaXMuc3ByaW5nPW5ldyB2KHthbmNob3I6WzAsMCwwXSxwZXJpb2Q6dGhpcy5vcHRpb25zLmVkZ2VQZXJpb2QsZGFtcGluZ1JhdGlvOnRoaXMub3B0aW9ucy5lZGdlRGFtcH0pLHRoaXMuZHJhZz1uZXcgZyh7Zm9yY2VGdW5jdGlvbjpnLkZPUkNFX0ZVTkNUSU9OUy5RVUFEUkFUSUMsc3RyZW5ndGg6dGhpcy5vcHRpb25zLmRyYWd9KSx0aGlzLmZyaWN0aW9uPW5ldyBnKHtmb3JjZUZ1bmN0aW9uOmcuRk9SQ0VfRlVOQ1RJT05TLkxJTkVBUixzdHJlbmd0aDp0aGlzLm9wdGlvbnMuZnJpY3Rpb259KSx0aGlzLl9ub2RlPW51bGwsdGhpcy5fdG91Y2hDb3VudD0wLHRoaXMuX3NwcmluZ1N0YXRlPXguTk9ORSx0aGlzLl9vbkVkZ2U9TS5OT05FLHRoaXMuX3BhZ2VTcHJpbmdQb3NpdGlvbj0wLHRoaXMuX2VkZ2VTcHJpbmdQb3NpdGlvbj0wLHRoaXMuX3RvdWNoVmVsb2NpdHk9MCx0aGlzLl9lYXJseUVuZD0hMSx0aGlzLl9uZWVkc1BhZ2luYXRpb25DaGVjaz0hMSx0aGlzLl9kaXNwbGFjZW1lbnQ9MCx0aGlzLl90b3RhbFNoaWZ0PTAsdGhpcy5fY2FjaGVkSW5kZXg9MCx0aGlzLl9zY3JvbGxlci5wb3NpdGlvbkZyb20odGhpcy5nZXRQb3NpdGlvbi5iaW5kKHRoaXMpKSx0aGlzLl9ldmVudElucHV0PW5ldyBtLHRoaXMuX2V2ZW50T3V0cHV0PW5ldyBtLHRoaXMuX2V2ZW50SW5wdXQucGlwZSh0aGlzLnN5bmMpLHRoaXMuc3luYy5waXBlKHRoaXMuX2V2ZW50SW5wdXQpLG0uc2V0SW5wdXRIYW5kbGVyKHRoaXMsdGhpcy5fZXZlbnRJbnB1dCksbS5zZXRPdXRwdXRIYW5kbGVyKHRoaXMsdGhpcy5fZXZlbnRPdXRwdXQpLHIuY2FsbCh0aGlzKSx0JiZ0aGlzLnNldE9wdGlvbnModCl9ZnVuY3Rpb24gbih0KXt0aGlzLl90b3VjaENvdW50PXQuY291bnQsdm9pZCAwPT09dC5jb3VudCYmKHRoaXMuX3RvdWNoQ291bnQ9MSksaC5jYWxsKHRoaXMpLHRoaXMuc2V0VmVsb2NpdHkoMCksdGhpcy5fdG91Y2hWZWxvY2l0eT0wLHRoaXMuX2Vhcmx5RW5kPSExfWZ1bmN0aW9uIG8odCl7dmFyIGk9LXQudmVsb2NpdHksZT0tdC5kZWx0YTtpZih0aGlzLl9vbkVkZ2UhPT1NLk5PTkUmJnQuc2xpcCYmKDA+aSYmdGhpcy5fb25FZGdlPT09TS5UT1B8fGk+MCYmdGhpcy5fb25FZGdlPT09TS5CT1RUT00/dGhpcy5fZWFybHlFbmR8fChzLmNhbGwodGhpcyx0KSx0aGlzLl9lYXJseUVuZD0hMCk6dGhpcy5fZWFybHlFbmQmJk1hdGguYWJzKGkpPk1hdGguYWJzKHRoaXMuZ2V0VmVsb2NpdHkoKSkmJm4uY2FsbCh0aGlzLHQpKSwhdGhpcy5fZWFybHlFbmQpe2lmKHRoaXMuX3RvdWNoVmVsb2NpdHk9aSx0LnNsaXApe3ZhciBvPXRoaXMub3B0aW9ucy5zcGVlZExpbWl0Oy1vPmk/aT0tbzppPm8mJihpPW8pLHRoaXMuc2V0VmVsb2NpdHkoaSk7dmFyIHI9MTYqbztlPnI/ZT1yOi1yPmUmJihlPS1yKX10aGlzLnNldFBvc2l0aW9uKHRoaXMuZ2V0UG9zaXRpb24oKStlKSx0aGlzLl9kaXNwbGFjZW1lbnQrPWUsdGhpcy5fc3ByaW5nU3RhdGU9PT14Lk5PTkUmJmYuY2FsbCh0aGlzKX19ZnVuY3Rpb24gcyh0KXtpZih0aGlzLl90b3VjaENvdW50PXQuY291bnR8fDAsIXRoaXMuX3RvdWNoQ291bnQpe2guY2FsbCh0aGlzKSx0aGlzLl9vbkVkZ2UhPT1NLk5PTkUmJmwuY2FsbCh0aGlzLHRoaXMuX2VkZ2VTcHJpbmdQb3NpdGlvbix4LkVER0UpLGEuY2FsbCh0aGlzKTt2YXIgaT0tdC52ZWxvY2l0eSxlPXRoaXMub3B0aW9ucy5zcGVlZExpbWl0O3Quc2xpcCYmKGUqPXRoaXMub3B0aW9ucy5lZGdlR3JpcCksLWU+aT9pPS1lOmk+ZSYmKGk9ZSksdGhpcy5zZXRWZWxvY2l0eShpKSx0aGlzLl90b3VjaFZlbG9jaXR5PTAsdGhpcy5fbmVlZHNQYWdpbmF0aW9uQ2hlY2s9ITB9fWZ1bmN0aW9uIHIoKXt0aGlzLl9ldmVudElucHV0LmJpbmRUaGlzKHRoaXMpLHRoaXMuX2V2ZW50SW5wdXQub24oXCJzdGFydFwiLG4pLHRoaXMuX2V2ZW50SW5wdXQub24oXCJ1cGRhdGVcIixvKSx0aGlzLl9ldmVudElucHV0Lm9uKFwiZW5kXCIscyksdGhpcy5fZXZlbnRJbnB1dC5vbihcInJlc2l6ZVwiLGZ1bmN0aW9uKCl7dGhpcy5fbm9kZS5fLmNhbGN1bGF0ZVNpemUoKX0uYmluZCh0aGlzKSksdGhpcy5fc2Nyb2xsZXIub24oXCJvbkVkZ2VcIixmdW5jdGlvbih0KXt0aGlzLl9lZGdlU3ByaW5nUG9zaXRpb249dC5wb3NpdGlvbixwLmNhbGwodGhpcyx0aGlzLl9zY3JvbGxlci5vbkVkZ2UoKSksdGhpcy5fZXZlbnRPdXRwdXQuZW1pdChcIm9uRWRnZVwiKX0uYmluZCh0aGlzKSksdGhpcy5fc2Nyb2xsZXIub24oXCJvZmZFZGdlXCIsZnVuY3Rpb24oKXt0aGlzLnN5bmMuc2V0T3B0aW9ucyh7c2NhbGU6dGhpcy5vcHRpb25zLnN5bmNTY2FsZX0pLHRoaXMuX29uRWRnZT10aGlzLl9zY3JvbGxlci5vbkVkZ2UoKSx0aGlzLl9ldmVudE91dHB1dC5lbWl0KFwib2ZmRWRnZVwiKX0uYmluZCh0aGlzKSksdGhpcy5fcGFydGljbGUub24oXCJ1cGRhdGVcIixmdW5jdGlvbih0KXt0aGlzLl9zcHJpbmdTdGF0ZT09PXguTk9ORSYmZi5jYWxsKHRoaXMpLHRoaXMuX2Rpc3BsYWNlbWVudD10LnBvc2l0aW9uLngtdGhpcy5fdG90YWxTaGlmdH0uYmluZCh0aGlzKSksdGhpcy5fcGFydGljbGUub24oXCJlbmRcIixmdW5jdGlvbigpeyghdGhpcy5vcHRpb25zLnBhZ2luYXRlZHx8dGhpcy5vcHRpb25zLnBhZ2luYXRlZCYmdGhpcy5fc3ByaW5nU3RhdGUhPT14Lk5PTkUpJiZ0aGlzLl9ldmVudE91dHB1dC5lbWl0KFwic2V0dGxlXCIpfS5iaW5kKHRoaXMpKX1mdW5jdGlvbiBhKCl7dGhpcy5fc3ByaW5nU3RhdGU/dGhpcy5fcGh5c2ljc0VuZ2luZS5hdHRhY2goW3RoaXMuc3ByaW5nXSx0aGlzLl9wYXJ0aWNsZSk6dGhpcy5fcGh5c2ljc0VuZ2luZS5hdHRhY2goW3RoaXMuZHJhZyx0aGlzLmZyaWN0aW9uXSx0aGlzLl9wYXJ0aWNsZSl9ZnVuY3Rpb24gaCgpe3RoaXMuX3NwcmluZ1N0YXRlPXguTk9ORSx0aGlzLl9waHlzaWNzRW5naW5lLmRldGFjaEFsbCgpfWZ1bmN0aW9uIGModCl7dmFyIGk9dGhpcy5vcHRpb25zLmRpcmVjdGlvbixlPXQuZ2V0U2l6ZSgpO3JldHVybiBlP2VbaV06dGhpcy5fc2Nyb2xsZXIuZ2V0U2l6ZSgpW2ldfWZ1bmN0aW9uIHAodCl7dGhpcy5zeW5jLnNldE9wdGlvbnMoe3NjYWxlOnRoaXMub3B0aW9ucy5lZGdlR3JpcH0pLHRoaXMuX29uRWRnZT10LHRoaXMuX3RvdWNoQ291bnR8fHRoaXMuX3NwcmluZ1N0YXRlPT09eC5FREdFfHxsLmNhbGwodGhpcyx0aGlzLl9lZGdlU3ByaW5nUG9zaXRpb24seC5FREdFKSx0aGlzLl9zcHJpbmdTdGF0ZSYmTWF0aC5hYnModGhpcy5nZXRWZWxvY2l0eSgpKTwuMDAxJiYoaC5jYWxsKHRoaXMpLGEuY2FsbCh0aGlzKSl9ZnVuY3Rpb24gdSgpe2lmKCF0aGlzLl90b3VjaENvdW50JiZ0aGlzLl9zcHJpbmdTdGF0ZSE9PXguRURHRSl7dmFyIHQ9dGhpcy5nZXRWZWxvY2l0eSgpO2lmKCEoTWF0aC5hYnModCk+PXRoaXMub3B0aW9ucy5wYWdlU3RvcFNwZWVkKSl7dmFyIGk9dGhpcy5nZXRQb3NpdGlvbigpLGU9TWF0aC5hYnModCk+dGhpcy5vcHRpb25zLnBhZ2VTd2l0Y2hTcGVlZCxuPWMuY2FsbCh0aGlzLHRoaXMuX25vZGUpLG89aT4uNSpuLHM9dD4wLHI9MD50O3RoaXMuX25lZWRzUGFnaW5hdGlvbkNoZWNrPSExLG8mJiFlfHxlJiZzP3RoaXMuZ29Ub05leHRQYWdlKCk6ZSYmcj90aGlzLmdvVG9QcmV2aW91c1BhZ2UoKTpsLmNhbGwodGhpcywwLHguUEFHRSl9fX1mdW5jdGlvbiBsKHQsaSl7dmFyIGU7aT09PXguRURHRT8odGhpcy5fZWRnZVNwcmluZ1Bvc2l0aW9uPXQsZT17YW5jaG9yOlt0aGlzLl9lZGdlU3ByaW5nUG9zaXRpb24sMCwwXSxwZXJpb2Q6dGhpcy5vcHRpb25zLmVkZ2VQZXJpb2QsZGFtcGluZ1JhdGlvOnRoaXMub3B0aW9ucy5lZGdlRGFtcH0pOmk9PT14LlBBR0UmJih0aGlzLl9wYWdlU3ByaW5nUG9zaXRpb249dCxlPXthbmNob3I6W3RoaXMuX3BhZ2VTcHJpbmdQb3NpdGlvbiwwLDBdLHBlcmlvZDp0aGlzLm9wdGlvbnMucGFnZVBlcmlvZCxkYW1waW5nUmF0aW86dGhpcy5vcHRpb25zLnBhZ2VEYW1wfSksdGhpcy5zcHJpbmcuc2V0T3B0aW9ucyhlKSxpJiYhdGhpcy5fc3ByaW5nU3RhdGUmJihoLmNhbGwodGhpcyksdGhpcy5fc3ByaW5nU3RhdGU9aSxhLmNhbGwodGhpcykpLHRoaXMuX3NwcmluZ1N0YXRlPWl9ZnVuY3Rpb24gZigpe3ZhciB0PTAsaT10aGlzLmdldFBvc2l0aW9uKCk7aSs9KDA+aT8tLjU6LjUpPj4wO2Zvcih2YXIgZT1jLmNhbGwodGhpcyx0aGlzLl9ub2RlKSxuPXRoaXMuX25vZGUuZ2V0TmV4dCgpO3QraT49ZSYmbjspdC09ZSx0aGlzLl9zY3JvbGxlci5zZXF1ZW5jZUZyb20obiksdGhpcy5fbm9kZT1uLG49dGhpcy5fbm9kZS5nZXROZXh0KCksZT1jLmNhbGwodGhpcyx0aGlzLl9ub2RlKTtmb3IodmFyIG8scz10aGlzLl9ub2RlLmdldFByZXZpb3VzKCk7MD49dCtpJiZzOylvPWMuY2FsbCh0aGlzLHMpLHRoaXMuX3Njcm9sbGVyLnNlcXVlbmNlRnJvbShzKSx0aGlzLl9ub2RlPXMsdCs9byxzPXRoaXMuX25vZGUuZ2V0UHJldmlvdXMoKTt0JiZkLmNhbGwodGhpcyx0KSx0aGlzLl9ub2RlJiYodGhpcy5fbm9kZS5pbmRleCE9PXRoaXMuX2NhY2hlZEluZGV4P3RoaXMuZ2V0UG9zaXRpb24oKTwuNSplJiYodGhpcy5fY2FjaGVkSW5kZXg9dGhpcy5fbm9kZS5pbmRleCx0aGlzLl9ldmVudE91dHB1dC5lbWl0KFwicGFnZUNoYW5nZVwiLHtkaXJlY3Rpb246LTEsaW5kZXg6dGhpcy5fY2FjaGVkSW5kZXh9KSk6dGhpcy5nZXRQb3NpdGlvbigpPi41KmUmJih0aGlzLl9jYWNoZWRJbmRleD10aGlzLl9ub2RlLmluZGV4KzEsdGhpcy5fZXZlbnRPdXRwdXQuZW1pdChcInBhZ2VDaGFuZ2VcIix7ZGlyZWN0aW9uOjEsaW5kZXg6dGhpcy5fY2FjaGVkSW5kZXh9KSkpfWZ1bmN0aW9uIGQodCl7dGhpcy5fZWRnZVNwcmluZ1Bvc2l0aW9uKz10LHRoaXMuX3BhZ2VTcHJpbmdQb3NpdGlvbis9dCx0aGlzLnNldFBvc2l0aW9uKHRoaXMuZ2V0UG9zaXRpb24oKSt0KSx0aGlzLl90b3RhbFNoaWZ0Kz10LHRoaXMuX3NwcmluZ1N0YXRlPT09eC5FREdFP3RoaXMuc3ByaW5nLnNldE9wdGlvbnMoe2FuY2hvcjpbdGhpcy5fZWRnZVNwcmluZ1Bvc2l0aW9uLDAsMF19KTp0aGlzLl9zcHJpbmdTdGF0ZT09PXguUEFHRSYmdGhpcy5zcHJpbmcuc2V0T3B0aW9ucyh7YW5jaG9yOlt0aGlzLl9wYWdlU3ByaW5nUG9zaXRpb24sMCwwXX0pfXZhciBfPXQoXCIuLi9waHlzaWNzL1BoeXNpY3NFbmdpbmVcIikseT10KFwiLi4vcGh5c2ljcy9ib2RpZXMvUGFydGljbGVcIiksZz10KFwiLi4vcGh5c2ljcy9mb3JjZXMvRHJhZ1wiKSx2PXQoXCIuLi9waHlzaWNzL2ZvcmNlcy9TcHJpbmdcIiksbT10KFwiLi4vY29yZS9FdmVudEhhbmRsZXJcIiksTz10KFwiLi4vY29yZS9PcHRpb25zTWFuYWdlclwiKSxTPXQoXCIuLi9jb3JlL1ZpZXdTZXF1ZW5jZVwiKSxUPXQoXCIuLi92aWV3cy9TY3JvbGxlclwiKSx3PXQoXCIuLi91dGlsaXRpZXMvVXRpbGl0eVwiKSxiPXQoXCIuLi9pbnB1dHMvR2VuZXJpY1N5bmNcIiksRT10KFwiLi4vaW5wdXRzL1Njcm9sbFN5bmNcIiksST10KFwiLi4vaW5wdXRzL1RvdWNoU3luY1wiKTtiLnJlZ2lzdGVyKHtzY3JvbGw6RSx0b3VjaDpJfSk7dmFyIHg9e05PTkU6MCxFREdFOjEsUEFHRToyfSxNPXtUT1A6LTEsTk9ORTowLEJPVFRPTToxfTtlLkRFRkFVTFRfT1BUSU9OUz17ZGlyZWN0aW9uOncuRGlyZWN0aW9uLlkscmFpbHM6ITAsZnJpY3Rpb246LjAwNSxkcmFnOjFlLTQsZWRnZUdyaXA6LjIsZWRnZVBlcmlvZDozMDAsZWRnZURhbXA6MSxtYXJnaW46MWUzLHBhZ2luYXRlZDohMSxwYWdlUGVyaW9kOjUwMCxwYWdlRGFtcDouOCxwYWdlU3RvcFNwZWVkOjEwLHBhZ2VTd2l0Y2hTcGVlZDouNSxzcGVlZExpbWl0OjUsZ3JvdXBTY3JvbGw6ITEsc3luY1NjYWxlOjF9LGUucHJvdG90eXBlLmdldEN1cnJlbnRJbmRleD1mdW5jdGlvbigpe3JldHVybiB0aGlzLl9ub2RlLmluZGV4fSxlLnByb3RvdHlwZS5nb1RvUHJldmlvdXNQYWdlPWZ1bmN0aW9uKCl7aWYoIXRoaXMuX25vZGV8fHRoaXMuX29uRWRnZT09PU0uVE9QKXJldHVybiBudWxsO2lmKHRoaXMuZ2V0UG9zaXRpb24oKT4xJiZ0aGlzLl9zcHJpbmdTdGF0ZT09PXguTk9ORSlyZXR1cm4gbC5jYWxsKHRoaXMsMCx4LlBBR0UpLHRoaXMuX25vZGU7dmFyIHQ9dGhpcy5fbm9kZS5nZXRQcmV2aW91cygpO2lmKHQpe3ZhciBpPWMuY2FsbCh0aGlzLHQpO3RoaXMuX3Njcm9sbGVyLnNlcXVlbmNlRnJvbSh0KSx0aGlzLl9ub2RlPXQsZC5jYWxsKHRoaXMsaSksbC5jYWxsKHRoaXMsMCx4LlBBR0UpfXJldHVybiB0fSxlLnByb3RvdHlwZS5nb1RvTmV4dFBhZ2U9ZnVuY3Rpb24oKXtpZighdGhpcy5fbm9kZXx8dGhpcy5fb25FZGdlPT09TS5CT1RUT00pcmV0dXJuIG51bGw7dmFyIHQ9dGhpcy5fbm9kZS5nZXROZXh0KCk7aWYodCl7dmFyIGk9Yy5jYWxsKHRoaXMsdGhpcy5fbm9kZSk7dGhpcy5fc2Nyb2xsZXIuc2VxdWVuY2VGcm9tKHQpLHRoaXMuX25vZGU9dCxkLmNhbGwodGhpcywtaSksbC5jYWxsKHRoaXMsMCx4LlBBR0UpfXJldHVybiB0fSxlLnByb3RvdHlwZS5nb1RvUGFnZT1mdW5jdGlvbih0KXt2YXIgaSxlPXRoaXMuZ2V0Q3VycmVudEluZGV4KCk7aWYoZT50KWZvcihpPTA7ZS10Pmk7aSsrKXRoaXMuZ29Ub1ByZXZpb3VzUGFnZSgpO2lmKHQ+ZSlmb3IoaT0wO3QtZT5pO2krKyl0aGlzLmdvVG9OZXh0UGFnZSgpfSxlLnByb3RvdHlwZS5vdXRwdXRGcm9tPWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuX3Njcm9sbGVyLm91dHB1dEZyb20uYXBwbHkodGhpcy5fc2Nyb2xsZXIsYXJndW1lbnRzKX0sZS5wcm90b3R5cGUuZ2V0UG9zaXRpb249ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5fcGFydGljbGUuZ2V0UG9zaXRpb24xRCgpfSxlLnByb3RvdHlwZS5nZXRBYnNvbHV0ZVBvc2l0aW9uPWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuX3Njcm9sbGVyLmdldEN1bXVsYXRpdmVTaXplKHRoaXMuZ2V0Q3VycmVudEluZGV4KCkpW3RoaXMub3B0aW9ucy5kaXJlY3Rpb25dK3RoaXMuZ2V0UG9zaXRpb24oKX0sZS5wcm90b3R5cGUuZ2V0T2Zmc2V0PWUucHJvdG90eXBlLmdldFBvc2l0aW9uLGUucHJvdG90eXBlLnNldFBvc2l0aW9uPWZ1bmN0aW9uKHQpe3RoaXMuX3BhcnRpY2xlLnNldFBvc2l0aW9uMUQodCl9LGUucHJvdG90eXBlLnNldE9mZnNldD1lLnByb3RvdHlwZS5zZXRQb3NpdGlvbixlLnByb3RvdHlwZS5nZXRWZWxvY2l0eT1mdW5jdGlvbigpe3JldHVybiB0aGlzLl90b3VjaENvdW50P3RoaXMuX3RvdWNoVmVsb2NpdHk6dGhpcy5fcGFydGljbGUuZ2V0VmVsb2NpdHkxRCgpfSxlLnByb3RvdHlwZS5zZXRWZWxvY2l0eT1mdW5jdGlvbih0KXt0aGlzLl9wYXJ0aWNsZS5zZXRWZWxvY2l0eTFEKHQpfSxlLnByb3RvdHlwZS5zZXRPcHRpb25zPWZ1bmN0aW9uKHQpe3ZvaWQgMCE9PXQuZGlyZWN0aW9uJiYoXCJ4XCI9PT10LmRpcmVjdGlvbj90LmRpcmVjdGlvbj13LkRpcmVjdGlvbi5YOlwieVwiPT09dC5kaXJlY3Rpb24mJih0LmRpcmVjdGlvbj13LkRpcmVjdGlvbi5ZKSksdC5ncm91cFNjcm9sbCE9PXRoaXMub3B0aW9ucy5ncm91cFNjcm9sbCYmKHQuZ3JvdXBTY3JvbGw/dGhpcy5zdWJzY3JpYmUodGhpcy5fc2Nyb2xsZXIpOnRoaXMudW5zdWJzY3JpYmUodGhpcy5fc2Nyb2xsZXIpKSx0aGlzLl9vcHRpb25zTWFuYWdlci5zZXRPcHRpb25zKHQpLHRoaXMuX3Njcm9sbGVyLnNldE9wdGlvbnModCksdm9pZCAwIT09dC5kcmFnJiZ0aGlzLmRyYWcuc2V0T3B0aW9ucyh7c3RyZW5ndGg6dGhpcy5vcHRpb25zLmRyYWd9KSx2b2lkIDAhPT10LmZyaWN0aW9uJiZ0aGlzLmZyaWN0aW9uLnNldE9wdGlvbnMoe3N0cmVuZ3RoOnRoaXMub3B0aW9ucy5mcmljdGlvbn0pLCh2b2lkIDAhPT10LmVkZ2VQZXJpb2R8fHZvaWQgMCE9PXQuZWRnZURhbXApJiZ0aGlzLnNwcmluZy5zZXRPcHRpb25zKHtwZXJpb2Q6dGhpcy5vcHRpb25zLmVkZ2VQZXJpb2QsZGFtcGluZ1JhdGlvOnRoaXMub3B0aW9ucy5lZGdlRGFtcH0pLCh0LnJhaWxzfHx2b2lkIDAhPT10LmRpcmVjdGlvbnx8dm9pZCAwIT09dC5zeW5jU2NhbGV8fHQucHJldmVudERlZmF1bHQpJiZ0aGlzLnN5bmMuc2V0T3B0aW9ucyh7cmFpbHM6dGhpcy5vcHRpb25zLnJhaWxzLGRpcmVjdGlvbjp0aGlzLm9wdGlvbnMuZGlyZWN0aW9uPT09dy5EaXJlY3Rpb24uWD9iLkRJUkVDVElPTl9YOmIuRElSRUNUSU9OX1ksc2NhbGU6dGhpcy5vcHRpb25zLnN5bmNTY2FsZSxwcmV2ZW50RGVmYXVsdDp0aGlzLm9wdGlvbnMucHJldmVudERlZmF1bHR9KX0sZS5wcm90b3R5cGUuc2VxdWVuY2VGcm9tPWZ1bmN0aW9uKHQpe3JldHVybiB0IGluc3RhbmNlb2YgQXJyYXkmJih0PW5ldyBTKHthcnJheTp0LHRyYWNrU2l6ZTohMH0pKSx0aGlzLl9ub2RlPXQsdGhpcy5fc2Nyb2xsZXIuc2VxdWVuY2VGcm9tKHQpfSxlLnByb3RvdHlwZS5nZXRTaXplPWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuX3Njcm9sbGVyLmdldFNpemUuYXBwbHkodGhpcy5fc2Nyb2xsZXIsYXJndW1lbnRzKX0sZS5wcm90b3R5cGUucmVuZGVyPWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMub3B0aW9ucy5wYWdpbmF0ZWQmJnRoaXMuX25lZWRzUGFnaW5hdGlvbkNoZWNrJiZ1LmNhbGwodGhpcyksdGhpcy5fc2Nyb2xsZXIucmVuZGVyKCl9LGkuZXhwb3J0cz1lfSx7XCIuLi9jb3JlL0V2ZW50SGFuZGxlclwiOjcsXCIuLi9jb3JlL09wdGlvbnNNYW5hZ2VyXCI6MTAsXCIuLi9jb3JlL1ZpZXdTZXF1ZW5jZVwiOjE3LFwiLi4vaW5wdXRzL0dlbmVyaWNTeW5jXCI6MjcsXCIuLi9pbnB1dHMvU2Nyb2xsU3luY1wiOjMyLFwiLi4vaW5wdXRzL1RvdWNoU3luY1wiOjMzLFwiLi4vcGh5c2ljcy9QaHlzaWNzRW5naW5lXCI6NDgsXCIuLi9waHlzaWNzL2JvZGllcy9QYXJ0aWNsZVwiOjUxLFwiLi4vcGh5c2ljcy9mb3JjZXMvRHJhZ1wiOjYzLFwiLi4vcGh5c2ljcy9mb3JjZXMvU3ByaW5nXCI6NjgsXCIuLi91dGlsaXRpZXMvVXRpbGl0eVwiOjk1LFwiLi4vdmlld3MvU2Nyb2xsZXJcIjoxMDh9XSwxMTA6W2Z1bmN0aW9uKHQsaSl7ZnVuY3Rpb24gZSh0KXt0aGlzLl9pdGVtcz1udWxsLHRoaXMuX3NpemU9bnVsbCx0aGlzLl9vdXRwdXRGdW5jdGlvbj1lLkRFRkFVTFRfT1VUUFVUX0ZVTkNUSU9OLHRoaXMub3B0aW9ucz1yLmNsb25lKHRoaXMuY29uc3RydWN0b3IuREVGQVVMVF9PUFRJT05TfHxlLkRFRkFVTFRfT1BUSU9OUyksdGhpcy5vcHRpb25zTWFuYWdlcj1uZXcgbih0aGlzLm9wdGlvbnMpLHQmJnRoaXMuc2V0T3B0aW9ucyh0KX12YXIgbj10KFwiLi4vY29yZS9PcHRpb25zTWFuYWdlclwiKSxvPXQoXCIuLi9jb3JlL1RyYW5zZm9ybVwiKSxzPXQoXCIuLi9jb3JlL1ZpZXdTZXF1ZW5jZVwiKSxyPXQoXCIuLi91dGlsaXRpZXMvVXRpbGl0eVwiKTtlLkRFRkFVTFRfT1BUSU9OUz17ZGlyZWN0aW9uOnIuRGlyZWN0aW9uLlksaXRlbVNwYWNpbmc6MH0sZS5ERUZBVUxUX09VVFBVVF9GVU5DVElPTj1mdW5jdGlvbih0LGkpe3ZhciBlPXRoaXMub3B0aW9ucy5kaXJlY3Rpb249PT1yLkRpcmVjdGlvbi5YP28udHJhbnNsYXRlKGksMCk6by50cmFuc2xhdGUoMCxpKTtyZXR1cm57dHJhbnNmb3JtOmUsdGFyZ2V0OnQucmVuZGVyKCl9fSxlLnByb3RvdHlwZS5nZXRTaXplPWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuX3NpemV8fHRoaXMucmVuZGVyKCksdGhpcy5fc2l6ZX0sZS5wcm90b3R5cGUuc2VxdWVuY2VGcm9tPWZ1bmN0aW9uKHQpe3JldHVybiB0IGluc3RhbmNlb2YgQXJyYXkmJih0PW5ldyBzKHQpKSx0aGlzLl9pdGVtcz10LHRoaXN9LGUucHJvdG90eXBlLnNldE9wdGlvbnM9ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5vcHRpb25zTWFuYWdlci5zZXRPcHRpb25zLmFwcGx5KHRoaXMub3B0aW9uc01hbmFnZXIsYXJndW1lbnRzKSx0aGlzfSxlLnByb3RvdHlwZS5zZXRPdXRwdXRGdW5jdGlvbj1mdW5jdGlvbih0KXtyZXR1cm4gdGhpcy5fb3V0cHV0RnVuY3Rpb249dCx0aGlzfSxlLnByb3RvdHlwZS5yZW5kZXI9ZnVuY3Rpb24oKXt2YXIgdD0wLGk9MV50aGlzLm9wdGlvbnMuZGlyZWN0aW9uLGU9dGhpcy5faXRlbXMsbj1udWxsLG89W10scz17fSxyPVtdLGE9MDtmb3IodGhpcy5fc2l6ZT1bMCwwXTtlJiYobj1lLmdldCgpKTspbi5nZXRTaXplJiYobz1uLmdldFNpemUoKSkscz10aGlzLl9vdXRwdXRGdW5jdGlvbi5jYWxsKHRoaXMsbix0LGErKyksci5wdXNoKHMpLG8mJihvW3RoaXMub3B0aW9ucy5kaXJlY3Rpb25dJiYodCs9b1t0aGlzLm9wdGlvbnMuZGlyZWN0aW9uXSksb1tpXT50aGlzLl9zaXplW2ldJiYodGhpcy5fc2l6ZVtpXT1vW2ldKSksZT1lLmdldE5leHQoKSx0aGlzLm9wdGlvbnMuaXRlbVNwYWNpbmcmJmUmJih0Kz10aGlzLm9wdGlvbnMuaXRlbVNwYWNpbmcpO3JldHVybiB0aGlzLl9zaXplW3RoaXMub3B0aW9ucy5kaXJlY3Rpb25dPXQscn0saS5leHBvcnRzPWV9LHtcIi4uL2NvcmUvT3B0aW9uc01hbmFnZXJcIjoxMCxcIi4uL2NvcmUvVHJhbnNmb3JtXCI6MTUsXCIuLi9jb3JlL1ZpZXdTZXF1ZW5jZVwiOjE3LFwiLi4vdXRpbGl0aWVzL1V0aWxpdHlcIjo5NX1dLDExMTpbZnVuY3Rpb24odCxpKXtpLmV4cG9ydHM9e0NvbnRleHR1YWxWaWV3OnQoXCIuL0NvbnRleHR1YWxWaWV3XCIpLERlY2s6dChcIi4vRGVja1wiKSxFZGdlU3dhcHBlcjp0KFwiLi9FZGdlU3dhcHBlclwiKSxEcmF3ZXJMYXlvdXQ6dChcIi4vRHJhd2VyTGF5b3V0XCIpLEZsZXhpYmxlTGF5b3V0OnQoXCIuL0ZsZXhpYmxlTGF5b3V0XCIpLEZsaXBwZXI6dChcIi4vRmxpcHBlclwiKSxHcmlkTGF5b3V0OnQoXCIuL0dyaWRMYXlvdXRcIiksSGVhZGVyRm9vdGVyTGF5b3V0OnQoXCIuL0hlYWRlckZvb3RlckxheW91dFwiKSxMaWdodGJveDp0KFwiLi9MaWdodGJveFwiKSxSZW5kZXJDb250cm9sbGVyOnQoXCIuL1JlbmRlckNvbnRyb2xsZXJcIiksU2Nyb2xsQ29udGFpbmVyOnQoXCIuL1Njcm9sbENvbnRhaW5lclwiKSxTY3JvbGxlcjp0KFwiLi9TY3JvbGxlclwiKSxTY3JvbGx2aWV3OnQoXCIuL1Njcm9sbHZpZXdcIiksU2VxdWVudGlhbExheW91dDp0KFwiLi9TZXF1ZW50aWFsTGF5b3V0XCIpfX0se1wiLi9Db250ZXh0dWFsVmlld1wiOjk3LFwiLi9EZWNrXCI6OTgsXCIuL0RyYXdlckxheW91dFwiOjk5LFwiLi9FZGdlU3dhcHBlclwiOjEwMCxcIi4vRmxleGlibGVMYXlvdXRcIjoxMDEsXCIuL0ZsaXBwZXJcIjoxMDIsXCIuL0dyaWRMYXlvdXRcIjoxMDMsXCIuL0hlYWRlckZvb3RlckxheW91dFwiOjEwNCxcIi4vTGlnaHRib3hcIjoxMDUsXCIuL1JlbmRlckNvbnRyb2xsZXJcIjoxMDYsXCIuL1Njcm9sbENvbnRhaW5lclwiOjEwNyxcIi4vU2Nyb2xsZXJcIjoxMDgsXCIuL1Njcm9sbHZpZXdcIjoxMDksXCIuL1NlcXVlbnRpYWxMYXlvdXRcIjoxMTB9XSwxMTI6W2Z1bmN0aW9uKHQsaSl7ZnVuY3Rpb24gZSgpe3IuYXBwbHkodGhpcyxhcmd1bWVudHMpLHRoaXMudGl0bGU9bmV3IG8oe2NsYXNzZXM6dGhpcy5vcHRpb25zLmNsYXNzZXMsY29udGVudDp0aGlzLm9wdGlvbnMuY29udGVudH0pLHRoaXMuYmFjaz1uZXcgbyh7c2l6ZTpbdGhpcy5vcHRpb25zLnNpemVbMV0sdGhpcy5vcHRpb25zLnNpemVbMV1dLGNsYXNzZXM6dGhpcy5vcHRpb25zLmNsYXNzZXMsY29udGVudDp0aGlzLm9wdGlvbnMuYmFja0NvbnRlbnR9KSx0aGlzLmJhY2sub24oXCJjbGlja1wiLGZ1bmN0aW9uKCl7dGhpcy5fZXZlbnRPdXRwdXQuZW1pdChcImJhY2tcIix7fSl9LmJpbmQodGhpcykpLHRoaXMubW9yZT1uZXcgbyh7c2l6ZTpbdGhpcy5vcHRpb25zLnNpemVbMV0sdGhpcy5vcHRpb25zLnNpemVbMV1dLGNsYXNzZXM6dGhpcy5vcHRpb25zLmNsYXNzZXMsY29udGVudDp0aGlzLm9wdGlvbnMubW9yZUNvbnRlbnR9KSx0aGlzLm1vcmUub24oXCJjbGlja1wiLGZ1bmN0aW9uKCl7dGhpcy5fZXZlbnRPdXRwdXQuZW1pdChcIm1vcmVcIix7fSl9LmJpbmQodGhpcykpLHRoaXMubGF5b3V0PW5ldyBuKHtpZDpcIm1hc3RlclwiLHNpemU6dGhpcy5vcHRpb25zLnNpemUsdGFyZ2V0Olt7dHJhbnNmb3JtOnMuaW5Gcm9udCxvcmlnaW46WzAsLjVdLHRhcmdldDp0aGlzLmJhY2t9LHtvcmlnaW46Wy41LC41XSx0YXJnZXQ6dGhpcy50aXRsZX0se3RyYW5zZm9ybTpzLmluRnJvbnQsb3JpZ2luOlsxLC41XSx0YXJnZXQ6dGhpcy5tb3JlfV19KSx0aGlzLl9hZGQodGhpcy5sYXlvdXQpLHRoaXMuX29wdGlvbnNNYW5hZ2VyLm9uKFwiY2hhbmdlXCIsZnVuY3Rpb24odCl7dmFyIGk9dC5pZCxlPXQudmFsdWU7XCJzaXplXCI9PT1pPyh0aGlzLmxheW91dC5pZC5tYXN0ZXIuc2V0U2l6ZShlKSx0aGlzLnRpdGxlLnNldFNpemUoZSksdGhpcy5iYWNrLnNldFNpemUoW2VbMV0sZVsxXV0pLHRoaXMubW9yZS5zZXRTaXplKFtlWzFdLGVbMV1dKSk6XCJiYWNrQ2xhc3Nlc1wiPT09aT90aGlzLmJhY2suc2V0T3B0aW9ucyh7Y2xhc3Nlczp0aGlzLm9wdGlvbnMuY2xhc3Nlcy5jb25jYXQodGhpcy5vcHRpb25zLmJhY2tDbGFzc2VzKX0pOlwiYmFja0NvbnRlbnRcIj09PWk/dGhpcy5iYWNrLnNldENvbnRlbnQodGhpcy5vcHRpb25zLmJhY2tDb250ZW50KTpcImNsYXNzZXNcIj09PWk/KHRoaXMudGl0bGUuc2V0T3B0aW9ucyh7Y2xhc3Nlczp0aGlzLm9wdGlvbnMuY2xhc3Nlc30pLHRoaXMuYmFjay5zZXRPcHRpb25zKHtjbGFzc2VzOnRoaXMub3B0aW9ucy5jbGFzc2VzLmNvbmNhdCh0aGlzLm9wdGlvbnMuYmFja0NsYXNzZXMpfSksdGhpcy5tb3JlLnNldE9wdGlvbnMoe2NsYXNzZXM6dGhpcy5vcHRpb25zLmNsYXNzZXMuY29uY2F0KHRoaXMub3B0aW9ucy5tb3JlQ2xhc3Nlcyl9KSk6XCJjb250ZW50XCI9PT1pP3RoaXMuc2V0Q29udGVudCh0aGlzLm9wdGlvbnMuY29udGVudCk6XCJtb3JlQ2xhc3Nlc1wiPT09aT90aGlzLm1vcmUuc2V0T3B0aW9ucyh7Y2xhc3Nlczp0aGlzLm9wdGlvbnMuY2xhc3Nlcy5jb25jYXQodGhpcy5vcHRpb25zLm1vcmVDbGFzc2VzKX0pOlwibW9yZUNvbnRlbnRcIj09PWkmJnRoaXMubW9yZS5zZXRDb250ZW50KHRoaXMub3B0aW9ucy5jb250ZW50KX0uYmluZCh0aGlzKSl9dmFyIG49dChcIi4uL2NvcmUvU2NlbmVcIiksbz10KFwiLi4vY29yZS9TdXJmYWNlXCIpLHM9dChcIi4uL2NvcmUvVHJhbnNmb3JtXCIpLHI9dChcIi4uL2NvcmUvVmlld1wiKTtlLnByb3RvdHlwZT1PYmplY3QuY3JlYXRlKHIucHJvdG90eXBlKSxlLnByb3RvdHlwZS5jb25zdHJ1Y3Rvcj1lLGUuREVGQVVMVF9PUFRJT05TPXtzaXplOlt2b2lkIDAsNTBdLGJhY2tDbGFzc2VzOltcImJhY2tcIl0sYmFja0NvbnRlbnQ6XCImI3gyNWMwO1wiLGNsYXNzZXM6W1wibmF2aWdhdGlvblwiXSxjb250ZW50OlwiXCIsbW9yZUNsYXNzZXM6W1wibW9yZVwiXSxtb3JlQ29udGVudDpcIiYjeDI3MWE7XCJ9LGUucHJvdG90eXBlLnNldENvbnRlbnQ9ZnVuY3Rpb24odCl7cmV0dXJuIHRoaXMudGl0bGUuc2V0Q29udGVudCh0KX0saS5leHBvcnRzPWV9LHtcIi4uL2NvcmUvU2NlbmVcIjoxMixcIi4uL2NvcmUvU3VyZmFjZVwiOjE0LFwiLi4vY29yZS9UcmFuc2Zvcm1cIjoxNSxcIi4uL2NvcmUvVmlld1wiOjE2fV0sMTEzOltmdW5jdGlvbih0LGkpe2Z1bmN0aW9uIGUodCl7dGhpcy5vcHRpb25zPU9iamVjdC5jcmVhdGUoZS5ERUZBVUxUX09QVElPTlMpLHRoaXMub3B0aW9uc01hbmFnZXI9bmV3IGModGhpcy5vcHRpb25zKSx0JiZ0aGlzLnNldE9wdGlvbnModCksdGhpcy5pbmRpY2F0b3I9bmV3IHMoe3NpemU6dGhpcy5vcHRpb25zLmluZGljYXRvclNpemUsY2xhc3NlczpbXCJzbGlkZXItYmFja1wiXX0pLHRoaXMubGFiZWw9bmV3IG8oe3NpemU6dGhpcy5vcHRpb25zLmxhYmVsU2l6ZSxjb250ZW50OnRoaXMub3B0aW9ucy5sYWJlbCxwcm9wZXJ0aWVzOntwb2ludGVyRXZlbnRzOlwibm9uZVwifSxjbGFzc2VzOltcInNsaWRlci1sYWJlbFwiXX0pLHRoaXMuZXZlbnRPdXRwdXQ9bmV3IGEsdGhpcy5ldmVudElucHV0PW5ldyBhLGEuc2V0SW5wdXRIYW5kbGVyKHRoaXMsdGhpcy5ldmVudElucHV0KSxhLnNldE91dHB1dEhhbmRsZXIodGhpcyx0aGlzLmV2ZW50T3V0cHV0KTt2YXIgaT0odGhpcy5vcHRpb25zLnJhbmdlWzFdLXRoaXMub3B0aW9ucy5yYW5nZVswXSkvdGhpcy5vcHRpb25zLmluZGljYXRvclNpemVbMF07dGhpcy5zeW5jPW5ldyBsKFtcIm1vdXNlXCIsXCJ0b3VjaFwiXSx7c2NhbGU6aSxkaXJlY3Rpb246bC5ESVJFQ1RJT05fWH0pLHRoaXMuaW5kaWNhdG9yLnBpcGUodGhpcy5zeW5jKSx0aGlzLnN5bmMucGlwZSh0aGlzKSx0aGlzLmV2ZW50SW5wdXQub24oXCJ1cGRhdGVcIixmdW5jdGlvbih0KXt0aGlzLnNldCh0LnBvc2l0aW9uKX0uYmluZCh0aGlzKSksdGhpcy5fZHJhd1Bvcz0wLG4uY2FsbCh0aGlzKX1mdW5jdGlvbiBuKCl7dGhpcy5sYWJlbC5zZXRDb250ZW50KHRoaXMub3B0aW9ucy5sYWJlbCsnPHNwYW4gc3R5bGU9XCJmbG9hdDogcmlnaHRcIj4nK3RoaXMuZ2V0KCkudG9GaXhlZCh0aGlzLm9wdGlvbnMucHJlY2lzaW9uKStcIjwvc3Bhbj5cIil9dmFyIG89dChcIi4uL2NvcmUvU3VyZmFjZVwiKSxzPXQoXCIuLi9zdXJmYWNlcy9DYW52YXNTdXJmYWNlXCIpLHI9dChcIi4uL2NvcmUvVHJhbnNmb3JtXCIpLGE9dChcIi4uL2NvcmUvRXZlbnRIYW5kbGVyXCIpLGg9dChcIi4uL21hdGgvVXRpbGl0aWVzXCIpLGM9dChcIi4uL2NvcmUvT3B0aW9uc01hbmFnZXJcIikscD10KFwiLi4vaW5wdXRzL01vdXNlU3luY1wiKSx1PXQoXCIuLi9pbnB1dHMvVG91Y2hTeW5jXCIpLGw9dChcIi4uL2lucHV0cy9HZW5lcmljU3luY1wiKTtsLnJlZ2lzdGVyKHttb3VzZTpwLHRvdWNoOnV9KSxlLkRFRkFVTFRfT1BUSU9OUz17c2l6ZTpbMjAwLDYwXSxpbmRpY2F0b3JTaXplOlsyMDAsMzBdLGxhYmVsU2l6ZTpbMjAwLDMwXSxyYW5nZTpbMCwxXSxwcmVjaXNpb246Mix2YWx1ZTowLGxhYmVsOlwiXCIsZmlsbENvbG9yOlwicmdiYSgxNzAsIDE3MCwgMTcwLCAxKVwifSxlLnByb3RvdHlwZS5zZXRPcHRpb25zPWZ1bmN0aW9uKHQpe3JldHVybiB0aGlzLm9wdGlvbnNNYW5hZ2VyLnNldE9wdGlvbnModCl9LGUucHJvdG90eXBlLmdldD1mdW5jdGlvbigpe3JldHVybiB0aGlzLm9wdGlvbnMudmFsdWV9LGUucHJvdG90eXBlLnNldD1mdW5jdGlvbih0KXt0IT09dGhpcy5vcHRpb25zLnZhbHVlJiYodGhpcy5vcHRpb25zLnZhbHVlPWguY2xhbXAodCx0aGlzLm9wdGlvbnMucmFuZ2UpLG4uY2FsbCh0aGlzKSx0aGlzLmV2ZW50T3V0cHV0LmVtaXQoXCJjaGFuZ2VcIix7dmFsdWU6dH0pKX0sZS5wcm90b3R5cGUuZ2V0U2l6ZT1mdW5jdGlvbigpe3JldHVybiB0aGlzLm9wdGlvbnMuc2l6ZX0sZS5wcm90b3R5cGUucmVuZGVyPWZ1bmN0aW9uKCl7dmFyIHQ9dGhpcy5vcHRpb25zLnJhbmdlLGk9TWF0aC5mbG9vcigodGhpcy5nZXQoKS10WzBdKS8odFsxXS10WzBdKSp0aGlzLm9wdGlvbnMuaW5kaWNhdG9yU2l6ZVswXSk7aWYoaTx0aGlzLl9kcmF3UG9zKXRoaXMuaW5kaWNhdG9yLmdldENvbnRleHQoXCIyZFwiKS5jbGVhclJlY3QoaSwwLHRoaXMuX2RyYXdQb3MtaSsxLHRoaXMub3B0aW9ucy5pbmRpY2F0b3JTaXplWzFdKTtlbHNlIGlmKGk+dGhpcy5fZHJhd1Bvcyl7dmFyIGU9dGhpcy5pbmRpY2F0b3IuZ2V0Q29udGV4dChcIjJkXCIpO2UuZmlsbFN0eWxlPXRoaXMub3B0aW9ucy5maWxsQ29sb3IsZS5maWxsUmVjdCh0aGlzLl9kcmF3UG9zLTEsMCxpLXRoaXMuX2RyYXdQb3MrMSx0aGlzLm9wdGlvbnMuaW5kaWNhdG9yU2l6ZVsxXSl9cmV0dXJuIHRoaXMuX2RyYXdQb3M9aSx7c2l6ZTp0aGlzLm9wdGlvbnMuc2l6ZSx0YXJnZXQ6W3tvcmlnaW46WzAsMF0sdGFyZ2V0OnRoaXMuaW5kaWNhdG9yLnJlbmRlcigpfSx7dHJhbnNmb3JtOnIudHJhbnNsYXRlKDAsMCwxKSxvcmlnaW46WzAsMF0sdGFyZ2V0OnRoaXMubGFiZWwucmVuZGVyKCl9XX19LGkuZXhwb3J0cz1lfSx7XCIuLi9jb3JlL0V2ZW50SGFuZGxlclwiOjcsXCIuLi9jb3JlL09wdGlvbnNNYW5hZ2VyXCI6MTAsXCIuLi9jb3JlL1N1cmZhY2VcIjoxNCxcIi4uL2NvcmUvVHJhbnNmb3JtXCI6MTUsXCIuLi9pbnB1dHMvR2VuZXJpY1N5bmNcIjoyNyxcIi4uL2lucHV0cy9Nb3VzZVN5bmNcIjoyOCxcIi4uL2lucHV0cy9Ub3VjaFN5bmNcIjozMyxcIi4uL21hdGgvVXRpbGl0aWVzXCI6NDAsXCIuLi9zdXJmYWNlcy9DYW52YXNTdXJmYWNlXCI6NzR9XSwxMTQ6W2Z1bmN0aW9uKHQsaSl7ZnVuY3Rpb24gZSgpe3IuYXBwbHkodGhpcyxhcmd1bWVudHMpLHRoaXMubGF5b3V0PW5ldyBhLHRoaXMuYnV0dG9ucz1bXSx0aGlzLl9idXR0b25JZHM9e30sdGhpcy5fYnV0dG9uQ2FsbGJhY2tzPXt9LHRoaXMubGF5b3V0LnNlcXVlbmNlRnJvbSh0aGlzLmJ1dHRvbnMpLHRoaXMuX2FkZCh0aGlzLmxheW91dCksdGhpcy5fb3B0aW9uc01hbmFnZXIub24oXCJjaGFuZ2VcIixuLmJpbmQodGhpcykpfWZ1bmN0aW9uIG4odCl7dmFyIGk9dC5pZCxlPXQudmFsdWU7aWYoXCJkaXJlY3Rpb25cIj09PWkpdGhpcy5sYXlvdXQuc2V0T3B0aW9ucyh7ZGltZW5zaW9uczpvLmNhbGwodGhpcy5idXR0b25zLmxlbmd0aCx0aGlzLm9wdGlvbnMuZGlyZWN0aW9uKX0pO2Vsc2UgaWYoXCJidXR0b25zXCI9PT1pKWZvcih2YXIgbiBpbiB0aGlzLmJ1dHRvbnMpdGhpcy5idXR0b25zW25dLnNldE9wdGlvbnMoZSk7ZWxzZSBpZihcInNlY3Rpb25zXCI9PT1pKWZvcih2YXIgcyBpbiB0aGlzLm9wdGlvbnMuc2VjdGlvbnMpdGhpcy5kZWZpbmVTZWN0aW9uKHMsdGhpcy5vcHRpb25zLnNlY3Rpb25zW3NdKX1mdW5jdGlvbiBvKHQsaSl7cmV0dXJuIGk9PT1zLkRpcmVjdGlvbi5YP1t0LDFdOlsxLHRdfXZhciBzPXQoXCIuLi91dGlsaXRpZXMvVXRpbGl0eVwiKSxyPXQoXCIuLi9jb3JlL1ZpZXdcIiksYT10KFwiLi4vdmlld3MvR3JpZExheW91dFwiKSxoPXQoXCIuL1RvZ2dsZUJ1dHRvblwiKTtlLnByb3RvdHlwZT1PYmplY3QuY3JlYXRlKHIucHJvdG90eXBlKSxlLnByb3RvdHlwZS5jb25zdHJ1Y3Rvcj1lLGUuREVGQVVMVF9PUFRJT05TPXtzZWN0aW9uczpbXSx3aWRnZXQ6aCxzaXplOlt2b2lkIDAsNTBdLGRpcmVjdGlvbjpzLkRpcmVjdGlvbi5YLGJ1dHRvbnM6e3RvZ2dsZU1vZGU6aC5PTn19LGUucHJvdG90eXBlLmRlZmluZVNlY3Rpb249ZnVuY3Rpb24odCxpKXt2YXIgZSxuPXRoaXMuX2J1dHRvbklkc1t0XTtpZih2b2lkIDA9PT1uKXtuPXRoaXMuYnV0dG9ucy5sZW5ndGgsdGhpcy5fYnV0dG9uSWRzW3RdPW47dmFyIHM9dGhpcy5vcHRpb25zLndpZGdldDtlPW5ldyBzLHRoaXMuYnV0dG9uc1tuXT1lLHRoaXMubGF5b3V0LnNldE9wdGlvbnMoe2RpbWVuc2lvbnM6byh0aGlzLmJ1dHRvbnMubGVuZ3RoLHRoaXMub3B0aW9ucy5kaXJlY3Rpb24pfSl9ZWxzZSBlPXRoaXMuYnV0dG9uc1tuXSxlLnVuYmluZChcInNlbGVjdFwiLHRoaXMuX2J1dHRvbkNhbGxiYWNrc1t0XSk7dGhpcy5vcHRpb25zLmJ1dHRvbnMmJmUuc2V0T3B0aW9ucyh0aGlzLm9wdGlvbnMuYnV0dG9ucyksZS5zZXRPcHRpb25zKGkpLHRoaXMuX2J1dHRvbkNhbGxiYWNrc1t0XT10aGlzLnNlbGVjdC5iaW5kKHRoaXMsdCksZS5vbihcInNlbGVjdFwiLHRoaXMuX2J1dHRvbkNhbGxiYWNrc1t0XSl9LGUucHJvdG90eXBlLnNlbGVjdD1mdW5jdGlvbih0KXt2YXIgaT10aGlzLl9idXR0b25JZHNbdF07dGhpcy5idXR0b25zW2ldJiZ0aGlzLmJ1dHRvbnNbaV0uaXNTZWxlY3RlZCgpP3RoaXMuX2V2ZW50T3V0cHV0LmVtaXQoXCJzZWxlY3RcIix7aWQ6dH0pOnRoaXMuYnV0dG9uc1tpXSYmdGhpcy5idXR0b25zW2ldLnNlbGVjdCgpO2Zvcih2YXIgZT0wO2U8dGhpcy5idXR0b25zLmxlbmd0aDtlKyspZSE9PWkmJnRoaXMuYnV0dG9uc1tlXS5kZXNlbGVjdCgpfSxpLmV4cG9ydHM9ZX0se1wiLi4vY29yZS9WaWV3XCI6MTYsXCIuLi91dGlsaXRpZXMvVXRpbGl0eVwiOjk1LFwiLi4vdmlld3MvR3JpZExheW91dFwiOjEwMyxcIi4vVG9nZ2xlQnV0dG9uXCI6MTE1fV0sMTE1OltmdW5jdGlvbih0LGkpe2Z1bmN0aW9uIGUodCl7dGhpcy5vcHRpb25zPXtjb250ZW50OlwiXCIsb2ZmQ2xhc3NlczpbXCJvZmZcIl0sb25DbGFzc2VzOltcIm9uXCJdLHNpemU6dm9pZCAwLG91dFRyYW5zaXRpb246e2N1cnZlOlwiZWFzZUluT3V0XCIsZHVyYXRpb246MzAwfSxpblRyYW5zaXRpb246e2N1cnZlOlwiZWFzZUluT3V0XCIsZHVyYXRpb246MzAwfSx0b2dnbGVNb2RlOmUuVE9HR0xFLGNyb3NzZmFkZTohMH0sdGhpcy5fZXZlbnRPdXRwdXQ9bmV3IG8sby5zZXRPdXRwdXRIYW5kbGVyKHRoaXMsdGhpcy5fZXZlbnRPdXRwdXQpLHRoaXMub2ZmU3VyZmFjZT1uZXcgbix0aGlzLm9mZlN1cmZhY2Uub24oXCJjbGlja1wiLGZ1bmN0aW9uKCl7dGhpcy5vcHRpb25zLnRvZ2dsZU1vZGUhPT1lLk9GRiYmdGhpcy5zZWxlY3QoKX0uYmluZCh0aGlzKSksdGhpcy5vZmZTdXJmYWNlLnBpcGUodGhpcy5fZXZlbnRPdXRwdXQpLHRoaXMub25TdXJmYWNlPW5ldyBuLHRoaXMub25TdXJmYWNlLm9uKFwiY2xpY2tcIixmdW5jdGlvbigpe3RoaXMub3B0aW9ucy50b2dnbGVNb2RlIT09ZS5PTiYmdGhpcy5kZXNlbGVjdCgpfS5iaW5kKHRoaXMpKSx0aGlzLm9uU3VyZmFjZS5waXBlKHRoaXMuX2V2ZW50T3V0cHV0KSx0aGlzLmFyYml0ZXI9bmV3IHMoe292ZXJsYXA6dGhpcy5vcHRpb25zLmNyb3NzZmFkZX0pLHRoaXMuZGVzZWxlY3QoKSx0JiZ0aGlzLnNldE9wdGlvbnModCl9dmFyIG49dChcIi4uL2NvcmUvU3VyZmFjZVwiKSxvPXQoXCIuLi9jb3JlL0V2ZW50SGFuZGxlclwiKSxzPXQoXCIuLi92aWV3cy9SZW5kZXJDb250cm9sbGVyXCIpO2UuT0ZGPTAsZS5PTj0xLGUuVE9HR0xFPTIsZS5wcm90b3R5cGUuc2VsZWN0PWZ1bmN0aW9uKCl7dGhpcy5zZWxlY3RlZD0hMCx0aGlzLmFyYml0ZXIuc2hvdyh0aGlzLm9uU3VyZmFjZSx0aGlzLm9wdGlvbnMuaW5UcmFuc2l0aW9uKSx0aGlzLl9ldmVudE91dHB1dC5lbWl0KFwic2VsZWN0XCIpfSxlLnByb3RvdHlwZS5kZXNlbGVjdD1mdW5jdGlvbigpe3RoaXMuc2VsZWN0ZWQ9ITEsdGhpcy5hcmJpdGVyLnNob3codGhpcy5vZmZTdXJmYWNlLHRoaXMub3B0aW9ucy5vdXRUcmFuc2l0aW9uKSx0aGlzLl9ldmVudE91dHB1dC5lbWl0KFwiZGVzZWxlY3RcIil9LGUucHJvdG90eXBlLmlzU2VsZWN0ZWQ9ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5zZWxlY3RlZH0sZS5wcm90b3R5cGUuc2V0T3B0aW9ucz1mdW5jdGlvbih0KXt2b2lkIDAhPT10LmNvbnRlbnQmJih0aGlzLm9wdGlvbnMuY29udGVudD10LmNvbnRlbnQsdGhpcy5vZmZTdXJmYWNlLnNldENvbnRlbnQodGhpcy5vcHRpb25zLmNvbnRlbnQpLHRoaXMub25TdXJmYWNlLnNldENvbnRlbnQodGhpcy5vcHRpb25zLmNvbnRlbnQpKSx0Lm9mZkNsYXNzZXMmJih0aGlzLm9wdGlvbnMub2ZmQ2xhc3Nlcz10Lm9mZkNsYXNzZXMsdGhpcy5vZmZTdXJmYWNlLnNldENsYXNzZXModGhpcy5vcHRpb25zLm9mZkNsYXNzZXMpKSx0Lm9uQ2xhc3NlcyYmKHRoaXMub3B0aW9ucy5vbkNsYXNzZXM9dC5vbkNsYXNzZXMsdGhpcy5vblN1cmZhY2Uuc2V0Q2xhc3Nlcyh0aGlzLm9wdGlvbnMub25DbGFzc2VzKSksdm9pZCAwIT09dC5zaXplJiYodGhpcy5vcHRpb25zLnNpemU9dC5zaXplLHRoaXMub25TdXJmYWNlLnNldFNpemUodGhpcy5vcHRpb25zLnNpemUpLHRoaXMub2ZmU3VyZmFjZS5zZXRTaXplKHRoaXMub3B0aW9ucy5zaXplKSksdm9pZCAwIT09dC50b2dnbGVNb2RlJiYodGhpcy5vcHRpb25zLnRvZ2dsZU1vZGU9dC50b2dnbGVNb2RlKSx2b2lkIDAhPT10Lm91dFRyYW5zaXRpb24mJih0aGlzLm9wdGlvbnMub3V0VHJhbnNpdGlvbj10Lm91dFRyYW5zaXRpb24pLHZvaWQgMCE9PXQuaW5UcmFuc2l0aW9uJiYodGhpcy5vcHRpb25zLmluVHJhbnNpdGlvbj10LmluVHJhbnNpdGlvbiksdm9pZCAwIT09dC5jcm9zc2ZhZGUmJih0aGlzLm9wdGlvbnMuY3Jvc3NmYWRlPXQuY3Jvc3NmYWRlLHRoaXMuYXJiaXRlci5zZXRPcHRpb25zKHtvdmVybGFwOnRoaXMub3B0aW9ucy5jcm9zc2ZhZGV9KSl9LGUucHJvdG90eXBlLmdldFNpemU9ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5vcHRpb25zLnNpemV9LGUucHJvdG90eXBlLnJlbmRlcj1mdW5jdGlvbigpe3JldHVybiB0aGlzLmFyYml0ZXIucmVuZGVyKCl9LGkuZXhwb3J0cz1lfSx7XCIuLi9jb3JlL0V2ZW50SGFuZGxlclwiOjcsXCIuLi9jb3JlL1N1cmZhY2VcIjoxNCxcIi4uL3ZpZXdzL1JlbmRlckNvbnRyb2xsZXJcIjoxMDZ9XSwxMTY6W2Z1bmN0aW9uKHQsaSl7aS5leHBvcnRzPXtOYXZpZ2F0aW9uQmFyOnQoXCIuL05hdmlnYXRpb25CYXJcIiksU2xpZGVyOnQoXCIuL1NsaWRlclwiKSxUYWJCYXI6dChcIi4vVGFiQmFyXCIpLFRvZ2dsZUJ1dHRvbjp0KFwiLi9Ub2dnbGVCdXR0b25cIil9fSx7XCIuL05hdmlnYXRpb25CYXJcIjoxMTIsXCIuL1NsaWRlclwiOjExMyxcIi4vVGFiQmFyXCI6MTE0LFwiLi9Ub2dnbGVCdXR0b25cIjoxMTV9XX0se30sWzIzXSkoMjMpfSk7XG47IGJyb3dzZXJpZnlfc2hpbV9fZGVmaW5lX19tb2R1bGVfX2V4cG9ydF9fKHR5cGVvZiBmYW1vdXMgIT0gXCJ1bmRlZmluZWRcIiA/IGZhbW91cyA6IHdpbmRvdy5mYW1vdXMpO1xuXG59KS5jYWxsKGdsb2JhbCwgdW5kZWZpbmVkLCB1bmRlZmluZWQsIHVuZGVmaW5lZCwgdW5kZWZpbmVkLCBmdW5jdGlvbiBkZWZpbmVFeHBvcnQoZXgpIHsgbW9kdWxlLmV4cG9ydHMgPSBleDsgfSk7XG5cbn0pLmNhbGwodGhpcyx0eXBlb2YgZ2xvYmFsICE9PSBcInVuZGVmaW5lZFwiID8gZ2xvYmFsIDogdHlwZW9mIHNlbGYgIT09IFwidW5kZWZpbmVkXCIgPyBzZWxmIDogdHlwZW9mIHdpbmRvdyAhPT0gXCJ1bmRlZmluZWRcIiA/IHdpbmRvdyA6IHt9KSIsIihmdW5jdGlvbiAoZ2xvYmFsKXtcblxuOyByZXF1aXJlKFwiL2hvbWUvdWJ1bnR1L3dvcmtzcGFjZS9ib3dlcl9jb21wb25lbnRzL2lvbmljL3JlbGVhc2UvanMvaW9uaWMubWluLmpzXCIpO1xucmVxdWlyZShcIi9ob21lL3VidW50dS93b3Jrc3BhY2UvYm93ZXJfY29tcG9uZW50cy9hbmd1bGFyL2FuZ3VsYXIubWluLmpzXCIpO1xucmVxdWlyZShcIi9ob21lL3VidW50dS93b3Jrc3BhY2UvYm93ZXJfY29tcG9uZW50cy9hbmd1bGFyLWFuaW1hdGUvYW5ndWxhci1hbmltYXRlLm1pbi5qc1wiKTtcbnJlcXVpcmUoXCIvaG9tZS91YnVudHUvd29ya3NwYWNlL2Jvd2VyX2NvbXBvbmVudHMvYW5ndWxhci1zYW5pdGl6ZS9hbmd1bGFyLXNhbml0aXplLm1pbi5qc1wiKTtcbnJlcXVpcmUoXCIvaG9tZS91YnVudHUvd29ya3NwYWNlL2Jvd2VyX2NvbXBvbmVudHMvYW5ndWxhci11aS1yb3V0ZXIvcmVsZWFzZS9hbmd1bGFyLXVpLXJvdXRlci5taW4uanNcIik7XG47X19icm93c2VyaWZ5X3NoaW1fcmVxdWlyZV9fPXJlcXVpcmU7KGZ1bmN0aW9uIGJyb3dzZXJpZnlTaGltKG1vZHVsZSwgZXhwb3J0cywgcmVxdWlyZSwgZGVmaW5lLCBicm93c2VyaWZ5X3NoaW1fX2RlZmluZV9fbW9kdWxlX19leHBvcnRfXykge1xuLyohXG4gKiBDb3B5cmlnaHQgMjAxNCBEcmlmdHkgQ28uXG4gKiBodHRwOi8vZHJpZnR5LmNvbS9cbiAqXG4gKiBJb25pYywgdjEuMC4wLWJldGEuMTNcbiAqIEEgcG93ZXJmdWwgSFRNTDUgbW9iaWxlIGFwcCBmcmFtZXdvcmsuXG4gKiBodHRwOi8vaW9uaWNmcmFtZXdvcmsuY29tL1xuICpcbiAqIEJ5IEBtYXhseW5jaCwgQGJlbmpzcGVycnksIEBhZGFtZGJyYWRsZXkgPDNcbiAqXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgTUlUIGxpY2Vuc2UuIFBsZWFzZSBzZWUgTElDRU5TRSBmb3IgbW9yZSBpbmZvcm1hdGlvbi5cbiAqXG4gKi9cblxuIWZ1bmN0aW9uKCl7ZnVuY3Rpb24gZShlKXtpZihlLiRyb290IT09ZSl7dmFyIHQ9ZS4kcGFyZW50O2UuJCRkaXNjb25uZWN0ZWQ9ITAsdC4kJGNoaWxkSGVhZD09PWUmJih0LiQkY2hpbGRIZWFkPWUuJCRuZXh0U2libGluZyksdC4kJGNoaWxkVGFpbD09PWUmJih0LiQkY2hpbGRUYWlsPWUuJCRwcmV2U2libGluZyksZS4kJHByZXZTaWJsaW5nJiYoZS4kJHByZXZTaWJsaW5nLiQkbmV4dFNpYmxpbmc9ZS4kJG5leHRTaWJsaW5nKSxlLiQkbmV4dFNpYmxpbmcmJihlLiQkbmV4dFNpYmxpbmcuJCRwcmV2U2libGluZz1lLiQkcHJldlNpYmxpbmcpLGUuJCRuZXh0U2libGluZz1lLiQkcHJldlNpYmxpbmc9bnVsbH19ZnVuY3Rpb24gdChlKXtpZihlLiRyb290IT09ZSYmZS4kJGRpc2Nvbm5lY3RlZCl7dmFyIHQ9ZS4kcGFyZW50O2UuJCRkaXNjb25uZWN0ZWQ9ITEsZS4kJHByZXZTaWJsaW5nPXQuJCRjaGlsZFRhaWwsdC4kJGNoaWxkSGVhZD8odC4kJGNoaWxkVGFpbC4kJG5leHRTaWJsaW5nPWUsdC4kJGNoaWxkVGFpbD1lKTp0LiQkY2hpbGRIZWFkPXQuJCRjaGlsZFRhaWw9ZX19ZnVuY3Rpb24gbihlKXtyZXR1cm5bXCIkbG9nXCIsZnVuY3Rpb24odCl7ZnVuY3Rpb24gbihlKXt0aGlzLmhhbmRsZT1lfXZhciBpPXRoaXMsbz10aGlzLl9pbnN0YW5jZXM9W107dGhpcy5fcmVnaXN0ZXJJbnN0YW5jZT1mdW5jdGlvbihlLHQpe3JldHVybiBlLiQkZGVsZWdhdGVIYW5kbGU9dCxvLnB1c2goZSksZnVuY3Rpb24oKXt2YXIgdD1vLmluZGV4T2YoZSk7LTEhPT10JiZvLnNwbGljZSh0LDEpfX0sdGhpcy4kZ2V0QnlIYW5kbGU9ZnVuY3Rpb24oZSl7cmV0dXJuIGU/bmV3IG4oZSk6aX0sZS5mb3JFYWNoKGZ1bmN0aW9uKGUpe24ucHJvdG90eXBlW2VdPWZ1bmN0aW9uKCl7dmFyIG4saSxyPXRoaXMuaGFuZGxlLGE9YXJndW1lbnRzLHM9MDtyZXR1cm4gby5mb3JFYWNoKGZ1bmN0aW9uKHQpe3QuJCRkZWxlZ2F0ZUhhbmRsZT09PXImJihzKyssaT10W2VdLmFwcGx5KHQsYSksMT09PXMmJihuPWkpKX0pLHM/bjp0Lndhcm4oJ0RlbGVnYXRlIGZvciBoYW5kbGUgXCInK3RoaXMuaGFuZGxlKydcIiBjb3VsZCBub3QgZmluZCBhIGNvcnJlc3BvbmRpbmcgZWxlbWVudCB3aXRoIGRlbGVnYXRlLWhhbmRsZT1cIicrdGhpcy5oYW5kbGUrJ1wiISAnK2UrXCIoKSB3YXMgbm90IGNhbGxlZCFcXG5Qb3NzaWJsZSBjYXVzZTogSWYgeW91IGFyZSBjYWxsaW5nIFwiK2UrJygpIGltbWVkaWF0ZWx5LCBhbmQgeW91ciBlbGVtZW50IHdpdGggZGVsZWdhdGUtaGFuZGxlPVwiJyt0aGlzLmhhbmRsZSsnXCIgaXMgYSBjaGlsZCBvZiB5b3VyIGNvbnRyb2xsZXIsIHRoZW4geW91ciBlbGVtZW50IG1heSBub3QgYmUgY29tcGlsZWQgeWV0LiBQdXQgYSAkdGltZW91dCBhcm91bmQgeW91ciBjYWxsIHRvICcrZStcIigpIGFuZCB0cnkgYWdhaW4uXCIpfSxpW2VdPWZ1bmN0aW9uKCl7dmFyIHQsbixpPWFyZ3VtZW50cztyZXR1cm4gby5mb3JFYWNoKGZ1bmN0aW9uKG8scil7bj1vW2VdLmFwcGx5KG8saSksMD09PXImJih0PW4pfSksdH19KX1dfWZ1bmN0aW9uIGkoZSx0KXtyZXR1cm5bZnVuY3Rpb24oKXtyZXR1cm57cHJpb3JpdHk6XCI5OVwiLGxpbms6ZnVuY3Rpb24obixpLG8pe28uJG9ic2VydmUoZSxmdW5jdGlvbihlKXtlfHxpWzBdLnJlbW92ZUF0dHJpYnV0ZSh0KX0pfX19XX1mdW5jdGlvbiBvKGUpe3JldHVybltcIiRpb25pY0dlc3R1cmVcIixcIiRwYXJzZVwiLGZ1bmN0aW9uKHQsbil7dmFyIGk9ZS5zdWJzdHIoMikudG9Mb3dlckNhc2UoKTtyZXR1cm4gZnVuY3Rpb24obyxyLGEpe3ZhciBzPW4oYVtlXSksYz1mdW5jdGlvbihlKXtvLiRhcHBseShmdW5jdGlvbigpe3Mobyx7JGV2ZW50OmV9KX0pfSxsPXQub24oaSxjLHIpO28uJG9uKFwiJGRlc3Ryb3lcIixmdW5jdGlvbigpe3Qub2ZmKGwsaSxjKX0pfX1dfWZ1bmN0aW9uIHIoKXtyZXR1cm5bXCIkaW9uaWNTY3JvbGxEZWxlZ2F0ZVwiLGZ1bmN0aW9uKGUpe3JldHVybntyZXN0cmljdDpcIkVcIixsaW5rOmZ1bmN0aW9uKHQsbixpKXtmdW5jdGlvbiBvKHQpe2Zvcih2YXIgaT0zLG89dC50YXJnZXQ7aS0tJiZvOyl7aWYoby5jbGFzc0xpc3QuY29udGFpbnMoXCJidXR0b25cIil8fG8udGFnTmFtZS5tYXRjaCgvaW5wdXR8dGV4dGFyZWF8c2VsZWN0L2kpfHxvLmlzQ29udGVudEVkaXRhYmxlKXJldHVybjtvPW8ucGFyZW50Tm9kZX12YXIgcj10Lmdlc3R1cmUmJnQuZ2VzdHVyZS50b3VjaGVzWzBdfHx0LmRldGFpbC50b3VjaGVzWzBdLGE9blswXS5nZXRCb3VuZGluZ0NsaWVudFJlY3QoKTtpb25pYy5Eb21VdGlsLnJlY3RDb250YWlucyhyLnBhZ2VYLHIucGFnZVksYS5sZWZ0LGEudG9wLTIwLGEubGVmdCthLndpZHRoLGEudG9wK2EuaGVpZ2h0KSYmZS5zY3JvbGxUb3AoITApfVwidHJ1ZVwiIT1pLm5vVGFwU2Nyb2xsJiYoaW9uaWMub24oXCJ0YXBcIixvLG5bMF0pLHQuJG9uKFwiJGRlc3Ryb3lcIixmdW5jdGlvbigpe2lvbmljLm9mZihcInRhcFwiLG8sblswXSl9KSl9fX1dfWZ1bmN0aW9uIGEoZSl7cmV0dXJuW2Z1bmN0aW9uKCl7cmV0dXJue3Jlc3RyaWN0OlwiRVwiLGNvbXBpbGU6ZnVuY3Rpb24odCl7ZnVuY3Rpb24gbih0LG4saSl7dmFyIG89KG5ldyBpb25pYy52aWV3cy5IZWFkZXJCYXIoe2VsOm5bMF0sYWxpZ25UaXRsZTppLmFsaWduVGl0bGV8fFwiY2VudGVyXCJ9KSxuWzBdKTtlPyh0LiR3YXRjaChmdW5jdGlvbigpe3JldHVybiBvLmNsYXNzTmFtZX0sZnVuY3Rpb24oZSl7dmFyIG49LTE9PT1lLmluZGV4T2YoXCJuZy1oaWRlXCIpLGk9LTEhPT1lLmluZGV4T2YoXCJiYXItc3ViaGVhZGVyXCIpO3QuJGhhc0hlYWRlcj1uJiYhaSx0LiRoYXNTdWJoZWFkZXI9biYmaX0pLHQuJG9uKFwiJGRlc3Ryb3lcIixmdW5jdGlvbigpe2RlbGV0ZSB0LiRoYXNIZWFkZXIsZGVsZXRlIHQuJGhhc1N1YmhlYWRlcn0pKToodC4kd2F0Y2goZnVuY3Rpb24oKXtyZXR1cm4gby5jbGFzc05hbWV9LGZ1bmN0aW9uKGUpe3ZhciBuPS0xPT09ZS5pbmRleE9mKFwibmctaGlkZVwiKSxpPS0xIT09ZS5pbmRleE9mKFwiYmFyLXN1YmZvb3RlclwiKTt0LiRoYXNGb290ZXI9biYmIWksdC4kaGFzU3ViZm9vdGVyPW4mJml9KSx0LiRvbihcIiRkZXN0cm95XCIsZnVuY3Rpb24oKXtkZWxldGUgdC4kaGFzRm9vdGVyLGRlbGV0ZSB0LiRoYXNTdWJmb290ZXJ9KSx0LiR3YXRjaChcIiRoYXNUYWJzXCIsZnVuY3Rpb24oZSl7bi50b2dnbGVDbGFzcyhcImhhcy10YWJzXCIsISFlKX0pKX10LmFkZENsYXNzKGU/XCJiYXIgYmFyLWhlYWRlclwiOlwiYmFyIGJhci1mb290ZXJcIik7dmFyIGk9dFswXS5wYXJlbnROb2RlO3JldHVybiBpLnF1ZXJ5U2VsZWN0b3IoXCIudGFicy10b3BcIikmJnQuYWRkQ2xhc3MoXCJoYXMtdGFicy10b3BcIikse3ByZTpufX19fV19ZnVuY3Rpb24gcyhlKXtyZXR1cm4gZS5jbGllbnRIZWlnaHR9ZnVuY3Rpb24gYyhlKXtlLnN0b3BQcm9wYWdhdGlvbigpfXZhciBsPXttZXRob2Q6ZnVuY3Rpb24oZSx0LG4pe3ZhciBpPSExO3JldHVybiBmdW5jdGlvbigpe3JldHVybiBpfHwoaT0hMCx0KGUpKSxuLmFwcGx5KHRoaXMsYXJndW1lbnRzKX19LGZpZWxkOmZ1bmN0aW9uKGUsdCxuLGksbyl7dmFyIHI9ITEsYT1mdW5jdGlvbigpe3JldHVybiByfHwocj0hMCx0KGUpKSxvfSxzPWZ1bmN0aW9uKG4pe3JldHVybiByfHwocj0hMCx0KGUpKSxvPW4sbn07T2JqZWN0LmRlZmluZVByb3BlcnR5KG4saSx7Z2V0OmEsc2V0OnMsZW51bWVyYWJsZTohMH0pfX0sdT1hbmd1bGFyLm1vZHVsZShcImlvbmljXCIsW1wibmdBbmltYXRlXCIsXCJuZ1Nhbml0aXplXCIsXCJ1aS5yb3V0ZXJcIl0pLGQ9YW5ndWxhci5leHRlbmQsZj1hbmd1bGFyLmZvckVhY2gsaD1hbmd1bGFyLmlzRGVmaW5lZCxwPWFuZ3VsYXIuaXNTdHJpbmcsdj1hbmd1bGFyLmVsZW1lbnQ7dS5mYWN0b3J5KFwiJGlvbmljQWN0aW9uU2hlZXRcIixbXCIkcm9vdFNjb3BlXCIsXCIkY29tcGlsZVwiLFwiJGFuaW1hdGVcIixcIiR0aW1lb3V0XCIsXCIkaW9uaWNUZW1wbGF0ZUxvYWRlclwiLFwiJGlvbmljUGxhdGZvcm1cIixcIiRpb25pY0JvZHlcIixmdW5jdGlvbihlLHQsbixpLG8scixhKXtmdW5jdGlvbiBzKG8pe3ZhciBzPWUuJG5ldyghMCk7YW5ndWxhci5leHRlbmQocyx7Y2FuY2VsOmFuZ3VsYXIubm9vcCxkZXN0cnVjdGl2ZUJ1dHRvbkNsaWNrZWQ6YW5ndWxhci5ub29wLGJ1dHRvbkNsaWNrZWQ6YW5ndWxhci5ub29wLCRkZXJlZ2lzdGVyQmFja0J1dHRvbjphbmd1bGFyLm5vb3AsYnV0dG9uczpbXSxjYW5jZWxPblN0YXRlQ2hhbmdlOiEwfSxvfHx7fSk7dmFyIGM9cy5lbGVtZW50PXQoJzxpb24tYWN0aW9uLXNoZWV0IGJ1dHRvbnM9XCJidXR0b25zXCI+PC9pb24tYWN0aW9uLXNoZWV0PicpKHMpLGw9dihjWzBdLnF1ZXJ5U2VsZWN0b3IoXCIuYWN0aW9uLXNoZWV0LXdyYXBwZXJcIikpLHU9cy5jYW5jZWxPblN0YXRlQ2hhbmdlP2UuJG9uKFwiJHN0YXRlQ2hhbmdlU3VjY2Vzc1wiLGZ1bmN0aW9uKCl7cy5jYW5jZWwoKX0pOmFuZ3VsYXIubm9vcDtyZXR1cm4gcy5yZW1vdmVTaGVldD1mdW5jdGlvbihlKXtzLnJlbW92ZWR8fChzLnJlbW92ZWQ9ITAsbC5yZW1vdmVDbGFzcyhcImFjdGlvbi1zaGVldC11cFwiKSxpKGZ1bmN0aW9uKCl7YS5yZW1vdmVDbGFzcyhcImFjdGlvbi1zaGVldC1vcGVuXCIpfSw0MDApLHMuJGRlcmVnaXN0ZXJCYWNrQnV0dG9uKCksdSgpLG4ucmVtb3ZlQ2xhc3MoYyxcImFjdGl2ZVwiLGZ1bmN0aW9uKCl7cy4kZGVzdHJveSgpLGMucmVtb3ZlKCkscy5jYW5jZWwuJHNjb3BlPW51bGwsKGV8fGFuZ3VsYXIubm9vcCkoKX0pKX0scy5zaG93U2hlZXQ9ZnVuY3Rpb24oZSl7cy5yZW1vdmVkfHwoYS5hcHBlbmQoYykuYWRkQ2xhc3MoXCJhY3Rpb24tc2hlZXQtb3BlblwiKSxuLmFkZENsYXNzKGMsXCJhY3RpdmVcIixmdW5jdGlvbigpe3MucmVtb3ZlZHx8KGV8fGFuZ3VsYXIubm9vcCkoKX0pLGkoZnVuY3Rpb24oKXtzLnJlbW92ZWR8fGwuYWRkQ2xhc3MoXCJhY3Rpb24tc2hlZXQtdXBcIil9LDIwLCExKSl9LHMuJGRlcmVnaXN0ZXJCYWNrQnV0dG9uPXIucmVnaXN0ZXJCYWNrQnV0dG9uQWN0aW9uKGZ1bmN0aW9uKCl7aShzLmNhbmNlbCl9LEMpLHMuY2FuY2VsPWZ1bmN0aW9uKCl7cy5yZW1vdmVTaGVldChvLmNhbmNlbCl9LHMuYnV0dG9uQ2xpY2tlZD1mdW5jdGlvbihlKXtvLmJ1dHRvbkNsaWNrZWQoZSxvLmJ1dHRvbnNbZV0pPT09ITAmJnMucmVtb3ZlU2hlZXQoKX0scy5kZXN0cnVjdGl2ZUJ1dHRvbkNsaWNrZWQ9ZnVuY3Rpb24oKXtvLmRlc3RydWN0aXZlQnV0dG9uQ2xpY2tlZCgpPT09ITAmJnMucmVtb3ZlU2hlZXQoKX0scy5zaG93U2hlZXQoKSxzLmNhbmNlbC4kc2NvcGU9cyxzLmNhbmNlbH1yZXR1cm57c2hvdzpzfX1dKSx2LnByb3RvdHlwZS5hZGRDbGFzcz1mdW5jdGlvbihlKXt2YXIgdCxuLGksbyxyLGE7aWYoZSYmXCJuZy1zY29wZVwiIT1lJiZcIm5nLWlzb2xhdGUtc2NvcGVcIiE9ZSlmb3IodD0wO3Q8dGhpcy5sZW5ndGg7dCsrKWlmKG89dGhpc1t0XSxvLnNldEF0dHJpYnV0ZSlpZihlLmluZGV4T2YoXCIgXCIpPDAmJm8uY2xhc3NMaXN0LmFkZClvLmNsYXNzTGlzdC5hZGQoZSk7ZWxzZXtmb3IoYT0oXCIgXCIrKG8uZ2V0QXR0cmlidXRlKFwiY2xhc3NcIil8fFwiXCIpK1wiIFwiKS5yZXBsYWNlKC9bXFxuXFx0XS9nLFwiIFwiKSxyPWUuc3BsaXQoXCIgXCIpLG49MDtuPHIubGVuZ3RoO24rKylpPXJbbl0udHJpbSgpLC0xPT09YS5pbmRleE9mKFwiIFwiK2krXCIgXCIpJiYoYSs9aStcIiBcIik7by5zZXRBdHRyaWJ1dGUoXCJjbGFzc1wiLGEudHJpbSgpKX1yZXR1cm4gdGhpc30sdi5wcm90b3R5cGUucmVtb3ZlQ2xhc3M9ZnVuY3Rpb24oZSl7dmFyIHQsbixpLG8scjtpZihlKWZvcih0PTA7dDx0aGlzLmxlbmd0aDt0KyspaWYocj10aGlzW3RdLHIuZ2V0QXR0cmlidXRlKWlmKGUuaW5kZXhPZihcIiBcIik8MCYmci5jbGFzc0xpc3QucmVtb3ZlKXIuY2xhc3NMaXN0LnJlbW92ZShlKTtlbHNlIGZvcihpPWUuc3BsaXQoXCIgXCIpLG49MDtuPGkubGVuZ3RoO24rKylvPWlbbl0sci5zZXRBdHRyaWJ1dGUoXCJjbGFzc1wiLChcIiBcIisoci5nZXRBdHRyaWJ1dGUoXCJjbGFzc1wiKXx8XCJcIikrXCIgXCIpLnJlcGxhY2UoL1tcXG5cXHRdL2csXCIgXCIpLnJlcGxhY2UoXCIgXCIrby50cmltKCkrXCIgXCIsXCIgXCIpLnRyaW0oKSk7cmV0dXJuIHRoaXN9LHUuZmFjdG9yeShcIiRpb25pY0JhY2tkcm9wXCIsW1wiJGRvY3VtZW50XCIsXCIkdGltZW91dFwiLGZ1bmN0aW9uKGUsdCl7ZnVuY3Rpb24gbigpezE9PT0rK2EmJihyLmFkZENsYXNzKFwidmlzaWJsZVwiKSxpb25pYy5yZXF1ZXN0QW5pbWF0aW9uRnJhbWUoZnVuY3Rpb24oKXthJiZyLmFkZENsYXNzKFwiYWN0aXZlXCIpfSkpfWZ1bmN0aW9uIGkoKXswPT09LS1hJiYoci5yZW1vdmVDbGFzcyhcImFjdGl2ZVwiKSx0KGZ1bmN0aW9uKCl7IWEmJnIucmVtb3ZlQ2xhc3MoXCJ2aXNpYmxlXCIpfSw0MDAsITEpKX1mdW5jdGlvbiBvKCl7cmV0dXJuIHJ9dmFyIHI9dignPGRpdiBjbGFzcz1cImJhY2tkcm9wXCI+JyksYT0wO3JldHVybiBlWzBdLmJvZHkuYXBwZW5kQ2hpbGQoclswXSkse3JldGFpbjpuLHJlbGVhc2U6aSxnZXRFbGVtZW50Om8sX2VsZW1lbnQ6cn19XSksdS5mYWN0b3J5KFwiJGlvbmljQmluZFwiLFtcIiRwYXJzZVwiLFwiJGludGVycG9sYXRlXCIsZnVuY3Rpb24oZSx0KXt2YXIgbj0vXlxccyooW0A9Jl0pKFxcPz8pXFxzKihcXHcqKVxccyokLztyZXR1cm4gZnVuY3Rpb24oaSxvLHIpe2Yocnx8e30sZnVuY3Rpb24ocixhKXt2YXIgcyxjLGw9ci5tYXRjaChuKXx8W10sdT1sWzNdfHxhLGQ9bFsxXTtzd2l0Y2goZCl7Y2FzZVwiQFwiOmlmKCFvW3VdKXJldHVybjtvLiRvYnNlcnZlKHUsZnVuY3Rpb24oZSl7aVthXT1lfSksb1t1XSYmKGlbYV09dChvW3VdKShpKSk7YnJlYWs7Y2FzZVwiPVwiOmlmKCFvW3VdKXJldHVybjtjPWkuJHdhdGNoKG9bdV0sZnVuY3Rpb24oZSl7aVthXT1lfSksaS4kb24oXCIkZGVzdHJveVwiLGMpO2JyZWFrO2Nhc2VcIiZcIjppZihvW3VdJiZvW3VdLm1hdGNoKFJlZ0V4cChhK1wiKC4qPylcIikpKXRocm93IG5ldyBFcnJvcignJiBleHByZXNzaW9uIGJpbmRpbmcgXCInK2ErJ1wiIGxvb2tzIGxpa2UgaXQgd2lsbCByZWN1cnNpdmVseSBjYWxsIFwiJytvW3VdKydcIiBhbmQgY2F1c2UgYSBzdGFjayBvdmVyZmxvdyEgUGxlYXNlIGNob29zZSBhIGRpZmZlcmVudCBzY29wZU5hbWUuJyk7cz1lKG9bdV0pLGlbYV09ZnVuY3Rpb24oZSl7cmV0dXJuIHMoaSxlKX19fSl9fV0pLHUuZmFjdG9yeShcIiRpb25pY0JvZHlcIixbXCIkZG9jdW1lbnRcIixmdW5jdGlvbihlKXtyZXR1cm57YWRkQ2xhc3M6ZnVuY3Rpb24oKXtmb3IodmFyIHQ9MDt0PGFyZ3VtZW50cy5sZW5ndGg7dCsrKWVbMF0uYm9keS5jbGFzc0xpc3QuYWRkKGFyZ3VtZW50c1t0XSk7cmV0dXJuIHRoaXN9LHJlbW92ZUNsYXNzOmZ1bmN0aW9uKCl7Zm9yKHZhciB0PTA7dDxhcmd1bWVudHMubGVuZ3RoO3QrKyllWzBdLmJvZHkuY2xhc3NMaXN0LnJlbW92ZShhcmd1bWVudHNbdF0pO3JldHVybiB0aGlzfSxlbmFibGVDbGFzczpmdW5jdGlvbihlKXt2YXIgdD1BcnJheS5wcm90b3R5cGUuc2xpY2UuY2FsbChhcmd1bWVudHMpLnNsaWNlKDEpO3JldHVybiBlP3RoaXMuYWRkQ2xhc3MuYXBwbHkodGhpcyx0KTp0aGlzLnJlbW92ZUNsYXNzLmFwcGx5KHRoaXMsdCksdGhpc30sYXBwZW5kOmZ1bmN0aW9uKHQpe3JldHVybiBlWzBdLmJvZHkuYXBwZW5kQ2hpbGQodC5sZW5ndGg/dFswXTp0KSx0aGlzfSxnZXQ6ZnVuY3Rpb24oKXtyZXR1cm4gZVswXS5ib2R5fX19XSksdS5mYWN0b3J5KFwiJGlvbmljQ2xpY2tCbG9ja1wiLFtcIiRkb2N1bWVudFwiLFwiJGlvbmljQm9keVwiLFwiJHRpbWVvdXRcIixmdW5jdGlvbihlLHQsbil7dmFyIGk9ZVswXS5jcmVhdGVFbGVtZW50KFwiZGl2XCIpO3JldHVybiBpLmNsYXNzTmFtZT1cImNsaWNrLWJsb2NrXCIse3Nob3c6ZnVuY3Rpb24oKXtpLnBhcmVudEVsZW1lbnQ/aS5jbGFzc0xpc3QucmVtb3ZlKFwiaGlkZVwiKTp0LmFwcGVuZChpKSxuKGZ1bmN0aW9uKCl7aS5jbGFzc0xpc3QuYWRkKFwiaGlkZVwiKX0sNTAwKX0saGlkZTpmdW5jdGlvbigpe2kuY2xhc3NMaXN0LmFkZChcImhpZGVcIil9fX1dKSx1LmZhY3RvcnkoXCIkY29sbGVjdGlvbkRhdGFTb3VyY2VcIixbXCIkY2FjaGVGYWN0b3J5XCIsXCIkcGFyc2VcIixcIiRyb290U2NvcGVcIixmdW5jdGlvbihuLGksbyl7ZnVuY3Rpb24gcihlKXtlLmNzcyhpb25pYy5DU1MuVFJBTlNGT1JNLFwidHJhbnNsYXRlM2QoLTIwMDBweCwtMjAwMHB4LDApXCIpfWZ1bmN0aW9uIGEoZSl7dGhpcy5zY29wZT1lLnNjb3BlLHRoaXMudHJhbnNjbHVkZUZuPWUudHJhbnNjbHVkZUZuLHRoaXMudHJhbnNjbHVkZVBhcmVudD1lLnRyYW5zY2x1ZGVQYXJlbnQsdGhpcy5lbGVtZW50PWUuZWxlbWVudCx0aGlzLmtleUV4cHI9ZS5rZXlFeHByLHRoaXMubGlzdEV4cHI9ZS5saXN0RXhwcix0aGlzLnRyYWNrQnlFeHByPWUudHJhY2tCeUV4cHIsdGhpcy5oZWlnaHRHZXR0ZXI9ZS5oZWlnaHRHZXR0ZXIsdGhpcy53aWR0aEdldHRlcj1lLndpZHRoR2V0dGVyLHRoaXMuZGltZW5zaW9ucz1bXSx0aGlzLmRhdGE9W10sdGhpcy5hdHRhY2hlZEl0ZW1zPXt9LHRoaXMuQkFDS1VQX0lURU1TX0xFTkdUSD0yMCx0aGlzLmJhY2t1cEl0ZW1zQXJyYXk9W119cmV0dXJuIGEucHJvdG90eXBlPXtzZXR1cDpmdW5jdGlvbigpe2lmKCF0aGlzLmlzU2V0dXApe3RoaXMuaXNTZXR1cD0hMDtmb3IodmFyIGU9MDtlPHRoaXMuQkFDS1VQX0lURU1TX0xFTkdUSDtlKyspdGhpcy5kZXRhY2hJdGVtKHRoaXMuY3JlYXRlSXRlbSgpKX19LGRlc3Ryb3k6ZnVuY3Rpb24oKXt0aGlzLmRpbWVuc2lvbnMubGVuZ3RoPTAsdGhpcy5kYXRhPW51bGwsdGhpcy5iYWNrdXBJdGVtc0FycmF5Lmxlbmd0aD0wLHRoaXMuYXR0YWNoZWRJdGVtcz17fX0sY2FsY3VsYXRlRGF0YURpbWVuc2lvbnM6ZnVuY3Rpb24oKXt2YXIgZT17fTt0aGlzLmRpbWVuc2lvbnM9dGhpcy5kYXRhLm1hcChmdW5jdGlvbih0LG4pe3JldHVybiBlW3RoaXMua2V5RXhwcl09dCxlLiRpbmRleD1uLHt3aWR0aDp0aGlzLndpZHRoR2V0dGVyKHRoaXMuc2NvcGUsZSksaGVpZ2h0OnRoaXMuaGVpZ2h0R2V0dGVyKHRoaXMuc2NvcGUsZSl9fSx0aGlzKSx0aGlzLmRpbWVuc2lvbnM9dGhpcy5iZWZvcmVTaWJsaW5ncy5jb25jYXQodGhpcy5kaW1lbnNpb25zKS5jb25jYXQodGhpcy5hZnRlclNpYmxpbmdzKSx0aGlzLmRhdGFTdGFydEluZGV4PXRoaXMuYmVmb3JlU2libGluZ3MubGVuZ3RofSxjcmVhdGVJdGVtOmZ1bmN0aW9uKCl7dmFyIGU9e307cmV0dXJuIGUuc2NvcGU9dGhpcy5zY29wZS4kbmV3KCksdGhpcy50cmFuc2NsdWRlRm4oZS5zY29wZSxmdW5jdGlvbih0KXt0LmNzcyhcInBvc2l0aW9uXCIsXCJhYnNvbHV0ZVwiKSxlLmVsZW1lbnQ9dH0pLHRoaXMudHJhbnNjbHVkZVBhcmVudC5hcHBlbmQoZS5lbGVtZW50KSxlfSxnZXRJdGVtOmZ1bmN0aW9uKGUpe3JldHVybihpdGVtPXRoaXMuYXR0YWNoZWRJdGVtc1tlXSl8fCgoaXRlbT10aGlzLmJhY2t1cEl0ZW1zQXJyYXkucG9wKCkpP3QoaXRlbS5zY29wZSk6aXRlbT10aGlzLmNyZWF0ZUl0ZW0oKSksaXRlbX0sYXR0YWNoSXRlbUF0SW5kZXg6ZnVuY3Rpb24oZSl7aWYoZTx0aGlzLmRhdGFTdGFydEluZGV4KXJldHVybiB0aGlzLmJlZm9yZVNpYmxpbmdzW2VdO2lmKGUtPXRoaXMuZGF0YVN0YXJ0SW5kZXgsZT50aGlzLmRhdGEubGVuZ3RoLTEpcmV0dXJuIHRoaXMuYWZ0ZXJTaWJsaW5nc1tlLXRoaXMuZGF0YVN0YXJ0SW5kZXhdO3ZhciB0PXRoaXMuZ2V0SXRlbShlKSxuPXRoaXMuZGF0YVtlXTtyZXR1cm4odC5pbmRleCE9PWV8fHQuc2NvcGVbdGhpcy5rZXlFeHByXSE9PW4pJiYodC5pbmRleD10LnNjb3BlLiRpbmRleD1lLHQuc2NvcGVbdGhpcy5rZXlFeHByXT1uLHQuc2NvcGUuJGZpcnN0PTA9PT1lLHQuc2NvcGUuJGxhc3Q9ZT09PXRoaXMuZ2V0TGVuZ3RoKCktMSx0LnNjb3BlLiRtaWRkbGU9ISh0LnNjb3BlLiRmaXJzdHx8dC5zY29wZS4kbGFzdCksdC5zY29wZS4kb2RkPSEodC5zY29wZS4kZXZlbj0wPT09KDEmZSkpLG8uJCRwaGFzZXx8dC5zY29wZS4kZGlnZXN0KCkpLHRoaXMuYXR0YWNoZWRJdGVtc1tlXT10LHR9LGRlc3Ryb3lJdGVtOmZ1bmN0aW9uKGUpe2UuZWxlbWVudC5yZW1vdmUoKSxlLnNjb3BlLiRkZXN0cm95KCksZS5zY29wZT1udWxsLGUuZWxlbWVudD1udWxsfSxkZXRhY2hJdGVtOmZ1bmN0aW9uKHQpe2RlbGV0ZSB0aGlzLmF0dGFjaGVkSXRlbXNbdC5pbmRleF0sdC5pc091dHNpZGU/cih0LmVsZW1lbnQpOnRoaXMuYmFja3VwSXRlbXNBcnJheS5sZW5ndGg+PXRoaXMuQkFDS1VQX0lURU1TX0xFTkdUSD90aGlzLmRlc3Ryb3lJdGVtKHQpOih0aGlzLmJhY2t1cEl0ZW1zQXJyYXkucHVzaCh0KSxyKHQuZWxlbWVudCksZSh0LnNjb3BlKSl9LGdldExlbmd0aDpmdW5jdGlvbigpe3JldHVybiB0aGlzLmRpbWVuc2lvbnMmJnRoaXMuZGltZW5zaW9ucy5sZW5ndGh8fDB9LHNldERhdGE6ZnVuY3Rpb24oZSx0LG4pe3RoaXMuZGF0YT1lfHxbXSx0aGlzLmJlZm9yZVNpYmxpbmdzPXR8fFtdLHRoaXMuYWZ0ZXJTaWJsaW5ncz1ufHxbXSx0aGlzLmNhbGN1bGF0ZURhdGFEaW1lbnNpb25zKCksdGhpcy5hZnRlclNpYmxpbmdzLmZvckVhY2goZnVuY3Rpb24oZSl7ZS5lbGVtZW50LmNzcyh7cG9zaXRpb246XCJhYnNvbHV0ZVwiLHRvcDpcIjBcIixsZWZ0OlwiMFwifSkscihlLmVsZW1lbnQpfSl9fSxhfV0pLHUuZmFjdG9yeShcIiRjb2xsZWN0aW9uUmVwZWF0TWFuYWdlclwiLFtcIiRyb290U2NvcGVcIixcIiR0aW1lb3V0XCIsZnVuY3Rpb24oKXtmdW5jdGlvbiBlKGUpe2Z1bmN0aW9uIHQoKXtyZXR1cm4gbi52aWV3cG9ydFNpemV9dmFyIG49dGhpczt0aGlzLmRhdGFTb3VyY2U9ZS5kYXRhU291cmNlLHRoaXMuZWxlbWVudD1lLmVsZW1lbnQsdGhpcy5zY3JvbGxWaWV3PWUuc2Nyb2xsVmlldyx0aGlzLmlzVmVydGljYWw9ISF0aGlzLnNjcm9sbFZpZXcub3B0aW9ucy5zY3JvbGxpbmdZLHRoaXMucmVuZGVyZWRJdGVtcz17fSx0aGlzLmRpbWVuc2lvbnM9W10sdGhpcy5zZXRDdXJyZW50SW5kZXgoMCksdGhpcy5zY3JvbGxWaWV3Ll9fJGNhbGxiYWNrPXRoaXMuc2Nyb2xsVmlldy5fX2NhbGxiYWNrLHRoaXMuc2Nyb2xsVmlldy5fX2NhbGxiYWNrPWFuZ3VsYXIuYmluZCh0aGlzLHRoaXMucmVuZGVyU2Nyb2xsKSx0aGlzLmlzVmVydGljYWw/KHRoaXMuc2Nyb2xsVmlldy5vcHRpb25zLmdldENvbnRlbnRIZWlnaHQ9dCx0aGlzLnNjcm9sbFZhbHVlPWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuc2Nyb2xsVmlldy5fX3Njcm9sbFRvcH0sdGhpcy5zY3JvbGxNYXhWYWx1ZT1mdW5jdGlvbigpe3JldHVybiB0aGlzLnNjcm9sbFZpZXcuX19tYXhTY3JvbGxUb3B9LHRoaXMuc2Nyb2xsU2l6ZT1mdW5jdGlvbigpe3JldHVybiB0aGlzLnNjcm9sbFZpZXcuX19jbGllbnRIZWlnaHR9LHRoaXMuc2Vjb25kYXJ5U2Nyb2xsU2l6ZT1mdW5jdGlvbigpe3JldHVybiB0aGlzLnNjcm9sbFZpZXcuX19jbGllbnRXaWR0aH0sdGhpcy50cmFuc2Zvcm1TdHJpbmc9ZnVuY3Rpb24oZSx0KXtyZXR1cm5cInRyYW5zbGF0ZTNkKFwiK3QrXCJweCxcIitlK1wicHgsMClcIn0sdGhpcy5wcmltYXJ5RGltZW5zaW9uPWZ1bmN0aW9uKGUpe3JldHVybiBlLmhlaWdodH0sdGhpcy5zZWNvbmRhcnlEaW1lbnNpb249ZnVuY3Rpb24oZSl7cmV0dXJuIGUud2lkdGh9KToodGhpcy5zY3JvbGxWaWV3Lm9wdGlvbnMuZ2V0Q29udGVudFdpZHRoPXQsdGhpcy5zY3JvbGxWYWx1ZT1mdW5jdGlvbigpe3JldHVybiB0aGlzLnNjcm9sbFZpZXcuX19zY3JvbGxMZWZ0fSx0aGlzLnNjcm9sbE1heFZhbHVlPWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuc2Nyb2xsVmlldy5fX21heFNjcm9sbExlZnR9LHRoaXMuc2Nyb2xsU2l6ZT1mdW5jdGlvbigpe3JldHVybiB0aGlzLnNjcm9sbFZpZXcuX19jbGllbnRXaWR0aH0sdGhpcy5zZWNvbmRhcnlTY3JvbGxTaXplPWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuc2Nyb2xsVmlldy5fX2NsaWVudEhlaWdodH0sdGhpcy50cmFuc2Zvcm1TdHJpbmc9ZnVuY3Rpb24oZSx0KXtyZXR1cm5cInRyYW5zbGF0ZTNkKFwiK2UrXCJweCxcIit0K1wicHgsMClcIn0sdGhpcy5wcmltYXJ5RGltZW5zaW9uPWZ1bmN0aW9uKGUpe3JldHVybiBlLndpZHRofSx0aGlzLnNlY29uZGFyeURpbWVuc2lvbj1mdW5jdGlvbihlKXtyZXR1cm4gZS5oZWlnaHR9KX1yZXR1cm4gZS5wcm90b3R5cGU9e2Rlc3Ryb3k6ZnVuY3Rpb24oKXt0aGlzLnJlbmRlcmVkSXRlbXM9e30sdGhpcy5yZW5kZXI9YW5ndWxhci5ub29wLHRoaXMuY2FsY3VsYXRlRGltZW5zaW9ucz1hbmd1bGFyLm5vb3AsdGhpcy5kaW1lbnNpb25zPVtdfSxjYWxjdWxhdGVEaW1lbnNpb25zOmZ1bmN0aW9uKCl7ZnVuY3Rpb24gZShlKXt2YXIgcj17cHJpbWFyeVNpemU6dGhpcy5wcmltYXJ5RGltZW5zaW9uKGUpLHNlY29uZGFyeVNpemU6TWF0aC5taW4odGhpcy5zZWNvbmRhcnlEaW1lbnNpb24oZSksbyl9O3JldHVybiB0JiYoaSs9dC5zZWNvbmRhcnlTaXplLHQucHJpbWFyeVBvcz09PW4mJmkrci5zZWNvbmRhcnlTaXplPm8mJihpPTAsbis9dC5wcmltYXJ5U2l6ZSkpLHIucHJpbWFyeVBvcz1uLHIuc2Vjb25kYXJ5UG9zPWksdD1yLHJ9dmFyIHQsbj0wLGk9MCxvPXRoaXMuc2Vjb25kYXJ5U2Nyb2xsU2l6ZSgpO3RoaXMuZGF0YVNvdXJjZS5iZWZvcmVTaWJsaW5ncyYmdGhpcy5kYXRhU291cmNlLmJlZm9yZVNpYmxpbmdzLmZvckVhY2goZSx0aGlzKTt2YXIgcj1uKyh0P3QucHJpbWFyeVNpemU6MCk7bj1pPTAsdD1udWxsO3ZhciBhPXRoaXMuZGF0YVNvdXJjZS5kaW1lbnNpb25zLm1hcChlLHRoaXMpLHM9bisodD90LnByaW1hcnlTaXplOjApO3JldHVybntiZWZvcmVTaXplOnIsdG90YWxTaXplOnMsZGltZW5zaW9uczphfX0scmVzaXplOmZ1bmN0aW9uKCl7dmFyIGU9dGhpcy5jYWxjdWxhdGVEaW1lbnNpb25zKCk7dGhpcy5kaW1lbnNpb25zPWUuZGltZW5zaW9ucyx0aGlzLnZpZXdwb3J0U2l6ZT1lLnRvdGFsU2l6ZSx0aGlzLmJlZm9yZVNpemU9ZS5iZWZvcmVTaXplLHRoaXMuc2V0Q3VycmVudEluZGV4KDApLHRoaXMucmVuZGVyKCEwKSx0aGlzLmRhdGFTb3VyY2Uuc2V0dXAoKX0sc2V0Q3VycmVudEluZGV4OmZ1bmN0aW9uKGUpe3ZhciB0PSh0aGlzLmRpbWVuc2lvbnNbZV18fHt9KS5wcmltYXJ5UG9zfHwwO3RoaXMuY3VycmVudEluZGV4PWUsdGhpcy5oYXNQcmV2SW5kZXg9ZT4wLHRoaXMuaGFzUHJldkluZGV4JiYodGhpcy5wcmV2aW91c1Bvcz1NYXRoLm1heCh0LXRoaXMuZGltZW5zaW9uc1tlLTFdLnByaW1hcnlTaXplLHRoaXMuZGltZW5zaW9uc1tlLTFdLnByaW1hcnlQb3MpKSx0aGlzLmhhc05leHRJbmRleD1lKzE8dGhpcy5kYXRhU291cmNlLmdldExlbmd0aCgpLHRoaXMuaGFzTmV4dEluZGV4JiYodGhpcy5uZXh0UG9zPU1hdGgubWluKHQrdGhpcy5kaW1lbnNpb25zW2UrMV0ucHJpbWFyeVNpemUsdGhpcy5kaW1lbnNpb25zW2UrMV0ucHJpbWFyeVBvcykpfSxyZW5kZXJTY3JvbGw6aW9uaWMuYW5pbWF0aW9uRnJhbWVUaHJvdHRsZShmdW5jdGlvbihlLHQsbixpKXtyZXR1cm4gdGhpcy5yZW5kZXJJZk5lZWRlZCh0aGlzLmlzVmVydGljYWw/dDplKSx0aGlzLnNjcm9sbFZpZXcuX18kY2FsbGJhY2soZSx0LG4saSl9KSxyZW5kZXJJZk5lZWRlZDpmdW5jdGlvbihlKXsodGhpcy5oYXNOZXh0SW5kZXgmJmU+PXRoaXMubmV4dFBvc3x8dGhpcy5oYXNQcmV2SW5kZXgmJmU8dGhpcy5wcmV2aW91c1BvcykmJnRoaXMucmVuZGVyKCl9LGdldEluZGV4Rm9yU2Nyb2xsVmFsdWU6ZnVuY3Rpb24oZSx0KXt2YXIgbjtpZih0PD10aGlzLmRpbWVuc2lvbnNbZV0ucHJpbWFyeVBvcylmb3IoOyhuPXRoaXMuZGltZW5zaW9uc1tlLTFdKSYmbi5wcmltYXJ5UG9zPnQ7KWUtLTtlbHNlIGZvcig7KG49dGhpcy5kaW1lbnNpb25zW2UrMV0pJiZuLnByaW1hcnlQb3M8dDspZSsrO3JldHVybiBlfSxyZW5kZXI6ZnVuY3Rpb24oZSl7ZnVuY3Rpb24gdChlLHQpe2U8aS5kYXRhU291cmNlLmRhdGFTdGFydEluZGV4fHxpLnJlbmRlckl0ZW0oZSx0LnByaW1hcnlQb3MtaS5iZWZvcmVTaXplLHQuc2Vjb25kYXJ5UG9zKX12YXIgbixpPXRoaXMsbz10aGlzLmN1cnJlbnRJbmRleD49dGhpcy5kYXRhU291cmNlLmdldExlbmd0aCgpO2lmKG98fGUpe2ZvcihuIGluIHRoaXMucmVuZGVyZWRJdGVtcyl0aGlzLnJlbW92ZUl0ZW0obik7aWYobylyZXR1cm59Zm9yKHZhciByLGE9dGhpcy5zY3JvbGxWYWx1ZSgpLHM9dGhpcy5zY3JvbGxTaXplKCksYz1zK2EsbD10aGlzLmdldEluZGV4Rm9yU2Nyb2xsVmFsdWUodGhpcy5jdXJyZW50SW5kZXgsYSksdT1NYXRoLm1heChsLTEsMCk7dT4wJiYocj10aGlzLmRpbWVuc2lvbnNbdV0pJiZyLnByaW1hcnlQb3M9PT10aGlzLmRpbWVuc2lvbnNbbC0xXS5wcmltYXJ5UG9zOyl1LS07Zm9yKG49dTsocj10aGlzLmRpbWVuc2lvbnNbbl0pJiZyLnByaW1hcnlQb3Mtci5wcmltYXJ5U2l6ZTxjOyl0KG4sciksbisrO2kuZGltZW5zaW9uc1tuXSYmKHQobixpLmRpbWVuc2lvbnNbbl0pLG4rKyksaS5kaW1lbnNpb25zW25dJiZ0KG4saS5kaW1lbnNpb25zW25dKTt2YXIgZD1uO2Zvcih2YXIgZiBpbiB0aGlzLnJlbmRlcmVkSXRlbXMpKHU+Znx8Zj5kKSYmdGhpcy5yZW1vdmVJdGVtKGYpO3RoaXMuc2V0Q3VycmVudEluZGV4KGwpfSxyZW5kZXJJdGVtOmZ1bmN0aW9uKGUsdCxuKXt2YXIgaT10aGlzLmRhdGFTb3VyY2UuYXR0YWNoSXRlbUF0SW5kZXgoZSk7aSYmaS5lbGVtZW50PygoaS5wcmltYXJ5UG9zIT09dHx8aS5zZWNvbmRhcnlQb3MhPT1uKSYmKGkuZWxlbWVudC5jc3MoaW9uaWMuQ1NTLlRSQU5TRk9STSx0aGlzLnRyYW5zZm9ybVN0cmluZyh0LG4pKSxpLnByaW1hcnlQb3M9dCxpLnNlY29uZGFyeVBvcz1uKSx0aGlzLnJlbmRlcmVkSXRlbXNbZV09aSk6ZGVsZXRlIHRoaXMucmVuZGVyZWRJdGVtc1tlXX0scmVtb3ZlSXRlbTpmdW5jdGlvbihlKXt2YXIgdD10aGlzLnJlbmRlcmVkSXRlbXNbZV07dCYmKHQucHJpbWFyeVBvcz10LnNlY29uZGFyeVBvcz1udWxsLHRoaXMuZGF0YVNvdXJjZS5kZXRhY2hJdGVtKHQpLGRlbGV0ZSB0aGlzLnJlbmRlcmVkSXRlbXNbZV0pfX0sZX1dKSx1LmZhY3RvcnkoXCIkaW9uaWNHZXN0dXJlXCIsW2Z1bmN0aW9uKCl7cmV0dXJue29uOmZ1bmN0aW9uKGUsdCxuLGkpe3JldHVybiB3aW5kb3cuaW9uaWMub25HZXN0dXJlKGUsdCxuWzBdLGkpfSxvZmY6ZnVuY3Rpb24oZSx0LG4pe3JldHVybiB3aW5kb3cuaW9uaWMub2ZmR2VzdHVyZShlLHQsbil9fX1dKSx1LnByb3ZpZGVyKFwiJGlvbmljQ29uZmlnXCIsZnVuY3Rpb24oKXt2YXIgZT17cHJlZmV0Y2hUZW1wbGF0ZXM6ITB9O3RoaXMucHJlZmV0Y2hUZW1wbGF0ZXM9ZnVuY3Rpb24odCl7cmV0dXJuIGFyZ3VtZW50cy5sZW5ndGgmJihlLnByZWZldGNoVGVtcGxhdGVzPXQpLGUucHJlZmV0Y2hUZW1wbGF0ZXN9LHRoaXMuJGdldD1mdW5jdGlvbigpe3JldHVybiBlfX0pO3ZhciBnPSc8ZGl2IGNsYXNzPVwibG9hZGluZy1jb250YWluZXJcIj48ZGl2IGNsYXNzPVwibG9hZGluZ1wiPjwvZGl2PjwvZGl2PicsbT1cIiRpb25pY0xvYWRpbmcgaW5zdGFuY2UuaGlkZSgpIGhhcyBiZWVuIGRlcHJlY2F0ZWQuIFVzZSAkaW9uaWNMb2FkaW5nLmhpZGUoKS5cIiwkPVwiJGlvbmljTG9hZGluZyBpbnN0YW5jZS5zaG93KCkgaGFzIGJlZW4gZGVwcmVjYXRlZC4gVXNlICRpb25pY0xvYWRpbmcuc2hvdygpLlwiLHc9XCIkaW9uaWNMb2FkaW5nIGluc3RhbmNlLnNldENvbnRlbnQoKSBoYXMgYmVlbiBkZXByZWNhdGVkLiBVc2UgJGlvbmljTG9hZGluZy5zaG93KHsgdGVtcGxhdGU6ICdteSBjb250ZW50JyB9KS5cIjt1LmNvbnN0YW50KFwiJGlvbmljTG9hZGluZ0NvbmZpZ1wiLHt0ZW1wbGF0ZTonPGkgY2xhc3M9XCJpY29uIGlvbi1sb2FkaW5nLWRcIj48L2k+J30pLmZhY3RvcnkoXCIkaW9uaWNMb2FkaW5nXCIsW1wiJGlvbmljTG9hZGluZ0NvbmZpZ1wiLFwiJGlvbmljQm9keVwiLFwiJGlvbmljVGVtcGxhdGVMb2FkZXJcIixcIiRpb25pY0JhY2tkcm9wXCIsXCIkdGltZW91dFwiLFwiJHFcIixcIiRsb2dcIixcIiRjb21waWxlXCIsXCIkaW9uaWNQbGF0Zm9ybVwiLGZ1bmN0aW9uKGUsdCxuLGksbyxyLGEscyxjKXtmdW5jdGlvbiB1KCl7cmV0dXJuIHB8fChwPW4uY29tcGlsZSh7dGVtcGxhdGU6ZyxhcHBlbmRUbzp0LmdldCgpfSkudGhlbihmdW5jdGlvbihlKXt2YXIgYT1lO3JldHVybiBlLnNob3c9ZnVuY3Rpb24oZSl7dmFyIGM9ZS50ZW1wbGF0ZVVybD9uLmxvYWQoZS50ZW1wbGF0ZVVybCk6ci53aGVuKGUudGVtcGxhdGV8fGUuY29udGVudHx8XCJcIik7dGhpcy5pc1Nob3dufHwodGhpcy5oYXNCYWNrZHJvcD0hZS5ub0JhY2tkcm9wJiZlLnNob3dCYWNrZHJvcCE9PSExLHRoaXMuaGFzQmFja2Ryb3AmJihpLnJldGFpbigpLGkuZ2V0RWxlbWVudCgpLmFkZENsYXNzKFwiYmFja2Ryb3AtbG9hZGluZ1wiKSkpLGUuZHVyYXRpb24mJihvLmNhbmNlbCh0aGlzLmR1cmF0aW9uVGltZW91dCksdGhpcy5kdXJhdGlvblRpbWVvdXQ9byhhbmd1bGFyLmJpbmQodGhpcyx0aGlzLmhpZGUpLCtlLmR1cmF0aW9uKSksYy50aGVuKGZ1bmN0aW9uKGUpe2lmKGUpe3ZhciBuPWEuZWxlbWVudC5jaGlsZHJlbigpO24uaHRtbChlKSxzKG4uY29udGVudHMoKSkoYS5zY29wZSl9YS5pc1Nob3duJiYoYS5lbGVtZW50LmFkZENsYXNzKFwidmlzaWJsZVwiKSxpb25pYy5yZXF1ZXN0QW5pbWF0aW9uRnJhbWUoZnVuY3Rpb24oKXthLmlzU2hvd24mJihhLmVsZW1lbnQuYWRkQ2xhc3MoXCJhY3RpdmVcIiksdC5hZGRDbGFzcyhcImxvYWRpbmctYWN0aXZlXCIpKX0pKX0pLHRoaXMuaXNTaG93bj0hMH0sZS5oaWRlPWZ1bmN0aW9uKCl7dGhpcy5pc1Nob3duJiYodGhpcy5oYXNCYWNrZHJvcCYmKGkucmVsZWFzZSgpLGkuZ2V0RWxlbWVudCgpLnJlbW92ZUNsYXNzKFwiYmFja2Ryb3AtbG9hZGluZ1wiKSksYS5lbGVtZW50LnJlbW92ZUNsYXNzKFwiYWN0aXZlXCIpLHQucmVtb3ZlQ2xhc3MoXCJsb2FkaW5nLWFjdGl2ZVwiKSxzZXRUaW1lb3V0KGZ1bmN0aW9uKCl7IWEuaXNTaG93biYmYS5lbGVtZW50LnJlbW92ZUNsYXNzKFwidmlzaWJsZVwiKX0sMjAwKSksby5jYW5jZWwodGhpcy5kdXJhdGlvblRpbWVvdXQpLHRoaXMuaXNTaG93bj0hMX0sZX0pKSxwfWZ1bmN0aW9uIGYodCl7dD1kKGV8fHt9LHR8fHt9KTt2YXIgbj10LmRlbGF5fHx0LnNob3dEZWxheXx8MDtyZXR1cm4gYiYmby5jYW5jZWwoYiksYj1vKGFuZ3VsYXIubm9vcCxuKSxiLnRoZW4odSkudGhlbihmdW5jdGlvbihlKXtyZXR1cm4gdigpLHY9Yy5yZWdpc3RlckJhY2tCdXR0b25BY3Rpb24oYW5ndWxhci5ub29wLFQpLGUuc2hvdyh0KX0pLHtoaWRlOmwubWV0aG9kKG0sYS5lcnJvcixoKSxzaG93OmwubWV0aG9kKCQsYS5lcnJvcixmdW5jdGlvbigpe2YodCl9KSxzZXRDb250ZW50OmwubWV0aG9kKHcsYS5lcnJvcixmdW5jdGlvbihlKXt1KCkudGhlbihmdW5jdGlvbih0KXt0LnNob3coe3RlbXBsYXRlOmV9KX0pfSl9fWZ1bmN0aW9uIGgoKXt2KCksby5jYW5jZWwoYiksdSgpLnRoZW4oZnVuY3Rpb24oZSl7ZS5oaWRlKCl9KX12YXIgcCx2PWFuZ3VsYXIubm9vcCxiPXIud2hlbigpO3JldHVybntzaG93OmYsaGlkZTpoLF9nZXRMb2FkZXI6dX19XSksdS5mYWN0b3J5KFwiJGlvbmljTW9kYWxcIixbXCIkcm9vdFNjb3BlXCIsXCIkaW9uaWNCb2R5XCIsXCIkY29tcGlsZVwiLFwiJHRpbWVvdXRcIixcIiRpb25pY1BsYXRmb3JtXCIsXCIkaW9uaWNUZW1wbGF0ZUxvYWRlclwiLFwiJHFcIixcIiRsb2dcIixmdW5jdGlvbihlLHQsbixpLG8scixhLHMpe3ZhciBjPWlvbmljLnZpZXdzLk1vZGFsLmluaGVyaXQoe2luaXRpYWxpemU6ZnVuY3Rpb24oZSl7aW9uaWMudmlld3MuTW9kYWwucHJvdG90eXBlLmluaXRpYWxpemUuY2FsbCh0aGlzLGUpLHRoaXMuYW5pbWF0aW9uPWUuYW5pbWF0aW9ufHxcInNsaWRlLWluLXVwXCJ9LHNob3c6ZnVuY3Rpb24oZSl7dmFyIG49dGhpcztpZihuLnNjb3BlLiQkZGVzdHJveWVkKXJldHVybiB2b2lkIHMuZXJyb3IoXCJDYW5ub3QgY2FsbCBcIituLnZpZXdUeXBlK1wiLnNob3coKSBhZnRlciByZW1vdmUoKS4gUGxlYXNlIGNyZWF0ZSBhIG5ldyBcIituLnZpZXdUeXBlK1wiIGluc3RhbmNlLlwiKTt2YXIgcj12KG4ubW9kYWxFbCk7cmV0dXJuIG4uZWwuY2xhc3NMaXN0LnJlbW92ZShcImhpZGVcIiksaShmdW5jdGlvbigpe3QuYWRkQ2xhc3Mobi52aWV3VHlwZStcIi1vcGVuXCIpfSw0MDApLG4uZWwucGFyZW50RWxlbWVudHx8KHIuYWRkQ2xhc3Mobi5hbmltYXRpb24pLHQuYXBwZW5kKG4uZWwpKSxlJiZuLnBvc2l0aW9uVmlldyYmbi5wb3NpdGlvblZpZXcoZSxyKSxyLmFkZENsYXNzKFwibmctZW50ZXIgYWN0aXZlXCIpLnJlbW92ZUNsYXNzKFwibmctbGVhdmUgbmctbGVhdmUtYWN0aXZlXCIpLG4uX2lzU2hvd249ITAsbi5fZGVyZWdpc3RlckJhY2tCdXR0b249by5yZWdpc3RlckJhY2tCdXR0b25BY3Rpb24obi5oYXJkd2FyZUJhY2tCdXR0b25DbG9zZT9hbmd1bGFyLmJpbmQobixuLmhpZGUpOmFuZ3VsYXIubm9vcCxTKSxuLl9pc09wZW5Qcm9taXNlPWEuZGVmZXIoKSxpb25pYy52aWV3cy5Nb2RhbC5wcm90b3R5cGUuc2hvdy5jYWxsKG4pLGkoZnVuY3Rpb24oKXtyLmFkZENsYXNzKFwibmctZW50ZXItYWN0aXZlXCIpLGlvbmljLnRyaWdnZXIoXCJyZXNpemVcIiksbi5zY29wZS4kcGFyZW50JiZuLnNjb3BlLiRwYXJlbnQuJGJyb2FkY2FzdChuLnZpZXdUeXBlK1wiLnNob3duXCIsbiksbi5lbC5jbGFzc0xpc3QuYWRkKFwiYWN0aXZlXCIpfSwyMCksaShmdW5jdGlvbigpe24uJGVsLm9uKFwiY2xpY2tcIixmdW5jdGlvbihlKXtuLmJhY2tkcm9wQ2xpY2tUb0Nsb3NlJiZlLnRhcmdldD09PW4uZWwmJm4uaGlkZSgpfSl9LDQwMCl9LGhpZGU6ZnVuY3Rpb24oKXt2YXIgZT10aGlzLG49dihlLm1vZGFsRWwpO3JldHVybiBlLmVsLmNsYXNzTGlzdC5yZW1vdmUoXCJhY3RpdmVcIiksbi5hZGRDbGFzcyhcIm5nLWxlYXZlXCIpLGkoZnVuY3Rpb24oKXtuLmFkZENsYXNzKFwibmctbGVhdmUtYWN0aXZlXCIpLnJlbW92ZUNsYXNzKFwibmctZW50ZXIgbmctZW50ZXItYWN0aXZlIGFjdGl2ZVwiKX0sMjApLGUuJGVsLm9mZihcImNsaWNrXCIpLGUuX2lzU2hvd249ITEsZS5zY29wZS4kcGFyZW50JiZlLnNjb3BlLiRwYXJlbnQuJGJyb2FkY2FzdChlLnZpZXdUeXBlK1wiLmhpZGRlblwiLGUpLGUuX2RlcmVnaXN0ZXJCYWNrQnV0dG9uJiZlLl9kZXJlZ2lzdGVyQmFja0J1dHRvbigpLGlvbmljLnZpZXdzLk1vZGFsLnByb3RvdHlwZS5oaWRlLmNhbGwoZSksaShmdW5jdGlvbigpe3QucmVtb3ZlQ2xhc3MoZS52aWV3VHlwZStcIi1vcGVuXCIpLGUuZWwuY2xhc3NMaXN0LmFkZChcImhpZGVcIil9LGUuaGlkZURlbGF5fHwzMjApfSxyZW1vdmU6ZnVuY3Rpb24oKXt2YXIgZT10aGlzO3JldHVybiBlLnNjb3BlLiRwYXJlbnQmJmUuc2NvcGUuJHBhcmVudC4kYnJvYWRjYXN0KGUudmlld1R5cGUrXCIucmVtb3ZlZFwiLGUpLGUuaGlkZSgpLnRoZW4oZnVuY3Rpb24oKXtlLnNjb3BlLiRkZXN0cm95KCksZS4kZWwucmVtb3ZlKCl9KX0saXNTaG93bjpmdW5jdGlvbigpe3JldHVybiEhdGhpcy5faXNTaG93bn19KSxsPWZ1bmN0aW9uKHQsaSl7dmFyIG89aS5zY29wZSYmaS5zY29wZS4kbmV3KCl8fGUuJG5ldyghMCk7aS52aWV3VHlwZT1pLnZpZXdUeXBlfHxcIm1vZGFsXCIsZChvLHskaGFzSGVhZGVyOiExLCRoYXNTdWJoZWFkZXI6ITEsJGhhc0Zvb3RlcjohMSwkaGFzU3ViZm9vdGVyOiExLCRoYXNUYWJzOiExLCRoYXNUYWJzVG9wOiExfSk7dmFyIHI9bihcIjxpb24tXCIraS52aWV3VHlwZStcIj5cIit0K1wiPC9pb24tXCIraS52aWV3VHlwZStcIj5cIikobyk7aS4kZWw9cixpLmVsPXJbMF0saS5tb2RhbEVsPWkuZWwucXVlcnlTZWxlY3RvcihcIi5cIitpLnZpZXdUeXBlKTt2YXIgYT1uZXcgYyhpKTtyZXR1cm4gYS5zY29wZT1vLGkuc2NvcGV8fChvW2kudmlld1R5cGVdPWEpLGF9O3JldHVybntmcm9tVGVtcGxhdGU6ZnVuY3Rpb24oZSx0KXt2YXIgbj1sKGUsdHx8e30pO3JldHVybiBufSxmcm9tVGVtcGxhdGVVcmw6ZnVuY3Rpb24oZSx0LG4pe3ZhciBpO3JldHVybiBhbmd1bGFyLmlzRnVuY3Rpb24odCkmJihpPXQsdD1uKSxyLmxvYWQoZSkudGhlbihmdW5jdGlvbihlKXt2YXIgbj1sKGUsdHx8e30pO3JldHVybiBpJiZpKG4pLG59KX19fV0pLHUuc2VydmljZShcIiRpb25pY05hdkJhckRlbGVnYXRlXCIsbihbXCJiYWNrXCIsXCJhbGlnblwiLFwic2hvd0JhY2tCdXR0b25cIixcInNob3dCYXJcIixcInNldFRpdGxlXCIsXCJjaGFuZ2VUaXRsZVwiLFwiZ2V0VGl0bGVcIixcImdldFByZXZpb3VzVGl0bGVcIl0pKTt2YXIgYj0xMDAseT0xNTAsUz0yMDAsQz0zMDAsaz00MDAsVD01MDA7dS5jb25zdGFudChcIiRpb25pY1BsYXRmb3JtRGVmYXVsdHNcIix7aW9zOnskaW9uaWNOYXZCYXJDb25maWc6e3RyYW5zaXRpb246XCJuYXYtdGl0bGUtc2xpZGUtaW9zXCIsYWxpZ25UaXRsZTpcImNlbnRlclwiLGJhY2tCdXR0b25JY29uOlwiaW9uLWlvczctYXJyb3ctYmFja1wifSwkaW9uaWNOYXZWaWV3Q29uZmlnOnt0cmFuc2l0aW9uOlwic2xpZGUtaW9zXCJ9LCRpb25pY1RhYnNDb25maWc6e3R5cGU6XCJcIixwb3NpdGlvbjpcIlwifX0sYW5kcm9pZDp7JGlvbmljTmF2QmFyQ29uZmlnOnt0cmFuc2l0aW9uOlwibmF2LXRpdGxlLXNsaWRlLWZ1bGxcIixhbGlnblRpdGxlOlwiY2VudGVyXCIsYmFja0J1dHRvbkljb246XCJpb24taW9zNy1hcnJvdy1iYWNrXCJ9LCRpb25pY05hdlZpZXdDb25maWc6e3RyYW5zaXRpb246XCJzbGlkZS1mdWxsXCJ9LCRpb25pY1RhYnNDb25maWc6e3R5cGU6XCJ0YWJzLXN0cmlwZWRcIixwb3NpdGlvbjpcIlwifX19KSx1LmNvbmZpZyhbXCIkaW9uaWNQbGF0Zm9ybURlZmF1bHRzXCIsXCIkaW5qZWN0b3JcIixmdW5jdGlvbihlLHQpe3ZhciBuPWlvbmljLlBsYXRmb3JtLnBsYXRmb3JtKCksaT1mdW5jdGlvbihlKXtmKGUsZnVuY3Rpb24oZSxuKXtkKHQuZ2V0KG4pLGUpfSl9O3N3aXRjaChuKXtjYXNlXCJpb3NcIjppKGUuaW9zKTticmVhaztjYXNlXCJhbmRyb2lkXCI6aShlLmFuZHJvaWQpfX1dKSx1LnByb3ZpZGVyKFwiJGlvbmljUGxhdGZvcm1cIixmdW5jdGlvbigpe3JldHVybnskZ2V0OltcIiRxXCIsXCIkcm9vdFNjb3BlXCIsZnVuY3Rpb24oZSl7dmFyIHQ9e29uSGFyZHdhcmVCYWNrQnV0dG9uOmZ1bmN0aW9uKGUpe2lvbmljLlBsYXRmb3JtLnJlYWR5KGZ1bmN0aW9uKCl7ZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lcihcImJhY2tidXR0b25cIixlLCExKX0pfSxvZmZIYXJkd2FyZUJhY2tCdXR0b246ZnVuY3Rpb24oZSl7aW9uaWMuUGxhdGZvcm0ucmVhZHkoZnVuY3Rpb24oKXtkb2N1bWVudC5yZW1vdmVFdmVudExpc3RlbmVyKFwiYmFja2J1dHRvblwiLGUpfSl9LCRiYWNrQnV0dG9uQWN0aW9uczp7fSxyZWdpc3RlckJhY2tCdXR0b25BY3Rpb246ZnVuY3Rpb24oZSxuLGkpe3QuX2hhc0JhY2tCdXR0b25IYW5kbGVyfHwodC4kYmFja0J1dHRvbkFjdGlvbnM9e30sdC5vbkhhcmR3YXJlQmFja0J1dHRvbih0LmhhcmR3YXJlQmFja0J1dHRvbkNsaWNrKSx0Ll9oYXNCYWNrQnV0dG9uSGFuZGxlcj0hMCk7dmFyIG89e2lkOmk/aTppb25pYy5VdGlscy5uZXh0VWlkKCkscHJpb3JpdHk6bj9uOjAsZm46ZX07cmV0dXJuIHQuJGJhY2tCdXR0b25BY3Rpb25zW28uaWRdPW8sZnVuY3Rpb24oKXtkZWxldGUgdC4kYmFja0J1dHRvbkFjdGlvbnNbby5pZF19fSxoYXJkd2FyZUJhY2tCdXR0b25DbGljazpmdW5jdGlvbihlKXt2YXIgbixpO2ZvcihpIGluIHQuJGJhY2tCdXR0b25BY3Rpb25zKSghbnx8dC4kYmFja0J1dHRvbkFjdGlvbnNbaV0ucHJpb3JpdHk+PW4ucHJpb3JpdHkpJiYobj10LiRiYWNrQnV0dG9uQWN0aW9uc1tpXSk7cmV0dXJuIG4/KG4uZm4oZSksbik6dm9pZCAwfSxpczpmdW5jdGlvbihlKXtyZXR1cm4gaW9uaWMuUGxhdGZvcm0uaXMoZSl9LG9uOmZ1bmN0aW9uKGUsdCl7cmV0dXJuIGlvbmljLlBsYXRmb3JtLnJlYWR5KGZ1bmN0aW9uKCl7ZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lcihlLHQsITEpfSksZnVuY3Rpb24oKXtpb25pYy5QbGF0Zm9ybS5yZWFkeShmdW5jdGlvbigpe2RvY3VtZW50LnJlbW92ZUV2ZW50TGlzdGVuZXIoZSx0KX0pfX0scmVhZHk6ZnVuY3Rpb24odCl7dmFyIG49ZS5kZWZlcigpO3JldHVybiBpb25pYy5QbGF0Zm9ybS5yZWFkeShmdW5jdGlvbigpe24ucmVzb2x2ZSgpLHQmJnQoKX0pLG4ucHJvbWlzZX19O3JldHVybiB0fV19fSksdS5mYWN0b3J5KFwiJGlvbmljUG9wb3ZlclwiLFtcIiRpb25pY01vZGFsXCIsXCIkaW9uaWNQb3NpdGlvblwiLFwiJGRvY3VtZW50XCIsXCIkd2luZG93XCIsZnVuY3Rpb24oZSx0LG4saSl7ZnVuY3Rpb24gbyhlLG8pe3ZhciBhPWFuZ3VsYXIuZWxlbWVudChlLnRhcmdldHx8ZSkscz10Lm9mZnNldChhKSxjPW8ucHJvcChcIm9mZnNldFdpZHRoXCIpLGw9by5wcm9wKFwib2Zmc2V0SGVpZ2h0XCIpLHU9blswXS5ib2R5LmNsaWVudFdpZHRoLGQ9aS5pbm5lckhlaWdodCxmPXtsZWZ0OnMubGVmdCtzLndpZHRoLzItYy8yfSxoPXYob1swXS5xdWVyeVNlbGVjdG9yKFwiLnBvcG92ZXItYXJyb3dcIikpO2YubGVmdDxyP2YubGVmdD1yOmYubGVmdCtjK3I+dSYmKGYubGVmdD11LWMtcikscy50b3Arcy5oZWlnaHQrbD5kPyhmLnRvcD1zLnRvcC1sLG8uYWRkQ2xhc3MoXCJwb3BvdmVyLWJvdHRvbVwiKSk6KGYudG9wPXMudG9wK3MuaGVpZ2h0LG8ucmVtb3ZlQ2xhc3MoXCJwb3BvdmVyLWJvdHRvbVwiKSksaC5jc3Moe2xlZnQ6cy5sZWZ0K3Mud2lkdGgvMi1oLnByb3AoXCJvZmZzZXRXaWR0aFwiKS8yLWYubGVmdCtcInB4XCJ9KSxvLmNzcyh7dG9wOmYudG9wK1wicHhcIixsZWZ0OmYubGVmdCtcInB4XCIsbWFyZ2luTGVmdDpcIjBcIixvcGFjaXR5OlwiMVwifSl9dmFyIHI9NixhPXt2aWV3VHlwZTpcInBvcG92ZXJcIixoaWRlRGVsYXk6MSxhbmltYXRpb246XCJub25lXCIscG9zaXRpb25WaWV3Om99O3JldHVybntmcm9tVGVtcGxhdGU6ZnVuY3Rpb24odCxuKXtyZXR1cm4gZS5mcm9tVGVtcGxhdGUodCxpb25pYy5VdGlscy5leHRlbmQobnx8e30sYSkpfSxmcm9tVGVtcGxhdGVVcmw6ZnVuY3Rpb24odCxuKXtyZXR1cm4gZS5mcm9tVGVtcGxhdGVVcmwodCxuLGlvbmljLlV0aWxzLmV4dGVuZChufHx7fSxhKSl9fX1dKTt2YXIgST0nPGRpdiBjbGFzcz1cInBvcHVwLWNvbnRhaW5lclwiPjxkaXYgY2xhc3M9XCJwb3B1cFwiPjxkaXYgY2xhc3M9XCJwb3B1cC1oZWFkXCI+PGgzIGNsYXNzPVwicG9wdXAtdGl0bGVcIiBuZy1iaW5kLWh0bWw9XCJ0aXRsZVwiPjwvaDM+PGg1IGNsYXNzPVwicG9wdXAtc3ViLXRpdGxlXCIgbmctYmluZC1odG1sPVwic3ViVGl0bGVcIiBuZy1pZj1cInN1YlRpdGxlXCI+PC9oNT48L2Rpdj48ZGl2IGNsYXNzPVwicG9wdXAtYm9keVwiPjwvZGl2PjxkaXYgY2xhc3M9XCJwb3B1cC1idXR0b25zXCI+PGJ1dHRvbiBuZy1yZXBlYXQ9XCJidXR0b24gaW4gYnV0dG9uc1wiIG5nLWNsaWNrPVwiJGJ1dHRvblRhcHBlZChidXR0b24sICRldmVudClcIiBjbGFzcz1cImJ1dHRvblwiIG5nLWNsYXNzPVwiYnV0dG9uLnR5cGUgfHwgXFwnYnV0dG9uLWRlZmF1bHRcXCdcIiBuZy1iaW5kLWh0bWw9XCJidXR0b24udGV4dFwiPjwvYnV0dG9uPjwvZGl2PjwvZGl2PjwvZGl2Pic7dS5mYWN0b3J5KFwiJGlvbmljUG9wdXBcIixbXCIkaW9uaWNUZW1wbGF0ZUxvYWRlclwiLFwiJGlvbmljQmFja2Ryb3BcIixcIiRxXCIsXCIkdGltZW91dFwiLFwiJHJvb3RTY29wZVwiLFwiJGlvbmljQm9keVwiLFwiJGNvbXBpbGVcIixcIiRpb25pY1BsYXRmb3JtXCIsZnVuY3Rpb24oZSx0LG4saSxvLHIsYSxzKXtmdW5jdGlvbiBjKHQpe3Q9ZCh7c2NvcGU6bnVsbCx0aXRsZTpcIlwiLGJ1dHRvbnM6W119LHR8fHt9KTt2YXIgbz1lLmNvbXBpbGUoe3RlbXBsYXRlOkksc2NvcGU6dC5zY29wZSYmdC5zY29wZS4kbmV3KCksYXBwZW5kVG86ci5nZXQoKX0pLHM9dC50ZW1wbGF0ZVVybD9lLmxvYWQodC50ZW1wbGF0ZVVybCk6bi53aGVuKHQudGVtcGxhdGV8fHQuY29udGVudHx8XCJcIik7cmV0dXJuIG4uYWxsKFtvLHNdKS50aGVuKGZ1bmN0aW9uKGUpe3ZhciBvPWVbMF0scj1lWzFdLHM9bi5kZWZlcigpO28ucmVzcG9uc2VEZWZlcnJlZD1zO3ZhciBjPXYoby5lbGVtZW50WzBdLnF1ZXJ5U2VsZWN0b3IoXCIucG9wdXAtYm9keVwiKSk7cmV0dXJuIHI/KGMuaHRtbChyKSxhKGMuY29udGVudHMoKSkoby5zY29wZSkpOmMucmVtb3ZlKCksZChvLnNjb3BlLHt0aXRsZTp0LnRpdGxlLGJ1dHRvbnM6dC5idXR0b25zLHN1YlRpdGxlOnQuc3ViVGl0bGUsJGJ1dHRvblRhcHBlZDpmdW5jdGlvbihlLHQpe3ZhciBuPShlLm9uVGFwfHxhbmd1bGFyLm5vb3ApKHQpO3Q9dC5vcmlnaW5hbEV2ZW50fHx0LHQuZGVmYXVsdFByZXZlbnRlZHx8cy5yZXNvbHZlKG4pfX0pLG8uc2hvdz1mdW5jdGlvbigpe28uaXNTaG93bnx8KG8uaXNTaG93bj0hMCxpb25pYy5yZXF1ZXN0QW5pbWF0aW9uRnJhbWUoZnVuY3Rpb24oKXtvLmlzU2hvd24mJihvLmVsZW1lbnQucmVtb3ZlQ2xhc3MoXCJwb3B1cC1oaWRkZW5cIiksby5lbGVtZW50LmFkZENsYXNzKFwicG9wdXAtc2hvd2luZyBhY3RpdmVcIiksZihvLmVsZW1lbnQpKX0pKX0sby5oaWRlPWZ1bmN0aW9uKGUpe3JldHVybiBlPWV8fGFuZ3VsYXIubm9vcCxvLmlzU2hvd24/KG8uaXNTaG93bj0hMSxvLmVsZW1lbnQucmVtb3ZlQ2xhc3MoXCJhY3RpdmVcIiksby5lbGVtZW50LmFkZENsYXNzKFwicG9wdXAtaGlkZGVuXCIpLHZvaWQgaShlLDI1MCkpOmUoKX0sby5yZW1vdmU9ZnVuY3Rpb24oKXtvLnJlbW92ZWR8fChvLmhpZGUoZnVuY3Rpb24oKXtvLmVsZW1lbnQucmVtb3ZlKCksby5zY29wZS4kZGVzdHJveSgpfSksby5yZW1vdmVkPSEwKX0sb30pfWZ1bmN0aW9uIGwoKXskWzBdJiYkWzBdLnJlc3BvbnNlRGVmZXJyZWQucmVzb2x2ZSgpfWZ1bmN0aW9uIHUoZSl7ZnVuY3Rpb24gbihlKXtvLnRoZW4oZnVuY3Rpb24odCl7dC5yZW1vdmVkfHx0LnJlc3BvbnNlRGVmZXJyZWQucmVzb2x2ZShlKX0pfXZhciBvPXcuX2NyZWF0ZVBvcHVwKGUpLGE9JFswXTthJiZhLmhpZGUoKTt2YXIgYz1pKGFuZ3VsYXIubm9vcCxhP20uc3RhY2tQdXNoRGVsYXk6MCkudGhlbihmdW5jdGlvbigpe3JldHVybiBvfSkudGhlbihmdW5jdGlvbihlKXtyZXR1cm4gYXx8KHIuYWRkQ2xhc3MoXCJwb3B1cC1vcGVuXCIpLHQucmV0YWluKCksdy5fYmFja0J1dHRvbkFjdGlvbkRvbmU9cy5yZWdpc3RlckJhY2tCdXR0b25BY3Rpb24obCxrKSksJC51bnNoaWZ0KGUpLGUuc2hvdygpLGUucmVzcG9uc2VEZWZlcnJlZC5ub3RpZnkoe2Nsb3NlOmMuY2xvc2V9KSxlLnJlc3BvbnNlRGVmZXJyZWQucHJvbWlzZS50aGVuKGZ1bmN0aW9uKG4pe3ZhciBvPSQuaW5kZXhPZihlKTstMSE9PW8mJiQuc3BsaWNlKG8sMSksZS5yZW1vdmUoKTt2YXIgYT0kWzBdO3JldHVybiBhP2Euc2hvdygpOihpKGZ1bmN0aW9uKCl7ci5yZW1vdmVDbGFzcyhcInBvcHVwLW9wZW5cIil9LDQwMCksdC5yZWxlYXNlKCksKHcuX2JhY2tCdXR0b25BY3Rpb25Eb25lfHxhbmd1bGFyLm5vb3ApKCkpLG59KX0pO3JldHVybiBjLmNsb3NlPW4sY31mdW5jdGlvbiBmKGUpe3ZhciB0PWVbMF0ucXVlcnlTZWxlY3RvcihcIlthdXRvZm9jdXNdXCIpO3QmJnQuZm9jdXMoKX1mdW5jdGlvbiBoKGUpe3JldHVybiB1KGQoe2J1dHRvbnM6W3t0ZXh0OmUub2tUZXh0fHxcIk9LXCIsdHlwZTplLm9rVHlwZXx8XCJidXR0b24tcG9zaXRpdmVcIixvblRhcDpmdW5jdGlvbigpe3JldHVybiEwfX1dfSxlfHx7fSkpfWZ1bmN0aW9uIHAoZSl7cmV0dXJuIHUoZCh7YnV0dG9uczpbe3RleHQ6ZS5jYW5jZWxUZXh0fHxcIkNhbmNlbFwiLHR5cGU6ZS5jYW5jZWxUeXBlfHxcImJ1dHRvbi1kZWZhdWx0XCIsb25UYXA6ZnVuY3Rpb24oKXtyZXR1cm4hMX19LHt0ZXh0OmUub2tUZXh0fHxcIk9LXCIsdHlwZTplLm9rVHlwZXx8XCJidXR0b24tcG9zaXRpdmVcIixvblRhcDpmdW5jdGlvbigpe3JldHVybiEwfX1dfSxlfHx7fSkpfWZ1bmN0aW9uIGcoZSl7dmFyIHQ9by4kbmV3KCEwKTt0LmRhdGE9e307dmFyIG49XCJcIjtyZXR1cm4gZS50ZW1wbGF0ZSYmLzxbYS16XVtcXHNcXFNdKj4vaS50ZXN0KGUudGVtcGxhdGUpPT09ITEmJihuPVwiPHNwYW4+XCIrZS50ZW1wbGF0ZStcIjwvc3Bhbj5cIixkZWxldGUgZS50ZW1wbGF0ZSksdShkKHt0ZW1wbGF0ZTpuKyc8aW5wdXQgbmctbW9kZWw9XCJkYXRhLnJlc3BvbnNlXCIgdHlwZT1cIicrKGUuaW5wdXRUeXBlfHxcInRleHRcIikrJ1wiIHBsYWNlaG9sZGVyPVwiJysoZS5pbnB1dFBsYWNlaG9sZGVyfHxcIlwiKSsnXCI+JyxzY29wZTp0LGJ1dHRvbnM6W3t0ZXh0OmUuY2FuY2VsVGV4dHx8XCJDYW5jZWxcIix0eXBlOmUuY2FuY2VsVHlwZXx8XCJidXR0b24tZGVmYXVsdFwiLG9uVGFwOmZ1bmN0aW9uKCl7fX0se3RleHQ6ZS5va1RleHR8fFwiT0tcIix0eXBlOmUub2tUeXBlfHxcImJ1dHRvbi1wb3NpdGl2ZVwiLG9uVGFwOmZ1bmN0aW9uKCl7cmV0dXJuIHQuZGF0YS5yZXNwb25zZXx8XCJcIn19XX0sZXx8e30pKX12YXIgbT17c3RhY2tQdXNoRGVsYXk6NzV9LCQ9W10sdz17c2hvdzp1LGFsZXJ0OmgsY29uZmlybTpwLHByb21wdDpnLF9jcmVhdGVQb3B1cDpjLF9wb3B1cFN0YWNrOiR9O3JldHVybiB3fV0pLHUuZmFjdG9yeShcIiRpb25pY1Bvc2l0aW9uXCIsW1wiJGRvY3VtZW50XCIsXCIkd2luZG93XCIsZnVuY3Rpb24oZSx0KXtmdW5jdGlvbiBuKGUsbil7cmV0dXJuIGUuY3VycmVudFN0eWxlP2UuY3VycmVudFN0eWxlW25dOnQuZ2V0Q29tcHV0ZWRTdHlsZT90LmdldENvbXB1dGVkU3R5bGUoZSlbbl06ZS5zdHlsZVtuXX1mdW5jdGlvbiBpKGUpe3JldHVyblwic3RhdGljXCI9PT0obihlLFwicG9zaXRpb25cIil8fFwic3RhdGljXCIpfXZhciBvPWZ1bmN0aW9uKHQpe2Zvcih2YXIgbj1lWzBdLG89dC5vZmZzZXRQYXJlbnR8fG47byYmbyE9PW4mJmkobyk7KW89by5vZmZzZXRQYXJlbnQ7cmV0dXJuIG98fG59O3JldHVybntwb3NpdGlvbjpmdW5jdGlvbih0KXt2YXIgbj10aGlzLm9mZnNldCh0KSxpPXt0b3A6MCxsZWZ0OjB9LHI9byh0WzBdKTtyIT1lWzBdJiYoaT10aGlzLm9mZnNldChhbmd1bGFyLmVsZW1lbnQocikpLGkudG9wKz1yLmNsaWVudFRvcC1yLnNjcm9sbFRvcCxpLmxlZnQrPXIuY2xpZW50TGVmdC1yLnNjcm9sbExlZnQpO3ZhciBhPXRbMF0uZ2V0Qm91bmRpbmdDbGllbnRSZWN0KCk7cmV0dXJue3dpZHRoOmEud2lkdGh8fHQucHJvcChcIm9mZnNldFdpZHRoXCIpLGhlaWdodDphLmhlaWdodHx8dC5wcm9wKFwib2Zmc2V0SGVpZ2h0XCIpLHRvcDpuLnRvcC1pLnRvcCxsZWZ0Om4ubGVmdC1pLmxlZnR9fSxvZmZzZXQ6ZnVuY3Rpb24obil7dmFyIGk9blswXS5nZXRCb3VuZGluZ0NsaWVudFJlY3QoKTtyZXR1cm57d2lkdGg6aS53aWR0aHx8bi5wcm9wKFwib2Zmc2V0V2lkdGhcIiksaGVpZ2h0OmkuaGVpZ2h0fHxuLnByb3AoXCJvZmZzZXRIZWlnaHRcIiksdG9wOmkudG9wKyh0LnBhZ2VZT2Zmc2V0fHxlWzBdLmRvY3VtZW50RWxlbWVudC5zY3JvbGxUb3ApLGxlZnQ6aS5sZWZ0Kyh0LnBhZ2VYT2Zmc2V0fHxlWzBdLmRvY3VtZW50RWxlbWVudC5zY3JvbGxMZWZ0KX19fX1dKSx1LnNlcnZpY2UoXCIkaW9uaWNTY3JvbGxEZWxlZ2F0ZVwiLG4oW1wicmVzaXplXCIsXCJzY3JvbGxUb3BcIixcInNjcm9sbEJvdHRvbVwiLFwic2Nyb2xsVG9cIixcInNjcm9sbEJ5XCIsXCJ6b29tVG9cIixcInpvb21CeVwiLFwiZ2V0U2Nyb2xsUG9zaXRpb25cIixcImFuY2hvclNjcm9sbFwiLFwiZ2V0U2Nyb2xsVmlld1wiLFwicmVtZW1iZXJTY3JvbGxQb3NpdGlvblwiLFwiZm9yZ2V0U2Nyb2xsUG9zaXRpb25cIixcInNjcm9sbFRvUmVtZW1iZXJlZFBvc2l0aW9uXCJdKSksdS5zZXJ2aWNlKFwiJGlvbmljU2lkZU1lbnVEZWxlZ2F0ZVwiLG4oW1widG9nZ2xlTGVmdFwiLFwidG9nZ2xlUmlnaHRcIixcImdldE9wZW5SYXRpb1wiLFwiaXNPcGVuXCIsXCJpc09wZW5MZWZ0XCIsXCJpc09wZW5SaWdodFwiLFwiY2FuRHJhZ0NvbnRlbnRcIixcImVkZ2VEcmFnVGhyZXNob2xkXCJdKSksdS5zZXJ2aWNlKFwiJGlvbmljU2xpZGVCb3hEZWxlZ2F0ZVwiLG4oW1widXBkYXRlXCIsXCJzbGlkZVwiLFwiZW5hYmxlU2xpZGVcIixcInByZXZpb3VzXCIsXCJuZXh0XCIsXCJzdG9wXCIsXCJzdGFydFwiLFwiY3VycmVudEluZGV4XCIsXCJzbGlkZXNDb3VudFwiXSkpLHUuc2VydmljZShcIiRpb25pY1RhYnNEZWxlZ2F0ZVwiLG4oW1wic2VsZWN0XCIsXCJzZWxlY3RlZEluZGV4XCJdKSksZnVuY3Rpb24oKXt2YXIgZT1bXTt1LmZhY3RvcnkoXCIkaW9uaWNUZW1wbGF0ZUNhY2hlXCIsW1wiJGh0dHBcIixcIiR0ZW1wbGF0ZUNhY2hlXCIsXCIkdGltZW91dFwiLFwiJGlvbmljQ29uZmlnXCIsZnVuY3Rpb24odCxuLGksbyl7ZnVuY3Rpb24gcihlKXtyZXR1cm4gYS5sZW5ndGg+NTAwPyExOlwidW5kZWZpbmVkXCI9PXR5cGVvZiBlP2MoKToocChlKSYmKGU9W2VdKSxmKGUsZnVuY3Rpb24oZSl7YS5wdXNoKGUpfSksdm9pZChzJiZjKCkpKX12YXIgYT1lLHM9ITEsYz1mdW5jdGlvbigpe2lmKG8ucHJlZmV0Y2hUZW1wbGF0ZXMhPT0hMSYmKHIuX3J1bkNvdW50Kysscz0hMCwwIT09YS5sZW5ndGgpKXtmb3IodmFyIGU9MDs1PmUmJih0ZW1wbGF0ZT1hLnBvcCgpKTspcCh0ZW1wbGF0ZSkmJnQuZ2V0KHRlbXBsYXRlLHtjYWNoZTpufSksZSsrO2EubGVuZ3RoJiZpKGZ1bmN0aW9uKCl7YygpfSwxZTMpfX07cmV0dXJuIHIuX3J1bkNvdW50PTAscn1dKS5jb25maWcoW1wiJHN0YXRlUHJvdmlkZXJcIixcIiRpb25pY0NvbmZpZ1Byb3ZpZGVyXCIsZnVuY3Rpb24odCxuKXt2YXIgaT10LnN0YXRlO3Quc3RhdGU9ZnVuY3Rpb24obyxyKXtpZihcIm9iamVjdFwiPT10eXBlb2YgciYmbi5wcmVmZXRjaFRlbXBsYXRlcygpIT09ITEpe3ZhciBhPXIucHJlZmV0Y2hUZW1wbGF0ZSE9PSExO2lmKGEmJnAoci50ZW1wbGF0ZVVybCkmJmUucHVzaChyLnRlbXBsYXRlVXJsKSxhbmd1bGFyLmlzT2JqZWN0KHIudmlld3MpKWZvcih2YXIgcyBpbiByLnZpZXdzKWE9ci52aWV3c1tzXS5wcmVmZXRjaFRlbXBsYXRlIT09ITEsYSYmcChyLnZpZXdzW3NdLnRlbXBsYXRlVXJsKSYmZS5wdXNoKHIudmlld3Nbc10udGVtcGxhdGVVcmwpfXJldHVybiBpLmNhbGwodCxvLHIpfX1dKS5ydW4oW1wiJGlvbmljVGVtcGxhdGVDYWNoZVwiLGZ1bmN0aW9uKGUpe2UoKX1dKX0oKSx1LmZhY3RvcnkoXCIkaW9uaWNUZW1wbGF0ZUxvYWRlclwiLFtcIiRjb21waWxlXCIsXCIkY29udHJvbGxlclwiLFwiJGh0dHBcIixcIiRxXCIsXCIkcm9vdFNjb3BlXCIsXCIkdGVtcGxhdGVDYWNoZVwiLGZ1bmN0aW9uKGUsdCxuLGksbyxyKXtmdW5jdGlvbiBhKGUpe3JldHVybiBuLmdldChlLHtjYWNoZTpyfSkudGhlbihmdW5jdGlvbihlKXtyZXR1cm4gZS5kYXRhJiZlLmRhdGEudHJpbSgpfSl9ZnVuY3Rpb24gcyhuKXtuPWQoe3RlbXBsYXRlOlwiXCIsdGVtcGxhdGVVcmw6XCJcIixzY29wZTpudWxsLGNvbnRyb2xsZXI6bnVsbCxsb2NhbHM6e30sYXBwZW5kVG86bnVsbH0sbnx8e30pO3ZhciByPW4udGVtcGxhdGVVcmw/dGhpcy5sb2FkKG4udGVtcGxhdGVVcmwpOmkud2hlbihuLnRlbXBsYXRlKTtyZXR1cm4gci50aGVuKGZ1bmN0aW9uKGkpe3ZhciByLGE9bi5zY29wZXx8by4kbmV3KCkscz12KFwiPGRpdj5cIikuaHRtbChpKS5jb250ZW50cygpO3JldHVybiBuLmNvbnRyb2xsZXImJihyPXQobi5jb250cm9sbGVyLGQobi5sb2NhbHMseyRzY29wZTphfSkpLHMuY2hpbGRyZW4oKS5kYXRhKFwiJG5nQ29udHJvbGxlckNvbnRyb2xsZXJcIixyKSksbi5hcHBlbmRUbyYmdihuLmFwcGVuZFRvKS5hcHBlbmQocyksZShzKShhKSx7ZWxlbWVudDpzLHNjb3BlOmF9fSl9cmV0dXJue2xvYWQ6YSxjb21waWxlOnN9fV0pLHUucnVuKFtcIiRyb290U2NvcGVcIixcIiRzdGF0ZVwiLFwiJGxvY2F0aW9uXCIsXCIkZG9jdW1lbnRcIixcIiRhbmltYXRlXCIsXCIkaW9uaWNQbGF0Zm9ybVwiLFwiJGlvbmljVmlld1NlcnZpY2VcIixmdW5jdGlvbihlLHQsbixpLG8scixhKXtmdW5jdGlvbiBzKHQpe3JldHVybiBlLiR2aWV3SGlzdG9yeS5iYWNrVmlldz9lLiR2aWV3SGlzdG9yeS5iYWNrVmlldy5nbygpOmlvbmljLlBsYXRmb3JtLmV4aXRBcHAoKSx0LnByZXZlbnREZWZhdWx0KCksITF9ZS4kdmlld0hpc3Rvcnk9e2hpc3Rvcmllczp7cm9vdDp7aGlzdG9yeUlkOlwicm9vdFwiLHBhcmVudEhpc3RvcnlJZDpudWxsLHN0YWNrOltdLGN1cnNvcjotMX19LHZpZXdzOnt9LGJhY2tWaWV3Om51bGwsZm9yd2FyZFZpZXc6bnVsbCxjdXJyZW50VmlldzpudWxsLGRpc2FibGVkUmVnaXN0cmFibGVUYWdOYW1lczpbXX0sYS5kaXNhYmxlUmVnaXN0ZXJCeVRhZ05hbWUmJihhLmRpc2FibGVSZWdpc3RlckJ5VGFnTmFtZShcImlvbi10YWJzXCIpLGEuZGlzYWJsZVJlZ2lzdGVyQnlUYWdOYW1lKFwiaW9uLXNpZGUtbWVudXNcIikpLGUuJG9uKFwiJHN0YXRlQ2hhbmdlU3RhcnRcIixmdW5jdGlvbigpe2lvbmljLmtleWJvYXJkLmhpZGUoKX0pLGUuJG9uKFwidmlld1N0YXRlLmNoYW5nZUhpc3RvcnlcIixmdW5jdGlvbihpLG8pe2lmKG8pe3ZhciByPW8uaGlzdG9yeUlkP2UuJHZpZXdIaXN0b3J5Lmhpc3Rvcmllc1tvLmhpc3RvcnlJZF06bnVsbDtpZihyJiZyLmN1cnNvcj4tMSYmci5jdXJzb3I8ci5zdGFjay5sZW5ndGgpe3ZhciBhPXIuc3RhY2tbci5jdXJzb3JdO3JldHVybiBhLmdvKG8pfSFvLnVybCYmby51aVNyZWYmJihvLnVybD10LmhyZWYoby51aVNyZWYpKSxvLnVybCYmKDA9PT1vLnVybC5pbmRleE9mKFwiI1wiKSYmKG8udXJsPW8udXJsLnJlcGxhY2UoXCIjXCIsXCJcIikpLG8udXJsIT09bi51cmwoKSYmbi51cmwoby51cmwpKX19KSxlLiRvbihcInZpZXdTdGF0ZS52aWV3RW50ZXJcIixmdW5jdGlvbihlLHQpe3QmJnQudGl0bGUmJihpWzBdLnRpdGxlPXQudGl0bGUpfSksci5yZWdpc3RlckJhY2tCdXR0b25BY3Rpb24ocyxiKX1dKS5mYWN0b3J5KFwiJGlvbmljVmlld1NlcnZpY2VcIixbXCIkcm9vdFNjb3BlXCIsXCIkc3RhdGVcIixcIiRsb2NhdGlvblwiLFwiJHdpbmRvd1wiLFwiJGluamVjdG9yXCIsXCIkYW5pbWF0ZVwiLFwiJGlvbmljTmF2Vmlld0NvbmZpZ1wiLFwiJGlvbmljQ2xpY2tCbG9ja1wiLGZ1bmN0aW9uKGUsdCxuLGksbyxyLGEscyl7ZnVuY3Rpb24gYygpe3JldHVybiBpb25pYy5VdGlscy5uZXh0VWlkKCl9dmFyIGw9ZnVuY3Rpb24oKXt9O3JldHVybiBsLnByb3RvdHlwZS5pbml0aWFsaXplPWZ1bmN0aW9uKGUpe2lmKGUpe2Zvcih2YXIgdCBpbiBlKXRoaXNbdF09ZVt0XTtyZXR1cm4gdGhpc31yZXR1cm4gbnVsbH0sbC5wcm90b3R5cGUuZ289ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5zdGF0ZU5hbWU/dC5nbyh0aGlzLnN0YXRlTmFtZSx0aGlzLnN0YXRlUGFyYW1zKTp0aGlzLnVybCYmdGhpcy51cmwhPT1uLnVybCgpP2UuJHZpZXdIaXN0b3J5LmJhY2tWaWV3PT09dGhpcz9pLmhpc3RvcnkuZ28oLTEpOmUuJHZpZXdIaXN0b3J5LmZvcndhcmRWaWV3PT09dGhpcz9pLmhpc3RvcnkuZ28oMSk6dm9pZCBuLnVybCh0aGlzLnVybCk6bnVsbH0sbC5wcm90b3R5cGUuZGVzdHJveT1mdW5jdGlvbigpe3RoaXMuc2NvcGUmJih0aGlzLnNjb3BlLiRkZXN0cm95JiZ0aGlzLnNjb3BlLiRkZXN0cm95KCksdGhpcy5zY29wZT1udWxsKX0se3JlZ2lzdGVyOmZ1bmN0aW9uKHQsaSl7dmFyIG89ZS4kdmlld0hpc3Rvcnkscj10aGlzLmdldEN1cnJlbnRTdGF0ZUlkKCksYT10aGlzLl9nZXRIaXN0b3J5KHQpLHM9by5jdXJyZW50VmlldyxsPW8uYmFja1ZpZXcsdT1vLmZvcndhcmRWaWV3LGQ9dGhpcy5uZXh0Vmlld09wdGlvbnMoKSxmPXt2aWV3SWQ6bnVsbCxuYXZBY3Rpb246bnVsbCxuYXZEaXJlY3Rpb246bnVsbCxoaXN0b3J5SWQ6YS5oaXN0b3J5SWR9O2lmKGkmJiF0aGlzLmlzVGFnTmFtZVJlZ2lzdHJhYmxlKGkpKXJldHVybiBmLm5hdkFjdGlvbj1cImRpc2FibGVkQnlUYWdOYW1lXCIsZjtpZihzJiZzLnN0YXRlSWQ9PT1yJiZzLmhpc3RvcnlJZD09PWEuaGlzdG9yeUlkKXJldHVybiBmLm5hdkFjdGlvbj1cIm5vQ2hhbmdlXCIsZjtpZihvLmZvcmNlZE5hdilpb25pYy5VdGlscy5leHRlbmQoZixvLmZvcmNlZE5hdiksZS4kdmlld0hpc3RvcnkuZm9yY2VkTmF2PW51bGw7ZWxzZSBpZihsJiZsLnN0YXRlSWQ9PT1yKWYudmlld0lkPWwudmlld0lkLGYubmF2QWN0aW9uPVwibW92ZUJhY2tcIixmLnZpZXdJZD1sLnZpZXdJZCxsLmhpc3RvcnlJZD09PXMuaGlzdG9yeUlkJiYoZi5uYXZEaXJlY3Rpb249XCJiYWNrXCIpO2Vsc2UgaWYodSYmdS5zdGF0ZUlkPT09cil7Zi52aWV3SWQ9dS52aWV3SWQsZi5uYXZBY3Rpb249XCJtb3ZlRm9yd2FyZFwiLHUuaGlzdG9yeUlkPT09cy5oaXN0b3J5SWQmJihmLm5hdkRpcmVjdGlvbj1cImZvcndhcmRcIik7dmFyIGg9dGhpcy5fZ2V0UGFyZW50SGlzdG9yeU9iaih0KTt1Lmhpc3RvcnlJZCYmaC5zY29wZSYmKGguc2NvcGUuJGhpc3RvcnlJZD11Lmhpc3RvcnlJZCxmLmhpc3RvcnlJZD11Lmhpc3RvcnlJZCl9ZWxzZSBpZihzJiZzLmhpc3RvcnlJZCE9PWEuaGlzdG9yeUlkJiZhLmN1cnNvcj4tMSYmYS5zdGFjay5sZW5ndGg+MCYmYS5jdXJzb3I8YS5zdGFjay5sZW5ndGgmJmEuc3RhY2tbYS5jdXJzb3JdLnN0YXRlSWQ9PT1yKXt2YXIgcD1hLnN0YWNrW2EuY3Vyc29yXTtmLnZpZXdJZD1wLnZpZXdJZCxmLm5hdkFjdGlvbj1cIm1vdmVCYWNrXCI7dmFyIHY9dGhpcy5fZ2V0Vmlld0J5SWQocC5iYWNrVmlld0lkKTtcbnYmJnAuaGlzdG9yeUlkIT09di5oaXN0b3J5SWQmJihhLnN0YWNrW2EuY3Vyc29yXS5iYWNrVmlld0lkPXMudmlld0lkKX1lbHNle2lmKGYudmlld0lkPWMocikscyl7aWYocy5mb3J3YXJkVmlld0lkPWYudmlld0lkLGEuaGlzdG9yeUlkPT09cy5oaXN0b3J5SWQmJihmLm5hdkRpcmVjdGlvbj1cImZvcndhcmRcIiksZi5uYXZBY3Rpb249XCJuZXdWaWV3XCIsdSYmcy5zdGF0ZUlkIT09dS5zdGF0ZUlkJiZzLmhpc3RvcnlJZD09PXUuaGlzdG9yeUlkKXt2YXIgZz10aGlzLl9nZXRIaXN0b3J5QnlJZCh1Lmhpc3RvcnlJZCk7aWYoZylmb3IodmFyIG09Zy5zdGFjay5sZW5ndGgtMTttPj11LmluZGV4O20tLSlnLnN0YWNrW21dLmRlc3Ryb3koKSxnLnN0YWNrLnNwbGljZShtKX19ZWxzZSBmLm5hdkFjdGlvbj1cImluaXRpYWxWaWV3XCI7by52aWV3c1tmLnZpZXdJZF09dGhpcy5jcmVhdGVWaWV3KHt2aWV3SWQ6Zi52aWV3SWQsaW5kZXg6YS5zdGFjay5sZW5ndGgsaGlzdG9yeUlkOmEuaGlzdG9yeUlkLGJhY2tWaWV3SWQ6cyYmcy52aWV3SWQ/cy52aWV3SWQ6bnVsbCxmb3J3YXJkVmlld0lkOm51bGwsc3RhdGVJZDpyLHN0YXRlTmFtZTp0aGlzLmdldEN1cnJlbnRTdGF0ZU5hbWUoKSxzdGF0ZVBhcmFtczp0aGlzLmdldEN1cnJlbnRTdGF0ZVBhcmFtcygpLHVybDpuLnVybCgpfSksXCJtb3ZlQmFja1wiPT1mLm5hdkFjdGlvbiYmZS4kZW1pdChcIiR2aWV3SGlzdG9yeS52aWV3QmFja1wiLHMudmlld0lkLGYudmlld0lkKSxhLnN0YWNrLnB1c2goby52aWV3c1tmLnZpZXdJZF0pfXJldHVybiBkJiYoZC5kaXNhYmxlQW5pbWF0ZSYmKGYubmF2RGlyZWN0aW9uPW51bGwpLGQuZGlzYWJsZUJhY2smJihvLnZpZXdzW2Yudmlld0lkXS5iYWNrVmlld0lkPW51bGwpLHRoaXMubmV4dFZpZXdPcHRpb25zKG51bGwpKSx0aGlzLnNldE5hdlZpZXdzKGYudmlld0lkKSxhLmN1cnNvcj1vLmN1cnJlbnRWaWV3LmluZGV4LGZ9LHNldE5hdlZpZXdzOmZ1bmN0aW9uKHQpe3ZhciBuPWUuJHZpZXdIaXN0b3J5O24uY3VycmVudFZpZXc9dGhpcy5fZ2V0Vmlld0J5SWQodCksbi5iYWNrVmlldz10aGlzLl9nZXRCYWNrVmlldyhuLmN1cnJlbnRWaWV3KSxuLmZvcndhcmRWaWV3PXRoaXMuX2dldEZvcndhcmRWaWV3KG4uY3VycmVudFZpZXcpLGUuJGJyb2FkY2FzdChcIiR2aWV3SGlzdG9yeS5oaXN0b3J5Q2hhbmdlXCIse3Nob3dCYWNrOm4uYmFja1ZpZXcmJm4uYmFja1ZpZXcuaGlzdG9yeUlkPT09bi5jdXJyZW50Vmlldy5oaXN0b3J5SWR9KX0scmVnaXN0ZXJIaXN0b3J5OmZ1bmN0aW9uKGUpe2UuJGhpc3RvcnlJZD1pb25pYy5VdGlscy5uZXh0VWlkKCl9LGNyZWF0ZVZpZXc6ZnVuY3Rpb24oZSl7dmFyIHQ9bmV3IGw7cmV0dXJuIHQuaW5pdGlhbGl6ZShlKX0sZ2V0Q3VycmVudFZpZXc6ZnVuY3Rpb24oKXtyZXR1cm4gZS4kdmlld0hpc3RvcnkuY3VycmVudFZpZXd9LGdldEJhY2tWaWV3OmZ1bmN0aW9uKCl7cmV0dXJuIGUuJHZpZXdIaXN0b3J5LmJhY2tWaWV3fSxnZXRGb3J3YXJkVmlldzpmdW5jdGlvbigpe3JldHVybiBlLiR2aWV3SGlzdG9yeS5mb3J3YXJkVmlld30sZ2V0TmF2RGlyZWN0aW9uOmZ1bmN0aW9uKCl7cmV0dXJuIGUuJHZpZXdIaXN0b3J5Lm5hdkRpcmVjdGlvbn0sZ2V0Q3VycmVudFN0YXRlTmFtZTpmdW5jdGlvbigpe3JldHVybiB0JiZ0LmN1cnJlbnQ/dC5jdXJyZW50Lm5hbWU6bnVsbH0saXNDdXJyZW50U3RhdGVOYXZWaWV3OmZ1bmN0aW9uKGUpe3JldHVybiB0JiZ0LmN1cnJlbnQmJnQuY3VycmVudC52aWV3cyYmdC5jdXJyZW50LnZpZXdzW2VdPyEwOiExfSxnZXRDdXJyZW50U3RhdGVQYXJhbXM6ZnVuY3Rpb24oKXt2YXIgZTtpZih0JiZ0LnBhcmFtcylmb3IodmFyIG4gaW4gdC5wYXJhbXMpdC5wYXJhbXMuaGFzT3duUHJvcGVydHkobikmJihlPWV8fHt9LGVbbl09dC5wYXJhbXNbbl0pO3JldHVybiBlfSxnZXRDdXJyZW50U3RhdGVJZDpmdW5jdGlvbigpe3ZhciBlO2lmKHQmJnQuY3VycmVudCYmdC5jdXJyZW50Lm5hbWUpe2lmKGU9dC5jdXJyZW50Lm5hbWUsdC5wYXJhbXMpZm9yKHZhciBuIGluIHQucGFyYW1zKXQucGFyYW1zLmhhc093blByb3BlcnR5KG4pJiZ0LnBhcmFtc1tuXSYmKGUrPVwiX1wiK24rXCI9XCIrdC5wYXJhbXNbbl0pO3JldHVybiBlfXJldHVybiBpb25pYy5VdGlscy5uZXh0VWlkKCl9LGdvVG9IaXN0b3J5Um9vdDpmdW5jdGlvbih0KXtpZih0KXt2YXIgbj1lLiR2aWV3SGlzdG9yeS5oaXN0b3JpZXNbdF07aWYobiYmbi5zdGFjay5sZW5ndGgpe2lmKGUuJHZpZXdIaXN0b3J5LmN1cnJlbnRWaWV3JiZlLiR2aWV3SGlzdG9yeS5jdXJyZW50Vmlldy52aWV3SWQ9PT1uLnN0YWNrWzBdLnZpZXdJZClyZXR1cm47ZS4kdmlld0hpc3RvcnkuZm9yY2VkTmF2PXt2aWV3SWQ6bi5zdGFja1swXS52aWV3SWQsbmF2QWN0aW9uOlwibW92ZUJhY2tcIixuYXZEaXJlY3Rpb246XCJiYWNrXCJ9LG4uc3RhY2tbMF0uZ28oKX19fSxfZ2V0Vmlld0J5SWQ6ZnVuY3Rpb24odCl7cmV0dXJuIHQ/ZS4kdmlld0hpc3Rvcnkudmlld3NbdF06bnVsbH0sX2dldEJhY2tWaWV3OmZ1bmN0aW9uKGUpe3JldHVybiBlP3RoaXMuX2dldFZpZXdCeUlkKGUuYmFja1ZpZXdJZCk6bnVsbH0sX2dldEZvcndhcmRWaWV3OmZ1bmN0aW9uKGUpe3JldHVybiBlP3RoaXMuX2dldFZpZXdCeUlkKGUuZm9yd2FyZFZpZXdJZCk6bnVsbH0sX2dldEhpc3RvcnlCeUlkOmZ1bmN0aW9uKHQpe3JldHVybiB0P2UuJHZpZXdIaXN0b3J5Lmhpc3Rvcmllc1t0XTpudWxsfSxfZ2V0SGlzdG9yeTpmdW5jdGlvbih0KXt2YXIgbj10aGlzLl9nZXRQYXJlbnRIaXN0b3J5T2JqKHQpO3JldHVybiBlLiR2aWV3SGlzdG9yeS5oaXN0b3JpZXNbbi5oaXN0b3J5SWRdfHwoZS4kdmlld0hpc3RvcnkuaGlzdG9yaWVzW24uaGlzdG9yeUlkXT17aGlzdG9yeUlkOm4uaGlzdG9yeUlkLHBhcmVudEhpc3RvcnlJZDp0aGlzLl9nZXRQYXJlbnRIaXN0b3J5T2JqKG4uc2NvcGUuJHBhcmVudCkuaGlzdG9yeUlkLHN0YWNrOltdLGN1cnNvcjotMX0pLGUuJHZpZXdIaXN0b3J5Lmhpc3Rvcmllc1tuLmhpc3RvcnlJZF19LF9nZXRQYXJlbnRIaXN0b3J5T2JqOmZ1bmN0aW9uKHQpe2Zvcih2YXIgbj10O247KXtpZihuLmhhc093blByb3BlcnR5KFwiJGhpc3RvcnlJZFwiKSlyZXR1cm57aGlzdG9yeUlkOm4uJGhpc3RvcnlJZCxzY29wZTpufTtuPW4uJHBhcmVudH1yZXR1cm57aGlzdG9yeUlkOlwicm9vdFwiLHNjb3BlOmV9fSxuZXh0Vmlld09wdGlvbnM6ZnVuY3Rpb24oZSl7cmV0dXJuIGFyZ3VtZW50cy5sZW5ndGg/dm9pZCh0aGlzLl9uZXh0T3B0cz1lKTp0aGlzLl9uZXh0T3B0c30sZ2V0UmVuZGVyZXI6ZnVuY3Rpb24oZSx0LG4pe2Z1bmN0aW9uIGkoZSl7Zm9yKHZhciB0PVwiXCI7IXQmJmU7KXQ9ZS5nZXRBdHRyaWJ1dGUoXCJhbmltYXRpb25cIiksZT1lLnBhcmVudEVsZW1lbnQ7cmV0dXJuIHQ/dDphLnRyYW5zaXRpb259ZnVuY3Rpb24gbygpe2QmJmVbMF0uY2xhc3NMaXN0LmFkZChkKSxcImJhY2tcIj09PWMubmF2RGlyZWN0aW9uP2VbMF0uY2xhc3NMaXN0LmFkZChcInJldmVyc2VcIik6ZVswXS5jbGFzc0xpc3QucmVtb3ZlKFwicmV2ZXJzZVwiKX12YXIgYyxsLHU9dGhpcyxkPWkoZVswXSk7cmV0dXJuIGZ1bmN0aW9uKHQpe3JldHVybntlbnRlcjpmdW5jdGlvbihuKXtyZXR1cm4gbCYmdD8obygpLG4uYWRkQ2xhc3MoXCJuZy1lbnRlclwiKSxzLnNob3coKSx2b2lkIHIuZW50ZXIobixlLG51bGwsZnVuY3Rpb24oKXtzLmhpZGUoKSxkJiZlWzBdLmNsYXNzTGlzdC5yZW1vdmUoZCl9KSk6KGx8fHMuaGlkZSgpLHZvaWQgZS5hcHBlbmQobikpfSxsZWF2ZTpmdW5jdGlvbigpe3ZhciBuPWUuY29udGVudHMoKTtyZXR1cm4gbCYmdD8obygpLHZvaWQgci5sZWF2ZShuLGZ1bmN0aW9uKCl7bi5yZW1vdmUoKX0pKTp2b2lkIG4ucmVtb3ZlKCl9LHJlZ2lzdGVyOmZ1bmN0aW9uKGUpe3JldHVybiBjPXUucmVnaXN0ZXIobixlKSxsPW51bGwhPT1kJiZudWxsIT09Yy5uYXZEaXJlY3Rpb24sY319fX0sZGlzYWJsZVJlZ2lzdGVyQnlUYWdOYW1lOmZ1bmN0aW9uKHQpe2UuJHZpZXdIaXN0b3J5LmRpc2FibGVkUmVnaXN0cmFibGVUYWdOYW1lcy5wdXNoKHQudG9VcHBlckNhc2UoKSl9LGlzVGFnTmFtZVJlZ2lzdHJhYmxlOmZ1bmN0aW9uKHQpe3ZhciBuLGksbz1lLiR2aWV3SGlzdG9yeS5kaXNhYmxlZFJlZ2lzdHJhYmxlVGFnTmFtZXM7Zm9yKG49MDtuPHQubGVuZ3RoO24rKylpZigxPT09dFtuXS5ub2RlVHlwZSlmb3IoaT0wO2k8by5sZW5ndGg7aSsrKWlmKHRbbl0udGFnTmFtZT09PW9baV0pcmV0dXJuITE7cmV0dXJuITB9LGNsZWFySGlzdG9yeTpmdW5jdGlvbigpe3ZhciB0PWUuJHZpZXdIaXN0b3J5Lmhpc3RvcmllcyxuPWUuJHZpZXdIaXN0b3J5LmN1cnJlbnRWaWV3O2lmKHQpZm9yKHZhciBpIGluIHQpdFtpXS5zdGFjayYmKHRbaV0uc3RhY2s9W10sdFtpXS5jdXJzb3I9LTEpLG4mJm4uaGlzdG9yeUlkPT09aT8obi5iYWNrVmlld0lkPW51bGwsbi5mb3J3YXJkVmlld0lkPW51bGwsdFtpXS5zdGFjay5wdXNoKG4pKTp0W2ldLmRlc3Ryb3kmJnRbaV0uZGVzdHJveSgpO2Zvcih2YXIgbyBpbiBlLiR2aWV3SGlzdG9yeS52aWV3cylvIT09bi52aWV3SWQmJmRlbGV0ZSBlLiR2aWV3SGlzdG9yeS52aWV3c1tvXTtuJiZ0aGlzLnNldE5hdlZpZXdzKG4udmlld0lkKX19fV0pLHUuY29uZmlnKFtcIiRwcm92aWRlXCIsZnVuY3Rpb24oZSl7ZnVuY3Rpb24gdChlLHQpe3JldHVybiBlLl9faGFzaD1lLmhhc2gsZS5oYXNoPWZ1bmN0aW9uKG4pe3JldHVybiBhbmd1bGFyLmlzRGVmaW5lZChuKSYmdChmdW5jdGlvbigpe3ZhciBlPWRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIuc2Nyb2xsLWNvbnRlbnRcIik7ZSYmKGUuc2Nyb2xsVG9wPTApfSwwLCExKSxlLl9faGFzaChuKX0sZX1lLmRlY29yYXRvcihcIiRsb2NhdGlvblwiLFtcIiRkZWxlZ2F0ZVwiLFwiJHRpbWVvdXRcIix0XSl9XSksdS5zZXJ2aWNlKFwiJGlvbmljTGlzdERlbGVnYXRlXCIsbihbXCJzaG93UmVvcmRlclwiLFwic2hvd0RlbGV0ZVwiLFwiY2FuU3dpcGVJdGVtc1wiLFwiY2xvc2VPcHRpb25CdXR0b25zXCJdKSkuY29udHJvbGxlcihcIiRpb25pY0xpc3RcIixbXCIkc2NvcGVcIixcIiRhdHRyc1wiLFwiJHBhcnNlXCIsXCIkaW9uaWNMaXN0RGVsZWdhdGVcIixmdW5jdGlvbihlLHQsbixpKXt2YXIgbz0hMCxyPSExLGE9ITEscz1pLl9yZWdpc3Rlckluc3RhbmNlKHRoaXMsdC5kZWxlZ2F0ZUhhbmRsZSk7ZS4kb24oXCIkZGVzdHJveVwiLHMpLHRoaXMuc2hvd1Jlb3JkZXI9ZnVuY3Rpb24oZSl7cmV0dXJuIGFyZ3VtZW50cy5sZW5ndGgmJihyPSEhZSkscn0sdGhpcy5zaG93RGVsZXRlPWZ1bmN0aW9uKGUpe3JldHVybiBhcmd1bWVudHMubGVuZ3RoJiYoYT0hIWUpLGF9LHRoaXMuY2FuU3dpcGVJdGVtcz1mdW5jdGlvbihlKXtyZXR1cm4gYXJndW1lbnRzLmxlbmd0aCYmKG89ISFlKSxvfSx0aGlzLmNsb3NlT3B0aW9uQnV0dG9ucz1mdW5jdGlvbigpe3RoaXMubGlzdFZpZXcmJnRoaXMubGlzdFZpZXcuY2xlYXJEcmFnRWZmZWN0cygpfX1dKSx1LmNvbnRyb2xsZXIoXCIkaW9uaWNOYXZCYXJcIixbXCIkc2NvcGVcIixcIiRlbGVtZW50XCIsXCIkYXR0cnNcIixcIiRpb25pY1ZpZXdTZXJ2aWNlXCIsXCIkYW5pbWF0ZVwiLFwiJGNvbXBpbGVcIixcIiRpb25pY05hdkJhckRlbGVnYXRlXCIsZnVuY3Rpb24oZSx0LG4saSxvLHIsYSl7dC5wYXJlbnQoKS5kYXRhKFwiJGlvbk5hdkJhckNvbnRyb2xsZXJcIix0aGlzKTt2YXIgcz1hLl9yZWdpc3Rlckluc3RhbmNlKHRoaXMsbi5kZWxlZ2F0ZUhhbmRsZSk7ZS4kb24oXCIkZGVzdHJveVwiLHMpLGUuJG9uKFwiJHZpZXdIaXN0b3J5Lmhpc3RvcnlDaGFuZ2VcIixmdW5jdGlvbihlLHQpe2JhY2tJc1Nob3duPSEhdC5zaG93QmFja30pO3ZhciBjPXRoaXM7dGhpcy5sZWZ0QnV0dG9uc0VsZW1lbnQ9dih0WzBdLnF1ZXJ5U2VsZWN0b3IoXCIuYnV0dG9ucy5sZWZ0LWJ1dHRvbnNcIikpLHRoaXMucmlnaHRCdXR0b25zRWxlbWVudD12KHRbMF0ucXVlcnlTZWxlY3RvcihcIi5idXR0b25zLnJpZ2h0LWJ1dHRvbnNcIikpLHRoaXMuYmFjaz1mdW5jdGlvbigpe3ZhciBlPWkuZ2V0QmFja1ZpZXcoKTtyZXR1cm4gZSYmZS5nbygpLCExfSx0aGlzLmFsaWduPWZ1bmN0aW9uKGUpe3RoaXMuX2hlYWRlckJhclZpZXcuYWxpZ24oZSl9LHRoaXMuc2hvd0JhY2tCdXR0b249ZnVuY3Rpb24odCl7cmV0dXJuIGFyZ3VtZW50cy5sZW5ndGgmJihlLmJhY2tCdXR0b25TaG93bj0hIXQpLCEoIWUuaGFzQmFja0J1dHRvbnx8IWUuYmFja0J1dHRvblNob3duKX0sdGhpcy5zaG93QmFyPWZ1bmN0aW9uKHQpe3JldHVybiBhcmd1bWVudHMubGVuZ3RoJiYoZS5pc0ludmlzaWJsZT0hdCxlLiRwYXJlbnQuJGhhc0hlYWRlcj0hIXQpLCFlLmlzSW52aXNpYmxlfSx0aGlzLnNldFRpdGxlPWZ1bmN0aW9uKHQpe2UudGl0bGUhPT10JiYoZS5vbGRUaXRsZT1lLnRpdGxlLGUudGl0bGU9dHx8XCJcIil9LHRoaXMuY2hhbmdlVGl0bGU9ZnVuY3Rpb24obixpKXtyZXR1cm4gZS50aXRsZT09PW4/KFwidW5kZWZpbmVkXCIhPXR5cGVvZiBiYWNrSXNTaG93biYmIWJhY2tJc1Nob3duJiZlLmJhY2tCdXR0b25TaG93biYmdih0WzBdLnF1ZXJ5U2VsZWN0b3IoXCIuYmFjay1idXR0b25cIikpLmFkZENsYXNzKFwibmctaGlkZVwiKSwhMSk6KHRoaXMuc2V0VGl0bGUobiksZS5pc1JldmVyc2U9XCJiYWNrXCI9PWksZS5zaG91bGRBbmltYXRlPSEhaSxlLnNob3VsZEFuaW1hdGU/dGhpcy5fYW5pbWF0ZVRpdGxlcygpOnRoaXMuX2hlYWRlckJhclZpZXcuYWxpZ24oKSwhMCl9LHRoaXMuZ2V0VGl0bGU9ZnVuY3Rpb24oKXtyZXR1cm4gZS50aXRsZXx8XCJcIn0sdGhpcy5nZXRQcmV2aW91c1RpdGxlPWZ1bmN0aW9uKCl7cmV0dXJuIGUub2xkVGl0bGV8fFwiXCJ9LHRoaXMuX2FuaW1hdGVUaXRsZXM9ZnVuY3Rpb24oKXt2YXIgbixpLGE7YT10WzBdLnF1ZXJ5U2VsZWN0b3JBbGwoXCIudGl0bGVcIiksYS5sZW5ndGgmJihuPXIoJzxoMSBjbGFzcz1cInRpdGxlXCIgbmctYmluZC1odG1sPVwib2xkVGl0bGVcIj48L2gxPicpKGUpLHYoYVthLmxlbmd0aC0xXSkucmVwbGFjZVdpdGgobikpLGk9cignPGgxIGNsYXNzPVwidGl0bGUgaW52aXNpYmxlXCIgbmctYmluZC1odG1sPVwidGl0bGVcIj48L2gxPicpKGUpLGlvbmljLnJlcXVlc3RBbmltYXRpb25GcmFtZShmdW5jdGlvbigpe24mJm8ubGVhdmUodihuKSk7dmFyIHI9biYmdihuKXx8bnVsbDtvLmVudGVyKGksdCxyLGZ1bmN0aW9uKCl7Yy5faGVhZGVyQmFyVmlldy5hbGlnbigpfSksZihhLGZ1bmN0aW9uKGUpe2UmJmUucGFyZW50Tm9kZSYmdihlKS5yZW1vdmUoKX0pLGUuJGRpZ2VzdCgpLGlvbmljLnJlcXVlc3RBbmltYXRpb25GcmFtZShmdW5jdGlvbigpe2lbMF0uY2xhc3NMaXN0LnJlbW92ZShcImludmlzaWJsZVwiKX0pfSl9fV0pLHUuZmFjdG9yeShcIiQkc2Nyb2xsVmFsdWVDYWNoZVwiLGZ1bmN0aW9uKCl7cmV0dXJue319KS5jb250cm9sbGVyKFwiJGlvbmljU2Nyb2xsXCIsW1wiJHNjb3BlXCIsXCJzY3JvbGxWaWV3T3B0aW9uc1wiLFwiJHRpbWVvdXRcIixcIiR3aW5kb3dcIixcIiQkc2Nyb2xsVmFsdWVDYWNoZVwiLFwiJGxvY2F0aW9uXCIsXCIkcm9vdFNjb3BlXCIsXCIkZG9jdW1lbnRcIixcIiRpb25pY1Njcm9sbERlbGVnYXRlXCIsZnVuY3Rpb24oZSx0LG4saSxvLHIsYSxzLGMpe3ZhciBsPXRoaXM7dGhpcy5fX3RpbWVvdXQ9bix0aGlzLl9zY3JvbGxWaWV3T3B0aW9ucz10O3ZhciB1PXRoaXMuZWxlbWVudD10LmVsLGQ9dGhpcy4kZWxlbWVudD12KHUpLGY9dGhpcy5zY3JvbGxWaWV3PW5ldyBpb25pYy52aWV3cy5TY3JvbGwodCk7KGQucGFyZW50KCkubGVuZ3RoP2QucGFyZW50KCk6ZCkuZGF0YShcIiQkaW9uaWNTY3JvbGxDb250cm9sbGVyXCIsdGhpcyk7dmFyIGg9Yy5fcmVnaXN0ZXJJbnN0YW5jZSh0aGlzLHQuZGVsZWdhdGVIYW5kbGUpO2FuZ3VsYXIuaXNEZWZpbmVkKHQuYm91bmNpbmcpfHxpb25pYy5QbGF0Zm9ybS5yZWFkeShmdW5jdGlvbigpe2Yub3B0aW9ucy5ib3VuY2luZz0hMCxpb25pYy5QbGF0Zm9ybS5pc0FuZHJvaWQoKSYmKGYub3B0aW9ucy5ib3VuY2luZz0hMSxmLm9wdGlvbnMuZGVjZWxlcmF0aW9uPS45NSl9KTt2YXIgcD1hbmd1bGFyLmJpbmQoZixmLnJlc2l6ZSk7aW9uaWMub24oXCJyZXNpemVcIixwLGkpO3ZhciBnPWFuZ3VsYXIubm9vcCxtPWFuZ3VsYXIubm9vcCwkPWZ1bmN0aW9uKHQpe3ZhciBuPSh0Lm9yaWdpbmFsRXZlbnR8fHQpLmRldGFpbHx8e307ZS4kb25TY3JvbGwmJmUuJG9uU2Nyb2xsKHtldmVudDp0LHNjcm9sbFRvcDpuLnNjcm9sbFRvcHx8MCxzY3JvbGxMZWZ0Om4uc2Nyb2xsTGVmdHx8MH0pfTtkLm9uKFwic2Nyb2xsXCIsJCksZS4kb24oXCIkZGVzdHJveVwiLGZ1bmN0aW9uKCl7aCgpLGYuX19jbGVhbnVwKCksaW9uaWMub2ZmKFwicmVzaXplXCIscCxpKSxpLnJlbW92ZUV2ZW50TGlzdGVuZXIoXCJyZXNpemVcIixwKSxtKCksZygpLGwuX3JlbWVtYmVyU2Nyb2xsSWQmJihvW2wuX3JlbWVtYmVyU2Nyb2xsSWRdPWYuZ2V0VmFsdWVzKCkpLHQ9bnVsbCxsLl9zY3JvbGxWaWV3T3B0aW9ucz1udWxsLGwuZWxlbWVudD1udWxsLGQub2ZmKFwic2Nyb2xsXCIsJCksZD1udWxsLGwuJGVsZW1lbnQ9bnVsbCxsLnNjcm9sbFZpZXc9bnVsbCxmPW51bGx9KSxtPWUuJG9uKFwiJHZpZXdDb250ZW50TG9hZGVkXCIsZnVuY3Rpb24odCxpKXtpZighdC5kZWZhdWx0UHJldmVudGVkKXt0LnByZXZlbnREZWZhdWx0KCk7dmFyIG89aSYmaS52aWV3SWR8fGUuJGhpc3RvcnlJZDtvJiZuKGZ1bmN0aW9uKCl7bC5yZW1lbWJlclNjcm9sbFBvc2l0aW9uKG8pLGwuc2Nyb2xsVG9SZW1lbWJlcmVkUG9zaXRpb24oKSxnPWEuJG9uKFwiJHZpZXdIaXN0b3J5LnZpZXdCYWNrXCIsZnVuY3Rpb24oZSx0KXtvPT09dCYmbC5mb3JnZXRTY3JvbGxQb3NpdGlvbigpfSl9LDAsITEpfX0pLG4oZnVuY3Rpb24oKXtmJiZmLnJ1biYmZi5ydW4oKX0pLHRoaXMuX3JlbWVtYmVyU2Nyb2xsSWQ9bnVsbCx0aGlzLmdldFNjcm9sbFZpZXc9ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5zY3JvbGxWaWV3fSx0aGlzLmdldFNjcm9sbFBvc2l0aW9uPWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuc2Nyb2xsVmlldy5nZXRWYWx1ZXMoKX0sdGhpcy5yZXNpemU9ZnVuY3Rpb24oKXtyZXR1cm4gbihwKS50aGVuKGZ1bmN0aW9uKCl7ZCYmZC50cmlnZ2VySGFuZGxlcihcInNjcm9sbC5yZXNpemVcIil9KX0sdGhpcy5zY3JvbGxUb3A9ZnVuY3Rpb24oZSl7dGhpcy5yZXNpemUoKS50aGVuKGZ1bmN0aW9uKCl7Zi5zY3JvbGxUbygwLDAsISFlKX0pfSx0aGlzLnNjcm9sbEJvdHRvbT1mdW5jdGlvbihlKXt0aGlzLnJlc2l6ZSgpLnRoZW4oZnVuY3Rpb24oKXt2YXIgdD1mLmdldFNjcm9sbE1heCgpO2Yuc2Nyb2xsVG8odC5sZWZ0LHQudG9wLCEhZSl9KX0sdGhpcy5zY3JvbGxUbz1mdW5jdGlvbihlLHQsbil7dGhpcy5yZXNpemUoKS50aGVuKGZ1bmN0aW9uKCl7Zi5zY3JvbGxUbyhlLHQsISFuKX0pfSx0aGlzLnpvb21Ubz1mdW5jdGlvbihlLHQsbixpKXt0aGlzLnJlc2l6ZSgpLnRoZW4oZnVuY3Rpb24oKXtmLnpvb21UbyhlLCEhdCxuLGkpfSl9LHRoaXMuem9vbUJ5PWZ1bmN0aW9uKGUsdCxuLGkpe3RoaXMucmVzaXplKCkudGhlbihmdW5jdGlvbigpe2Yuem9vbUJ5KGUsISF0LG4saSl9KX0sdGhpcy5zY3JvbGxCeT1mdW5jdGlvbihlLHQsbil7dGhpcy5yZXNpemUoKS50aGVuKGZ1bmN0aW9uKCl7Zi5zY3JvbGxCeShlLHQsISFuKX0pfSx0aGlzLmFuY2hvclNjcm9sbD1mdW5jdGlvbihlKXt0aGlzLnJlc2l6ZSgpLnRoZW4oZnVuY3Rpb24oKXt2YXIgdD1yLmhhc2goKSxuPXQmJnNbMF0uZ2V0RWxlbWVudEJ5SWQodCk7aWYoIXR8fCFuKXJldHVybiB2b2lkIGYuc2Nyb2xsVG8oMCwwLCEhZSk7dmFyIGk9bixvPTAsYT0wLGM9MDtkbyBudWxsIT09aSYmKG8rPWkub2Zmc2V0TGVmdCksbnVsbCE9PWkmJihhKz1pLm9mZnNldFRvcCksaT1pLm9mZnNldFBhcmVudCxjKys7d2hpbGUoaS5hdHRyaWJ1dGVzIT1sLmVsZW1lbnQuYXR0cmlidXRlcyYmaS5vZmZzZXRQYXJlbnQpO2Yuc2Nyb2xsVG8obyxhLCEhZSl9KX0sdGhpcy5yZW1lbWJlclNjcm9sbFBvc2l0aW9uPWZ1bmN0aW9uKGUpe2lmKCFlKXRocm93IG5ldyBFcnJvcihcIk11c3Qgc3VwcGx5IGFuIGlkIHRvIHJlbWVtYmVyIHRoZSBzY3JvbGwgYnkhXCIpO3RoaXMuX3JlbWVtYmVyU2Nyb2xsSWQ9ZX0sdGhpcy5mb3JnZXRTY3JvbGxQb3NpdGlvbj1mdW5jdGlvbigpe2RlbGV0ZSBvW3RoaXMuX3JlbWVtYmVyU2Nyb2xsSWRdLHRoaXMuX3JlbWVtYmVyU2Nyb2xsSWQ9bnVsbH0sdGhpcy5zY3JvbGxUb1JlbWVtYmVyZWRQb3NpdGlvbj1mdW5jdGlvbihlKXt2YXIgdD1vW3RoaXMuX3JlbWVtYmVyU2Nyb2xsSWRdO3QmJnRoaXMucmVzaXplKCkudGhlbihmdW5jdGlvbigpe2YmJmYuc2Nyb2xsVG8mJmYuc2Nyb2xsVG8oK3QubGVmdCwrdC50b3AsZSl9KX0sdGhpcy5fc2V0UmVmcmVzaGVyPWZ1bmN0aW9uKGUsdCl7dmFyIGk9dGhpcy5yZWZyZXNoZXI9dCxvPWwucmVmcmVzaGVyLmNsaWVudEhlaWdodHx8NjA7Zi5hY3RpdmF0ZVB1bGxUb1JlZnJlc2gobyxmdW5jdGlvbigpe2kuY2xhc3NMaXN0LmFkZChcImFjdGl2ZVwiKSxlLiRvblB1bGxpbmcoKX0sZnVuY3Rpb24oKXtuKGZ1bmN0aW9uKCl7aS5jbGFzc0xpc3QucmVtb3ZlKFwiYWN0aXZlXCIpLGkuY2xhc3NMaXN0LnJlbW92ZShcInJlZnJlc2hpbmdcIiksaS5jbGFzc0xpc3QucmVtb3ZlKFwicmVmcmVzaGluZy10YWlsXCIpLGkuY2xhc3NMaXN0LmFkZChcImludmlzaWJsZVwiKX0sMzAwKX0sZnVuY3Rpb24oKXtpLmNsYXNzTGlzdC5hZGQoXCJyZWZyZXNoaW5nXCIpLGUuJG9uUmVmcmVzaCgpfSxmdW5jdGlvbigpe2kuY2xhc3NMaXN0LnJlbW92ZShcImludmlzaWJsZVwiKX0sZnVuY3Rpb24oKXtpLmNsYXNzTGlzdC5hZGQoXCJpbnZpc2libGVcIil9LGZ1bmN0aW9uKCl7aS5jbGFzc0xpc3QuYWRkKFwicmVmcmVzaGluZy10YWlsXCIpfSl9fV0pLHUuY29udHJvbGxlcihcIiRpb25pY1NpZGVNZW51c1wiLFtcIiRzY29wZVwiLFwiJGF0dHJzXCIsXCIkaW9uaWNTaWRlTWVudURlbGVnYXRlXCIsXCIkaW9uaWNQbGF0Zm9ybVwiLFwiJGlvbmljQm9keVwiLGZ1bmN0aW9uKGUsdCxuLGksbyl7dmFyIHIsYSxzLGMsbCx1LGQsZj10aGlzO2YuJHNjb3BlPWUsZi5pbml0aWFsaXplPWZ1bmN0aW9uKGUpe2YubGVmdD1lLmxlZnQsZi5yaWdodD1lLnJpZ2h0LGYuc2V0Q29udGVudChlLmNvbnRlbnQpLGYuZHJhZ1RocmVzaG9sZFg9ZS5kcmFnVGhyZXNob2xkWHx8MTB9LGYuc2V0Q29udGVudD1mdW5jdGlvbihlKXtlJiYoZi5jb250ZW50PWUsZi5jb250ZW50Lm9uRHJhZz1mdW5jdGlvbihlKXtmLl9oYW5kbGVEcmFnKGUpfSxmLmNvbnRlbnQuZW5kRHJhZz1mdW5jdGlvbihlKXtmLl9lbmREcmFnKGUpfSl9LGYuaXNPcGVuTGVmdD1mdW5jdGlvbigpe3JldHVybiBmLmdldE9wZW5BbW91bnQoKT4wfSxmLmlzT3BlblJpZ2h0PWZ1bmN0aW9uKCl7cmV0dXJuIGYuZ2V0T3BlbkFtb3VudCgpPDB9LGYudG9nZ2xlTGVmdD1mdW5jdGlvbihlKXtpZighZCYmZi5sZWZ0LmlzRW5hYmxlZCl7dmFyIHQ9Zi5nZXRPcGVuQW1vdW50KCk7MD09PWFyZ3VtZW50cy5sZW5ndGgmJihlPTA+PXQpLGYuY29udGVudC5lbmFibGVBbmltYXRpb24oKSxmLm9wZW5QZXJjZW50YWdlKGU/MTAwOjApfX0sZi50b2dnbGVSaWdodD1mdW5jdGlvbihlKXtpZighZCYmZi5yaWdodC5pc0VuYWJsZWQpe3ZhciB0PWYuZ2V0T3BlbkFtb3VudCgpOzA9PT1hcmd1bWVudHMubGVuZ3RoJiYoZT10Pj0wKSxmLmNvbnRlbnQuZW5hYmxlQW5pbWF0aW9uKCksZi5vcGVuUGVyY2VudGFnZShlPy0xMDA6MCl9fSxmLmNsb3NlPWZ1bmN0aW9uKCl7Zi5vcGVuUGVyY2VudGFnZSgwKX0sZi5nZXRPcGVuQW1vdW50PWZ1bmN0aW9uKCl7cmV0dXJuIGYuY29udGVudCYmZi5jb250ZW50LmdldFRyYW5zbGF0ZVgoKXx8MH0sZi5nZXRPcGVuUmF0aW89ZnVuY3Rpb24oKXt2YXIgZT1mLmdldE9wZW5BbW91bnQoKTtyZXR1cm4gZT49MD9lL2YubGVmdC53aWR0aDplL2YucmlnaHQud2lkdGh9LGYuaXNPcGVuPWZ1bmN0aW9uKCl7cmV0dXJuIDAhPT1mLmdldE9wZW5BbW91bnQoKX0sZi5nZXRPcGVuUGVyY2VudGFnZT1mdW5jdGlvbigpe3JldHVybiAxMDAqZi5nZXRPcGVuUmF0aW8oKX0sZi5vcGVuUGVyY2VudGFnZT1mdW5jdGlvbihlKXt2YXIgdD1lLzEwMDtpZihmLmxlZnQmJmU+PTApZi5vcGVuQW1vdW50KGYubGVmdC53aWR0aCp0KTtlbHNlIGlmKGYucmlnaHQmJjA+ZSl7e2YucmlnaHQud2lkdGh9Zi5vcGVuQW1vdW50KGYucmlnaHQud2lkdGgqdCl9by5lbmFibGVDbGFzcygwIT09ZSxcIm1lbnUtb3BlblwiKX0sZi5vcGVuQW1vdW50PWZ1bmN0aW9uKGUpe3ZhciB0PWYubGVmdCYmZi5sZWZ0LndpZHRofHwwLG49Zi5yaWdodCYmZi5yaWdodC53aWR0aHx8MDtyZXR1cm4oZi5sZWZ0JiZmLmxlZnQuaXNFbmFibGVkfHwhKGU+MCkpJiYoZi5yaWdodCYmZi5yaWdodC5pc0VuYWJsZWR8fCEoMD5lKSk/YSYmZT50P3ZvaWQgZi5jb250ZW50LnNldFRyYW5zbGF0ZVgodCk6ciYmLW4+ZT92b2lkIGYuY29udGVudC5zZXRUcmFuc2xhdGVYKC1uKTooZi5jb250ZW50LnNldFRyYW5zbGF0ZVgoZSksdm9pZChlPj0wPyhhPSEwLHI9ITEsZT4wJiYoZi5yaWdodCYmZi5yaWdodC5wdXNoRG93biYmZi5yaWdodC5wdXNoRG93bigpLGYubGVmdCYmZi5sZWZ0LmJyaW5nVXAmJmYubGVmdC5icmluZ1VwKCkpKToocj0hMCxhPSExLGYucmlnaHQmJmYucmlnaHQuYnJpbmdVcCYmZi5yaWdodC5icmluZ1VwKCksZi5sZWZ0JiZmLmxlZnQucHVzaERvd24mJmYubGVmdC5wdXNoRG93bigpKSkpOnZvaWQgZi5jb250ZW50LnNldFRyYW5zbGF0ZVgoMCl9LGYuc25hcFRvUmVzdD1mdW5jdGlvbihlKXtmLmNvbnRlbnQuZW5hYmxlQW5pbWF0aW9uKCkscz0hMTt2YXIgdD1mLmdldE9wZW5SYXRpbygpO2lmKDA9PT10KXJldHVybiB2b2lkIGYub3BlblBlcmNlbnRhZ2UoMCk7dmFyIG49LjMsaT1lLmdlc3R1cmUudmVsb2NpdHlYLG89ZS5nZXN0dXJlLmRpcmVjdGlvbjtmLm9wZW5QZXJjZW50YWdlKHQ+MCYmLjU+dCYmXCJyaWdodFwiPT1vJiZuPmk/MDp0Pi41JiZcImxlZnRcIj09byYmbj5pPzEwMDowPnQmJnQ+LS41JiZcImxlZnRcIj09byYmbj5pPzA6LjU+dCYmXCJyaWdodFwiPT1vJiZuPmk/LTEwMDpcInJpZ2h0XCI9PW8mJnQ+PTAmJih0Pj0uNXx8aT5uKT8xMDA6XCJsZWZ0XCI9PW8mJjA+PXQmJigtLjU+PXR8fGk+bik/LTEwMDowKX0sZi5pc0FzaWRlRXhwb3NlZD1mdW5jdGlvbigpe3JldHVybiEhZH0sZi5leHBvc2VBc2lkZT1mdW5jdGlvbihlKXtmLmxlZnQmJmYubGVmdC5pc0VuYWJsZWQmJihmLmNsb3NlKCksZD1lLGYuY29udGVudC5zZXRNYXJnaW5MZWZ0KGQ/Zi5sZWZ0LndpZHRoOjApLGYuJHNjb3BlLiRlbWl0KFwiJGlvbmljRXhwb3NlQXNpZGVcIixkKSl9LGYuYWN0aXZlQXNpZGVSZXNpemluZz1mdW5jdGlvbihlKXtvLmVuYWJsZUNsYXNzKGUsXCJhc2lkZS1yZXNpemluZ1wiKX0sZi5fZW5kRHJhZz1mdW5jdGlvbihlKXtkfHwocyYmZi5zbmFwVG9SZXN0KGUpLGM9bnVsbCxsPW51bGwsdT1udWxsKX0sZi5faGFuZGxlRHJhZz1mdW5jdGlvbihlKXtkfHwoYz9sPWUuZ2VzdHVyZS50b3VjaGVzWzBdLnBhZ2VYOihjPWUuZ2VzdHVyZS50b3VjaGVzWzBdLnBhZ2VYLGw9YyksIXMmJk1hdGguYWJzKGwtYyk+Zi5kcmFnVGhyZXNob2xkWCYmKGM9bCxzPSEwLGYuY29udGVudC5kaXNhYmxlQW5pbWF0aW9uKCksdT1mLmdldE9wZW5BbW91bnQoKSkscyYmZi5vcGVuQW1vdW50KHUrKGwtYykpKX0sZi5jYW5EcmFnQ29udGVudD1mdW5jdGlvbih0KXtyZXR1cm4gYXJndW1lbnRzLmxlbmd0aCYmKGUuZHJhZ0NvbnRlbnQ9ISF0KSxlLmRyYWdDb250ZW50fSxmLmVkZ2VUaHJlc2hvbGQ9MjUsZi5lZGdlVGhyZXNob2xkRW5hYmxlZD0hMSxmLmVkZ2VEcmFnVGhyZXNob2xkPWZ1bmN0aW9uKGUpe3JldHVybiBhcmd1bWVudHMubGVuZ3RoJiYoYW5ndWxhci5pc051bWJlcihlKSYmZT4wPyhmLmVkZ2VUaHJlc2hvbGQ9ZSxmLmVkZ2VUaHJlc2hvbGRFbmFibGVkPSEwKTpmLmVkZ2VUaHJlc2hvbGRFbmFibGVkPSEhZSksZi5lZGdlVGhyZXNob2xkRW5hYmxlZH0sZi5pc0RyYWdnYWJsZVRhcmdldD1mdW5jdGlvbih0KXt2YXIgbj1mLmVkZ2VUaHJlc2hvbGRFbmFibGVkJiYhZi5pc09wZW4oKSxpPXQuZ2VzdHVyZS5zdGFydEV2ZW50JiZ0Lmdlc3R1cmUuc3RhcnRFdmVudC5jZW50ZXImJnQuZ2VzdHVyZS5zdGFydEV2ZW50LmNlbnRlci5wYWdlWCxvPSFufHxpPD1mLmVkZ2VUaHJlc2hvbGR8fGk+PWYuY29udGVudC5lbGVtZW50Lm9mZnNldFdpZHRoLWYuZWRnZVRocmVzaG9sZDtyZXR1cm4oZS5kcmFnQ29udGVudHx8Zi5pc09wZW4oKSkmJm8mJiF0Lmdlc3R1cmUuc3JjRXZlbnQuZGVmYXVsdFByZXZlbnRlZCYmIXQudGFyZ2V0LnRhZ05hbWUubWF0Y2goL2lucHV0fHRleHRhcmVhfHNlbGVjdHxvYmplY3R8ZW1iZWQvaSkmJiF0LnRhcmdldC5pc0NvbnRlbnRFZGl0YWJsZSYmISh0LnRhcmdldC5kYXRhc2V0P3QudGFyZ2V0LmRhdGFzZXQucHJldmVudFNjcm9sbDpcInRydWVcIj09dC50YXJnZXQuZ2V0QXR0cmlidXRlKFwiZGF0YS1wcmV2ZW50LXNjcm9sbFwiKSl9LGUuc2lkZU1lbnVDb250ZW50VHJhbnNsYXRlWD0wO3ZhciBoPWFuZ3VsYXIubm9vcCxwPWFuZ3VsYXIuYmluZChmLGYuY2xvc2UpO2UuJHdhdGNoKGZ1bmN0aW9uKCl7cmV0dXJuIDAhPT1mLmdldE9wZW5BbW91bnQoKX0sZnVuY3Rpb24oZSl7aCgpLGUmJihoPWkucmVnaXN0ZXJCYWNrQnV0dG9uQWN0aW9uKHAseSkpfSk7dmFyIHY9bi5fcmVnaXN0ZXJJbnN0YW5jZShmLHQuZGVsZWdhdGVIYW5kbGUpO2UuJG9uKFwiJGRlc3Ryb3lcIixmdW5jdGlvbigpe3YoKSxoKCl9KSxmLmluaXRpYWxpemUoe2xlZnQ6e3dpZHRoOjI3NX0scmlnaHQ6e3dpZHRoOjI3NX19KX1dKSx1LmNvbnRyb2xsZXIoXCIkaW9uaWNUYWJcIixbXCIkc2NvcGVcIixcIiRpb25pY1ZpZXdTZXJ2aWNlXCIsXCIkYXR0cnNcIixcIiRsb2NhdGlvblwiLFwiJHN0YXRlXCIsZnVuY3Rpb24oZSx0LG4saSxvKXt0aGlzLiRzY29wZT1lLHRoaXMuaHJlZk1hdGNoZXNTdGF0ZT1mdW5jdGlvbigpe3JldHVybiBuLmhyZWYmJjA9PT1pLnBhdGgoKS5pbmRleE9mKG4uaHJlZi5yZXBsYWNlKC9eIy8sXCJcIikucmVwbGFjZSgvXFwvJC8sXCJcIikpfSx0aGlzLnNyZWZNYXRjaGVzU3RhdGU9ZnVuY3Rpb24oKXtyZXR1cm4gbi51aVNyZWYmJm8uaW5jbHVkZXMobi51aVNyZWYuc3BsaXQoXCIoXCIpWzBdKX0sdGhpcy5uYXZOYW1lTWF0Y2hlc1N0YXRlPWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMubmF2Vmlld05hbWUmJnQuaXNDdXJyZW50U3RhdGVOYXZWaWV3KHRoaXMubmF2Vmlld05hbWUpfSx0aGlzLnRhYk1hdGNoZXNTdGF0ZT1mdW5jdGlvbigpe3JldHVybiB0aGlzLmhyZWZNYXRjaGVzU3RhdGUoKXx8dGhpcy5zcmVmTWF0Y2hlc1N0YXRlKCl8fHRoaXMubmF2TmFtZU1hdGNoZXNTdGF0ZSgpfX1dKSx1LmNvbnRyb2xsZXIoXCIkaW9uaWNUYWJzXCIsW1wiJHNjb3BlXCIsXCIkaW9uaWNWaWV3U2VydmljZVwiLFwiJGVsZW1lbnRcIixmdW5jdGlvbihlLHQpe3ZhciBuPW51bGwsaT10aGlzO2kudGFicz1bXSxpLnNlbGVjdGVkSW5kZXg9ZnVuY3Rpb24oKXtyZXR1cm4gaS50YWJzLmluZGV4T2Yobil9LGkuc2VsZWN0ZWRUYWI9ZnVuY3Rpb24oKXtyZXR1cm4gbn0saS5hZGQ9ZnVuY3Rpb24oZSl7dC5yZWdpc3Rlckhpc3RvcnkoZSksaS50YWJzLnB1c2goZSksMT09PWkudGFicy5sZW5ndGgmJmkuc2VsZWN0KGUpfSxpLnJlbW92ZT1mdW5jdGlvbihlKXt2YXIgdD1pLnRhYnMuaW5kZXhPZihlKTtpZigtMSE9PXQpe2lmKGUuJHRhYlNlbGVjdGVkKWlmKGkuZGVzZWxlY3QoZSksMT09PWkudGFicy5sZW5ndGgpO2Vsc2V7dmFyIG49dD09PWkudGFicy5sZW5ndGgtMT90LTE6dCsxO2kuc2VsZWN0KGkudGFic1tuXSl9aS50YWJzLnNwbGljZSh0LDEpfX0saS5kZXNlbGVjdD1mdW5jdGlvbihlKXtlLiR0YWJTZWxlY3RlZCYmKG49bnVsbCxlLiR0YWJTZWxlY3RlZD0hMSwoZS5vbkRlc2VsZWN0fHxhbmd1bGFyLm5vb3ApKCkpfSxpLnNlbGVjdD1mdW5jdGlvbihvLHIpe3ZhciBhO2lmKGFuZ3VsYXIuaXNOdW1iZXIobyk/KGE9byxvPWkudGFic1thXSk6YT1pLnRhYnMuaW5kZXhPZihvKSwxPT09YXJndW1lbnRzLmxlbmd0aCYmKHI9ISghby5uYXZWaWV3TmFtZSYmIW8udWlTcmVmKSksbiYmbi4kaGlzdG9yeUlkPT1vLiRoaXN0b3J5SWQpciYmdC5nb1RvSGlzdG9yeVJvb3Qoby4kaGlzdG9yeUlkKTtlbHNlIGlmKGYoaS50YWJzLGZ1bmN0aW9uKGUpe2kuZGVzZWxlY3QoZSl9KSxuPW8sby4kdGFiU2VsZWN0ZWQ9ITAsKG8ub25TZWxlY3R8fGFuZ3VsYXIubm9vcCkoKSxyKXt2YXIgcz17dHlwZTpcInRhYlwiLHRhYkluZGV4OmEsaGlzdG9yeUlkOm8uJGhpc3RvcnlJZCxuYXZWaWV3TmFtZTpvLm5hdlZpZXdOYW1lLGhhc05hdlZpZXc6ISFvLm5hdlZpZXdOYW1lLHRpdGxlOm8udGl0bGUsdXJsOm8uaHJlZix1aVNyZWY6by51aVNyZWZ9O2UuJGVtaXQoXCJ2aWV3U3RhdGUuY2hhbmdlSGlzdG9yeVwiLHMpfX19XSksdS5kaXJlY3RpdmUoXCJpb25BY3Rpb25TaGVldFwiLFtcIiRkb2N1bWVudFwiLGZ1bmN0aW9uKGUpe3JldHVybntyZXN0cmljdDpcIkVcIixzY29wZTohMCxyZXBsYWNlOiEwLGxpbms6ZnVuY3Rpb24odCxuKXt2YXIgaT1mdW5jdGlvbihlKXsyNz09ZS53aGljaCYmKHQuY2FuY2VsKCksdC4kYXBwbHkoKSl9LG89ZnVuY3Rpb24oZSl7ZS50YXJnZXQ9PW5bMF0mJih0LmNhbmNlbCgpLHQuJGFwcGx5KCkpfTt0LiRvbihcIiRkZXN0cm95XCIsZnVuY3Rpb24oKXtuLnJlbW92ZSgpLGUudW5iaW5kKFwia2V5dXBcIixpKX0pLGUuYmluZChcImtleXVwXCIsaSksbi5iaW5kKFwiY2xpY2tcIixvKX0sdGVtcGxhdGU6JzxkaXYgY2xhc3M9XCJhY3Rpb24tc2hlZXQtYmFja2Ryb3BcIj48ZGl2IGNsYXNzPVwiYWN0aW9uLXNoZWV0LXdyYXBwZXJcIj48ZGl2IGNsYXNzPVwiYWN0aW9uLXNoZWV0XCI+PGRpdiBjbGFzcz1cImFjdGlvbi1zaGVldC1ncm91cFwiPjxkaXYgY2xhc3M9XCJhY3Rpb24tc2hlZXQtdGl0bGVcIiBuZy1pZj1cInRpdGxlVGV4dFwiIG5nLWJpbmQtaHRtbD1cInRpdGxlVGV4dFwiPjwvZGl2PjxidXR0b24gY2xhc3M9XCJidXR0b25cIiBuZy1jbGljaz1cImJ1dHRvbkNsaWNrZWQoJGluZGV4KVwiIG5nLXJlcGVhdD1cImJ1dHRvbiBpbiBidXR0b25zXCIgbmctYmluZC1odG1sPVwiYnV0dG9uLnRleHRcIj48L2J1dHRvbj48L2Rpdj48ZGl2IGNsYXNzPVwiYWN0aW9uLXNoZWV0LWdyb3VwXCIgbmctaWY9XCJkZXN0cnVjdGl2ZVRleHRcIj48YnV0dG9uIGNsYXNzPVwiYnV0dG9uIGRlc3RydWN0aXZlXCIgbmctY2xpY2s9XCJkZXN0cnVjdGl2ZUJ1dHRvbkNsaWNrZWQoKVwiIG5nLWJpbmQtaHRtbD1cImRlc3RydWN0aXZlVGV4dFwiPjwvYnV0dG9uPjwvZGl2PjxkaXYgY2xhc3M9XCJhY3Rpb24tc2hlZXQtZ3JvdXBcIiBuZy1pZj1cImNhbmNlbFRleHRcIj48YnV0dG9uIGNsYXNzPVwiYnV0dG9uXCIgbmctY2xpY2s9XCJjYW5jZWwoKVwiIG5nLWJpbmQtaHRtbD1cImNhbmNlbFRleHRcIj48L2J1dHRvbj48L2Rpdj48L2Rpdj48L2Rpdj48L2Rpdj4nfX1dKSx1LmRpcmVjdGl2ZShcImlvbkNoZWNrYm94XCIsZnVuY3Rpb24oKXtyZXR1cm57cmVzdHJpY3Q6XCJFXCIscmVwbGFjZTohMCxyZXF1aXJlOlwiP25nTW9kZWxcIix0cmFuc2NsdWRlOiEwLHRlbXBsYXRlOic8bGFiZWwgY2xhc3M9XCJpdGVtIGl0ZW0tY2hlY2tib3hcIj48ZGl2IGNsYXNzPVwiY2hlY2tib3ggY2hlY2tib3gtaW5wdXQtaGlkZGVuIGRpc2FibGUtcG9pbnRlci1ldmVudHNcIj48aW5wdXQgdHlwZT1cImNoZWNrYm94XCI+PGkgY2xhc3M9XCJjaGVja2JveC1pY29uXCI+PC9pPjwvZGl2PjxkaXYgY2xhc3M9XCJpdGVtLWNvbnRlbnQgZGlzYWJsZS1wb2ludGVyLWV2ZW50c1wiIG5nLXRyYW5zY2x1ZGU+PC9kaXY+PC9sYWJlbD4nLGNvbXBpbGU6ZnVuY3Rpb24oZSx0KXt2YXIgbj1lLmZpbmQoXCJpbnB1dFwiKTtmKHtuYW1lOnQubmFtZSxcIm5nLXZhbHVlXCI6dC5uZ1ZhbHVlLFwibmctbW9kZWxcIjp0Lm5nTW9kZWwsXCJuZy1jaGVja2VkXCI6dC5uZ0NoZWNrZWQsXCJuZy1kaXNhYmxlZFwiOnQubmdEaXNhYmxlZCxcIm5nLXRydWUtdmFsdWVcIjp0Lm5nVHJ1ZVZhbHVlLFwibmctZmFsc2UtdmFsdWVcIjp0Lm5nRmFsc2VWYWx1ZSxcIm5nLWNoYW5nZVwiOnQubmdDaGFuZ2V9LGZ1bmN0aW9uKGUsdCl7aChlKSYmbi5hdHRyKHQsZSl9KX19fSk7dmFyIHg9XCJDYW5ub3QgY3JlYXRlIGEgY29sbGVjdGlvbi1yZXBlYXQgd2l0aGluIGEgc2Nyb2xsVmlldyB0aGF0IGlzIHNjcm9sbGFibGUgb24gYm90aCB4IGFuZCB5IGF4aXMuICBDaG9vc2UgZWl0aGVyIHggZGlyZWN0aW9uIG9yIHkgZGlyZWN0aW9uLlwiLEI9XCJjb2xsZWN0aW9uLXJlcGVhdCBleHBlY3RlZCBhdHRyaWJ1dGUgY29sbGVjdGlvbi1pdGVtLWhlaWdodCB0byBiZSBhIGFuIGV4cHJlc3Npb24gdGhhdCByZXR1cm5zIGEgbnVtYmVyIChpbiBwaXhlbHMpIG9yIHBlcmNlbnRhZ2UuXCIsVj1cImNvbGxlY3Rpb24tcmVwZWF0IGV4cGVjdGVkIGF0dHJpYnV0ZSBjb2xsZWN0aW9uLWl0ZW0td2lkdGggdG8gYmUgYSBhbiBleHByZXNzaW9uIHRoYXQgcmV0dXJucyBhIG51bWJlciAoaW4gcGl4ZWxzKSBvciBwZXJjZW50YWdlLlwiLEU9XCJjb2xsZWN0aW9uLXJlcGVhdCBleHBlY3RlZCBleHByZXNzaW9uIGluIGZvcm0gb2YgJ19pdGVtXyBpbiBfY29sbGVjdGlvbl9bIHRyYWNrIGJ5IF9pZF9dJyBidXQgZ290ICclJ1wiO3UuZGlyZWN0aXZlKFwiY29sbGVjdGlvblJlcGVhdFwiLFtcIiRjb2xsZWN0aW9uUmVwZWF0TWFuYWdlclwiLFwiJGNvbGxlY3Rpb25EYXRhU291cmNlXCIsXCIkcGFyc2VcIixmdW5jdGlvbihlLHQsbil7cmV0dXJue3ByaW9yaXR5OjFlMyx0cmFuc2NsdWRlOlwiZWxlbWVudFwiLHRlcm1pbmFsOiEwLCQkdGxiOiEwLHJlcXVpcmU6XCJeJGlvbmljU2Nyb2xsXCIsY29udHJvbGxlcjpbZnVuY3Rpb24oKXt9XSxsaW5rOmZ1bmN0aW9uKGksbyxyLGEscyl7ZnVuY3Rpb24gYyhlKXt2YXIgdD1bXSxuPVtdLGk9ITA7ZihJLmNoaWxkcmVuLGZ1bmN0aW9uKGUpe2lmKGlvbmljLkRvbVV0aWwuZWxlbWVudElzRGVzY2VuZGFudChvWzBdLGUsSSkpaT0hMTtlbHNle2lmKGUuaGFzQXR0cmlidXRlKFwiY29sbGVjdGlvbi1yZXBlYXQtaWdub3JlXCIpKXJldHVybjt2YXIgcj1lLm9mZnNldFdpZHRoLGE9ZS5vZmZzZXRIZWlnaHQ7aWYociYmYSl7dmFyIHM9dihlKTsoaT90Om4pLnB1c2goe3dpZHRoOmUub2Zmc2V0V2lkdGgsaGVpZ2h0OmUub2Zmc2V0SGVpZ2h0LGVsZW1lbnQ6cyxzY29wZTpzLmlzb2xhdGVTY29wZSgpfHxzLnNjb3BlKCksaXNPdXRzaWRlOiEwfSl9fX0pLGQucmVzaXplKCksay5zZXREYXRhKGUsdCxuKSxULnJlc2l6ZSgpfWZ1bmN0aW9uIGwoKXtjKGkuJGV2YWwoUykpfXZhciB1PXYoJzxkaXYgc3R5bGU9XCJwb3NpdGlvbjpyZWxhdGl2ZTtcIj4nKTtvLnBhcmVudCgpWzBdLmluc2VydEJlZm9yZSh1WzBdLG9bMF0pLHUuYXBwZW5kKG8pO3ZhciBkPWEuc2Nyb2xsVmlldztpZihkLm9wdGlvbnMuc2Nyb2xsaW5nWCYmZC5vcHRpb25zLnNjcm9sbGluZ1kpdGhyb3cgbmV3IEVycm9yKHgpO3ZhciBoPSEhZC5vcHRpb25zLnNjcm9sbGluZ1k7aWYoaCYmIXIuY29sbGVjdGlvbkl0ZW1IZWlnaHQpdGhyb3cgbmV3IEVycm9yKEIpO2lmKCFoJiYhci5jb2xsZWN0aW9uSXRlbVdpZHRoKXRocm93IG5ldyBFcnJvcihWKTt2YXIgZz1uKHIuY29sbGVjdGlvbkl0ZW1IZWlnaHR8fCdcIjEwMCVcIicpLG09bihyLmNvbGxlY3Rpb25JdGVtV2lkdGh8fCdcIjEwMCVcIicpLCQ9ZnVuY3Rpb24oZSx0KXt2YXIgbj1nKGUsdCk7cmV0dXJuIHAobikmJm4uaW5kZXhPZihcIiVcIik+LTE/TWF0aC5mbG9vcihwYXJzZUludChuLDEwKS8xMDAqZC5fX2NsaWVudEhlaWdodCk6bn0sdz1mdW5jdGlvbihlLHQpe3ZhciBuPW0oZSx0KTtyZXR1cm4gcChuKSYmbi5pbmRleE9mKFwiJVwiKT4tMT9NYXRoLmZsb29yKHBhcnNlSW50KG4sMTApLzEwMCpkLl9fY2xpZW50V2lkdGgpOm59LGI9ci5jb2xsZWN0aW9uUmVwZWF0Lm1hdGNoKC9eXFxzKihbXFxzXFxTXSs/KVxccytpblxccysoW1xcc1xcU10rPykoPzpcXHMrdHJhY2tcXHMrYnlcXHMrKFtcXHNcXFNdKz8pKT9cXHMqJC8pO2lmKCFiKXRocm93IG5ldyBFcnJvcihFLnJlcGxhY2UoXCIlXCIsci5jb2xsZWN0aW9uUmVwZWF0KSk7dmFyIHk9YlsxXSxTPWJbMl0sQz1iWzNdLGs9bmV3IHQoe3Njb3BlOmksdHJhbnNjbHVkZUZuOnMsdHJhbnNjbHVkZVBhcmVudDpvLnBhcmVudCgpLGtleUV4cHI6eSxsaXN0RXhwcjpTLHRyYWNrQnlFeHByOkMsaGVpZ2h0R2V0dGVyOiQsd2lkdGhHZXR0ZXI6d30pLFQ9bmV3IGUoe2RhdGFTb3VyY2U6ayxlbGVtZW50OmEuJGVsZW1lbnQsc2Nyb2xsVmlldzphLnNjcm9sbFZpZXd9KTtpLiR3YXRjaENvbGxlY3Rpb24oUyxmdW5jdGlvbihlKXtpZihlJiYhYW5ndWxhci5pc0FycmF5KGUpKXRocm93IG5ldyBFcnJvcihcImNvbGxlY3Rpb24tcmVwZWF0IGV4cGVjdHMgYW4gYXJyYXkgdG8gcmVwZWF0IG92ZXIsIGJ1dCBpbnN0ZWFkIGdvdCAnXCIrdHlwZW9mIGUrXCInLlwiKTtjKGUpfSk7dmFyIEk9YS5zY3JvbGxWaWV3Ll9fY29udGVudDthLiRlbGVtZW50Lm9uKFwic2Nyb2xsLnJlc2l6ZVwiLGwpLGlvbmljLm9uKFwicmVzaXplXCIsbCx3aW5kb3cpLGkuJG9uKFwiJGRlc3Ryb3lcIixmdW5jdGlvbigpe1QuZGVzdHJveSgpLGsuZGVzdHJveSgpLGlvbmljLm9mZihcInJlc2l6ZVwiLGwsd2luZG93KX0pfX19XSkuZGlyZWN0aXZlKHtuZ1NyYzppKFwibmdTcmNcIixcInNyY1wiKSxuZ1NyY3NldDppKFwibmdTcmNzZXRcIixcInNyY3NldFwiKSxuZ0hyZWY6aShcIm5nSHJlZlwiLFwiaHJlZlwiKX0pLHUuZGlyZWN0aXZlKFwiaW9uQ29udGVudFwiLFtcIiR0aW1lb3V0XCIsXCIkY29udHJvbGxlclwiLFwiJGlvbmljQmluZFwiLGZ1bmN0aW9uKGUsdCxuKXtyZXR1cm57cmVzdHJpY3Q6XCJFXCIscmVxdWlyZTpcIl4/aW9uTmF2Vmlld1wiLHNjb3BlOiEwLHByaW9yaXR5OjgwMCxjb21waWxlOmZ1bmN0aW9uKGUsaSl7ZnVuY3Rpb24gbyhlLG8sYSl7dmFyIHM9ZS4kcGFyZW50O2lmKGUuJHdhdGNoKGZ1bmN0aW9uKCl7cmV0dXJuKHMuJGhhc0hlYWRlcj9cIiBoYXMtaGVhZGVyXCI6XCJcIikrKHMuJGhhc1N1YmhlYWRlcj9cIiBoYXMtc3ViaGVhZGVyXCI6XCJcIikrKHMuJGhhc0Zvb3Rlcj9cIiBoYXMtZm9vdGVyXCI6XCJcIikrKHMuJGhhc1N1YmZvb3Rlcj9cIiBoYXMtc3ViZm9vdGVyXCI6XCJcIikrKHMuJGhhc1RhYnM/XCIgaGFzLXRhYnNcIjpcIlwiKSsocy4kaGFzVGFic1RvcD9cIiBoYXMtdGFicy10b3BcIjpcIlwiKX0sZnVuY3Rpb24oZSx0KXtvLnJlbW92ZUNsYXNzKHQpLG8uYWRkQ2xhc3MoZSl9KSxlLiRoYXNIZWFkZXI9ZS4kaGFzU3ViaGVhZGVyPWUuJGhhc0Zvb3Rlcj1lLiRoYXNTdWJmb290ZXI9ZS4kaGFzVGFicz1lLiRoYXNUYWJzVG9wPSExLG4oZSxhLHskb25TY3JvbGw6XCImb25TY3JvbGxcIiwkb25TY3JvbGxDb21wbGV0ZTpcIiZvblNjcm9sbENvbXBsZXRlXCIsaGFzQm91bmNpbmc6XCJAXCIscGFkZGluZzpcIkBcIixkaXJlY3Rpb246XCJAXCIsc2Nyb2xsYmFyWDpcIkBcIixzY3JvbGxiYXJZOlwiQFwiLHN0YXJ0WDpcIkBcIixzdGFydFk6XCJAXCIsc2Nyb2xsRXZlbnRJbnRlcnZhbDpcIkBcIn0pLGUuZGlyZWN0aW9uPWUuZGlyZWN0aW9ufHxcInlcIixhbmd1bGFyLmlzRGVmaW5lZChhLnBhZGRpbmcpJiZlLiR3YXRjaChhLnBhZGRpbmcsZnVuY3Rpb24oZSl7KHJ8fG8pLnRvZ2dsZUNsYXNzKFwicGFkZGluZ1wiLCEhZSl9KSxcImZhbHNlXCI9PT1hLnNjcm9sbCk7ZWxzZSBpZihcInRydWVcIj09PWkub3ZlcmZsb3dTY3JvbGwpby5hZGRDbGFzcyhcIm92ZXJmbG93LXNjcm9sbFwiKTtlbHNle3ZhciBjPXtlbDpvWzBdLGRlbGVnYXRlSGFuZGxlOmkuZGVsZWdhdGVIYW5kbGUsbG9ja2luZzpcInRydWVcIj09PShpLmxvY2tpbmd8fFwidHJ1ZVwiKSxib3VuY2luZzplLiRldmFsKGUuaGFzQm91bmNpbmcpLHN0YXJ0WDplLiRldmFsKGUuc3RhcnRYKXx8MCxzdGFydFk6ZS4kZXZhbChlLnN0YXJ0WSl8fDAsc2Nyb2xsYmFyWDplLiRldmFsKGUuc2Nyb2xsYmFyWCkhPT0hMSxzY3JvbGxiYXJZOmUuJGV2YWwoZS5zY3JvbGxiYXJZKSE9PSExLHNjcm9sbGluZ1g6ZS5kaXJlY3Rpb24uaW5kZXhPZihcInhcIik+PTAsc2Nyb2xsaW5nWTplLmRpcmVjdGlvbi5pbmRleE9mKFwieVwiKT49MCxzY3JvbGxFdmVudEludGVydmFsOnBhcnNlSW50KGUuc2Nyb2xsRXZlbnRJbnRlcnZhbCwxMCl8fDEwLHNjcm9sbGluZ0NvbXBsZXRlOmZ1bmN0aW9uKCl7ZS4kb25TY3JvbGxDb21wbGV0ZSh7c2Nyb2xsVG9wOnRoaXMuX19zY3JvbGxUb3Asc2Nyb2xsTGVmdDp0aGlzLl9fc2Nyb2xsTGVmdH0pfX07dChcIiRpb25pY1Njcm9sbFwiLHskc2NvcGU6ZSxzY3JvbGxWaWV3T3B0aW9uczpjfSksZS4kb24oXCIkZGVzdHJveVwiLGZ1bmN0aW9uKCl7Yy5zY3JvbGxpbmdDb21wbGV0ZT1hbmd1bGFyLm5vb3AsZGVsZXRlIGMuZWwscj1udWxsLG89bnVsbCxpLiQkZWxlbWVudD1udWxsfSl9fXZhciByO3JldHVybiBlLmFkZENsYXNzKFwic2Nyb2xsLWNvbnRlbnQgaW9uaWMtc2Nyb2xsXCIpLFwiZmFsc2VcIiE9aS5zY3JvbGw/KHI9dignPGRpdiBjbGFzcz1cInNjcm9sbFwiPjwvZGl2PicpLHIuYXBwZW5kKGUuY29udGVudHMoKSksZS5hcHBlbmQocikpOmUuYWRkQ2xhc3MoXCJzY3JvbGwtY29udGVudC1mYWxzZVwiKSx7cHJlOm99fX19XSksdS5kaXJlY3RpdmUoXCJleHBvc2VBc2lkZVdoZW5cIixbXCIkd2luZG93XCIsZnVuY3Rpb24oZSl7cmV0dXJue3Jlc3RyaWN0OlwiQVwiLHJlcXVpcmU6XCJeaW9uU2lkZU1lbnVzXCIsbGluazpmdW5jdGlvbih0LG4saSxvKXtmdW5jdGlvbiByKCl7dmFyIHQ9XCJsYXJnZVwiPT1pLmV4cG9zZUFzaWRlV2hlbj9cIihtaW4td2lkdGg6NzY4cHgpXCI6aS5leHBvc2VBc2lkZVdoZW47by5leHBvc2VBc2lkZShlLm1hdGNoTWVkaWEodCkubWF0Y2hlcyksby5hY3RpdmVBc2lkZVJlc2l6aW5nKCExKX1mdW5jdGlvbiBhKCl7by5hY3RpdmVBc2lkZVJlc2l6aW5nKCEwKSxzKCl9dmFyIHM9aW9uaWMuZGVib3VuY2UoZnVuY3Rpb24oKXt0LiRhcHBseShmdW5jdGlvbigpe3IoKX0pfSwzMDAsITEpO3IoKSxpb25pYy5vbihcInJlc2l6ZVwiLGEsZSksdC4kb24oXCIkZGVzdHJveVwiLGZ1bmN0aW9uKCl7aW9uaWMub2ZmKFwicmVzaXplXCIsYSxlKX0pfX19XSk7dmFyIF89XCJvbkhvbGQgb25UYXAgb25Ub3VjaCBvblJlbGVhc2Ugb25EcmFnIG9uRHJhZ1VwIG9uRHJhZ1JpZ2h0IG9uRHJhZ0Rvd24gb25EcmFnTGVmdCBvblN3aXBlIG9uU3dpcGVVcCBvblN3aXBlUmlnaHQgb25Td2lwZURvd24gb25Td2lwZUxlZnRcIi5zcGxpdChcIiBcIik7Xy5mb3JFYWNoKGZ1bmN0aW9uKGUpe3UuZGlyZWN0aXZlKGUsbyhlKSl9KSx1LmRpcmVjdGl2ZShcImlvbk5hdkJhclwiLHIoKSkuZGlyZWN0aXZlKFwiaW9uSGVhZGVyQmFyXCIscigpKS5kaXJlY3RpdmUoXCJpb25IZWFkZXJCYXJcIixhKCEwKSkuZGlyZWN0aXZlKFwiaW9uRm9vdGVyQmFyXCIsYSghMSkpLHUuZGlyZWN0aXZlKFwiaW9uSW5maW5pdGVTY3JvbGxcIixbXCIkdGltZW91dFwiLGZ1bmN0aW9uKGUpe2Z1bmN0aW9uIHQoZSx0LG4pe3JldHVybiBuP3QqKDEtcGFyc2VGbG9hdChlLDEwKS8xMDApOnQtcGFyc2VGbG9hdChlLDEwKX1yZXR1cm57cmVzdHJpY3Q6XCJFXCIscmVxdWlyZTpbXCJeJGlvbmljU2Nyb2xsXCIsXCJpb25JbmZpbml0ZVNjcm9sbFwiXSx0ZW1wbGF0ZTonPGkgY2xhc3M9XCJpY29uIHt7aWNvbigpfX0gaWNvbi1yZWZyZXNoaW5nXCI+PC9pPicsc2NvcGU6ITAsY29udHJvbGxlcjpbXCIkc2NvcGVcIixcIiRhdHRyc1wiLGZ1bmN0aW9uKGUsbil7dGhpcy5pc0xvYWRpbmc9ITEsdGhpcy5zY3JvbGxWaWV3PW51bGwsdGhpcy5nZXRNYXhTY3JvbGw9ZnVuY3Rpb24oKXt2YXIgZT0obi5kaXN0YW5jZXx8XCIyLjUlXCIpLnRyaW0oKSxpPS0xIT09ZS5pbmRleE9mKFwiJVwiKSxvPXRoaXMuc2Nyb2xsVmlldy5nZXRTY3JvbGxNYXgoKTtyZXR1cm57bGVmdDp0aGlzLnNjcm9sbFZpZXcub3B0aW9ucy5zY3JvbGxpbmdYP3QoZSxvLmxlZnQsaSk6LTEsdG9wOnRoaXMuc2Nyb2xsVmlldy5vcHRpb25zLnNjcm9sbGluZ1k/dChlLG8udG9wLGkpOi0xfX19XSxsaW5rOmZ1bmN0aW9uKHQsbixpLG8pe2Z1bmN0aW9uIHIoKXtpZighcy5pc0xvYWRpbmcpe3ZhciBlPWMuZ2V0VmFsdWVzKCksdD1zLmdldE1heFNjcm9sbCgpOygtMSE9PXQubGVmdCYmZS5sZWZ0Pj10LmxlZnR8fC0xIT09dC50b3AmJmUudG9wPj10LnRvcCkmJmwoKX19dmFyIGE9b1swXSxzPW9bMV0sYz1zLnNjcm9sbFZpZXc9YS5zY3JvbGxWaWV3O3QuaWNvbj1mdW5jdGlvbigpe3JldHVybiBhbmd1bGFyLmlzRGVmaW5lZChpLmljb24pP2kuaWNvbjpcImlvbi1sb2FkaW5nLWRcIn07dmFyIGw9ZnVuY3Rpb24oKXtuWzBdLmNsYXNzTGlzdC5hZGQoXCJhY3RpdmVcIikscy5pc0xvYWRpbmc9ITAsdC4kcGFyZW50JiZ0LiRwYXJlbnQuJGFwcGx5KGkub25JbmZpbml0ZXx8XCJcIil9LHU9ZnVuY3Rpb24oKXtuWzBdLmNsYXNzTGlzdC5yZW1vdmUoXCJhY3RpdmVcIiksZShmdW5jdGlvbigpe2MucmVzaXplKCksZCgpfSwwLCExKSxzLmlzTG9hZGluZz0hMX07dC4kb24oXCJzY3JvbGwuaW5maW5pdGVTY3JvbGxDb21wbGV0ZVwiLGZ1bmN0aW9uKCl7dSgpfSksdC4kb24oXCIkZGVzdHJveVwiLGZ1bmN0aW9uKCl7YSYmYS4kZWxlbWVudCYmYS4kZWxlbWVudC5vZmYoXCJzY3JvbGxcIixkKX0pO3ZhciBkPWlvbmljLmFuaW1hdGlvbkZyYW1lVGhyb3R0bGUocik7c2V0VGltZW91dChkKSxhLiRlbGVtZW50Lm9uKFwic2Nyb2xsXCIsZCl9fX1dKTt2YXIgQT0nPGEgY2xhc3M9XCJpdGVtLWNvbnRlbnRcIiBuZy1ocmVmPVwie3skaHJlZigpfX1cIiB0YXJnZXQ9XCJ7eyR0YXJnZXQoKX19XCI+PC9hPicsUD0nPGRpdiBjbGFzcz1cIml0ZW0tY29udGVudFwiPjwvZGl2Pic7dS5kaXJlY3RpdmUoXCJpb25JdGVtXCIsW1wiJGFuaW1hdGVcIixcIiRjb21waWxlXCIsZnVuY3Rpb24oKXtyZXR1cm57cmVzdHJpY3Q6XCJFXCIsY29udHJvbGxlcjpbXCIkc2NvcGVcIixcIiRlbGVtZW50XCIsZnVuY3Rpb24oZSx0KXt0aGlzLiRzY29wZT1lLHRoaXMuJGVsZW1lbnQ9dH1dLHNjb3BlOiEwLGNvbXBpbGU6ZnVuY3Rpb24oZSx0KXt2YXIgbj1hbmd1bGFyLmlzRGVmaW5lZCh0LmhyZWYpfHxhbmd1bGFyLmlzRGVmaW5lZCh0Lm5nSHJlZil8fGFuZ3VsYXIuaXNEZWZpbmVkKHQudWlTcmVmKSxpPW58fC9pb24tKGRlbGV0ZXxvcHRpb258cmVvcmRlciktYnV0dG9uL2kudGVzdChlLmh0bWwoKSk7aWYoaSl7dmFyIG89dihuP0E6UCk7by5hcHBlbmQoZS5jb250ZW50cygpKSxlLmFwcGVuZChvKSxlLmFkZENsYXNzKFwiaXRlbSBpdGVtLWNvbXBsZXhcIil9ZWxzZSBlLmFkZENsYXNzKFwiaXRlbVwiKTtyZXR1cm4gZnVuY3Rpb24oZSx0LG4pe2UuJGhyZWY9ZnVuY3Rpb24oKXtyZXR1cm4gbi5ocmVmfHxuLm5nSHJlZn0sZS4kdGFyZ2V0PWZ1bmN0aW9uKCl7cmV0dXJuIG4udGFyZ2V0fHxcIl9zZWxmXCJ9fX19fV0pO3ZhciBEPSc8ZGl2IGNsYXNzPVwiaXRlbS1sZWZ0LWVkaXQgaXRlbS1kZWxldGUgZW5hYmxlLXBvaW50ZXItZXZlbnRzXCI+PC9kaXY+Jzt1LmRpcmVjdGl2ZShcImlvbkRlbGV0ZUJ1dHRvblwiLFtcIiRhbmltYXRlXCIsZnVuY3Rpb24oKXtyZXR1cm57cmVzdHJpY3Q6XCJFXCIscmVxdWlyZTpbXCJeaW9uSXRlbVwiLFwiXj9pb25MaXN0XCJdLHByaW9yaXR5Ok51bWJlci5NQVhfVkFMVUUsY29tcGlsZTpmdW5jdGlvbihlLHQpe3JldHVybiB0LiRzZXQoXCJjbGFzc1wiLCh0W1wiY2xhc3NcIl18fFwiXCIpK1wiIGJ1dHRvbiBpY29uIGJ1dHRvbi1pY29uXCIsITApLGZ1bmN0aW9uKGUsdCxuLGkpe3ZhciBvPWlbMF0scj1pWzFdLGE9dihEKTthLmFwcGVuZCh0KSxvLiRlbGVtZW50LmFwcGVuZChhKS5hZGRDbGFzcyhcIml0ZW0tbGVmdC1lZGl0YWJsZVwiKSxyJiZyLnNob3dEZWxldGUoKSYmYS5hZGRDbGFzcyhcInZpc2libGUgYWN0aXZlXCIpfX19fV0pLHUuZGlyZWN0aXZlKFwiaXRlbUZsb2F0aW5nTGFiZWxcIixmdW5jdGlvbigpe3JldHVybntyZXN0cmljdDpcIkNcIixsaW5rOmZ1bmN0aW9uKGUsdCl7dmFyIG49dFswXSxpPW4ucXVlcnlTZWxlY3RvcihcImlucHV0LCB0ZXh0YXJlYVwiKSxvPW4ucXVlcnlTZWxlY3RvcihcIi5pbnB1dC1sYWJlbFwiKTtpZihpJiZvKXt2YXIgcj1mdW5jdGlvbigpe2kudmFsdWU/by5jbGFzc0xpc3QuYWRkKFwiaGFzLWlucHV0XCIpOm8uY2xhc3NMaXN0LnJlbW92ZShcImhhcy1pbnB1dFwiKX07aS5hZGRFdmVudExpc3RlbmVyKFwiaW5wdXRcIixyKTt2YXIgYT1hbmd1bGFyLmVsZW1lbnQoaSkuY29udHJvbGxlcihcIm5nTW9kZWxcIik7YSYmKGEuJHJlbmRlcj1mdW5jdGlvbigpe2kudmFsdWU9YS4kdmlld1ZhbHVlfHxcIlwiLHIoKX0pLGUuJG9uKFwiJGRlc3Ryb3lcIixmdW5jdGlvbigpe2kucmVtb3ZlRXZlbnRMaXN0ZW5lcihcImlucHV0XCIscil9KX19fX0pO3ZhciBIPSc8ZGl2IGNsYXNzPVwiaXRlbS1vcHRpb25zIGludmlzaWJsZVwiPjwvZGl2Pic7dS5kaXJlY3RpdmUoXCJpb25PcHRpb25CdXR0b25cIixbXCIkY29tcGlsZVwiLGZ1bmN0aW9uKCl7ZnVuY3Rpb24gZShlKXtlLnN0b3BQcm9wYWdhdGlvbigpfXJldHVybntyZXN0cmljdDpcIkVcIixyZXF1aXJlOlwiXmlvbkl0ZW1cIixwcmlvcml0eTpOdW1iZXIuTUFYX1ZBTFVFLGNvbXBpbGU6ZnVuY3Rpb24odCxuKXtyZXR1cm4gbi4kc2V0KFwiY2xhc3NcIiwobltcImNsYXNzXCJdfHxcIlwiKStcIiBidXR0b25cIiwhMCksZnVuY3Rpb24odCxuLGksbyl7by5vcHRpb25zQ29udGFpbmVyfHwoby5vcHRpb25zQ29udGFpbmVyPXYoSCksby4kZWxlbWVudC5hcHBlbmQoby5vcHRpb25zQ29udGFpbmVyKSksby5vcHRpb25zQ29udGFpbmVyLmFwcGVuZChuKSxuLm9uKFwiY2xpY2tcIixlKX19fX1dKTt2YXIgTD0nPGRpdiBkYXRhLXByZXZlbnQtc2Nyb2xsPVwidHJ1ZVwiIGNsYXNzPVwiaXRlbS1yaWdodC1lZGl0IGl0ZW0tcmVvcmRlciBlbmFibGUtcG9pbnRlci1ldmVudHNcIj48L2Rpdj4nO3UuZGlyZWN0aXZlKFwiaW9uUmVvcmRlckJ1dHRvblwiLFtcIiRhbmltYXRlXCIsXCIkcGFyc2VcIixmdW5jdGlvbihlLHQpe3JldHVybntyZXN0cmljdDpcIkVcIixyZXF1aXJlOltcIl5pb25JdGVtXCIsXCJeP2lvbkxpc3RcIl0scHJpb3JpdHk6TnVtYmVyLk1BWF9WQUxVRSxjb21waWxlOmZ1bmN0aW9uKGUsbil7cmV0dXJuIG4uJHNldChcImNsYXNzXCIsKG5bXCJjbGFzc1wiXXx8XCJcIikrXCIgYnV0dG9uIGljb24gYnV0dG9uLWljb25cIiwhMCksZVswXS5zZXRBdHRyaWJ1dGUoXCJkYXRhLXByZXZlbnQtc2Nyb2xsXCIsITApLGZ1bmN0aW9uKGUsbixpLG8pe3ZhciByPW9bMF0sYT1vWzFdLHM9dChpLm9uUmVvcmRlcik7ZS4kb25SZW9yZGVyPWZ1bmN0aW9uKHQsbil7cyhlLHskZnJvbUluZGV4OnQsJHRvSW5kZXg6bn0pfSxpLm5nQ2xpY2t8fGkub25DbGlja3x8aS5vbmNsaWNrfHwoblswXS5vbmNsaWNrPWZ1bmN0aW9uKGUpe3JldHVybiBlLnN0b3BQcm9wYWdhdGlvbigpLCExfSk7dmFyIGM9dihMKTtjLmFwcGVuZChuKSxyLiRlbGVtZW50LmFwcGVuZChjKS5hZGRDbGFzcyhcIml0ZW0tcmlnaHQtZWRpdGFibGVcIiksYSYmYS5zaG93UmVvcmRlcigpJiZjLmFkZENsYXNzKFwidmlzaWJsZSBhY3RpdmVcIil9fX19XSksdS5kaXJlY3RpdmUoXCJrZXlib2FyZEF0dGFjaFwiLGZ1bmN0aW9uKCl7cmV0dXJuIGZ1bmN0aW9uKGUsdCl7ZnVuY3Rpb24gbihlKXtpZighaW9uaWMuUGxhdGZvcm0uaXNBbmRyb2lkKCl8fGlvbmljLlBsYXRmb3JtLmlzRnVsbFNjcmVlbil7dmFyIG49ZS5rZXlib2FyZEhlaWdodHx8ZS5kZXRhaWwua2V5Ym9hcmRIZWlnaHQ7dC5jc3MoXCJib3R0b21cIixuK1wicHhcIiksbz10LmNvbnRyb2xsZXIoXCIkaW9uaWNTY3JvbGxcIiksbyYmKG8uc2Nyb2xsVmlldy5fX2NvbnRhaW5lci5zdHlsZS5ib3R0b209bitzKHRbMF0pK1wicHhcIil9fWZ1bmN0aW9uIGkoKXsoIWlvbmljLlBsYXRmb3JtLmlzQW5kcm9pZCgpfHxpb25pYy5QbGF0Zm9ybS5pc0Z1bGxTY3JlZW4pJiYodC5jc3MoXCJib3R0b21cIixcIlwiKSxvJiYoby5zY3JvbGxWaWV3Ll9fY29udGFpbmVyLnN0eWxlLmJvdHRvbT1cIlwiKSl9aW9uaWMub24oXCJuYXRpdmUua2V5Ym9hcmRzaG93XCIsbix3aW5kb3cpLGlvbmljLm9uKFwibmF0aXZlLmtleWJvYXJkaGlkZVwiLGksd2luZG93KSxpb25pYy5vbihcIm5hdGl2ZS5zaG93a2V5Ym9hcmRcIixuLHdpbmRvdyksaW9uaWMub24oXCJuYXRpdmUuaGlkZWtleWJvYXJkXCIsaSx3aW5kb3cpO3ZhciBvO2UuJG9uKFwiJGRlc3Ryb3lcIixmdW5jdGlvbigpe2lvbmljLm9mZihcIm5hdGl2ZS5rZXlib2FyZHNob3dcIixuLHdpbmRvdyksaW9uaWMub2ZmKFwibmF0aXZlLmtleWJvYXJkaGlkZVwiLGksd2luZG93KSxpb25pYy5vZmYoXCJuYXRpdmUuc2hvd2tleWJvYXJkXCIsbix3aW5kb3cpLGlvbmljLm9mZihcIm5hdGl2ZS5oaWRla2V5Ym9hcmRcIixpLHdpbmRvdyl9KX19KSx1LmRpcmVjdGl2ZShcImlvbkxpc3RcIixbXCIkYW5pbWF0ZVwiLFwiJHRpbWVvdXRcIixmdW5jdGlvbihlLHQpe3JldHVybntyZXN0cmljdDpcIkVcIixyZXF1aXJlOltcImlvbkxpc3RcIixcIl4/JGlvbmljU2Nyb2xsXCJdLGNvbnRyb2xsZXI6XCIkaW9uaWNMaXN0XCIsY29tcGlsZTpmdW5jdGlvbihlLG4pe3ZhciBpPXYoJzxkaXYgY2xhc3M9XCJsaXN0XCI+JykuYXBwZW5kKGUuY29udGVudHMoKSkuYWRkQ2xhc3Mobi50eXBlKTtyZXR1cm4gZS5hcHBlbmQoaSksZnVuY3Rpb24oZSxpLG8scil7ZnVuY3Rpb24gYSgpe2Z1bmN0aW9uIG8oZSx0KXt0KCkmJmUuYWRkQ2xhc3MoXCJ2aXNpYmxlXCIpfHxlLnJlbW92ZUNsYXNzKFwiYWN0aXZlXCIpLGlvbmljLnJlcXVlc3RBbmltYXRpb25GcmFtZShmdW5jdGlvbigpe3QoKSYmZS5hZGRDbGFzcyhcImFjdGl2ZVwiKXx8ZS5yZW1vdmVDbGFzcyhcInZpc2libGVcIil9KX1zLmxpc3RWaWV3PW5ldyBpb25pYy52aWV3cy5MaXN0Vmlldyh7ZWw6aVswXSxsaXN0RWw6aS5jaGlsZHJlbigpWzBdLHNjcm9sbEVsOmMmJmMuZWxlbWVudCxzY3JvbGxWaWV3OmMmJmMuc2Nyb2xsVmlldyxvblJlb3JkZXI6ZnVuY3Rpb24oZSxuLGkpe3ZhciBvPXYoZSkuc2NvcGUoKTtvJiZvLiRvblJlb3JkZXImJnQoZnVuY3Rpb24oKXtvLiRvblJlb3JkZXIobixpKX0pfSxjYW5Td2lwZTpmdW5jdGlvbigpe3JldHVybiBzLmNhblN3aXBlSXRlbXMoKX19KTtoKG4uY2FuU3dpcGUpJiZlLiR3YXRjaChcIiEhKFwiK24uY2FuU3dpcGUrXCIpXCIsZnVuY3Rpb24oZSl7cy5jYW5Td2lwZUl0ZW1zKGUpfSksaChuLnNob3dEZWxldGUpJiZlLiR3YXRjaChcIiEhKFwiK24uc2hvd0RlbGV0ZStcIilcIixmdW5jdGlvbihlKXtzLnNob3dEZWxldGUoZSl9KSxoKG4uc2hvd1Jlb3JkZXIpJiZlLiR3YXRjaChcIiEhKFwiK24uc2hvd1Jlb3JkZXIrXCIpXCIsZnVuY3Rpb24oZSl7cy5zaG93UmVvcmRlcihlKX0pLGUuJHdhdGNoKGZ1bmN0aW9uKCl7cmV0dXJuIHMuc2hvd0RlbGV0ZSgpfSxmdW5jdGlvbihlLHQpe2lmKGV8fHQpe2UmJnMuY2xvc2VPcHRpb25CdXR0b25zKCkscy5jYW5Td2lwZUl0ZW1zKCFlKSxpLmNoaWxkcmVuKCkudG9nZ2xlQ2xhc3MoXCJsaXN0LWxlZnQtZWRpdGluZ1wiLGUpLGkudG9nZ2xlQ2xhc3MoXCJkaXNhYmxlLXBvaW50ZXItZXZlbnRzXCIsZSk7dmFyIG49dihpWzBdLmdldEVsZW1lbnRzQnlDbGFzc05hbWUoXCJpdGVtLWRlbGV0ZVwiKSk7byhuLHMuc2hvd0RlbGV0ZSl9fSksZS4kd2F0Y2goZnVuY3Rpb24oKXtyZXR1cm4gcy5zaG93UmVvcmRlcigpfSxmdW5jdGlvbihlLHQpe2lmKGV8fHQpe2UmJnMuY2xvc2VPcHRpb25CdXR0b25zKCkscy5jYW5Td2lwZUl0ZW1zKCFlKSxpLmNoaWxkcmVuKCkudG9nZ2xlQ2xhc3MoXCJsaXN0LXJpZ2h0LWVkaXRpbmdcIixlKSxpLnRvZ2dsZUNsYXNzKFwiZGlzYWJsZS1wb2ludGVyLWV2ZW50c1wiLGUpO3ZhciBuPXYoaVswXS5nZXRFbGVtZW50c0J5Q2xhc3NOYW1lKFwiaXRlbS1yZW9yZGVyXCIpKTtvKG4scy5zaG93UmVvcmRlcil9fSl9dmFyIHM9clswXSxjPXJbMV07dChhKX19fX1dKSx1LmRpcmVjdGl2ZShcIm1lbnVDbG9zZVwiLFtcIiRpb25pY1ZpZXdTZXJ2aWNlXCIsZnVuY3Rpb24oKXtyZXR1cm57cmVzdHJpY3Q6XCJBQ1wiLHJlcXVpcmU6XCJeaW9uU2lkZU1lbnVzXCIsbGluazpmdW5jdGlvbihlLHQsbixpKXt0LmJpbmQoXCJjbGlja1wiLGZ1bmN0aW9uKCl7aS5jbG9zZSgpfSl9fX1dKSx1LmRpcmVjdGl2ZShcIm1lbnVUb2dnbGVcIixbXCIkaW9uaWNWaWV3U2VydmljZVwiLGZ1bmN0aW9uKCl7cmV0dXJue3Jlc3RyaWN0OlwiQUNcIixyZXF1aXJlOlwiXmlvblNpZGVNZW51c1wiLGxpbms6ZnVuY3Rpb24oZSx0LG4saSl7dmFyIG89bi5tZW51VG9nZ2xlfHxcImxlZnRcIjt0LmJpbmQoXCJjbGlja1wiLGZ1bmN0aW9uKCl7XCJsZWZ0XCI9PT1vP2kudG9nZ2xlTGVmdCgpOlwicmlnaHRcIj09PW8mJmkudG9nZ2xlUmlnaHQoKX0pfX19XSksdS5kaXJlY3RpdmUoXCJpb25Nb2RhbFwiLFtmdW5jdGlvbigpe3JldHVybntyZXN0cmljdDpcIkVcIix0cmFuc2NsdWRlOiEwLHJlcGxhY2U6ITAsY29udHJvbGxlcjpbZnVuY3Rpb24oKXt9XSx0ZW1wbGF0ZTonPGRpdiBjbGFzcz1cIm1vZGFsLWJhY2tkcm9wXCI+PGRpdiBjbGFzcz1cIm1vZGFsLXdyYXBwZXJcIiBuZy10cmFuc2NsdWRlPjwvZGl2PjwvZGl2Pid9fV0pLHUuZGlyZWN0aXZlKFwiaW9uTW9kYWxWaWV3XCIsZnVuY3Rpb24oKXtyZXR1cm57cmVzdHJpY3Q6XCJFXCIsY29tcGlsZTpmdW5jdGlvbihlKXtlLmFkZENsYXNzKFwibW9kYWxcIil9fX0pLHUuZGlyZWN0aXZlKFwiaW9uTmF2QmFja0J1dHRvblwiLFtcIiRhbmltYXRlXCIsXCIkcm9vdFNjb3BlXCIsXCIkc2FuaXRpemVcIixcIiRpb25pY05hdkJhckNvbmZpZ1wiLFwiJGlvbmljTmdDbGlja1wiLGZ1bmN0aW9uKGUsdCxuLGksbyl7dmFyIHI9ITE7cmV0dXJuIHQuJG9uKFwiJHZpZXdIaXN0b3J5Lmhpc3RvcnlDaGFuZ2VcIixmdW5jdGlvbihlLHQpe3I9ISF0LnNob3dCYWNrfSkse3Jlc3RyaWN0OlwiRVwiLHJlcXVpcmU6XCJeaW9uTmF2QmFyXCIsY29tcGlsZTpmdW5jdGlvbih0KXt0LmFkZENsYXNzKFwiYnV0dG9uIGJhY2stYnV0dG9uIG5nLWhpZGVcIik7dmFyIGE9ISEodC5odG1sKCl8fFwiXCIpLm1hdGNoKC9jbGFzcz0uKj9pb24tLyk7cmV0dXJuIGZ1bmN0aW9uKHQscyxjLGwpe2F8fC0xIT09c1swXS5jbGFzc05hbWUuaW5kZXhPZihcImlvbi1cIil8fHMuYWRkQ2xhc3MoaS5iYWNrQnV0dG9uSWNvbiksaChjLm5nQ2xpY2spfHxvKHQscyxsLmJhY2spLHQuJHdhdGNoKGZ1bmN0aW9uKCl7cmV0dXJuIGgoYy5mcm9tVGl0bGUpJiYoc1swXS5pbm5lckhUTUw9JzxzcGFuIGNsYXNzPVwiYmFjay1idXR0b24tdGl0bGVcIj4nK24odC5vbGRUaXRsZSkrXCI8L3NwYW4+XCIpLCEoIXJ8fCF0LmJhY2tCdXR0b25TaG93bil9LGlvbmljLmFuaW1hdGlvbkZyYW1lVGhyb3R0bGUoZnVuY3Rpb24odCl7dD9lLnJlbW92ZUNsYXNzKHMsXCJuZy1oaWRlXCIpOmUuYWRkQ2xhc3MocyxcIm5nLWhpZGVcIil9KSl9fX19XSksdS5jb25zdGFudChcIiRpb25pY05hdkJhckNvbmZpZ1wiLHt0cmFuc2l0aW9uOlwibmF2LXRpdGxlLXNsaWRlLWlvczdcIixhbGlnblRpdGxlOlwiY2VudGVyXCIsYmFja0J1dHRvbkljb246XCJpb24taW9zNy1hcnJvdy1iYWNrXCJ9KSx1LmRpcmVjdGl2ZShcImlvbk5hdkJhclwiLFtcIiRpb25pY1ZpZXdTZXJ2aWNlXCIsXCIkcm9vdFNjb3BlXCIsXCIkYW5pbWF0ZVwiLFwiJGNvbXBpbGVcIixcIiRpb25pY05hdkJhckNvbmZpZ1wiLGZ1bmN0aW9uKGUsdCxuLGksbyl7cmV0dXJue3Jlc3RyaWN0OlwiRVwiLGNvbnRyb2xsZXI6XCIkaW9uaWNOYXZCYXJcIixzY29wZTohMCxjb21waWxlOmZ1bmN0aW9uKGUsdCl7ZnVuY3Rpb24gbihlLHQsbixpKXtpLl9oZWFkZXJCYXJWaWV3PW5ldyBpb25pYy52aWV3cy5IZWFkZXJCYXIoe2VsOnRbMF0sYWxpZ25UaXRsZTpuLmFsaWduVGl0bGV8fG8uYWxpZ25UaXRsZXx8XCJjZW50ZXJcIn0pLGUuYmFja0J1dHRvblNob3duPSExLGUuc2hvdWxkQW5pbWF0ZT0hMCxlLmlzUmV2ZXJzZT0hMSxlLmlzSW52aXNpYmxlPSEwLGUuJG9uKFwiJGRlc3Ryb3lcIixmdW5jdGlvbigpe2UuJHBhcmVudC4kaGFzSGVhZGVyPSExfSksZS4kd2F0Y2goZnVuY3Rpb24oKXtyZXR1cm4oZS5pc1JldmVyc2U/XCIgcmV2ZXJzZVwiOlwiXCIpKyhlLmlzSW52aXNpYmxlP1wiIGludmlzaWJsZVwiOlwiXCIpKyhlLnNob3VsZEFuaW1hdGU/XCJcIjpcIiBuby1hbmltYXRpb25cIil9LGZ1bmN0aW9uKGUsbil7dC5yZW1vdmVDbGFzcyhuKSx0LmFkZENsYXNzKGUpfSl9cmV0dXJuIGUuYWRkQ2xhc3MoXCJiYXIgYmFyLWhlYWRlciBuYXYtYmFyXCIpLmFwcGVuZCgnPGRpdiBjbGFzcz1cImJ1dHRvbnMgbGVmdC1idXR0b25zXCI+IDwvZGl2PjxoMSBuZy1iaW5kLWh0bWw9XCJ0aXRsZVwiIGNsYXNzPVwidGl0bGVcIj48L2gxPjxkaXYgY2xhc3M9XCJidXR0b25zIHJpZ2h0LWJ1dHRvbnNcIj4gPC9kaXY+JyksZS5hZGRDbGFzcyhoKHQuYW5pbWF0aW9uKT90LmFuaW1hdGlvbjpvLnRyYW5zaXRpb24pLHtwcmU6bn19fX1dKSx1LmRpcmVjdGl2ZShcImlvbk5hdkJ1dHRvbnNcIixbXCIkY29tcGlsZVwiLFwiJGFuaW1hdGVcIixmdW5jdGlvbihlLHQpe3JldHVybntyZXF1aXJlOlwiXmlvbk5hdkJhclwiLHJlc3RyaWN0OlwiRVwiLGNvbXBpbGU6ZnVuY3Rpb24obil7dmFyIGk9bi5jb250ZW50cygpLnJlbW92ZSgpO1xucmV0dXJuIGZ1bmN0aW9uKG4sbyxyLGEpe3ZhciBzPVwicmlnaHRcIj09PXIuc2lkZT9hLnJpZ2h0QnV0dG9uc0VsZW1lbnQ6YS5sZWZ0QnV0dG9uc0VsZW1lbnQsYz12KFwiPHNwYW4+XCIpLmFwcGVuZChpKTtvLmFwcGVuZChjKSxlKGMpKG4pLGlvbmljLnJlcXVlc3RBbmltYXRpb25GcmFtZShmdW5jdGlvbigpe24uJCRkZXN0cm95ZWR8fHQuZW50ZXIoYyxzKX0pLG4uJG9uKFwiJGRlc3Ryb3lcIixmdW5jdGlvbigpe3QubGVhdmUoYyl9KSxvLmNzcyhcImRpc3BsYXlcIixcIm5vbmVcIil9fX19XSksdS5kaXJlY3RpdmUoXCJuYXZDbGVhclwiLFtcIiRpb25pY1ZpZXdTZXJ2aWNlXCIsXCIkc3RhdGVcIixcIiRsb2NhdGlvblwiLFwiJHdpbmRvd1wiLFwiJHJvb3RTY29wZVwiLGZ1bmN0aW9uKGUsdCxuLGksbyl7cmV0dXJuIG8uJG9uKFwiJHN0YXRlQ2hhbmdlRXJyb3JcIixmdW5jdGlvbigpe2UubmV4dFZpZXdPcHRpb25zKG51bGwpfSkse3ByaW9yaXR5OjEwMCxyZXN0cmljdDpcIkFDXCIsY29tcGlsZTpmdW5jdGlvbigpe2Z1bmN0aW9uIHQodCxuKXtmdW5jdGlvbiBvKCl7cj10LiRvbihcIiRzdGF0ZUNoYW5nZVN0YXJ0XCIsZnVuY3Rpb24oKXtlLm5leHRWaWV3T3B0aW9ucyh7ZGlzYWJsZUFuaW1hdGU6ITAsZGlzYWJsZUJhY2s6ITB9KSxyKCl9KSxpLnNldFRpbWVvdXQociwzMDApfXZhciByO24ub24oXCJjbGlja1wiLG8pfXJldHVybntwcmU6dH19fX1dKSx1LmNvbnN0YW50KFwiJGlvbmljTmF2Vmlld0NvbmZpZ1wiLHt0cmFuc2l0aW9uOlwic2xpZGUtbGVmdC1yaWdodC1pb3M3XCJ9KSx1LmRpcmVjdGl2ZShcImlvbk5hdlZpZXdcIixbXCIkaW9uaWNWaWV3U2VydmljZVwiLFwiJHN0YXRlXCIsXCIkY29tcGlsZVwiLFwiJGNvbnRyb2xsZXJcIixcIiRhbmltYXRlXCIsZnVuY3Rpb24oZSx0LG4saSxvKXt2YXIgcj0hMSxhPXtyZXN0cmljdDpcIkVcIix0ZXJtaW5hbDohMCxwcmlvcml0eToyZTMsdHJhbnNjbHVkZTohMCxjb250cm9sbGVyOmZ1bmN0aW9uKCl7fSxjb21waWxlOmZ1bmN0aW9uKHMsYyxsKXtyZXR1cm4gZnVuY3Rpb24ocyxjLHUpe2Z1bmN0aW9uIGQocil7by5lbmFibGVkKCk9PT0hMSYmKHI9ITEpO3ZhciBhPXQuJGN1cnJlbnQmJnQuJGN1cnJlbnQubG9jYWxzW3BdO2lmKGEhPT1oKXt2YXIgbD1lLmdldFJlbmRlcmVyKGMsdSxzKTtpZihmJiYoZi4kZGVzdHJveSgpLGY9bnVsbCksIWEpcmV0dXJuIGg9bnVsbCx3LnN0YXRlPW51bGwsYy5hcHBlbmQobSk7dmFyIGQ9dihcIjxkaXY+PC9kaXY+XCIpLmh0bWwoYS4kdGVtcGxhdGUpLmNvbnRlbnRzKCksJD1sKCkucmVnaXN0ZXIoZCk7bChyKS5sZWF2ZSgpLGg9YSx3LnN0YXRlPWEuJCRzdGF0ZSxsKHIpLmVudGVyKGQpO3ZhciBiPW4oZCk7aWYoZj1zLiRuZXcoKSxmLiRuYXZEaXJlY3Rpb249JC5uYXZEaXJlY3Rpb24sYS4kJGNvbnRyb2xsZXIpe2EuJHNjb3BlPWY7dmFyIHk9aShhLiQkY29udHJvbGxlcixhKTtjLmNoaWxkcmVuKCkuZGF0YShcIiRuZ0NvbnRyb2xsZXJDb250cm9sbGVyXCIseSl9YihmKTt2YXIgUz1lLl9nZXRWaWV3QnlJZCgkLnZpZXdJZCl8fHt9O2YuJGJyb2FkY2FzdChcIiR2aWV3Q29udGVudExvYWRlZFwiLFMpLGcmJmYuJGV2YWwoZyksZD1udWxsfX12YXIgZixoLHA9dVthLm5hbWVdfHx1Lm5hbWV8fFwiXCIsZz11Lm9ubG9hZHx8XCJcIixtPWwocyk7Yy5hcHBlbmQobSk7dmFyICQ9Yy5wYXJlbnQoKS5pbmhlcml0ZWREYXRhKFwiJHVpVmlld1wiKTtwLmluZGV4T2YoXCJAXCIpPDAmJihwPXArXCJAXCIrKCQmJiQuc3RhdGU/JC5zdGF0ZS5uYW1lOlwiXCIpKTt2YXIgdz17bmFtZTpwLHN0YXRlOm51bGx9O2MuZGF0YShcIiR1aVZpZXdcIix3KTt2YXIgYj1mdW5jdGlvbigpe2lmKCFyKXtyPSEwO3RyeXtkKCEwKX1jYXRjaChlKXt0aHJvdyByPSExLGV9cj0hMX19O3MuJG9uKFwiJHN0YXRlQ2hhbmdlU3VjY2Vzc1wiLGIpLGQoITEpfX19O3JldHVybiBhfV0pLHUuY29uZmlnKFtcIiRwcm92aWRlXCIsZnVuY3Rpb24oZSl7ZS5kZWNvcmF0b3IoXCJuZ0NsaWNrRGlyZWN0aXZlXCIsW1wiJGRlbGVnYXRlXCIsZnVuY3Rpb24oZSl7cmV0dXJuIGUuc2hpZnQoKSxlfV0pfV0pLmZhY3RvcnkoXCIkaW9uaWNOZ0NsaWNrXCIsW1wiJHBhcnNlXCIsZnVuY3Rpb24oZSl7cmV0dXJuIGZ1bmN0aW9uKHQsbixpKXt2YXIgbz1hbmd1bGFyLmlzRnVuY3Rpb24oaSk/aTplKGkpO24ub24oXCJjbGlja1wiLGZ1bmN0aW9uKGUpe3QuJGFwcGx5KGZ1bmN0aW9uKCl7byh0LHskZXZlbnQ6ZX0pfSl9KSxuLm9uY2xpY2s9ZnVuY3Rpb24oKXt9fX1dKS5kaXJlY3RpdmUoXCJuZ0NsaWNrXCIsW1wiJGlvbmljTmdDbGlja1wiLGZ1bmN0aW9uKGUpe3JldHVybiBmdW5jdGlvbih0LG4saSl7ZSh0LG4saS5uZ0NsaWNrKX19XSkuZGlyZWN0aXZlKFwiaW9uU3RvcEV2ZW50XCIsZnVuY3Rpb24oKXtyZXR1cm57cmVzdHJpY3Q6XCJBXCIsbGluazpmdW5jdGlvbihlLHQsbil7dC5iaW5kKG4uaW9uU3RvcEV2ZW50LGMpfX19KSx1LmRpcmVjdGl2ZShcImlvblBhbmVcIixmdW5jdGlvbigpe3JldHVybntyZXN0cmljdDpcIkVcIixsaW5rOmZ1bmN0aW9uKGUsdCl7dC5hZGRDbGFzcyhcInBhbmVcIil9fX0pLHUuZGlyZWN0aXZlKFwiaW9uUG9wb3ZlclwiLFtmdW5jdGlvbigpe3JldHVybntyZXN0cmljdDpcIkVcIix0cmFuc2NsdWRlOiEwLHJlcGxhY2U6ITAsY29udHJvbGxlcjpbZnVuY3Rpb24oKXt9XSx0ZW1wbGF0ZTonPGRpdiBjbGFzcz1cInBvcG92ZXItYmFja2Ryb3BcIj48ZGl2IGNsYXNzPVwicG9wb3Zlci13cmFwcGVyXCIgbmctdHJhbnNjbHVkZT48L2Rpdj48L2Rpdj4nfX1dKSx1LmRpcmVjdGl2ZShcImlvblBvcG92ZXJWaWV3XCIsZnVuY3Rpb24oKXtyZXR1cm57cmVzdHJpY3Q6XCJFXCIsY29tcGlsZTpmdW5jdGlvbihlKXtlLmFwcGVuZChhbmd1bGFyLmVsZW1lbnQoJzxkaXYgY2xhc3M9XCJwb3BvdmVyLWFycm93XCI+PC9kaXY+JykpLGUuYWRkQ2xhc3MoXCJwb3BvdmVyXCIpfX19KSx1LmRpcmVjdGl2ZShcImlvblJhZGlvXCIsZnVuY3Rpb24oKXtyZXR1cm57cmVzdHJpY3Q6XCJFXCIscmVwbGFjZTohMCxyZXF1aXJlOlwiP25nTW9kZWxcIix0cmFuc2NsdWRlOiEwLHRlbXBsYXRlOic8bGFiZWwgY2xhc3M9XCJpdGVtIGl0ZW0tcmFkaW9cIj48aW5wdXQgdHlwZT1cInJhZGlvXCIgbmFtZT1cInJhZGlvLWdyb3VwXCI+PGRpdiBjbGFzcz1cIml0ZW0tY29udGVudCBkaXNhYmxlLXBvaW50ZXItZXZlbnRzXCIgbmctdHJhbnNjbHVkZT48L2Rpdj48aSBjbGFzcz1cInJhZGlvLWljb24gZGlzYWJsZS1wb2ludGVyLWV2ZW50cyBpY29uIGlvbi1jaGVja21hcmtcIj48L2k+PC9sYWJlbD4nLGNvbXBpbGU6ZnVuY3Rpb24oZSx0KXt0Lmljb24mJmUuY2hpbGRyZW4oKS5lcSgyKS5yZW1vdmVDbGFzcyhcImlvbi1jaGVja21hcmtcIikuYWRkQ2xhc3ModC5pY29uKTt2YXIgbj1lLmZpbmQoXCJpbnB1dFwiKTtyZXR1cm4gZih7bmFtZTp0Lm5hbWUsdmFsdWU6dC52YWx1ZSxkaXNhYmxlZDp0LmRpc2FibGVkLFwibmctdmFsdWVcIjp0Lm5nVmFsdWUsXCJuZy1tb2RlbFwiOnQubmdNb2RlbCxcIm5nLWRpc2FibGVkXCI6dC5uZ0Rpc2FibGVkLFwibmctY2hhbmdlXCI6dC5uZ0NoYW5nZX0sZnVuY3Rpb24oZSx0KXtoKGUpJiZuLmF0dHIodCxlKX0pLGZ1bmN0aW9uKGUsdCxuKXtlLmdldFZhbHVlPWZ1bmN0aW9uKCl7cmV0dXJuIGUubmdWYWx1ZXx8bi52YWx1ZX19fX19KSx1LmRpcmVjdGl2ZShcImlvblJlZnJlc2hlclwiLFtcIiRpb25pY0JpbmRcIixmdW5jdGlvbihlKXtyZXR1cm57cmVzdHJpY3Q6XCJFXCIscmVwbGFjZTohMCxyZXF1aXJlOlwiXiRpb25pY1Njcm9sbFwiLHRlbXBsYXRlOic8ZGl2IGNsYXNzPVwic2Nyb2xsLXJlZnJlc2hlclwiIGNvbGxlY3Rpb24tcmVwZWF0LWlnbm9yZT48ZGl2IGNsYXNzPVwiaW9uaWMtcmVmcmVzaGVyLWNvbnRlbnRcIiBuZy1jbGFzcz1cIntcXCdpb25pYy1yZWZyZXNoZXItd2l0aC10ZXh0XFwnOiBwdWxsaW5nVGV4dCB8fCByZWZyZXNoaW5nVGV4dH1cIj48ZGl2IGNsYXNzPVwiaWNvbi1wdWxsaW5nXCIgbmctY2xhc3M9XCJ7XFwncHVsbGluZy1yb3RhdGlvbi1kaXNhYmxlZFxcJzpkaXNhYmxlUHVsbGluZ1JvdGF0aW9ufVwiPjxpIGNsYXNzPVwiaWNvbiB7e3B1bGxpbmdJY29ufX1cIj48L2k+PC9kaXY+PGRpdiBjbGFzcz1cInRleHQtcHVsbGluZ1wiIG5nLWJpbmQtaHRtbD1cInB1bGxpbmdUZXh0XCI+PC9kaXY+PGkgY2xhc3M9XCJpY29uIHt7cmVmcmVzaGluZ0ljb259fSBpY29uLXJlZnJlc2hpbmdcIj48L2k+PGRpdiBjbGFzcz1cInRleHQtcmVmcmVzaGluZ1wiIG5nLWJpbmQtaHRtbD1cInJlZnJlc2hpbmdUZXh0XCI+PC9kaXY+PC9kaXY+PC9kaXY+Jyxjb21waWxlOmZ1bmN0aW9uKHQsbil7cmV0dXJuIGFuZ3VsYXIuaXNVbmRlZmluZWQobi5wdWxsaW5nSWNvbikmJm4uJHNldChcInB1bGxpbmdJY29uXCIsXCJpb24taW9zNy1hcnJvdy1kb3duXCIpLGFuZ3VsYXIuaXNVbmRlZmluZWQobi5yZWZyZXNoaW5nSWNvbikmJm4uJHNldChcInJlZnJlc2hpbmdJY29uXCIsXCJpb24tbG9hZGluZy1kXCIpLGZ1bmN0aW9uKHQsbixpLG8pe2UodCxpLHtwdWxsaW5nSWNvbjpcIkBcIixwdWxsaW5nVGV4dDpcIkBcIixyZWZyZXNoaW5nSWNvbjpcIkBcIixyZWZyZXNoaW5nVGV4dDpcIkBcIixkaXNhYmxlUHVsbGluZ1JvdGF0aW9uOlwiQFwiLCRvblJlZnJlc2g6XCImb25SZWZyZXNoXCIsJG9uUHVsbGluZzpcIiZvblB1bGxpbmdcIn0pLG8uX3NldFJlZnJlc2hlcih0LG5bMF0pLHQuJG9uKFwic2Nyb2xsLnJlZnJlc2hDb21wbGV0ZVwiLGZ1bmN0aW9uKCl7dC4kZXZhbEFzeW5jKGZ1bmN0aW9uKCl7by5zY3JvbGxWaWV3LmZpbmlzaFB1bGxUb1JlZnJlc2goKX0pfSl9fX19XSksdS5kaXJlY3RpdmUoXCJpb25TY3JvbGxcIixbXCIkdGltZW91dFwiLFwiJGNvbnRyb2xsZXJcIixcIiRpb25pY0JpbmRcIixmdW5jdGlvbihlLHQsbil7cmV0dXJue3Jlc3RyaWN0OlwiRVwiLHNjb3BlOiEwLGNvbnRyb2xsZXI6ZnVuY3Rpb24oKXt9LGNvbXBpbGU6ZnVuY3Rpb24oZSl7ZnVuY3Rpb24gaShlLGkscil7dmFyIGEscztuKGUscix7ZGlyZWN0aW9uOlwiQFwiLHBhZ2luZzpcIkBcIiwkb25TY3JvbGw6XCImb25TY3JvbGxcIixzY3JvbGw6XCJAXCIsc2Nyb2xsYmFyWDpcIkBcIixzY3JvbGxiYXJZOlwiQFwiLHpvb21pbmc6XCJAXCIsbWluWm9vbTpcIkBcIixtYXhab29tOlwiQFwifSksZS5kaXJlY3Rpb249ZS5kaXJlY3Rpb258fFwieVwiLGFuZ3VsYXIuaXNEZWZpbmVkKHIucGFkZGluZykmJmUuJHdhdGNoKHIucGFkZGluZyxmdW5jdGlvbihlKXtvLnRvZ2dsZUNsYXNzKFwicGFkZGluZ1wiLCEhZSl9KSxlLiRldmFsKGUucGFnaW5nKT09PSEwJiZvLmFkZENsYXNzKFwic2Nyb2xsLXBhZ2luZ1wiKSxlLmRpcmVjdGlvbnx8KGUuZGlyZWN0aW9uPVwieVwiKTt2YXIgYz1lLiRldmFsKGUucGFnaW5nKT09PSEwLGw9e2VsOmlbMF0sZGVsZWdhdGVIYW5kbGU6ci5kZWxlZ2F0ZUhhbmRsZSxsb2NraW5nOlwidHJ1ZVwiPT09KHIubG9ja2luZ3x8XCJ0cnVlXCIpLGJvdW5jaW5nOmUuJGV2YWwoci5oYXNCb3VuY2luZykscGFnaW5nOmMsc2Nyb2xsYmFyWDplLiRldmFsKGUuc2Nyb2xsYmFyWCkhPT0hMSxzY3JvbGxiYXJZOmUuJGV2YWwoZS5zY3JvbGxiYXJZKSE9PSExLHNjcm9sbGluZ1g6ZS5kaXJlY3Rpb24uaW5kZXhPZihcInhcIik+PTAsc2Nyb2xsaW5nWTplLmRpcmVjdGlvbi5pbmRleE9mKFwieVwiKT49MCx6b29taW5nOmUuJGV2YWwoZS56b29taW5nKT09PSEwLG1heFpvb206ZS4kZXZhbChlLm1heFpvb20pfHwzLG1pblpvb206ZS4kZXZhbChlLm1pblpvb20pfHwuNX07YyYmKGwuc3BlZWRNdWx0aXBsaWVyPS44LGwuYm91bmNpbmc9ITEpLHM9dChcIiRpb25pY1Njcm9sbFwiLHskc2NvcGU6ZSxzY3JvbGxWaWV3T3B0aW9uczpsfSksYT1lLiRwYXJlbnQuc2Nyb2xsVmlldz1zLnNjcm9sbFZpZXd9ZS5hZGRDbGFzcyhcInNjcm9sbC12aWV3IGlvbmljLXNjcm9sbFwiKTt2YXIgbz12KCc8ZGl2IGNsYXNzPVwic2Nyb2xsXCI+PC9kaXY+Jyk7cmV0dXJuIG8uYXBwZW5kKGUuY29udGVudHMoKSksZS5hcHBlbmQobykse3ByZTppfX19fV0pLHUuZGlyZWN0aXZlKFwiaW9uU2lkZU1lbnVcIixmdW5jdGlvbigpe3JldHVybntyZXN0cmljdDpcIkVcIixyZXF1aXJlOlwiXmlvblNpZGVNZW51c1wiLHNjb3BlOiEwLGNvbXBpbGU6ZnVuY3Rpb24oZSx0KXtyZXR1cm4gYW5ndWxhci5pc1VuZGVmaW5lZCh0LmlzRW5hYmxlZCkmJnQuJHNldChcImlzRW5hYmxlZFwiLFwidHJ1ZVwiKSxhbmd1bGFyLmlzVW5kZWZpbmVkKHQud2lkdGgpJiZ0LiRzZXQoXCJ3aWR0aFwiLFwiMjc1XCIpLGUuYWRkQ2xhc3MoXCJtZW51IG1lbnUtXCIrdC5zaWRlKSxmdW5jdGlvbihlLG4saSxvKXtlLnNpZGU9aS5zaWRlfHxcImxlZnRcIjt2YXIgcj1vW2Uuc2lkZV09bmV3IGlvbmljLnZpZXdzLlNpZGVNZW51KHt3aWR0aDp0LndpZHRoLGVsOm5bMF0saXNFbmFibGVkOiEwfSk7ZS4kd2F0Y2goaS53aWR0aCxmdW5jdGlvbihlKXt2YXIgdD0rZTt0JiZ0PT1lJiZyLnNldFdpZHRoKCtlKX0pLGUuJHdhdGNoKGkuaXNFbmFibGVkLGZ1bmN0aW9uKGUpe3Iuc2V0SXNFbmFibGVkKCEhZSl9KX19fX0pLHUuZGlyZWN0aXZlKFwiaW9uU2lkZU1lbnVDb250ZW50XCIsW1wiJHRpbWVvdXRcIixcIiRpb25pY0dlc3R1cmVcIixcIiR3aW5kb3dcIixmdW5jdGlvbihlLHQsbil7cmV0dXJue3Jlc3RyaWN0OlwiRUFcIixyZXF1aXJlOlwiXmlvblNpZGVNZW51c1wiLHNjb3BlOiEwLGNvbXBpbGU6ZnVuY3Rpb24oaSxvKXtmdW5jdGlvbiByKHIsYSxzLGMpe2Z1bmN0aW9uIGwoZSl7MCE9PWMuZ2V0T3BlbkFtb3VudCgpPyhjLmNsb3NlKCksZS5nZXN0dXJlLnNyY0V2ZW50LnByZXZlbnREZWZhdWx0KCksdj1udWxsLGc9bnVsbCk6dnx8KHY9aW9uaWMudGFwLnBvaW50ZXJDb29yZChlLmdlc3R1cmUuc3JjRXZlbnQpKX1mdW5jdGlvbiB1KGUpe2MuaXNEcmFnZ2FibGVUYXJnZXQoZSkmJlwieFwiPT1wKGUpJiYoYy5faGFuZGxlRHJhZyhlKSxlLmdlc3R1cmUuc3JjRXZlbnQucHJldmVudERlZmF1bHQoKSl9ZnVuY3Rpb24gZChlKXtcInhcIj09cChlKSYmZS5nZXN0dXJlLnNyY0V2ZW50LnByZXZlbnREZWZhdWx0KCl9ZnVuY3Rpb24gZihlKXtjLl9lbmREcmFnKGUpLHY9bnVsbCxnPW51bGx9ZnVuY3Rpb24gcChlKXtpZihnKXJldHVybiBnO2lmKGUmJmUuZ2VzdHVyZSl7aWYodil7dmFyIHQ9aW9uaWMudGFwLnBvaW50ZXJDb29yZChlLmdlc3R1cmUuc3JjRXZlbnQpLG49TWF0aC5hYnModC54LXYueCksaT1NYXRoLmFicyh0Lnktdi55KSxvPWk+bj9cInlcIjpcInhcIjtyZXR1cm4gTWF0aC5tYXgobixpKT4zMCYmKGc9byksb312PWlvbmljLnRhcC5wb2ludGVyQ29vcmQoZS5nZXN0dXJlLnNyY0V2ZW50KX1yZXR1cm5cInhcIn12YXIgdj1udWxsLGc9bnVsbDthLmFkZENsYXNzKFwibWVudS1jb250ZW50IHBhbmVcIiksaChvLmRyYWdDb250ZW50KT9yLiR3YXRjaChvLmRyYWdDb250ZW50LGZ1bmN0aW9uKGUpe2MuY2FuRHJhZ0NvbnRlbnQoZSl9KTpjLmNhbkRyYWdDb250ZW50KCEwKSxoKG8uZWRnZURyYWdUaHJlc2hvbGQpJiZyLiR3YXRjaChvLmVkZ2VEcmFnVGhyZXNob2xkLGZ1bmN0aW9uKGUpe2MuZWRnZURyYWdUaHJlc2hvbGQoZSl9KTt2YXIgbT17ZWxlbWVudDppWzBdLG9uRHJhZzpmdW5jdGlvbigpe30sZW5kRHJhZzpmdW5jdGlvbigpe30sZ2V0VHJhbnNsYXRlWDpmdW5jdGlvbigpe3JldHVybiByLnNpZGVNZW51Q29udGVudFRyYW5zbGF0ZVh8fDB9LHNldFRyYW5zbGF0ZVg6aW9uaWMuYW5pbWF0aW9uRnJhbWVUaHJvdHRsZShmdW5jdGlvbih0KXt2YXIgbj1tLm9mZnNldFgrdDthWzBdLnN0eWxlW2lvbmljLkNTUy5UUkFOU0ZPUk1dPVwidHJhbnNsYXRlM2QoXCIrbitcInB4LDAsMClcIixlKGZ1bmN0aW9uKCl7ci5zaWRlTWVudUNvbnRlbnRUcmFuc2xhdGVYPXR9KX0pLHNldE1hcmdpbkxlZnQ6aW9uaWMuYW5pbWF0aW9uRnJhbWVUaHJvdHRsZShmdW5jdGlvbihlKXtlPyhlPXBhcnNlSW50KGUsMTApLGFbMF0uc3R5bGVbaW9uaWMuQ1NTLlRSQU5TRk9STV09XCJ0cmFuc2xhdGUzZChcIitlK1wicHgsMCwwKVwiLGFbMF0uc3R5bGUud2lkdGg9bi5pbm5lcldpZHRoLWUrXCJweFwiLG0ub2Zmc2V0WD1lKTooYVswXS5zdHlsZVtpb25pYy5DU1MuVFJBTlNGT1JNXT1cInRyYW5zbGF0ZTNkKDAsMCwwKVwiLGFbMF0uc3R5bGUud2lkdGg9XCJcIixtLm9mZnNldFg9MCl9KSxlbmFibGVBbmltYXRpb246ZnVuY3Rpb24oKXtyLmFuaW1hdGlvbkVuYWJsZWQ9ITAsYVswXS5jbGFzc0xpc3QuYWRkKFwibWVudS1hbmltYXRlZFwiKX0sZGlzYWJsZUFuaW1hdGlvbjpmdW5jdGlvbigpe3IuYW5pbWF0aW9uRW5hYmxlZD0hMSxhWzBdLmNsYXNzTGlzdC5yZW1vdmUoXCJtZW51LWFuaW1hdGVkXCIpfSxvZmZzZXRYOjB9O2Muc2V0Q29udGVudChtKTt2YXIgJD17c3RvcF9icm93c2VyX2JlaGF2aW9yOiExfSx3PXQub24oXCJ0YXBcIixsLGEsJCksYj10Lm9uKFwiZHJhZ3JpZ2h0XCIsdSxhLCQpLHk9dC5vbihcImRyYWdsZWZ0XCIsdSxhLCQpLFM9dC5vbihcImRyYWd1cFwiLGQsYSwkKSxDPXQub24oXCJkcmFnZG93blwiLGQsYSwkKSxrPXQub24oXCJyZWxlYXNlXCIsZixhLCQpO3IuJG9uKFwiJGRlc3Ryb3lcIixmdW5jdGlvbigpe3Qub2ZmKHksXCJkcmFnbGVmdFwiLHUpLHQub2ZmKGIsXCJkcmFncmlnaHRcIix1KSx0Lm9mZihTLFwiZHJhZ3VwXCIsZCksdC5vZmYoQyxcImRyYWdkb3duXCIsZCksdC5vZmYoayxcInJlbGVhc2VcIixmKSx0Lm9mZih3LFwidGFwXCIsbCl9KX1yZXR1cm57cHJlOnJ9fX19XSksdS5kaXJlY3RpdmUoXCJpb25TaWRlTWVudXNcIixbXCIkaW9uaWNCb2R5XCIsZnVuY3Rpb24oZSl7cmV0dXJue3Jlc3RyaWN0OlwiRUNBXCIsY29udHJvbGxlcjpcIiRpb25pY1NpZGVNZW51c1wiLGNvbXBpbGU6ZnVuY3Rpb24odCxuKXtmdW5jdGlvbiBpKHQpe3QuJG9uKFwiJGlvbmljRXhwb3NlQXNpZGVcIixmdW5jdGlvbihuLGkpe3QuJGV4cG9zZUFzaWRlfHwodC4kZXhwb3NlQXNpZGU9e30pLHQuJGV4cG9zZUFzaWRlLmFjdGl2ZT1pLGUuZW5hYmxlQ2xhc3MoaSxcImFzaWRlLW9wZW5cIil9KSx0LiRvbihcIiRkZXN0cm95XCIsZnVuY3Rpb24oKXtlLnJlbW92ZUNsYXNzKFwibWVudS1vcGVuXCIsXCJhc2lkZS1vcGVuXCIpfSl9cmV0dXJuIG4uJHNldChcImNsYXNzXCIsKG5bXCJjbGFzc1wiXXx8XCJcIikrXCIgdmlld1wiKSx7cHJlOml9fX19XSksdS5kaXJlY3RpdmUoXCJpb25TbGlkZUJveFwiLFtcIiR0aW1lb3V0XCIsXCIkY29tcGlsZVwiLFwiJGlvbmljU2xpZGVCb3hEZWxlZ2F0ZVwiLGZ1bmN0aW9uKGUsdCxuKXtyZXR1cm57cmVzdHJpY3Q6XCJFXCIscmVwbGFjZTohMCx0cmFuc2NsdWRlOiEwLHNjb3BlOnthdXRvUGxheTpcIj1cIixkb2VzQ29udGludWU6XCJAXCIsc2xpZGVJbnRlcnZhbDpcIkBcIixzaG93UGFnZXI6XCJAXCIscGFnZXJDbGljazpcIiZcIixkaXNhYmxlU2Nyb2xsOlwiQFwiLG9uU2xpZGVDaGFuZ2VkOlwiJlwiLGFjdGl2ZVNsaWRlOlwiPT9cIn0sY29udHJvbGxlcjpbXCIkc2NvcGVcIixcIiRlbGVtZW50XCIsXCIkYXR0cnNcIixmdW5jdGlvbih0LGksbyl7dmFyIHI9dC4kZXZhbCh0LmRvZXNDb250aW51ZSk9PT0hMCxhPWgoby5hdXRvUGxheSk/ISF0LmF1dG9QbGF5OiExLHM9YT90LiRldmFsKHQuc2xpZGVJbnRlcnZhbCl8fDRlMzowLGM9bmV3IGlvbmljLnZpZXdzLlNsaWRlcih7ZWw6aVswXSxhdXRvOnMsY29udGludW91czpyLHN0YXJ0U2xpZGU6dC5hY3RpdmVTbGlkZSxzbGlkZXNDaGFuZ2VkOmZ1bmN0aW9uKCl7dC5jdXJyZW50U2xpZGU9Yy5jdXJyZW50SW5kZXgoKSxlKGZ1bmN0aW9uKCl7fSl9LGNhbGxiYWNrOmZ1bmN0aW9uKG4pe3QuY3VycmVudFNsaWRlPW4sdC5vblNsaWRlQ2hhbmdlZCh7aW5kZXg6dC5jdXJyZW50U2xpZGUsJGluZGV4OnQuY3VycmVudFNsaWRlfSksdC4kcGFyZW50LiRicm9hZGNhc3QoXCJzbGlkZUJveC5zbGlkZUNoYW5nZWRcIixuKSx0LmFjdGl2ZVNsaWRlPW4sZShmdW5jdGlvbigpe30pfX0pO2MuZW5hYmxlU2xpZGUodC4kZXZhbChvLmRpc2FibGVTY3JvbGwpIT09ITApLHQuJHdhdGNoKFwiYWN0aXZlU2xpZGVcIixmdW5jdGlvbihlKXthbmd1bGFyLmlzRGVmaW5lZChlKSYmYy5zbGlkZShlKX0pLHQuJG9uKFwic2xpZGVCb3gubmV4dFNsaWRlXCIsZnVuY3Rpb24oKXtjLm5leHQoKX0pLHQuJG9uKFwic2xpZGVCb3gucHJldlNsaWRlXCIsZnVuY3Rpb24oKXtjLnByZXYoKX0pLHQuJG9uKFwic2xpZGVCb3guc2V0U2xpZGVcIixmdW5jdGlvbihlLHQpe2Muc2xpZGUodCl9KSx0aGlzLl9fc2xpZGVyPWM7dmFyIGw9bi5fcmVnaXN0ZXJJbnN0YW5jZShjLG8uZGVsZWdhdGVIYW5kbGUpO3QuJG9uKFwiJGRlc3Ryb3lcIixsKSx0aGlzLnNsaWRlc0NvdW50PWZ1bmN0aW9uKCl7cmV0dXJuIGMuc2xpZGVzQ291bnQoKX0sdGhpcy5vblBhZ2VyQ2xpY2s9ZnVuY3Rpb24oZSl7dC5wYWdlckNsaWNrKHtpbmRleDplfSl9LGUoZnVuY3Rpb24oKXtjLmxvYWQoKX0pfV0sdGVtcGxhdGU6JzxkaXYgY2xhc3M9XCJzbGlkZXJcIj48ZGl2IGNsYXNzPVwic2xpZGVyLXNsaWRlc1wiIG5nLXRyYW5zY2x1ZGU+PC9kaXY+PC9kaXY+JyxsaW5rOmZ1bmN0aW9uKGUsbil7aWYoZS4kZXZhbChlLnNob3dQYWdlcikhPT0hMSl7dmFyIGk9ZS4kbmV3KCksbz12KFwiPGlvbi1wYWdlcj48L2lvbi1wYWdlcj5cIik7bi5hcHBlbmQobyksdChvKShpKX19fX1dKS5kaXJlY3RpdmUoXCJpb25TbGlkZVwiLGZ1bmN0aW9uKCl7cmV0dXJue3Jlc3RyaWN0OlwiRVwiLHJlcXVpcmU6XCJeaW9uU2xpZGVCb3hcIixjb21waWxlOmZ1bmN0aW9uKGUpe3JldHVybiBlLmFkZENsYXNzKFwic2xpZGVyLXNsaWRlXCIpLGZ1bmN0aW9uKCl7fX19fSkuZGlyZWN0aXZlKFwiaW9uUGFnZXJcIixmdW5jdGlvbigpe3JldHVybntyZXN0cmljdDpcIkVcIixyZXBsYWNlOiEwLHJlcXVpcmU6XCJeaW9uU2xpZGVCb3hcIix0ZW1wbGF0ZTonPGRpdiBjbGFzcz1cInNsaWRlci1wYWdlclwiPjxzcGFuIGNsYXNzPVwic2xpZGVyLXBhZ2VyLXBhZ2VcIiBuZy1yZXBlYXQ9XCJzbGlkZSBpbiBudW1TbGlkZXMoKSB0cmFjayBieSAkaW5kZXhcIiBuZy1jbGFzcz1cInthY3RpdmU6ICRpbmRleCA9PSBjdXJyZW50U2xpZGV9XCIgbmctY2xpY2s9XCJwYWdlckNsaWNrKCRpbmRleClcIj48aSBjbGFzcz1cImljb24gaW9uLXJlY29yZFwiPjwvaT48L3NwYW4+PC9kaXY+JyxsaW5rOmZ1bmN0aW9uKGUsdCxuLGkpe3ZhciBvPWZ1bmN0aW9uKGUpe2Zvcih2YXIgbj10WzBdLmNoaWxkcmVuLGk9bi5sZW5ndGgsbz0wO2k+bztvKyspbz09ZT9uW29dLmNsYXNzTGlzdC5hZGQoXCJhY3RpdmVcIik6bltvXS5jbGFzc0xpc3QucmVtb3ZlKFwiYWN0aXZlXCIpfTtlLnBhZ2VyQ2xpY2s9ZnVuY3Rpb24oZSl7aS5vblBhZ2VyQ2xpY2soZSl9LGUubnVtU2xpZGVzPWZ1bmN0aW9uKCl7cmV0dXJuIG5ldyBBcnJheShpLnNsaWRlc0NvdW50KCkpfSxlLiR3YXRjaChcImN1cnJlbnRTbGlkZVwiLGZ1bmN0aW9uKGUpe28oZSl9KX19fSksdS5jb25zdGFudChcIiRpb25pY1RhYkNvbmZpZ1wiLHt0eXBlOlwiXCJ9KSx1LmRpcmVjdGl2ZShcImlvblRhYlwiLFtcIiRyb290U2NvcGVcIixcIiRhbmltYXRlXCIsXCIkaW9uaWNCaW5kXCIsXCIkY29tcGlsZVwiLGZ1bmN0aW9uKGUsdCxuLGkpe2Z1bmN0aW9uIG8oZSx0KXtyZXR1cm4gYW5ndWxhci5pc0RlZmluZWQodCk/XCIgXCIrZSsnPVwiJyt0KydcIic6XCJcIn1yZXR1cm57cmVzdHJpY3Q6XCJFXCIscmVxdWlyZTpbXCJeaW9uVGFic1wiLFwiaW9uVGFiXCJdLHJlcGxhY2U6ITAsY29udHJvbGxlcjpcIiRpb25pY1RhYlwiLHNjb3BlOiEwLGNvbXBpbGU6ZnVuY3Rpb24oZSxyKXt2YXIgYT1cIjxpb24tdGFiLW5hdlwiK28oXCJuZy1jbGlja1wiLHIubmdDbGljaykrbyhcInRpdGxlXCIsci50aXRsZSkrbyhcImljb25cIixyLmljb24pK28oXCJpY29uLW9uXCIsci5pY29uT24pK28oXCJpY29uLW9mZlwiLHIuaWNvbk9mZikrbyhcImJhZGdlXCIsci5iYWRnZSkrbyhcImJhZGdlLXN0eWxlXCIsci5iYWRnZVN0eWxlKStvKFwiaGlkZGVuXCIsci5oaWRkZW4pK28oXCJjbGFzc1wiLHJbXCJjbGFzc1wiXSkrXCI+PC9pb24tdGFiLW5hdj5cIixzPXYoJzxkaXYgY2xhc3M9XCJwYW5lXCI+JykuYXBwZW5kKGUuY29udGVudHMoKS5yZW1vdmUoKSk7cmV0dXJuIGZ1bmN0aW9uKGUsbyxyLGMpe2Z1bmN0aW9uIGwoKXtoLnRhYk1hdGNoZXNTdGF0ZSgpJiZmLnNlbGVjdChlLCExKX12YXIgdSxkLGY9Y1swXSxoPWNbMV0scD1zWzBdLnF1ZXJ5U2VsZWN0b3IoXCJpb24tbmF2LXZpZXdcIil8fHNbMF0ucXVlcnlTZWxlY3RvcihcImRhdGEtaW9uLW5hdi12aWV3XCIpLGc9cCYmcC5nZXRBdHRyaWJ1dGUoXCJuYW1lXCIpO24oZSxyLHthbmltYXRlOlwiPVwiLG9uU2VsZWN0OlwiJlwiLG9uRGVzZWxlY3Q6XCImXCIsdGl0bGU6XCJAXCIsdWlTcmVmOlwiQFwiLGhyZWY6XCJAXCJ9KSxmLmFkZChlKSxlLiRvbihcIiRkZXN0cm95XCIsZnVuY3Rpb24oKXtlLiR0YWJzRGVzdHJveXx8Zi5yZW1vdmUoZSksbS5pc29sYXRlU2NvcGUoKS4kZGVzdHJveSgpLG0ucmVtb3ZlKCl9KSxvWzBdLnJlbW92ZUF0dHJpYnV0ZShcInRpdGxlXCIpLGcmJihoLm5hdlZpZXdOYW1lPWUubmF2Vmlld05hbWU9ZyksZS4kb24oXCIkc3RhdGVDaGFuZ2VTdWNjZXNzXCIsbCksbCgpO3ZhciBtPXYoYSk7bS5kYXRhKFwiJGlvblRhYnNDb250cm9sbGVyXCIsZiksbS5kYXRhKFwiJGlvblRhYkNvbnRyb2xsZXJcIixoKSxmLiR0YWJzRWxlbWVudC5hcHBlbmQoaShtKShlKSksZS4kd2F0Y2goXCIkdGFiU2VsZWN0ZWRcIixmdW5jdGlvbihuKXt1JiZ1LiRkZXN0cm95KCksdT1udWxsLGQmJnQubGVhdmUoZCksZD1udWxsLG4mJih1PWUuJG5ldygpLGQ9cy5jbG9uZSgpLHQuZW50ZXIoZCxmLiRlbGVtZW50KSxpKGQpKHUpKX0pfX19fV0pLHUuZGlyZWN0aXZlKFwiaW9uVGFiTmF2XCIsW2Z1bmN0aW9uKCl7cmV0dXJue3Jlc3RyaWN0OlwiRVwiLHJlcGxhY2U6ITAscmVxdWlyZTpbXCJeaW9uVGFic1wiLFwiXmlvblRhYlwiXSx0ZW1wbGF0ZTonPGEgbmctY2xhc3M9XCJ7XFwndGFiLWl0ZW0tYWN0aXZlXFwnOiBpc1RhYkFjdGl2ZSgpLCBcXCdoYXMtYmFkZ2VcXCc6YmFkZ2UsIFxcJ3RhYi1oaWRkZW5cXCc6aXNIaWRkZW4oKX1cIiAgY2xhc3M9XCJ0YWItaXRlbVwiPjxzcGFuIGNsYXNzPVwiYmFkZ2Uge3tiYWRnZVN0eWxlfX1cIiBuZy1pZj1cImJhZGdlXCI+e3tiYWRnZX19PC9zcGFuPjxpIGNsYXNzPVwiaWNvbiB7e2dldEljb25PbigpfX1cIiBuZy1pZj1cImdldEljb25PbigpICYmIGlzVGFiQWN0aXZlKClcIj48L2k+PGkgY2xhc3M9XCJpY29uIHt7Z2V0SWNvbk9mZigpfX1cIiBuZy1pZj1cImdldEljb25PZmYoKSAmJiAhaXNUYWJBY3RpdmUoKVwiPjwvaT48c3BhbiBjbGFzcz1cInRhYi10aXRsZVwiIG5nLWJpbmQtaHRtbD1cInRpdGxlXCI+PC9zcGFuPjwvYT4nLHNjb3BlOnt0aXRsZTpcIkBcIixpY29uOlwiQFwiLGljb25PbjpcIkBcIixpY29uT2ZmOlwiQFwiLGJhZGdlOlwiPVwiLGhpZGRlbjpcIkBcIixiYWRnZVN0eWxlOlwiQFwiLFwiY2xhc3NcIjpcIkBcIn0sY29tcGlsZTpmdW5jdGlvbigpe3JldHVybiBmdW5jdGlvbihlLHQsbixpKXt2YXIgbz1pWzBdLHI9aVsxXTt0WzBdLnJlbW92ZUF0dHJpYnV0ZShcInRpdGxlXCIpLGUuc2VsZWN0VGFiPWZ1bmN0aW9uKGUpe2UucHJldmVudERlZmF1bHQoKSxvLnNlbGVjdChyLiRzY29wZSwhMCl9LG4ubmdDbGlja3x8dC5vbihcImNsaWNrXCIsZnVuY3Rpb24odCl7ZS4kYXBwbHkoZnVuY3Rpb24oKXtlLnNlbGVjdFRhYih0KX0pfSksZS5pc0hpZGRlbj1mdW5jdGlvbigpe3JldHVyblwidHJ1ZVwiPT09bi5oaWRkZW58fG4uaGlkZGVuPT09ITA/ITA6ITF9LGUuZ2V0SWNvbk9uPWZ1bmN0aW9uKCl7cmV0dXJuIGUuaWNvbk9ufHxlLmljb259LGUuZ2V0SWNvbk9mZj1mdW5jdGlvbigpe3JldHVybiBlLmljb25PZmZ8fGUuaWNvbn0sZS5pc1RhYkFjdGl2ZT1mdW5jdGlvbigpe3JldHVybiBvLnNlbGVjdGVkVGFiKCk9PT1yLiRzY29wZX19fX19XSksdS5jb25zdGFudChcIiRpb25pY1RhYnNDb25maWdcIix7cG9zaXRpb246XCJcIix0eXBlOlwiXCJ9KSx1LmRpcmVjdGl2ZShcImlvblRhYnNcIixbXCIkaW9uaWNWaWV3U2VydmljZVwiLFwiJGlvbmljVGFic0RlbGVnYXRlXCIsXCIkaW9uaWNUYWJzQ29uZmlnXCIsZnVuY3Rpb24oZSx0LG4pe3JldHVybntyZXN0cmljdDpcIkVcIixzY29wZTohMCxjb250cm9sbGVyOlwiJGlvbmljVGFic1wiLGNvbXBpbGU6ZnVuY3Rpb24oZSl7ZnVuY3Rpb24gaShlLG4saSxvKXt2YXIgcj10Ll9yZWdpc3Rlckluc3RhbmNlKG8saS5kZWxlZ2F0ZUhhbmRsZSk7ZS4kb24oXCIkZGVzdHJveVwiLGZ1bmN0aW9uKCl7ZS4kdGFic0Rlc3Ryb3k9ITAscigpfSksby4kc2NvcGU9ZSxvLiRlbGVtZW50PW4sby4kdGFic0VsZW1lbnQ9dihuWzBdLnF1ZXJ5U2VsZWN0b3IoXCIudGFic1wiKSk7dmFyIGE9blswXTtlLiR3YXRjaChmdW5jdGlvbigpe3JldHVybiBhLmNsYXNzTmFtZX0sZnVuY3Rpb24odCl7dmFyIG49LTEhPT10LmluZGV4T2YoXCJ0YWJzLXRvcFwiKSxpPS0xIT09dC5pbmRleE9mKFwidGFicy1pdGVtLWhpZGVcIik7ZS4kaGFzVGFicz0hbiYmIWksZS4kaGFzVGFic1RvcD1uJiYhaX0pLGUuJG9uKFwiJGRlc3Ryb3lcIixmdW5jdGlvbigpe2RlbGV0ZSBlLiRoYXNUYWJzLGRlbGV0ZSBlLiRoYXNUYWJzVG9wfSl9ZS5hZGRDbGFzcyhcInZpZXdcIik7dmFyIG89dignPGRpdiBjbGFzcz1cInRhYnNcIj48L2Rpdj4nKTtyZXR1cm4gby5hcHBlbmQoZS5jb250ZW50cygpKSxlLmFwcGVuZChvKSxlLmFkZENsYXNzKG4ucG9zaXRpb24pLGUuYWRkQ2xhc3Mobi50eXBlKSx7cHJlOml9fX19XSksdS5kaXJlY3RpdmUoXCJpb25Ub2dnbGVcIixbXCIkaW9uaWNHZXN0dXJlXCIsXCIkdGltZW91dFwiLGZ1bmN0aW9uKCl7cmV0dXJue3Jlc3RyaWN0OlwiRVwiLHJlcGxhY2U6ITAscmVxdWlyZTpcIj9uZ01vZGVsXCIsdHJhbnNjbHVkZTohMCx0ZW1wbGF0ZTonPGRpdiBjbGFzcz1cIml0ZW0gaXRlbS10b2dnbGVcIj48ZGl2IG5nLXRyYW5zY2x1ZGU+PC9kaXY+PGxhYmVsIGNsYXNzPVwidG9nZ2xlXCI+PGlucHV0IHR5cGU9XCJjaGVja2JveFwiPjxkaXYgY2xhc3M9XCJ0cmFja1wiPjxkaXYgY2xhc3M9XCJoYW5kbGVcIj48L2Rpdj48L2Rpdj48L2xhYmVsPjwvZGl2PicsY29tcGlsZTpmdW5jdGlvbihlLHQpe3ZhciBuPWUuZmluZChcImlucHV0XCIpO3JldHVybiBmKHtuYW1lOnQubmFtZSxcIm5nLXZhbHVlXCI6dC5uZ1ZhbHVlLFwibmctbW9kZWxcIjp0Lm5nTW9kZWwsXCJuZy1jaGVja2VkXCI6dC5uZ0NoZWNrZWQsXCJuZy1kaXNhYmxlZFwiOnQubmdEaXNhYmxlZCxcIm5nLXRydWUtdmFsdWVcIjp0Lm5nVHJ1ZVZhbHVlLFwibmctZmFsc2UtdmFsdWVcIjp0Lm5nRmFsc2VWYWx1ZSxcIm5nLWNoYW5nZVwiOnQubmdDaGFuZ2V9LGZ1bmN0aW9uKGUsdCl7aChlKSYmbi5hdHRyKHQsZSl9KSx0LnRvZ2dsZUNsYXNzJiZlWzBdLmdldEVsZW1lbnRzQnlUYWdOYW1lKFwibGFiZWxcIilbMF0uY2xhc3NMaXN0LmFkZCh0LnRvZ2dsZUNsYXNzKSxmdW5jdGlvbihlLHQpe3ZhciBuLGksbyxyO249dFswXS5nZXRFbGVtZW50c0J5VGFnTmFtZShcImxhYmVsXCIpWzBdLGk9bi5jaGlsZHJlblswXSxvPW4uY2hpbGRyZW5bMV0scj1vLmNoaWxkcmVuWzBdO3ZhciBhPXYoaSkuY29udHJvbGxlcihcIm5nTW9kZWxcIik7ZS50b2dnbGU9bmV3IGlvbmljLnZpZXdzLlRvZ2dsZSh7ZWw6bix0cmFjazpvLGNoZWNrYm94OmksaGFuZGxlOnIsb25DaGFuZ2U6ZnVuY3Rpb24oKXthLiRzZXRWaWV3VmFsdWUoaS5jaGVja2VkPyEwOiExKSxlLiRhcHBseSgpfX0pLGUuJG9uKFwiJGRlc3Ryb3lcIixmdW5jdGlvbigpe2UudG9nZ2xlLmRlc3Ryb3koKX0pfX19fV0pLHUuZGlyZWN0aXZlKFwiaW9uVmlld1wiLFtcIiRpb25pY1ZpZXdTZXJ2aWNlXCIsXCIkcm9vdFNjb3BlXCIsXCIkYW5pbWF0ZVwiLGZ1bmN0aW9uKCl7cmV0dXJue3Jlc3RyaWN0OlwiRUFcIixwcmlvcml0eToxZTMscmVxdWlyZTpbXCJeP2lvbk5hdkJhclwiLFwiXj9pb25Nb2RhbFwiXSxjb21waWxlOmZ1bmN0aW9uKGUpe3JldHVybiBlLmFkZENsYXNzKFwicGFuZVwiKSxlWzBdLnJlbW92ZUF0dHJpYnV0ZShcInRpdGxlXCIpLGZ1bmN0aW9uKGUsdCxuLGkpe3ZhciBvPWlbMF0scj1pWzFdO2lmKG8mJiFyKXtpZihhbmd1bGFyLmlzRGVmaW5lZChuLnRpdGxlKSl7dmFyIGE9bi50aXRsZTtvLmNoYW5nZVRpdGxlKGEsZS4kbmF2RGlyZWN0aW9uKSxuLiRvYnNlcnZlKFwidGl0bGVcIixmdW5jdGlvbihlKXtvLnNldFRpdGxlKGUpfSl9dmFyIHM9YW5ndWxhci5pc0RlZmluZWQobi5oaWRlQmFja0J1dHRvbik/bi5oaWRlQmFja0J1dHRvbjpcImZhbHNlXCI7ZS4kd2F0Y2gocyxmdW5jdGlvbihlKXtvLnNob3dCYWNrQnV0dG9uKCFlKX0pO3ZhciBjPWFuZ3VsYXIuaXNEZWZpbmVkKG4uaGlkZU5hdkJhcik/bi5oaWRlTmF2QmFyOlwiZmFsc2VcIjtlLiR3YXRjaChjLGZ1bmN0aW9uKGUpe28uc2hvd0JhcighZSl9KX19fX19XSl9KCk7XG47IGJyb3dzZXJpZnlfc2hpbV9fZGVmaW5lX19tb2R1bGVfX2V4cG9ydF9fKHR5cGVvZiBpb25pYyAhPSBcInVuZGVmaW5lZFwiID8gaW9uaWMgOiB3aW5kb3cuaW9uaWMpO1xuXG59KS5jYWxsKGdsb2JhbCwgdW5kZWZpbmVkLCB1bmRlZmluZWQsIHVuZGVmaW5lZCwgdW5kZWZpbmVkLCBmdW5jdGlvbiBkZWZpbmVFeHBvcnQoZXgpIHsgbW9kdWxlLmV4cG9ydHMgPSBleDsgfSk7XG5cbn0pLmNhbGwodGhpcyx0eXBlb2YgZ2xvYmFsICE9PSBcInVuZGVmaW5lZFwiID8gZ2xvYmFsIDogdHlwZW9mIHNlbGYgIT09IFwidW5kZWZpbmVkXCIgPyBzZWxmIDogdHlwZW9mIHdpbmRvdyAhPT0gXCJ1bmRlZmluZWRcIiA/IHdpbmRvdyA6IHt9KSIsIi8qIVxuICogQ29weXJpZ2h0IDIwMTQgRHJpZnR5IENvLlxuICogaHR0cDovL2RyaWZ0eS5jb20vXG4gKlxuICogSW9uaWMsIHYxLjAuMC1iZXRhLjEzXG4gKiBBIHBvd2VyZnVsIEhUTUw1IG1vYmlsZSBhcHAgZnJhbWV3b3JrLlxuICogaHR0cDovL2lvbmljZnJhbWV3b3JrLmNvbS9cbiAqXG4gKiBCeSBAbWF4bHluY2gsIEBiZW5qc3BlcnJ5LCBAYWRhbWRicmFkbGV5IDwzXG4gKlxuICogTGljZW5zZWQgdW5kZXIgdGhlIE1JVCBsaWNlbnNlLiBQbGVhc2Ugc2VlIExJQ0VOU0UgZm9yIG1vcmUgaW5mb3JtYXRpb24uXG4gKlxuICovXG5cbiFmdW5jdGlvbigpe2Z1bmN0aW9uIGUoZSx0LG4pe3QhPT0hMT9rLmFkZEV2ZW50TGlzdGVuZXIoZSxqW2VdLG4pOmsucmVtb3ZlRXZlbnRMaXN0ZW5lcihlLGpbZV0pfWZ1bmN0aW9uIHQoZSl7dmFyIHQ9VChlLnRhcmdldCksaT1FKHQpO2lmKGlvbmljLnRhcC5yZXF1aXJlc05hdGl2ZUNsaWNrKGkpfHx6KXJldHVybiExO3ZhciByPWlvbmljLnRhcC5wb2ludGVyQ29vcmQoZSk7bihcImNsaWNrXCIsaSxyLngsci55KSxfKGkpfWZ1bmN0aW9uIG4oZSx0LG4saSl7dmFyIHI9ZG9jdW1lbnQuY3JlYXRlRXZlbnQoXCJNb3VzZUV2ZW50c1wiKTtyLmluaXRNb3VzZUV2ZW50KGUsITAsITAsd2luZG93LDEsMCwwLG4saSwhMSwhMSwhMSwhMSwwLG51bGwpLHIuaXNJb25pY1RhcD0hMCx0LmRpc3BhdGNoRXZlbnQocil9ZnVuY3Rpb24gaShlKXtyZXR1cm4oXCJzdWJtaXRcIiE9ZS50YXJnZXQudHlwZXx8MCE9PWUuZGV0YWlsKSYmKGlvbmljLnNjcm9sbC5pc1Njcm9sbGluZyYmaW9uaWMudGFwLmNvbnRhaW5zT3JJc1RleHRJbnB1dChlLnRhcmdldCl8fCFlLmlzSW9uaWNUYXAmJiFpb25pYy50YXAucmVxdWlyZXNOYXRpdmVDbGljayhlLnRhcmdldCkpPyhlLnN0b3BQcm9wYWdhdGlvbigpLGlvbmljLnRhcC5pc0xhYmVsV2l0aFRleHRJbnB1dChlLnRhcmdldCl8fGUucHJldmVudERlZmF1bHQoKSwhMSk6dm9pZCAwfWZ1bmN0aW9uIHIodCl7aWYoIXQuaXNJb25pY1RhcCYmIWQodCkpe2lmKFgpcmV0dXJuIHQuc3RvcFByb3BhZ2F0aW9uKCksaW9uaWMudGFwLmlzVGV4dElucHV0KHQudGFyZ2V0KSYmcT09PXQudGFyZ2V0fHwvXihzZWxlY3R8b3B0aW9uKSQvaS50ZXN0KHQudGFyZ2V0LnRhZ05hbWUpfHx0LnByZXZlbnREZWZhdWx0KCksITE7ej0hMSxGPWlvbmljLnRhcC5wb2ludGVyQ29vcmQodCksZShcIm1vdXNlbW92ZVwiKSxpb25pYy5hY3RpdmF0b3Iuc3RhcnQodCl9fWZ1bmN0aW9uIG8obil7cmV0dXJuIFg/KG4uc3RvcFByb3BhZ2F0aW9uKCksbi5wcmV2ZW50RGVmYXVsdCgpLCExKTpkKG4pfHwvXihzZWxlY3R8b3B0aW9uKSQvaS50ZXN0KG4udGFyZ2V0LnRhZ05hbWUpPyExOih2KG4pfHx0KG4pLGUoXCJtb3VzZW1vdmVcIiwhMSksaW9uaWMuYWN0aXZhdG9yLmVuZCgpLHZvaWQoej0hMSkpfWZ1bmN0aW9uIHModCl7cmV0dXJuIHYodCk/KGUoXCJtb3VzZW1vdmVcIiwhMSksaW9uaWMuYWN0aXZhdG9yLmVuZCgpLHo9ITAsITEpOnZvaWQgMH1mdW5jdGlvbiBhKHQpe2lmKCFkKHQpJiYoej0hMSxoKCksRj1pb25pYy50YXAucG9pbnRlckNvb3JkKHQpLGUoVSksaW9uaWMuYWN0aXZhdG9yLnN0YXJ0KHQpLGlvbmljLlBsYXRmb3JtLmlzSU9TKCkmJmlvbmljLnRhcC5pc0xhYmVsV2l0aFRleHRJbnB1dCh0LnRhcmdldCkpKXt2YXIgbj1FKFQodC50YXJnZXQpKTtuIT09WSYmdC5wcmV2ZW50RGVmYXVsdCgpfX1mdW5jdGlvbiBsKGUpe2QoZSl8fChoKCksdihlKXx8KHQoZSksL14oc2VsZWN0fG9wdGlvbikkL2kudGVzdChlLnRhcmdldC50YWdOYW1lKSYmZS5wcmV2ZW50RGVmYXVsdCgpKSxxPWUudGFyZ2V0LHUoKSl9ZnVuY3Rpb24gYyh0KXtyZXR1cm4gdih0KT8oej0hMCxlKFUsITEpLGlvbmljLmFjdGl2YXRvci5lbmQoKSwhMSk6dm9pZCAwfWZ1bmN0aW9uIHUoKXtlKFUsITEpLGlvbmljLmFjdGl2YXRvci5lbmQoKSx6PSExfWZ1bmN0aW9uIGgoKXtYPSEwLGNsZWFyVGltZW91dChIKSxIPXNldFRpbWVvdXQoZnVuY3Rpb24oKXtYPSExfSwyZTMpfWZ1bmN0aW9uIGQoZSl7cmV0dXJuIGUuaXNUYXBIYW5kbGVkPyEwOihlLmlzVGFwSGFuZGxlZD0hMCxpb25pYy5zY3JvbGwuaXNTY3JvbGxpbmcmJmlvbmljLnRhcC5jb250YWluc09ySXNUZXh0SW5wdXQoZS50YXJnZXQpPyhlLnByZXZlbnREZWZhdWx0KCksITApOnZvaWQgMCl9ZnVuY3Rpb24gXyhlKXtXPW51bGw7dmFyIHQ9ITE7XCJTRUxFQ1RcIj09ZS50YWdOYW1lPyhuKFwibW91c2Vkb3duXCIsZSwwLDApLGUuZm9jdXMmJmUuZm9jdXMoKSx0PSEwKTpnKCk9PT1lP3Q9ITA6L14oaW5wdXR8dGV4dGFyZWEpJC9pLnRlc3QoZS50YWdOYW1lKXx8ZS5pc0NvbnRlbnRFZGl0YWJsZT8odD0hMCxlLmZvY3VzJiZlLmZvY3VzKCksZS52YWx1ZT1lLnZhbHVlLFgmJihXPWUpKTpmKCksdCYmKGcoZSksaW9uaWMudHJpZ2dlcihcImlvbmljLmZvY3VzaW5cIix7dGFyZ2V0OmV9LCEwKSl9ZnVuY3Rpb24gZigpe3ZhciBlPWcoKTtlJiYoL14oaW5wdXR8dGV4dGFyZWF8c2VsZWN0KSQvaS50ZXN0KGUudGFnTmFtZSl8fGUuaXNDb250ZW50RWRpdGFibGUpJiZlLmJsdXIoKSxnKG51bGwpfWZ1bmN0aW9uIHAoZSl7WCYmaW9uaWMudGFwLmlzVGV4dElucHV0KGcoKSkmJmlvbmljLnRhcC5pc1RleHRJbnB1dChXKSYmVyE9PWUudGFyZ2V0JiYoVy5mb2N1cygpLFc9bnVsbCksaW9uaWMuc2Nyb2xsLmlzU2Nyb2xsaW5nPSExfWZ1bmN0aW9uIG0oKXtnKG51bGwpfWZ1bmN0aW9uIGcoZSl7cmV0dXJuIGFyZ3VtZW50cy5sZW5ndGgmJihZPWUpLFl8fGRvY3VtZW50LmFjdGl2ZUVsZW1lbnR9ZnVuY3Rpb24gdihlKXtpZighZXx8MSE9PWUudGFyZ2V0Lm5vZGVUeXBlfHwhRnx8MD09PUYueCYmMD09PUYueSlyZXR1cm4hMTt2YXIgdD1pb25pYy50YXAucG9pbnRlckNvb3JkKGUpLG49ISghZS50YXJnZXQuY2xhc3NMaXN0fHwhZS50YXJnZXQuY2xhc3NMaXN0LmNvbnRhaW5zKSxpPW4mZS50YXJnZXQuY2xhc3NMaXN0LmNvbnRhaW5zKFwiYnV0dG9uXCIpP1o6QjtyZXR1cm4gTWF0aC5hYnMoRi54LXQueCk+aXx8TWF0aC5hYnMoRi55LXQueSk+aX1mdW5jdGlvbiBUKGUsdCl7Zm9yKHZhciBuPWUsaT0wOzY+aSYmbjtpKyspe2lmKFwiTEFCRUxcIj09PW4udGFnTmFtZSlyZXR1cm4gbjtuPW4ucGFyZW50RWxlbWVudH1yZXR1cm4gdCE9PSExP2U6dm9pZCAwfWZ1bmN0aW9uIEUoZSl7aWYoZSYmXCJMQUJFTFwiPT09ZS50YWdOYW1lKXtpZihlLmNvbnRyb2wpcmV0dXJuIGUuY29udHJvbDtpZihlLnF1ZXJ5U2VsZWN0b3Ipe3ZhciB0PWUucXVlcnlTZWxlY3RvcihcImlucHV0LHRleHRhcmVhLHNlbGVjdFwiKTtpZih0KXJldHVybiB0fX1yZXR1cm4gZX1mdW5jdGlvbiBTKCl7QSgpPyh3aW5kb3cuYWRkRXZlbnRMaXN0ZW5lcihcIm5hdGl2ZS5rZXlib2FyZHNob3dcIix3KSx3aW5kb3cuYWRkRXZlbnRMaXN0ZW5lcihcIm5hdGl2ZS5rZXlib2FyZGhpZGVcIixMKSx3aW5kb3cuYWRkRXZlbnRMaXN0ZW5lcihcIm5hdGl2ZS5zaG93a2V5Ym9hcmRcIix3KSx3aW5kb3cuYWRkRXZlbnRMaXN0ZW5lcihcIm5hdGl2ZS5oaWRla2V5Ym9hcmRcIixMKSk6ZG9jdW1lbnQuYm9keS5hZGRFdmVudExpc3RlbmVyKFwiZm9jdXNvdXRcIixMKSxkb2N1bWVudC5ib2R5LmFkZEV2ZW50TGlzdGVuZXIoXCJpb25pYy5mb2N1c2luXCIsYiksZG9jdW1lbnQuYm9keS5hZGRFdmVudExpc3RlbmVyKFwiZm9jdXNpblwiLGIpLGRvY3VtZW50LmJvZHkuYWRkRXZlbnRMaXN0ZW5lcihcIm9yaWVudGF0aW9uY2hhbmdlXCIsRyksd2luZG93Lm5hdmlnYXRvci5tc1BvaW50ZXJFbmFibGVkP2RvY3VtZW50LnJlbW92ZUV2ZW50TGlzdGVuZXIoXCJNU1BvaW50ZXJEb3duXCIsUyk6ZG9jdW1lbnQucmVtb3ZlRXZlbnRMaXN0ZW5lcihcInRvdWNoc3RhcnRcIixTKX1mdW5jdGlvbiB3KGUpe2NsZWFyVGltZW91dChLKSxpb25pYy5rZXlib2FyZC5oZWlnaHQ9ZS5rZXlib2FyZEhlaWdodH1mdW5jdGlvbiBiKGUpe2UudGFyZ2V0JiZpb25pYy50YXAuaXNUZXh0SW5wdXQoZS50YXJnZXQpJiYhaW9uaWMudGFwLmlzRGF0ZUlucHV0KGUudGFyZ2V0KSYmUChlLnRhcmdldCkmJihkb2N1bWVudC5hZGRFdmVudExpc3RlbmVyKFwia2V5ZG93blwiLE0sITEpLGRvY3VtZW50LmJvZHkuc2Nyb2xsVG9wPTAsZG9jdW1lbnQuYm9keS5xdWVyeVNlbGVjdG9yKFwiLnNjcm9sbC1jb250ZW50XCIpLnNjcm9sbFRvcD0wLCQ9ZS50YXJnZXQseShlKSl9ZnVuY3Rpb24geShlKXtjbGVhclRpbWVvdXQoSiksY2xlYXJUaW1lb3V0KEspLEo9c2V0VGltZW91dChmdW5jdGlvbigpe2lmKCEodHQrMzUwPkRhdGUubm93KCkpKXt0dD1EYXRlLm5vdygpO3ZhciB0LG49JC5nZXRCb3VuZGluZ0NsaWVudFJlY3QoKSxpPTA7UT1zZXRJbnRlcnZhbChmdW5jdGlvbigpe3Q9SSgpLGk+MTAmJihjbGVhckludGVydmFsKFEpLHQ9Mjc1KSx0JiYoY2xlYXJJbnRlcnZhbChRKSxEKGUudGFyZ2V0LG4udG9wLG4uYm90dG9tLGV0LHQpKSxpKyt9LDEwMCl9fSwzMil9ZnVuY3Rpb24gRChlLHQsbixpLHIpe3ZhciBvPXt0YXJnZXQ6ZSxlbGVtZW50VG9wOk1hdGgucm91bmQodCksZWxlbWVudEJvdHRvbTpNYXRoLnJvdW5kKG4pLGtleWJvYXJkSGVpZ2h0OnIsdmlld3BvcnRIZWlnaHQ6aX07cmV0dXJuIG8uaGFzUGx1Z2luPUEoKSxvLmNvbnRlbnRIZWlnaHQ9aS1yLG8uaXNFbGVtZW50VW5kZXJLZXlib2FyZD1vLmVsZW1lbnRCb3R0b20+by5jb250ZW50SGVpZ2h0LGlvbmljLmtleWJvYXJkLmlzT3Blbj0hMCwkPWUsaW9uaWMudHJpZ2dlcihcInNjcm9sbENoaWxkSW50b1ZpZXdcIixvLCEwKSxpb25pYy5yZXF1ZXN0QW5pbWF0aW9uRnJhbWUoZnVuY3Rpb24oKXtkb2N1bWVudC5ib2R5LmNsYXNzTGlzdC5hZGQobnQpfSksd2luZG93Lm5hdmlnYXRvci5tc1BvaW50ZXJFbmFibGVkP2RvY3VtZW50LmFkZEV2ZW50TGlzdGVuZXIoXCJNU1BvaW50ZXJNb3ZlXCIsTiwhMSk6ZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lcihcInRvdWNobW92ZVwiLE4sITEpLG99ZnVuY3Rpb24gTCgpe2NsZWFyVGltZW91dChLKSxLPXNldFRpbWVvdXQoaW9uaWMua2V5Ym9hcmQuaGlkZSwzNTApfWZ1bmN0aW9uIHgoKXtDKCk+ZXQmJihldD1DKCkpfWZ1bmN0aW9uIE0oZSl7aW9uaWMuc2Nyb2xsLmlzU2Nyb2xsaW5nJiZOKGUpfWZ1bmN0aW9uIE4oZSl7XCJURVhUQVJFQVwiIT09ZS50YXJnZXQudGFnTmFtZSYmZS5wcmV2ZW50RGVmYXVsdCgpfWZ1bmN0aW9uIEcoKXt2YXIgZT1DKCk7aWYoZT09PWV0KXZhciB0PTAsbj1zZXRJbnRlcnZhbChmdW5jdGlvbigpe3Q+MTAmJmNsZWFySW50ZXJ2YWwobiksZT1DKCksZSE9PWV0JiYoaW9uaWMua2V5Ym9hcmQubGFuZHNjYXBlPWV0PmU/ITA6ITEsZXQ9ZSxjbGVhckludGVydmFsKG4pKSx0Kyt9LDUwKTtlbHNlIGV0PWV9ZnVuY3Rpb24gSSgpe3JldHVybiBpb25pYy5rZXlib2FyZC5oZWlnaHQ/aW9uaWMua2V5Ym9hcmQuaGVpZ2h0OmlvbmljLlBsYXRmb3JtLmlzQW5kcm9pZCgpP2lvbmljLlBsYXRmb3JtLmlzRnVsbFNjcmVlbj8yNzU6QygpPGV0P2V0LUMoKTowOmlvbmljLlBsYXRmb3JtLmlzSU9TKCk/aW9uaWMua2V5Ym9hcmQubGFuZHNjYXBlPzIwNjppb25pYy5QbGF0Zm9ybS5pc1dlYlZpZXcoKT8yNjA6MjE2OjI3NX1mdW5jdGlvbiBDKCl7cmV0dXJuIHdpbmRvdy5pbm5lckhlaWdodHx8c2NyZWVuLmhlaWdodH1mdW5jdGlvbiBQKGUpe2Zvcig7ZTspe2lmKGUuY2xhc3NMaXN0LmNvbnRhaW5zKGl0KSlyZXR1cm4hMDtlPWUucGFyZW50RWxlbWVudH1yZXR1cm4hMX1mdW5jdGlvbiBBKCl7cmV0dXJuISEod2luZG93LmNvcmRvdmEmJmNvcmRvdmEucGx1Z2lucyYmY29yZG92YS5wbHVnaW5zLktleWJvYXJkKX1mdW5jdGlvbiBPKCl7dmFyIGU7Zm9yKGU9MDtlPGRvY3VtZW50LmhlYWQuY2hpbGRyZW4ubGVuZ3RoO2UrKylpZihcInZpZXdwb3J0XCI9PWRvY3VtZW50LmhlYWQuY2hpbGRyZW5bZV0ubmFtZSl7cnQ9ZG9jdW1lbnQuaGVhZC5jaGlsZHJlbltlXTticmVha31pZihydCl7dmFyIHQsbj1ydC5jb250ZW50LnRvTG93ZXJDYXNlKCkucmVwbGFjZSgvXFxzKy9nLFwiXCIpLnNwbGl0KFwiLFwiKTtmb3IoZT0wO2U8bi5sZW5ndGg7ZSsrKW5bZV0mJih0PW5bZV0uc3BsaXQoXCI9XCIpLG90W3RbMF1dPXQubGVuZ3RoPjE/dFsxXTpcIl9cIik7UigpfX1mdW5jdGlvbiBSKCl7dmFyIGU9b3Qud2lkdGgsdD1vdC5oZWlnaHQsbj1pb25pYy5QbGF0Zm9ybSxpPW4udmVyc2lvbigpLHI9XCJkZXZpY2Utd2lkdGhcIixvPVwiZGV2aWNlLWhlaWdodFwiLHM9aW9uaWMudmlld3BvcnQub3JpZW50YXRpb24oKTtkZWxldGUgb3QuaGVpZ2h0LG90LndpZHRoPXIsbi5pc0lQYWQoKT9pPjc/ZGVsZXRlIG90LndpZHRoOm4uaXNXZWJWaWV3KCk/OTA9PXM/b3QuaGVpZ2h0PVwiMFwiOjc9PWkmJihvdC5oZWlnaHQ9byk6Nz5pJiYob3QuaGVpZ2h0PVwiMFwiKTpuLmlzSU9TKCkmJihuLmlzV2ViVmlldygpP2k+Nz9kZWxldGUgb3Qud2lkdGg6Nz5pP3QmJihvdC5oZWlnaHQ9XCIwXCIpOjc9PWkmJihvdC5oZWlnaHQ9byk6Nz5pJiZ0JiYob3QuaGVpZ2h0PVwiMFwiKSksKGUhPT1vdC53aWR0aHx8dCE9PW90LmhlaWdodCkmJlYoKX1mdW5jdGlvbiBWKCl7dmFyIGUsdD1bXTtmb3IoZSBpbiBvdClvdFtlXSYmdC5wdXNoKGUrKFwiX1wiPT1vdFtlXT9cIlwiOlwiPVwiK290W2VdKSk7cnQuY29udGVudD10LmpvaW4oXCIsIFwiKX13aW5kb3cuaW9uaWM9d2luZG93LmlvbmljfHx7fSx3aW5kb3cuaW9uaWMudmlld3M9e30sd2luZG93LmlvbmljLnZlcnNpb249XCIxLjAuMC1iZXRhLjEzXCIsZnVuY3Rpb24oZSx0LG4pe2Z1bmN0aW9uIGkoKXtvPSEwO2Zvcih2YXIgZT0wO2U8ci5sZW5ndGg7ZSsrKW4ucmVxdWVzdEFuaW1hdGlvbkZyYW1lKHJbZV0pO3I9W10sdC5yZW1vdmVFdmVudExpc3RlbmVyKFwiRE9NQ29udGVudExvYWRlZFwiLGkpfXZhciByPVtdLG89XCJjb21wbGV0ZVwiPT09dC5yZWFkeVN0YXRlfHxcImludGVyYWN0aXZlXCI9PT10LnJlYWR5U3RhdGU7b3x8dC5hZGRFdmVudExpc3RlbmVyKFwiRE9NQ29udGVudExvYWRlZFwiLGkpLGUuX3JBRj1mdW5jdGlvbigpe3JldHVybiBlLnJlcXVlc3RBbmltYXRpb25GcmFtZXx8ZS53ZWJraXRSZXF1ZXN0QW5pbWF0aW9uRnJhbWV8fGUubW96UmVxdWVzdEFuaW1hdGlvbkZyYW1lfHxmdW5jdGlvbih0KXtlLnNldFRpbWVvdXQodCwxNil9fSgpO3ZhciBzPWUuY2FuY2VsQW5pbWF0aW9uRnJhbWV8fGUud2Via2l0Q2FuY2VsQW5pbWF0aW9uRnJhbWV8fGUubW96Q2FuY2VsQW5pbWF0aW9uRnJhbWV8fGUud2Via2l0Q2FuY2VsUmVxdWVzdEFuaW1hdGlvbkZyYW1lO24uRG9tVXRpbD17cmVxdWVzdEFuaW1hdGlvbkZyYW1lOmZ1bmN0aW9uKHQpe3JldHVybiBlLl9yQUYodCl9LGNhbmNlbEFuaW1hdGlvbkZyYW1lOmZ1bmN0aW9uKGUpe3MoZSl9LGFuaW1hdGlvbkZyYW1lVGhyb3R0bGU6ZnVuY3Rpb24oZSl7dmFyIHQsaSxyO3JldHVybiBmdW5jdGlvbigpe3Q9YXJndW1lbnRzLHI9dGhpcyxpfHwoaT0hMCxuLnJlcXVlc3RBbmltYXRpb25GcmFtZShmdW5jdGlvbigpe2UuYXBwbHkocix0KSxpPSExfSkpfX0sZ2V0UG9zaXRpb25JblBhcmVudDpmdW5jdGlvbihlKXtyZXR1cm57bGVmdDplLm9mZnNldExlZnQsdG9wOmUub2Zmc2V0VG9wfX0scmVhZHk6ZnVuY3Rpb24oZSl7bz9uLnJlcXVlc3RBbmltYXRpb25GcmFtZShlKTpyLnB1c2goZSl9LGdldFRleHRCb3VuZHM6ZnVuY3Rpb24obil7aWYodC5jcmVhdGVSYW5nZSl7dmFyIGk9dC5jcmVhdGVSYW5nZSgpO2lmKGkuc2VsZWN0Tm9kZUNvbnRlbnRzKG4pLGkuZ2V0Qm91bmRpbmdDbGllbnRSZWN0KXt2YXIgcj1pLmdldEJvdW5kaW5nQ2xpZW50UmVjdCgpO2lmKHIpe3ZhciBvPWUuc2Nyb2xsWCxzPWUuc2Nyb2xsWTtyZXR1cm57dG9wOnIudG9wK3MsbGVmdDpyLmxlZnQrbyxyaWdodDpyLmxlZnQrbytyLndpZHRoLGJvdHRvbTpyLnRvcCtzK3IuaGVpZ2h0LHdpZHRoOnIud2lkdGgsaGVpZ2h0OnIuaGVpZ2h0fX19fXJldHVybiBudWxsfSxnZXRDaGlsZEluZGV4OmZ1bmN0aW9uKGUsdCl7aWYodClmb3IodmFyIG4saT1lLnBhcmVudE5vZGUuY2hpbGRyZW4scj0wLG89MCxzPWkubGVuZ3RoO3M+cjtyKyspaWYobj1pW3JdLG4ubm9kZU5hbWUmJm4ubm9kZU5hbWUudG9Mb3dlckNhc2UoKT09dCl7aWYobj09ZSlyZXR1cm4gbztvKyt9cmV0dXJuIEFycmF5LnByb3RvdHlwZS5zbGljZS5jYWxsKGUucGFyZW50Tm9kZS5jaGlsZHJlbikuaW5kZXhPZihlKX0sc3dhcE5vZGVzOmZ1bmN0aW9uKGUsdCl7dC5wYXJlbnROb2RlLmluc2VydEJlZm9yZShlLHQpfSxlbGVtZW50SXNEZXNjZW5kYW50OmZ1bmN0aW9uKGUsdCxuKXt2YXIgaT1lO2Rve2lmKGk9PT10KXJldHVybiEwO2k9aS5wYXJlbnROb2RlfXdoaWxlKGkmJmkhPT1uKTtyZXR1cm4hMX0sZ2V0UGFyZW50V2l0aENsYXNzOmZ1bmN0aW9uKGUsdCxuKXtmb3Iobj1ufHwxMDtlLnBhcmVudE5vZGUmJm4tLTspe2lmKGUucGFyZW50Tm9kZS5jbGFzc0xpc3QmJmUucGFyZW50Tm9kZS5jbGFzc0xpc3QuY29udGFpbnModCkpcmV0dXJuIGUucGFyZW50Tm9kZTtlPWUucGFyZW50Tm9kZX1yZXR1cm4gbnVsbH0sZ2V0UGFyZW50T3JTZWxmV2l0aENsYXNzOmZ1bmN0aW9uKGUsdCxuKXtmb3Iobj1ufHwxMDtlJiZuLS07KXtpZihlLmNsYXNzTGlzdCYmZS5jbGFzc0xpc3QuY29udGFpbnModCkpcmV0dXJuIGU7ZT1lLnBhcmVudE5vZGV9cmV0dXJuIG51bGx9LHJlY3RDb250YWluczpmdW5jdGlvbihlLHQsbixpLHIsbyl7cmV0dXJuIG4+ZXx8ZT5yPyExOmk+dHx8dD5vPyExOiEwfX0sbi5yZXF1ZXN0QW5pbWF0aW9uRnJhbWU9bi5Eb21VdGlsLnJlcXVlc3RBbmltYXRpb25GcmFtZSxuLmNhbmNlbEFuaW1hdGlvbkZyYW1lPW4uRG9tVXRpbC5jYW5jZWxBbmltYXRpb25GcmFtZSxuLmFuaW1hdGlvbkZyYW1lVGhyb3R0bGU9bi5Eb21VdGlsLmFuaW1hdGlvbkZyYW1lVGhyb3R0bGV9KHdpbmRvdyxkb2N1bWVudCxpb25pYyksZnVuY3Rpb24oZSl7ZS5DdXN0b21FdmVudD1mdW5jdGlvbigpe2lmKFwiZnVuY3Rpb25cIj09dHlwZW9mIHdpbmRvdy5DdXN0b21FdmVudClyZXR1cm4gQ3VzdG9tRXZlbnQ7dmFyIGU9ZnVuY3Rpb24oZSx0KXt2YXIgbjt0PXR8fHtidWJibGVzOiExLGNhbmNlbGFibGU6ITEsZGV0YWlsOnZvaWQgMH07dHJ5e249ZG9jdW1lbnQuY3JlYXRlRXZlbnQoXCJDdXN0b21FdmVudFwiKSxuLmluaXRDdXN0b21FdmVudChlLHQuYnViYmxlcyx0LmNhbmNlbGFibGUsdC5kZXRhaWwpfWNhdGNoKGkpe249ZG9jdW1lbnQuY3JlYXRlRXZlbnQoXCJFdmVudFwiKTtmb3IodmFyIHIgaW4gdCluW3JdPXRbcl07bi5pbml0RXZlbnQoZSx0LmJ1YmJsZXMsdC5jYW5jZWxhYmxlKX1yZXR1cm4gbn07cmV0dXJuIGUucHJvdG90eXBlPXdpbmRvdy5FdmVudC5wcm90b3R5cGUsZX0oKSxlLkV2ZW50Q29udHJvbGxlcj17VklSVFVBTElaRURfRVZFTlRTOltcInRhcFwiLFwic3dpcGVcIixcInN3aXBlcmlnaHRcIixcInN3aXBlbGVmdFwiLFwiZHJhZ1wiLFwiaG9sZFwiLFwicmVsZWFzZVwiXSx0cmlnZ2VyOmZ1bmN0aW9uKHQsbixpLHIpe3ZhciBvPW5ldyBlLkN1c3RvbUV2ZW50KHQse2RldGFpbDpuLGJ1YmJsZXM6ISFpLGNhbmNlbGFibGU6ISFyfSk7biYmbi50YXJnZXQmJm4udGFyZ2V0LmRpc3BhdGNoRXZlbnQmJm4udGFyZ2V0LmRpc3BhdGNoRXZlbnQobyl8fHdpbmRvdy5kaXNwYXRjaEV2ZW50KG8pfSxvbjpmdW5jdGlvbih0LG4saSl7Zm9yKHZhciByPWl8fHdpbmRvdyxvPTAscz10aGlzLlZJUlRVQUxJWkVEX0VWRU5UUy5sZW5ndGg7cz5vO28rKylpZih0PT10aGlzLlZJUlRVQUxJWkVEX0VWRU5UU1tvXSl7dmFyIGE9bmV3IGUuR2VzdHVyZShpKTtyZXR1cm4gYS5vbih0LG4pLGF9ci5hZGRFdmVudExpc3RlbmVyKHQsbil9LG9mZjpmdW5jdGlvbihlLHQsbil7bi5yZW1vdmVFdmVudExpc3RlbmVyKGUsdCl9LG9uR2VzdHVyZTpmdW5jdGlvbih0LG4saSxyKXt2YXIgbz1uZXcgZS5HZXN0dXJlKGkscik7cmV0dXJuIG8ub24odCxuKSxvfSxvZmZHZXN0dXJlOmZ1bmN0aW9uKGUsdCxuKXtlLm9mZih0LG4pfSxoYW5kbGVQb3BTdGF0ZTpmdW5jdGlvbigpe319LGUub249ZnVuY3Rpb24oKXtlLkV2ZW50Q29udHJvbGxlci5vbi5hcHBseShlLkV2ZW50Q29udHJvbGxlcixhcmd1bWVudHMpfSxlLm9mZj1mdW5jdGlvbigpe2UuRXZlbnRDb250cm9sbGVyLm9mZi5hcHBseShlLkV2ZW50Q29udHJvbGxlcixhcmd1bWVudHMpfSxlLnRyaWdnZXI9ZS5FdmVudENvbnRyb2xsZXIudHJpZ2dlcixlLm9uR2VzdHVyZT1mdW5jdGlvbigpe3JldHVybiBlLkV2ZW50Q29udHJvbGxlci5vbkdlc3R1cmUuYXBwbHkoZS5FdmVudENvbnRyb2xsZXIub25HZXN0dXJlLGFyZ3VtZW50cyl9LGUub2ZmR2VzdHVyZT1mdW5jdGlvbigpe3JldHVybiBlLkV2ZW50Q29udHJvbGxlci5vZmZHZXN0dXJlLmFwcGx5KGUuRXZlbnRDb250cm9sbGVyLm9mZkdlc3R1cmUsYXJndW1lbnRzKX19KHdpbmRvdy5pb25pYyksZnVuY3Rpb24oZSl7ZnVuY3Rpb24gdCgpe2lmKCFlLkdlc3R1cmVzLlJFQURZKXtlLkdlc3R1cmVzLmV2ZW50LmRldGVybWluZUV2ZW50VHlwZXMoKTtmb3IodmFyIHQgaW4gZS5HZXN0dXJlcy5nZXN0dXJlcyllLkdlc3R1cmVzLmdlc3R1cmVzLmhhc093blByb3BlcnR5KHQpJiZlLkdlc3R1cmVzLmRldGVjdGlvbi5yZWdpc3RlcihlLkdlc3R1cmVzLmdlc3R1cmVzW3RdKTtlLkdlc3R1cmVzLmV2ZW50Lm9uVG91Y2goZS5HZXN0dXJlcy5ET0NVTUVOVCxlLkdlc3R1cmVzLkVWRU5UX01PVkUsZS5HZXN0dXJlcy5kZXRlY3Rpb24uZGV0ZWN0KSxlLkdlc3R1cmVzLmV2ZW50Lm9uVG91Y2goZS5HZXN0dXJlcy5ET0NVTUVOVCxlLkdlc3R1cmVzLkVWRU5UX0VORCxlLkdlc3R1cmVzLmRldGVjdGlvbi5kZXRlY3QpLGUuR2VzdHVyZXMuUkVBRFk9ITB9fWUuR2VzdHVyZT1mdW5jdGlvbih0LG4pe3JldHVybiBuZXcgZS5HZXN0dXJlcy5JbnN0YW5jZSh0LG58fHt9KX0sZS5HZXN0dXJlcz17fSxlLkdlc3R1cmVzLmRlZmF1bHRzPXtzdG9wX2Jyb3dzZXJfYmVoYXZpb3I6XCJkaXNhYmxlLXVzZXItYmVoYXZpb3JcIn0sZS5HZXN0dXJlcy5IQVNfUE9JTlRFUkVWRU5UUz13aW5kb3cubmF2aWdhdG9yLnBvaW50ZXJFbmFibGVkfHx3aW5kb3cubmF2aWdhdG9yLm1zUG9pbnRlckVuYWJsZWQsZS5HZXN0dXJlcy5IQVNfVE9VQ0hFVkVOVFM9XCJvbnRvdWNoc3RhcnRcImluIHdpbmRvdyxlLkdlc3R1cmVzLk1PQklMRV9SRUdFWD0vbW9iaWxlfHRhYmxldHxpcChhZHxob25lfG9kKXxhbmRyb2lkfHNpbGsvaSxlLkdlc3R1cmVzLk5PX01PVVNFRVZFTlRTPWUuR2VzdHVyZXMuSEFTX1RPVUNIRVZFTlRTJiZ3aW5kb3cubmF2aWdhdG9yLnVzZXJBZ2VudC5tYXRjaChlLkdlc3R1cmVzLk1PQklMRV9SRUdFWCksZS5HZXN0dXJlcy5FVkVOVF9UWVBFUz17fSxlLkdlc3R1cmVzLkRJUkVDVElPTl9ET1dOPVwiZG93blwiLGUuR2VzdHVyZXMuRElSRUNUSU9OX0xFRlQ9XCJsZWZ0XCIsZS5HZXN0dXJlcy5ESVJFQ1RJT05fVVA9XCJ1cFwiLGUuR2VzdHVyZXMuRElSRUNUSU9OX1JJR0hUPVwicmlnaHRcIixlLkdlc3R1cmVzLlBPSU5URVJfTU9VU0U9XCJtb3VzZVwiLGUuR2VzdHVyZXMuUE9JTlRFUl9UT1VDSD1cInRvdWNoXCIsZS5HZXN0dXJlcy5QT0lOVEVSX1BFTj1cInBlblwiLGUuR2VzdHVyZXMuRVZFTlRfU1RBUlQ9XCJzdGFydFwiLGUuR2VzdHVyZXMuRVZFTlRfTU9WRT1cIm1vdmVcIixlLkdlc3R1cmVzLkVWRU5UX0VORD1cImVuZFwiLGUuR2VzdHVyZXMuRE9DVU1FTlQ9d2luZG93LmRvY3VtZW50LGUuR2VzdHVyZXMucGx1Z2lucz17fSxlLkdlc3R1cmVzLlJFQURZPSExLGUuR2VzdHVyZXMuSW5zdGFuY2U9ZnVuY3Rpb24obixpKXt2YXIgcj10aGlzO2lmKG51bGwhPT1uKXJldHVybiB0KCksdGhpcy5lbGVtZW50PW4sdGhpcy5lbmFibGVkPSEwLHRoaXMub3B0aW9ucz1lLkdlc3R1cmVzLnV0aWxzLmV4dGVuZChlLkdlc3R1cmVzLnV0aWxzLmV4dGVuZCh7fSxlLkdlc3R1cmVzLmRlZmF1bHRzKSxpfHx7fSksdGhpcy5vcHRpb25zLnN0b3BfYnJvd3Nlcl9iZWhhdmlvciYmZS5HZXN0dXJlcy51dGlscy5zdG9wRGVmYXVsdEJyb3dzZXJCZWhhdmlvcih0aGlzLmVsZW1lbnQsdGhpcy5vcHRpb25zLnN0b3BfYnJvd3Nlcl9iZWhhdmlvciksZS5HZXN0dXJlcy5ldmVudC5vblRvdWNoKG4sZS5HZXN0dXJlcy5FVkVOVF9TVEFSVCxmdW5jdGlvbih0KXtyLmVuYWJsZWQmJmUuR2VzdHVyZXMuZGV0ZWN0aW9uLnN0YXJ0RGV0ZWN0KHIsdCl9KSx0aGlzfSxlLkdlc3R1cmVzLkluc3RhbmNlLnByb3RvdHlwZT17b246ZnVuY3Rpb24oZSx0KXtmb3IodmFyIG49ZS5zcGxpdChcIiBcIiksaT0wO2k8bi5sZW5ndGg7aSsrKXRoaXMuZWxlbWVudC5hZGRFdmVudExpc3RlbmVyKG5baV0sdCwhMSk7cmV0dXJuIHRoaXN9LG9mZjpmdW5jdGlvbihlLHQpe2Zvcih2YXIgbj1lLnNwbGl0KFwiIFwiKSxpPTA7aTxuLmxlbmd0aDtpKyspdGhpcy5lbGVtZW50LnJlbW92ZUV2ZW50TGlzdGVuZXIobltpXSx0LCExKTtyZXR1cm4gdGhpc30sdHJpZ2dlcjpmdW5jdGlvbih0LG4pe3ZhciBpPWUuR2VzdHVyZXMuRE9DVU1FTlQuY3JlYXRlRXZlbnQoXCJFdmVudFwiKTtpLmluaXRFdmVudCh0LCEwLCEwKSxpLmdlc3R1cmU9bjt2YXIgcj10aGlzLmVsZW1lbnQ7cmV0dXJuIGUuR2VzdHVyZXMudXRpbHMuaGFzUGFyZW50KG4udGFyZ2V0LHIpJiYocj1uLnRhcmdldCksci5kaXNwYXRjaEV2ZW50KGkpLHRoaXN9LGVuYWJsZTpmdW5jdGlvbihlKXtyZXR1cm4gdGhpcy5lbmFibGVkPWUsdGhpc319O3ZhciBuPW51bGwsaT0hMSxyPSExO2UuR2VzdHVyZXMuZXZlbnQ9e2JpbmREb206ZnVuY3Rpb24oZSx0LG4pe2Zvcih2YXIgaT10LnNwbGl0KFwiIFwiKSxyPTA7cjxpLmxlbmd0aDtyKyspZS5hZGRFdmVudExpc3RlbmVyKGlbcl0sbiwhMSl9LG9uVG91Y2g6ZnVuY3Rpb24odCxvLHMpe3ZhciBhPXRoaXM7dGhpcy5iaW5kRG9tKHQsZS5HZXN0dXJlcy5FVkVOVF9UWVBFU1tvXSxmdW5jdGlvbihsKXt2YXIgYz1sLnR5cGUudG9Mb3dlckNhc2UoKTtpZighYy5tYXRjaCgvbW91c2UvKXx8IXIpe2MubWF0Y2goL3RvdWNoLyl8fGMubWF0Y2goL3BvaW50ZXJkb3duLyl8fGMubWF0Y2goL21vdXNlLykmJjE9PT1sLndoaWNoP2k9ITA6Yy5tYXRjaCgvbW91c2UvKSYmMSE9PWwud2hpY2gmJihpPSExKSxjLm1hdGNoKC90b3VjaHxwb2ludGVyLykmJihyPSEwKTt2YXIgdT0wO2kmJihlLkdlc3R1cmVzLkhBU19QT0lOVEVSRVZFTlRTJiZvIT1lLkdlc3R1cmVzLkVWRU5UX0VORD91PWUuR2VzdHVyZXMuUG9pbnRlckV2ZW50LnVwZGF0ZVBvaW50ZXIobyxsKTpjLm1hdGNoKC90b3VjaC8pP3U9bC50b3VjaGVzLmxlbmd0aDpyfHwodT1jLm1hdGNoKC91cC8pPzA6MSksdT4wJiZvPT1lLkdlc3R1cmVzLkVWRU5UX0VORD9vPWUuR2VzdHVyZXMuRVZFTlRfTU9WRTp1fHwobz1lLkdlc3R1cmVzLkVWRU5UX0VORCksKHV8fG51bGw9PT1uKSYmKG49bCkscy5jYWxsKGUuR2VzdHVyZXMuZGV0ZWN0aW9uLGEuY29sbGVjdEV2ZW50RGF0YSh0LG8sYS5nZXRUb3VjaExpc3QobixvKSxsKSksZS5HZXN0dXJlcy5IQVNfUE9JTlRFUkVWRU5UUyYmbz09ZS5HZXN0dXJlcy5FVkVOVF9FTkQmJih1PWUuR2VzdHVyZXMuUG9pbnRlckV2ZW50LnVwZGF0ZVBvaW50ZXIobyxsKSkpLHV8fChuPW51bGwsaT0hMSxyPSExLGUuR2VzdHVyZXMuUG9pbnRlckV2ZW50LnJlc2V0KCkpfX0pfSxkZXRlcm1pbmVFdmVudFR5cGVzOmZ1bmN0aW9uKCl7dmFyIHQ7dD1lLkdlc3R1cmVzLkhBU19QT0lOVEVSRVZFTlRTP2UuR2VzdHVyZXMuUG9pbnRlckV2ZW50LmdldEV2ZW50cygpOmUuR2VzdHVyZXMuTk9fTU9VU0VFVkVOVFM/W1widG91Y2hzdGFydFwiLFwidG91Y2htb3ZlXCIsXCJ0b3VjaGVuZCB0b3VjaGNhbmNlbFwiXTpbXCJ0b3VjaHN0YXJ0IG1vdXNlZG93blwiLFwidG91Y2htb3ZlIG1vdXNlbW92ZVwiLFwidG91Y2hlbmQgdG91Y2hjYW5jZWwgbW91c2V1cFwiXSxlLkdlc3R1cmVzLkVWRU5UX1RZUEVTW2UuR2VzdHVyZXMuRVZFTlRfU1RBUlRdPXRbMF0sZS5HZXN0dXJlcy5FVkVOVF9UWVBFU1tlLkdlc3R1cmVzLkVWRU5UX01PVkVdPXRbMV0sZS5HZXN0dXJlcy5FVkVOVF9UWVBFU1tlLkdlc3R1cmVzLkVWRU5UX0VORF09dFsyXX0sZ2V0VG91Y2hMaXN0OmZ1bmN0aW9uKHQpe3JldHVybiBlLkdlc3R1cmVzLkhBU19QT0lOVEVSRVZFTlRTP2UuR2VzdHVyZXMuUG9pbnRlckV2ZW50LmdldFRvdWNoTGlzdCgpOnQudG91Y2hlcz90LnRvdWNoZXM6KHQuaWRlbnRpZmllcj0xLFt0XSl9LGNvbGxlY3RFdmVudERhdGE6ZnVuY3Rpb24odCxuLGkscil7dmFyIG89ZS5HZXN0dXJlcy5QT0lOVEVSX1RPVUNIO3JldHVybihyLnR5cGUubWF0Y2goL21vdXNlLyl8fGUuR2VzdHVyZXMuUG9pbnRlckV2ZW50Lm1hdGNoVHlwZShlLkdlc3R1cmVzLlBPSU5URVJfTU9VU0UscikpJiYobz1lLkdlc3R1cmVzLlBPSU5URVJfTU9VU0UpLHtjZW50ZXI6ZS5HZXN0dXJlcy51dGlscy5nZXRDZW50ZXIoaSksdGltZVN0YW1wOihuZXcgRGF0ZSkuZ2V0VGltZSgpLHRhcmdldDpyLnRhcmdldCx0b3VjaGVzOmksZXZlbnRUeXBlOm4scG9pbnRlclR5cGU6byxzcmNFdmVudDpyLHByZXZlbnREZWZhdWx0OmZ1bmN0aW9uKCl7dGhpcy5zcmNFdmVudC5wcmV2ZW50TWFuaXB1bGF0aW9uJiZ0aGlzLnNyY0V2ZW50LnByZXZlbnRNYW5pcHVsYXRpb24oKSx0aGlzLnNyY0V2ZW50LnByZXZlbnREZWZhdWx0fSxzdG9wUHJvcGFnYXRpb246ZnVuY3Rpb24oKXt0aGlzLnNyY0V2ZW50LnN0b3BQcm9wYWdhdGlvbigpfSxzdG9wRGV0ZWN0OmZ1bmN0aW9uKCl7cmV0dXJuIGUuR2VzdHVyZXMuZGV0ZWN0aW9uLnN0b3BEZXRlY3QoKX19fX0sZS5HZXN0dXJlcy5Qb2ludGVyRXZlbnQ9e3BvaW50ZXJzOnt9LGdldFRvdWNoTGlzdDpmdW5jdGlvbigpe3ZhciBlPXRoaXMsdD1bXTtyZXR1cm4gT2JqZWN0LmtleXMoZS5wb2ludGVycykuc29ydCgpLmZvckVhY2goZnVuY3Rpb24obil7dC5wdXNoKGUucG9pbnRlcnNbbl0pfSksdH0sdXBkYXRlUG9pbnRlcjpmdW5jdGlvbih0LG4pe3JldHVybiB0PT1lLkdlc3R1cmVzLkVWRU5UX0VORD90aGlzLnBvaW50ZXJzPXt9OihuLmlkZW50aWZpZXI9bi5wb2ludGVySWQsdGhpcy5wb2ludGVyc1tuLnBvaW50ZXJJZF09biksT2JqZWN0LmtleXModGhpcy5wb2ludGVycykubGVuZ3RofSxtYXRjaFR5cGU6ZnVuY3Rpb24odCxuKXtpZighbi5wb2ludGVyVHlwZSlyZXR1cm4hMTt2YXIgaT17fTtyZXR1cm4gaVtlLkdlc3R1cmVzLlBPSU5URVJfTU9VU0VdPW4ucG9pbnRlclR5cGU9PW4uTVNQT0lOVEVSX1RZUEVfTU9VU0V8fG4ucG9pbnRlclR5cGU9PWUuR2VzdHVyZXMuUE9JTlRFUl9NT1VTRSxpW2UuR2VzdHVyZXMuUE9JTlRFUl9UT1VDSF09bi5wb2ludGVyVHlwZT09bi5NU1BPSU5URVJfVFlQRV9UT1VDSHx8bi5wb2ludGVyVHlwZT09ZS5HZXN0dXJlcy5QT0lOVEVSX1RPVUNILGlbZS5HZXN0dXJlcy5QT0lOVEVSX1BFTl09bi5wb2ludGVyVHlwZT09bi5NU1BPSU5URVJfVFlQRV9QRU58fG4ucG9pbnRlclR5cGU9PWUuR2VzdHVyZXMuUE9JTlRFUl9QRU4saVt0XX0sZ2V0RXZlbnRzOmZ1bmN0aW9uKCl7cmV0dXJuW1wicG9pbnRlcmRvd24gTVNQb2ludGVyRG93blwiLFwicG9pbnRlcm1vdmUgTVNQb2ludGVyTW92ZVwiLFwicG9pbnRlcnVwIHBvaW50ZXJjYW5jZWwgTVNQb2ludGVyVXAgTVNQb2ludGVyQ2FuY2VsXCJdfSxyZXNldDpmdW5jdGlvbigpe3RoaXMucG9pbnRlcnM9e319fSxlLkdlc3R1cmVzLnV0aWxzPXtleHRlbmQ6ZnVuY3Rpb24oZSx0LG4pe2Zvcih2YXIgaSBpbiB0KXZvaWQgMCE9PWVbaV0mJm58fChlW2ldPXRbaV0pO3JldHVybiBlfSxoYXNQYXJlbnQ6ZnVuY3Rpb24oZSx0KXtmb3IoO2U7KXtpZihlPT10KXJldHVybiEwO2U9ZS5wYXJlbnROb2RlfXJldHVybiExfSxnZXRDZW50ZXI6ZnVuY3Rpb24oZSl7Zm9yKHZhciB0PVtdLG49W10saT0wLHI9ZS5sZW5ndGg7cj5pO2krKyl0LnB1c2goZVtpXS5wYWdlWCksbi5wdXNoKGVbaV0ucGFnZVkpO3JldHVybntwYWdlWDooTWF0aC5taW4uYXBwbHkoTWF0aCx0KStNYXRoLm1heC5hcHBseShNYXRoLHQpKS8yLHBhZ2VZOihNYXRoLm1pbi5hcHBseShNYXRoLG4pK01hdGgubWF4LmFwcGx5KE1hdGgsbikpLzJ9fSxnZXRWZWxvY2l0eTpmdW5jdGlvbihlLHQsbil7cmV0dXJue3g6TWF0aC5hYnModC9lKXx8MCx5Ok1hdGguYWJzKG4vZSl8fDB9fSxnZXRBbmdsZTpmdW5jdGlvbihlLHQpe3ZhciBuPXQucGFnZVktZS5wYWdlWSxpPXQucGFnZVgtZS5wYWdlWDtyZXR1cm4gMTgwKk1hdGguYXRhbjIobixpKS9NYXRoLlBJfSxnZXREaXJlY3Rpb246ZnVuY3Rpb24odCxuKXt2YXIgaT1NYXRoLmFicyh0LnBhZ2VYLW4ucGFnZVgpLHI9TWF0aC5hYnModC5wYWdlWS1uLnBhZ2VZKTtyZXR1cm4gaT49cj90LnBhZ2VYLW4ucGFnZVg+MD9lLkdlc3R1cmVzLkRJUkVDVElPTl9MRUZUOmUuR2VzdHVyZXMuRElSRUNUSU9OX1JJR0hUOnQucGFnZVktbi5wYWdlWT4wP2UuR2VzdHVyZXMuRElSRUNUSU9OX1VQOmUuR2VzdHVyZXMuRElSRUNUSU9OX0RPV059LGdldERpc3RhbmNlOmZ1bmN0aW9uKGUsdCl7dmFyIG49dC5wYWdlWC1lLnBhZ2VYLGk9dC5wYWdlWS1lLnBhZ2VZO3JldHVybiBNYXRoLnNxcnQobipuK2kqaSl9LGdldFNjYWxlOmZ1bmN0aW9uKGUsdCl7cmV0dXJuIGUubGVuZ3RoPj0yJiZ0Lmxlbmd0aD49Mj90aGlzLmdldERpc3RhbmNlKHRbMF0sdFsxXSkvdGhpcy5nZXREaXN0YW5jZShlWzBdLGVbMV0pOjF9LGdldFJvdGF0aW9uOmZ1bmN0aW9uKGUsdCl7cmV0dXJuIGUubGVuZ3RoPj0yJiZ0Lmxlbmd0aD49Mj90aGlzLmdldEFuZ2xlKHRbMV0sdFswXSktdGhpcy5nZXRBbmdsZShlWzFdLGVbMF0pOjB9LGlzVmVydGljYWw6ZnVuY3Rpb24odCl7cmV0dXJuIHQ9PWUuR2VzdHVyZXMuRElSRUNUSU9OX1VQfHx0PT1lLkdlc3R1cmVzLkRJUkVDVElPTl9ET1dOfSxzdG9wRGVmYXVsdEJyb3dzZXJCZWhhdmlvcjpmdW5jdGlvbihlLHQpe2UmJmUuY2xhc3NMaXN0JiYoZS5jbGFzc0xpc3QuYWRkKHQpLGUub25zZWxlY3RzdGFydD1mdW5jdGlvbigpe3JldHVybiExfSl9fSxlLkdlc3R1cmVzLmRldGVjdGlvbj17Z2VzdHVyZXM6W10sY3VycmVudDpudWxsLHByZXZpb3VzOm51bGwsc3RvcHBlZDohMSxzdGFydERldGVjdDpmdW5jdGlvbih0LG4pe3RoaXMuY3VycmVudHx8KHRoaXMuc3RvcHBlZD0hMSx0aGlzLmN1cnJlbnQ9e2luc3Q6dCxzdGFydEV2ZW50OmUuR2VzdHVyZXMudXRpbHMuZXh0ZW5kKHt9LG4pLGxhc3RFdmVudDohMSxuYW1lOlwiXCJ9LHRoaXMuZGV0ZWN0KG4pKX0sZGV0ZWN0OmZ1bmN0aW9uKHQpe2lmKHRoaXMuY3VycmVudCYmIXRoaXMuc3RvcHBlZCl7dD10aGlzLmV4dGVuZEV2ZW50RGF0YSh0KTtmb3IodmFyIG49dGhpcy5jdXJyZW50Lmluc3Qub3B0aW9ucyxpPTAscj10aGlzLmdlc3R1cmVzLmxlbmd0aDtyPmk7aSsrKXt2YXIgbz10aGlzLmdlc3R1cmVzW2ldO2lmKCF0aGlzLnN0b3BwZWQmJm5bby5uYW1lXSE9PSExJiZvLmhhbmRsZXIuY2FsbChvLHQsdGhpcy5jdXJyZW50Lmluc3QpPT09ITEpe3RoaXMuc3RvcERldGVjdCgpO2JyZWFrfX1yZXR1cm4gdGhpcy5jdXJyZW50JiYodGhpcy5jdXJyZW50Lmxhc3RFdmVudD10KSx0LmV2ZW50VHlwZT09ZS5HZXN0dXJlcy5FVkVOVF9FTkQmJiF0LnRvdWNoZXMubGVuZ3RoLTEmJnRoaXMuc3RvcERldGVjdCgpLHR9fSxzdG9wRGV0ZWN0OmZ1bmN0aW9uKCl7dGhpcy5wcmV2aW91cz1lLkdlc3R1cmVzLnV0aWxzLmV4dGVuZCh7fSx0aGlzLmN1cnJlbnQpLHRoaXMuY3VycmVudD1udWxsLHRoaXMuc3RvcHBlZD0hMH0sZXh0ZW5kRXZlbnREYXRhOmZ1bmN0aW9uKHQpe3ZhciBuPXRoaXMuY3VycmVudC5zdGFydEV2ZW50O2lmKG4mJih0LnRvdWNoZXMubGVuZ3RoIT1uLnRvdWNoZXMubGVuZ3RofHx0LnRvdWNoZXM9PT1uLnRvdWNoZXMpKXtuLnRvdWNoZXM9W107Zm9yKHZhciBpPTAscj10LnRvdWNoZXMubGVuZ3RoO3I+aTtpKyspbi50b3VjaGVzLnB1c2goZS5HZXN0dXJlcy51dGlscy5leHRlbmQoe30sdC50b3VjaGVzW2ldKSl9dmFyIG89dC50aW1lU3RhbXAtbi50aW1lU3RhbXAscz10LmNlbnRlci5wYWdlWC1uLmNlbnRlci5wYWdlWCxhPXQuY2VudGVyLnBhZ2VZLW4uY2VudGVyLnBhZ2VZLGw9ZS5HZXN0dXJlcy51dGlscy5nZXRWZWxvY2l0eShvLHMsYSk7cmV0dXJuIGUuR2VzdHVyZXMudXRpbHMuZXh0ZW5kKHQse2RlbHRhVGltZTpvLGRlbHRhWDpzLGRlbHRhWTphLHZlbG9jaXR5WDpsLngsdmVsb2NpdHlZOmwueSxkaXN0YW5jZTplLkdlc3R1cmVzLnV0aWxzLmdldERpc3RhbmNlKG4uY2VudGVyLHQuY2VudGVyKSxhbmdsZTplLkdlc3R1cmVzLnV0aWxzLmdldEFuZ2xlKG4uY2VudGVyLHQuY2VudGVyKSxkaXJlY3Rpb246ZS5HZXN0dXJlcy51dGlscy5nZXREaXJlY3Rpb24obi5jZW50ZXIsdC5jZW50ZXIpLHNjYWxlOmUuR2VzdHVyZXMudXRpbHMuZ2V0U2NhbGUobi50b3VjaGVzLHQudG91Y2hlcykscm90YXRpb246ZS5HZXN0dXJlcy51dGlscy5nZXRSb3RhdGlvbihuLnRvdWNoZXMsdC50b3VjaGVzKSxzdGFydEV2ZW50Om59KSx0fSxyZWdpc3RlcjpmdW5jdGlvbih0KXt2YXIgbj10LmRlZmF1bHRzfHx7fTtyZXR1cm4gdm9pZCAwPT09blt0Lm5hbWVdJiYoblt0Lm5hbWVdPSEwKSxlLkdlc3R1cmVzLnV0aWxzLmV4dGVuZChlLkdlc3R1cmVzLmRlZmF1bHRzLG4sITApLHQuaW5kZXg9dC5pbmRleHx8MWUzLHRoaXMuZ2VzdHVyZXMucHVzaCh0KSx0aGlzLmdlc3R1cmVzLnNvcnQoZnVuY3Rpb24oZSx0KXtyZXR1cm4gZS5pbmRleDx0LmluZGV4Py0xOmUuaW5kZXg+dC5pbmRleD8xOjB9KSx0aGlzLmdlc3R1cmVzfX0sZS5HZXN0dXJlcy5nZXN0dXJlcz1lLkdlc3R1cmVzLmdlc3R1cmVzfHx7fSxlLkdlc3R1cmVzLmdlc3R1cmVzLkhvbGQ9e25hbWU6XCJob2xkXCIsaW5kZXg6MTAsZGVmYXVsdHM6e2hvbGRfdGltZW91dDo1MDAsaG9sZF90aHJlc2hvbGQ6MX0sdGltZXI6bnVsbCxoYW5kbGVyOmZ1bmN0aW9uKHQsbil7c3dpdGNoKHQuZXZlbnRUeXBlKXtjYXNlIGUuR2VzdHVyZXMuRVZFTlRfU1RBUlQ6Y2xlYXJUaW1lb3V0KHRoaXMudGltZXIpLGUuR2VzdHVyZXMuZGV0ZWN0aW9uLmN1cnJlbnQubmFtZT10aGlzLm5hbWUsdGhpcy50aW1lcj1zZXRUaW1lb3V0KGZ1bmN0aW9uKCl7XCJob2xkXCI9PWUuR2VzdHVyZXMuZGV0ZWN0aW9uLmN1cnJlbnQubmFtZSYmKGUudGFwLmNhbmNlbENsaWNrKCksbi50cmlnZ2VyKFwiaG9sZFwiLHQpKX0sbi5vcHRpb25zLmhvbGRfdGltZW91dCk7YnJlYWs7Y2FzZSBlLkdlc3R1cmVzLkVWRU5UX01PVkU6dC5kaXN0YW5jZT5uLm9wdGlvbnMuaG9sZF90aHJlc2hvbGQmJmNsZWFyVGltZW91dCh0aGlzLnRpbWVyKTticmVhaztjYXNlIGUuR2VzdHVyZXMuRVZFTlRfRU5EOmNsZWFyVGltZW91dCh0aGlzLnRpbWVyKX19fSxlLkdlc3R1cmVzLmdlc3R1cmVzLlRhcD17bmFtZTpcInRhcFwiLGluZGV4OjEwMCxkZWZhdWx0czp7dGFwX21heF90b3VjaHRpbWU6MjUwLHRhcF9tYXhfZGlzdGFuY2U6MTAsdGFwX2Fsd2F5czohMCxkb3VibGV0YXBfZGlzdGFuY2U6MjAsZG91YmxldGFwX2ludGVydmFsOjMwMH0saGFuZGxlcjpmdW5jdGlvbih0LG4pe2lmKHQuZXZlbnRUeXBlPT1lLkdlc3R1cmVzLkVWRU5UX0VORCYmXCJ0b3VjaGNhbmNlbFwiIT10LnNyY0V2ZW50LnR5cGUpe3ZhciBpPWUuR2VzdHVyZXMuZGV0ZWN0aW9uLnByZXZpb3VzLHI9ITE7aWYodC5kZWx0YVRpbWU+bi5vcHRpb25zLnRhcF9tYXhfdG91Y2h0aW1lfHx0LmRpc3RhbmNlPm4ub3B0aW9ucy50YXBfbWF4X2Rpc3RhbmNlKXJldHVybjtpJiZcInRhcFwiPT1pLm5hbWUmJnQudGltZVN0YW1wLWkubGFzdEV2ZW50LnRpbWVTdGFtcDxuLm9wdGlvbnMuZG91YmxldGFwX2ludGVydmFsJiZ0LmRpc3RhbmNlPG4ub3B0aW9ucy5kb3VibGV0YXBfZGlzdGFuY2UmJihuLnRyaWdnZXIoXCJkb3VibGV0YXBcIix0KSxyPSEwKSwoIXJ8fG4ub3B0aW9ucy50YXBfYWx3YXlzKSYmKGUuR2VzdHVyZXMuZGV0ZWN0aW9uLmN1cnJlbnQubmFtZT1cInRhcFwiLG4udHJpZ2dlcihcInRhcFwiLHQpKX19fSxlLkdlc3R1cmVzLmdlc3R1cmVzLlN3aXBlPXtuYW1lOlwic3dpcGVcIixpbmRleDo0MCxkZWZhdWx0czp7c3dpcGVfbWF4X3RvdWNoZXM6MSxzd2lwZV92ZWxvY2l0eTouN30saGFuZGxlcjpmdW5jdGlvbih0LG4pe2lmKHQuZXZlbnRUeXBlPT1lLkdlc3R1cmVzLkVWRU5UX0VORCl7aWYobi5vcHRpb25zLnN3aXBlX21heF90b3VjaGVzPjAmJnQudG91Y2hlcy5sZW5ndGg+bi5vcHRpb25zLnN3aXBlX21heF90b3VjaGVzKXJldHVybjsodC52ZWxvY2l0eVg+bi5vcHRpb25zLnN3aXBlX3ZlbG9jaXR5fHx0LnZlbG9jaXR5WT5uLm9wdGlvbnMuc3dpcGVfdmVsb2NpdHkpJiYobi50cmlnZ2VyKHRoaXMubmFtZSx0KSxuLnRyaWdnZXIodGhpcy5uYW1lK3QuZGlyZWN0aW9uLHQpKX19fSxlLkdlc3R1cmVzLmdlc3R1cmVzLkRyYWc9e25hbWU6XCJkcmFnXCIsaW5kZXg6NTAsZGVmYXVsdHM6e2RyYWdfbWluX2Rpc3RhbmNlOjEwLGNvcnJlY3RfZm9yX2RyYWdfbWluX2Rpc3RhbmNlOiEwLGRyYWdfbWF4X3RvdWNoZXM6MSxkcmFnX2Jsb2NrX2hvcml6b250YWw6ITAsZHJhZ19ibG9ja192ZXJ0aWNhbDohMCxkcmFnX2xvY2tfdG9fYXhpczohMSxkcmFnX2xvY2tfbWluX2Rpc3RhbmNlOjI1fSx0cmlnZ2VyZWQ6ITEsaGFuZGxlcjpmdW5jdGlvbih0LG4pe2lmKGUuR2VzdHVyZXMuZGV0ZWN0aW9uLmN1cnJlbnQubmFtZSE9dGhpcy5uYW1lJiZ0aGlzLnRyaWdnZXJlZClyZXR1cm4gbi50cmlnZ2VyKHRoaXMubmFtZStcImVuZFwiLHQpLHZvaWQodGhpcy50cmlnZ2VyZWQ9ITEpO2lmKCEobi5vcHRpb25zLmRyYWdfbWF4X3RvdWNoZXM+MCYmdC50b3VjaGVzLmxlbmd0aD5uLm9wdGlvbnMuZHJhZ19tYXhfdG91Y2hlcykpc3dpdGNoKHQuZXZlbnRUeXBlKXtjYXNlIGUuR2VzdHVyZXMuRVZFTlRfU1RBUlQ6dGhpcy50cmlnZ2VyZWQ9ITE7YnJlYWs7Y2FzZSBlLkdlc3R1cmVzLkVWRU5UX01PVkU6aWYodC5kaXN0YW5jZTxuLm9wdGlvbnMuZHJhZ19taW5fZGlzdGFuY2UmJmUuR2VzdHVyZXMuZGV0ZWN0aW9uLmN1cnJlbnQubmFtZSE9dGhpcy5uYW1lKXJldHVybjtpZihlLkdlc3R1cmVzLmRldGVjdGlvbi5jdXJyZW50Lm5hbWUhPXRoaXMubmFtZSYmKGUuR2VzdHVyZXMuZGV0ZWN0aW9uLmN1cnJlbnQubmFtZT10aGlzLm5hbWUsbi5vcHRpb25zLmNvcnJlY3RfZm9yX2RyYWdfbWluX2Rpc3RhbmNlKSl7dmFyIGk9TWF0aC5hYnMobi5vcHRpb25zLmRyYWdfbWluX2Rpc3RhbmNlL3QuZGlzdGFuY2UpO2UuR2VzdHVyZXMuZGV0ZWN0aW9uLmN1cnJlbnQuc3RhcnRFdmVudC5jZW50ZXIucGFnZVgrPXQuZGVsdGFYKmksZS5HZXN0dXJlcy5kZXRlY3Rpb24uY3VycmVudC5zdGFydEV2ZW50LmNlbnRlci5wYWdlWSs9dC5kZWx0YVkqaSx0PWUuR2VzdHVyZXMuZGV0ZWN0aW9uLmV4dGVuZEV2ZW50RGF0YSh0KX0oZS5HZXN0dXJlcy5kZXRlY3Rpb24uY3VycmVudC5sYXN0RXZlbnQuZHJhZ19sb2NrZWRfdG9fYXhpc3x8bi5vcHRpb25zLmRyYWdfbG9ja190b19heGlzJiZuLm9wdGlvbnMuZHJhZ19sb2NrX21pbl9kaXN0YW5jZTw9dC5kaXN0YW5jZSkmJih0LmRyYWdfbG9ja2VkX3RvX2F4aXM9ITApO3ZhciByPWUuR2VzdHVyZXMuZGV0ZWN0aW9uLmN1cnJlbnQubGFzdEV2ZW50LmRpcmVjdGlvbjt0LmRyYWdfbG9ja2VkX3RvX2F4aXMmJnIhPT10LmRpcmVjdGlvbiYmKHQuZGlyZWN0aW9uPWUuR2VzdHVyZXMudXRpbHMuaXNWZXJ0aWNhbChyKT90LmRlbHRhWTwwP2UuR2VzdHVyZXMuRElSRUNUSU9OX1VQOmUuR2VzdHVyZXMuRElSRUNUSU9OX0RPV046dC5kZWx0YVg8MD9lLkdlc3R1cmVzLkRJUkVDVElPTl9MRUZUOmUuR2VzdHVyZXMuRElSRUNUSU9OX1JJR0hUKSx0aGlzLnRyaWdnZXJlZHx8KG4udHJpZ2dlcih0aGlzLm5hbWUrXCJzdGFydFwiLHQpLHRoaXMudHJpZ2dlcmVkPSEwKSxuLnRyaWdnZXIodGhpcy5uYW1lLHQpLG4udHJpZ2dlcih0aGlzLm5hbWUrdC5kaXJlY3Rpb24sdCksKG4ub3B0aW9ucy5kcmFnX2Jsb2NrX3ZlcnRpY2FsJiZlLkdlc3R1cmVzLnV0aWxzLmlzVmVydGljYWwodC5kaXJlY3Rpb24pfHxuLm9wdGlvbnMuZHJhZ19ibG9ja19ob3Jpem9udGFsJiYhZS5HZXN0dXJlcy51dGlscy5pc1ZlcnRpY2FsKHQuZGlyZWN0aW9uKSkmJnQucHJldmVudERlZmF1bHQoKTticmVhaztjYXNlIGUuR2VzdHVyZXMuRVZFTlRfRU5EOnRoaXMudHJpZ2dlcmVkJiZuLnRyaWdnZXIodGhpcy5uYW1lK1wiZW5kXCIsdCksdGhpcy50cmlnZ2VyZWQ9ITF9fX0sZS5HZXN0dXJlcy5nZXN0dXJlcy5UcmFuc2Zvcm09e25hbWU6XCJ0cmFuc2Zvcm1cIixpbmRleDo0NSxkZWZhdWx0czp7dHJhbnNmb3JtX21pbl9zY2FsZTouMDEsdHJhbnNmb3JtX21pbl9yb3RhdGlvbjoxLHRyYW5zZm9ybV9hbHdheXNfYmxvY2s6ITF9LHRyaWdnZXJlZDohMSxoYW5kbGVyOmZ1bmN0aW9uKHQsbil7aWYoZS5HZXN0dXJlcy5kZXRlY3Rpb24uY3VycmVudC5uYW1lIT10aGlzLm5hbWUmJnRoaXMudHJpZ2dlcmVkKXJldHVybiBuLnRyaWdnZXIodGhpcy5uYW1lK1wiZW5kXCIsdCksdm9pZCh0aGlzLnRyaWdnZXJlZD0hMSk7aWYoISh0LnRvdWNoZXMubGVuZ3RoPDIpKXN3aXRjaChuLm9wdGlvbnMudHJhbnNmb3JtX2Fsd2F5c19ibG9jayYmdC5wcmV2ZW50RGVmYXVsdCgpLHQuZXZlbnRUeXBlKXtjYXNlIGUuR2VzdHVyZXMuRVZFTlRfU1RBUlQ6dGhpcy50cmlnZ2VyZWQ9ITE7YnJlYWs7Y2FzZSBlLkdlc3R1cmVzLkVWRU5UX01PVkU6dmFyIGk9TWF0aC5hYnMoMS10LnNjYWxlKSxyPU1hdGguYWJzKHQucm90YXRpb24pO2lmKGk8bi5vcHRpb25zLnRyYW5zZm9ybV9taW5fc2NhbGUmJnI8bi5vcHRpb25zLnRyYW5zZm9ybV9taW5fcm90YXRpb24pcmV0dXJuO2UuR2VzdHVyZXMuZGV0ZWN0aW9uLmN1cnJlbnQubmFtZT10aGlzLm5hbWUsdGhpcy50cmlnZ2VyZWR8fChuLnRyaWdnZXIodGhpcy5uYW1lK1wic3RhcnRcIix0KSx0aGlzLnRyaWdnZXJlZD0hMCksbi50cmlnZ2VyKHRoaXMubmFtZSx0KSxyPm4ub3B0aW9ucy50cmFuc2Zvcm1fbWluX3JvdGF0aW9uJiZuLnRyaWdnZXIoXCJyb3RhdGVcIix0KSxpPm4ub3B0aW9ucy50cmFuc2Zvcm1fbWluX3NjYWxlJiYobi50cmlnZ2VyKFwicGluY2hcIix0KSxuLnRyaWdnZXIoXCJwaW5jaFwiKyh0LnNjYWxlPDE/XCJpblwiOlwib3V0XCIpLHQpKTticmVhaztjYXNlIGUuR2VzdHVyZXMuRVZFTlRfRU5EOnRoaXMudHJpZ2dlcmVkJiZuLnRyaWdnZXIodGhpcy5uYW1lK1wiZW5kXCIsdCksdGhpcy50cmlnZ2VyZWQ9ITF9fX0sZS5HZXN0dXJlcy5nZXN0dXJlcy5Ub3VjaD17bmFtZTpcInRvdWNoXCIsaW5kZXg6LTEvMCxkZWZhdWx0czp7cHJldmVudF9kZWZhdWx0OiExLHByZXZlbnRfbW91c2VldmVudHM6ITF9LGhhbmRsZXI6ZnVuY3Rpb24odCxuKXtyZXR1cm4gbi5vcHRpb25zLnByZXZlbnRfbW91c2VldmVudHMmJnQucG9pbnRlclR5cGU9PWUuR2VzdHVyZXMuUE9JTlRFUl9NT1VTRT92b2lkIHQuc3RvcERldGVjdCgpOihuLm9wdGlvbnMucHJldmVudF9kZWZhdWx0JiZ0LnByZXZlbnREZWZhdWx0KCksdm9pZCh0LmV2ZW50VHlwZT09ZS5HZXN0dXJlcy5FVkVOVF9TVEFSVCYmbi50cmlnZ2VyKHRoaXMubmFtZSx0KSkpfX0sZS5HZXN0dXJlcy5nZXN0dXJlcy5SZWxlYXNlPXtuYW1lOlwicmVsZWFzZVwiLGluZGV4OjEvMCxoYW5kbGVyOmZ1bmN0aW9uKHQsbil7dC5ldmVudFR5cGU9PWUuR2VzdHVyZXMuRVZFTlRfRU5EJiZuLnRyaWdnZXIodGhpcy5uYW1lLHQpfX19KHdpbmRvdy5pb25pYyksZnVuY3Rpb24oZSx0LG4pe2Z1bmN0aW9uIGkoKXtuLlBsYXRmb3JtLmlzV2ViVmlldygpP3QuYWRkRXZlbnRMaXN0ZW5lcihcImRldmljZXJlYWR5XCIsciwhMSk6cigpLGwmJmUucmVtb3ZlRXZlbnRMaXN0ZW5lcihcImxvYWRcIixpLCExKX1mdW5jdGlvbiByKCl7bi5QbGF0Zm9ybS5pc1JlYWR5PSEwLG4uUGxhdGZvcm0uZGV0ZWN0KCk7Zm9yKHZhciBlPTA7ZTxoLmxlbmd0aDtlKyspaFtlXSgpO2g9W10sbi50cmlnZ2VyKFwicGxhdGZvcm1yZWFkeVwiLHt0YXJnZXQ6dH0pLG4ucmVxdWVzdEFuaW1hdGlvbkZyYW1lKGZ1bmN0aW9uKCl7dC5ib2R5LmNsYXNzTGlzdC5hZGQoXCJwbGF0Zm9ybS1yZWFkeVwiKX0pfXZhciBvPVwiaW9zXCIscz1cImFuZHJvaWRcIixhPVwid2luZG93c3Bob25lXCI7bi5QbGF0Zm9ybT17bmF2aWdhdG9yOmUubmF2aWdhdG9yLGlzUmVhZHk6ITEsaXNGdWxsU2NyZWVuOiExLHBsYXRmb3JtczpudWxsLGdyYWRlOm51bGwsdWE6bmF2aWdhdG9yLnVzZXJBZ2VudCxyZWFkeTpmdW5jdGlvbihlKXt0aGlzLmlzUmVhZHk/ZSgpOmgucHVzaChlKX0sZGV0ZWN0OmZ1bmN0aW9uKCl7bi5QbGF0Zm9ybS5fY2hlY2tQbGF0Zm9ybXMoKSxuLnJlcXVlc3RBbmltYXRpb25GcmFtZShmdW5jdGlvbigpe2Zvcih2YXIgZT0wO2U8bi5QbGF0Zm9ybS5wbGF0Zm9ybXMubGVuZ3RoO2UrKyl0LmJvZHkuY2xhc3NMaXN0LmFkZChcInBsYXRmb3JtLVwiK24uUGxhdGZvcm0ucGxhdGZvcm1zW2VdKX0pfSxzZXRHcmFkZTpmdW5jdGlvbihlKXt2YXIgaT10aGlzLmdyYWRlO3RoaXMuZ3JhZGU9ZSxuLnJlcXVlc3RBbmltYXRpb25GcmFtZShmdW5jdGlvbigpe2kmJnQuYm9keS5jbGFzc0xpc3QucmVtb3ZlKFwiZ3JhZGUtXCIraSksdC5ib2R5LmNsYXNzTGlzdC5hZGQoXCJncmFkZS1cIitlKX0pfSxkZXZpY2U6ZnVuY3Rpb24oKXtyZXR1cm4gZS5kZXZpY2V8fHt9fSxfY2hlY2tQbGF0Zm9ybXM6ZnVuY3Rpb24oKXt0aGlzLnBsYXRmb3Jtcz1bXTt2YXIgZT1cImFcIjt0aGlzLmlzV2ViVmlldygpPyh0aGlzLnBsYXRmb3Jtcy5wdXNoKFwid2Vidmlld1wiKSx0aGlzLnBsYXRmb3Jtcy5wdXNoKFwiY29yZG92YVwiKSk6dGhpcy5wbGF0Zm9ybXMucHVzaChcImJyb3dzZXJcIiksdGhpcy5pc0lQYWQoKSYmdGhpcy5wbGF0Zm9ybXMucHVzaChcImlwYWRcIik7dmFyIHQ9dGhpcy5wbGF0Zm9ybSgpO2lmKHQpe3RoaXMucGxhdGZvcm1zLnB1c2godCk7dmFyIG49dGhpcy52ZXJzaW9uKCk7aWYobil7dmFyIGk9bi50b1N0cmluZygpO2kuaW5kZXhPZihcIi5cIik+MD9pPWkucmVwbGFjZShcIi5cIixcIl9cIik6aSs9XCJfMFwiLHRoaXMucGxhdGZvcm1zLnB1c2godCtpLnNwbGl0KFwiX1wiKVswXSksdGhpcy5wbGF0Zm9ybXMucHVzaCh0K2kpLHRoaXMuaXNBbmRyb2lkKCkmJjQuND5uP2U9ND5uP1wiY1wiOlwiYlwiOnRoaXMuaXNXaW5kb3dzUGhvbmUoKSYmKGU9XCJiXCIpfX10aGlzLnNldEdyYWRlKGUpfSxpc1dlYlZpZXc6ZnVuY3Rpb24oKXtyZXR1cm4hKCFlLmNvcmRvdmEmJiFlLlBob25lR2FwJiYhZS5waG9uZWdhcCl9LGlzSVBhZDpmdW5jdGlvbigpe3JldHVybi9pUGFkL2kudGVzdChuLlBsYXRmb3JtLm5hdmlnYXRvci5wbGF0Zm9ybSk/ITA6L2lQYWQvaS50ZXN0KHRoaXMudWEpfSxpc0lPUzpmdW5jdGlvbigpe3JldHVybiB0aGlzLmlzKG8pfSxpc0FuZHJvaWQ6ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5pcyhzKX0saXNXaW5kb3dzUGhvbmU6ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5pcyhhKX0scGxhdGZvcm06ZnVuY3Rpb24oKXtyZXR1cm4gbnVsbD09PWMmJnRoaXMuc2V0UGxhdGZvcm0odGhpcy5kZXZpY2UoKS5wbGF0Zm9ybSksY30sc2V0UGxhdGZvcm06ZnVuY3Rpb24oZSl7Yz1cInVuZGVmaW5lZFwiIT10eXBlb2YgZSYmbnVsbCE9PWUmJmUubGVuZ3RoP2UudG9Mb3dlckNhc2UoKTp0aGlzLnVhLmluZGV4T2YoXCJBbmRyb2lkXCIpPjA/czp0aGlzLnVhLmluZGV4T2YoXCJpUGhvbmVcIik+LTF8fHRoaXMudWEuaW5kZXhPZihcImlQYWRcIik+LTF8fHRoaXMudWEuaW5kZXhPZihcImlQb2RcIik+LTE/bzp0aGlzLnVhLmluZGV4T2YoXCJXaW5kb3dzIFBob25lXCIpPi0xP2E6bi5QbGF0Zm9ybS5uYXZpZ2F0b3IucGxhdGZvcm0mJm5hdmlnYXRvci5wbGF0Zm9ybS50b0xvd2VyQ2FzZSgpLnNwbGl0KFwiIFwiKVswXXx8XCJcIn0sdmVyc2lvbjpmdW5jdGlvbigpe3JldHVybiBudWxsPT09dSYmdGhpcy5zZXRWZXJzaW9uKHRoaXMuZGV2aWNlKCkudmVyc2lvbiksdX0sc2V0VmVyc2lvbjpmdW5jdGlvbihlKXtpZihcInVuZGVmaW5lZFwiIT10eXBlb2YgZSYmbnVsbCE9PWUmJihlPWUuc3BsaXQoXCIuXCIpLGU9cGFyc2VGbG9hdChlWzBdK1wiLlwiKyhlLmxlbmd0aD4xP2VbMV06MCkpLCFpc05hTihlKSkpcmV0dXJuIHZvaWQodT1lKTt1PTA7dmFyIHQ9dGhpcy5wbGF0Zm9ybSgpLG49e2FuZHJvaWQ6L0FuZHJvaWQgKFxcZCspLihcXGQrKT8vLGlvczovT1MgKFxcZCspXyhcXGQrKT8vLHdpbmRvd3NwaG9uZTovV2luZG93cyBQaG9uZSAoXFxkKykuKFxcZCspPy99O25bdF0mJihlPXRoaXMudWEubWF0Y2goblt0XSksZSYmZS5sZW5ndGg+MiYmKHU9cGFyc2VGbG9hdChlWzFdK1wiLlwiK2VbMl0pKSl9LGlzOmZ1bmN0aW9uKGUpe2lmKGU9ZS50b0xvd2VyQ2FzZSgpLHRoaXMucGxhdGZvcm1zKWZvcih2YXIgdD0wO3Q8dGhpcy5wbGF0Zm9ybXMubGVuZ3RoO3QrKylpZih0aGlzLnBsYXRmb3Jtc1t0XT09PWUpcmV0dXJuITA7dmFyIG49dGhpcy5wbGF0Zm9ybSgpO3JldHVybiBuP249PT1lLnRvTG93ZXJDYXNlKCk6dGhpcy51YS50b0xvd2VyQ2FzZSgpLmluZGV4T2YoZSk+PTB9LGV4aXRBcHA6ZnVuY3Rpb24oKXt0aGlzLnJlYWR5KGZ1bmN0aW9uKCl7bmF2aWdhdG9yLmFwcCYmbmF2aWdhdG9yLmFwcC5leGl0QXBwJiZuYXZpZ2F0b3IuYXBwLmV4aXRBcHAoKX0pfSxzaG93U3RhdHVzQmFyOmZ1bmN0aW9uKGkpe3RoaXMuX3Nob3dTdGF0dXNCYXI9aSx0aGlzLnJlYWR5KGZ1bmN0aW9uKCl7bi5yZXF1ZXN0QW5pbWF0aW9uRnJhbWUoZnVuY3Rpb24oKXtuLlBsYXRmb3JtLl9zaG93U3RhdHVzQmFyPyhlLlN0YXR1c0JhciYmZS5TdGF0dXNCYXIuc2hvdygpLHQuYm9keS5jbGFzc0xpc3QucmVtb3ZlKFwic3RhdHVzLWJhci1oaWRlXCIpKTooZS5TdGF0dXNCYXImJmUuU3RhdHVzQmFyLmhpZGUoKSx0LmJvZHkuY2xhc3NMaXN0LmFkZChcInN0YXR1cy1iYXItaGlkZVwiKSl9KX0pfSxmdWxsU2NyZWVuOmZ1bmN0aW9uKGUsaSl7dGhpcy5pc0Z1bGxTY3JlZW49ZSE9PSExLG4uRG9tVXRpbC5yZWFkeShmdW5jdGlvbigpe24ucmVxdWVzdEFuaW1hdGlvbkZyYW1lKGZ1bmN0aW9uKCl7cGFuZXM9dC5nZXRFbGVtZW50c0J5Q2xhc3NOYW1lKFwicGFuZVwiKTtmb3IodmFyIGU9MDtlPHBhbmVzLmxlbmd0aDtlKyspcGFuZXNbZV0uc3R5bGUuaGVpZ2h0PXBhbmVzW2VdLm9mZnNldEhlaWdodCtcInB4XCI7bi5QbGF0Zm9ybS5pc0Z1bGxTY3JlZW4/dC5ib2R5LmNsYXNzTGlzdC5hZGQoXCJmdWxsc2NyZWVuXCIpOnQuYm9keS5jbGFzc0xpc3QucmVtb3ZlKFwiZnVsbHNjcmVlblwiKX0pLG4uUGxhdGZvcm0uc2hvd1N0YXR1c0JhcihpPT09ITApfSl9fTt2YXIgbCxjPW51bGwsdT1udWxsLGg9W107XCJjb21wbGV0ZVwiPT09dC5yZWFkeVN0YXRlP2koKToobD0hMCxlLmFkZEV2ZW50TGlzdGVuZXIoXCJsb2FkXCIsaSwhMSkpLGUuYWRkRXZlbnRMaXN0ZW5lcihcImxvYWRcIixpLCExKX0odGhpcyxkb2N1bWVudCxpb25pYyksZnVuY3Rpb24oZSx0KXtcInVzZSBzdHJpY3RcIjt0LkNTUz17fSxmdW5jdGlvbigpe3ZhciBuLGk9W1wid2Via2l0VHJhbnNmb3JtXCIsXCJ0cmFuc2Zvcm1cIixcIi13ZWJraXQtdHJhbnNmb3JtXCIsXCJ3ZWJraXQtdHJhbnNmb3JtXCIsXCItbW96LXRyYW5zZm9ybVwiLFwibW96LXRyYW5zZm9ybVwiLFwiTW96VHJhbnNmb3JtXCIsXCJtb3pUcmFuc2Zvcm1cIixcIm1zVHJhbnNmb3JtXCJdO2ZvcihuPTA7bjxpLmxlbmd0aDtuKyspaWYodm9pZCAwIT09ZS5kb2N1bWVudEVsZW1lbnQuc3R5bGVbaVtuXV0pe3QuQ1NTLlRSQU5TRk9STT1pW25dO2JyZWFrfWZvcihpPVtcIndlYmtpdFRyYW5zaXRpb25cIixcIm1velRyYW5zaXRpb25cIixcIm1zVHJhbnNpdGlvblwiLFwidHJhbnNpdGlvblwiXSxuPTA7bjxpLmxlbmd0aDtuKyspaWYodm9pZCAwIT09ZS5kb2N1bWVudEVsZW1lbnQuc3R5bGVbaVtuXV0pe3QuQ1NTLlRSQU5TSVRJT049aVtuXTticmVha319KCksXCJjbGFzc0xpc3RcImluIGUuZG9jdW1lbnRFbGVtZW50fHwhT2JqZWN0LmRlZmluZVByb3BlcnR5fHxcInVuZGVmaW5lZFwiPT10eXBlb2YgSFRNTEVsZW1lbnR8fE9iamVjdC5kZWZpbmVQcm9wZXJ0eShIVE1MRWxlbWVudC5wcm90b3R5cGUsXCJjbGFzc0xpc3RcIix7Z2V0OmZ1bmN0aW9uKCl7ZnVuY3Rpb24gZShlKXtyZXR1cm4gZnVuY3Rpb24oKXt2YXIgbixpPXQuY2xhc3NOYW1lLnNwbGl0KC9cXHMrLyk7Zm9yKG49MDtuPGFyZ3VtZW50cy5sZW5ndGg7bisrKWUoaSxpLmluZGV4T2YoYXJndW1lbnRzW25dKSxhcmd1bWVudHNbbl0pO3QuY2xhc3NOYW1lPWkuam9pbihcIiBcIil9fXZhciB0PXRoaXM7cmV0dXJue2FkZDplKGZ1bmN0aW9uKGUsdCxuKXt+dHx8ZS5wdXNoKG4pfSkscmVtb3ZlOmUoZnVuY3Rpb24oZSx0KXt+dCYmZS5zcGxpY2UodCwxKX0pLHRvZ2dsZTplKGZ1bmN0aW9uKGUsdCxuKXt+dD9lLnNwbGljZSh0LDEpOmUucHVzaChuKX0pLGNvbnRhaW5zOmZ1bmN0aW9uKGUpe3JldHVybiEhfnQuY2xhc3NOYW1lLnNwbGl0KC9cXHMrLykuaW5kZXhPZihlKX0saXRlbTpmdW5jdGlvbihlKXtyZXR1cm4gdC5jbGFzc05hbWUuc3BsaXQoL1xccysvKVtlXXx8bnVsbH19fX0pfShkb2N1bWVudCxpb25pYyk7dmFyIGssWSxYLEgseixGLFcscSxVPVwidG91Y2htb3ZlXCIsQj02LFo9NTAsaj17Y2xpY2s6aSxtb3VzZWRvd246cixtb3VzZXVwOm8sbW91c2Vtb3ZlOnMsdG91Y2hzdGFydDphLHRvdWNoZW5kOmwsdG91Y2hjYW5jZWw6dSx0b3VjaG1vdmU6Yyxwb2ludGVyZG93bjphLHBvaW50ZXJ1cDpsLHBvaW50ZXJjYW5jZWw6dSxwb2ludGVybW92ZTpjLE1TUG9pbnRlckRvd246YSxNU1BvaW50ZXJVcDpsLE1TUG9pbnRlckNhbmNlbDp1LE1TUG9pbnRlck1vdmU6Yyxmb2N1c2luOnAsZm9jdXNvdXQ6bX07aW9uaWMudGFwPXtyZWdpc3RlcjpmdW5jdGlvbih0KXtyZXR1cm4gaz10LGUoXCJjbGlja1wiLCEwLCEwKSxlKFwibW91c2V1cFwiKSxlKFwibW91c2Vkb3duXCIpLHdpbmRvdy5uYXZpZ2F0b3IucG9pbnRlckVuYWJsZWQ/KGUoXCJwb2ludGVyZG93blwiKSxlKFwicG9pbnRlcnVwXCIpLGUoXCJwb2ludGNhbmNlbFwiKSxVPVwicG9pbnRlcm1vdmVcIik6d2luZG93Lm5hdmlnYXRvci5tc1BvaW50ZXJFbmFibGVkPyhlKFwiTVNQb2ludGVyRG93blwiKSxlKFwiTVNQb2ludGVyVXBcIiksZShcIk1TUG9pbnRlckNhbmNlbFwiKSxVPVwiTVNQb2ludGVyTW92ZVwiKTooZShcInRvdWNoc3RhcnRcIiksZShcInRvdWNoZW5kXCIpLGUoXCJ0b3VjaGNhbmNlbFwiKSksZShcImZvY3VzaW5cIiksZShcImZvY3Vzb3V0XCIpLGZ1bmN0aW9uKCl7Zm9yKHZhciB0IGluIGopZSh0LCExKTtrPW51bGwsWT1udWxsLFg9ITEsej0hMSxGPW51bGx9fSxpZ25vcmVTY3JvbGxTdGFydDpmdW5jdGlvbihlKXtyZXR1cm4gZS5kZWZhdWx0UHJldmVudGVkfHwvXihmaWxlfHJhbmdlKSQvaS50ZXN0KGUudGFyZ2V0LnR5cGUpfHxcInRydWVcIj09KGUudGFyZ2V0LmRhdGFzZXQ/ZS50YXJnZXQuZGF0YXNldC5wcmV2ZW50U2Nyb2xsOmUudGFyZ2V0LmdldEF0dHJpYnV0ZShcImRhdGEtcHJldmVudC1zY3JvbGxcIikpfHwhIS9eKG9iamVjdHxlbWJlZCkkL2kudGVzdChlLnRhcmdldC50YWdOYW1lKXx8aW9uaWMudGFwLmlzRWxlbWVudFRhcERpc2FibGVkKGUudGFyZ2V0KX0saXNUZXh0SW5wdXQ6ZnVuY3Rpb24oZSl7cmV0dXJuISFlJiYoXCJURVhUQVJFQVwiPT1lLnRhZ05hbWV8fFwidHJ1ZVwiPT09ZS5jb250ZW50RWRpdGFibGV8fFwiSU5QVVRcIj09ZS50YWdOYW1lJiYhL14ocmFkaW98Y2hlY2tib3h8cmFuZ2V8ZmlsZXxzdWJtaXR8cmVzZXQpJC9pLnRlc3QoZS50eXBlKSl9LGlzRGF0ZUlucHV0OmZ1bmN0aW9uKGUpe3JldHVybiEhZSYmXCJJTlBVVFwiPT1lLnRhZ05hbWUmJi9eKGRhdGV8dGltZXxkYXRldGltZS1sb2NhbHxtb250aHx3ZWVrKSQvaS50ZXN0KGUudHlwZSl9LGlzTGFiZWxXaXRoVGV4dElucHV0OmZ1bmN0aW9uKGUpe3ZhciB0PVQoZSwhMSk7cmV0dXJuISF0JiZpb25pYy50YXAuaXNUZXh0SW5wdXQoRSh0KSl9LGNvbnRhaW5zT3JJc1RleHRJbnB1dDpmdW5jdGlvbihlKXtyZXR1cm4gaW9uaWMudGFwLmlzVGV4dElucHV0KGUpfHxpb25pYy50YXAuaXNMYWJlbFdpdGhUZXh0SW5wdXQoZSl9LGNsb25lRm9jdXNlZElucHV0OmZ1bmN0aW9uKGUpe2lvbmljLnRhcC5oYXNDaGVja2VkQ2xvbmV8fChpb25pYy50YXAuaGFzQ2hlY2tlZENsb25lPSEwLGlvbmljLnJlcXVlc3RBbmltYXRpb25GcmFtZShmdW5jdGlvbigpe3ZhciB0PWUucXVlcnlTZWxlY3RvcihcIjpmb2N1c1wiKTtpZihpb25pYy50YXAuaXNUZXh0SW5wdXQodCkpe3ZhciBuPXQucGFyZW50RWxlbWVudC5xdWVyeVNlbGVjdG9yKFwiLmNsb25lZC10ZXh0LWlucHV0XCIpO258fChuPWRvY3VtZW50LmNyZWF0ZUVsZW1lbnQodC50YWdOYW1lKSxuLnBsYWNlaG9sZGVyPXQucGxhY2Vob2xkZXIsbi50eXBlPXQudHlwZSxuLnZhbHVlPXQudmFsdWUsbi5zdHlsZT10LnN0eWxlLG4uY2xhc3NOYW1lPXQuY2xhc3NOYW1lLG4uY2xhc3NMaXN0LmFkZChcImNsb25lZC10ZXh0LWlucHV0XCIpLG4ucmVhZE9ubHk9ITAsdC5pc0NvbnRlbnRFZGl0YWJsZSYmKG4uY29udGVudEVkaXRhYmxlPXQuY29udGVudEVkaXRhYmxlLG4uaW5uZXJIVE1MPXQuaW5uZXJIVE1MKSx0LnBhcmVudEVsZW1lbnQuaW5zZXJ0QmVmb3JlKG4sdCksdC5zdHlsZS50b3A9dC5vZmZzZXRUb3AsdC5jbGFzc0xpc3QuYWRkKFwicHJldmlvdXMtaW5wdXQtZm9jdXNcIikpfX0pKX0saGFzQ2hlY2tlZENsb25lOiExLHJlbW92ZUNsb25lZElucHV0czpmdW5jdGlvbihlKXtpb25pYy50YXAuaGFzQ2hlY2tlZENsb25lPSExLGlvbmljLnJlcXVlc3RBbmltYXRpb25GcmFtZShmdW5jdGlvbigpe3ZhciB0LG49ZS5xdWVyeVNlbGVjdG9yQWxsKFwiLmNsb25lZC10ZXh0LWlucHV0XCIpLGk9ZS5xdWVyeVNlbGVjdG9yQWxsKFwiLnByZXZpb3VzLWlucHV0LWZvY3VzXCIpO2Zvcih0PTA7dDxuLmxlbmd0aDt0Kyspblt0XS5wYXJlbnRFbGVtZW50LnJlbW92ZUNoaWxkKG5bdF0pO2Zvcih0PTA7dDxpLmxlbmd0aDt0KyspaVt0XS5jbGFzc0xpc3QucmVtb3ZlKFwicHJldmlvdXMtaW5wdXQtZm9jdXNcIiksaVt0XS5zdHlsZS50b3A9XCJcIixpW3RdLmZvY3VzKCl9KX0scmVxdWlyZXNOYXRpdmVDbGljazpmdW5jdGlvbihlKXtyZXR1cm4hZXx8ZS5kaXNhYmxlZHx8L14oZmlsZXxyYW5nZSkkL2kudGVzdChlLnR5cGUpfHwvXihvYmplY3R8dmlkZW8pJC9pLnRlc3QoZS50YWdOYW1lKXx8aW9uaWMudGFwLmlzTGFiZWxDb250YWluaW5nRmlsZUlucHV0KGUpPyEwOmlvbmljLnRhcC5pc0VsZW1lbnRUYXBEaXNhYmxlZChlKX0saXNMYWJlbENvbnRhaW5pbmdGaWxlSW5wdXQ6ZnVuY3Rpb24oZSl7dmFyIHQ9VChlKTtpZihcIkxBQkVMXCIhPT10LnRhZ05hbWUpcmV0dXJuITE7dmFyIG49dC5xdWVyeVNlbGVjdG9yKFwiaW5wdXRbdHlwZT1maWxlXVwiKTtyZXR1cm4gbiYmbi5kaXNhYmxlZD09PSExPyEwOiExfSxpc0VsZW1lbnRUYXBEaXNhYmxlZDpmdW5jdGlvbihlKXtpZihlJiYxPT09ZS5ub2RlVHlwZSlmb3IodmFyIHQ9ZTt0Oyl7aWYoXCJ0cnVlXCI9PSh0LmRhdGFzZXQ/dC5kYXRhc2V0LnRhcERpc2FibGVkOnQuZ2V0QXR0cmlidXRlKFwiZGF0YS10YXAtZGlzYWJsZWRcIikpKXJldHVybiEwO3Q9dC5wYXJlbnRFbGVtZW50fXJldHVybiExfSxzZXRUb2xlcmFuY2U6ZnVuY3Rpb24oZSx0KXtCPWUsWj10fSxjYW5jZWxDbGljazpmdW5jdGlvbigpe3o9ITB9LHBvaW50ZXJDb29yZDpmdW5jdGlvbihlKXt2YXIgdD17eDowLHk6MH07aWYoZSl7dmFyIG49ZS50b3VjaGVzJiZlLnRvdWNoZXMubGVuZ3RoP2UudG91Y2hlczpbZV0saT1lLmNoYW5nZWRUb3VjaGVzJiZlLmNoYW5nZWRUb3VjaGVzWzBdfHxuWzBdO2kmJih0Lng9aS5jbGllbnRYfHxpLnBhZ2VYfHwwLHQueT1pLmNsaWVudFl8fGkucGFnZVl8fDApfXJldHVybiB0fX0saW9uaWMuRG9tVXRpbC5yZWFkeShmdW5jdGlvbigpe3ZhciBlPVwidW5kZWZpbmVkXCIhPXR5cGVvZiBhbmd1bGFyP2FuZ3VsYXI6bnVsbDsoIWV8fGUmJiFlLnNjZW5hcmlvKSYmaW9uaWMudGFwLnJlZ2lzdGVyKGRvY3VtZW50KX0pLGZ1bmN0aW9uKGUsdCl7XCJ1c2Ugc3RyaWN0XCI7ZnVuY3Rpb24gbigpe289e30sdC5yZXF1ZXN0QW5pbWF0aW9uRnJhbWUocil9ZnVuY3Rpb24gaSgpe2Zvcih2YXIgZSBpbiBvKW9bZV0mJihvW2VdLmNsYXNzTGlzdC5hZGQobCksc1tlXT1vW2VdKTtvPXt9fWZ1bmN0aW9uIHIoKXtmb3IodmFyIGUgaW4gcylzW2VdJiYoc1tlXS5jbGFzc0xpc3QucmVtb3ZlKGwpLGRlbGV0ZSBzW2VdKX12YXIgbz17fSxzPXt9LGE9MCxsPVwiYWN0aXZhdGVkXCI7dC5hY3RpdmF0b3I9e3N0YXJ0OmZ1bmN0aW9uKGUpe3ZhciBuPXRoaXM7dC5yZXF1ZXN0QW5pbWF0aW9uRnJhbWUoZnVuY3Rpb24oKXtpZighdC50YXAucmVxdWlyZXNOYXRpdmVDbGljayhlLnRhcmdldCkpe2Zvcih2YXIgcixzPWUudGFyZ2V0LGw9MDs2PmwmJihzJiYxPT09cy5ub2RlVHlwZSk7bCsrKXtpZihyJiZzLmNsYXNzTGlzdC5jb250YWlucyhcIml0ZW1cIikpe3I9czticmVha31pZihcIkFcIj09cy50YWdOYW1lfHxcIkJVVFRPTlwiPT1zLnRhZ05hbWV8fHMuaGFzQXR0cmlidXRlKFwibmctY2xpY2tcIikpe3I9cztcbmJyZWFrfWlmKHMuY2xhc3NMaXN0LmNvbnRhaW5zKFwiYnV0dG9uXCIpKXtyPXM7YnJlYWt9aWYocy5jbGFzc0xpc3QuY29udGFpbnMoXCJwYW5lXCIpfHxcIkJPRFlcIj09cy50YWdOYW1lfHxcIklPTi1DT05URU5UXCI9PXMudGFnTmFtZSlicmVhaztzPXMucGFyZW50RWxlbWVudH1yJiYob1thXT1yLFwidG91Y2hzdGFydFwiPT09ZS50eXBlP24uX2FjdGl2YXRlVGltZW91dD1zZXRUaW1lb3V0KGksODApOnQucmVxdWVzdEFuaW1hdGlvbkZyYW1lKGkpLGE9YT4xOT8wOmErMSl9fSl9LGVuZDpmdW5jdGlvbigpe2NsZWFyVGltZW91dCh0aGlzLl9hY3RpdmF0ZVRpbWVvdXQpLHNldFRpbWVvdXQobiwyMDApfX19KGRvY3VtZW50LGlvbmljKSxmdW5jdGlvbihlKXt2YXIgdD1bXCIwXCIsXCIwXCIsXCIwXCJdO2UuVXRpbHM9e2FycmF5TW92ZTpmdW5jdGlvbihlLHQsbil7aWYobj49ZS5sZW5ndGgpZm9yKHZhciBpPW4tZS5sZW5ndGg7aS0tKzE7KWUucHVzaCh2b2lkIDApO3JldHVybiBlLnNwbGljZShuLDAsZS5zcGxpY2UodCwxKVswXSksZX0scHJveHk6ZnVuY3Rpb24oZSx0KXt2YXIgbj1BcnJheS5wcm90b3R5cGUuc2xpY2UuY2FsbChhcmd1bWVudHMsMik7cmV0dXJuIGZ1bmN0aW9uKCl7cmV0dXJuIGUuYXBwbHkodCxuLmNvbmNhdChBcnJheS5wcm90b3R5cGUuc2xpY2UuY2FsbChhcmd1bWVudHMpKSl9fSxkZWJvdW5jZTpmdW5jdGlvbihlLHQsbil7dmFyIGkscixvLHMsYTtyZXR1cm4gZnVuY3Rpb24oKXtvPXRoaXMscj1hcmd1bWVudHMscz1uZXcgRGF0ZTt2YXIgbD1mdW5jdGlvbigpe3ZhciBjPW5ldyBEYXRlLXM7dD5jP2k9c2V0VGltZW91dChsLHQtYyk6KGk9bnVsbCxufHwoYT1lLmFwcGx5KG8scikpKX0sYz1uJiYhaTtyZXR1cm4gaXx8KGk9c2V0VGltZW91dChsLHQpKSxjJiYoYT1lLmFwcGx5KG8scikpLGF9fSx0aHJvdHRsZTpmdW5jdGlvbihlLHQsbil7dmFyIGkscixvLHM9bnVsbCxhPTA7bnx8KG49e30pO3ZhciBsPWZ1bmN0aW9uKCl7YT1uLmxlYWRpbmc9PT0hMT8wOkRhdGUubm93KCkscz1udWxsLG89ZS5hcHBseShpLHIpfTtyZXR1cm4gZnVuY3Rpb24oKXt2YXIgYz1EYXRlLm5vdygpO2F8fG4ubGVhZGluZyE9PSExfHwoYT1jKTt2YXIgdT10LShjLWEpO3JldHVybiBpPXRoaXMscj1hcmd1bWVudHMsMD49dT8oY2xlYXJUaW1lb3V0KHMpLHM9bnVsbCxhPWMsbz1lLmFwcGx5KGkscikpOnN8fG4udHJhaWxpbmc9PT0hMXx8KHM9c2V0VGltZW91dChsLHUpKSxvfX0saW5oZXJpdDpmdW5jdGlvbih0LG4pe3ZhciBpLHI9dGhpcztpPXQmJnQuaGFzT3duUHJvcGVydHkoXCJjb25zdHJ1Y3RvclwiKT90LmNvbnN0cnVjdG9yOmZ1bmN0aW9uKCl7cmV0dXJuIHIuYXBwbHkodGhpcyxhcmd1bWVudHMpfSxlLmV4dGVuZChpLHIsbik7dmFyIG89ZnVuY3Rpb24oKXt0aGlzLmNvbnN0cnVjdG9yPWl9O3JldHVybiBvLnByb3RvdHlwZT1yLnByb3RvdHlwZSxpLnByb3RvdHlwZT1uZXcgbyx0JiZlLmV4dGVuZChpLnByb3RvdHlwZSx0KSxpLl9fc3VwZXJfXz1yLnByb3RvdHlwZSxpfSxleHRlbmQ6ZnVuY3Rpb24oZSl7Zm9yKHZhciB0PUFycmF5LnByb3RvdHlwZS5zbGljZS5jYWxsKGFyZ3VtZW50cywxKSxuPTA7bjx0Lmxlbmd0aDtuKyspe3ZhciBpPXRbbl07aWYoaSlmb3IodmFyIHIgaW4gaSllW3JdPWlbcl19cmV0dXJuIGV9LG5leHRVaWQ6ZnVuY3Rpb24oKXtmb3IodmFyIGUsbj10Lmxlbmd0aDtuOyl7aWYobi0tLGU9dFtuXS5jaGFyQ29kZUF0KDApLDU3PT1lKXJldHVybiB0W25dPVwiQVwiLHQuam9pbihcIlwiKTtpZig5MCE9ZSlyZXR1cm4gdFtuXT1TdHJpbmcuZnJvbUNoYXJDb2RlKGUrMSksdC5qb2luKFwiXCIpO3Rbbl09XCIwXCJ9cmV0dXJuIHQudW5zaGlmdChcIjBcIiksdC5qb2luKFwiXCIpfX0sZS5pbmhlcml0PWUuVXRpbHMuaW5oZXJpdCxlLmV4dGVuZD1lLlV0aWxzLmV4dGVuZCxlLnRocm90dGxlPWUuVXRpbHMudGhyb3R0bGUsZS5wcm94eT1lLlV0aWxzLnByb3h5LGUuZGVib3VuY2U9ZS5VdGlscy5kZWJvdW5jZX0od2luZG93LmlvbmljKTt2YXIgJCxLLEosUSxldD1DKCksdHQ9MCxudD1cImtleWJvYXJkLW9wZW5cIixpdD1cInNjcm9sbFwiO2lvbmljLmtleWJvYXJkPXtpc09wZW46ITEsaGVpZ2h0Om51bGwsbGFuZHNjYXBlOiExLGhpZGU6ZnVuY3Rpb24oKXtjbGVhclRpbWVvdXQoSiksY2xlYXJUaW1lb3V0KEspLGNsZWFyVGltZW91dChRKSxpb25pYy5rZXlib2FyZC5pc09wZW49ITEsaW9uaWMudHJpZ2dlcihcInJlc2V0U2Nyb2xsVmlld1wiLHt0YXJnZXQ6JH0sITApLGlvbmljLnJlcXVlc3RBbmltYXRpb25GcmFtZShmdW5jdGlvbigpe2RvY3VtZW50LmJvZHkuY2xhc3NMaXN0LnJlbW92ZShudCl9KSx3aW5kb3cubmF2aWdhdG9yLm1zUG9pbnRlckVuYWJsZWQ/ZG9jdW1lbnQucmVtb3ZlRXZlbnRMaXN0ZW5lcihcIk1TUG9pbnRlck1vdmVcIixOKTpkb2N1bWVudC5yZW1vdmVFdmVudExpc3RlbmVyKFwidG91Y2htb3ZlXCIsTiksZG9jdW1lbnQucmVtb3ZlRXZlbnRMaXN0ZW5lcihcImtleWRvd25cIixNKSxBKCkmJmNvcmRvdmEucGx1Z2lucy5LZXlib2FyZC5jbG9zZSgpfSxzaG93OmZ1bmN0aW9uKCl7QSgpJiZjb3Jkb3ZhLnBsdWdpbnMuS2V5Ym9hcmQuc2hvdygpfX0saW9uaWMuUGxhdGZvcm0ucmVhZHkoZnVuY3Rpb24oKXt4KCksc2V0VGltZW91dCh4LDk5OSksd2luZG93Lm5hdmlnYXRvci5tc1BvaW50ZXJFbmFibGVkP2RvY3VtZW50LmFkZEV2ZW50TGlzdGVuZXIoXCJNU1BvaW50ZXJEb3duXCIsUywhMSk6ZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lcihcInRvdWNoc3RhcnRcIixTLCExKX0pO3ZhciBydCxvdD17fTtpb25pYy52aWV3cG9ydD17b3JpZW50YXRpb246ZnVuY3Rpb24oKXtyZXR1cm4gd2luZG93LmlubmVyV2lkdGg+d2luZG93LmlubmVySGVpZ2h0PzkwOjB9fSxpb25pYy5QbGF0Zm9ybS5yZWFkeShmdW5jdGlvbigpe08oKSx3aW5kb3cuYWRkRXZlbnRMaXN0ZW5lcihcIm9yaWVudGF0aW9uY2hhbmdlXCIsZnVuY3Rpb24oKXtzZXRUaW1lb3V0KFIsMWUzKX0sITEpfSksZnVuY3Rpb24oZSl7XCJ1c2Ugc3RyaWN0XCI7ZS52aWV3cy5WaWV3PWZ1bmN0aW9uKCl7dGhpcy5pbml0aWFsaXplLmFwcGx5KHRoaXMsYXJndW1lbnRzKX0sZS52aWV3cy5WaWV3LmluaGVyaXQ9ZS5pbmhlcml0LGUuZXh0ZW5kKGUudmlld3MuVmlldy5wcm90b3R5cGUse2luaXRpYWxpemU6ZnVuY3Rpb24oKXt9fSl9KHdpbmRvdy5pb25pYyk7dmFyIHN0PXtlZmZlY3Q6e319OyFmdW5jdGlvbihlKXt2YXIgdD1EYXRlLm5vd3x8ZnVuY3Rpb24oKXtyZXR1cm4rbmV3IERhdGV9LG49NjAsaT0xZTMscj17fSxvPTE7c3QuZWZmZWN0LkFuaW1hdGU9e3JlcXVlc3RBbmltYXRpb25GcmFtZTpmdW5jdGlvbigpe3ZhciB0PWUucmVxdWVzdEFuaW1hdGlvbkZyYW1lfHxlLndlYmtpdFJlcXVlc3RBbmltYXRpb25GcmFtZXx8ZS5tb3pSZXF1ZXN0QW5pbWF0aW9uRnJhbWV8fGUub1JlcXVlc3RBbmltYXRpb25GcmFtZSxuPSEhdDtpZih0JiYhL3JlcXVlc3RBbmltYXRpb25GcmFtZVxcKFxcKVxccypcXHtcXHMqXFxbbmF0aXZlIGNvZGVcXF1cXHMqXFx9L2kudGVzdCh0LnRvU3RyaW5nKCkpJiYobj0hMSksbilyZXR1cm4gZnVuY3Rpb24oZSxuKXt0KGUsbil9O3ZhciBpPTYwLHI9e30sbz0wLHM9MSxhPW51bGwsbD0rbmV3IERhdGU7cmV0dXJuIGZ1bmN0aW9uKGUpe3ZhciB0PXMrKztyZXR1cm4gclt0XT1lLG8rKyxudWxsPT09YSYmKGE9c2V0SW50ZXJ2YWwoZnVuY3Rpb24oKXt2YXIgZT0rbmV3IERhdGUsdD1yO3I9e30sbz0wO2Zvcih2YXIgbiBpbiB0KXQuaGFzT3duUHJvcGVydHkobikmJih0W25dKGUpLGw9ZSk7ZS1sPjI1MDAmJihjbGVhckludGVydmFsKGEpLGE9bnVsbCl9LDFlMy9pKSksdH19KCksc3RvcDpmdW5jdGlvbihlKXt2YXIgdD1udWxsIT1yW2VdO3JldHVybiB0JiYocltlXT1udWxsKSx0fSxpc1J1bm5pbmc6ZnVuY3Rpb24oZSl7cmV0dXJuIG51bGwhPXJbZV19LHN0YXJ0OmZ1bmN0aW9uKGUscyxhLGwsYyx1KXt2YXIgaD10KCksZD1oLF89MCxmPTAscD1vKys7aWYodXx8KHU9ZG9jdW1lbnQuYm9keSkscCUyMD09PTApe3ZhciBtPXt9O2Zvcih2YXIgZyBpbiByKW1bZ109ITA7cj1tfXZhciB2PWZ1bmN0aW9uKG8pe3ZhciBtPW8hPT0hMCxnPXQoKTtpZighcltwXXx8cyYmIXMocCkpcmV0dXJuIHJbcF09bnVsbCx2b2lkKGEmJmEobi1mLygoZy1oKS9pKSxwLCExKSk7aWYobSlmb3IodmFyIFQ9TWF0aC5yb3VuZCgoZy1kKS8oaS9uKSktMSxFPTA7RTxNYXRoLm1pbihULDQpO0UrKyl2KCEwKSxmKys7bCYmKF89KGctaCkvbCxfPjEmJihfPTEpKTt2YXIgUz1jP2MoXyk6XztlKFMsZyxtKSE9PSExJiYxIT09X3x8IW0/bSYmKGQ9ZyxzdC5lZmZlY3QuQW5pbWF0ZS5yZXF1ZXN0QW5pbWF0aW9uRnJhbWUodix1KSk6KHJbcF09bnVsbCxhJiZhKG4tZi8oKGctaCkvaSkscCwxPT09X3x8bnVsbD09bCkpfTtyZXR1cm4gcltwXT0hMCxzdC5lZmZlY3QuQW5pbWF0ZS5yZXF1ZXN0QW5pbWF0aW9uRnJhbWUodix1KSxwfX19KHRoaXMpOyFmdW5jdGlvbihlKXt2YXIgdD1mdW5jdGlvbigpe30sbj1mdW5jdGlvbihlKXtyZXR1cm4gTWF0aC5wb3coZS0xLDMpKzF9LGk9ZnVuY3Rpb24oZSl7cmV0dXJuKGUvPS41KTwxPy41Kk1hdGgucG93KGUsMyk6LjUqKE1hdGgucG93KGUtMiwzKSsyKX07ZS52aWV3cy5TY3JvbGw9ZS52aWV3cy5WaWV3LmluaGVyaXQoe2luaXRpYWxpemU6ZnVuY3Rpb24obil7dmFyIGk9dGhpczt0aGlzLl9fY29udGFpbmVyPW4uZWwsdGhpcy5fX2NvbnRlbnQ9bi5lbC5maXJzdEVsZW1lbnRDaGlsZCxzZXRUaW1lb3V0KGZ1bmN0aW9uKCl7aS5fX2NvbnRhaW5lciYmaS5fX2NvbnRlbnQmJihpLl9fY29udGFpbmVyLnNjcm9sbFRvcD0wLGkuX19jb250ZW50LnNjcm9sbFRvcD0wKX0pLHRoaXMub3B0aW9ucz17c2Nyb2xsaW5nWDohMSxzY3JvbGxiYXJYOiEwLHNjcm9sbGluZ1k6ITAsc2Nyb2xsYmFyWTohMCxzdGFydFg6MCxzdGFydFk6MCx3aGVlbERhbXBlbjo2LG1pblNjcm9sbGJhclNpemVYOjUsbWluU2Nyb2xsYmFyU2l6ZVk6NSxzY3JvbGxiYXJzRmFkZTohMCxzY3JvbGxiYXJGYWRlRGVsYXk6MzAwLHNjcm9sbGJhclJlc2l6ZUZhZGVEZWxheToxZTMsYW5pbWF0aW5nOiEwLGFuaW1hdGlvbkR1cmF0aW9uOjI1MCxib3VuY2luZzohMCxsb2NraW5nOiEwLHBhZ2luZzohMSxzbmFwcGluZzohMSx6b29taW5nOiExLG1pblpvb206LjUsbWF4Wm9vbTozLHNwZWVkTXVsdGlwbGllcjoxLGRlY2VsZXJhdGlvbjouOTcsc2Nyb2xsaW5nQ29tcGxldGU6dCxwZW5ldHJhdGlvbkRlY2VsZXJhdGlvbjouMDMscGVuZXRyYXRpb25BY2NlbGVyYXRpb246LjA4LHNjcm9sbEV2ZW50SW50ZXJ2YWw6MTAsZ2V0Q29udGVudFdpZHRoOmZ1bmN0aW9uKCl7cmV0dXJuIE1hdGgubWF4KGkuX19jb250ZW50LnNjcm9sbFdpZHRoLGkuX19jb250ZW50Lm9mZnNldFdpZHRoKX0sZ2V0Q29udGVudEhlaWdodDpmdW5jdGlvbigpe3JldHVybiBNYXRoLm1heChpLl9fY29udGVudC5zY3JvbGxIZWlnaHQsaS5fX2NvbnRlbnQub2Zmc2V0SGVpZ2h0KzIqaS5fX2NvbnRlbnQub2Zmc2V0VG9wKX19O2Zvcih2YXIgciBpbiBuKXRoaXMub3B0aW9uc1tyXT1uW3JdO3RoaXMuaGludFJlc2l6ZT1lLmRlYm91bmNlKGZ1bmN0aW9uKCl7aS5yZXNpemUoKX0sMWUzLCEwKSx0aGlzLm9uU2Nyb2xsPWZ1bmN0aW9uKCl7ZS5zY3JvbGwuaXNTY3JvbGxpbmc/KGNsZWFyVGltZW91dChpLnNjcm9sbFRpbWVyKSxpLnNjcm9sbFRpbWVyPXNldFRpbWVvdXQoaS5zZXRTY3JvbGxTdG9wLDgwKSk6c2V0VGltZW91dChpLnNldFNjcm9sbFN0YXJ0LDUwKX0sdGhpcy5zZXRTY3JvbGxTdGFydD1mdW5jdGlvbigpe2Uuc2Nyb2xsLmlzU2Nyb2xsaW5nPU1hdGguYWJzKGUuc2Nyb2xsLmxhc3RUb3AtaS5fX3Njcm9sbFRvcCk+MSxjbGVhclRpbWVvdXQoaS5zY3JvbGxUaW1lciksaS5zY3JvbGxUaW1lcj1zZXRUaW1lb3V0KGkuc2V0U2Nyb2xsU3RvcCw4MCl9LHRoaXMuc2V0U2Nyb2xsU3RvcD1mdW5jdGlvbigpe2Uuc2Nyb2xsLmlzU2Nyb2xsaW5nPSExLGUuc2Nyb2xsLmxhc3RUb3A9aS5fX3Njcm9sbFRvcH0sdGhpcy50cmlnZ2VyU2Nyb2xsRXZlbnQ9ZS50aHJvdHRsZShmdW5jdGlvbigpe2kub25TY3JvbGwoKSxlLnRyaWdnZXIoXCJzY3JvbGxcIix7c2Nyb2xsVG9wOmkuX19zY3JvbGxUb3Asc2Nyb2xsTGVmdDppLl9fc2Nyb2xsTGVmdCx0YXJnZXQ6aS5fX2NvbnRhaW5lcn0pfSx0aGlzLm9wdGlvbnMuc2Nyb2xsRXZlbnRJbnRlcnZhbCksdGhpcy50cmlnZ2VyU2Nyb2xsRW5kRXZlbnQ9ZnVuY3Rpb24oKXtlLnRyaWdnZXIoXCJzY3JvbGxlbmRcIix7c2Nyb2xsVG9wOmkuX19zY3JvbGxUb3Asc2Nyb2xsTGVmdDppLl9fc2Nyb2xsTGVmdCx0YXJnZXQ6aS5fX2NvbnRhaW5lcn0pfSx0aGlzLl9fc2Nyb2xsTGVmdD10aGlzLm9wdGlvbnMuc3RhcnRYLHRoaXMuX19zY3JvbGxUb3A9dGhpcy5vcHRpb25zLnN0YXJ0WSx0aGlzLl9fY2FsbGJhY2s9dGhpcy5nZXRSZW5kZXJGbigpLHRoaXMuX19pbml0RXZlbnRIYW5kbGVycygpLHRoaXMuX19jcmVhdGVTY3JvbGxiYXJzKCl9LHJ1bjpmdW5jdGlvbigpe3RoaXMucmVzaXplKCksdGhpcy5fX2ZhZGVTY3JvbGxiYXJzKFwib3V0XCIsdGhpcy5vcHRpb25zLnNjcm9sbGJhclJlc2l6ZUZhZGVEZWxheSl9LF9faXNTaW5nbGVUb3VjaDohMSxfX2lzVHJhY2tpbmc6ITEsX19kaWREZWNlbGVyYXRpb25Db21wbGV0ZTohMSxfX2lzR2VzdHVyaW5nOiExLF9faXNEcmFnZ2luZzohMSxfX2lzRGVjZWxlcmF0aW5nOiExLF9faXNBbmltYXRpbmc6ITEsX19jbGllbnRMZWZ0OjAsX19jbGllbnRUb3A6MCxfX2NsaWVudFdpZHRoOjAsX19jbGllbnRIZWlnaHQ6MCxfX2NvbnRlbnRXaWR0aDowLF9fY29udGVudEhlaWdodDowLF9fc25hcFdpZHRoOjEwMCxfX3NuYXBIZWlnaHQ6MTAwLF9fcmVmcmVzaEhlaWdodDpudWxsLF9fcmVmcmVzaEFjdGl2ZTohMSxfX3JlZnJlc2hBY3RpdmF0ZTpudWxsLF9fcmVmcmVzaERlYWN0aXZhdGU6bnVsbCxfX3JlZnJlc2hTdGFydDpudWxsLF9fem9vbUxldmVsOjEsX19zY3JvbGxMZWZ0OjAsX19zY3JvbGxUb3A6MCxfX21heFNjcm9sbExlZnQ6MCxfX21heFNjcm9sbFRvcDowLF9fc2NoZWR1bGVkTGVmdDowLF9fc2NoZWR1bGVkVG9wOjAsX19zY2hlZHVsZWRab29tOjAsX19sYXN0VG91Y2hMZWZ0Om51bGwsX19sYXN0VG91Y2hUb3A6bnVsbCxfX2xhc3RUb3VjaE1vdmU6bnVsbCxfX3Bvc2l0aW9uczpudWxsLF9fbWluRGVjZWxlcmF0aW9uU2Nyb2xsTGVmdDpudWxsLF9fbWluRGVjZWxlcmF0aW9uU2Nyb2xsVG9wOm51bGwsX19tYXhEZWNlbGVyYXRpb25TY3JvbGxMZWZ0Om51bGwsX19tYXhEZWNlbGVyYXRpb25TY3JvbGxUb3A6bnVsbCxfX2RlY2VsZXJhdGlvblZlbG9jaXR5WDpudWxsLF9fZGVjZWxlcmF0aW9uVmVsb2NpdHlZOm51bGwsX190cmFuc2Zvcm1Qcm9wZXJ0eTpudWxsLF9fcGVyc3BlY3RpdmVQcm9wZXJ0eTpudWxsLF9faW5kaWNhdG9yWDpudWxsLF9faW5kaWNhdG9yWTpudWxsLF9fc2Nyb2xsYmFyRmFkZVRpbWVvdXQ6bnVsbCxfX2RpZFdhaXRGb3JTaXplOm51bGwsX19zaXplclRpbWVvdXQ6bnVsbCxfX2luaXRFdmVudEhhbmRsZXJzOmZ1bmN0aW9uKCl7ZnVuY3Rpb24gdChlKXtyZXR1cm4gZS50b3VjaGVzJiZlLnRvdWNoZXMubGVuZ3RoP2UudG91Y2hlczpbe3BhZ2VYOmUucGFnZVgscGFnZVk6ZS5wYWdlWX1dfXZhciBuPXRoaXMsaT10aGlzLl9fY29udGFpbmVyO2lmKG4uc2Nyb2xsQ2hpbGRJbnRvVmlldz1mdW5jdGlvbih0KXt2YXIgcjtpZighbi5pc1Njcm9sbGVkSW50b1ZpZXcpe2lmKGUuUGxhdGZvcm0uaXNJT1MoKXx8ZS5QbGF0Zm9ybS5pc0Z1bGxTY3JlZW4pe3I9aS5nZXRCb3VuZGluZ0NsaWVudFJlY3QoKS5ib3R0b207dmFyIG89dC5kZXRhaWwudmlld3BvcnRIZWlnaHQtcixzPU1hdGgubWF4KDAsdC5kZXRhaWwua2V5Ym9hcmRIZWlnaHQtbyk7aS5zdHlsZS5oZWlnaHQ9aS5jbGllbnRIZWlnaHQtcytcInB4XCIsaS5zdHlsZS5vdmVyZmxvdz1cInZpc2libGVcIixuLnJlc2l6ZSgpfW4uaXNTY3JvbGxlZEludG9WaWV3PSEwfWlmKHQuZGV0YWlsLmlzRWxlbWVudFVuZGVyS2V5Ym9hcmQpe3ZhciBhO2E9ZS5QbGF0Zm9ybS5pc0FuZHJvaWQoKSYmIWUuUGxhdGZvcm0uaXNGdWxsU2NyZWVuP2UuUGxhdGZvcm0udmVyc2lvbigpPDQuND81MDA6MzUwOjgwLGUuc2Nyb2xsLmlzU2Nyb2xsaW5nPSEwLHNldFRpbWVvdXQoZnVuY3Rpb24oKXt2YXIgbz0uNSppLmNsaWVudEhlaWdodDtyPWkuZ2V0Qm91bmRpbmdDbGllbnRSZWN0KCkuYm90dG9tO3ZhciBzPXQuZGV0YWlsLmVsZW1lbnRUb3AtcixhPXMrbzthPjAmJihlLnRhcC5jbG9uZUZvY3VzZWRJbnB1dChpLG4pLG4uc2Nyb2xsQnkoMCxhLCEwKSxuLm9uU2Nyb2xsKCkpfSxhKX10LnN0b3BQcm9wYWdhdGlvbigpfSxuLnJlc2V0U2Nyb2xsVmlldz1mdW5jdGlvbigpe24uaXNTY3JvbGxlZEludG9WaWV3JiYobi5pc1Njcm9sbGVkSW50b1ZpZXc9ITEsaS5zdHlsZS5oZWlnaHQ9XCJcIixpLnN0eWxlLm92ZXJmbG93PVwiXCIsbi5yZXNpemUoKSxlLnNjcm9sbC5pc1Njcm9sbGluZz0hMSl9LGkuYWRkRXZlbnRMaXN0ZW5lcihcInNjcm9sbENoaWxkSW50b1ZpZXdcIixuLnNjcm9sbENoaWxkSW50b1ZpZXcpLGkuYWRkRXZlbnRMaXN0ZW5lcihcInJlc2V0U2Nyb2xsVmlld1wiLG4ucmVzZXRTY3JvbGxWaWV3KSxuLnRvdWNoU3RhcnQ9ZnVuY3Rpb24oaSl7aWYobi5zdGFydENvb3JkaW5hdGVzPWUudGFwLnBvaW50ZXJDb29yZChpKSwhZS50YXAuaWdub3JlU2Nyb2xsU3RhcnQoaSkpe2lmKG4uX19pc0Rvd249ITAsZS50YXAuY29udGFpbnNPcklzVGV4dElucHV0KGkudGFyZ2V0KXx8XCJTRUxFQ1RcIj09PWkudGFyZ2V0LnRhZ05hbWUpcmV0dXJuIHZvaWQobi5fX2hhc1N0YXJ0ZWQ9ITEpO24uX19pc1NlbGVjdGFibGU9ITAsbi5fX2VuYWJsZVNjcm9sbFk9ITAsbi5fX2hhc1N0YXJ0ZWQ9ITAsbi5kb1RvdWNoU3RhcnQodChpKSxpLnRpbWVTdGFtcCksaS5wcmV2ZW50RGVmYXVsdCgpfX0sbi50b3VjaE1vdmU9ZnVuY3Rpb24ocil7aWYoISghbi5fX2lzRG93bnx8ci5kZWZhdWx0UHJldmVudGVkfHxcIlRFWFRBUkVBXCI9PT1yLnRhcmdldC50YWdOYW1lJiZyLnRhcmdldC5wYXJlbnRFbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXCI6Zm9jdXNcIikpKXtpZighbi5fX2hhc1N0YXJ0ZWQmJihlLnRhcC5jb250YWluc09ySXNUZXh0SW5wdXQoci50YXJnZXQpfHxcIlNFTEVDVFwiPT09ci50YXJnZXQudGFnTmFtZSkpcmV0dXJuIG4uX19oYXNTdGFydGVkPSEwLG4uZG9Ub3VjaFN0YXJ0KHQociksci50aW1lU3RhbXApLHZvaWQgci5wcmV2ZW50RGVmYXVsdCgpO2lmKG4uc3RhcnRDb29yZGluYXRlcyl7dmFyIG89ZS50YXAucG9pbnRlckNvb3JkKHIpO24uX19pc1NlbGVjdGFibGUmJmUudGFwLmlzVGV4dElucHV0KHIudGFyZ2V0KSYmTWF0aC5hYnMobi5zdGFydENvb3JkaW5hdGVzLngtby54KT4yMCYmKG4uX19lbmFibGVTY3JvbGxZPSExLG4uX19pc1NlbGVjdGFibGU9ITApLG4uX19lbmFibGVTY3JvbGxZJiZNYXRoLmFicyhuLnN0YXJ0Q29vcmRpbmF0ZXMueS1vLnkpPjEwJiYobi5fX2lzU2VsZWN0YWJsZT0hMSxlLnRhcC5jbG9uZUZvY3VzZWRJbnB1dChpLG4pKX1uLmRvVG91Y2hNb3ZlKHQociksci50aW1lU3RhbXAsci5zY2FsZSksbi5fX2lzRG93bj0hMH19LG4udG91Y2hFbmQ9ZnVuY3Rpb24odCl7bi5fX2lzRG93biYmKG4uZG9Ub3VjaEVuZCh0LnRpbWVTdGFtcCksbi5fX2lzRG93bj0hMSxuLl9faGFzU3RhcnRlZD0hMSxuLl9faXNTZWxlY3RhYmxlPSEwLG4uX19lbmFibGVTY3JvbGxZPSEwLG4uX19pc0RyYWdnaW5nfHxuLl9faXNEZWNlbGVyYXRpbmd8fG4uX19pc0FuaW1hdGluZ3x8ZS50YXAucmVtb3ZlQ2xvbmVkSW5wdXRzKGksbikpfSxcIm9udG91Y2hzdGFydFwiaW4gd2luZG93KWkuYWRkRXZlbnRMaXN0ZW5lcihcInRvdWNoc3RhcnRcIixuLnRvdWNoU3RhcnQsITEpLGRvY3VtZW50LmFkZEV2ZW50TGlzdGVuZXIoXCJ0b3VjaG1vdmVcIixuLnRvdWNoTW92ZSwhMSksZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lcihcInRvdWNoZW5kXCIsbi50b3VjaEVuZCwhMSksZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lcihcInRvdWNoY2FuY2VsXCIsbi50b3VjaEVuZCwhMSk7ZWxzZSBpZih3aW5kb3cubmF2aWdhdG9yLnBvaW50ZXJFbmFibGVkKWkuYWRkRXZlbnRMaXN0ZW5lcihcInBvaW50ZXJkb3duXCIsbi50b3VjaFN0YXJ0LCExKSxkb2N1bWVudC5hZGRFdmVudExpc3RlbmVyKFwicG9pbnRlcm1vdmVcIixuLnRvdWNoTW92ZSwhMSksZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lcihcInBvaW50ZXJ1cFwiLG4udG91Y2hFbmQsITEpLGRvY3VtZW50LmFkZEV2ZW50TGlzdGVuZXIoXCJwb2ludGVyY2FuY2VsXCIsbi50b3VjaEVuZCwhMSk7ZWxzZSBpZih3aW5kb3cubmF2aWdhdG9yLm1zUG9pbnRlckVuYWJsZWQpaS5hZGRFdmVudExpc3RlbmVyKFwiTVNQb2ludGVyRG93blwiLG4udG91Y2hTdGFydCwhMSksZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lcihcIk1TUG9pbnRlck1vdmVcIixuLnRvdWNoTW92ZSwhMSksZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lcihcIk1TUG9pbnRlclVwXCIsbi50b3VjaEVuZCwhMSksZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lcihcIk1TUG9pbnRlckNhbmNlbFwiLG4udG91Y2hFbmQsITEpO2Vsc2V7dmFyIHI9ITE7bi5tb3VzZURvd249ZnVuY3Rpb24oaSl7ZS50YXAuaWdub3JlU2Nyb2xsU3RhcnQoaSl8fFwiU0VMRUNUXCI9PT1pLnRhcmdldC50YWdOYW1lfHwobi5kb1RvdWNoU3RhcnQodChpKSxpLnRpbWVTdGFtcCksZS50YXAuaXNUZXh0SW5wdXQoaS50YXJnZXQpfHxpLnByZXZlbnREZWZhdWx0KCkscj0hMCl9LG4ubW91c2VNb3ZlPWZ1bmN0aW9uKGUpe3ImJiFlLmRlZmF1bHRQcmV2ZW50ZWQmJihuLmRvVG91Y2hNb3ZlKHQoZSksZS50aW1lU3RhbXApLHI9ITApfSxuLm1vdXNlVXA9ZnVuY3Rpb24oZSl7ciYmKG4uZG9Ub3VjaEVuZChlLnRpbWVTdGFtcCkscj0hMSl9LG4ubW91c2VXaGVlbD1lLmFuaW1hdGlvbkZyYW1lVGhyb3R0bGUoZnVuY3Rpb24odCl7dmFyIGk9ZS5Eb21VdGlsLmdldFBhcmVudE9yU2VsZldpdGhDbGFzcyh0LnRhcmdldCxcImlvbmljLXNjcm9sbFwiKTtpPT09bi5fX2NvbnRhaW5lciYmKG4uaGludFJlc2l6ZSgpLG4uc2Nyb2xsQnkodC53aGVlbERlbHRhWC9uLm9wdGlvbnMud2hlZWxEYW1wZW4sLXQud2hlZWxEZWx0YVkvbi5vcHRpb25zLndoZWVsRGFtcGVuKSxuLl9fZmFkZVNjcm9sbGJhcnMoXCJpblwiKSxjbGVhclRpbWVvdXQobi5fX3doZWVsSGlkZUJhclRpbWVvdXQpLG4uX193aGVlbEhpZGVCYXJUaW1lb3V0PXNldFRpbWVvdXQoZnVuY3Rpb24oKXtuLl9fZmFkZVNjcm9sbGJhcnMoXCJvdXRcIil9LDEwMCkpfSksaS5hZGRFdmVudExpc3RlbmVyKFwibW91c2Vkb3duXCIsbi5tb3VzZURvd24sITEpLGRvY3VtZW50LmFkZEV2ZW50TGlzdGVuZXIoXCJtb3VzZW1vdmVcIixuLm1vdXNlTW92ZSwhMSksZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lcihcIm1vdXNldXBcIixuLm1vdXNlVXAsITEpLGRvY3VtZW50LmFkZEV2ZW50TGlzdGVuZXIoXCJtb3VzZXdoZWVsXCIsbi5tb3VzZVdoZWVsLCExKX19LF9fY2xlYW51cDpmdW5jdGlvbigpe3ZhciB0PXRoaXMuX19jb250YWluZXIsbj10aGlzO3QucmVtb3ZlRXZlbnRMaXN0ZW5lcihcInRvdWNoc3RhcnRcIixuLnRvdWNoU3RhcnQpLGRvY3VtZW50LnJlbW92ZUV2ZW50TGlzdGVuZXIoXCJ0b3VjaG1vdmVcIixuLnRvdWNoTW92ZSksZG9jdW1lbnQucmVtb3ZlRXZlbnRMaXN0ZW5lcihcInRvdWNoZW5kXCIsbi50b3VjaEVuZCksZG9jdW1lbnQucmVtb3ZlRXZlbnRMaXN0ZW5lcihcInRvdWNoY2FuY2VsXCIsbi50b3VjaENhbmNlbCksdC5yZW1vdmVFdmVudExpc3RlbmVyKFwicG9pbnRlcmRvd25cIixuLnRvdWNoU3RhcnQpLGRvY3VtZW50LnJlbW92ZUV2ZW50TGlzdGVuZXIoXCJwb2ludGVybW92ZVwiLG4udG91Y2hNb3ZlKSxkb2N1bWVudC5yZW1vdmVFdmVudExpc3RlbmVyKFwicG9pbnRlcnVwXCIsbi50b3VjaEVuZCksZG9jdW1lbnQucmVtb3ZlRXZlbnRMaXN0ZW5lcihcInBvaW50ZXJjYW5jZWxcIixuLnRvdWNoRW5kKSx0LnJlbW92ZUV2ZW50TGlzdGVuZXIoXCJNU1BvaW50ZXJEb3duXCIsbi50b3VjaFN0YXJ0KSxkb2N1bWVudC5yZW1vdmVFdmVudExpc3RlbmVyKFwiTVNQb2ludGVyTW92ZVwiLG4udG91Y2hNb3ZlKSxkb2N1bWVudC5yZW1vdmVFdmVudExpc3RlbmVyKFwiTVNQb2ludGVyVXBcIixuLnRvdWNoRW5kKSxkb2N1bWVudC5yZW1vdmVFdmVudExpc3RlbmVyKFwiTVNQb2ludGVyQ2FuY2VsXCIsbi50b3VjaEVuZCksdC5yZW1vdmVFdmVudExpc3RlbmVyKFwibW91c2Vkb3duXCIsbi5tb3VzZURvd24pLGRvY3VtZW50LnJlbW92ZUV2ZW50TGlzdGVuZXIoXCJtb3VzZW1vdmVcIixuLm1vdXNlTW92ZSksZG9jdW1lbnQucmVtb3ZlRXZlbnRMaXN0ZW5lcihcIm1vdXNldXBcIixuLm1vdXNlVXApLGRvY3VtZW50LnJlbW92ZUV2ZW50TGlzdGVuZXIoXCJtb3VzZXdoZWVsXCIsbi5tb3VzZVdoZWVsKSx0LnJlbW92ZUV2ZW50TGlzdGVuZXIoXCJzY3JvbGxDaGlsZEludG9WaWV3XCIsbi5zY3JvbGxDaGlsZEludG9WaWV3KSx0LnJlbW92ZUV2ZW50TGlzdGVuZXIoXCJyZXNldFNjcm9sbFZpZXdcIixuLnJlc2V0U2Nyb2xsVmlldyksZS50YXAucmVtb3ZlQ2xvbmVkSW5wdXRzKHQsbiksZGVsZXRlIHRoaXMuX19jb250YWluZXIsZGVsZXRlIHRoaXMuX19jb250ZW50LGRlbGV0ZSB0aGlzLl9faW5kaWNhdG9yWCxkZWxldGUgdGhpcy5fX2luZGljYXRvclksZGVsZXRlIHRoaXMub3B0aW9ucy5lbCx0aGlzLl9fY2FsbGJhY2s9dGhpcy5zY3JvbGxDaGlsZEludG9WaWV3PXRoaXMucmVzZXRTY3JvbGxWaWV3PWFuZ3VsYXIubm9vcCx0aGlzLm1vdXNlTW92ZT10aGlzLm1vdXNlRG93bj10aGlzLm1vdXNlVXA9dGhpcy5tb3VzZVdoZWVsPXRoaXMudG91Y2hTdGFydD10aGlzLnRvdWNoTW92ZT10aGlzLnRvdWNoRW5kPXRoaXMudG91Y2hDYW5jZWw9YW5ndWxhci5ub29wLHRoaXMucmVzaXplPXRoaXMuc2Nyb2xsVG89dGhpcy56b29tVG89dGhpcy5fX3Njcm9sbGluZ0NvbXBsZXRlPWFuZ3VsYXIubm9vcCx0PW51bGx9LF9fY3JlYXRlU2Nyb2xsYmFyOmZ1bmN0aW9uKGUpe3ZhciB0PWRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJkaXZcIiksbj1kb2N1bWVudC5jcmVhdGVFbGVtZW50KFwiZGl2XCIpO3JldHVybiBuLmNsYXNzTmFtZT1cInNjcm9sbC1iYXItaW5kaWNhdG9yIHNjcm9sbC1iYXItZmFkZS1vdXRcIix0LmNsYXNzTmFtZT1cImhcIj09ZT9cInNjcm9sbC1iYXIgc2Nyb2xsLWJhci1oXCI6XCJzY3JvbGwtYmFyIHNjcm9sbC1iYXItdlwiLHQuYXBwZW5kQ2hpbGQobiksdH0sX19jcmVhdGVTY3JvbGxiYXJzOmZ1bmN0aW9uKCl7dmFyIGUsdDt0aGlzLm9wdGlvbnMuc2Nyb2xsaW5nWCYmKGU9e2VsOnRoaXMuX19jcmVhdGVTY3JvbGxiYXIoXCJoXCIpLHNpemVSYXRpbzoxfSxlLmluZGljYXRvcj1lLmVsLmNoaWxkcmVuWzBdLHRoaXMub3B0aW9ucy5zY3JvbGxiYXJYJiZ0aGlzLl9fY29udGFpbmVyLmFwcGVuZENoaWxkKGUuZWwpLHRoaXMuX19pbmRpY2F0b3JYPWUpLHRoaXMub3B0aW9ucy5zY3JvbGxpbmdZJiYodD17ZWw6dGhpcy5fX2NyZWF0ZVNjcm9sbGJhcihcInZcIiksc2l6ZVJhdGlvOjF9LHQuaW5kaWNhdG9yPXQuZWwuY2hpbGRyZW5bMF0sdGhpcy5vcHRpb25zLnNjcm9sbGJhclkmJnRoaXMuX19jb250YWluZXIuYXBwZW5kQ2hpbGQodC5lbCksdGhpcy5fX2luZGljYXRvclk9dCl9LF9fcmVzaXplU2Nyb2xsYmFyczpmdW5jdGlvbigpe3ZhciBlPXRoaXM7aWYoZS5fX2luZGljYXRvclgpe3ZhciB0PU1hdGgubWF4KE1hdGgucm91bmQoZS5fX2NsaWVudFdpZHRoKmUuX19jbGllbnRXaWR0aC9lLl9fY29udGVudFdpZHRoKSwyMCk7dD5lLl9fY29udGVudFdpZHRoJiYodD0wKSxlLl9faW5kaWNhdG9yWC5zaXplPXQsZS5fX2luZGljYXRvclgubWluU2NhbGU9dGhpcy5vcHRpb25zLm1pblNjcm9sbGJhclNpemVYL3QsZS5fX2luZGljYXRvclguaW5kaWNhdG9yLnN0eWxlLndpZHRoPXQrXCJweFwiLGUuX19pbmRpY2F0b3JYLm1heFBvcz1lLl9fY2xpZW50V2lkdGgtdCxlLl9faW5kaWNhdG9yWC5zaXplUmF0aW89ZS5fX21heFNjcm9sbExlZnQ/ZS5fX2luZGljYXRvclgubWF4UG9zL2UuX19tYXhTY3JvbGxMZWZ0OjF9aWYoZS5fX2luZGljYXRvclkpe3ZhciBuPU1hdGgubWF4KE1hdGgucm91bmQoZS5fX2NsaWVudEhlaWdodCplLl9fY2xpZW50SGVpZ2h0L2UuX19jb250ZW50SGVpZ2h0KSwyMCk7bj5lLl9fY29udGVudEhlaWdodCYmKG49MCksZS5fX2luZGljYXRvclkuc2l6ZT1uLGUuX19pbmRpY2F0b3JZLm1pblNjYWxlPXRoaXMub3B0aW9ucy5taW5TY3JvbGxiYXJTaXplWS9uLGUuX19pbmRpY2F0b3JZLm1heFBvcz1lLl9fY2xpZW50SGVpZ2h0LW4sZS5fX2luZGljYXRvclkuaW5kaWNhdG9yLnN0eWxlLmhlaWdodD1uK1wicHhcIixlLl9faW5kaWNhdG9yWS5zaXplUmF0aW89ZS5fX21heFNjcm9sbFRvcD9lLl9faW5kaWNhdG9yWS5tYXhQb3MvZS5fX21heFNjcm9sbFRvcDoxfX0sX19yZXBvc2l0aW9uU2Nyb2xsYmFyczpmdW5jdGlvbigpe3ZhciBlLHQsbixpLHIsbz10aGlzLHM9MCxhPTA7by5fX2luZGljYXRvclgmJihvLl9faW5kaWNhdG9yWSYmKHM9MTApLGk9TWF0aC5yb3VuZChvLl9faW5kaWNhdG9yWC5zaXplUmF0aW8qby5fX3Njcm9sbExlZnQpfHwwLHQ9by5fX3Njcm9sbExlZnQtKG8uX19tYXhTY3JvbGxMZWZ0LXMpLG8uX19zY3JvbGxMZWZ0PDA/KHdpZHRoU2NhbGU9TWF0aC5tYXgoby5fX2luZGljYXRvclgubWluU2NhbGUsKG8uX19pbmRpY2F0b3JYLnNpemUtTWF0aC5hYnMoby5fX3Njcm9sbExlZnQpKS9vLl9faW5kaWNhdG9yWC5zaXplKSxpPTAsby5fX2luZGljYXRvclguaW5kaWNhdG9yLnN0eWxlW28uX190cmFuc2Zvcm1PcmlnaW5Qcm9wZXJ0eV09XCJsZWZ0IGNlbnRlclwiKTp0PjA/KHdpZHRoU2NhbGU9TWF0aC5tYXgoby5fX2luZGljYXRvclgubWluU2NhbGUsKG8uX19pbmRpY2F0b3JYLnNpemUtdCkvby5fX2luZGljYXRvclguc2l6ZSksaT1vLl9faW5kaWNhdG9yWC5tYXhQb3MtcyxvLl9faW5kaWNhdG9yWC5pbmRpY2F0b3Iuc3R5bGVbby5fX3RyYW5zZm9ybU9yaWdpblByb3BlcnR5XT1cInJpZ2h0IGNlbnRlclwiKTooaT1NYXRoLm1pbihvLl9fbWF4U2Nyb2xsTGVmdCxNYXRoLm1heCgwLGkpKSx3aWR0aFNjYWxlPTEpLG8uX19pbmRpY2F0b3JYLmluZGljYXRvci5zdHlsZVtvLl9fdHJhbnNmb3JtUHJvcGVydHldPVwidHJhbnNsYXRlM2QoXCIraStcInB4LCAwLCAwKSBzY2FsZVgoXCIrd2lkdGhTY2FsZStcIilcIiksby5fX2luZGljYXRvclkmJihyPU1hdGgucm91bmQoby5fX2luZGljYXRvclkuc2l6ZVJhdGlvKm8uX19zY3JvbGxUb3ApfHwwLG8uX19pbmRpY2F0b3JYJiYoYT0xMCksbj1vLl9fc2Nyb2xsVG9wLShvLl9fbWF4U2Nyb2xsVG9wLWEpLG8uX19zY3JvbGxUb3A8MD8oZT1NYXRoLm1heChvLl9faW5kaWNhdG9yWS5taW5TY2FsZSwoby5fX2luZGljYXRvclkuc2l6ZS1NYXRoLmFicyhvLl9fc2Nyb2xsVG9wKSkvby5fX2luZGljYXRvclkuc2l6ZSkscj0wLG8uX19pbmRpY2F0b3JZLmluZGljYXRvci5zdHlsZVtvLl9fdHJhbnNmb3JtT3JpZ2luUHJvcGVydHldPVwiY2VudGVyIHRvcFwiKTpuPjA/KGU9TWF0aC5tYXgoby5fX2luZGljYXRvclkubWluU2NhbGUsKG8uX19pbmRpY2F0b3JZLnNpemUtbikvby5fX2luZGljYXRvclkuc2l6ZSkscj1vLl9faW5kaWNhdG9yWS5tYXhQb3MtYSxvLl9faW5kaWNhdG9yWS5pbmRpY2F0b3Iuc3R5bGVbby5fX3RyYW5zZm9ybU9yaWdpblByb3BlcnR5XT1cImNlbnRlciBib3R0b21cIik6KHI9TWF0aC5taW4oby5fX21heFNjcm9sbFRvcCxNYXRoLm1heCgwLHIpKSxlPTEpLG8uX19pbmRpY2F0b3JZLmluZGljYXRvci5zdHlsZVtvLl9fdHJhbnNmb3JtUHJvcGVydHldPVwidHJhbnNsYXRlM2QoMCxcIityK1wicHgsIDApIHNjYWxlWShcIitlK1wiKVwiKX0sX19mYWRlU2Nyb2xsYmFyczpmdW5jdGlvbihlLHQpe3ZhciBuPXRoaXM7aWYodGhpcy5vcHRpb25zLnNjcm9sbGJhcnNGYWRlKXt2YXIgaT1cInNjcm9sbC1iYXItZmFkZS1vdXRcIjtuLm9wdGlvbnMuc2Nyb2xsYmFyc0ZhZGU9PT0hMCYmKGNsZWFyVGltZW91dChuLl9fc2Nyb2xsYmFyRmFkZVRpbWVvdXQpLFwiaW5cIj09ZT8obi5fX2luZGljYXRvclgmJm4uX19pbmRpY2F0b3JYLmluZGljYXRvci5jbGFzc0xpc3QucmVtb3ZlKGkpLG4uX19pbmRpY2F0b3JZJiZuLl9faW5kaWNhdG9yWS5pbmRpY2F0b3IuY2xhc3NMaXN0LnJlbW92ZShpKSk6bi5fX3Njcm9sbGJhckZhZGVUaW1lb3V0PXNldFRpbWVvdXQoZnVuY3Rpb24oKXtuLl9faW5kaWNhdG9yWCYmbi5fX2luZGljYXRvclguaW5kaWNhdG9yLmNsYXNzTGlzdC5hZGQoaSksbi5fX2luZGljYXRvclkmJm4uX19pbmRpY2F0b3JZLmluZGljYXRvci5jbGFzc0xpc3QuYWRkKGkpfSx0fHxuLm9wdGlvbnMuc2Nyb2xsYmFyRmFkZURlbGF5KSl9fSxfX3Njcm9sbGluZ0NvbXBsZXRlOmZ1bmN0aW9uKCl7dmFyIHQ9dGhpczt0Lm9wdGlvbnMuc2Nyb2xsaW5nQ29tcGxldGUoKSxlLnRhcC5yZW1vdmVDbG9uZWRJbnB1dHModC5fX2NvbnRhaW5lcix0KSx0Ll9fZmFkZVNjcm9sbGJhcnMoXCJvdXRcIil9LHJlc2l6ZTpmdW5jdGlvbigpe3RoaXMuX19jb250YWluZXImJnRoaXMub3B0aW9ucyYmdGhpcy5zZXREaW1lbnNpb25zKHRoaXMuX19jb250YWluZXIuY2xpZW50V2lkdGgsdGhpcy5fX2NvbnRhaW5lci5jbGllbnRIZWlnaHQsdGhpcy5vcHRpb25zLmdldENvbnRlbnRXaWR0aCgpLHRoaXMub3B0aW9ucy5nZXRDb250ZW50SGVpZ2h0KCkpfSxnZXRSZW5kZXJGbjpmdW5jdGlvbigpe3ZhciBlLHQ9dGhpcyxuPXRoaXMuX19jb250ZW50LGk9ZG9jdW1lbnQuZG9jdW1lbnRFbGVtZW50LnN0eWxlO1wiTW96QXBwZWFyYW5jZVwiaW4gaT9lPVwiZ2Vja29cIjpcIldlYmtpdEFwcGVhcmFuY2VcImluIGk/ZT1cIndlYmtpdFwiOlwic3RyaW5nXCI9PXR5cGVvZiBuYXZpZ2F0b3IuY3B1Q2xhc3MmJihlPVwidHJpZGVudFwiKTt2YXIgcixvPXt0cmlkZW50OlwibXNcIixnZWNrbzpcIk1velwiLHdlYmtpdDpcIldlYmtpdFwiLHByZXN0bzpcIk9cIn1bZV0scz1kb2N1bWVudC5jcmVhdGVFbGVtZW50KFwiZGl2XCIpLGE9bytcIlBlcnNwZWN0aXZlXCIsbD1vK1wiVHJhbnNmb3JtXCIsYz1vK1wiVHJhbnNmb3JtT3JpZ2luXCI7cmV0dXJuIHQuX19wZXJzcGVjdGl2ZVByb3BlcnR5PWwsdC5fX3RyYW5zZm9ybVByb3BlcnR5PWwsdC5fX3RyYW5zZm9ybU9yaWdpblByb3BlcnR5PWMscy5zdHlsZVthXSE9PXI/ZnVuY3Rpb24oZSxpLHIsbyl7bi5zdHlsZVtsXT1cInRyYW5zbGF0ZTNkKFwiKy1lK1wicHgsXCIrLWkrXCJweCwwKSBzY2FsZShcIityK1wiKVwiLHQuX19yZXBvc2l0aW9uU2Nyb2xsYmFycygpLG98fHQudHJpZ2dlclNjcm9sbEV2ZW50KCl9OnMuc3R5bGVbbF0hPT1yP2Z1bmN0aW9uKGUsaSxyLG8pe24uc3R5bGVbbF09XCJ0cmFuc2xhdGUoXCIrLWUrXCJweCxcIistaStcInB4KSBzY2FsZShcIityK1wiKVwiLHQuX19yZXBvc2l0aW9uU2Nyb2xsYmFycygpLG98fHQudHJpZ2dlclNjcm9sbEV2ZW50KCl9OmZ1bmN0aW9uKGUsaSxyLG8pe24uc3R5bGUubWFyZ2luTGVmdD1lPy1lL3IrXCJweFwiOlwiXCIsbi5zdHlsZS5tYXJnaW5Ub3A9aT8taS9yK1wicHhcIjpcIlwiLG4uc3R5bGUuem9vbT1yfHxcIlwiLHQuX19yZXBvc2l0aW9uU2Nyb2xsYmFycygpLG98fHQudHJpZ2dlclNjcm9sbEV2ZW50KCl9fSxzZXREaW1lbnNpb25zOmZ1bmN0aW9uKGUsdCxuLGkpe3ZhciByPXRoaXM7ZT09PStlJiYoci5fX2NsaWVudFdpZHRoPWUpLHQ9PT0rdCYmKHIuX19jbGllbnRIZWlnaHQ9dCksbj09PStuJiYoci5fX2NvbnRlbnRXaWR0aD1uKSxpPT09K2kmJihyLl9fY29udGVudEhlaWdodD1pKSxyLl9fY29tcHV0ZVNjcm9sbE1heCgpLHIuX19yZXNpemVTY3JvbGxiYXJzKCksci5zY3JvbGxUbyhyLl9fc2Nyb2xsTGVmdCxyLl9fc2Nyb2xsVG9wLCEwLG51bGwsITApfSxzZXRQb3NpdGlvbjpmdW5jdGlvbihlLHQpe3ZhciBuPXRoaXM7bi5fX2NsaWVudExlZnQ9ZXx8MCxuLl9fY2xpZW50VG9wPXR8fDB9LHNldFNuYXBTaXplOmZ1bmN0aW9uKGUsdCl7dmFyIG49dGhpcztuLl9fc25hcFdpZHRoPWUsbi5fX3NuYXBIZWlnaHQ9dH0sYWN0aXZhdGVQdWxsVG9SZWZyZXNoOmZ1bmN0aW9uKHQsbixpLHIsbyxzLGEpe3ZhciBsPXRoaXM7bC5fX3JlZnJlc2hIZWlnaHQ9dCxsLl9fcmVmcmVzaEFjdGl2YXRlPWZ1bmN0aW9uKCl7ZS5yZXF1ZXN0QW5pbWF0aW9uRnJhbWUobil9LGwuX19yZWZyZXNoRGVhY3RpdmF0ZT1mdW5jdGlvbigpe2UucmVxdWVzdEFuaW1hdGlvbkZyYW1lKGkpfSxsLl9fcmVmcmVzaFN0YXJ0PWZ1bmN0aW9uKCl7ZS5yZXF1ZXN0QW5pbWF0aW9uRnJhbWUocil9LGwuX19yZWZyZXNoU2hvdz1mdW5jdGlvbigpe2UucmVxdWVzdEFuaW1hdGlvbkZyYW1lKG8pfSxsLl9fcmVmcmVzaEhpZGU9ZnVuY3Rpb24oKXtlLnJlcXVlc3RBbmltYXRpb25GcmFtZShzKX0sbC5fX3JlZnJlc2hUYWlsPWZ1bmN0aW9uKCl7ZS5yZXF1ZXN0QW5pbWF0aW9uRnJhbWUoYSl9LGwuX19yZWZyZXNoVGFpbFRpbWU9MTAwLGwuX19taW5TcGluVGltZT02MDB9LHRyaWdnZXJQdWxsVG9SZWZyZXNoOmZ1bmN0aW9uKCl7dGhpcy5fX3B1Ymxpc2godGhpcy5fX3Njcm9sbExlZnQsLXRoaXMuX19yZWZyZXNoSGVpZ2h0LHRoaXMuX196b29tTGV2ZWwsITApO3ZhciBlPW5ldyBEYXRlO3NlbGYucmVmcmVzaFN0YXJ0VGltZT1lLmdldFRpbWUoKSx0aGlzLl9fcmVmcmVzaFN0YXJ0JiZ0aGlzLl9fcmVmcmVzaFN0YXJ0KCl9LGZpbmlzaFB1bGxUb1JlZnJlc2g6ZnVuY3Rpb24oKXt2YXIgZT10aGlzLHQ9bmV3IERhdGUsbj0wO2UucmVmcmVzaFN0YXJ0VGltZStlLl9fbWluU3BpblRpbWU+dC5nZXRUaW1lKCkmJihuPWUucmVmcmVzaFN0YXJ0VGltZStlLl9fbWluU3BpblRpbWUtdC5nZXRUaW1lKCkpLHNldFRpbWVvdXQoZnVuY3Rpb24oKXtlLl9fcmVmcmVzaFRhaWwmJmUuX19yZWZyZXNoVGFpbCgpLHNldFRpbWVvdXQoZnVuY3Rpb24oKXtlLl9fcmVmcmVzaEFjdGl2ZT0hMSxlLl9fcmVmcmVzaERlYWN0aXZhdGUmJmUuX19yZWZyZXNoRGVhY3RpdmF0ZSgpLGUuc2Nyb2xsVG8oZS5fX3Njcm9sbExlZnQsZS5fX3Njcm9sbFRvcCwhMCl9LGUuX19yZWZyZXNoVGFpbFRpbWUpfSxuKX0sZ2V0VmFsdWVzOmZ1bmN0aW9uKCl7dmFyIGU9dGhpcztyZXR1cm57bGVmdDplLl9fc2Nyb2xsTGVmdCx0b3A6ZS5fX3Njcm9sbFRvcCx6b29tOmUuX196b29tTGV2ZWx9fSxnZXRTY3JvbGxNYXg6ZnVuY3Rpb24oKXt2YXIgZT10aGlzO3JldHVybntsZWZ0OmUuX19tYXhTY3JvbGxMZWZ0LHRvcDplLl9fbWF4U2Nyb2xsVG9wfX0sem9vbVRvOmZ1bmN0aW9uKGUsdCxuLGkpe3ZhciByPXRoaXM7aWYoIXIub3B0aW9ucy56b29taW5nKXRocm93IG5ldyBFcnJvcihcIlpvb21pbmcgaXMgbm90IGVuYWJsZWQhXCIpO3IuX19pc0RlY2VsZXJhdGluZyYmKHN0LmVmZmVjdC5BbmltYXRlLnN0b3Aoci5fX2lzRGVjZWxlcmF0aW5nKSxyLl9faXNEZWNlbGVyYXRpbmc9ITEpO3ZhciBvPXIuX196b29tTGV2ZWw7bnVsbD09biYmKG49ci5fX2NsaWVudFdpZHRoLzIpLG51bGw9PWkmJihpPXIuX19jbGllbnRIZWlnaHQvMiksZT1NYXRoLm1heChNYXRoLm1pbihlLHIub3B0aW9ucy5tYXhab29tKSxyLm9wdGlvbnMubWluWm9vbSksci5fX2NvbXB1dGVTY3JvbGxNYXgoZSk7dmFyIHM9KG4rci5fX3Njcm9sbExlZnQpKmUvby1uLGE9KGkrci5fX3Njcm9sbFRvcCkqZS9vLWk7cz5yLl9fbWF4U2Nyb2xsTGVmdD9zPXIuX19tYXhTY3JvbGxMZWZ0OjA+cyYmKHM9MCksYT5yLl9fbWF4U2Nyb2xsVG9wP2E9ci5fX21heFNjcm9sbFRvcDowPmEmJihhPTApLHIuX19wdWJsaXNoKHMsYSxlLHQpfSx6b29tQnk6ZnVuY3Rpb24oZSx0LG4saSl7dmFyIHI9dGhpcztyLnpvb21UbyhyLl9fem9vbUxldmVsKmUsdCxuLGkpfSxzY3JvbGxUbzpmdW5jdGlvbihlLHQsbixpLHIpe3ZhciBvPXRoaXM7aWYoby5fX2lzRGVjZWxlcmF0aW5nJiYoc3QuZWZmZWN0LkFuaW1hdGUuc3RvcChvLl9faXNEZWNlbGVyYXRpbmcpLG8uX19pc0RlY2VsZXJhdGluZz0hMSksbnVsbCE9aSYmaSE9PW8uX196b29tTGV2ZWwpe2lmKCFvLm9wdGlvbnMuem9vbWluZyl0aHJvdyBuZXcgRXJyb3IoXCJab29taW5nIGlzIG5vdCBlbmFibGVkIVwiKTtlKj1pLHQqPWksby5fX2NvbXB1dGVTY3JvbGxNYXgoaSl9ZWxzZSBpPW8uX196b29tTGV2ZWw7by5vcHRpb25zLnNjcm9sbGluZ1g/by5vcHRpb25zLnBhZ2luZz9lPU1hdGgucm91bmQoZS9vLl9fY2xpZW50V2lkdGgpKm8uX19jbGllbnRXaWR0aDpvLm9wdGlvbnMuc25hcHBpbmcmJihlPU1hdGgucm91bmQoZS9vLl9fc25hcFdpZHRoKSpvLl9fc25hcFdpZHRoKTplPW8uX19zY3JvbGxMZWZ0LG8ub3B0aW9ucy5zY3JvbGxpbmdZP28ub3B0aW9ucy5wYWdpbmc/dD1NYXRoLnJvdW5kKHQvby5fX2NsaWVudEhlaWdodCkqby5fX2NsaWVudEhlaWdodDpvLm9wdGlvbnMuc25hcHBpbmcmJih0PU1hdGgucm91bmQodC9vLl9fc25hcEhlaWdodCkqby5fX3NuYXBIZWlnaHQpOnQ9by5fX3Njcm9sbFRvcCxlPU1hdGgubWF4KE1hdGgubWluKG8uX19tYXhTY3JvbGxMZWZ0LGUpLDApLHQ9TWF0aC5tYXgoTWF0aC5taW4oby5fX21heFNjcm9sbFRvcCx0KSwwKSxlPT09by5fX3Njcm9sbExlZnQmJnQ9PT1vLl9fc2Nyb2xsVG9wJiYobj0hMSksby5fX3B1Ymxpc2goZSx0LGksbixyKX0sc2Nyb2xsQnk6ZnVuY3Rpb24oZSx0LG4pe3ZhciBpPXRoaXMscj1pLl9faXNBbmltYXRpbmc/aS5fX3NjaGVkdWxlZExlZnQ6aS5fX3Njcm9sbExlZnQsbz1pLl9faXNBbmltYXRpbmc/aS5fX3NjaGVkdWxlZFRvcDppLl9fc2Nyb2xsVG9wO2kuc2Nyb2xsVG8ocisoZXx8MCksbysodHx8MCksbil9LGRvTW91c2Vab29tOmZ1bmN0aW9uKGUsdCxuLGkpe3ZhciByPXRoaXMsbz1lPjA/Ljk3OjEuMDM7cmV0dXJuIHIuem9vbVRvKHIuX196b29tTGV2ZWwqbywhMSxuLXIuX19jbGllbnRMZWZ0LGktci5fX2NsaWVudFRvcCl9LGRvVG91Y2hTdGFydDpmdW5jdGlvbihlLHQpe3RoaXMuaGludFJlc2l6ZSgpLHQgaW5zdGFuY2VvZiBEYXRlJiYodD10LnZhbHVlT2YoKSksXCJudW1iZXJcIiE9dHlwZW9mIHQmJih0PURhdGUubm93KCkpO3ZhciBuPXRoaXM7bi5fX2ludGVycnVwdGVkQW5pbWF0aW9uPSEwLG4uX19pc0RlY2VsZXJhdGluZyYmKHN0LmVmZmVjdC5BbmltYXRlLnN0b3Aobi5fX2lzRGVjZWxlcmF0aW5nKSxuLl9faXNEZWNlbGVyYXRpbmc9ITEsbi5fX2ludGVycnVwdGVkQW5pbWF0aW9uPSEwKSxuLl9faXNBbmltYXRpbmcmJihzdC5lZmZlY3QuQW5pbWF0ZS5zdG9wKG4uX19pc0FuaW1hdGluZyksbi5fX2lzQW5pbWF0aW5nPSExLG4uX19pbnRlcnJ1cHRlZEFuaW1hdGlvbj0hMCk7dmFyIGkscixvPTE9PT1lLmxlbmd0aDtvPyhpPWVbMF0ucGFnZVgscj1lWzBdLnBhZ2VZKTooaT1NYXRoLmFicyhlWzBdLnBhZ2VYK2VbMV0ucGFnZVgpLzIscj1NYXRoLmFicyhlWzBdLnBhZ2VZK2VbMV0ucGFnZVkpLzIpLG4uX19pbml0aWFsVG91Y2hMZWZ0PWksbi5fX2luaXRpYWxUb3VjaFRvcD1yLG4uX19pbml0aWFsVG91Y2hlcz1lLG4uX196b29tTGV2ZWxTdGFydD1uLl9fem9vbUxldmVsLG4uX19sYXN0VG91Y2hMZWZ0PWksbi5fX2xhc3RUb3VjaFRvcD1yLG4uX19sYXN0VG91Y2hNb3ZlPXQsbi5fX2xhc3RTY2FsZT0xLG4uX19lbmFibGVTY3JvbGxYPSFvJiZuLm9wdGlvbnMuc2Nyb2xsaW5nWCxuLl9fZW5hYmxlU2Nyb2xsWT0hbyYmbi5vcHRpb25zLnNjcm9sbGluZ1ksbi5fX2lzVHJhY2tpbmc9ITAsbi5fX2RpZERlY2VsZXJhdGlvbkNvbXBsZXRlPSExLG4uX19pc0RyYWdnaW5nPSFvLG4uX19pc1NpbmdsZVRvdWNoPW8sbi5fX3Bvc2l0aW9ucz1bXX0sZG9Ub3VjaE1vdmU6ZnVuY3Rpb24oZSx0LG4pe3QgaW5zdGFuY2VvZiBEYXRlJiYodD10LnZhbHVlT2YoKSksXCJudW1iZXJcIiE9dHlwZW9mIHQmJih0PURhdGUubm93KCkpO3ZhciBpPXRoaXM7aWYoaS5fX2lzVHJhY2tpbmcpe3ZhciByLG87Mj09PWUubGVuZ3RoPyhyPU1hdGguYWJzKGVbMF0ucGFnZVgrZVsxXS5wYWdlWCkvMixvPU1hdGguYWJzKGVbMF0ucGFnZVkrZVsxXS5wYWdlWSkvMiwhbiYmaS5vcHRpb25zLnpvb21pbmcmJihuPWkuX19nZXRTY2FsZShpLl9faW5pdGlhbFRvdWNoZXMsZSkpKToocj1lWzBdLnBhZ2VYLG89ZVswXS5wYWdlWSk7dmFyIHM9aS5fX3Bvc2l0aW9ucztpZihpLl9faXNEcmFnZ2luZyl7dmFyIGE9ci1pLl9fbGFzdFRvdWNoTGVmdCxsPW8taS5fX2xhc3RUb3VjaFRvcCxjPWkuX19zY3JvbGxMZWZ0LHU9aS5fX3Njcm9sbFRvcCxoPWkuX196b29tTGV2ZWw7aWYobnVsbCE9biYmaS5vcHRpb25zLnpvb21pbmcpe3ZhciBkPWg7aWYoaD1oL2kuX19sYXN0U2NhbGUqbixoPU1hdGgubWF4KE1hdGgubWluKGgsaS5vcHRpb25zLm1heFpvb20pLGkub3B0aW9ucy5taW5ab29tKSxkIT09aCl7dmFyIF89ci1pLl9fY2xpZW50TGVmdCxmPW8taS5fX2NsaWVudFRvcDtjPShfK2MpKmgvZC1fLHU9KGYrdSkqaC9kLWYsaS5fX2NvbXB1dGVTY3JvbGxNYXgoaCl9fWlmKGkuX19lbmFibGVTY3JvbGxYKXtjLT1hKnRoaXMub3B0aW9ucy5zcGVlZE11bHRpcGxpZXI7dmFyIHA9aS5fX21heFNjcm9sbExlZnQ7KGM+cHx8MD5jKSYmKGkub3B0aW9ucy5ib3VuY2luZz9jKz1hLzIqdGhpcy5vcHRpb25zLnNwZWVkTXVsdGlwbGllcjpjPWM+cD9wOjApfWlmKGkuX19lbmFibGVTY3JvbGxZKXt1LT1sKnRoaXMub3B0aW9ucy5zcGVlZE11bHRpcGxpZXI7dmFyIG09aS5fX21heFNjcm9sbFRvcDt1Pm18fDA+dT9pLm9wdGlvbnMuYm91bmNpbmd8fGkuX19yZWZyZXNoSGVpZ2h0JiYwPnU/KHUrPWwvMip0aGlzLm9wdGlvbnMuc3BlZWRNdWx0aXBsaWVyLGkuX19lbmFibGVTY3JvbGxYfHxudWxsPT1pLl9fcmVmcmVzaEhlaWdodHx8KDA+dT8oaS5fX3JlZnJlc2hIaWRkZW49ITEsaS5fX3JlZnJlc2hTaG93KCkpOihpLl9fcmVmcmVzaEhpZGUoKSxpLl9fcmVmcmVzaEhpZGRlbj0hMCksIWkuX19yZWZyZXNoQWN0aXZlJiZ1PD0taS5fX3JlZnJlc2hIZWlnaHQ/KGkuX19yZWZyZXNoQWN0aXZlPSEwLGkuX19yZWZyZXNoQWN0aXZhdGUmJmkuX19yZWZyZXNoQWN0aXZhdGUoKSk6aS5fX3JlZnJlc2hBY3RpdmUmJnU+LWkuX19yZWZyZXNoSGVpZ2h0JiYoaS5fX3JlZnJlc2hBY3RpdmU9ITEsaS5fX3JlZnJlc2hEZWFjdGl2YXRlJiZpLl9fcmVmcmVzaERlYWN0aXZhdGUoKSkpKTp1PXU+bT9tOjA6aS5fX3JlZnJlc2hIZWlnaHQmJiFpLl9fcmVmcmVzaEhpZGRlbiYmKGkuX19yZWZyZXNoSGlkZSgpLGkuX19yZWZyZXNoSGlkZGVuPSEwKX1zLmxlbmd0aD42MCYmcy5zcGxpY2UoMCwzMCkscy5wdXNoKGMsdSx0KSxpLl9fcHVibGlzaChjLHUsaCl9ZWxzZXt2YXIgZz1pLm9wdGlvbnMubG9ja2luZz8zOjAsdj01LFQ9TWF0aC5hYnMoci1pLl9faW5pdGlhbFRvdWNoTGVmdCksRT1NYXRoLmFicyhvLWkuX19pbml0aWFsVG91Y2hUb3ApO2kuX19lbmFibGVTY3JvbGxYPWkub3B0aW9ucy5zY3JvbGxpbmdYJiZUPj1nLGkuX19lbmFibGVTY3JvbGxZPWkub3B0aW9ucy5zY3JvbGxpbmdZJiZFPj1nLHMucHVzaChpLl9fc2Nyb2xsTGVmdCxpLl9fc2Nyb2xsVG9wLHQpLGkuX19pc0RyYWdnaW5nPShpLl9fZW5hYmxlU2Nyb2xsWHx8aS5fX2VuYWJsZVNjcm9sbFkpJiYoVD49dnx8RT49diksaS5fX2lzRHJhZ2dpbmcmJihpLl9faW50ZXJydXB0ZWRBbmltYXRpb249ITEsaS5fX2ZhZGVTY3JvbGxiYXJzKFwiaW5cIikpfWkuX19sYXN0VG91Y2hMZWZ0PXIsaS5fX2xhc3RUb3VjaFRvcD1vLGkuX19sYXN0VG91Y2hNb3ZlPXQsaS5fX2xhc3RTY2FsZT1ufX0sZG9Ub3VjaEVuZDpmdW5jdGlvbih0KXt0IGluc3RhbmNlb2YgRGF0ZSYmKHQ9dC52YWx1ZU9mKCkpLFwibnVtYmVyXCIhPXR5cGVvZiB0JiYodD1EYXRlLm5vdygpKTt2YXIgbj10aGlzO2lmKG4uX19pc1RyYWNraW5nKXtpZihuLl9faXNUcmFja2luZz0hMSxuLl9faXNEcmFnZ2luZylpZihuLl9faXNEcmFnZ2luZz0hMSxuLl9faXNTaW5nbGVUb3VjaCYmbi5vcHRpb25zLmFuaW1hdGluZyYmdC1uLl9fbGFzdFRvdWNoTW92ZTw9MTAwKXtmb3IodmFyIGk9bi5fX3Bvc2l0aW9ucyxyPWkubGVuZ3RoLTEsbz1yLHM9cjtzPjAmJmlbc10+bi5fX2xhc3RUb3VjaE1vdmUtMTAwO3MtPTMpbz1zO2lmKG8hPT1yKXt2YXIgYT1pW3JdLWlbb10sbD1uLl9fc2Nyb2xsTGVmdC1pW28tMl0sYz1uLl9fc2Nyb2xsVG9wLWlbby0xXTtuLl9fZGVjZWxlcmF0aW9uVmVsb2NpdHlYPWwvYSooMWUzLzYwKSxuLl9fZGVjZWxlcmF0aW9uVmVsb2NpdHlZPWMvYSooMWUzLzYwKTt2YXIgdT1uLm9wdGlvbnMucGFnaW5nfHxuLm9wdGlvbnMuc25hcHBpbmc/NDoxOyhNYXRoLmFicyhuLl9fZGVjZWxlcmF0aW9uVmVsb2NpdHlYKT51fHxNYXRoLmFicyhuLl9fZGVjZWxlcmF0aW9uVmVsb2NpdHlZKT51KSYmKG4uX19yZWZyZXNoQWN0aXZlfHxuLl9fc3RhcnREZWNlbGVyYXRpb24odCkpfWVsc2Ugbi5fX3Njcm9sbGluZ0NvbXBsZXRlKCl9ZWxzZSB0LW4uX19sYXN0VG91Y2hNb3ZlPjEwMCYmbi5fX3Njcm9sbGluZ0NvbXBsZXRlKCk7aWYoIW4uX19pc0RlY2VsZXJhdGluZylpZihuLl9fcmVmcmVzaEFjdGl2ZSYmbi5fX3JlZnJlc2hTdGFydCl7bi5fX3B1Ymxpc2gobi5fX3Njcm9sbExlZnQsLW4uX19yZWZyZXNoSGVpZ2h0LG4uX196b29tTGV2ZWwsITApO3ZhciBoPW5ldyBEYXRlO24ucmVmcmVzaFN0YXJ0VGltZT1oLmdldFRpbWUoKSxuLl9fcmVmcmVzaFN0YXJ0JiZuLl9fcmVmcmVzaFN0YXJ0KCksZS5QbGF0Zm9ybS5pc0FuZHJvaWQoKXx8bi5fX3N0YXJ0RGVjZWxlcmF0aW9uKCl9ZWxzZShuLl9faW50ZXJydXB0ZWRBbmltYXRpb258fG4uX19pc0RyYWdnaW5nKSYmbi5fX3Njcm9sbGluZ0NvbXBsZXRlKCksbi5zY3JvbGxUbyhuLl9fc2Nyb2xsTGVmdCxuLl9fc2Nyb2xsVG9wLCEwLG4uX196b29tTGV2ZWwpLG4uX19yZWZyZXNoQWN0aXZlJiYobi5fX3JlZnJlc2hBY3RpdmU9ITEsbi5fX3JlZnJlc2hEZWFjdGl2YXRlJiZuLl9fcmVmcmVzaERlYWN0aXZhdGUoKSk7bi5fX3Bvc2l0aW9ucy5sZW5ndGg9MH19LF9fcHVibGlzaDpmdW5jdGlvbihlLHQscixvLHMpe3ZhciBhPXRoaXMsbD1hLl9faXNBbmltYXRpbmc7aWYobCYmKHN0LmVmZmVjdC5BbmltYXRlLnN0b3AobCksYS5fX2lzQW5pbWF0aW5nPSExKSxvJiZhLm9wdGlvbnMuYW5pbWF0aW5nKXthLl9fc2NoZWR1bGVkTGVmdD1lLGEuX19zY2hlZHVsZWRUb3A9dCxhLl9fc2NoZWR1bGVkWm9vbT1yO3ZhciBjPWEuX19zY3JvbGxMZWZ0LHU9YS5fX3Njcm9sbFRvcCxoPWEuX196b29tTGV2ZWwsZD1lLWMsXz10LXUsZj1yLWgscD1mdW5jdGlvbihlLHQsbil7biYmKGEuX19zY3JvbGxMZWZ0PWMrZCplLGEuX19zY3JvbGxUb3A9dStfKmUsYS5fX3pvb21MZXZlbD1oK2YqZSxhLl9fY2FsbGJhY2smJmEuX19jYWxsYmFjayhhLl9fc2Nyb2xsTGVmdCxhLl9fc2Nyb2xsVG9wLGEuX196b29tTGV2ZWwscykpfSxtPWZ1bmN0aW9uKGUpe3JldHVybiBhLl9faXNBbmltYXRpbmc9PT1lfSxnPWZ1bmN0aW9uKGUsdCxuKXt0PT09YS5fX2lzQW5pbWF0aW5nJiYoYS5fX2lzQW5pbWF0aW5nPSExKSwoYS5fX2RpZERlY2VsZXJhdGlvbkNvbXBsZXRlfHxuKSYmYS5fX3Njcm9sbGluZ0NvbXBsZXRlKCksYS5vcHRpb25zLnpvb21pbmcmJmEuX19jb21wdXRlU2Nyb2xsTWF4KCl9O2EuX19pc0FuaW1hdGluZz1zdC5lZmZlY3QuQW5pbWF0ZS5zdGFydChwLG0sZyxhLm9wdGlvbnMuYW5pbWF0aW9uRHVyYXRpb24sbD9uOmkpfWVsc2UgYS5fX3NjaGVkdWxlZExlZnQ9YS5fX3Njcm9sbExlZnQ9ZSxhLl9fc2NoZWR1bGVkVG9wPWEuX19zY3JvbGxUb3A9dCxhLl9fc2NoZWR1bGVkWm9vbT1hLl9fem9vbUxldmVsPXIsYS5fX2NhbGxiYWNrJiZhLl9fY2FsbGJhY2soZSx0LHIscyksYS5vcHRpb25zLnpvb21pbmcmJmEuX19jb21wdXRlU2Nyb2xsTWF4KCl9LF9fY29tcHV0ZVNjcm9sbE1heDpmdW5jdGlvbihlKXt2YXIgdD10aGlzO251bGw9PWUmJihlPXQuX196b29tTGV2ZWwpLHQuX19tYXhTY3JvbGxMZWZ0PU1hdGgubWF4KHQuX19jb250ZW50V2lkdGgqZS10Ll9fY2xpZW50V2lkdGgsMCksdC5fX21heFNjcm9sbFRvcD1NYXRoLm1heCh0Ll9fY29udGVudEhlaWdodCplLXQuX19jbGllbnRIZWlnaHQsMCksdC5fX2RpZFdhaXRGb3JTaXplfHx0Ll9fbWF4U2Nyb2xsTGVmdHx8dC5fX21heFNjcm9sbFRvcHx8KHQuX19kaWRXYWl0Rm9yU2l6ZT0hMCx0Ll9fd2FpdEZvclNpemUoKSl9LF9fd2FpdEZvclNpemU6ZnVuY3Rpb24oKXt2YXIgZT10aGlzO2NsZWFyVGltZW91dChlLl9fc2l6ZXJUaW1lb3V0KTt2YXIgdD1mdW5jdGlvbigpe2UucmVzaXplKCksZS5vcHRpb25zLnNjcm9sbGluZ1gmJiFlLl9fbWF4U2Nyb2xsTGVmdHx8ZS5vcHRpb25zLnNjcm9sbGluZ1kmJiFlLl9fbWF4U2Nyb2xsVG9wfTt0KCksZS5fX3NpemVyVGltZW91dD1zZXRUaW1lb3V0KHQsMWUzKX0sX19zdGFydERlY2VsZXJhdGlvbjpmdW5jdGlvbigpe3ZhciBlPXRoaXM7aWYoZS5vcHRpb25zLnBhZ2luZyl7dmFyIHQ9TWF0aC5tYXgoTWF0aC5taW4oZS5fX3Njcm9sbExlZnQsZS5fX21heFNjcm9sbExlZnQpLDApLG49TWF0aC5tYXgoTWF0aC5taW4oZS5fX3Njcm9sbFRvcCxlLl9fbWF4U2Nyb2xsVG9wKSwwKSxpPWUuX19jbGllbnRXaWR0aCxyPWUuX19jbGllbnRIZWlnaHQ7ZS5fX21pbkRlY2VsZXJhdGlvblNjcm9sbExlZnQ9TWF0aC5mbG9vcih0L2kpKmksZS5fX21pbkRlY2VsZXJhdGlvblNjcm9sbFRvcD1NYXRoLmZsb29yKG4vcikqcixlLl9fbWF4RGVjZWxlcmF0aW9uU2Nyb2xsTGVmdD1NYXRoLmNlaWwodC9pKSppLGUuX19tYXhEZWNlbGVyYXRpb25TY3JvbGxUb3A9TWF0aC5jZWlsKG4vcikqcn1lbHNlIGUuX19taW5EZWNlbGVyYXRpb25TY3JvbGxMZWZ0PTAsZS5fX21pbkRlY2VsZXJhdGlvblNjcm9sbFRvcD0wLGUuX19tYXhEZWNlbGVyYXRpb25TY3JvbGxMZWZ0PWUuX19tYXhTY3JvbGxMZWZ0LGUuX19tYXhEZWNlbGVyYXRpb25TY3JvbGxUb3A9ZS5fX21heFNjcm9sbFRvcCxlLl9fcmVmcmVzaEFjdGl2ZSYmKGUuX19taW5EZWNlbGVyYXRpb25TY3JvbGxUb3A9LTEqZS5fX3JlZnJlc2hIZWlnaHQpO3ZhciBvPWZ1bmN0aW9uKHQsbixpKXtlLl9fc3RlcFRocm91Z2hEZWNlbGVyYXRpb24oaSl9O2UuX19taW5WZWxvY2l0eVRvS2VlcERlY2VsZXJhdGluZz1lLm9wdGlvbnMuc25hcHBpbmc/NDouMTt2YXIgcz1mdW5jdGlvbigpe3ZhciB0PU1hdGguYWJzKGUuX19kZWNlbGVyYXRpb25WZWxvY2l0eVgpPj1lLl9fbWluVmVsb2NpdHlUb0tlZXBEZWNlbGVyYXRpbmd8fE1hdGguYWJzKGUuX19kZWNlbGVyYXRpb25WZWxvY2l0eVkpPj1lLl9fbWluVmVsb2NpdHlUb0tlZXBEZWNlbGVyYXRpbmc7cmV0dXJuIHR8fChlLl9fZGlkRGVjZWxlcmF0aW9uQ29tcGxldGU9ITAsZS5vcHRpb25zLmJvdW5jaW5nJiYhZS5fX3JlZnJlc2hBY3RpdmUmJmUuc2Nyb2xsVG8oTWF0aC5taW4oTWF0aC5tYXgoZS5fX3Njcm9sbExlZnQsMCksZS5fX21heFNjcm9sbExlZnQpLE1hdGgubWluKE1hdGgubWF4KGUuX19zY3JvbGxUb3AsMCksZS5fX21heFNjcm9sbFRvcCksZS5fX3JlZnJlc2hBY3RpdmUpKSx0fSxhPWZ1bmN0aW9uKCl7ZS5fX2lzRGVjZWxlcmF0aW5nPSExLGUuX19kaWREZWNlbGVyYXRpb25Db21wbGV0ZSYmZS5fX3Njcm9sbGluZ0NvbXBsZXRlKCksZS5vcHRpb25zLnBhZ2luZyYmZS5zY3JvbGxUbyhlLl9fc2Nyb2xsTGVmdCxlLl9fc2Nyb2xsVG9wLGUub3B0aW9ucy5zbmFwcGluZyl9O2UuX19pc0RlY2VsZXJhdGluZz1zdC5lZmZlY3QuQW5pbWF0ZS5zdGFydChvLHMsYSl9LF9fc3RlcFRocm91Z2hEZWNlbGVyYXRpb246ZnVuY3Rpb24oZSl7dmFyIHQ9dGhpcyxuPXQuX19zY3JvbGxMZWZ0K3QuX19kZWNlbGVyYXRpb25WZWxvY2l0eVgsaT10Ll9fc2Nyb2xsVG9wK3QuX19kZWNlbGVyYXRpb25WZWxvY2l0eVk7aWYoIXQub3B0aW9ucy5ib3VuY2luZyl7dmFyIHI9TWF0aC5tYXgoTWF0aC5taW4odC5fX21heERlY2VsZXJhdGlvblNjcm9sbExlZnQsbiksdC5fX21pbkRlY2VsZXJhdGlvblNjcm9sbExlZnQpO3IhPT1uJiYobj1yLHQuX19kZWNlbGVyYXRpb25WZWxvY2l0eVg9MCk7dmFyIG89TWF0aC5tYXgoTWF0aC5taW4odC5fX21heERlY2VsZXJhdGlvblNjcm9sbFRvcCxpKSx0Ll9fbWluRGVjZWxlcmF0aW9uU2Nyb2xsVG9wKTtvIT09aSYmKGk9byx0Ll9fZGVjZWxlcmF0aW9uVmVsb2NpdHlZPTApfWlmKGU/dC5fX3B1Ymxpc2gobixpLHQuX196b29tTGV2ZWwpOih0Ll9fc2Nyb2xsTGVmdD1uLHQuX19zY3JvbGxUb3A9aSksIXQub3B0aW9ucy5wYWdpbmcpe3ZhciBzPXQub3B0aW9ucy5kZWNlbGVyYXRpb247dC5fX2RlY2VsZXJhdGlvblZlbG9jaXR5WCo9cyx0Ll9fZGVjZWxlcmF0aW9uVmVsb2NpdHlZKj1zfWlmKHQub3B0aW9ucy5ib3VuY2luZyl7dmFyIGE9MCxsPTAsYz10Lm9wdGlvbnMucGVuZXRyYXRpb25EZWNlbGVyYXRpb24sdT10Lm9wdGlvbnMucGVuZXRyYXRpb25BY2NlbGVyYXRpb247aWYobjx0Ll9fbWluRGVjZWxlcmF0aW9uU2Nyb2xsTGVmdD9hPXQuX19taW5EZWNlbGVyYXRpb25TY3JvbGxMZWZ0LW46bj50Ll9fbWF4RGVjZWxlcmF0aW9uU2Nyb2xsTGVmdCYmKGE9dC5fX21heERlY2VsZXJhdGlvblNjcm9sbExlZnQtbiksaTx0Ll9fbWluRGVjZWxlcmF0aW9uU2Nyb2xsVG9wP2w9dC5fX21pbkRlY2VsZXJhdGlvblNjcm9sbFRvcC1pOmk+dC5fX21heERlY2VsZXJhdGlvblNjcm9sbFRvcCYmKGw9dC5fX21heERlY2VsZXJhdGlvblNjcm9sbFRvcC1pKSwwIT09YSl7dmFyIGg9YSp0Ll9fZGVjZWxlcmF0aW9uVmVsb2NpdHlYPD10Ll9fbWluRGVjZWxlcmF0aW9uU2Nyb2xsTGVmdDtoJiYodC5fX2RlY2VsZXJhdGlvblZlbG9jaXR5WCs9YSpjKTt2YXIgZD1NYXRoLmFicyh0Ll9fZGVjZWxlcmF0aW9uVmVsb2NpdHlYKTw9dC5fX21pblZlbG9jaXR5VG9LZWVwRGVjZWxlcmF0aW5nOyghaHx8ZCkmJih0Ll9fZGVjZWxlcmF0aW9uVmVsb2NpdHlYPWEqdSl9aWYoMCE9PWwpe3ZhciBfPWwqdC5fX2RlY2VsZXJhdGlvblZlbG9jaXR5WTw9dC5fX21pbkRlY2VsZXJhdGlvblNjcm9sbFRvcDtfJiYodC5fX2RlY2VsZXJhdGlvblZlbG9jaXR5WSs9bCpjKTt2YXIgZj1NYXRoLmFicyh0Ll9fZGVjZWxlcmF0aW9uVmVsb2NpdHlZKTw9dC5fX21pblZlbG9jaXR5VG9LZWVwRGVjZWxlcmF0aW5nOyghX3x8ZikmJih0Ll9fZGVjZWxlcmF0aW9uVmVsb2NpdHlZPWwqdSl9fX0sX19nZXREaXN0YW5jZTpmdW5jdGlvbihlLHQpe3ZhciBuPXQucGFnZVgtZS5wYWdlWCxpPXQucGFnZVktZS5wYWdlWTtyZXR1cm4gTWF0aC5zcXJ0KG4qbitpKmkpfSxfX2dldFNjYWxlOmZ1bmN0aW9uKGUsdCl7dmFyIG49dGhpcztyZXR1cm4gZS5sZW5ndGg+PTImJnQubGVuZ3RoPj0yP24uX19nZXREaXN0YW5jZSh0WzBdLHRbMV0pL24uX19nZXREaXN0YW5jZShlWzBdLGVbMV0pOjF9fSksZS5zY3JvbGw9e2lzU2Nyb2xsaW5nOiExLGxhc3RUb3A6MH19KGlvbmljKSxmdW5jdGlvbihlKXtcInVzZSBzdHJpY3RcIjtlLnZpZXdzLkhlYWRlckJhcj1lLnZpZXdzLlZpZXcuaW5oZXJpdCh7aW5pdGlhbGl6ZTpmdW5jdGlvbih0KXt0aGlzLmVsPXQuZWwsZS5leHRlbmQodGhpcyx7YWxpZ25UaXRsZTpcImNlbnRlclwifSx0KSx0aGlzLmFsaWduKCl9LGFsaWduOmZ1bmN0aW9uKHQpe3R8fCh0PXRoaXMuYWxpZ25UaXRsZSk7dmFyIG49dGhpcy5lbC5xdWVyeVNlbGVjdG9yKFwiLnRpdGxlXCIpO2lmKG4pe3ZhciBpPXRoaXM7ZS5yZXF1ZXN0QW5pbWF0aW9uRnJhbWUoZnVuY3Rpb24oKXt2YXIgcixvLHMsYT1pLmVsLmNoaWxkTm9kZXMsbD0wLGM9MCx1PSExO2ZvcihyPTA7cjxhLmxlbmd0aDtyKyspaWYobz1hW3JdLG8udGFnTmFtZSYmXCJoMVwiPT1vLnRhZ05hbWUudG9Mb3dlckNhc2UoKSl1PSEwO2Vsc2V7aWYocz1udWxsLDM9PW8ubm9kZVR5cGUpe3ZhciBoPWUuRG9tVXRpbC5nZXRUZXh0Qm91bmRzKG8pO2gmJihzPWgud2lkdGgpfWVsc2UgMT09by5ub2RlVHlwZSYmKHM9by5vZmZzZXRXaWR0aCk7cyYmKHU/Yys9czpsKz1zKX12YXIgZD1NYXRoLm1heChsLGMpKzEwO24uc3R5bGUubGVmdD1uLnN0eWxlLnJpZ2h0PVwiXCIsXCJjZW50ZXJcIj09dD8oZD4xMCYmKG4uc3R5bGUubGVmdD1kK1wicHhcIixuLnN0eWxlLnJpZ2h0PWQrXCJweFwiKSxuLm9mZnNldFdpZHRoPG4uc2Nyb2xsV2lkdGgmJmM+MCYmKG4uc3R5bGUucmlnaHQ9Yys1K1wicHhcIikpOlwibGVmdFwiPT10PyhuLmNsYXNzTGlzdC5hZGQoXCJ0aXRsZS1sZWZ0XCIpLGw+MCYmKG4uc3R5bGUubGVmdD1sKzE1K1wicHhcIikpOlwicmlnaHRcIj09dCYmKG4uY2xhc3NMaXN0LmFkZChcInRpdGxlLXJpZ2h0XCIpLGM+MCYmKG4uc3R5bGUucmlnaHQ9YysxNStcInB4XCIpKX0pfX19KX0oaW9uaWMpLGZ1bmN0aW9uKGUpe1widXNlIHN0cmljdFwiO3ZhciB0PVwiaXRlbVwiLG49XCJpdGVtLWNvbnRlbnRcIixpPVwiaXRlbS1zbGlkaW5nXCIscj1cIml0ZW0tb3B0aW9uc1wiLG89XCJpdGVtLXBsYWNlaG9sZGVyXCIscz1cIml0ZW0tcmVvcmRlcmluZ1wiLGE9XCJpdGVtLXJlb3JkZXJcIixsPWZ1bmN0aW9uKCl7fTtsLnByb3RvdHlwZT17c3RhcnQ6ZnVuY3Rpb24oKXt9LGRyYWc6ZnVuY3Rpb24oKXt9LGVuZDpmdW5jdGlvbigpe30saXNTYW1lSXRlbTpmdW5jdGlvbigpe3JldHVybiExfX07dmFyIGM9ZnVuY3Rpb24oZSl7dGhpcy5kcmFnVGhyZXNob2xkWD1lLmRyYWdUaHJlc2hvbGRYfHwxMCx0aGlzLmVsPWUuZWwsdGhpcy5jYW5Td2lwZT1lLmNhblN3aXBlfTtjLnByb3RvdHlwZT1uZXcgbCxjLnByb3RvdHlwZS5zdGFydD1mdW5jdGlvbihvKXt2YXIgcyxhLGwsYzt0aGlzLmNhblN3aXBlKCkmJihzPW8udGFyZ2V0LmNsYXNzTGlzdC5jb250YWlucyhuKT9vLnRhcmdldDpvLnRhcmdldC5jbGFzc0xpc3QuY29udGFpbnModCk/by50YXJnZXQucXVlcnlTZWxlY3RvcihcIi5cIituKTplLkRvbVV0aWwuZ2V0UGFyZW50V2l0aENsYXNzKG8udGFyZ2V0LG4pLHMmJihzLmNsYXNzTGlzdC5yZW1vdmUoaSksbD1wYXJzZUZsb2F0KHMuc3R5bGVbZS5DU1MuVFJBTlNGT1JNXS5yZXBsYWNlKFwidHJhbnNsYXRlM2QoXCIsXCJcIikuc3BsaXQoXCIsXCIpWzBdKXx8MCxhPXMucGFyZW50Tm9kZS5xdWVyeVNlbGVjdG9yKFwiLlwiK3IpLGEmJihhLmNsYXNzTGlzdC5yZW1vdmUoXCJpbnZpc2libGVcIiksYz1hLm9mZnNldFdpZHRoLHRoaXMuX2N1cnJlbnREcmFnPXtidXR0b25zOmEsYnV0dG9uc1dpZHRoOmMsY29udGVudDpzLHN0YXJ0T2Zmc2V0WDpsfSkpKX0sYy5wcm90b3R5cGUuaXNTYW1lSXRlbT1mdW5jdGlvbihlKXtyZXR1cm4gZS5fbGFzdERyYWcmJnRoaXMuX2N1cnJlbnREcmFnP3RoaXMuX2N1cnJlbnREcmFnLmNvbnRlbnQ9PWUuX2xhc3REcmFnLmNvbnRlbnQ6ITF9LGMucHJvdG90eXBlLmNsZWFuPWZ1bmN0aW9uKCl7dmFyIHQ9dGhpcy5fbGFzdERyYWc7dCYmKHQuY29udGVudC5zdHlsZVtlLkNTUy5UUkFOU0lUSU9OXT1cIlwiLHQuY29udGVudC5zdHlsZVtlLkNTUy5UUkFOU0ZPUk1dPVwiXCIsZS5yZXF1ZXN0QW5pbWF0aW9uRnJhbWUoZnVuY3Rpb24oKXtzZXRUaW1lb3V0KGZ1bmN0aW9uKCl7dC5idXR0b25zJiZ0LmJ1dHRvbnMuY2xhc3NMaXN0LmFkZChcImludmlzaWJsZVwiKX0sMjUwKX0pKX0sYy5wcm90b3R5cGUuZHJhZz1lLmFuaW1hdGlvbkZyYW1lVGhyb3R0bGUoZnVuY3Rpb24odCl7dmFyIG47aWYodGhpcy5fY3VycmVudERyYWcmJighdGhpcy5faXNEcmFnZ2luZyYmKE1hdGguYWJzKHQuZ2VzdHVyZS5kZWx0YVgpPnRoaXMuZHJhZ1RocmVzaG9sZFh8fE1hdGguYWJzKHRoaXMuX2N1cnJlbnREcmFnLnN0YXJ0T2Zmc2V0WCk+MCkmJih0aGlzLl9pc0RyYWdnaW5nPSEwKSx0aGlzLl9pc0RyYWdnaW5nKSl7bj10aGlzLl9jdXJyZW50RHJhZy5idXR0b25zV2lkdGg7dmFyIGk9TWF0aC5taW4oMCx0aGlzLl9jdXJyZW50RHJhZy5zdGFydE9mZnNldFgrdC5nZXN0dXJlLmRlbHRhWCk7LW4+aSYmKGk9TWF0aC5taW4oLW4sLW4rLjQqKHQuZ2VzdHVyZS5kZWx0YVgrbikpKSx0aGlzLl9jdXJyZW50RHJhZy5jb250ZW50LnN0eWxlW2UuQ1NTLlRSQU5TRk9STV09XCJ0cmFuc2xhdGUzZChcIitpK1wicHgsIDAsIDApXCIsdGhpcy5fY3VycmVudERyYWcuY29udGVudC5zdHlsZVtlLkNTUy5UUkFOU0lUSU9OXT1cIm5vbmVcIlxufX0pLGMucHJvdG90eXBlLmVuZD1mdW5jdGlvbih0LG4pe3ZhciBpPXRoaXM7aWYoIXRoaXMuX2N1cnJlbnREcmFnKXJldHVybiB2b2lkKG4mJm4oKSk7dmFyIHI9LXRoaXMuX2N1cnJlbnREcmFnLmJ1dHRvbnNXaWR0aDt0Lmdlc3R1cmUuZGVsdGFYPi0odGhpcy5fY3VycmVudERyYWcuYnV0dG9uc1dpZHRoLzIpJiYoXCJsZWZ0XCI9PXQuZ2VzdHVyZS5kaXJlY3Rpb24mJk1hdGguYWJzKHQuZ2VzdHVyZS52ZWxvY2l0eVgpPC4zP3I9MDpcInJpZ2h0XCI9PXQuZ2VzdHVyZS5kaXJlY3Rpb24mJihyPTApKSxlLnJlcXVlc3RBbmltYXRpb25GcmFtZShmdW5jdGlvbigpe2lmKDA9PT1yKXtpLl9jdXJyZW50RHJhZy5jb250ZW50LnN0eWxlW2UuQ1NTLlRSQU5TRk9STV09XCJcIjt2YXIgdD1pLl9jdXJyZW50RHJhZy5idXR0b25zO3NldFRpbWVvdXQoZnVuY3Rpb24oKXt0JiZ0LmNsYXNzTGlzdC5hZGQoXCJpbnZpc2libGVcIil9LDI1MCl9ZWxzZSBpLl9jdXJyZW50RHJhZy5jb250ZW50LnN0eWxlW2UuQ1NTLlRSQU5TRk9STV09XCJ0cmFuc2xhdGUzZChcIityK1wicHgsIDAsIDApXCI7aS5fY3VycmVudERyYWcuY29udGVudC5zdHlsZVtlLkNTUy5UUkFOU0lUSU9OXT1cIlwiLGkuX2xhc3REcmFnPWkuX2N1cnJlbnREcmFnLGkuX2N1cnJlbnREcmFnPW51bGwsbiYmbigpfSl9O3ZhciB1PWZ1bmN0aW9uKGUpe2lmKHRoaXMuZHJhZ1RocmVzaG9sZFk9ZS5kcmFnVGhyZXNob2xkWXx8MCx0aGlzLm9uUmVvcmRlcj1lLm9uUmVvcmRlcix0aGlzLmxpc3RFbD1lLmxpc3RFbCx0aGlzLmVsPWUuZWwsdGhpcy5zY3JvbGxFbD1lLnNjcm9sbEVsLHRoaXMuc2Nyb2xsVmlldz1lLnNjcm9sbFZpZXcsdGhpcy5saXN0RWxUcnVlVG9wPTAsdGhpcy5saXN0RWwub2Zmc2V0UGFyZW50KXt2YXIgdD10aGlzLmxpc3RFbDtkbyB0aGlzLmxpc3RFbFRydWVUb3ArPXQub2Zmc2V0VG9wLHQ9dC5vZmZzZXRQYXJlbnQ7d2hpbGUodCl9fTt1LnByb3RvdHlwZT1uZXcgbCx1LnByb3RvdHlwZS5fbW92ZUVsZW1lbnQ9ZnVuY3Rpb24odCl7dmFyIG49dC5nZXN0dXJlLmNlbnRlci5wYWdlWSt0aGlzLnNjcm9sbFZpZXcuZ2V0VmFsdWVzKCkudG9wLXRoaXMuX2N1cnJlbnREcmFnLmVsZW1lbnRIZWlnaHQvMi10aGlzLmxpc3RFbFRydWVUb3A7dGhpcy5lbC5zdHlsZVtlLkNTUy5UUkFOU0ZPUk1dPVwidHJhbnNsYXRlM2QoMCwgXCIrbitcInB4LCAwKVwifSx1LnByb3RvdHlwZS5zdGFydD1mdW5jdGlvbih0KXt2YXIgbj1lLkRvbVV0aWwuZ2V0Q2hpbGRJbmRleCh0aGlzLmVsLHRoaXMuZWwubm9kZU5hbWUudG9Mb3dlckNhc2UoKSksaT10aGlzLmVsLnNjcm9sbEhlaWdodCxyPXRoaXMuZWwuY2xvbmVOb2RlKCEwKTtyLmNsYXNzTGlzdC5hZGQobyksdGhpcy5lbC5wYXJlbnROb2RlLmluc2VydEJlZm9yZShyLHRoaXMuZWwpLHRoaXMuZWwuY2xhc3NMaXN0LmFkZChzKSx0aGlzLl9jdXJyZW50RHJhZz17ZWxlbWVudEhlaWdodDppLHN0YXJ0SW5kZXg6bixwbGFjZWhvbGRlcjpyLHNjcm9sbEhlaWdodDpzY3JvbGwsbGlzdDpyLnBhcmVudE5vZGV9LHRoaXMuX21vdmVFbGVtZW50KHQpfSx1LnByb3RvdHlwZS5kcmFnPWUuYW5pbWF0aW9uRnJhbWVUaHJvdHRsZShmdW5jdGlvbih0KXt2YXIgbj10aGlzO2lmKHRoaXMuX2N1cnJlbnREcmFnKXt2YXIgaT0wLHI9dC5nZXN0dXJlLmNlbnRlci5wYWdlWSxvPXRoaXMubGlzdEVsVHJ1ZVRvcDtpZih0aGlzLnNjcm9sbFZpZXcpe3ZhciBzPXRoaXMuc2Nyb2xsVmlldy5fX2NvbnRhaW5lcjtpPXRoaXMuc2Nyb2xsVmlldy5nZXRWYWx1ZXMoKS50b3A7dmFyIGE9cy5vZmZzZXRUb3AsbD1hLXIrdGhpcy5fY3VycmVudERyYWcuZWxlbWVudEhlaWdodC8yLGM9cit0aGlzLl9jdXJyZW50RHJhZy5lbGVtZW50SGVpZ2h0LzItYS1zLm9mZnNldEhlaWdodDt0Lmdlc3R1cmUuZGVsdGFZPDAmJmw+MCYmaT4wJiYodGhpcy5zY3JvbGxWaWV3LnNjcm9sbEJ5KG51bGwsLWwpLGUucmVxdWVzdEFuaW1hdGlvbkZyYW1lKGZ1bmN0aW9uKCl7bi5kcmFnKHQpfSkpLHQuZ2VzdHVyZS5kZWx0YVk+MCYmYz4wJiZpPHRoaXMuc2Nyb2xsVmlldy5nZXRTY3JvbGxNYXgoKS50b3AmJih0aGlzLnNjcm9sbFZpZXcuc2Nyb2xsQnkobnVsbCxjKSxlLnJlcXVlc3RBbmltYXRpb25GcmFtZShmdW5jdGlvbigpe24uZHJhZyh0KX0pKX0hdGhpcy5faXNEcmFnZ2luZyYmTWF0aC5hYnModC5nZXN0dXJlLmRlbHRhWSk+dGhpcy5kcmFnVGhyZXNob2xkWSYmKHRoaXMuX2lzRHJhZ2dpbmc9ITApLHRoaXMuX2lzRHJhZ2dpbmcmJih0aGlzLl9tb3ZlRWxlbWVudCh0KSx0aGlzLl9jdXJyZW50RHJhZy5jdXJyZW50WT1pK3Itbyl9fSksdS5wcm90b3R5cGUuX2dldFJlb3JkZXJJbmRleD1mdW5jdGlvbigpe2Zvcih2YXIgZSx0PXRoaXMsbj0odGhpcy5fY3VycmVudERyYWcucGxhY2Vob2xkZXIsQXJyYXkucHJvdG90eXBlLnNsaWNlLmNhbGwodGhpcy5fY3VycmVudERyYWcucGxhY2Vob2xkZXIucGFyZW50Tm9kZS5jaGlsZHJlbikuZmlsdGVyKGZ1bmN0aW9uKGUpe3JldHVybiBlLm5vZGVOYW1lPT09dC5lbC5ub2RlTmFtZSYmZSE9PXQuZWx9KSksaT10aGlzLl9jdXJyZW50RHJhZy5jdXJyZW50WSxyPTAsbz1uLmxlbmd0aDtvPnI7cisrKWlmKGU9bltyXSxyPT09by0xKXtpZihpPmUub2Zmc2V0VG9wKXJldHVybiByfWVsc2UgaWYoMD09PXIpe2lmKGk8ZS5vZmZzZXRUb3ArZS5vZmZzZXRIZWlnaHQpcmV0dXJuIHJ9ZWxzZSBpZihpPmUub2Zmc2V0VG9wLWUub2Zmc2V0SGVpZ2h0LzImJmk8ZS5vZmZzZXRUb3ArZS5vZmZzZXRIZWlnaHQpcmV0dXJuIHI7cmV0dXJuIHRoaXMuX2N1cnJlbnREcmFnLnN0YXJ0SW5kZXh9LHUucHJvdG90eXBlLmVuZD1mdW5jdGlvbih0LG4pe2lmKCF0aGlzLl9jdXJyZW50RHJhZylyZXR1cm4gdm9pZChuJiZuKCkpO3ZhciBpPXRoaXMuX2N1cnJlbnREcmFnLnBsYWNlaG9sZGVyLHI9dGhpcy5fZ2V0UmVvcmRlckluZGV4KCk7dGhpcy5lbC5jbGFzc0xpc3QucmVtb3ZlKHMpLHRoaXMuZWwuc3R5bGVbZS5DU1MuVFJBTlNGT1JNXT1cIlwiLGkucGFyZW50Tm9kZS5pbnNlcnRCZWZvcmUodGhpcy5lbCxpKSxpLnBhcmVudE5vZGUucmVtb3ZlQ2hpbGQoaSksdGhpcy5vblJlb3JkZXImJnRoaXMub25SZW9yZGVyKHRoaXMuZWwsdGhpcy5fY3VycmVudERyYWcuc3RhcnRJbmRleCxyKSx0aGlzLl9jdXJyZW50RHJhZz1udWxsLG4mJm4oKX0sZS52aWV3cy5MaXN0Vmlldz1lLnZpZXdzLlZpZXcuaW5oZXJpdCh7aW5pdGlhbGl6ZTpmdW5jdGlvbih0KXt2YXIgbj10aGlzO3Q9ZS5leHRlbmQoe29uUmVvcmRlcjpmdW5jdGlvbigpe30sdmlydHVhbFJlbW92ZVRocmVzaG9sZDotMjAwLHZpcnR1YWxBZGRUaHJlc2hvbGQ6MjAwLGNhblN3aXBlOmZ1bmN0aW9uKCl7cmV0dXJuITB9fSx0KSxlLmV4dGVuZCh0aGlzLHQpLCF0aGlzLml0ZW1IZWlnaHQmJnRoaXMubGlzdEVsJiYodGhpcy5pdGVtSGVpZ2h0PXRoaXMubGlzdEVsLmNoaWxkcmVuWzBdJiZwYXJzZUludCh0aGlzLmxpc3RFbC5jaGlsZHJlblswXS5zdHlsZS5oZWlnaHQsMTApKSx0aGlzLm9uUmVmcmVzaD10Lm9uUmVmcmVzaHx8ZnVuY3Rpb24oKXt9LHRoaXMub25SZWZyZXNoT3BlbmluZz10Lm9uUmVmcmVzaE9wZW5pbmd8fGZ1bmN0aW9uKCl7fSx0aGlzLm9uUmVmcmVzaEhvbGRpbmc9dC5vblJlZnJlc2hIb2xkaW5nfHxmdW5jdGlvbigpe30sd2luZG93LmlvbmljLm9uR2VzdHVyZShcInJlbGVhc2VcIixmdW5jdGlvbihlKXtuLl9oYW5kbGVFbmREcmFnKGUpfSx0aGlzLmVsKSx3aW5kb3cuaW9uaWMub25HZXN0dXJlKFwiZHJhZ1wiLGZ1bmN0aW9uKGUpe24uX2hhbmRsZURyYWcoZSl9LHRoaXMuZWwpLHRoaXMuX2luaXREcmFnKCl9LHN0b3BSZWZyZXNoaW5nOmZ1bmN0aW9uKCl7dmFyIGU9dGhpcy5lbC5xdWVyeVNlbGVjdG9yKFwiLmxpc3QtcmVmcmVzaGVyXCIpO2Uuc3R5bGUuaGVpZ2h0PVwiMHB4XCJ9LGRpZFNjcm9sbDpmdW5jdGlvbihlKXtpZih0aGlzLmlzVmlydHVhbCl7dmFyIHQ9dGhpcy5pdGVtSGVpZ2h0LG49KHRoaXMubGlzdEVsLmNoaWxkcmVuLmxlbmd0aCxlLnRhcmdldC5zY3JvbGxIZWlnaHQpLGk9dGhpcy5lbC5wYXJlbnROb2RlLm9mZnNldEhlaWdodCxyPShlLnNjcm9sbFRvcCxNYXRoLm1heCgwLGUuc2Nyb2xsVG9wK3RoaXMudmlydHVhbFJlbW92ZVRocmVzaG9sZCkpLG89TWF0aC5taW4obixNYXRoLmFicyhlLnNjcm9sbFRvcCkraSt0aGlzLnZpcnR1YWxBZGRUaHJlc2hvbGQpLHM9TWF0aC5mbG9vcigoby1yKS90KSxhPXBhcnNlSW50KE1hdGguYWJzKHIvdCksMTApLGw9cGFyc2VJbnQoTWF0aC5hYnMoby90KSwxMCk7dGhpcy5fdmlydHVhbEl0ZW1zVG9SZW1vdmU9QXJyYXkucHJvdG90eXBlLnNsaWNlLmNhbGwodGhpcy5saXN0RWwuY2hpbGRyZW4sMCxhKTt7QXJyYXkucHJvdG90eXBlLnNsaWNlLmNhbGwodGhpcy5saXN0RWwuY2hpbGRyZW4sYSxhK3MpfXRoaXMucmVuZGVyVmlld3BvcnQmJnRoaXMucmVuZGVyVmlld3BvcnQocixvLGEsbCl9fSxkaWRTdG9wU2Nyb2xsaW5nOmZ1bmN0aW9uKCl7aWYodGhpcy5pc1ZpcnR1YWwpZm9yKHZhciBlPTA7ZTx0aGlzLl92aXJ0dWFsSXRlbXNUb1JlbW92ZS5sZW5ndGg7ZSsrKXt7dGhpcy5fdmlydHVhbEl0ZW1zVG9SZW1vdmVbZV19dGhpcy5kaWRIaWRlSXRlbSYmdGhpcy5kaWRIaWRlSXRlbShlKX19LGNsZWFyRHJhZ0VmZmVjdHM6ZnVuY3Rpb24oKXt0aGlzLl9sYXN0RHJhZ09wJiYodGhpcy5fbGFzdERyYWdPcC5jbGVhbiYmdGhpcy5fbGFzdERyYWdPcC5jbGVhbigpLHRoaXMuX2xhc3REcmFnT3A9bnVsbCl9LF9pbml0RHJhZzpmdW5jdGlvbigpe3RoaXMuX2xhc3REcmFnT3A9dGhpcy5fZHJhZ09wLHRoaXMuX2RyYWdPcD1udWxsfSxfZ2V0SXRlbTpmdW5jdGlvbihlKXtmb3IoO2U7KXtpZihlLmNsYXNzTGlzdCYmZS5jbGFzc0xpc3QuY29udGFpbnModCkpcmV0dXJuIGU7ZT1lLnBhcmVudE5vZGV9cmV0dXJuIG51bGx9LF9zdGFydERyYWc6ZnVuY3Rpb24odCl7dmFyIG49dGhpczt0aGlzLl9pc0RyYWdnaW5nPSExO3ZhciBpLHI9dGhpcy5fbGFzdERyYWdPcDshZS5Eb21VdGlsLmdldFBhcmVudE9yU2VsZldpdGhDbGFzcyh0LnRhcmdldCxhKXx8XCJ1cFwiIT10Lmdlc3R1cmUuZGlyZWN0aW9uJiZcImRvd25cIiE9dC5nZXN0dXJlLmRpcmVjdGlvbj8hdGhpcy5fZGlkRHJhZ1VwT3JEb3duJiYoXCJsZWZ0XCI9PXQuZ2VzdHVyZS5kaXJlY3Rpb258fFwicmlnaHRcIj09dC5nZXN0dXJlLmRpcmVjdGlvbikmJk1hdGguYWJzKHQuZ2VzdHVyZS5kZWx0YVgpPjUmJihpPXRoaXMuX2dldEl0ZW0odC50YXJnZXQpLGkmJmkucXVlcnlTZWxlY3RvcihcIi5pdGVtLW9wdGlvbnNcIikmJih0aGlzLl9kcmFnT3A9bmV3IGMoe2VsOnRoaXMuZWwsY2FuU3dpcGU6dGhpcy5jYW5Td2lwZX0pLHRoaXMuX2RyYWdPcC5zdGFydCh0KSx0LnByZXZlbnREZWZhdWx0KCkpKTooaT10aGlzLl9nZXRJdGVtKHQudGFyZ2V0KSxpJiYodGhpcy5fZHJhZ09wPW5ldyB1KHtsaXN0RWw6dGhpcy5lbCxlbDppLHNjcm9sbEVsOnRoaXMuc2Nyb2xsRWwsc2Nyb2xsVmlldzp0aGlzLnNjcm9sbFZpZXcsb25SZW9yZGVyOmZ1bmN0aW9uKGUsdCxpKXtuLm9uUmVvcmRlciYmbi5vblJlb3JkZXIoZSx0LGkpfX0pLHRoaXMuX2RyYWdPcC5zdGFydCh0KSx0LnByZXZlbnREZWZhdWx0KCkpKSxyJiZ0aGlzLl9kcmFnT3AmJiF0aGlzLl9kcmFnT3AuaXNTYW1lSXRlbShyKSYmdC5kZWZhdWx0UHJldmVudGVkJiZyLmNsZWFuJiZyLmNsZWFuKCl9LF9oYW5kbGVFbmREcmFnOmZ1bmN0aW9uKGUpe3ZhciB0PXRoaXM7dGhpcy5fZGlkRHJhZ1VwT3JEb3duPSExLHRoaXMuX2RyYWdPcCYmdGhpcy5fZHJhZ09wLmVuZChlLGZ1bmN0aW9uKCl7dC5faW5pdERyYWcoKX0pfSxfaGFuZGxlRHJhZzpmdW5jdGlvbihlKXtNYXRoLmFicyhlLmdlc3R1cmUuZGVsdGFZKT41JiYodGhpcy5fZGlkRHJhZ1VwT3JEb3duPSEwKSx0aGlzLmlzRHJhZ2dpbmd8fHRoaXMuX2RyYWdPcHx8dGhpcy5fc3RhcnREcmFnKGUpLHRoaXMuX2RyYWdPcCYmKGUuZ2VzdHVyZS5zcmNFdmVudC5wcmV2ZW50RGVmYXVsdCgpLHRoaXMuX2RyYWdPcC5kcmFnKGUpKX19KX0oaW9uaWMpLGZ1bmN0aW9uKGUpe1widXNlIHN0cmljdFwiO2Uudmlld3MuTW9kYWw9ZS52aWV3cy5WaWV3LmluaGVyaXQoe2luaXRpYWxpemU6ZnVuY3Rpb24odCl7dD1lLmV4dGVuZCh7Zm9jdXNGaXJzdElucHV0OiExLHVuZm9jdXNPbkhpZGU6ITAsZm9jdXNGaXJzdERlbGF5OjYwMCxiYWNrZHJvcENsaWNrVG9DbG9zZTohMCxoYXJkd2FyZUJhY2tCdXR0b25DbG9zZTohMH0sdCksZS5leHRlbmQodGhpcyx0KSx0aGlzLmVsPXQuZWx9LHNob3c6ZnVuY3Rpb24oKXt2YXIgZT10aGlzO2UuZm9jdXNGaXJzdElucHV0JiZ3aW5kb3cuc2V0VGltZW91dChmdW5jdGlvbigpe3ZhciB0PWUuZWwucXVlcnlTZWxlY3RvcihcImlucHV0LCB0ZXh0YXJlYVwiKTt0JiZ0LmZvY3VzJiZ0LmZvY3VzKCl9LGUuZm9jdXNGaXJzdERlbGF5KX0saGlkZTpmdW5jdGlvbigpe2lmKHRoaXMudW5mb2N1c09uSGlkZSl7dmFyIGU9dGhpcy5lbC5xdWVyeVNlbGVjdG9yQWxsKFwiaW5wdXQsIHRleHRhcmVhXCIpO3dpbmRvdy5zZXRUaW1lb3V0KGZ1bmN0aW9uKCl7Zm9yKHZhciB0PTA7dDxlLmxlbmd0aDt0KyspZVt0XS5ibHVyJiZlW3RdLmJsdXIoKX0pfX19KX0oaW9uaWMpLGZ1bmN0aW9uKGUpe1widXNlIHN0cmljdFwiO2Uudmlld3MuU2lkZU1lbnU9ZS52aWV3cy5WaWV3LmluaGVyaXQoe2luaXRpYWxpemU6ZnVuY3Rpb24oZSl7dGhpcy5lbD1lLmVsLHRoaXMuaXNFbmFibGVkPVwidW5kZWZpbmVkXCI9PXR5cGVvZiBlLmlzRW5hYmxlZD8hMDplLmlzRW5hYmxlZCx0aGlzLnNldFdpZHRoKGUud2lkdGgpfSxnZXRGdWxsV2lkdGg6ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy53aWR0aH0sc2V0V2lkdGg6ZnVuY3Rpb24oZSl7dGhpcy53aWR0aD1lLHRoaXMuZWwuc3R5bGUud2lkdGg9ZStcInB4XCJ9LHNldElzRW5hYmxlZDpmdW5jdGlvbihlKXt0aGlzLmlzRW5hYmxlZD1lfSxicmluZ1VwOmZ1bmN0aW9uKCl7XCIwXCIhPT10aGlzLmVsLnN0eWxlLnpJbmRleCYmKHRoaXMuZWwuc3R5bGUuekluZGV4PVwiMFwiKX0scHVzaERvd246ZnVuY3Rpb24oKXtcIi0xXCIhPT10aGlzLmVsLnN0eWxlLnpJbmRleCYmKHRoaXMuZWwuc3R5bGUuekluZGV4PVwiLTFcIil9fSksZS52aWV3cy5TaWRlTWVudUNvbnRlbnQ9ZS52aWV3cy5WaWV3LmluaGVyaXQoe2luaXRpYWxpemU6ZnVuY3Rpb24odCl7ZS5leHRlbmQodGhpcyx7YW5pbWF0aW9uQ2xhc3M6XCJtZW51LWFuaW1hdGVkXCIsb25EcmFnOmZ1bmN0aW9uKCl7fSxvbkVuZERyYWc6ZnVuY3Rpb24oKXt9fSx0KSxlLm9uR2VzdHVyZShcImRyYWdcIixlLnByb3h5KHRoaXMuX29uRHJhZyx0aGlzKSx0aGlzLmVsKSxlLm9uR2VzdHVyZShcInJlbGVhc2VcIixlLnByb3h5KHRoaXMuX29uRW5kRHJhZyx0aGlzKSx0aGlzLmVsKX0sX29uRHJhZzpmdW5jdGlvbihlKXt0aGlzLm9uRHJhZyYmdGhpcy5vbkRyYWcoZSl9LF9vbkVuZERyYWc6ZnVuY3Rpb24oZSl7dGhpcy5vbkVuZERyYWcmJnRoaXMub25FbmREcmFnKGUpfSxkaXNhYmxlQW5pbWF0aW9uOmZ1bmN0aW9uKCl7dGhpcy5lbC5jbGFzc0xpc3QucmVtb3ZlKHRoaXMuYW5pbWF0aW9uQ2xhc3MpfSxlbmFibGVBbmltYXRpb246ZnVuY3Rpb24oKXt0aGlzLmVsLmNsYXNzTGlzdC5hZGQodGhpcy5hbmltYXRpb25DbGFzcyl9LGdldFRyYW5zbGF0ZVg6ZnVuY3Rpb24oKXtyZXR1cm4gcGFyc2VGbG9hdCh0aGlzLmVsLnN0eWxlW2UuQ1NTLlRSQU5TRk9STV0ucmVwbGFjZShcInRyYW5zbGF0ZTNkKFwiLFwiXCIpLnNwbGl0KFwiLFwiKVswXSl9LHNldFRyYW5zbGF0ZVg6ZS5hbmltYXRpb25GcmFtZVRocm90dGxlKGZ1bmN0aW9uKHQpe3RoaXMuZWwuc3R5bGVbZS5DU1MuVFJBTlNGT1JNXT1cInRyYW5zbGF0ZTNkKFwiK3QrXCJweCwgMCwgMClcIn0pfSl9KGlvbmljKSxmdW5jdGlvbihlKXtcInVzZSBzdHJpY3RcIjtlLnZpZXdzLlNsaWRlcj1lLnZpZXdzLlZpZXcuaW5oZXJpdCh7aW5pdGlhbGl6ZTpmdW5jdGlvbihlKXtmdW5jdGlvbiB0KCl7bT1FLmNoaWxkcmVuLFQ9bS5sZW5ndGgsbS5sZW5ndGg8MiYmKGUuY29udGludW91cz0hMSksZi50cmFuc2l0aW9ucyYmZS5jb250aW51b3VzJiZtLmxlbmd0aDwzJiYoRS5hcHBlbmRDaGlsZChtWzBdLmNsb25lTm9kZSghMCkpLEUuYXBwZW5kQ2hpbGQoRS5jaGlsZHJlblsxXS5jbG9uZU5vZGUoITApKSxtPUUuY2hpbGRyZW4pLGc9bmV3IEFycmF5KG0ubGVuZ3RoKSx2PXAub2Zmc2V0V2lkdGh8fHAuZ2V0Qm91bmRpbmdDbGllbnRSZWN0KCkud2lkdGgsRS5zdHlsZS53aWR0aD1tLmxlbmd0aCp2K1wicHhcIjtmb3IodmFyIHQ9bS5sZW5ndGg7dC0tOyl7dmFyIG49bVt0XTtuLnN0eWxlLndpZHRoPXYrXCJweFwiLG4uc2V0QXR0cmlidXRlKFwiZGF0YS1pbmRleFwiLHQpLGYudHJhbnNpdGlvbnMmJihuLnN0eWxlLmxlZnQ9dCotditcInB4XCIscyh0LFM+dD8tdjp0PlM/djowLDApKX1lLmNvbnRpbnVvdXMmJmYudHJhbnNpdGlvbnMmJihzKHIoUy0xKSwtdiwwKSxzKHIoUysxKSx2LDApKSxmLnRyYW5zaXRpb25zfHwoRS5zdHlsZS5sZWZ0PVMqLXYrXCJweFwiKSxwLnN0eWxlLnZpc2liaWxpdHk9XCJ2aXNpYmxlXCIsZS5zbGlkZXNDaGFuZ2VkJiZlLnNsaWRlc0NoYW5nZWQoKX1mdW5jdGlvbiBuKCl7ZS5jb250aW51b3VzP28oUy0xKTpTJiZvKFMtMSl9ZnVuY3Rpb24gaSgpe2UuY29udGludW91cz9vKFMrMSk6UzxtLmxlbmd0aC0xJiZvKFMrMSl9ZnVuY3Rpb24gcihlKXtyZXR1cm4obS5sZW5ndGgrZSVtLmxlbmd0aCklbS5sZW5ndGh9ZnVuY3Rpb24gbyh0LG4pe2lmKFMhPXQpe2lmKGYudHJhbnNpdGlvbnMpe3ZhciBpPU1hdGguYWJzKFMtdCkvKFMtdCk7aWYoZS5jb250aW51b3VzKXt2YXIgbz1pO2k9LWdbcih0KV0vdixpIT09byYmKHQ9LWkqbS5sZW5ndGgrdCl9Zm9yKHZhciBhPU1hdGguYWJzKFMtdCktMTthLS07KXMocigodD5TP3Q6UyktYS0xKSx2KmksMCk7dD1yKHQpLHMoUyx2Kmksbnx8dykscyh0LDAsbnx8dyksZS5jb250aW51b3VzJiZzKHIodC1pKSwtKHYqaSksMCl9ZWxzZSB0PXIodCksbChTKi12LHQqLXYsbnx8dyk7Uz10LF8oZS5jYWxsYmFjayYmZS5jYWxsYmFjayhTLG1bU10pKX19ZnVuY3Rpb24gcyhlLHQsbil7YShlLHQsbiksZ1tlXT10fWZ1bmN0aW9uIGEoZSx0LG4pe3ZhciBpPW1bZV0scj1pJiZpLnN0eWxlO3ImJihyLndlYmtpdFRyYW5zaXRpb25EdXJhdGlvbj1yLk1velRyYW5zaXRpb25EdXJhdGlvbj1yLm1zVHJhbnNpdGlvbkR1cmF0aW9uPXIuT1RyYW5zaXRpb25EdXJhdGlvbj1yLnRyYW5zaXRpb25EdXJhdGlvbj1uK1wibXNcIixyLndlYmtpdFRyYW5zZm9ybT1cInRyYW5zbGF0ZShcIit0K1wicHgsMCl0cmFuc2xhdGVaKDApXCIsci5tc1RyYW5zZm9ybT1yLk1velRyYW5zZm9ybT1yLk9UcmFuc2Zvcm09XCJ0cmFuc2xhdGVYKFwiK3QrXCJweClcIil9ZnVuY3Rpb24gbCh0LG4saSl7aWYoIWkpcmV0dXJuIHZvaWQoRS5zdHlsZS5sZWZ0PW4rXCJweFwiKTt2YXIgcj0rbmV3IERhdGUsbz1zZXRJbnRlcnZhbChmdW5jdGlvbigpe3ZhciBzPStuZXcgRGF0ZS1yO3JldHVybiBzPmk/KEUuc3R5bGUubGVmdD1uK1wicHhcIixEJiZjKCksZS50cmFuc2l0aW9uRW5kJiZlLnRyYW5zaXRpb25FbmQuY2FsbChldmVudCxTLG1bU10pLHZvaWQgY2xlYXJJbnRlcnZhbChvKSk6dm9pZChFLnN0eWxlLmxlZnQ9KG4tdCkqKE1hdGguZmxvb3Iocy9pKjEwMCkvMTAwKSt0K1wicHhcIil9LDQpfWZ1bmN0aW9uIGMoKXtiPXNldFRpbWVvdXQoaSxEKX1mdW5jdGlvbiB1KCl7RD1lLmF1dG98fDAsY2xlYXJUaW1lb3V0KGIpfXZhciBoPXRoaXMsZD1mdW5jdGlvbigpe30sXz1mdW5jdGlvbihlKXtzZXRUaW1lb3V0KGV8fGQsMCl9LGY9e2FkZEV2ZW50TGlzdGVuZXI6ISF3aW5kb3cuYWRkRXZlbnRMaXN0ZW5lcix0b3VjaDpcIm9udG91Y2hzdGFydFwiaW4gd2luZG93fHx3aW5kb3cuRG9jdW1lbnRUb3VjaCYmZG9jdW1lbnQgaW5zdGFuY2VvZiBEb2N1bWVudFRvdWNoLHRyYW5zaXRpb25zOmZ1bmN0aW9uKGUpe3ZhciB0PVtcInRyYW5zaXRpb25Qcm9wZXJ0eVwiLFwiV2Via2l0VHJhbnNpdGlvblwiLFwiTW96VHJhbnNpdGlvblwiLFwiT1RyYW5zaXRpb25cIixcIm1zVHJhbnNpdGlvblwiXTtmb3IodmFyIG4gaW4gdClpZih2b2lkIDAhPT1lLnN0eWxlW3Rbbl1dKXJldHVybiEwO3JldHVybiExfShkb2N1bWVudC5jcmVhdGVFbGVtZW50KFwic3dpcGVcIikpfSxwPWUuZWw7aWYocCl7dmFyIG0sZyx2LFQsRT1wLmNoaWxkcmVuWzBdO2U9ZXx8e307dmFyIFM9cGFyc2VJbnQoZS5zdGFydFNsaWRlLDEwKXx8MCx3PWUuc3BlZWR8fDMwMDtlLmNvbnRpbnVvdXM9dm9pZCAwIT09ZS5jb250aW51b3VzP2UuY29udGludW91czohMDt2YXIgYix5LEQ9ZS5hdXRvfHwwLEw9e30seD17fSxNPXtoYW5kbGVFdmVudDpmdW5jdGlvbihuKXtzd2l0Y2goKFwibW91c2Vkb3duXCI9PW4udHlwZXx8XCJtb3VzZXVwXCI9PW4udHlwZXx8XCJtb3VzZW1vdmVcIj09bi50eXBlKSYmKG4udG91Y2hlcz1be3BhZ2VYOm4ucGFnZVgscGFnZVk6bi5wYWdlWX1dKSxuLnR5cGUpe2Nhc2VcIm1vdXNlZG93blwiOnRoaXMuc3RhcnQobik7YnJlYWs7Y2FzZVwidG91Y2hzdGFydFwiOnRoaXMuc3RhcnQobik7YnJlYWs7Y2FzZVwidG91Y2htb3ZlXCI6dGhpcy50b3VjaG1vdmUobik7YnJlYWs7Y2FzZVwibW91c2Vtb3ZlXCI6dGhpcy50b3VjaG1vdmUobik7YnJlYWs7Y2FzZVwidG91Y2hlbmRcIjpfKHRoaXMuZW5kKG4pKTticmVhaztjYXNlXCJtb3VzZXVwXCI6Xyh0aGlzLmVuZChuKSk7YnJlYWs7Y2FzZVwid2Via2l0VHJhbnNpdGlvbkVuZFwiOmNhc2VcIm1zVHJhbnNpdGlvbkVuZFwiOmNhc2VcIm9UcmFuc2l0aW9uRW5kXCI6Y2FzZVwib3RyYW5zaXRpb25lbmRcIjpjYXNlXCJ0cmFuc2l0aW9uZW5kXCI6Xyh0aGlzLnRyYW5zaXRpb25FbmQobikpO2JyZWFrO2Nhc2VcInJlc2l6ZVwiOl8odCl9ZS5zdG9wUHJvcGFnYXRpb24mJm4uc3RvcFByb3BhZ2F0aW9uKCl9LHN0YXJ0OmZ1bmN0aW9uKGUpe3ZhciB0PWUudG91Y2hlc1swXTtMPXt4OnQucGFnZVgseTp0LnBhZ2VZLHRpbWU6K25ldyBEYXRlfSx5PXZvaWQgMCx4PXt9LGYudG91Y2g/KEUuYWRkRXZlbnRMaXN0ZW5lcihcInRvdWNobW92ZVwiLHRoaXMsITEpLEUuYWRkRXZlbnRMaXN0ZW5lcihcInRvdWNoZW5kXCIsdGhpcywhMSkpOihFLmFkZEV2ZW50TGlzdGVuZXIoXCJtb3VzZW1vdmVcIix0aGlzLCExKSxFLmFkZEV2ZW50TGlzdGVuZXIoXCJtb3VzZXVwXCIsdGhpcywhMSksZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lcihcIm1vdXNldXBcIix0aGlzLCExKSl9LHRvdWNobW92ZTpmdW5jdGlvbih0KXtpZighKHQudG91Y2hlcy5sZW5ndGg+MXx8dC5zY2FsZSYmMSE9PXQuc2NhbGV8fGguc2xpZGVJc0Rpc2FibGVkKSl7ZS5kaXNhYmxlU2Nyb2xsJiZ0LnByZXZlbnREZWZhdWx0KCk7dmFyIG49dC50b3VjaGVzWzBdO3g9e3g6bi5wYWdlWC1MLngseTpuLnBhZ2VZLUwueX0sXCJ1bmRlZmluZWRcIj09dHlwZW9mIHkmJih5PSEhKHl8fE1hdGguYWJzKHgueCk8TWF0aC5hYnMoeC55KSkpLHl8fCh0LnByZXZlbnREZWZhdWx0KCksdSgpLGUuY29udGludW91cz8oYShyKFMtMSkseC54K2dbcihTLTEpXSwwKSxhKFMseC54K2dbU10sMCksYShyKFMrMSkseC54K2dbcihTKzEpXSwwKSk6KHgueD14LngvKCFTJiZ4Lng+MHx8Uz09bS5sZW5ndGgtMSYmeC54PDA/TWF0aC5hYnMoeC54KS92KzE6MSksYShTLTEseC54K2dbUy0xXSwwKSxhKFMseC54K2dbU10sMCksYShTKzEseC54K2dbUysxXSwwKSkpfX0sZW5kOmZ1bmN0aW9uKCl7dmFyIHQ9K25ldyBEYXRlLUwudGltZSxuPU51bWJlcih0KTwyNTAmJk1hdGguYWJzKHgueCk+MjB8fE1hdGguYWJzKHgueCk+di8yLGk9IVMmJngueD4wfHxTPT1tLmxlbmd0aC0xJiZ4Lng8MDtlLmNvbnRpbnVvdXMmJihpPSExKTt2YXIgbz14Lng8MDt5fHwobiYmIWk/KG8/KGUuY29udGludW91cz8ocyhyKFMtMSksLXYsMCkscyhyKFMrMiksdiwwKSk6cyhTLTEsLXYsMCkscyhTLGdbU10tdix3KSxzKHIoUysxKSxnW3IoUysxKV0tdix3KSxTPXIoUysxKSk6KGUuY29udGludW91cz8ocyhyKFMrMSksdiwwKSxzKHIoUy0yKSwtdiwwKSk6cyhTKzEsdiwwKSxzKFMsZ1tTXSt2LHcpLHMocihTLTEpLGdbcihTLTEpXSt2LHcpLFM9cihTLTEpKSxlLmNhbGxiYWNrJiZlLmNhbGxiYWNrKFMsbVtTXSkpOmUuY29udGludW91cz8ocyhyKFMtMSksLXYsdykscyhTLDAsdykscyhyKFMrMSksdix3KSk6KHMoUy0xLC12LHcpLHMoUywwLHcpLHMoUysxLHYsdykpKSxmLnRvdWNoPyhFLnJlbW92ZUV2ZW50TGlzdGVuZXIoXCJ0b3VjaG1vdmVcIixNLCExKSxFLnJlbW92ZUV2ZW50TGlzdGVuZXIoXCJ0b3VjaGVuZFwiLE0sITEpKTooRS5yZW1vdmVFdmVudExpc3RlbmVyKFwibW91c2Vtb3ZlXCIsTSwhMSksRS5yZW1vdmVFdmVudExpc3RlbmVyKFwibW91c2V1cFwiLE0sITEpLGRvY3VtZW50LnJlbW92ZUV2ZW50TGlzdGVuZXIoXCJtb3VzZXVwXCIsTSwhMSkpfSx0cmFuc2l0aW9uRW5kOmZ1bmN0aW9uKHQpe3BhcnNlSW50KHQudGFyZ2V0LmdldEF0dHJpYnV0ZShcImRhdGEtaW5kZXhcIiksMTApPT1TJiYoRCYmYygpLGUudHJhbnNpdGlvbkVuZCYmZS50cmFuc2l0aW9uRW5kLmNhbGwodCxTLG1bU10pKX19O3RoaXMudXBkYXRlPWZ1bmN0aW9uKCl7c2V0VGltZW91dCh0KX0sdGhpcy5zZXR1cD1mdW5jdGlvbigpe3QoKX0sdGhpcy5lbmFibGVTbGlkZT1mdW5jdGlvbihlKXtyZXR1cm4gYXJndW1lbnRzLmxlbmd0aCYmKHRoaXMuc2xpZGVJc0Rpc2FibGVkPSFlKSwhdGhpcy5zbGlkZUlzRGlzYWJsZWR9LHRoaXMuc2xpZGU9ZnVuY3Rpb24oZSx0KXt1KCksbyhlLHQpfSx0aGlzLnByZXY9dGhpcy5wcmV2aW91cz1mdW5jdGlvbigpe3UoKSxuKCl9LHRoaXMubmV4dD1mdW5jdGlvbigpe3UoKSxpKCl9LHRoaXMuc3RvcD1mdW5jdGlvbigpe3UoKX0sdGhpcy5zdGFydD1mdW5jdGlvbigpe2MoKX0sdGhpcy5jdXJyZW50SW5kZXg9ZnVuY3Rpb24oKXtyZXR1cm4gU30sdGhpcy5zbGlkZXNDb3VudD1mdW5jdGlvbigpe3JldHVybiBUfSx0aGlzLmtpbGw9ZnVuY3Rpb24oKXt1KCksRS5zdHlsZS53aWR0aD1cIlwiLEUuc3R5bGUubGVmdD1cIlwiO2Zvcih2YXIgZT1tLmxlbmd0aDtlLS07KXt2YXIgdD1tW2VdO3Quc3R5bGUud2lkdGg9XCJcIix0LnN0eWxlLmxlZnQ9XCJcIixmLnRyYW5zaXRpb25zJiZhKGUsMCwwKX1mLmFkZEV2ZW50TGlzdGVuZXI/KEUucmVtb3ZlRXZlbnRMaXN0ZW5lcihcInRvdWNoc3RhcnRcIixNLCExKSxFLnJlbW92ZUV2ZW50TGlzdGVuZXIoXCJ3ZWJraXRUcmFuc2l0aW9uRW5kXCIsTSwhMSksRS5yZW1vdmVFdmVudExpc3RlbmVyKFwibXNUcmFuc2l0aW9uRW5kXCIsTSwhMSksRS5yZW1vdmVFdmVudExpc3RlbmVyKFwib1RyYW5zaXRpb25FbmRcIixNLCExKSxFLnJlbW92ZUV2ZW50TGlzdGVuZXIoXCJvdHJhbnNpdGlvbmVuZFwiLE0sITEpLEUucmVtb3ZlRXZlbnRMaXN0ZW5lcihcInRyYW5zaXRpb25lbmRcIixNLCExKSx3aW5kb3cucmVtb3ZlRXZlbnRMaXN0ZW5lcihcInJlc2l6ZVwiLE0sITEpKTp3aW5kb3cub25yZXNpemU9bnVsbH0sdGhpcy5sb2FkPWZ1bmN0aW9uKCl7dCgpLEQmJmMoKSxmLmFkZEV2ZW50TGlzdGVuZXI/KGYudG91Y2g/RS5hZGRFdmVudExpc3RlbmVyKFwidG91Y2hzdGFydFwiLE0sITEpOkUuYWRkRXZlbnRMaXN0ZW5lcihcIm1vdXNlZG93blwiLE0sITEpLGYudHJhbnNpdGlvbnMmJihFLmFkZEV2ZW50TGlzdGVuZXIoXCJ3ZWJraXRUcmFuc2l0aW9uRW5kXCIsTSwhMSksRS5hZGRFdmVudExpc3RlbmVyKFwibXNUcmFuc2l0aW9uRW5kXCIsTSwhMSksRS5hZGRFdmVudExpc3RlbmVyKFwib1RyYW5zaXRpb25FbmRcIixNLCExKSxFLmFkZEV2ZW50TGlzdGVuZXIoXCJvdHJhbnNpdGlvbmVuZFwiLE0sITEpLEUuYWRkRXZlbnRMaXN0ZW5lcihcInRyYW5zaXRpb25lbmRcIixNLCExKSksd2luZG93LmFkZEV2ZW50TGlzdGVuZXIoXCJyZXNpemVcIixNLCExKSk6d2luZG93Lm9ucmVzaXplPWZ1bmN0aW9uKCl7dCgpfX19fX0pfShpb25pYyksZnVuY3Rpb24oZSl7XCJ1c2Ugc3RyaWN0XCI7ZS52aWV3cy5Ub2dnbGU9ZS52aWV3cy5WaWV3LmluaGVyaXQoe2luaXRpYWxpemU6ZnVuY3Rpb24odCl7dmFyIG49dGhpczt0aGlzLmVsPXQuZWwsdGhpcy5jaGVja2JveD10LmNoZWNrYm94LHRoaXMudHJhY2s9dC50cmFjayx0aGlzLmhhbmRsZT10LmhhbmRsZSx0aGlzLm9wZW5QZXJjZW50PS0xLHRoaXMub25DaGFuZ2U9dC5vbkNoYW5nZXx8ZnVuY3Rpb24oKXt9LHRoaXMudHJpZ2dlclRocmVzaG9sZD10LnRyaWdnZXJUaHJlc2hvbGR8fDIwLHRoaXMuZHJhZ1N0YXJ0SGFuZGxlcj1mdW5jdGlvbihlKXtuLmRyYWdTdGFydChlKX0sdGhpcy5kcmFnSGFuZGxlcj1mdW5jdGlvbihlKXtuLmRyYWcoZSl9LHRoaXMuaG9sZEhhbmRsZXI9ZnVuY3Rpb24oZSl7bi5ob2xkKGUpfSx0aGlzLnJlbGVhc2VIYW5kbGVyPWZ1bmN0aW9uKGUpe24ucmVsZWFzZShlKX0sdGhpcy5kcmFnU3RhcnRHZXN0dXJlPWUub25HZXN0dXJlKFwiZHJhZ3N0YXJ0XCIsdGhpcy5kcmFnU3RhcnRIYW5kbGVyLHRoaXMuZWwpLHRoaXMuZHJhZ0dlc3R1cmU9ZS5vbkdlc3R1cmUoXCJkcmFnXCIsdGhpcy5kcmFnSGFuZGxlcix0aGlzLmVsKSx0aGlzLmRyYWdIb2xkR2VzdHVyZT1lLm9uR2VzdHVyZShcImhvbGRcIix0aGlzLmhvbGRIYW5kbGVyLHRoaXMuZWwpLHRoaXMuZHJhZ1JlbGVhc2VHZXN0dXJlPWUub25HZXN0dXJlKFwicmVsZWFzZVwiLHRoaXMucmVsZWFzZUhhbmRsZXIsdGhpcy5lbCl9LGRlc3Ryb3k6ZnVuY3Rpb24oKXtlLm9mZkdlc3R1cmUodGhpcy5kcmFnU3RhcnRHZXN0dXJlLFwiZHJhZ3N0YXJ0XCIsdGhpcy5kcmFnU3RhcnRHZXN0dXJlKSxlLm9mZkdlc3R1cmUodGhpcy5kcmFnR2VzdHVyZSxcImRyYWdcIix0aGlzLmRyYWdHZXN0dXJlKSxlLm9mZkdlc3R1cmUodGhpcy5kcmFnSG9sZEdlc3R1cmUsXCJob2xkXCIsdGhpcy5ob2xkSGFuZGxlciksZS5vZmZHZXN0dXJlKHRoaXMuZHJhZ1JlbGVhc2VHZXN0dXJlLFwicmVsZWFzZVwiLHRoaXMucmVsZWFzZUhhbmRsZXIpfSx0YXA6ZnVuY3Rpb24oKXtcImRpc2FibGVkXCIhPT10aGlzLmVsLmdldEF0dHJpYnV0ZShcImRpc2FibGVkXCIpJiZ0aGlzLnZhbCghdGhpcy5jaGVja2JveC5jaGVja2VkKX0sZHJhZ1N0YXJ0OmZ1bmN0aW9uKGUpe3RoaXMuY2hlY2tib3guZGlzYWJsZWR8fCh0aGlzLl9kcmFnSW5mbz17d2lkdGg6dGhpcy5lbC5vZmZzZXRXaWR0aCxsZWZ0OnRoaXMuZWwub2Zmc2V0TGVmdCxyaWdodDp0aGlzLmVsLm9mZnNldExlZnQrdGhpcy5lbC5vZmZzZXRXaWR0aCx0cmlnZ2VyWDp0aGlzLmVsLm9mZnNldFdpZHRoLzIsaW5pdGlhbFN0YXRlOnRoaXMuY2hlY2tib3guY2hlY2tlZH0sZS5nZXN0dXJlLnNyY0V2ZW50LnByZXZlbnREZWZhdWx0KCksdGhpcy5ob2xkKGUpKX0sZHJhZzpmdW5jdGlvbih0KXt2YXIgbj10aGlzO3RoaXMuX2RyYWdJbmZvJiYodC5nZXN0dXJlLnNyY0V2ZW50LnByZXZlbnREZWZhdWx0KCksZS5yZXF1ZXN0QW5pbWF0aW9uRnJhbWUoZnVuY3Rpb24oKXtpZihuLl9kcmFnSW5mbyl7dmFyIGU9KG4udHJhY2sub2Zmc2V0TGVmdCtuLmhhbmRsZS5vZmZzZXRXaWR0aC8yLG4udHJhY2sub2Zmc2V0TGVmdCtuLnRyYWNrLm9mZnNldFdpZHRoLW4uaGFuZGxlLm9mZnNldFdpZHRoLzIsdC5nZXN0dXJlLmRlbHRhWCx0Lmdlc3R1cmUudG91Y2hlc1swXS5wYWdlWC1uLl9kcmFnSW5mby5sZWZ0KSxpPW4uX2RyYWdJbmZvLndpZHRoLW4udHJpZ2dlclRocmVzaG9sZDtuLl9kcmFnSW5mby5pbml0aWFsU3RhdGU/ZTxuLnRyaWdnZXJUaHJlc2hvbGQ/bi5zZXRPcGVuUGVyY2VudCgwKTplPm4uX2RyYWdJbmZvLnRyaWdnZXJYJiZuLnNldE9wZW5QZXJjZW50KDEwMCk6ZTxuLl9kcmFnSW5mby50cmlnZ2VyWD9uLnNldE9wZW5QZXJjZW50KDApOmU+aSYmbi5zZXRPcGVuUGVyY2VudCgxMDApfX0pKX0sZW5kRHJhZzpmdW5jdGlvbigpe3RoaXMuX2RyYWdJbmZvPW51bGx9LGhvbGQ6ZnVuY3Rpb24oKXt0aGlzLmVsLmNsYXNzTGlzdC5hZGQoXCJkcmFnZ2luZ1wiKX0scmVsZWFzZTpmdW5jdGlvbihlKXt0aGlzLmVsLmNsYXNzTGlzdC5yZW1vdmUoXCJkcmFnZ2luZ1wiKSx0aGlzLmVuZERyYWcoZSl9LHNldE9wZW5QZXJjZW50OmZ1bmN0aW9uKHQpe2lmKHRoaXMub3BlblBlcmNlbnQ8MHx8dDx0aGlzLm9wZW5QZXJjZW50LTN8fHQ+dGhpcy5vcGVuUGVyY2VudCszKWlmKHRoaXMub3BlblBlcmNlbnQ9dCwwPT09dCl0aGlzLnZhbCghMSk7ZWxzZSBpZigxMDA9PT10KXRoaXMudmFsKCEwKTtlbHNle3ZhciBuPU1hdGgucm91bmQodC8xMDAqdGhpcy50cmFjay5vZmZzZXRXaWR0aC10aGlzLmhhbmRsZS5vZmZzZXRXaWR0aCk7bj0xPm4/MDpuLHRoaXMuaGFuZGxlLnN0eWxlW2UuQ1NTLlRSQU5TRk9STV09XCJ0cmFuc2xhdGUzZChcIituK1wicHgsMCwwKVwifX0sdmFsOmZ1bmN0aW9uKHQpe3JldHVybih0PT09ITB8fHQ9PT0hMSkmJihcIlwiIT09dGhpcy5oYW5kbGUuc3R5bGVbZS5DU1MuVFJBTlNGT1JNXSYmKHRoaXMuaGFuZGxlLnN0eWxlW2UuQ1NTLlRSQU5TRk9STV09XCJcIiksdGhpcy5jaGVja2JveC5jaGVja2VkPXQsdGhpcy5vcGVuUGVyY2VudD10PzEwMDowLHRoaXMub25DaGFuZ2UmJnRoaXMub25DaGFuZ2UoKSksdGhpcy5jaGVja2JveC5jaGVja2VkfX0pfShpb25pYyl9KCk7IiwiLyohIG5nU3RvcmFnZSAwLjMuMCB8IENvcHlyaWdodCAoYykgMjAxMyBHaWFzIEtheSBMZWUgfCBNSVQgTGljZW5zZSAqL1widXNlIHN0cmljdFwiOyFmdW5jdGlvbigpe2Z1bmN0aW9uIGEoYSl7cmV0dXJuW1wiJHJvb3RTY29wZVwiLFwiJHdpbmRvd1wiLGZ1bmN0aW9uKGIsYyl7Zm9yKHZhciBkLGUsZixnPWNbYV18fChjb25zb2xlLndhcm4oXCJUaGlzIGJyb3dzZXIgZG9lcyBub3Qgc3VwcG9ydCBXZWIgU3RvcmFnZSFcIikse30pLGg9eyRkZWZhdWx0OmZ1bmN0aW9uKGEpe2Zvcih2YXIgYiBpbiBhKWFuZ3VsYXIuaXNEZWZpbmVkKGhbYl0pfHwoaFtiXT1hW2JdKTtyZXR1cm4gaH0sJHJlc2V0OmZ1bmN0aW9uKGEpe2Zvcih2YXIgYiBpbiBoKVwiJFwiPT09YlswXXx8ZGVsZXRlIGhbYl07cmV0dXJuIGguJGRlZmF1bHQoYSl9fSxpPTA7aTxnLmxlbmd0aDtpKyspKGY9Zy5rZXkoaSkpJiZcIm5nU3RvcmFnZS1cIj09PWYuc2xpY2UoMCwxMCkmJihoW2Yuc2xpY2UoMTApXT1hbmd1bGFyLmZyb21Kc29uKGcuZ2V0SXRlbShmKSkpO3JldHVybiBkPWFuZ3VsYXIuY29weShoKSxiLiR3YXRjaChmdW5jdGlvbigpe2V8fChlPXNldFRpbWVvdXQoZnVuY3Rpb24oKXtpZihlPW51bGwsIWFuZ3VsYXIuZXF1YWxzKGgsZCkpe2FuZ3VsYXIuZm9yRWFjaChoLGZ1bmN0aW9uKGEsYil7YW5ndWxhci5pc0RlZmluZWQoYSkmJlwiJFwiIT09YlswXSYmZy5zZXRJdGVtKFwibmdTdG9yYWdlLVwiK2IsYW5ndWxhci50b0pzb24oYSkpLGRlbGV0ZSBkW2JdfSk7Zm9yKHZhciBhIGluIGQpZy5yZW1vdmVJdGVtKFwibmdTdG9yYWdlLVwiK2EpO2Q9YW5ndWxhci5jb3B5KGgpfX0sMTAwKSl9KSxcImxvY2FsU3RvcmFnZVwiPT09YSYmYy5hZGRFdmVudExpc3RlbmVyJiZjLmFkZEV2ZW50TGlzdGVuZXIoXCJzdG9yYWdlXCIsZnVuY3Rpb24oYSl7XCJuZ1N0b3JhZ2UtXCI9PT1hLmtleS5zbGljZSgwLDEwKSYmKGEubmV3VmFsdWU/aFthLmtleS5zbGljZSgxMCldPWFuZ3VsYXIuZnJvbUpzb24oYS5uZXdWYWx1ZSk6ZGVsZXRlIGhbYS5rZXkuc2xpY2UoMTApXSxkPWFuZ3VsYXIuY29weShoKSxiLiRhcHBseSgpKX0pLGh9XX1hbmd1bGFyLm1vZHVsZShcIm5nU3RvcmFnZVwiLFtdKS5mYWN0b3J5KFwiJGxvY2FsU3RvcmFnZVwiLGEoXCJsb2NhbFN0b3JhZ2VcIikpLmZhY3RvcnkoXCIkc2Vzc2lvblN0b3JhZ2VcIixhKFwic2Vzc2lvblN0b3JhZ2VcIikpfSgpOyIsIid1c2Ugc3RyaWN0JztcbnZhciBjb250cm9sbGVybmFtZSA9ICdkYXNoYm9hcmQnO1xuXG52YXIgZGIgPSByZXF1aXJlKCdhcHAvZGIuanMnKSgndXNlcnMnKTtcblxubW9kdWxlLmV4cG9ydHMgPSBmdW5jdGlvbihhcHApIHtcbiAgLypqc2hpbnQgdmFsaWR0aGlzOiB0cnVlICovXG5cbiAgdmFyIGRlcHMgPSBbJyRzY29wZScsICckbG9jYWxTdG9yYWdlJywgJ21haW4ucGxheWVycy5nYW1lU2VydmljZXMnLCAnJGlvbmljTW9kYWwnXTtcblxuICBmdW5jdGlvbiBjb250cm9sbGVyKCRzY29wZSwgJGxvY2FsU3RvcmFnZSwgZ2FtZVNlcnZpY2VzLCAkaW9uaWNNb2RhbCkge1xuICAgIHZhciB2bSA9IHRoaXM7XG4gICAgLyogLi4gKi9cbiAgICB2bS5lcnJvcnMgPSB7IGdhbWVuYW1lOiB7IH0gfTtcbiAgICAvKiBsb2dnZWQgaW4gdXNlciBkYXRhICovXG4gICAgdm0udXNlckRhdGEgPSB7fTtcbiAgICAvKiBuZXcgZ2FtZSByZXF1ZXN0IGRhdGEgKi9cbiAgICB2bS5uZXdHYW1lID0ge307XG4gICAgLyogKi9cbiAgICB2bS5tb2RhbCA9IHt9O1xuXG4gICAgZGIuZGF0YUZ5KCRsb2NhbFN0b3JhZ2UudXNlckRhdGEsIHZtLnVzZXJEYXRhKTtcblxuICAgIHZhciBhY3RpdmF0ZSA9IGZ1bmN0aW9uKCkge1xuXG4gICAgICB2bS5uZXdHYW1lID0gZnVuY3Rpb24oKSB7XG4gICAgICAgIGdhbWVTZXJ2aWNlcy5uZXdHYW1lKHZtLm5ld0dhbWUpLnRoZW4oXG4gICAgICAgICAgZnVuY3Rpb24ocmVzKSB7XG4gICAgICAgICAgICB2bS5lcnJvcnMuZ2FtZW5hbWUgPSB7IH07XG4gICAgICAgICAgfSwgZnVuY3Rpb24oZXJyKSB7XG4gICAgICAgICAgICB2bS5lcnJvcnMuZ2FtZW5hbWUudGFrZW4gPSB0cnVlO1xuICAgICAgICAgIH1cbiAgICAgICAgKTtcbiAgICAgIH07XG5cbiAgICB9O1xuXG4gICAgYWN0aXZhdGUoKTtcbiAgfVxuXG4gIGNvbnRyb2xsZXIuJGluamVjdCA9IGRlcHM7XG4gIGFwcC5jb250cm9sbGVyKGFwcC5uYW1lICsgJy4nICsgY29udHJvbGxlcm5hbWUsIGNvbnRyb2xsZXIpO1xufTsiLCIndXNlIHN0cmljdCc7XG52YXIgY29udHJvbGxlcm5hbWUgPSAnZmluZEFjdGlvbic7XG5cbnZhciBkYj17IHVzZXJzOiByZXF1aXJlKCdhcHAvZGInKSgndXNlcnMnKSB9O1xuXG4vKiBIYW5kbGUgbG9naW4gcmVkaXJlY3RzIC0gbmV3IHVzZXIgc2NyZWVucywgdXBkYXRlcyBldGMuLiAqL1xuXG5tb2R1bGUuZXhwb3J0cyA9IGZ1bmN0aW9uKGFwcCkge1xuICAgIC8qanNoaW50IHZhbGlkdGhpczogdHJ1ZSAqL1xuXG4gICAgdmFyIGRlcHMgPSBbJyRzdGF0ZScsICdtYWluLnBsYXllcnMudXNlclNlcnZpY2VzJywgJyRsb2NhbFN0b3JhZ2UnXTtcblxuICAgIGZ1bmN0aW9uIGNvbnRyb2xsZXIoJHN0YXRlLCB1c2VyU2VydmljZXMsICRsb2NhbFN0b3JhZ2UpIHtcbiAgICAgICAgdmFyIHZtID0gdGhpcztcbiAgICAgICAgdmFyIHVzZXIgPSAkbG9jYWxTdG9yYWdlLnVzZXJEYXRhO1xuICAgICAgICB2YXIgYWN0aXZhdGUgPSBmdW5jdGlvbigpIHtcbiAgICAgICAgICAgIGlmICghIXVzZXIuZmlyc3RTY3JlZW4pIHtcbiAgICAgICAgICAgICAgICB1c2VyLmZpcnN0U2NyZWVuID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICBkYi5wdXQodXNlci51c2VybmFtZSwgdXNlciwgZnVuY3Rpb24oZXJyLHJlcykge1xuICAgICAgICAgICAgICAgICAgICAkc3RhdGUuZ28oJ2Rhc2hib2FyZCcpO1xuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgXG4gICAgICAgICAgICAkc3RhdGUuZ28oJ2Rhc2hib2FyZCcpO1xuICAgICAgICAgICAgXG4gICAgICAgIH07XG4gICAgICAgIGFjdGl2YXRlKCk7XG4gICAgfVxuXG4gICAgY29udHJvbGxlci4kaW5qZWN0ID0gZGVwcztcbiAgICBhcHAuY29udHJvbGxlcihhcHAubmFtZSArICcuJyArIGNvbnRyb2xsZXJuYW1lLCBjb250cm9sbGVyKTtcbn07IiwiJ3VzZSBzdHJpY3QnO1xudmFyIGNvbnRyb2xsZXJuYW1lID0gJ2dhbWVzJztcblxubW9kdWxlLmV4cG9ydHMgPSBmdW5jdGlvbihhcHApIHtcbiAgICAvKmpzaGludCB2YWxpZHRoaXM6IHRydWUgKi9cblxuICAgIHZhciBkZXBzID0gW107XG5cbiAgICBmdW5jdGlvbiBjb250cm9sbGVyKCkge1xuICAgICAgICB2YXIgdm0gPSB0aGlzO1xuICAgICAgICB2bS5tZXNzYWdlID0gJ0hlbGxvIFdvcmxkJztcbiAgICAgICAgXG4gICAgICAgIHZhciBhY3RpdmF0ZSA9IGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgdm0uZ2FtZXM9W3tuYW1lOidoZWxsbyd9LHtuYW1lOid3b3JsZCd9XTtcbiAgICAgICAgfTtcbiAgICAgICAgXG4gICAgICAgIGFjdGl2YXRlKCk7XG4gICAgfVxuXG4gICAgY29udHJvbGxlci4kaW5qZWN0ID0gZGVwcztcbiAgICBhcHAuY29udHJvbGxlcihhcHAubmFtZSArICcuJyArIGNvbnRyb2xsZXJuYW1lLCBjb250cm9sbGVyKTtcbn07IiwiJ3VzZSBzdHJpY3QnO1xuXG5tb2R1bGUuZXhwb3J0cyA9IGZ1bmN0aW9uKGFwcCkge1xuICAgIC8vIGluamVjdDpzdGFydFxuICAgIHJlcXVpcmUoJy4vZGFzaGJvYXJkJykoYXBwKTtcbiAgICByZXF1aXJlKCcuL2ZpbmRBY3Rpb24nKShhcHApO1xuICAgIHJlcXVpcmUoJy4vZ2FtZXMnKShhcHApO1xuICAgIHJlcXVpcmUoJy4vbG9naW4nKShhcHApO1xuICAgIHJlcXVpcmUoJy4vc2V0dGluZ3MnKShhcHApO1xuICAgIC8vIGluamVjdDplbmRcbn07IiwiJ3VzZSBzdHJpY3QnO1xudmFyIGNvbnRyb2xsZXJuYW1lID0gJ2xvZ2luJztcblxubW9kdWxlLmV4cG9ydHMgPSBmdW5jdGlvbihhcHApIHtcbiAgICAvKmpzaGludCB2YWxpZHRoaXM6IHRydWUgKi9cblxuICAgIHZhciBkZXBzID0gWyckc3RhdGUnLCckaW9uaWNBY3Rpb25TaGVldCcsICdtYWluLnBsYXllcnMudXNlclNlcnZpY2VzJ107XG5cbiAgICBmdW5jdGlvbiBjb250cm9sbGVyKCRzdGF0ZSwgJGlvbmljQWN0aW9uU2hlZXQsIHVzZXJTZXJ2aWNlcykge1xuICAgICAgICB2YXIgdm0gPSB0aGlzO1xuICAgICAgICBcbiAgICAgICAgdm0uZm9ybSA9IHsgc2lnblVwOiB7IH0sIHNpZ25JbjogeyB9IH07Ly9yZWZsZWN0aXZlXG4gICAgICAgIHZtLmVycm9ycyA9IHsgdXNlcm5hbWU6IHt9LCBwYXNzd29yZDoge30gfTsvLy4uXG4gICAgICAgIFxuICAgICAgICB2bS5lcnJvcnMuY2xlYXIgPSBmdW5jdGlvbigpIHtcbiAgICAgICAgICAgIHZtLmVycm9ycy51c2VybmFtZSA9IHt9O1xuICAgICAgICB9O1xuXG4gICAgICAgIHZtLnNpZ25VcCA9IGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgdXNlclNlcnZpY2VzLnNpZ25VcCh2bS5mb3JtLnNpZ25VcCkudGhlbihmdW5jdGlvbihnb3QpIHtcbiAgICAgICAgICAgICAgICB2bS5lcnJvcnMudXNlcm5hbWUgPSB7IH07XG4gICAgICAgICAgICAgICAgJHN0YXRlLmdvKCdmaW5kQWN0aW9uJyk7XG4gICAgICAgICAgICB9LCBmdW5jdGlvbigpIHtcbiAgICAgICAgICAgICAgICB2bS5lcnJvcnMudXNlcm5hbWUuZHVwbGljYXRlPXRydWU7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfTtcblxuICAgICAgICB2bS5zaWduSW4gPSBmdW5jdGlvbigpIHtcbiAgICAgICAgICAgIHVzZXJTZXJ2aWNlcy5zaWduSW4odm0uZm9ybS5zaWduSW4pLnRoZW4oZnVuY3Rpb24oZ290KSB7XG4gICAgICAgICAgICAgICAgdm0uZXJyb3JzLnBhc3N3b3JkID0ge307XG4gICAgICAgICAgICAgICAgJHN0YXRlLmdvKCdmaW5kQWN0aW9uJyk7XG4gICAgICAgICAgICB9LCBmdW5jdGlvbigpIHtcbiAgICAgICAgICAgICAgICB2bS5lcnJvcnMucGFzc3dvcmQuaW52YWxpZD10cnVlO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgIH07XG5cbiAgICAgICAgdmFyIGFjdGl2YXRlID0gZnVuY3Rpb24oKSB7XG5cbiAgICAgICAgfTtcblxuICAgICAgICBhY3RpdmF0ZSgpO1xuICAgIH1cblxuICAgIGNvbnRyb2xsZXIuJGluamVjdCA9IGRlcHM7XG4gICAgYXBwLmNvbnRyb2xsZXIoYXBwLm5hbWUgKyAnLicgKyBjb250cm9sbGVybmFtZSwgY29udHJvbGxlcik7XG59O1xuIiwiJ3VzZSBzdHJpY3QnO1xudmFyIGNvbnRyb2xsZXJuYW1lID0gJ3NldHRpbmdzJztcblxubW9kdWxlLmV4cG9ydHMgPSBmdW5jdGlvbihhcHApIHtcbiAgICAvKmpzaGludCB2YWxpZHRoaXM6IHRydWUgKi9cblxuICAgIHZhciBkZXBzID0gW107XG5cbiAgICBmdW5jdGlvbiBjb250cm9sbGVyKCkge1xuICAgICAgICB2YXIgdm0gPSB0aGlzO1xuICAgICAgICB2bS5tZXNzYWdlID0gJ0hlbGxvIFdvcmxkJztcbiAgICAgICAgdmFyIGFjdGl2YXRlID0gZnVuY3Rpb24oKSB7XG5cbiAgICAgICAgfTtcbiAgICAgICAgYWN0aXZhdGUoKTtcbiAgICB9XG5cbiAgICBjb250cm9sbGVyLiRpbmplY3QgPSBkZXBzO1xuICAgIGFwcC5jb250cm9sbGVyKGFwcC5uYW1lICsgJy4nICsgY29udHJvbGxlcm5hbWUsIGNvbnRyb2xsZXIpO1xufTsiLCIndXNlIHN0cmljdCc7XG5yZXF1aXJlKCdhbmd1bGFyLXVpLXJvdXRlcicpO1xucmVxdWlyZSgnYW5ndWxhci1pb25pYycpO1xucmVxdWlyZSgnZmFtb3VzLWFuZ3VsYXInKTtcblxudmFyIG1vZHVsZW5hbWUgPSAncGxheWVycyc7XG5cbm1vZHVsZS5leHBvcnRzID0gZnVuY3Rpb24obmFtZXNwYWNlKSB7XG5cbiAgICB2YXIgZnVsbG5hbWUgPSBuYW1lc3BhY2UgKyAnLicgKyBtb2R1bGVuYW1lO1xuXG4gICAgdmFyIGFuZ3VsYXIgPSByZXF1aXJlKCdhbmd1bGFyJyk7XG4gICAgLyouLiovXG4gICAgcmVxdWlyZSgnbmdTdG9yYWdlJyk7XG5cbiAgICB2YXIgYXBwID0gYW5ndWxhci5tb2R1bGUoZnVsbG5hbWUsIFsndWkucm91dGVyJywgJ2lvbmljJywgJ2ZhbW91cy5hbmd1bGFyJywgJ25nU3RvcmFnZSddKTtcblxuICAgIC8vIGluamVjdDpmb2xkZXJzIHN0YXJ0XG4gICAgcmVxdWlyZSgnLi9jb250cm9sbGVycycpKGFwcCk7XG4gICAgcmVxdWlyZSgnLi9zZXJ2aWNlcycpKGFwcCk7XG5cbiAgICAvLyBpbmplY3Q6Zm9sZGVycyBlbmRcblxuICAgIGFwcC5jb25maWcoWyckc3RhdGVQcm92aWRlcicsICckdXJsUm91dGVyUHJvdmlkZXInLCBmdW5jdGlvbigkc3RhdGVQcm92aWRlciwgJHVybFJvdXRlclByb3ZpZGVyKSB7XG4gICAgICAgICR1cmxSb3V0ZXJQcm92aWRlci5vdGhlcndpc2UoJy8nKTtcbiAgICAgICAgXG4gICAgICAgICRzdGF0ZVByb3ZpZGVyXG4gICAgICAgIC5zdGF0ZSgnbG9naW4nLCB7XG4gICAgICAgICAgICB1cmwgOiAnL2xvZ2luJyxcbiAgICAgICAgICAgIHRlbXBsYXRlOiByZXF1aXJlKCcuL3ZpZXdzL2xvZ2luLmh0bWwnKVxuICAgICAgIH0pXG4gICAgICAgLnN0YXRlKCdmaW5kQWN0aW9uJywge1xuICAgICAgICAgICB1cmw6ICcvZmluZEFjdGlvbicsXG4gICAgICAgICAgIGNvbnRyb2xsZXI6ICdtYWluLnBsYXllcnMuZmluZEFjdGlvbidcbiAgICAgICB9KVxuICAgICAgIC5zdGF0ZSgnZGFzaGJvYXJkJywge1xuICAgICAgICAgICB1cmw6ICcvZGFzaGJvYXJkJyxcbiAgICAgICAgICAgdGVtcGxhdGU6IHJlcXVpcmUoJy4vdmlld3MvZGFzaGJvYXJkLmh0bWwnKSxcbiAgICAgICAgICAgY29udHJvbGxlcjogJ21haW4ucGxheWVycy5kYXNoYm9hcmQnXG4gICAgICAgfSk7XG5cbiAgICB9XSk7XG4gICAgXG4gICAgXG4gICAgcmV0dXJuIGFwcDtcbn07IiwiJ3VzZSBzdHJpY3QnO1xudmFyIHNlcnZpY2VuYW1lID0gJ2dhbWVTZXJ2aWNlcyc7XG5cbnZhciBkYiA9IHtcbiAgICBnYW1lczogcmVxdWlyZSgnYXBwL2RiLmpzJykoJ2dhbWVzJyksXG4gICAgdXNlcnM6IHJlcXVpcmUoJ2FwcC9kYi5qcycpKCd1c2VycycpXG59O1xuXG5tb2R1bGUuZXhwb3J0cyA9IGZ1bmN0aW9uKGFwcCkge1xuXG4gICAgdmFyIGRlcGVuZGVuY2llcyA9IFtdO1xuXG4gICAgZnVuY3Rpb24gc2VydmljZSgpIHtcbiAgICAgICAgdmFyIGlzSW5pdGlhbGl6ZWQgPSBmYWxzZTtcbiAgICAgICAgdmFyIGluaXQgPSBmdW5jdGlvbigpIHtcbiAgICAgICAgICAgIGlzSW5pdGlhbGl6ZWQgPSB0cnVlO1xuICAgICAgICB9O1xuICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgLy8gaW5pdGlhbGl6YXRpb25cbiAgICAgICAgICAgIGluaXQ6IGluaXQsXG5cbiAgICAgICAgICAgICRnZXQ6IFsnJHEnLFxuICAgICAgICAgICAgICAgIGZ1bmN0aW9uKCRxKSB7XG4gICAgICAgICAgICAgICAgICAgIHZhciBuZXdHYW1lID0gZnVuY3Rpb24ob3B0cykge1xuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGQgPSAkcS5kZWZlcigpO1xuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGRhdGEgPSBkYi5nYW1lcy5kYXRhQ3J1bWIob3B0cyk7XG4gICAgICAgICAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgICAgICAgICAgIGRiLmdhbWVzLmdldChkYXRhLmdhbWVuYW1lLGZ1bmN0aW9uKGVycixyZXMpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAocmVzKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBkLnJlamVjdCh7cmVhc29uOidTb3JyeSwgdGhhdCBuYW1lIGlzIHRha2VuIGZvciBub3cuJ30pO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRiLmdhbWVzLnB1dChkYXRhLGRhdGEuZ2FtZW5hbWUsIGZ1bmN0aW9uKGVycixyZXMpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZC5yZXNvbHZlKHsgZ290OnJlcyB9KTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KTtcblxuICAgICAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBkLnByb21pc2U7XG4gICAgICAgICAgICAgICAgICAgIH07XG5cbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlzSW5pdGlhbGl6ZWQ6IGlzSW5pdGlhbGl6ZWQsXG4gICAgICAgICAgICAgICAgICAgICAgICBuZXdHYW1lOiBuZXdHYW1lXG4gICAgICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgXVxuICAgICAgICB9O1xuXG4gICAgfVxuICAgIHNlcnZpY2UuJGluamVjdCA9IGRlcGVuZGVuY2llcztcblxuICAgIGFwcC5wcm92aWRlcihhcHAubmFtZSArICcuJyArIHNlcnZpY2VuYW1lLCBzZXJ2aWNlKTtcbn07IiwiJ3VzZSBzdHJpY3QnO1xuXG5tb2R1bGUuZXhwb3J0cyA9IGZ1bmN0aW9uKGFwcCkge1xuICAgIC8vIGluamVjdDpzdGFydFxuICAgIHJlcXVpcmUoJy4vZ2FtZVNlcnZpY2VzJykoYXBwKTtcbiAgICByZXF1aXJlKCcuL3VzZXJTZXJ2aWNlcycpKGFwcCk7XG4gICAgLy8gaW5qZWN0OmVuZFxufTsiLCIndXNlIHN0cmljdCc7XG52YXIgc2VydmljZW5hbWUgPSAndXNlclNlcnZpY2VzJztcblxudmFyIGRiID0gcmVxdWlyZSgnYXBwL2RiLmpzJykoJ3VzZXJzJyk7XG5cblxubW9kdWxlLmV4cG9ydHMgPSBmdW5jdGlvbihhcHApIHtcblxuICAgIHZhciBkZXBlbmRlbmNpZXMgPSBbIF07XG5cbiAgICBmdW5jdGlvbiBzZXJ2aWNlKCkge1xuICAgICAgICBcbiAgICAgICAgdmFyIGlzSW5pdGlhbGl6ZWQgPSBmYWxzZTtcbiAgICAgICAgXG4gICAgICAgIHZhciBpbml0ID0gZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICBpc0luaXRpYWxpemVkID0gdHJ1ZTtcbiAgICAgICAgfTtcbiAgICAgICAgXG4gICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICAvLyBpbml0aWFsaXphdGlvblxuICAgICAgICAgICAgaW5pdDogaW5pdCxcblxuICAgICAgICAgICAgJGdldDogWyckcScsICckbG9jYWxTdG9yYWdlJywgXG4gICAgICAgICAgICAgICAgZnVuY3Rpb24oJHEsICRsb2NhbFN0b3JhZ2UpIHtcbiAgICAgICAgICAgICAgICAgICAgXG4gICAgICAgICAgICAgICAgICAgIHZhciB1c2VyRGF0YSA9IGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuICRsb2NhbFN0b3JhZ2UudXNlckRhdGE7XG4gICAgICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgICAgICB2YXIgc2lnblVwID0gZnVuY3Rpb24oY3RybERhdGEpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBkYXRhID0gZGIuZGF0YUNydW1ibGUoY3RybERhdGEpO1xuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGQgPSAkcS5kZWZlcigpO1xuXG4gICAgICAgICAgICAgICAgICAgICAgICBkYi5nZXQoZGF0YS51c2VybmFtZSxmdW5jdGlvbihlcnIsIHJlcykge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vdXNlciBzaG91bGQgbm90IGV4aXN0LlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChyZXMpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGQucmVqZWN0KHtyZWFzb246J1VzZXJuYW1lIGV4aXN0cy4nfSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLy9zYXZlIGl0XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZGIucHV0KGRhdGEsIGRhdGEudXNlcm5hbWUsIGZ1bmN0aW9uKGVyciwgcmVzKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChlcnIpIHRocm93KGVycik7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAkbG9jYWxTdG9yYWdlLnVzZXJEYXRhID0gZGF0YTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZC5yZXNvbHZlKHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGdvdDogcmVzXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pOyAgIFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgICAgICAgICAgfSk7XG5cblxuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGQucHJvbWlzZTtcbiAgICAgICAgICAgICAgICAgICAgfTtcblxuICAgICAgICAgICAgICAgICAgICB2YXIgc2lnbkluID0gZnVuY3Rpb24oY3RybERhdGEpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBkYXRhID0gZGIuZGF0YUNydW1ibGUoY3RybERhdGEpO1xuICAgICAgICAgICAgICAgICAgICAgICAgXG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgZCA9ICRxLmRlZmVyKCk7XG4gICAgICAgICAgICAgICAgICAgICAgICAvL25vIHBhc3MsIG5vIGxvZ2luXG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoIWRhdGEucGFzc3BocmFzZSkgZC5yZWplY3QoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgICAgICAgICAgZGIuZ2V0KGRhdGEudXNlcm5hbWUsIGZ1bmN0aW9uKGVyciwgcmVzKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGVycikgdGhyb3coZXJyKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAocmVzLnBhc3NwaHJhc2UgPT0gZGF0YS5wYXNzcGhyYXNlIHx8IGVycikge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAkbG9jYWxTdG9yYWdlLnVzZXJEYXRhID0gcmVzO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gZC5yZXNvbHZlKHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGdvdDogcmVzXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0gXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGQucmVqZWN0KCk7XG4gICAgICAgICAgICAgICAgICAgICAgICB9KTtcblxuXG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gZC5wcm9taXNlO1xuICAgICAgICAgICAgICAgICAgICB9O1xuXG5cbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlzSW5pdGlhbGl6ZWQ6IGlzSW5pdGlhbGl6ZWQsXG4gICAgICAgICAgICAgICAgICAgICAgICBzaWduVXA6IHNpZ25VcCxcbiAgICAgICAgICAgICAgICAgICAgICAgIHNpZ25Jbjogc2lnbkluLFxuICAgICAgICAgICAgICAgICAgICAgICAgdXNlcjogdXNlckRhdGFcbiAgICAgICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICBdXG4gICAgICAgIH07XG5cbiAgICB9XG4gICAgc2VydmljZS4kaW5qZWN0ID0gZGVwZW5kZW5jaWVzO1xuXG4gICAgYXBwLnByb3ZpZGVyKGFwcC5uYW1lICsgJy4nICsgc2VydmljZW5hbWUsIHNlcnZpY2UpO1xuXG59OyIsIm1vZHVsZS5leHBvcnRzID0gJzxkaXYgY2xhc3M9XCJSZWRXYXJcIj5cXG4nICtcbiAgICAnXFxuJyArXG4gICAgJyAgPGlvbi10YWJzIGNsYXNzPVwidGFicy1wb3NpdGl2ZSB0YWJzLWljb24tbGVmdFwiPlxcbicgK1xuICAgICdcXG4nICtcbiAgICAnICAgIDxpb24tdGFiIHRpdGxlPVwiSG9tZVwiIGljb24tb249XCJpb24taW9zNy1ob21lXCIgaWNvbi1vZmY9XCJpb24taW9zNy1ob21lLW91dGxpbmVcIj5cXG4nICtcbiAgICAnICAgIFxcbicgK1xuICAgICcgICAgICA8aW9uLWNvbnRlbnQgbmctY29udHJvbGxlcj1cIm1haW4ucGxheWVycy5kYXNoYm9hcmQgYXMgY3RybFwiPlxcbicgK1xuICAgICdcXG4nICtcbiAgICAnICAgICAgICA8ZGl2IGNsYXNzPVwiaXRlbVwiPlN0YXJ0IGEgbmV3IGdhbWUgZnJvbSBoZXJlLCB7e2N0cmwudXNlckRhdGEuZGF0YVVzZXJuYW1lfX0uPC9kaXY+XFxuJyArXG4gICAgJyAgICAgICAgPG5nLWZvcm0gbmFtZT1cImZvcm1cIj5cXG4nICtcbiAgICAnICAgICAgICAgIDxkaXYgY2xhc3M9XCJsaXN0XCI+XFxuJyArXG4gICAgJ1xcbicgK1xuICAgICcgICAgICAgICAgICAgIDxsYWJlbCBjbGFzcz1cIml0ZW0gaXRlbS1pbnB1dFwiPlxcbicgK1xuICAgICcgICAgICAgICAgICAgICAgPGlucHV0IG1pbmxlbmd0aD1cIjVcIiByZXF1aXJlZCB0eXBlPVwidGV4dFwiIHBsYWNlaG9sZGVyPVwiRW50ZXIgYSB0aXRsZSBmb3IgeW91ciBnYW1lLlwiIG5nLW1vZGVsPVwiY3RybC5uZXdHYW1lLmRhdGFHYW1lbmFtZVwiPlxcbicgK1xuICAgICcgICAgICAgICAgICAgIDwvbGFiZWw+XFxuJyArXG4gICAgJyAgICAgICAgICAgICAgXFxuJyArXG4gICAgJyAgICAgICAgICAgICAgPGxhYmVsIGNsYXNzPVwiaXRlbSBpdGVtLWlucHV0XCI+XFxuJyArXG4gICAgJyAgICAgICAgICAgICAgICA8aW5wdXQgbWlubGVuZ3RoPVwiNVwiIHJlcXVpcmVkIHR5cGU9XCJwYXNzd29yZFwiIHBsYWNlaG9sZGVyPVwiT3B0aW9uYWxseSwgZW50ZXIgYSBwYXNzd29yZC5cIiBuZy1tb2RlbD1cImN0cmwubmV3R2FtZS5kYXRhR2FtZVBhc3NwaHJhc2VcIj5cXG4nICtcbiAgICAnICAgICAgICAgICAgICA8L2xhYmVsPlxcbicgK1xuICAgICcgICAgICAgICAgICAgIFxcbicgK1xuICAgICcgICAgICAgICAgICAgIDx1bCBjbGFzcz1cImxpc3RcIj5cXG4nICtcbiAgICAnICAgICAgICAgICAgXFxuJyArXG4gICAgJyAgICAgICAgICAgICAgICA8bGkgY2xhc3M9XCJpdGVtIGl0ZW0tdG9nZ2xlXCI+XFxuJyArXG4gICAgJyAgICAgICAgICAgICAgICAgICBNYWtlIGl0IHZpc2libGUgdG8gZXZlcnlvbmU/XFxuJyArXG4gICAgJyAgICAgICAgICAgICAgICAgICA8bGFiZWwgZm9yPVwidmlzaWJpbGl0eVwiIGNsYXNzPVwidG9nZ2xlIHRvZ2dsZS1iYWxhbmNlZFwiPlxcbicgK1xuICAgICcgICAgICAgICAgICAgICAgICAgICA8aW5wdXQgaWQ9XCJ2aXNpYmlsaXR5XCIgbmFtZT1cInZpc2liaWxpdHlcIiBuZy1tb2RlbD1cImRhdGFHYW1lVmlzaWJpbGl0eVwiIHR5cGU9XCJjaGVja2JveFwiPlxcbicgK1xuICAgICcgICAgICAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzPVwidHJhY2tcIj5cXG4nICtcbiAgICAnICAgICAgICAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzPVwiaGFuZGxlXCI+PC9kaXY+XFxuJyArXG4gICAgJyAgICAgICAgICAgICAgICAgICAgIDwvZGl2PlxcbicgK1xuICAgICcgICAgICAgICAgICAgICAgICAgPC9sYWJlbD5cXG4nICtcbiAgICAnICAgICAgICAgICAgICAgIDwvbGk+XFxuJyArXG4gICAgJ1xcbicgK1xuICAgICcgICAgICAgICAgICAgIDwvdWw+XFxuJyArXG4gICAgJyAgICAgICAgICAgICAgXFxuJyArXG4gICAgJyAgICAgICAgICAgICAgXFxuJyArXG4gICAgJyAgICAgICAgICAgICAgPGRpdiBjbGFzcz1cIml0ZW0gaXRlbS1idXR0b25cIj5cXG4nICtcbiAgICAnICAgICAgICAgICAgICAgICAgICA8YnV0dG9uIG5nLWNsaWNrPVwiY3RybC5uZXdHYW1lKClcIiBjbGFzcz1cImJ1dHRvbiBidXR0b24tcG9zaXRpdmVcIj5TdGFydCBHYW1lPC9idXR0b24+XFxuJyArXG4gICAgJyAgICAgICAgICAgICAgPC9kaXY+XFxuJyArXG4gICAgJyAgICAgICAgICA8L2Rpdj5cXG4nICtcbiAgICAnICAgICAgICA8L25nLWZvcm0+XFxuJyArXG4gICAgJyAgICAgIDwvaW9uLWNvbnRlbnQ+XFxuJyArXG4gICAgJ1xcbicgK1xuICAgICcgICAgPC9pb24tdGFiPlxcbicgK1xuICAgICdcXG4nICtcbiAgICAnICAgIDxpb24tdGFiIHRpdGxlPVwiR2FtZXNcIiBpY29uLW9uPVwiaW9uLWlvczcta2V5cGFkXCIgaWNvbi1vZmY9XCJpb24taW9zNy1rZXlwYWQtb3V0bGluZVwiPlxcbicgK1xuICAgICcgICAgICA8aW9uLWNvbnRlbnQgbmctY29udHJvbGxlcj1cIm1haW4ucGxheWVycy5nYW1lcyBhcyBjdHJsXCI+XFxuJyArXG4gICAgJyAgICAgICAgPGgxPkdhbWVzPC9oMT5cXG4nICtcbiAgICAnICAgICAgICA8dWwgbmctcmVwZWF0PVwiZ2FtZSBpbiBjdHJsLmdhbWVzXCI+XFxuJyArXG4gICAgJyAgICAgICAgICA8bGk+e3tnYW1lLm5hbWV9fTwvbGk+XFxuJyArXG4gICAgJyAgICAgICAgPC91bD5cXG4nICtcbiAgICAnICAgICAgPC9pb24tY29udGVudD5cXG4nICtcbiAgICAnICAgIDwvaW9uLXRhYj5cXG4nICtcbiAgICAnXFxuJyArXG4gICAgJyAgICA8aW9uLXRhYiB0aXRsZT1cIlNldHRpbmdzXCIgaWNvbi1vbj1cImlvbi1pb3M3LWdlYXJcIiBpY29uLW9mZj1cImlvbi1pb3M3LWdlYXItb3V0bGluZVwiPlxcbicgK1xuICAgICcgICAgICA8aW9uLWNvbnRlbnQgbmctY29udHJvbGxlcj1cIm1haW4ucGxheWVycy5zZXR0aW5ncyBhcyBjdHJsXCI+XFxuJyArXG4gICAgJyAgICAgICAgPGgxPlNldHRpbmdzPC9oMT5cXG4nICtcbiAgICAnICAgICAgICA8dWwgbmctcmVwZWF0PVwic2V0dGluZyBpbiBjdHJsLnNldHRpbmdzXCI+XFxuJyArXG4gICAgJyAgICAgICAgICA8bGk+e3tzZXR0aW5nLm5hbWV9fSA6OiB7e3NldHRpbmcudmFsdWV9fTwvbGk+XFxuJyArXG4gICAgJyAgICAgICAgPC91bD5cXG4nICtcbiAgICAnICAgICAgPC9pb24tY29udGVudD4gICAgPC9pb24tdGFiPlxcbicgK1xuICAgICdcXG4nICtcbiAgICAnICA8L2lvbi10YWJzPlxcbicgK1xuICAgICdcXG4nICtcbiAgICAnPC9kaXY+XFxuJyArXG4gICAgJyc7IiwibW9kdWxlLmV4cG9ydHMgPSAnPGRpdiBuZy1jb250cm9sbGVyPVwibWFpbi5wbGF5ZXJzLmxvZ2luIGFzIGN0cmxcIj5cXG4nICtcbiAgICAnXFxuJyArXG4gICAgJyAgICA8aW9uLWhlYWRlci1iYXIgYWxpZ24tdGl0bGU9XCJsZWZ0XCIgY2xhc3M9XCJiYXItcG9zaXRpdmVcIj5cXG4nICtcbiAgICAnICAgICAgICA8aDEgY2xhc3M9XCJ0aXRsZVwiPlJlZFdhcjwvaDE+XFxuJyArXG4gICAgJyAgICA8L2lvbi1oZWFkZXItYmFyPlxcbicgK1xuICAgICcgICAgPGlvbi1jb250ZW50PlxcbicgK1xuICAgICcgICAgICAgIDxoMT5SRUQgV0FSPC9oMT5cXG4nICtcbiAgICAnICAgICAgICA8YSBjbGFzcz1cImJ1dHRvbiBidXR0b24tYmFsYW5jZWRcIiB1aS1zcmVmPVwibG9naW5cIj5MT0dJTjwvYT5cXG4nICtcbiAgICAnICAgIDwvaW9uLWNvbnRlbnQ+XFxuJyArXG4gICAgJyAgICA8aW9uLWZvb3Rlci1iYXIgYWxpZ24tdGl0bGU9XCJsZWZ0XCIgY2xhc3M9XCJiYXItcG9zaXRpdmVcIj5cXG4nICtcbiAgICAnXFxuJyArXG4gICAgJyAgICA8L2lvbi1mb290ZXItYmFyPlxcbicgK1xuICAgICc8L2Rpdj4nOyIsIm1vZHVsZS5leHBvcnRzID0gJzxkaXYgbmctY29udHJvbGxlcj1cIm1haW4ucGxheWVycy5sb2dpbiBhcyBjdHJsXCI+XFxuJyArXG4gICAgJ1xcbicgK1xuICAgICcgICAgPGlvbi1oZWFkZXItYmFyIGFsaWduLXRpdGxlPVwibGVmdFwiIGNsYXNzPVwiYmFyLXBvc2l0aXZlXCI+XFxuJyArXG4gICAgJyAgICAgICAgPGgxIGNsYXNzPVwidGl0bGVcIj5SZWRXYXI8L2gxPlxcbicgK1xuICAgICcgICAgPC9pb24taGVhZGVyLWJhcj5cXG4nICtcbiAgICAnICAgIDxpb24tY29udGVudD5cXG4nICtcbiAgICAnICAgICAgICA8bmctZm9ybSBuYW1lPVwibG9naW5Gb3JtXCI+XFxuJyArXG4gICAgJ1xcbicgK1xuICAgICcgICAgICAgICAgICA8ZGl2IGNsYXNzPVwibGlzdFwiPlxcbicgK1xuICAgICcgICAgICAgICAgICAgICAgPGRpdiBuZy1pZj1cIiFzaWduVXBcIj5cXG4nICtcbiAgICAnICAgICAgICAgICAgICAgIFxcbicgK1xuICAgICcgICAgICAgICAgICAgICAgICAgIDxsYWJlbCBjbGFzcz1cIml0ZW0gaXRlbS1pbnB1dFwiPlxcbicgK1xuICAgICcgICAgICAgICAgICAgICAgICAgICAgICA8aW5wdXQgbWlubGVuZ3RoPVwiNVwiIHJlcXVpcmVkIHR5cGU9XCJ0ZXh0XCIgcGxhY2Vob2xkZXI9XCJFbnRlciB5b3VyIFVzZXJuYW1lXCIgbmctbW9kZWw9XCJjdHJsLmZvcm0uc2lnbkluLmRhdGEudXNlcm5hbWVcIj5cXG4nICtcbiAgICAnICAgICAgICAgICAgICAgICAgICA8L2xhYmVsPlxcbicgK1xuICAgICcgICAgICAgICAgICAgICAgICAgIFxcbicgK1xuICAgICcgICAgICAgICAgICAgICAgICAgIDxsYWJlbCBjbGFzcz1cIml0ZW0gaXRlbS1pbnB1dFwiPlxcbicgK1xuICAgICcgICAgICAgICAgICAgICAgICAgICAgICA8aW5wdXQgbWlubGVuZ3RoPVwiNVwiIHJlcXVpcmVkIHR5cGU9XCJwYXNzd29yZFwiIHBsYWNlaG9sZGVyPVwiRW50ZXIgeW91ciBQYXNzd29yZFwiIG5nLW1vZGVsPVwiY3RybC5mb3JtLnNpZ25Jbi5kYXRhLnBhc3NwaHJhc2VcIj5cXG4nICtcbiAgICAnICAgICAgICAgICAgICAgICAgICA8L2xhYmVsPlxcbicgK1xuICAgICcgICAgICAgICAgICAgICAgICAgIFxcbicgK1xuICAgICcgICAgICAgICAgICAgICAgICAgIDxkaXYgY2xhc3M9XCJpdGVtIGl0ZW0tZGl2aWRlclwiIG5nLXNob3c9XCJjdHJsLmVycm9ycy5wYXNzd29yZC5pbnZhbGlkXCI+U29ycnksIHRoYXRcXCdzIG5vdCB0aGUgcmlnaHQgcGFzc3dvcmQuPC9kaXY+XFxuJyArXG4gICAgJyAgICAgICAgICAgICAgICAgICAgXFxuJyArXG4gICAgJyAgICAgICAgICAgICAgICA8L2Rpdj5cXG4nICtcbiAgICAnXFxuJyArXG4gICAgJyAgICAgICAgICAgICAgICA8ZGl2IG5nLWlmPVwic2lnblVwXCI+XFxuJyArXG4gICAgJyAgICAgICAgXFxuJyArXG4gICAgJyAgICAgICAgICAgICAgICAgICAgPGxhYmVsIGNsYXNzPVwiaXRlbSBpdGVtLWlucHV0XCI+XFxuJyArXG4gICAgJyAgICAgICAgICAgICAgICAgICAgICAgIDxpbnB1dCBuZy1jaGFuZ2U9XCJjdHJsLmVycm9ycy5jbGVhcigpXCIgbmFtZT1cInVzZXJuYW1lXCIgbmctbW9kZWw9XCJjdHJsLmZvcm0uc2lnblVwLmRhdGEudXNlcm5hbWVcIiBuZy1taW5sZW5ndGg9XCI0XCIgbmctcGF0dGVybj1cIi9bYS16QS1aMC05XiBdL1wiIHR5cGU9XCJ0ZXh0XCIgcGxhY2Vob2xkZXI9XCJDcmVhdGUgeW91ciBVc2VybmFtZVwiPlxcbicgK1xuICAgICcgICAgICAgICAgICAgICAgICAgIDwvbGFiZWw+XFxuJyArXG4gICAgJyAgICAgICAgICAgICAgICBcXG4nICtcbiAgICAnICAgICAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzPVwiaXRlbSBpdGVtLWRpdmlkZXJcIiBuZy1zaG93PVwiY3RybC5lcnJvcnMudXNlcm5hbWUuZHVwbGljYXRlXCI+U29ycnksIHRoYXQgdXNlcm5hbWUgaXMgYWxyZWFkeSBpbiB1c2UuPC9kaXY+XFxuJyArXG4gICAgJyAgICAgICAgICAgICAgICAgICAgPGRpdiBjbGFzcz1cIml0ZW0gaXRlbS1kaXZpZGVyXCIgbmctc2hvdz1cImxvZ2luRm9ybS51c2VybmFtZS4kZXJyb3IubWlubGVuZ3RoXCI+SSBuZWVkIGF0IGxlYXN0IDQgY2hhcmFjdGVycy48L2Rpdj5cXG4nICtcbiAgICAnICAgICAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzPVwiaXRlbSBpdGVtLWRpdmlkZXJcIiBuZy1zaG93PVwibG9naW5Gb3JtLnVzZXJuYW1lLiRlcnJvci5wYXR0ZXJuXCI+U29ycnksIG5vIGZ1bm55IGNoYXJhY3RlcnMuPC9kaXY+XFxuJyArXG4gICAgJ1xcbicgK1xuICAgICcgICAgICAgICAgICAgICAgICAgIDxsYWJlbCBjbGFzcz1cIml0ZW0gaXRlbS1pbnB1dFwiPlxcbicgK1xuICAgICcgICAgICAgICAgICAgICAgICAgICAgICA8aW5wdXQgbmctbWlubGVuZ3RoPVwiNVwiIG5hbWU9XCJwYXNzd29yZFwiIG5nLW1vZGVsPVwiY3RybC5mb3JtLnNpZ25VcC5kYXRhLnBhc3NwaHJhc2VcIiB0eXBlPVwicGFzc3dvcmRcIiBwbGFjZWhvbGRlcj1cIkNyZWF0ZSB5b3VyIFBhc3N3b3JkXCIgcmVxdWlyZWQ+XFxuJyArXG4gICAgJyAgICAgICAgICAgICAgICAgICAgPC9sYWJlbD5cXG4nICtcbiAgICAnXFxuJyArXG4gICAgJyAgICAgICAgICAgICAgICA8L2Rpdj5cXG4nICtcbiAgICAnXFxuJyArXG4gICAgJ1xcbicgK1xuICAgICcgICAgICAgICAgICAgICAgPGRpdiBjbGFzcz1cIml0ZW0gaXRlbS1jaGVja2JveFwiPlxcbicgK1xuICAgICcgICAgICAgICAgICAgICAgICAgIDxsYWJlbCBjbGFzcz1cImNoZWNrYm94XCI+XFxuJyArXG4gICAgJyAgICAgICAgICAgICAgICAgICAgICAgIDxpbnB1dCB0eXBlPVwiY2hlY2tib3hcIiBuZy1tb2RlbD1cInNpZ25VcFwiPlxcbicgK1xuICAgICcgICAgICAgICAgICAgICAgICAgIDwvbGFiZWw+XFxuJyArXG4gICAgJyAgICAgICAgICAgICAgICAgICAgSSB3YW50IHRvIFNpZ24gVXAhXFxuJyArXG4gICAgJyAgICAgICAgICAgICAgICA8L2Rpdj5cXG4nICtcbiAgICAnICAgICAgICAgICAgICAgIDxkaXYgY2xhc3M9XCJpdGVtIGl0ZW0tYnV0dG9uXCI+XFxuJyArXG4gICAgJyAgICAgICAgICAgICAgICAgICAgPGJ1dHRvbiBuZy1jbGljaz1cImN0cmwuc2lnbkluKClcIiBuZy1pZj1cIiFzaWduVXBcIiBjbGFzcz1cImJ1dHRvbiBidXR0b24tcG9zaXRpdmVcIj5TaWduIEluPC9idXR0b24+XFxuJyArXG4gICAgJyAgICAgICAgICAgICAgICAgICAgPGJ1dHRvbiBuZy1jbGljaz1cImN0cmwuc2lnblVwKClcIiBuZy1pZj1cInNpZ25VcFwiIGNsYXNzPVwiYnV0dG9uIGJ1dHRvbi1lbmVyZ2l6ZWRcIj5TaWduIFVwPC9idXR0b24+XFxuJyArXG4gICAgJyAgICAgICAgICAgICAgICA8L2Rpdj5cXG4nICtcbiAgICAnICAgICAgICAgICAgPC9kaXY+XFxuJyArXG4gICAgJ1xcbicgK1xuICAgICcgICAgICAgIDwvbmctZm9ybT5cXG4nICtcbiAgICAnXFxuJyArXG4gICAgJyAgICA8L2lvbi1jb250ZW50PlxcbicgK1xuICAgICcgICAgPGlvbi1mb290ZXItYmFyIGFsaWduLXRpdGxlPVwibGVmdFwiIGNsYXNzPVwiYmFyLXBvc2l0aXZlXCI+XFxuJyArXG4gICAgJ1xcbicgK1xuICAgICcgICAgPC9pb24tZm9vdGVyLWJhcj5cXG4nICtcbiAgICAnPC9kaXY+JzsiLCJcbm1vZHVsZS5leHBvcnRzID0gZnVuY3Rpb24odXNlREIpIHtcbiAgICB2YXIgUG91Y2hEQiA9IHJlcXVpcmUoJ3BvdWNoZGIvZGlzdC9wb3VjaGRiLmpzJyk7XG4gICAgXG4gICAgdmFyIGRiID0gbmV3IFBvdWNoREIoJ3JlZC53YXIuJyt1c2VEQiwge1xuICAgICAgICBhZGFwdGVyOiAnd2Vic3FsJ1xuICAgIH0pO1xuICAgIFxuICAgIC8qKlxuICAgICAqIERvIHNvbWUgdmFsaWRhdGlvbiBmdW5rLiBcbiAgICAgKiovXG4gICAgZGIuZGF0YUNydW1ibGUgPSBmdW5jdGlvbihvYmopIHtcbiAgICAgICAgdmFyIGRhdGEgPSB7fTtcbiAgICAgICAgT2JqZWN0LmtleXMob2JqKS5mb3JFYWNoKGZ1bmN0aW9uKGtleSkge1xuICAgICAgICAgICAgLy8tLWNhbGwgdGhlIHZhbGlkYXRlIGZ1bmN0aW9uIC8vXG4gICAgICAgICAgICBpZiAoZGIudmFsaWRhdGVba2V5XSkgXG4gICAgICAgICAgICAgICAgZGIudmFsaWRhdGVba2V5XSgpLnRoZW4oXG4gICAgICAgICAgICAgICAgICAgIGZ1bmN0aW9uKHZhbGlkKSB7IH0sXG4gICAgICAgICAgICAgICAgICAgIGZ1bmN0aW9uKGludmFsaWQpIHsgfVxuICAgICAgICAgICAgICAgICk7XG4gICAgICAgIH0pO1xuICAgICAgICByZXR1cm4gZGF0YTtcbiAgICB9O1xuXG4gICAgXG4gICAgcmV0dXJuIGRiO1xufSIsIlxuLypcbiAqIGNsYXNzTGlzdC5qczogQ3Jvc3MtYnJvd3NlciBmdWxsIGVsZW1lbnQuY2xhc3NMaXN0IGltcGxlbWVudGF0aW9uLlxuICogMjAxMS0wNi0xNVxuICpcbiAqIEJ5IEVsaSBHcmV5LCBodHRwOi8vZWxpZ3JleS5jb21cbiAqIFB1YmxpYyBEb21haW4uXG4gKiBOTyBXQVJSQU5UWSBFWFBSRVNTRUQgT1IgSU1QTElFRC4gVVNFIEFUIFlPVVIgT1dOIFJJU0suXG4gKi9cblxuLypnbG9iYWwgc2VsZiwgZG9jdW1lbnQsIERPTUV4Y2VwdGlvbiAqL1xuXG4vKiEgQHNvdXJjZSBodHRwOi8vcHVybC5lbGlncmV5LmNvbS9naXRodWIvY2xhc3NMaXN0LmpzL2Jsb2IvbWFzdGVyL2NsYXNzTGlzdC5qcyovXG5cbmlmICh0eXBlb2YgZG9jdW1lbnQgIT09IFwidW5kZWZpbmVkXCIgJiYgIShcImNsYXNzTGlzdFwiIGluIGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJhXCIpKSkge1xuXG4oZnVuY3Rpb24gKHZpZXcpIHtcblxuXCJ1c2Ugc3RyaWN0XCI7XG5cbnZhclxuICAgICAgY2xhc3NMaXN0UHJvcCA9IFwiY2xhc3NMaXN0XCJcbiAgICAsIHByb3RvUHJvcCA9IFwicHJvdG90eXBlXCJcbiAgICAsIGVsZW1DdHJQcm90byA9ICh2aWV3LkhUTUxFbGVtZW50IHx8IHZpZXcuRWxlbWVudClbcHJvdG9Qcm9wXVxuICAgICwgb2JqQ3RyID0gT2JqZWN0XG4gICAgLCBzdHJUcmltID0gU3RyaW5nW3Byb3RvUHJvcF0udHJpbSB8fCBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLnJlcGxhY2UoL15cXHMrfFxccyskL2csIFwiXCIpO1xuICAgIH1cbiAgICAsIGFyckluZGV4T2YgPSBBcnJheVtwcm90b1Byb3BdLmluZGV4T2YgfHwgZnVuY3Rpb24gKGl0ZW0pIHtcbiAgICAgICAgdmFyXG4gICAgICAgICAgICAgIGkgPSAwXG4gICAgICAgICAgICAsIGxlbiA9IHRoaXMubGVuZ3RoXG4gICAgICAgIDtcbiAgICAgICAgZm9yICg7IGkgPCBsZW47IGkrKykge1xuICAgICAgICAgICAgaWYgKGkgaW4gdGhpcyAmJiB0aGlzW2ldID09PSBpdGVtKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIGk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIC0xO1xuICAgIH1cbiAgICAvLyBWZW5kb3JzOiBwbGVhc2UgYWxsb3cgY29udGVudCBjb2RlIHRvIGluc3RhbnRpYXRlIERPTUV4Y2VwdGlvbnNcbiAgICAsIERPTUV4ID0gZnVuY3Rpb24gKHR5cGUsIG1lc3NhZ2UpIHtcbiAgICAgICAgdGhpcy5uYW1lID0gdHlwZTtcbiAgICAgICAgdGhpcy5jb2RlID0gRE9NRXhjZXB0aW9uW3R5cGVdO1xuICAgICAgICB0aGlzLm1lc3NhZ2UgPSBtZXNzYWdlO1xuICAgIH1cbiAgICAsIGNoZWNrVG9rZW5BbmRHZXRJbmRleCA9IGZ1bmN0aW9uIChjbGFzc0xpc3QsIHRva2VuKSB7XG4gICAgICAgIGlmICh0b2tlbiA9PT0gXCJcIikge1xuICAgICAgICAgICAgdGhyb3cgbmV3IERPTUV4KFxuICAgICAgICAgICAgICAgICAgXCJTWU5UQVhfRVJSXCJcbiAgICAgICAgICAgICAgICAsIFwiQW4gaW52YWxpZCBvciBpbGxlZ2FsIHN0cmluZyB3YXMgc3BlY2lmaWVkXCJcbiAgICAgICAgICAgICk7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKC9cXHMvLnRlc3QodG9rZW4pKSB7XG4gICAgICAgICAgICB0aHJvdyBuZXcgRE9NRXgoXG4gICAgICAgICAgICAgICAgICBcIklOVkFMSURfQ0hBUkFDVEVSX0VSUlwiXG4gICAgICAgICAgICAgICAgLCBcIlN0cmluZyBjb250YWlucyBhbiBpbnZhbGlkIGNoYXJhY3RlclwiXG4gICAgICAgICAgICApO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBhcnJJbmRleE9mLmNhbGwoY2xhc3NMaXN0LCB0b2tlbik7XG4gICAgfVxuICAgICwgQ2xhc3NMaXN0ID0gZnVuY3Rpb24gKGVsZW0pIHtcbiAgICAgICAgdmFyXG4gICAgICAgICAgICAgIHRyaW1tZWRDbGFzc2VzID0gc3RyVHJpbS5jYWxsKGVsZW0uY2xhc3NOYW1lKVxuICAgICAgICAgICAgLCBjbGFzc2VzID0gdHJpbW1lZENsYXNzZXMgPyB0cmltbWVkQ2xhc3Nlcy5zcGxpdCgvXFxzKy8pIDogW11cbiAgICAgICAgICAgICwgaSA9IDBcbiAgICAgICAgICAgICwgbGVuID0gY2xhc3Nlcy5sZW5ndGhcbiAgICAgICAgO1xuICAgICAgICBmb3IgKDsgaSA8IGxlbjsgaSsrKSB7XG4gICAgICAgICAgICB0aGlzLnB1c2goY2xhc3Nlc1tpXSk7XG4gICAgICAgIH1cbiAgICAgICAgdGhpcy5fdXBkYXRlQ2xhc3NOYW1lID0gZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgZWxlbS5jbGFzc05hbWUgPSB0aGlzLnRvU3RyaW5nKCk7XG4gICAgICAgIH07XG4gICAgfVxuICAgICwgY2xhc3NMaXN0UHJvdG8gPSBDbGFzc0xpc3RbcHJvdG9Qcm9wXSA9IFtdXG4gICAgLCBjbGFzc0xpc3RHZXR0ZXIgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHJldHVybiBuZXcgQ2xhc3NMaXN0KHRoaXMpO1xuICAgIH1cbjtcbi8vIE1vc3QgRE9NRXhjZXB0aW9uIGltcGxlbWVudGF0aW9ucyBkb24ndCBhbGxvdyBjYWxsaW5nIERPTUV4Y2VwdGlvbidzIHRvU3RyaW5nKClcbi8vIG9uIG5vbi1ET01FeGNlcHRpb25zLiBFcnJvcidzIHRvU3RyaW5nKCkgaXMgc3VmZmljaWVudCBoZXJlLlxuRE9NRXhbcHJvdG9Qcm9wXSA9IEVycm9yW3Byb3RvUHJvcF07XG5jbGFzc0xpc3RQcm90by5pdGVtID0gZnVuY3Rpb24gKGkpIHtcbiAgICByZXR1cm4gdGhpc1tpXSB8fCBudWxsO1xufTtcbmNsYXNzTGlzdFByb3RvLmNvbnRhaW5zID0gZnVuY3Rpb24gKHRva2VuKSB7XG4gICAgdG9rZW4gKz0gXCJcIjtcbiAgICByZXR1cm4gY2hlY2tUb2tlbkFuZEdldEluZGV4KHRoaXMsIHRva2VuKSAhPT0gLTE7XG59O1xuY2xhc3NMaXN0UHJvdG8uYWRkID0gZnVuY3Rpb24gKHRva2VuKSB7XG4gICAgdG9rZW4gKz0gXCJcIjtcbiAgICBpZiAoY2hlY2tUb2tlbkFuZEdldEluZGV4KHRoaXMsIHRva2VuKSA9PT0gLTEpIHtcbiAgICAgICAgdGhpcy5wdXNoKHRva2VuKTtcbiAgICAgICAgdGhpcy5fdXBkYXRlQ2xhc3NOYW1lKCk7XG4gICAgfVxufTtcbmNsYXNzTGlzdFByb3RvLnJlbW92ZSA9IGZ1bmN0aW9uICh0b2tlbikge1xuICAgIHRva2VuICs9IFwiXCI7XG4gICAgdmFyIGluZGV4ID0gY2hlY2tUb2tlbkFuZEdldEluZGV4KHRoaXMsIHRva2VuKTtcbiAgICBpZiAoaW5kZXggIT09IC0xKSB7XG4gICAgICAgIHRoaXMuc3BsaWNlKGluZGV4LCAxKTtcbiAgICAgICAgdGhpcy5fdXBkYXRlQ2xhc3NOYW1lKCk7XG4gICAgfVxufTtcbmNsYXNzTGlzdFByb3RvLnRvZ2dsZSA9IGZ1bmN0aW9uICh0b2tlbikge1xuICAgIHRva2VuICs9IFwiXCI7XG4gICAgaWYgKGNoZWNrVG9rZW5BbmRHZXRJbmRleCh0aGlzLCB0b2tlbikgPT09IC0xKSB7XG4gICAgICAgIHRoaXMuYWRkKHRva2VuKTtcbiAgICB9IGVsc2Uge1xuICAgICAgICB0aGlzLnJlbW92ZSh0b2tlbik7XG4gICAgfVxufTtcbmNsYXNzTGlzdFByb3RvLnRvU3RyaW5nID0gZnVuY3Rpb24gKCkge1xuICAgIHJldHVybiB0aGlzLmpvaW4oXCIgXCIpO1xufTtcblxuaWYgKG9iakN0ci5kZWZpbmVQcm9wZXJ0eSkge1xuICAgIHZhciBjbGFzc0xpc3RQcm9wRGVzYyA9IHtcbiAgICAgICAgICBnZXQ6IGNsYXNzTGlzdEdldHRlclxuICAgICAgICAsIGVudW1lcmFibGU6IHRydWVcbiAgICAgICAgLCBjb25maWd1cmFibGU6IHRydWVcbiAgICB9O1xuICAgIHRyeSB7XG4gICAgICAgIG9iakN0ci5kZWZpbmVQcm9wZXJ0eShlbGVtQ3RyUHJvdG8sIGNsYXNzTGlzdFByb3AsIGNsYXNzTGlzdFByb3BEZXNjKTtcbiAgICB9IGNhdGNoIChleCkgeyAvLyBJRSA4IGRvZXNuJ3Qgc3VwcG9ydCBlbnVtZXJhYmxlOnRydWVcbiAgICAgICAgaWYgKGV4Lm51bWJlciA9PT0gLTB4N0ZGNUVDNTQpIHtcbiAgICAgICAgICAgIGNsYXNzTGlzdFByb3BEZXNjLmVudW1lcmFibGUgPSBmYWxzZTtcbiAgICAgICAgICAgIG9iakN0ci5kZWZpbmVQcm9wZXJ0eShlbGVtQ3RyUHJvdG8sIGNsYXNzTGlzdFByb3AsIGNsYXNzTGlzdFByb3BEZXNjKTtcbiAgICAgICAgfVxuICAgIH1cbn0gZWxzZSBpZiAob2JqQ3RyW3Byb3RvUHJvcF0uX19kZWZpbmVHZXR0ZXJfXykge1xuICAgIGVsZW1DdHJQcm90by5fX2RlZmluZUdldHRlcl9fKGNsYXNzTGlzdFByb3AsIGNsYXNzTGlzdEdldHRlcik7XG59XG5cbn0oc2VsZikpO1xuXG59XG4iLCJpZiAoIUZ1bmN0aW9uLnByb3RvdHlwZS5iaW5kKSB7XG4gICAgRnVuY3Rpb24ucHJvdG90eXBlLmJpbmQgPSBmdW5jdGlvbiAob1RoaXMpIHtcbiAgICAgICAgaWYgKHR5cGVvZiB0aGlzICE9PSBcImZ1bmN0aW9uXCIpIHtcbiAgICAgICAgICAgIC8vIGNsb3Nlc3QgdGhpbmcgcG9zc2libGUgdG8gdGhlIEVDTUFTY3JpcHQgNSBpbnRlcm5hbCBJc0NhbGxhYmxlIGZ1bmN0aW9uXG4gICAgICAgICAgICB0aHJvdyBuZXcgVHlwZUVycm9yKFwiRnVuY3Rpb24ucHJvdG90eXBlLmJpbmQgLSB3aGF0IGlzIHRyeWluZyB0byBiZSBib3VuZCBpcyBub3QgY2FsbGFibGVcIik7XG4gICAgICAgIH1cblxuICAgICAgICB2YXIgYUFyZ3MgPSBBcnJheS5wcm90b3R5cGUuc2xpY2UuY2FsbChhcmd1bWVudHMsIDEpLFxuICAgICAgICBmVG9CaW5kID0gdGhpcyxcbiAgICAgICAgZk5PUCA9IGZ1bmN0aW9uICgpIHt9LFxuICAgICAgICBmQm91bmQgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICByZXR1cm4gZlRvQmluZC5hcHBseSh0aGlzIGluc3RhbmNlb2YgZk5PUCAmJiBvVGhpc1xuICAgICAgICAgICAgICAgID8gdGhpc1xuICAgICAgICAgICAgICAgIDogb1RoaXMsXG4gICAgICAgICAgICAgICAgYUFyZ3MuY29uY2F0KEFycmF5LnByb3RvdHlwZS5zbGljZS5jYWxsKGFyZ3VtZW50cykpKTtcbiAgICAgICAgfTtcblxuICAgICAgICBmTk9QLnByb3RvdHlwZSA9IHRoaXMucHJvdG90eXBlO1xuICAgICAgICBmQm91bmQucHJvdG90eXBlID0gbmV3IGZOT1AoKTtcblxuICAgICAgICByZXR1cm4gZkJvdW5kO1xuICAgIH07XG59XG4iLCJyZXF1aXJlKCcuL2NsYXNzTGlzdC5qcycpO1xucmVxdWlyZSgnLi9mdW5jdGlvblByb3RvdHlwZUJpbmQuanMnKTtcbnJlcXVpcmUoJy4vcmVxdWVzdEFuaW1hdGlvbkZyYW1lLmpzJyk7IiwiLy8gYWRkcyByZXF1ZXN0QW5pbWF0aW9uRnJhbWUgZnVuY3Rpb25hbGl0eVxuLy8gU291cmNlOiBodHRwOi8vc3RyZDYuY29tLzIwMTEvMDUvYmV0dGVyLXdpbmRvdy1yZXF1ZXN0YW5pbWF0aW9uZnJhbWUtc2hpbS9cblxud2luZG93LnJlcXVlc3RBbmltYXRpb25GcmFtZSB8fCAod2luZG93LnJlcXVlc3RBbmltYXRpb25GcmFtZSA9XG4gIHdpbmRvdy53ZWJraXRSZXF1ZXN0QW5pbWF0aW9uRnJhbWUgfHxcbiAgd2luZG93Lm1velJlcXVlc3RBbmltYXRpb25GcmFtZSAgICB8fFxuICB3aW5kb3cub1JlcXVlc3RBbmltYXRpb25GcmFtZSAgICAgIHx8XG4gIHdpbmRvdy5tc1JlcXVlc3RBbmltYXRpb25GcmFtZSAgICAgfHxcbiAgZnVuY3Rpb24oY2FsbGJhY2ssIGVsZW1lbnQpIHtcbiAgICByZXR1cm4gd2luZG93LnNldFRpbWVvdXQoZnVuY3Rpb24oKSB7XG4gICAgICBjYWxsYmFjaygrbmV3IERhdGUoKSk7XG4gIH0sIDEwMDAgLyA2MCk7XG59KTtcbiIsIihmdW5jdGlvbiAoZ2xvYmFsKXtcbi8vICAgIFBvdWNoREIgMy4wLjZcbi8vICAgIFxuLy8gICAgKGMpIDIwMTItMjAxNCBEYWxlIEhhcnZleSBhbmQgdGhlIFBvdWNoREIgdGVhbVxuLy8gICAgUG91Y2hEQiBtYXkgYmUgZnJlZWx5IGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBBcGFjaGUgbGljZW5zZSwgdmVyc2lvbiAyLjAuXG4vLyAgICBGb3IgYWxsIGRldGFpbHMgYW5kIGRvY3VtZW50YXRpb246XG4vLyAgICBodHRwOi8vcG91Y2hkYi5jb21cbiFmdW5jdGlvbihlKXtpZihcIm9iamVjdFwiPT10eXBlb2YgZXhwb3J0cyltb2R1bGUuZXhwb3J0cz1lKCk7ZWxzZSBpZihcImZ1bmN0aW9uXCI9PXR5cGVvZiBkZWZpbmUmJmRlZmluZS5hbWQpZGVmaW5lKGUpO2Vsc2V7dmFyIGY7XCJ1bmRlZmluZWRcIiE9dHlwZW9mIHdpbmRvdz9mPXdpbmRvdzpcInVuZGVmaW5lZFwiIT10eXBlb2YgZ2xvYmFsP2Y9Z2xvYmFsOlwidW5kZWZpbmVkXCIhPXR5cGVvZiBzZWxmJiYoZj1zZWxmKSxmLlBvdWNoREI9ZSgpfX0oZnVuY3Rpb24oKXt2YXIgZGVmaW5lLG1vZHVsZSxleHBvcnRzO3JldHVybiAoZnVuY3Rpb24gZSh0LG4scil7ZnVuY3Rpb24gcyhvLHUpe2lmKCFuW29dKXtpZighdFtvXSl7dmFyIGE9dHlwZW9mIHJlcXVpcmU9PVwiZnVuY3Rpb25cIiYmcmVxdWlyZTtpZighdSYmYSlyZXR1cm4gYShvLCEwKTtpZihpKXJldHVybiBpKG8sITApO3Rocm93IG5ldyBFcnJvcihcIkNhbm5vdCBmaW5kIG1vZHVsZSAnXCIrbytcIidcIil9dmFyIGY9bltvXT17ZXhwb3J0czp7fX07dFtvXVswXS5jYWxsKGYuZXhwb3J0cyxmdW5jdGlvbihlKXt2YXIgbj10W29dWzFdW2VdO3JldHVybiBzKG4/bjplKX0sZixmLmV4cG9ydHMsZSx0LG4scil9cmV0dXJuIG5bb10uZXhwb3J0c312YXIgaT10eXBlb2YgcmVxdWlyZT09XCJmdW5jdGlvblwiJiZyZXF1aXJlO2Zvcih2YXIgbz0wO288ci5sZW5ndGg7bysrKXMocltvXSk7cmV0dXJuIHN9KSh7MTpbZnVuY3Rpb24oX2RlcmVxXyxtb2R1bGUsZXhwb3J0cyl7XG5cInVzZSBzdHJpY3RcIjtcblxudmFyIHV0aWxzID0gX2RlcmVxXygnLi91dGlscycpO1xudmFyIG1lcmdlID0gX2RlcmVxXygnLi9tZXJnZScpO1xudmFyIGVycm9ycyA9IF9kZXJlcV8oJy4vZGVwcy9lcnJvcnMnKTtcbnZhciBFdmVudEVtaXR0ZXIgPSBfZGVyZXFfKCdldmVudHMnKS5FdmVudEVtaXR0ZXI7XG52YXIgdXBzZXJ0ID0gX2RlcmVxXygnLi9kZXBzL3Vwc2VydCcpO1xudmFyIENoYW5nZXMgPSBfZGVyZXFfKCcuL2NoYW5nZXMnKTtcbnZhciBQcm9taXNlID0gdXRpbHMuUHJvbWlzZTtcblxuLypcbiAqIEEgZ2VuZXJpYyBwb3VjaCBhZGFwdGVyXG4gKi9cblxuLy8gcmV0dXJucyBmaXJzdCBlbGVtZW50IG9mIGFyciBzYXRpc2Z5aW5nIGNhbGxiYWNrIHByZWRpY2F0ZVxuZnVuY3Rpb24gYXJyYXlGaXJzdChhcnIsIGNhbGxiYWNrKSB7XG4gIGZvciAodmFyIGkgPSAwOyBpIDwgYXJyLmxlbmd0aDsgaSsrKSB7XG4gICAgaWYgKGNhbGxiYWNrKGFycltpXSwgaSkgPT09IHRydWUpIHtcbiAgICAgIHJldHVybiBhcnJbaV07XG4gICAgfVxuICB9XG4gIHJldHVybiBmYWxzZTtcbn1cblxuLy8gV3JhcHBlciBmb3IgZnVuY3Rpb25zIHRoYXQgY2FsbCB0aGUgYnVsa2RvY3MgYXBpIHdpdGggYSBzaW5nbGUgZG9jLFxuLy8gaWYgdGhlIGZpcnN0IHJlc3VsdCBpcyBhbiBlcnJvciwgcmV0dXJuIGFuIGVycm9yXG5mdW5jdGlvbiB5YW5rRXJyb3IoY2FsbGJhY2spIHtcbiAgcmV0dXJuIGZ1bmN0aW9uIChlcnIsIHJlc3VsdHMpIHtcbiAgICBpZiAoZXJyIHx8IHJlc3VsdHNbMF0uZXJyb3IpIHtcbiAgICAgIGNhbGxiYWNrKGVyciB8fCByZXN1bHRzWzBdKTtcbiAgICB9IGVsc2Uge1xuICAgICAgY2FsbGJhY2sobnVsbCwgcmVzdWx0c1swXSk7XG4gICAgfVxuICB9O1xufVxuXG4vLyBmb3IgZXZlcnkgbm9kZSBpbiBhIHJldmlzaW9uIHRyZWUgY29tcHV0ZXMgaXRzIGRpc3RhbmNlIGZyb20gdGhlIGNsb3Nlc3Rcbi8vIGxlYWZcbmZ1bmN0aW9uIGNvbXB1dGVIZWlnaHQocmV2cykge1xuICB2YXIgaGVpZ2h0ID0ge307XG4gIHZhciBlZGdlcyA9IFtdO1xuICBtZXJnZS50cmF2ZXJzZVJldlRyZWUocmV2cywgZnVuY3Rpb24gKGlzTGVhZiwgcG9zLCBpZCwgcHJudCkge1xuICAgIHZhciByZXYgPSBwb3MgKyBcIi1cIiArIGlkO1xuICAgIGlmIChpc0xlYWYpIHtcbiAgICAgIGhlaWdodFtyZXZdID0gMDtcbiAgICB9XG4gICAgaWYgKHBybnQgIT09IHVuZGVmaW5lZCkge1xuICAgICAgZWRnZXMucHVzaCh7ZnJvbTogcHJudCwgdG86IHJldn0pO1xuICAgIH1cbiAgICByZXR1cm4gcmV2O1xuICB9KTtcblxuICBlZGdlcy5yZXZlcnNlKCk7XG4gIGVkZ2VzLmZvckVhY2goZnVuY3Rpb24gKGVkZ2UpIHtcbiAgICBpZiAoaGVpZ2h0W2VkZ2UuZnJvbV0gPT09IHVuZGVmaW5lZCkge1xuICAgICAgaGVpZ2h0W2VkZ2UuZnJvbV0gPSAxICsgaGVpZ2h0W2VkZ2UudG9dO1xuICAgIH0gZWxzZSB7XG4gICAgICBoZWlnaHRbZWRnZS5mcm9tXSA9IE1hdGgubWluKGhlaWdodFtlZGdlLmZyb21dLCAxICsgaGVpZ2h0W2VkZ2UudG9dKTtcbiAgICB9XG4gIH0pO1xuICByZXR1cm4gaGVpZ2h0O1xufVxuXG5mdW5jdGlvbiBhbGxEb2NzS2V5c1F1ZXJ5KGFwaSwgb3B0cywgY2FsbGJhY2spIHtcbiAgdmFyIGtleXMgPSAgKCdsaW1pdCcgaW4gb3B0cykgP1xuICAgICAgb3B0cy5rZXlzLnNsaWNlKG9wdHMuc2tpcCwgb3B0cy5saW1pdCArIG9wdHMuc2tpcCkgOlxuICAgICAgKG9wdHMuc2tpcCA+IDApID8gb3B0cy5rZXlzLnNsaWNlKG9wdHMuc2tpcCkgOiBvcHRzLmtleXM7XG4gIGlmIChvcHRzLmRlc2NlbmRpbmcpIHtcbiAgICBrZXlzLnJldmVyc2UoKTtcbiAgfVxuICBpZiAoIWtleXMubGVuZ3RoKSB7XG4gICAgcmV0dXJuIGFwaS5fYWxsRG9jcyh7bGltaXQ6IDB9LCBjYWxsYmFjayk7XG4gIH1cbiAgdmFyIGZpbmFsUmVzdWx0cyA9IHtcbiAgICBvZmZzZXQ6IG9wdHMuc2tpcFxuICB9O1xuICByZXR1cm4gUHJvbWlzZS5hbGwoa2V5cy5tYXAoZnVuY3Rpb24gKGtleSwgaSkge1xuICAgIHZhciBzdWJPcHRzID0gdXRpbHMuZXh0ZW5kKHRydWUsIHtrZXk6IGtleSwgZGVsZXRlZDogJ29rJ30sIG9wdHMpO1xuICAgIFsnbGltaXQnLCAnc2tpcCcsICdrZXlzJ10uZm9yRWFjaChmdW5jdGlvbiAob3B0S2V5KSB7XG4gICAgICBkZWxldGUgc3ViT3B0c1tvcHRLZXldO1xuICAgIH0pO1xuICAgIHJldHVybiBuZXcgUHJvbWlzZShmdW5jdGlvbiAocmVzb2x2ZSwgcmVqZWN0KSB7XG4gICAgICBhcGkuX2FsbERvY3Moc3ViT3B0cywgZnVuY3Rpb24gKGVyciwgcmVzKSB7XG4gICAgICAgIGlmIChlcnIpIHtcbiAgICAgICAgICByZXR1cm4gcmVqZWN0KGVycik7XG4gICAgICAgIH1cbiAgICAgICAgZmluYWxSZXN1bHRzLnRvdGFsX3Jvd3MgPSByZXMudG90YWxfcm93cztcbiAgICAgICAgcmVzb2x2ZShyZXMucm93c1swXSB8fCB7a2V5OiBrZXksIGVycm9yOiAnbm90X2ZvdW5kJ30pO1xuICAgICAgfSk7XG4gICAgfSk7XG4gIH0pKS50aGVuKGZ1bmN0aW9uIChyZXN1bHRzKSB7XG4gICAgZmluYWxSZXN1bHRzLnJvd3MgPSByZXN1bHRzO1xuICAgIHJldHVybiBmaW5hbFJlc3VsdHM7XG4gIH0pO1xufVxuXG51dGlscy5pbmhlcml0cyhBYnN0cmFjdFBvdWNoREIsIEV2ZW50RW1pdHRlcik7XG5tb2R1bGUuZXhwb3J0cyA9IEFic3RyYWN0UG91Y2hEQjtcblxuZnVuY3Rpb24gQWJzdHJhY3RQb3VjaERCKCkge1xuICB2YXIgc2VsZiA9IHRoaXM7XG4gIEV2ZW50RW1pdHRlci5jYWxsKHRoaXMpO1xuICBzZWxmLmF1dG9Db21wYWN0ID0gZnVuY3Rpb24gKGNhbGxiYWNrKSB7XG4gICAgLy8gaHR0cCBkb2Vzbid0IGhhdmUgYXV0by1jb21wYWN0aW9uXG4gICAgaWYgKCFzZWxmLmF1dG9fY29tcGFjdGlvbiB8fCBzZWxmLnR5cGUoKSA9PT0gJ2h0dHAnKSB7XG4gICAgICByZXR1cm4gY2FsbGJhY2s7XG4gICAgfVxuICAgIHJldHVybiBmdW5jdGlvbiAoZXJyLCByZXMpIHtcbiAgICAgIGlmIChlcnIpIHtcbiAgICAgICAgY2FsbGJhY2soZXJyKTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIHZhciBjb3VudCA9IHJlcy5sZW5ndGg7XG4gICAgICAgIHZhciBkZWNDb3VudCA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICBjb3VudC0tO1xuICAgICAgICAgIGlmICghY291bnQpIHtcbiAgICAgICAgICAgIGNhbGxiYWNrKG51bGwsIHJlcyk7XG4gICAgICAgICAgfVxuICAgICAgICB9O1xuICAgICAgICBpZiAoIXJlcy5sZW5ndGgpIHtcbiAgICAgICAgICByZXR1cm4gY2FsbGJhY2sobnVsbCwgcmVzKTtcbiAgICAgICAgfVxuICAgICAgICByZXMuZm9yRWFjaChmdW5jdGlvbiAoZG9jKSB7XG4gICAgICAgICAgaWYgKGRvYy5vayAmJiBkb2MuaWQpIHsgLy8gaWYgbm8gaWQsIHRoZW4gaXQgd2FzIGEgbG9jYWwgZG9jXG4gICAgICAgICAgICAvLyBUT0RPOiB3ZSBuZWVkIGJldHRlciBlcnJvciBoYW5kbGluZ1xuICAgICAgICAgICAgc2VsZi5jb21wYWN0RG9jdW1lbnQoZG9jLmlkLCAxLCBkZWNDb3VudCk7XG4gICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIGRlY0NvdW50KCk7XG4gICAgICAgICAgfVxuICAgICAgICB9KTtcbiAgICAgIH1cbiAgICB9O1xuICB9O1xuXG4gIHZhciBsaXN0ZW5lcnMgPSAwLCBjaGFuZ2VzO1xuICB2YXIgZXZlbnROYW1lcyA9IFsnY2hhbmdlJywgJ2RlbGV0ZScsICdjcmVhdGUnLCAndXBkYXRlJ107XG4gIHRoaXMub24oJ25ld0xpc3RlbmVyJywgZnVuY3Rpb24gKGV2ZW50TmFtZSkge1xuICAgIGlmICh+ZXZlbnROYW1lcy5pbmRleE9mKGV2ZW50TmFtZSkpIHtcbiAgICAgIGlmIChsaXN0ZW5lcnMpIHtcbiAgICAgICAgbGlzdGVuZXJzKys7XG4gICAgICAgIHJldHVybjtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIGxpc3RlbmVycysrO1xuICAgICAgfVxuICAgIH0gZWxzZSB7XG4gICAgICByZXR1cm47XG4gICAgfVxuICAgIHZhciBsYXN0Q2hhbmdlID0gMDtcbiAgICBjaGFuZ2VzID0gdGhpcy5jaGFuZ2VzKHtcbiAgICAgIGNvbmZsaWN0czogdHJ1ZSxcbiAgICAgIGluY2x1ZGVfZG9jczogdHJ1ZSxcbiAgICAgIGNvbnRpbnVvdXM6IHRydWUsXG4gICAgICBzaW5jZTogJ25vdycsXG4gICAgICBvbkNoYW5nZTogZnVuY3Rpb24gKGNoYW5nZSkge1xuICAgICAgICBpZiAoY2hhbmdlLnNlcSA8PSBsYXN0Q2hhbmdlKSB7XG4gICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG4gICAgICAgIGxhc3RDaGFuZ2UgPSBjaGFuZ2Uuc2VxO1xuICAgICAgICBzZWxmLmVtaXQoJ2NoYW5nZScsIGNoYW5nZSk7XG4gICAgICAgIGlmIChjaGFuZ2UuZG9jLl9kZWxldGVkKSB7XG4gICAgICAgICAgc2VsZi5lbWl0KCdkZWxldGUnLCBjaGFuZ2UpO1xuICAgICAgICB9IGVsc2UgaWYgKGNoYW5nZS5kb2MuX3Jldi5zcGxpdCgnLScpWzBdID09PSAnMScpIHtcbiAgICAgICAgICBzZWxmLmVtaXQoJ2NyZWF0ZScsIGNoYW5nZSk7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgc2VsZi5lbWl0KCd1cGRhdGUnLCBjaGFuZ2UpO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgfSk7XG4gIH0pO1xuICB0aGlzLm9uKCdyZW1vdmVMaXN0ZW5lcicsIGZ1bmN0aW9uIChldmVudE5hbWUpIHtcbiAgICBpZiAofmV2ZW50TmFtZXMuaW5kZXhPZihldmVudE5hbWUpKSB7XG4gICAgICBsaXN0ZW5lcnMtLTtcbiAgICAgIGlmIChsaXN0ZW5lcnMpIHtcbiAgICAgICAgcmV0dXJuO1xuICAgICAgfVxuICAgIH0gZWxzZSB7XG4gICAgICByZXR1cm47XG4gICAgfVxuICAgIGNoYW5nZXMuY2FuY2VsKCk7XG4gIH0pO1xufVxuXG5BYnN0cmFjdFBvdWNoREIucHJvdG90eXBlLnBvc3QgPVxuICB1dGlscy5hZGFwdGVyRnVuKCdwb3N0JywgZnVuY3Rpb24gKGRvYywgb3B0cywgY2FsbGJhY2spIHtcbiAgaWYgKHR5cGVvZiBvcHRzID09PSAnZnVuY3Rpb24nKSB7XG4gICAgY2FsbGJhY2sgPSBvcHRzO1xuICAgIG9wdHMgPSB7fTtcbiAgfVxuICBpZiAodHlwZW9mIGRvYyAhPT0gJ29iamVjdCcgfHwgQXJyYXkuaXNBcnJheShkb2MpKSB7XG4gICAgcmV0dXJuIGNhbGxiYWNrKGVycm9ycy5OT1RfQU5fT0JKRUNUKTtcbiAgfVxuICB0aGlzLmJ1bGtEb2NzKHtkb2NzOiBbZG9jXX0sIG9wdHMsXG4gICAgICB0aGlzLmF1dG9Db21wYWN0KHlhbmtFcnJvcihjYWxsYmFjaykpKTtcbn0pO1xuXG5BYnN0cmFjdFBvdWNoREIucHJvdG90eXBlLnB1dCA9XG4gIHV0aWxzLmFkYXB0ZXJGdW4oJ3B1dCcsIHV0aWxzLmdldEFyZ3VtZW50cyhmdW5jdGlvbiAoYXJncykge1xuICB2YXIgdGVtcCwgdGVtcHR5cGUsIG9wdHMsIGNhbGxiYWNrO1xuICB2YXIgZG9jID0gYXJncy5zaGlmdCgpO1xuICB2YXIgaWQgPSAnX2lkJyBpbiBkb2M7XG4gIGlmICh0eXBlb2YgZG9jICE9PSAnb2JqZWN0JyB8fCBBcnJheS5pc0FycmF5KGRvYykpIHtcbiAgICBjYWxsYmFjayA9IGFyZ3MucG9wKCk7XG4gICAgcmV0dXJuIGNhbGxiYWNrKGVycm9ycy5OT1RfQU5fT0JKRUNUKTtcbiAgfVxuICBkb2MgPSB1dGlscy5jbG9uZShkb2MpO1xuICB3aGlsZSAodHJ1ZSkge1xuICAgIHRlbXAgPSBhcmdzLnNoaWZ0KCk7XG4gICAgdGVtcHR5cGUgPSB0eXBlb2YgdGVtcDtcbiAgICBpZiAodGVtcHR5cGUgPT09IFwic3RyaW5nXCIgJiYgIWlkKSB7XG4gICAgICBkb2MuX2lkID0gdGVtcDtcbiAgICAgIGlkID0gdHJ1ZTtcbiAgICB9IGVsc2UgaWYgKHRlbXB0eXBlID09PSBcInN0cmluZ1wiICYmIGlkICYmICEoJ19yZXYnIGluIGRvYykpIHtcbiAgICAgIGRvYy5fcmV2ID0gdGVtcDtcbiAgICB9IGVsc2UgaWYgKHRlbXB0eXBlID09PSBcIm9iamVjdFwiKSB7XG4gICAgICBvcHRzID0gdGVtcDtcbiAgICB9IGVsc2UgaWYgKHRlbXB0eXBlID09PSBcImZ1bmN0aW9uXCIpIHtcbiAgICAgIGNhbGxiYWNrID0gdGVtcDtcbiAgICB9XG4gICAgaWYgKCFhcmdzLmxlbmd0aCkge1xuICAgICAgYnJlYWs7XG4gICAgfVxuICB9XG4gIG9wdHMgPSBvcHRzIHx8IHt9O1xuICB2YXIgZXJyb3IgPSB1dGlscy5pbnZhbGlkSWRFcnJvcihkb2MuX2lkKTtcbiAgaWYgKGVycm9yKSB7XG4gICAgcmV0dXJuIGNhbGxiYWNrKGVycm9yKTtcbiAgfVxuICBpZiAodXRpbHMuaXNMb2NhbElkKGRvYy5faWQpICYmIHR5cGVvZiB0aGlzLl9wdXRMb2NhbCA9PT0gJ2Z1bmN0aW9uJykge1xuICAgIGlmIChkb2MuX2RlbGV0ZWQpIHtcbiAgICAgIHJldHVybiB0aGlzLl9yZW1vdmVMb2NhbChkb2MsIGNhbGxiYWNrKTtcbiAgICB9IGVsc2Uge1xuICAgICAgcmV0dXJuIHRoaXMuX3B1dExvY2FsKGRvYywgY2FsbGJhY2spO1xuICAgIH1cbiAgfVxuICB0aGlzLmJ1bGtEb2NzKHtkb2NzOiBbZG9jXX0sIG9wdHMsXG4gICAgICB0aGlzLmF1dG9Db21wYWN0KHlhbmtFcnJvcihjYWxsYmFjaykpKTtcbn0pKTtcblxuQWJzdHJhY3RQb3VjaERCLnByb3RvdHlwZS5wdXRBdHRhY2htZW50ID1cbiAgdXRpbHMuYWRhcHRlckZ1bigncHV0QXR0YWNobWVudCcsIGZ1bmN0aW9uIChkb2NJZCwgYXR0YWNobWVudElkLCByZXYsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYmxvYiwgdHlwZSwgY2FsbGJhY2spIHtcbiAgdmFyIGFwaSA9IHRoaXM7XG4gIGlmICh0eXBlb2YgdHlwZSA9PT0gJ2Z1bmN0aW9uJykge1xuICAgIGNhbGxiYWNrID0gdHlwZTtcbiAgICB0eXBlID0gYmxvYjtcbiAgICBibG9iID0gcmV2O1xuICAgIHJldiA9IG51bGw7XG4gIH1cbiAgaWYgKHR5cGVvZiB0eXBlID09PSAndW5kZWZpbmVkJykge1xuICAgIHR5cGUgPSBibG9iO1xuICAgIGJsb2IgPSByZXY7XG4gICAgcmV2ID0gbnVsbDtcbiAgfVxuXG4gIGZ1bmN0aW9uIGNyZWF0ZUF0dGFjaG1lbnQoZG9jKSB7XG4gICAgZG9jLl9hdHRhY2htZW50cyA9IGRvYy5fYXR0YWNobWVudHMgfHwge307XG4gICAgZG9jLl9hdHRhY2htZW50c1thdHRhY2htZW50SWRdID0ge1xuICAgICAgY29udGVudF90eXBlOiB0eXBlLFxuICAgICAgZGF0YTogYmxvYlxuICAgIH07XG4gICAgcmV0dXJuIGFwaS5wdXQoZG9jKTtcbiAgfVxuXG4gIHJldHVybiBhcGkuZ2V0KGRvY0lkKS50aGVuKGZ1bmN0aW9uIChkb2MpIHtcbiAgICBpZiAoZG9jLl9yZXYgIT09IHJldikge1xuICAgICAgdGhyb3cgZXJyb3JzLlJFVl9DT05GTElDVDtcbiAgICB9XG5cbiAgICByZXR1cm4gY3JlYXRlQXR0YWNobWVudChkb2MpO1xuICB9LCBmdW5jdGlvbiAoZXJyKSB7XG4gICAgIC8vIGNyZWF0ZSBuZXcgZG9jXG4gICAgaWYgKGVyci5lcnJvciA9PT0gZXJyb3JzLk1JU1NJTkdfRE9DLmVycm9yKSB7XG4gICAgICByZXR1cm4gY3JlYXRlQXR0YWNobWVudCh7X2lkOiBkb2NJZH0pO1xuICAgIH0gZWxzZSB7XG4gICAgICB0aHJvdyBlcnI7XG4gICAgfVxuICB9KTtcbn0pO1xuXG5BYnN0cmFjdFBvdWNoREIucHJvdG90eXBlLnJlbW92ZUF0dGFjaG1lbnQgPVxuICB1dGlscy5hZGFwdGVyRnVuKCdyZW1vdmVBdHRhY2htZW50JywgZnVuY3Rpb24gKGRvY0lkLCBhdHRhY2htZW50SWQsIHJldixcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjYWxsYmFjaykge1xuICB2YXIgc2VsZiA9IHRoaXM7XG4gIHNlbGYuZ2V0KGRvY0lkLCBmdW5jdGlvbiAoZXJyLCBvYmopIHtcbiAgICBpZiAoZXJyKSB7XG4gICAgICBjYWxsYmFjayhlcnIpO1xuICAgICAgcmV0dXJuO1xuICAgIH1cbiAgICBpZiAob2JqLl9yZXYgIT09IHJldikge1xuICAgICAgY2FsbGJhY2soZXJyb3JzLlJFVl9DT05GTElDVCk7XG4gICAgICByZXR1cm47XG4gICAgfVxuICAgIGlmICghb2JqLl9hdHRhY2htZW50cykge1xuICAgICAgcmV0dXJuIGNhbGxiYWNrKCk7XG4gICAgfVxuICAgIGRlbGV0ZSBvYmouX2F0dGFjaG1lbnRzW2F0dGFjaG1lbnRJZF07XG4gICAgaWYgKE9iamVjdC5rZXlzKG9iai5fYXR0YWNobWVudHMpLmxlbmd0aCA9PT0gMCkge1xuICAgICAgZGVsZXRlIG9iai5fYXR0YWNobWVudHM7XG4gICAgfVxuICAgIHNlbGYucHV0KG9iaiwgY2FsbGJhY2spO1xuICB9KTtcbn0pO1xuXG5BYnN0cmFjdFBvdWNoREIucHJvdG90eXBlLnJlbW92ZSA9XG4gIHV0aWxzLmFkYXB0ZXJGdW4oJ3JlbW92ZScsIGZ1bmN0aW9uIChkb2NPcklkLCBvcHRzT3JSZXYsIG9wdHMsIGNhbGxiYWNrKSB7XG4gIHZhciBkb2M7XG4gIGlmICh0eXBlb2Ygb3B0c09yUmV2ID09PSAnc3RyaW5nJykge1xuICAgIC8vIGlkLCByZXYsIG9wdHMsIGNhbGxiYWNrIHN0eWxlXG4gICAgZG9jID0ge1xuICAgICAgX2lkOiBkb2NPcklkLFxuICAgICAgX3Jldjogb3B0c09yUmV2XG4gICAgfTtcbiAgICBpZiAodHlwZW9mIG9wdHMgPT09ICdmdW5jdGlvbicpIHtcbiAgICAgIGNhbGxiYWNrID0gb3B0cztcbiAgICAgIG9wdHMgPSB7fTtcbiAgICB9XG4gIH0gZWxzZSB7XG4gICAgLy8gZG9jLCBvcHRzLCBjYWxsYmFjayBzdHlsZVxuICAgIGRvYyA9IGRvY09ySWQ7XG4gICAgaWYgKHR5cGVvZiBvcHRzT3JSZXYgPT09ICdmdW5jdGlvbicpIHtcbiAgICAgIGNhbGxiYWNrID0gb3B0c09yUmV2O1xuICAgICAgb3B0cyA9IHt9O1xuICAgIH0gZWxzZSB7XG4gICAgICBjYWxsYmFjayA9IG9wdHM7XG4gICAgICBvcHRzID0gb3B0c09yUmV2O1xuICAgIH1cbiAgfVxuICBvcHRzID0gdXRpbHMuY2xvbmUob3B0cyB8fCB7fSk7XG4gIG9wdHMud2FzX2RlbGV0ZSA9IHRydWU7XG4gIHZhciBuZXdEb2MgPSB7X2lkOiBkb2MuX2lkLCBfcmV2OiAoZG9jLl9yZXYgfHwgb3B0cy5yZXYpfTtcbiAgbmV3RG9jLl9kZWxldGVkID0gdHJ1ZTtcbiAgaWYgKHV0aWxzLmlzTG9jYWxJZChuZXdEb2MuX2lkKSAmJiB0eXBlb2YgdGhpcy5fcmVtb3ZlTG9jYWwgPT09ICdmdW5jdGlvbicpIHtcbiAgICByZXR1cm4gdGhpcy5fcmVtb3ZlTG9jYWwoZG9jLCBjYWxsYmFjayk7XG4gIH1cbiAgdGhpcy5idWxrRG9jcyh7ZG9jczogW25ld0RvY119LCBvcHRzLCB5YW5rRXJyb3IoY2FsbGJhY2spKTtcbn0pO1xuXG5BYnN0cmFjdFBvdWNoREIucHJvdG90eXBlLnJldnNEaWZmID1cbiAgdXRpbHMuYWRhcHRlckZ1bigncmV2c0RpZmYnLCBmdW5jdGlvbiAocmVxLCBvcHRzLCBjYWxsYmFjaykge1xuICBpZiAodHlwZW9mIG9wdHMgPT09ICdmdW5jdGlvbicpIHtcbiAgICBjYWxsYmFjayA9IG9wdHM7XG4gICAgb3B0cyA9IHt9O1xuICB9XG4gIG9wdHMgPSB1dGlscy5jbG9uZShvcHRzKTtcbiAgdmFyIGlkcyA9IE9iamVjdC5rZXlzKHJlcSk7XG5cbiAgaWYgKCFpZHMubGVuZ3RoKSB7XG4gICAgcmV0dXJuIGNhbGxiYWNrKG51bGwsIHt9KTtcbiAgfVxuXG4gIHZhciBjb3VudCA9IDA7XG4gIHZhciBtaXNzaW5nID0gbmV3IHV0aWxzLk1hcCgpO1xuXG4gIGZ1bmN0aW9uIGFkZFRvTWlzc2luZyhpZCwgcmV2SWQpIHtcbiAgICBpZiAoIW1pc3NpbmcuaGFzKGlkKSkge1xuICAgICAgbWlzc2luZy5zZXQoaWQsIHttaXNzaW5nOiBbXX0pO1xuICAgIH1cbiAgICBtaXNzaW5nLmdldChpZCkubWlzc2luZy5wdXNoKHJldklkKTtcbiAgfVxuXG4gIGZ1bmN0aW9uIHByb2Nlc3NEb2MoaWQsIHJldl90cmVlKSB7XG4gICAgLy8gSXMgdGhpcyBmYXN0IGVub3VnaD8gTWF5YmUgd2Ugc2hvdWxkIHN3aXRjaCB0byBhIHNldCBzaW11bGF0ZWQgYnkgYSBtYXBcbiAgICB2YXIgbWlzc2luZ0ZvcklkID0gcmVxW2lkXS5zbGljZSgwKTtcbiAgICBtZXJnZS50cmF2ZXJzZVJldlRyZWUocmV2X3RyZWUsIGZ1bmN0aW9uIChpc0xlYWYsIHBvcywgcmV2SGFzaCwgY3R4LFxuICAgICAgb3B0cykge1xuICAgICAgICB2YXIgcmV2ID0gcG9zICsgJy0nICsgcmV2SGFzaDtcbiAgICAgICAgdmFyIGlkeCA9IG1pc3NpbmdGb3JJZC5pbmRleE9mKHJldik7XG4gICAgICAgIGlmIChpZHggPT09IC0xKSB7XG4gICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG5cbiAgICAgICAgbWlzc2luZ0ZvcklkLnNwbGljZShpZHgsIDEpO1xuICAgICAgICBpZiAob3B0cy5zdGF0dXMgIT09ICdhdmFpbGFibGUnKSB7XG4gICAgICAgICAgYWRkVG9NaXNzaW5nKGlkLCByZXYpO1xuICAgICAgICB9XG4gICAgICB9KTtcblxuICAgIC8vIFRyYXZlcnNpbmcgdGhlIHRyZWUgaXMgc3luY2hyb25vdXMsIHNvIG5vdyBgbWlzc2luZ0ZvcklkYCBjb250YWluc1xuICAgIC8vIHJldmlzaW9ucyB0aGF0IHdlcmUgbm90IGZvdW5kIGluIHRoZSB0cmVlXG4gICAgbWlzc2luZ0ZvcklkLmZvckVhY2goZnVuY3Rpb24gKHJldikge1xuICAgICAgYWRkVG9NaXNzaW5nKGlkLCByZXYpO1xuICAgIH0pO1xuICB9XG5cbiAgaWRzLm1hcChmdW5jdGlvbiAoaWQpIHtcbiAgICB0aGlzLl9nZXRSZXZpc2lvblRyZWUoaWQsIGZ1bmN0aW9uIChlcnIsIHJldl90cmVlKSB7XG4gICAgICBpZiAoZXJyICYmIGVyci5zdGF0dXMgPT09IDQwNCAmJiBlcnIubWVzc2FnZSA9PT0gJ21pc3NpbmcnKSB7XG4gICAgICAgIG1pc3Npbmcuc2V0KGlkLCB7bWlzc2luZzogcmVxW2lkXX0pO1xuICAgICAgfSBlbHNlIGlmIChlcnIpIHtcbiAgICAgICAgcmV0dXJuIGNhbGxiYWNrKGVycik7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICBwcm9jZXNzRG9jKGlkLCByZXZfdHJlZSk7XG4gICAgICB9XG5cbiAgICAgIGlmICgrK2NvdW50ID09PSBpZHMubGVuZ3RoKSB7XG4gICAgICAgIC8vIGNvbnZlcnQgTGF6eU1hcCB0byBvYmplY3RcbiAgICAgICAgdmFyIG1pc3NpbmdPYmogPSB7fTtcbiAgICAgICAgbWlzc2luZy5mb3JFYWNoKGZ1bmN0aW9uICh2YWx1ZSwga2V5KSB7XG4gICAgICAgICAgbWlzc2luZ09ialtrZXldID0gdmFsdWU7XG4gICAgICAgIH0pO1xuICAgICAgICByZXR1cm4gY2FsbGJhY2sobnVsbCwgbWlzc2luZ09iaik7XG4gICAgICB9XG4gICAgfSk7XG4gIH0sIHRoaXMpO1xufSk7XG5cbi8vIGNvbXBhY3Qgb25lIGRvY3VtZW50IGFuZCBmaXJlIGNhbGxiYWNrXG4vLyBieSBjb21wYWN0aW5nIHdlIG1lYW4gcmVtb3ZpbmcgYWxsIHJldmlzaW9ucyB3aGljaFxuLy8gYXJlIGZ1cnRoZXIgZnJvbSB0aGUgbGVhZiBpbiByZXZpc2lvbiB0cmVlIHRoYW4gbWF4X2hlaWdodFxuQWJzdHJhY3RQb3VjaERCLnByb3RvdHlwZS5jb21wYWN0RG9jdW1lbnQgPVxuICB1dGlscy5hZGFwdGVyRnVuKCdjb21wYWN0RG9jdW1lbnQnLCBmdW5jdGlvbiAoZG9jSWQsIG1heF9oZWlnaHQsIGNhbGxiYWNrKSB7XG4gIHZhciBzZWxmID0gdGhpcztcbiAgdGhpcy5fZ2V0UmV2aXNpb25UcmVlKGRvY0lkLCBmdW5jdGlvbiAoZXJyLCByZXZfdHJlZSkge1xuICAgIGlmIChlcnIpIHtcbiAgICAgIHJldHVybiBjYWxsYmFjayhlcnIpO1xuICAgIH1cbiAgICB2YXIgaGVpZ2h0ID0gY29tcHV0ZUhlaWdodChyZXZfdHJlZSk7XG4gICAgdmFyIGNhbmRpZGF0ZXMgPSBbXTtcbiAgICB2YXIgcmV2cyA9IFtdO1xuICAgIE9iamVjdC5rZXlzKGhlaWdodCkuZm9yRWFjaChmdW5jdGlvbiAocmV2KSB7XG4gICAgICBpZiAoaGVpZ2h0W3Jldl0gPiBtYXhfaGVpZ2h0KSB7XG4gICAgICAgIGNhbmRpZGF0ZXMucHVzaChyZXYpO1xuICAgICAgfVxuICAgIH0pO1xuXG4gICAgbWVyZ2UudHJhdmVyc2VSZXZUcmVlKHJldl90cmVlLCBmdW5jdGlvbiAoaXNMZWFmLCBwb3MsIHJldkhhc2gsIGN0eCwgb3B0cykge1xuICAgICAgdmFyIHJldiA9IHBvcyArICctJyArIHJldkhhc2g7XG4gICAgICBpZiAob3B0cy5zdGF0dXMgPT09ICdhdmFpbGFibGUnICYmIGNhbmRpZGF0ZXMuaW5kZXhPZihyZXYpICE9PSAtMSkge1xuICAgICAgICBvcHRzLnN0YXR1cyA9ICdtaXNzaW5nJztcbiAgICAgICAgcmV2cy5wdXNoKHJldik7XG4gICAgICB9XG4gICAgfSk7XG4gICAgc2VsZi5fZG9Db21wYWN0aW9uKGRvY0lkLCByZXZfdHJlZSwgcmV2cywgY2FsbGJhY2spO1xuICB9KTtcbn0pO1xuXG4vLyBjb21wYWN0IHRoZSB3aG9sZSBkYXRhYmFzZSB1c2luZyBzaW5nbGUgZG9jdW1lbnRcbi8vIGNvbXBhY3Rpb25cbkFic3RyYWN0UG91Y2hEQi5wcm90b3R5cGUuY29tcGFjdCA9XG4gIHV0aWxzLmFkYXB0ZXJGdW4oJ2NvbXBhY3QnLCBmdW5jdGlvbiAob3B0cywgY2FsbGJhY2spIHtcbiAgaWYgKHR5cGVvZiBvcHRzID09PSAnZnVuY3Rpb24nKSB7XG4gICAgY2FsbGJhY2sgPSBvcHRzO1xuICAgIG9wdHMgPSB7fTtcbiAgfVxuICB2YXIgc2VsZiA9IHRoaXM7XG5cbiAgb3B0cyA9IHV0aWxzLmNsb25lKG9wdHMgfHwge30pO1xuXG4gIHNlbGYuZ2V0KCdfbG9jYWwvY29tcGFjdGlvbicpW1wiY2F0Y2hcIl0oZnVuY3Rpb24gKCkge1xuICAgIHJldHVybiBmYWxzZTtcbiAgfSkudGhlbihmdW5jdGlvbiAoZG9jKSB7XG4gICAgaWYgKHR5cGVvZiBzZWxmLl9jb21wYWN0ID09PSAnZnVuY3Rpb24nKSB7XG4gICAgICBpZiAoZG9jICYmIGRvYy5sYXN0X3NlcSkge1xuICAgICAgICBvcHRzLmxhc3Rfc2VxID0gZG9jLmxhc3Rfc2VxO1xuICAgICAgfVxuICAgICAgcmV0dXJuIHNlbGYuX2NvbXBhY3Qob3B0cywgY2FsbGJhY2spO1xuICAgIH1cblxuICB9KTtcbn0pO1xuQWJzdHJhY3RQb3VjaERCLnByb3RvdHlwZS5fY29tcGFjdCA9IGZ1bmN0aW9uIChvcHRzLCBjYWxsYmFjaykge1xuICB2YXIgZG9uZSA9IGZhbHNlO1xuICB2YXIgc3RhcnRlZCA9IDA7XG4gIHZhciBjb3B0cyA9IHtcbiAgICByZXR1cm5Eb2NzOiBmYWxzZVxuICB9O1xuICB2YXIgc2VsZiA9IHRoaXM7XG4gIHZhciBsYXN0U2VxO1xuICBmdW5jdGlvbiBmaW5pc2goKSB7XG4gICAgc2VsZi5nZXQoJ19sb2NhbC9jb21wYWN0aW9uJylbXCJjYXRjaFwiXShmdW5jdGlvbiAoKSB7XG4gICAgICByZXR1cm4gZmFsc2U7XG4gICAgfSkudGhlbihmdW5jdGlvbiAoZG9jKSB7XG4gICAgICBkb2MgPSBkb2MgfHwge19pZDogJ19sb2NhbC9jb21wYWN0aW9uJ307XG4gICAgICBkb2MubGFzdF9zZXEgPSBsYXN0U2VxO1xuICAgICAgcmV0dXJuIHNlbGYucHV0KGRvYyk7XG4gICAgfSkudGhlbihmdW5jdGlvbiAoKSB7XG4gICAgICBjYWxsYmFjaygpO1xuICAgIH0sIGNhbGxiYWNrKTtcbiAgfVxuICBpZiAob3B0cy5sYXN0X3NlcSkge1xuICAgIGNvcHRzLnNpbmNlID0gb3B0cy5sYXN0X3NlcTtcbiAgfVxuICBmdW5jdGlvbiBhZnRlckNvbXBhY3QoKSB7XG4gICAgc3RhcnRlZC0tO1xuICAgIGlmICghc3RhcnRlZCAmJiBkb25lKSB7XG4gICAgICBmaW5pc2goKTtcbiAgICB9XG4gIH1cbiAgZnVuY3Rpb24gb25DaGFuZ2Uocm93KSB7XG4gICAgc3RhcnRlZCsrO1xuICAgIHNlbGYuY29tcGFjdERvY3VtZW50KHJvdy5pZCwgMCkudGhlbihhZnRlckNvbXBhY3QsIGNhbGxiYWNrKTtcbiAgfVxuICBzZWxmLmNoYW5nZXMoY29wdHMpLm9uKCdjaGFuZ2UnLCBvbkNoYW5nZSkub24oJ2NvbXBsZXRlJywgZnVuY3Rpb24gKHJlc3ApIHtcbiAgICBkb25lID0gdHJ1ZTtcbiAgICBsYXN0U2VxID0gcmVzcC5sYXN0X3NlcTtcbiAgICBpZiAoIXN0YXJ0ZWQpIHtcbiAgICAgIGZpbmlzaCgpO1xuICAgIH1cbiAgfSkub24oJ2Vycm9yJywgY2FsbGJhY2spO1xufTtcbi8qIEJlZ2luIGFwaSB3cmFwcGVycy4gU3BlY2lmaWMgZnVuY3Rpb25hbGl0eSB0byBzdG9yYWdlIGJlbG9uZ3MgaW4gdGhlIFxuICAgX1ttZXRob2RdICovXG5BYnN0cmFjdFBvdWNoREIucHJvdG90eXBlLmdldCA9XG4gIHV0aWxzLmFkYXB0ZXJGdW4oJ2dldCcsIGZ1bmN0aW9uIChpZCwgb3B0cywgY2FsbGJhY2spIHtcbiAgaWYgKHR5cGVvZiBvcHRzID09PSAnZnVuY3Rpb24nKSB7XG4gICAgY2FsbGJhY2sgPSBvcHRzO1xuICAgIG9wdHMgPSB7fTtcbiAgfVxuICBpZiAodHlwZW9mIGlkICE9PSAnc3RyaW5nJykge1xuICAgIHJldHVybiBjYWxsYmFjayhlcnJvcnMuSU5WQUxJRF9JRCk7XG4gIH1cbiAgaWYgKHV0aWxzLmlzTG9jYWxJZChpZCkgJiYgdHlwZW9mIHRoaXMuX2dldExvY2FsID09PSAnZnVuY3Rpb24nKSB7XG4gICAgcmV0dXJuIHRoaXMuX2dldExvY2FsKGlkLCBjYWxsYmFjayk7XG4gIH1cbiAgdmFyIGxlYXZlcyA9IFtdLCBzZWxmID0gdGhpcztcbiAgZnVuY3Rpb24gZmluaXNoT3BlblJldnMoKSB7XG4gICAgdmFyIHJlc3VsdCA9IFtdO1xuICAgIHZhciBjb3VudCA9IGxlYXZlcy5sZW5ndGg7XG4gICAgaWYgKCFjb3VudCkge1xuICAgICAgcmV0dXJuIGNhbGxiYWNrKG51bGwsIHJlc3VsdCk7XG4gICAgfVxuICAgIC8vIG9yZGVyIHdpdGggb3Blbl9yZXZzIGlzIHVuc3BlY2lmaWVkXG4gICAgbGVhdmVzLmZvckVhY2goZnVuY3Rpb24gKGxlYWYpIHtcbiAgICAgIHNlbGYuZ2V0KGlkLFxuICAgICAgICAgICAgICAge3JldjogbGVhZiwgcmV2czogb3B0cy5yZXZzLCBhdHRhY2htZW50czogb3B0cy5hdHRhY2htZW50c30sXG4gICAgICAgICAgICAgICBmdW5jdGlvbiAoZXJyLCBkb2MpIHtcbiAgICAgICAgaWYgKCFlcnIpIHtcbiAgICAgICAgICByZXN1bHQucHVzaCh7b2s6IGRvY30pO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgIHJlc3VsdC5wdXNoKHttaXNzaW5nOiBsZWFmfSk7XG4gICAgICAgIH1cbiAgICAgICAgY291bnQtLTtcbiAgICAgICAgaWYgKCFjb3VudCkge1xuICAgICAgICAgIGNhbGxiYWNrKG51bGwsIHJlc3VsdCk7XG4gICAgICAgIH1cbiAgICAgIH0pO1xuICAgIH0pO1xuICB9XG5cbiAgaWYgKG9wdHMub3Blbl9yZXZzKSB7XG4gICAgaWYgKG9wdHMub3Blbl9yZXZzID09PSBcImFsbFwiKSB7XG4gICAgICB0aGlzLl9nZXRSZXZpc2lvblRyZWUoaWQsIGZ1bmN0aW9uIChlcnIsIHJldl90cmVlKSB7XG4gICAgICAgIGlmIChlcnIpIHtcbiAgICAgICAgICAvLyBpZiB0aGVyZSdzIG5vIHN1Y2ggZG9jdW1lbnQgd2Ugc2hvdWxkIHRyZWF0IHRoaXNcbiAgICAgICAgICAvLyBzaXR1YXRpb24gdGhlIHNhbWUgd2F5IGFzIGlmIHJldmlzaW9uIHRyZWUgd2FzIGVtcHR5XG4gICAgICAgICAgcmV2X3RyZWUgPSBbXTtcbiAgICAgICAgfVxuICAgICAgICBsZWF2ZXMgPSBtZXJnZS5jb2xsZWN0TGVhdmVzKHJldl90cmVlKS5tYXAoZnVuY3Rpb24gKGxlYWYpIHtcbiAgICAgICAgICByZXR1cm4gbGVhZi5yZXY7XG4gICAgICAgIH0pO1xuICAgICAgICBmaW5pc2hPcGVuUmV2cygpO1xuICAgICAgfSk7XG4gICAgfSBlbHNlIHtcbiAgICAgIGlmIChBcnJheS5pc0FycmF5KG9wdHMub3Blbl9yZXZzKSkge1xuICAgICAgICBsZWF2ZXMgPSBvcHRzLm9wZW5fcmV2cztcbiAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBsZWF2ZXMubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICB2YXIgbCA9IGxlYXZlc1tpXTtcbiAgICAgICAgICAvLyBsb29rcyBsaWtlIGl0J3MgdGhlIG9ubHkgdGhpbmcgY291Y2hkYiBjaGVja3NcbiAgICAgICAgICBpZiAoISh0eXBlb2YobCkgPT09IFwic3RyaW5nXCIgJiYgL15cXGQrLS8udGVzdChsKSkpIHtcbiAgICAgICAgICAgIHJldHVybiBjYWxsYmFjayhlcnJvcnMuZXJyb3IoZXJyb3JzLkJBRF9SRVFVRVNULFxuICAgICAgICAgICAgICBcIkludmFsaWQgcmV2IGZvcm1hdFwiKSk7XG4gICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIGZpbmlzaE9wZW5SZXZzKCk7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICByZXR1cm4gY2FsbGJhY2soZXJyb3JzLmVycm9yKGVycm9ycy5VTktOT1dOX0VSUk9SLFxuICAgICAgICAgICdmdW5jdGlvbl9jbGF1c2UnKSk7XG4gICAgICB9XG4gICAgfVxuICAgIHJldHVybjsgLy8gb3Blbl9yZXZzIGRvZXMgbm90IGxpa2Ugb3RoZXIgb3B0aW9uc1xuICB9XG5cbiAgcmV0dXJuIHRoaXMuX2dldChpZCwgb3B0cywgZnVuY3Rpb24gKGVyciwgcmVzdWx0KSB7XG4gICAgb3B0cyA9IHV0aWxzLmNsb25lKG9wdHMpO1xuICAgIGlmIChlcnIpIHtcbiAgICAgIHJldHVybiBjYWxsYmFjayhlcnIpO1xuICAgIH1cblxuICAgIHZhciBkb2MgPSByZXN1bHQuZG9jO1xuICAgIGlmICghZG9jKSB7XG4gICAgICAvLyBhIHNtb2tlIHRlc3QgZm9yIHNvbWV0aGluZyBiZWluZyB2ZXJ5IHdyb25nXG4gICAgICByZXR1cm4gY2FsbGJhY2sobmV3IEVycm9yKCdubyBkb2MhJykpO1xuICAgIH1cbiAgICB2YXIgbWV0YWRhdGEgPSByZXN1bHQubWV0YWRhdGE7XG4gICAgdmFyIGN0eCA9IHJlc3VsdC5jdHg7XG5cbiAgICBpZiAob3B0cy5jb25mbGljdHMpIHtcbiAgICAgIHZhciBjb25mbGljdHMgPSBtZXJnZS5jb2xsZWN0Q29uZmxpY3RzKG1ldGFkYXRhKTtcbiAgICAgIGlmIChjb25mbGljdHMubGVuZ3RoKSB7XG4gICAgICAgIGRvYy5fY29uZmxpY3RzID0gY29uZmxpY3RzO1xuICAgICAgfVxuICAgIH1cblxuICAgIGlmIChvcHRzLnJldnMgfHwgb3B0cy5yZXZzX2luZm8pIHtcbiAgICAgIHZhciBwYXRocyA9IG1lcmdlLnJvb3RUb0xlYWYobWV0YWRhdGEucmV2X3RyZWUpO1xuICAgICAgdmFyIHBhdGggPSBhcnJheUZpcnN0KHBhdGhzLCBmdW5jdGlvbiAoYXJyKSB7XG4gICAgICAgIHJldHVybiBhcnIuaWRzLm1hcChmdW5jdGlvbiAoeCkgeyByZXR1cm4geC5pZDsgfSlcbiAgICAgICAgICAuaW5kZXhPZihkb2MuX3Jldi5zcGxpdCgnLScpWzFdKSAhPT0gLTE7XG4gICAgICB9KTtcblxuICAgICAgdmFyIGluZGV4T2ZSZXYgPSBwYXRoLmlkcy5tYXAoZnVuY3Rpb24gKHgpIHtyZXR1cm4geC5pZDsgfSlcbiAgICAgICAgLmluZGV4T2YoZG9jLl9yZXYuc3BsaXQoJy0nKVsxXSkgKyAxO1xuICAgICAgdmFyIGhvd01hbnkgPSBwYXRoLmlkcy5sZW5ndGggLSBpbmRleE9mUmV2O1xuICAgICAgcGF0aC5pZHMuc3BsaWNlKGluZGV4T2ZSZXYsIGhvd01hbnkpO1xuICAgICAgcGF0aC5pZHMucmV2ZXJzZSgpO1xuXG4gICAgICBpZiAob3B0cy5yZXZzKSB7XG4gICAgICAgIGRvYy5fcmV2aXNpb25zID0ge1xuICAgICAgICAgIHN0YXJ0OiAocGF0aC5wb3MgKyBwYXRoLmlkcy5sZW5ndGgpIC0gMSxcbiAgICAgICAgICBpZHM6IHBhdGguaWRzLm1hcChmdW5jdGlvbiAocmV2KSB7XG4gICAgICAgICAgICByZXR1cm4gcmV2LmlkO1xuICAgICAgICAgIH0pXG4gICAgICAgIH07XG4gICAgICB9XG4gICAgICBpZiAob3B0cy5yZXZzX2luZm8pIHtcbiAgICAgICAgdmFyIHBvcyA9ICBwYXRoLnBvcyArIHBhdGguaWRzLmxlbmd0aDtcbiAgICAgICAgZG9jLl9yZXZzX2luZm8gPSBwYXRoLmlkcy5tYXAoZnVuY3Rpb24gKHJldikge1xuICAgICAgICAgIHBvcy0tO1xuICAgICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICByZXY6IHBvcyArICctJyArIHJldi5pZCxcbiAgICAgICAgICAgIHN0YXR1czogcmV2Lm9wdHMuc3RhdHVzXG4gICAgICAgICAgfTtcbiAgICAgICAgfSk7XG4gICAgICB9XG4gICAgfVxuXG4gICAgaWYgKG9wdHMubG9jYWxfc2VxKSB7XG4gICAgICBkb2MuX2xvY2FsX3NlcSA9IHJlc3VsdC5tZXRhZGF0YS5zZXE7XG4gICAgfVxuXG4gICAgaWYgKG9wdHMuYXR0YWNobWVudHMgJiYgZG9jLl9hdHRhY2htZW50cykge1xuICAgICAgdmFyIGF0dGFjaG1lbnRzID0gZG9jLl9hdHRhY2htZW50cztcbiAgICAgIHZhciBjb3VudCA9IE9iamVjdC5rZXlzKGF0dGFjaG1lbnRzKS5sZW5ndGg7XG4gICAgICBpZiAoY291bnQgPT09IDApIHtcbiAgICAgICAgcmV0dXJuIGNhbGxiYWNrKG51bGwsIGRvYyk7XG4gICAgICB9XG4gICAgICBPYmplY3Qua2V5cyhhdHRhY2htZW50cykuZm9yRWFjaChmdW5jdGlvbiAoa2V5KSB7XG4gICAgICAgIHRoaXMuX2dldEF0dGFjaG1lbnQoYXR0YWNobWVudHNba2V5XSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB7ZW5jb2RlOiB0cnVlLCBjdHg6IGN0eH0sIGZ1bmN0aW9uIChlcnIsIGRhdGEpIHtcbiAgICAgICAgICB2YXIgYXR0ID0gZG9jLl9hdHRhY2htZW50c1trZXldO1xuICAgICAgICAgIGF0dC5kYXRhID0gZGF0YTtcbiAgICAgICAgICBkZWxldGUgYXR0LnN0dWI7XG4gICAgICAgICAgaWYgKCEtLWNvdW50KSB7XG4gICAgICAgICAgICBjYWxsYmFjayhudWxsLCBkb2MpO1xuICAgICAgICAgIH1cbiAgICAgICAgfSk7XG4gICAgICB9LCBzZWxmKTtcbiAgICB9IGVsc2Uge1xuICAgICAgaWYgKGRvYy5fYXR0YWNobWVudHMpIHtcbiAgICAgICAgZm9yICh2YXIga2V5IGluIGRvYy5fYXR0YWNobWVudHMpIHtcbiAgICAgICAgICBpZiAoZG9jLl9hdHRhY2htZW50cy5oYXNPd25Qcm9wZXJ0eShrZXkpKSB7XG4gICAgICAgICAgICBkb2MuX2F0dGFjaG1lbnRzW2tleV0uc3R1YiA9IHRydWU7XG4gICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICB9XG4gICAgICBjYWxsYmFjayhudWxsLCBkb2MpO1xuICAgIH1cbiAgfSk7XG59KTtcblxuQWJzdHJhY3RQb3VjaERCLnByb3RvdHlwZS5nZXRBdHRhY2htZW50ID1cbiAgdXRpbHMuYWRhcHRlckZ1bignZ2V0QXR0YWNobWVudCcsIGZ1bmN0aW9uIChkb2NJZCwgYXR0YWNobWVudElkLCBvcHRzLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNhbGxiYWNrKSB7XG4gIHZhciBzZWxmID0gdGhpcztcbiAgaWYgKG9wdHMgaW5zdGFuY2VvZiBGdW5jdGlvbikge1xuICAgIGNhbGxiYWNrID0gb3B0cztcbiAgICBvcHRzID0ge307XG4gIH1cbiAgb3B0cyA9IHV0aWxzLmNsb25lKG9wdHMpO1xuICB0aGlzLl9nZXQoZG9jSWQsIG9wdHMsIGZ1bmN0aW9uIChlcnIsIHJlcykge1xuICAgIGlmIChlcnIpIHtcbiAgICAgIHJldHVybiBjYWxsYmFjayhlcnIpO1xuICAgIH1cbiAgICBpZiAocmVzLmRvYy5fYXR0YWNobWVudHMgJiYgcmVzLmRvYy5fYXR0YWNobWVudHNbYXR0YWNobWVudElkXSkge1xuICAgICAgb3B0cy5jdHggPSByZXMuY3R4O1xuICAgICAgc2VsZi5fZ2V0QXR0YWNobWVudChyZXMuZG9jLl9hdHRhY2htZW50c1thdHRhY2htZW50SWRdLCBvcHRzLCBjYWxsYmFjayk7XG4gICAgfSBlbHNlIHtcbiAgICAgIHJldHVybiBjYWxsYmFjayhlcnJvcnMuTUlTU0lOR19ET0MpO1xuICAgIH1cbiAgfSk7XG59KTtcblxuQWJzdHJhY3RQb3VjaERCLnByb3RvdHlwZS5hbGxEb2NzID1cbiAgdXRpbHMuYWRhcHRlckZ1bignYWxsRG9jcycsIGZ1bmN0aW9uIChvcHRzLCBjYWxsYmFjaykge1xuICBpZiAodHlwZW9mIG9wdHMgPT09ICdmdW5jdGlvbicpIHtcbiAgICBjYWxsYmFjayA9IG9wdHM7XG4gICAgb3B0cyA9IHt9O1xuICB9XG4gIG9wdHMgPSB1dGlscy5jbG9uZShvcHRzKTtcbiAgb3B0cy5za2lwID0gdHlwZW9mIG9wdHMuc2tpcCAhPT0gJ3VuZGVmaW5lZCcgPyBvcHRzLnNraXAgOiAwO1xuICBpZiAoJ2tleXMnIGluIG9wdHMpIHtcbiAgICBpZiAoIUFycmF5LmlzQXJyYXkob3B0cy5rZXlzKSkge1xuICAgICAgcmV0dXJuIGNhbGxiYWNrKG5ldyBUeXBlRXJyb3IoJ29wdGlvbnMua2V5cyBtdXN0IGJlIGFuIGFycmF5JykpO1xuICAgIH1cbiAgICB2YXIgaW5jb21wYXRpYmxlT3B0ID1cbiAgICAgIFsnc3RhcnRrZXknLCAnZW5ka2V5JywgJ2tleSddLmZpbHRlcihmdW5jdGlvbiAoaW5jb21wYXRpYmxlT3B0KSB7XG4gICAgICByZXR1cm4gaW5jb21wYXRpYmxlT3B0IGluIG9wdHM7XG4gICAgfSlbMF07XG4gICAgaWYgKGluY29tcGF0aWJsZU9wdCkge1xuICAgICAgY2FsbGJhY2soZXJyb3JzLmVycm9yKGVycm9ycy5RVUVSWV9QQVJTRV9FUlJPUixcbiAgICAgICAgJ1F1ZXJ5IHBhcmFtZXRlciBgJyArIGluY29tcGF0aWJsZU9wdCArXG4gICAgICAgICdgIGlzIG5vdCBjb21wYXRpYmxlIHdpdGggbXVsdGktZ2V0J1xuICAgICAgKSk7XG4gICAgICByZXR1cm47XG4gICAgfVxuICAgIGlmICh0aGlzLnR5cGUoKSAhPT0gJ2h0dHAnKSB7XG4gICAgICByZXR1cm4gYWxsRG9jc0tleXNRdWVyeSh0aGlzLCBvcHRzLCBjYWxsYmFjayk7XG4gICAgfVxuICB9XG5cbiAgcmV0dXJuIHRoaXMuX2FsbERvY3Mob3B0cywgY2FsbGJhY2spO1xufSk7XG5cbkFic3RyYWN0UG91Y2hEQi5wcm90b3R5cGUuY2hhbmdlcyA9IGZ1bmN0aW9uIChvcHRzLCBjYWxsYmFjaykge1xuICBpZiAodHlwZW9mIG9wdHMgPT09ICdmdW5jdGlvbicpIHtcbiAgICBjYWxsYmFjayA9IG9wdHM7XG4gICAgb3B0cyA9IHt9O1xuICB9XG4gIHJldHVybiBuZXcgQ2hhbmdlcyh0aGlzLCBvcHRzLCBjYWxsYmFjayk7XG59O1xuXG5BYnN0cmFjdFBvdWNoREIucHJvdG90eXBlLmNsb3NlID1cbiAgdXRpbHMuYWRhcHRlckZ1bignY2xvc2UnLCBmdW5jdGlvbiAoY2FsbGJhY2spIHtcbiAgdGhpcy5fY2xvc2VkID0gdHJ1ZTtcbiAgcmV0dXJuIHRoaXMuX2Nsb3NlKGNhbGxiYWNrKTtcbn0pO1xuXG5BYnN0cmFjdFBvdWNoREIucHJvdG90eXBlLmluZm8gPSB1dGlscy5hZGFwdGVyRnVuKCdpbmZvJywgZnVuY3Rpb24gKGNhbGxiYWNrKSB7XG4gIHZhciBzZWxmID0gdGhpcztcbiAgdGhpcy5faW5mbyhmdW5jdGlvbiAoZXJyLCBpbmZvKSB7XG4gICAgaWYgKGVycikge1xuICAgICAgcmV0dXJuIGNhbGxiYWNrKGVycik7XG4gICAgfVxuICAgIC8vIGFzc3VtZSB3ZSBrbm93IGJldHRlciB0aGFuIHRoZSBhZGFwdGVyLCB1bmxlc3MgaXQgaW5mb3JtcyB1c1xuICAgIGluZm8uZGJfbmFtZSA9IGluZm8uZGJfbmFtZSB8fCBzZWxmLl9kYl9uYW1lO1xuICAgIGluZm8uYXV0b19jb21wYWN0aW9uID0gISEoc2VsZi5fYXV0b19jb21wYWN0aW9uICYmIHNlbGYudHlwZSgpICE9PSAnaHR0cCcpO1xuICAgIGNhbGxiYWNrKG51bGwsIGluZm8pO1xuICB9KTtcbn0pO1xuXG5BYnN0cmFjdFBvdWNoREIucHJvdG90eXBlLmlkID0gdXRpbHMuYWRhcHRlckZ1bignaWQnLCBmdW5jdGlvbiAoY2FsbGJhY2spIHtcbiAgcmV0dXJuIHRoaXMuX2lkKGNhbGxiYWNrKTtcbn0pO1xuXG5BYnN0cmFjdFBvdWNoREIucHJvdG90eXBlLnR5cGUgPSBmdW5jdGlvbiAoKSB7XG4gIHJldHVybiAodHlwZW9mIHRoaXMuX3R5cGUgPT09ICdmdW5jdGlvbicpID8gdGhpcy5fdHlwZSgpIDogdGhpcy5hZGFwdGVyO1xufTtcblxuQWJzdHJhY3RQb3VjaERCLnByb3RvdHlwZS5idWxrRG9jcyA9XG4gIHV0aWxzLmFkYXB0ZXJGdW4oJ2J1bGtEb2NzJywgZnVuY3Rpb24gKHJlcSwgb3B0cywgY2FsbGJhY2spIHtcbiAgaWYgKHR5cGVvZiBvcHRzID09PSAnZnVuY3Rpb24nKSB7XG4gICAgY2FsbGJhY2sgPSBvcHRzO1xuICAgIG9wdHMgPSB7fTtcbiAgfVxuXG4gIG9wdHMgPSB1dGlscy5jbG9uZShvcHRzKTtcblxuICBpZiAoQXJyYXkuaXNBcnJheShyZXEpKSB7XG4gICAgcmVxID0ge1xuICAgICAgZG9jczogcmVxXG4gICAgfTtcbiAgfVxuXG4gIGlmICghcmVxIHx8ICFyZXEuZG9jcyB8fCAhQXJyYXkuaXNBcnJheShyZXEuZG9jcykpIHtcbiAgICByZXR1cm4gY2FsbGJhY2soZXJyb3JzLk1JU1NJTkdfQlVMS19ET0NTKTtcbiAgfVxuXG4gIGZvciAodmFyIGkgPSAwOyBpIDwgcmVxLmRvY3MubGVuZ3RoOyArK2kpIHtcbiAgICBpZiAodHlwZW9mIHJlcS5kb2NzW2ldICE9PSAnb2JqZWN0JyB8fCBBcnJheS5pc0FycmF5KHJlcS5kb2NzW2ldKSkge1xuICAgICAgcmV0dXJuIGNhbGxiYWNrKGVycm9ycy5OT1RfQU5fT0JKRUNUKTtcbiAgICB9XG4gIH1cblxuICByZXEgPSB1dGlscy5jbG9uZShyZXEpO1xuICBpZiAoISgnbmV3X2VkaXRzJyBpbiBvcHRzKSkge1xuICAgIGlmICgnbmV3X2VkaXRzJyBpbiByZXEpIHtcbiAgICAgIG9wdHMubmV3X2VkaXRzID0gcmVxLm5ld19lZGl0cztcbiAgICB9IGVsc2Uge1xuICAgICAgb3B0cy5uZXdfZWRpdHMgPSB0cnVlO1xuICAgIH1cbiAgfVxuXG4gIHJldHVybiB0aGlzLl9idWxrRG9jcyhyZXEsIG9wdHMsIHRoaXMuYXV0b0NvbXBhY3QoY2FsbGJhY2spKTtcbn0pO1xuXG5BYnN0cmFjdFBvdWNoREIucHJvdG90eXBlLnJlZ2lzdGVyRGVwZW5kZW50RGF0YWJhc2UgPVxuICB1dGlscy5hZGFwdGVyRnVuKCdyZWdpc3RlckRlcGVuZGVudERhdGFiYXNlJywgZnVuY3Rpb24gKGRlcGVuZGVudERiLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNhbGxiYWNrKSB7XG4gIHZhciBkZXBEQiA9IG5ldyB0aGlzLmNvbnN0cnVjdG9yKGRlcGVuZGVudERiLCB7YWRhcHRlcjogdGhpcy5fYWRhcHRlcn0pO1xuICBmdW5jdGlvbiBkaWZmRnVuKGRvYykge1xuICAgIGRvYy5kZXBlbmRlbnREYnMgPSBkb2MuZGVwZW5kZW50RGJzIHx8IHt9O1xuICAgIGlmIChkb2MuZGVwZW5kZW50RGJzW2RlcGVuZGVudERiXSkge1xuICAgICAgcmV0dXJuIGZhbHNlOyAvLyBubyB1cGRhdGUgcmVxdWlyZWRcbiAgICB9XG4gICAgZG9jLmRlcGVuZGVudERic1tkZXBlbmRlbnREYl0gPSB0cnVlO1xuICAgIHJldHVybiBkb2M7XG4gIH1cbiAgdXBzZXJ0KHRoaXMsICdfbG9jYWwvX3BvdWNoX2RlcGVuZGVudERicycsIGRpZmZGdW4sIGZ1bmN0aW9uIChlcnIpIHtcbiAgICBpZiAoZXJyKSB7XG4gICAgICByZXR1cm4gY2FsbGJhY2soZXJyKTtcbiAgICB9XG4gICAgcmV0dXJuIGNhbGxiYWNrKG51bGwsIHtkYjogZGVwREJ9KTtcbiAgfSk7XG59KTtcblxufSx7XCIuL2NoYW5nZXNcIjo2LFwiLi9kZXBzL2Vycm9yc1wiOjExLFwiLi9kZXBzL3Vwc2VydFwiOjEzLFwiLi9tZXJnZVwiOjE4LFwiLi91dGlsc1wiOjIzLFwiZXZlbnRzXCI6Mjd9XSwyOltmdW5jdGlvbihfZGVyZXFfLG1vZHVsZSxleHBvcnRzKXtcbihmdW5jdGlvbiAocHJvY2Vzcyl7XG5cInVzZSBzdHJpY3RcIjtcblxudmFyIENIQU5HRVNfQkFUQ0hfU0laRSA9IDI1O1xuXG52YXIgdXRpbHMgPSBfZGVyZXFfKCcuLi91dGlscycpO1xudmFyIGVycm9ycyA9IF9kZXJlcV8oJy4uL2RlcHMvZXJyb3JzJyk7XG4vLyBwYXJzZVVyaSAxLjIuMlxuLy8gKGMpIFN0ZXZlbiBMZXZpdGhhbiA8c3RldmVubGV2aXRoYW4uY29tPlxuLy8gTUlUIExpY2Vuc2VcbmZ1bmN0aW9uIHBhcnNlVXJpKHN0cikge1xuICB2YXIgbyA9IHBhcnNlVXJpLm9wdGlvbnM7XG4gIHZhciBtID0gby5wYXJzZXJbby5zdHJpY3RNb2RlID8gXCJzdHJpY3RcIiA6IFwibG9vc2VcIl0uZXhlYyhzdHIpO1xuICB2YXIgdXJpID0ge307XG4gIHZhciBpID0gMTQ7XG5cbiAgd2hpbGUgKGktLSkge1xuICAgIHVyaVtvLmtleVtpXV0gPSBtW2ldIHx8IFwiXCI7XG4gIH1cblxuICB1cmlbby5xLm5hbWVdID0ge307XG4gIHVyaVtvLmtleVsxMl1dLnJlcGxhY2Uoby5xLnBhcnNlciwgZnVuY3Rpb24gKCQwLCAkMSwgJDIpIHtcbiAgICBpZiAoJDEpIHtcbiAgICAgIHVyaVtvLnEubmFtZV1bJDFdID0gJDI7XG4gICAgfVxuICB9KTtcblxuICByZXR1cm4gdXJpO1xufVxuXG5mdW5jdGlvbiBlbmNvZGVEb2NJZChpZCkge1xuICBpZiAoL15fKGRlc2lnbnxsb2NhbCkvLnRlc3QoaWQpKSB7XG4gICAgcmV0dXJuIGlkO1xuICB9XG4gIHJldHVybiBlbmNvZGVVUklDb21wb25lbnQoaWQpO1xufVxuXG5mdW5jdGlvbiBwcmVwcm9jZXNzQXR0YWNobWVudHMoZG9jKSB7XG4gIGlmICghZG9jLl9hdHRhY2htZW50cyB8fCAhT2JqZWN0LmtleXMoZG9jLl9hdHRhY2htZW50cykpIHtcbiAgICByZXR1cm4gdXRpbHMuUHJvbWlzZS5yZXNvbHZlKCk7XG4gIH1cblxuICByZXR1cm4gdXRpbHMuUHJvbWlzZS5hbGwoT2JqZWN0LmtleXMoZG9jLl9hdHRhY2htZW50cykubWFwKGZ1bmN0aW9uIChrZXkpIHtcbiAgICB2YXIgYXR0YWNobWVudCA9IGRvYy5fYXR0YWNobWVudHNba2V5XTtcbiAgICBpZiAoYXR0YWNobWVudC5kYXRhICYmIHR5cGVvZiBhdHRhY2htZW50LmRhdGEgIT09ICdzdHJpbmcnKSB7XG4gICAgICBpZiAodHlwZW9mIHByb2Nlc3MgPT09IHVuZGVmaW5lZCB8fCBwcm9jZXNzLmJyb3dzZXIpIHtcbiAgICAgICAgcmV0dXJuIG5ldyB1dGlscy5Qcm9taXNlKGZ1bmN0aW9uIChyZXNvbHZlKSB7XG4gICAgICAgICAgdmFyIHJlYWRlciA9IG5ldyBGaWxlUmVhZGVyKCk7XG4gICAgICAgICAgcmVhZGVyLm9ubG9hZGVuZCA9IGZ1bmN0aW9uIChlKSB7XG4gICAgICAgICAgICBhdHRhY2htZW50LmRhdGEgPSB1dGlscy5idG9hKFxuICAgICAgICAgICAgICB1dGlscy5hcnJheUJ1ZmZlclRvQmluYXJ5U3RyaW5nKGUudGFyZ2V0LnJlc3VsdCkpO1xuICAgICAgICAgICAgcmVzb2x2ZSgpO1xuICAgICAgICAgIH07XG4gICAgICAgICAgcmVhZGVyLnJlYWRBc0FycmF5QnVmZmVyKGF0dGFjaG1lbnQuZGF0YSk7XG4gICAgICAgIH0pO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgYXR0YWNobWVudC5kYXRhID0gYXR0YWNobWVudC5kYXRhLnRvU3RyaW5nKCdiYXNlNjQnKTtcbiAgICAgIH1cbiAgICB9XG4gIH0pKTtcbn1cblxucGFyc2VVcmkub3B0aW9ucyA9IHtcbiAgc3RyaWN0TW9kZTogZmFsc2UsXG4gIGtleTogW1wic291cmNlXCIsIFwicHJvdG9jb2xcIiwgXCJhdXRob3JpdHlcIiwgXCJ1c2VySW5mb1wiLCBcInVzZXJcIiwgXCJwYXNzd29yZFwiLFxuICAgICAgICBcImhvc3RcIiwgXCJwb3J0XCIsIFwicmVsYXRpdmVcIiwgXCJwYXRoXCIsIFwiZGlyZWN0b3J5XCIsIFwiZmlsZVwiLCBcInF1ZXJ5XCIsXG4gICAgICAgIFwiYW5jaG9yXCJdLFxuICBxOiAgIHtcbiAgICBuYW1lOiAgIFwicXVlcnlLZXlcIixcbiAgICBwYXJzZXI6IC8oPzpefCYpKFteJj1dKik9PyhbXiZdKikvZ1xuICB9LFxuICBwYXJzZXI6IHtcbiAgICAvKiBqc2hpbnQgbWF4bGVuOiBmYWxzZSAqL1xuICAgIHN0cmljdDogL14oPzooW146XFwvPyNdKyk6KT8oPzpcXC9cXC8oKD86KChbXjpAXSopKD86OihbXjpAXSopKT8pP0ApPyhbXjpcXC8/I10qKSg/OjooXFxkKikpPykpPygoKCg/OltePyNcXC9dKlxcLykqKShbXj8jXSopKSg/OlxcPyhbXiNdKikpPyg/OiMoLiopKT8pLyxcbiAgICBsb29zZTogIC9eKD86KD8hW146QF0rOlteOkBcXC9dKkApKFteOlxcLz8jLl0rKTopPyg/OlxcL1xcLyk/KCg/OigoW146QF0qKSg/OjooW146QF0qKSk/KT9AKT8oW146XFwvPyNdKikoPzo6KFxcZCopKT8pKCgoXFwvKD86W14/I10oPyFbXj8jXFwvXSpcXC5bXj8jXFwvLl0rKD86Wz8jXXwkKSkpKlxcLz8pPyhbXj8jXFwvXSopKSg/OlxcPyhbXiNdKikpPyg/OiMoLiopKT8pL1xuICB9XG59O1xuXG4vLyBHZXQgYWxsIHRoZSBpbmZvcm1hdGlvbiB5b3UgcG9zc2libHkgY2FuIGFib3V0IHRoZSBVUkkgZ2l2ZW4gYnkgbmFtZSBhbmRcbi8vIHJldHVybiBpdCBhcyBhIHN1aXRhYmxlIG9iamVjdC5cbmZ1bmN0aW9uIGdldEhvc3QobmFtZSwgb3B0cykge1xuICAvLyBJZiB0aGUgZ2l2ZW4gbmFtZSBjb250YWlucyBcImh0dHA6XCJcbiAgaWYgKC9odHRwKHM/KTovLnRlc3QobmFtZSkpIHtcbiAgICAvLyBQcmFzZSB0aGUgVVJJIGludG8gYWxsIGl0cyBsaXR0bGUgYml0c1xuICAgIHZhciB1cmkgPSBwYXJzZVVyaShuYW1lKTtcblxuICAgIC8vIFN0b3JlIHRoZSBmYWN0IHRoYXQgaXQgaXMgYSByZW1vdGUgVVJJXG4gICAgdXJpLnJlbW90ZSA9IHRydWU7XG5cbiAgICAvLyBTdG9yZSB0aGUgdXNlciBhbmQgcGFzc3dvcmQgYXMgYSBzZXBhcmF0ZSBhdXRoIG9iamVjdFxuICAgIGlmICh1cmkudXNlciB8fCB1cmkucGFzc3dvcmQpIHtcbiAgICAgIHVyaS5hdXRoID0ge3VzZXJuYW1lOiB1cmkudXNlciwgcGFzc3dvcmQ6IHVyaS5wYXNzd29yZH07XG4gICAgfVxuXG4gICAgLy8gU3BsaXQgdGhlIHBhdGggcGFydCBvZiB0aGUgVVJJIGludG8gcGFydHMgdXNpbmcgJy8nIGFzIHRoZSBkZWxpbWl0ZXJcbiAgICAvLyBhZnRlciByZW1vdmluZyBhbnkgbGVhZGluZyAnLycgYW5kIGFueSB0cmFpbGluZyAnLydcbiAgICB2YXIgcGFydHMgPSB1cmkucGF0aC5yZXBsYWNlKC8oXlxcL3xcXC8kKS9nLCAnJykuc3BsaXQoJy8nKTtcblxuICAgIC8vIFN0b3JlIHRoZSBmaXJzdCBwYXJ0IGFzIHRoZSBkYXRhYmFzZSBuYW1lIGFuZCByZW1vdmUgaXQgZnJvbSB0aGUgcGFydHNcbiAgICAvLyBhcnJheVxuICAgIHVyaS5kYiA9IHBhcnRzLnBvcCgpO1xuXG4gICAgLy8gUmVzdG9yZSB0aGUgcGF0aCBieSBqb2luaW5nIGFsbCB0aGUgcmVtYWluaW5nIHBhcnRzIChhbGwgdGhlIHBhcnRzXG4gICAgLy8gZXhjZXB0IGZvciB0aGUgZGF0YWJhc2UgbmFtZSkgd2l0aCAnLydzXG4gICAgdXJpLnBhdGggPSBwYXJ0cy5qb2luKCcvJyk7XG4gICAgb3B0cyA9IG9wdHMgfHwge307XG4gICAgb3B0cyA9IHV0aWxzLmNsb25lKG9wdHMpO1xuICAgIHVyaS5oZWFkZXJzID0gb3B0cy5oZWFkZXJzIHx8IHt9O1xuXG4gICAgaWYgKG9wdHMuYXV0aCB8fCB1cmkuYXV0aCkge1xuICAgICAgdmFyIG5BdXRoID0gb3B0cy5hdXRoIHx8IHVyaS5hdXRoO1xuICAgICAgdmFyIHRva2VuID0gdXRpbHMuYnRvYShuQXV0aC51c2VybmFtZSArICc6JyArIG5BdXRoLnBhc3N3b3JkKTtcbiAgICAgIHVyaS5oZWFkZXJzLkF1dGhvcml6YXRpb24gPSAnQmFzaWMgJyArIHRva2VuO1xuICAgIH1cblxuICAgIGlmIChvcHRzLmhlYWRlcnMpIHtcbiAgICAgIHVyaS5oZWFkZXJzID0gb3B0cy5oZWFkZXJzO1xuICAgIH1cblxuICAgIHJldHVybiB1cmk7XG4gIH1cblxuICAvLyBJZiB0aGUgZ2l2ZW4gbmFtZSBkb2VzIG5vdCBjb250YWluICdodHRwOicgdGhlbiByZXR1cm4gYSB2ZXJ5IGJhc2ljIG9iamVjdFxuICAvLyB3aXRoIG5vIGhvc3QsIHRoZSBjdXJyZW50IHBhdGgsIHRoZSBnaXZlbiBuYW1lIGFzIHRoZSBkYXRhYmFzZSBuYW1lIGFuZCBub1xuICAvLyB1c2VybmFtZS9wYXNzd29yZFxuICByZXR1cm4ge2hvc3Q6ICcnLCBwYXRoOiAnLycsIGRiOiBuYW1lLCBhdXRoOiBmYWxzZX07XG59XG5cbi8vIEdlbmVyYXRlIGEgVVJMIHdpdGggdGhlIGhvc3QgZGF0YSBnaXZlbiBieSBvcHRzIGFuZCB0aGUgZ2l2ZW4gcGF0aFxuZnVuY3Rpb24gZ2VuREJVcmwob3B0cywgcGF0aCkge1xuICByZXR1cm4gZ2VuVXJsKG9wdHMsIG9wdHMuZGIgKyAnLycgKyBwYXRoKTtcbn1cblxuLy8gR2VuZXJhdGUgYSBVUkwgd2l0aCB0aGUgaG9zdCBkYXRhIGdpdmVuIGJ5IG9wdHMgYW5kIHRoZSBnaXZlbiBwYXRoXG5mdW5jdGlvbiBnZW5Vcmwob3B0cywgcGF0aCkge1xuICBpZiAob3B0cy5yZW1vdGUpIHtcbiAgICAvLyBJZiB0aGUgaG9zdCBhbHJlYWR5IGhhcyBhIHBhdGgsIHRoZW4gd2UgbmVlZCB0byBoYXZlIGEgcGF0aCBkZWxpbWl0ZXJcbiAgICAvLyBPdGhlcndpc2UsIHRoZSBwYXRoIGRlbGltaXRlciBpcyB0aGUgZW1wdHkgc3RyaW5nXG4gICAgdmFyIHBhdGhEZWwgPSAhb3B0cy5wYXRoID8gJycgOiAnLyc7XG5cbiAgICAvLyBJZiB0aGUgaG9zdCBhbHJlYWR5IGhhcyBhIHBhdGgsIHRoZW4gd2UgbmVlZCB0byBoYXZlIGEgcGF0aCBkZWxpbWl0ZXJcbiAgICAvLyBPdGhlcndpc2UsIHRoZSBwYXRoIGRlbGltaXRlciBpcyB0aGUgZW1wdHkgc3RyaW5nXG4gICAgcmV0dXJuIG9wdHMucHJvdG9jb2wgKyAnOi8vJyArIG9wdHMuaG9zdCArICc6JyArIG9wdHMucG9ydCArICcvJyArXG4gICAgICAgICAgIG9wdHMucGF0aCArIHBhdGhEZWwgKyBwYXRoO1xuICB9XG5cbiAgcmV0dXJuICcvJyArIHBhdGg7XG59XG4vLyBJbXBsZW1lbnRzIHRoZSBQb3VjaERCIEFQSSBmb3IgZGVhbGluZyB3aXRoIENvdWNoREIgaW5zdGFuY2VzIG92ZXIgSFRUUFxuZnVuY3Rpb24gSHR0cFBvdWNoKG9wdHMsIGNhbGxiYWNrKSB7XG4gIC8vIFRoZSBmdW5jdGlvbnMgdGhhdCB3aWxsIGJlIHB1YmxpY2x5IGF2YWlsYWJsZSBmb3IgSHR0cFBvdWNoXG4gIHZhciBhcGkgPSB0aGlzO1xuICBhcGkuZ2V0SG9zdCA9IG9wdHMuZ2V0SG9zdCA/IG9wdHMuZ2V0SG9zdCA6IGdldEhvc3Q7XG5cbiAgLy8gUGFyc2UgdGhlIFVSSSBnaXZlbiBieSBvcHRzLm5hbWUgaW50byBhbiBlYXN5LXRvLXVzZSBvYmplY3RcbiAgdmFyIGhvc3QgPSBhcGkuZ2V0SG9zdChvcHRzLm5hbWUsIG9wdHMpO1xuXG4gIC8vIEdlbmVyYXRlIHRoZSBkYXRhYmFzZSBVUkwgYmFzZWQgb24gdGhlIGhvc3RcbiAgdmFyIGRiVXJsID0gZ2VuREJVcmwoaG9zdCwgJycpO1xuXG4gIGFwaS5nZXRVcmwgPSBmdW5jdGlvbiAoKSB7cmV0dXJuIGRiVXJsOyB9O1xuICBhcGkuZ2V0SGVhZGVycyA9IGZ1bmN0aW9uICgpIHtyZXR1cm4gdXRpbHMuY2xvbmUoaG9zdC5oZWFkZXJzKTsgfTtcblxuICB2YXIgYWpheE9wdHMgPSBvcHRzLmFqYXggfHwge307XG4gIG9wdHMgPSB1dGlscy5jbG9uZShvcHRzKTtcbiAgZnVuY3Rpb24gYWpheChvcHRpb25zLCBjYWxsYmFjaykge1xuICAgIHJldHVybiB1dGlscy5hamF4KHV0aWxzLmV4dGVuZCh7fSwgYWpheE9wdHMsIG9wdGlvbnMpLCBjYWxsYmFjayk7XG4gIH1cblxuICAvLyBDcmVhdGUgYSBuZXcgQ291Y2hEQiBkYXRhYmFzZSBiYXNlZCBvbiB0aGUgZ2l2ZW4gb3B0c1xuICB2YXIgY3JlYXRlREIgPSBmdW5jdGlvbiAoKSB7XG4gICAgYWpheCh7aGVhZGVyczogaG9zdC5oZWFkZXJzLCBtZXRob2Q6ICdQVVQnLCB1cmw6IGRiVXJsfSxcbiAgICAgICAgIGZ1bmN0aW9uIChlcnIsIHJldCkge1xuICAgICAgLy8gSWYgd2UgZ2V0IGFuIFwiVW5hdXRob3JpemVkXCIgZXJyb3JcbiAgICAgIGlmIChlcnIgJiYgZXJyLnN0YXR1cyA9PT0gNDAxKSB7XG4gICAgICAgIC8vIFRlc3QgaWYgdGhlIGRhdGFiYXNlIGFscmVhZHkgZXhpc3RzXG4gICAgICAgIGFqYXgoe2hlYWRlcnM6IGhvc3QuaGVhZGVycywgbWV0aG9kOiAnSEVBRCcsIHVybDogZGJVcmx9LFxuICAgICAgICAgICAgIGZ1bmN0aW9uIChlcnIsIHJldCkge1xuICAgICAgICAgIC8vIElmIHRoZXJlIGlzIHN0aWxsIGFuIGVycm9yXG4gICAgICAgICAgaWYgKGVycikge1xuICAgICAgICAgICAgLy8gR2l2ZSB0aGUgZXJyb3IgdG8gdGhlIGNhbGxiYWNrIHRvIGRlYWwgd2l0aFxuICAgICAgICAgICAgY2FsbGJhY2soZXJyKTtcbiAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgLy8gQ29udGludWUgYXMgaWYgdGhlcmUgaGFkIGJlZW4gbm8gZXJyb3JzXG4gICAgICAgICAgICBjYWxsYmFjayhudWxsLCBhcGkpO1xuICAgICAgICAgIH1cbiAgICAgICAgfSk7XG4gICAgICAgIC8vIElmIHRoZXJlIHdlcmUgbm8gZXJycm9zIG9yIGlmIHRoZSBvbmx5IGVycm9yIGlzIFwiUHJlY29uZGl0aW9uIEZhaWxlZFwiXG4gICAgICAgIC8vIChub3RlOiBcIlByZWNvbmRpdGlvbiBGYWlsZWRcIiBvY2N1cnMgd2hlbiB3ZSB0cnkgdG8gY3JlYXRlIGEgZGF0YWJhc2VcbiAgICAgICAgLy8gdGhhdCBhbHJlYWR5IGV4aXN0cylcbiAgICAgIH0gZWxzZSBpZiAoIWVyciB8fCBlcnIuc3RhdHVzID09PSA0MTIpIHtcbiAgICAgICAgLy8gQ29udGludWUgYXMgaWYgdGhlcmUgaGFkIGJlZW4gbm8gZXJyb3JzXG4gICAgICAgIGNhbGxiYWNrKG51bGwsIGFwaSk7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICBjYWxsYmFjayhlcnIpO1xuICAgICAgfVxuICAgIH0pO1xuICB9O1xuICBpZiAoIW9wdHMuc2tpcFNldHVwKSB7XG4gICAgYWpheCh7aGVhZGVyczogaG9zdC5oZWFkZXJzLCBtZXRob2Q6ICdHRVQnLCB1cmw6IGRiVXJsfSxcbiAgICAgICAgIGZ1bmN0aW9uIChlcnIsIHJldCkge1xuICAgICAgLy9jaGVjayBpZiB0aGUgZGIgZXhpc3RzXG4gICAgICBpZiAoZXJyKSB7XG4gICAgICAgIGlmIChlcnIuc3RhdHVzID09PSA0MDQpIHtcbiAgICAgICAgICAvL2lmIGl0IGRvZXNuJ3QsIGNyZWF0ZSBpdFxuICAgICAgICAgIGNyZWF0ZURCKCk7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgY2FsbGJhY2soZXJyKTtcbiAgICAgICAgfVxuICAgICAgfSBlbHNlIHtcbiAgICAgICAgLy9nbyBkbyBzdHVmZiB3aXRoIHRoZSBkYlxuICAgICAgICBjYWxsYmFjayhudWxsLCBhcGkpO1xuICAgICAgfVxuICAgIH0pO1xuICB9XG5cbiAgYXBpLnR5cGUgPSBmdW5jdGlvbiAoKSB7XG4gICAgcmV0dXJuICdodHRwJztcbiAgfTtcblxuICBhcGkuaWQgPSB1dGlscy5hZGFwdGVyRnVuKCdpZCcsIGZ1bmN0aW9uIChjYWxsYmFjaykge1xuICAgIGFqYXgoe1xuICAgICAgaGVhZGVyczogaG9zdC5oZWFkZXJzLFxuICAgICAgbWV0aG9kOiAnR0VUJyxcbiAgICAgIHVybDogZ2VuVXJsKGhvc3QsICcnKVxuICAgIH0sIGZ1bmN0aW9uIChlcnIsIHJlc3VsdCkge1xuICAgICAgdmFyIHV1aWQgPSAocmVzdWx0ICYmIHJlc3VsdC51dWlkKSA/XG4gICAgICAgIHJlc3VsdC51dWlkICsgaG9zdC5kYiA6IGdlbkRCVXJsKGhvc3QsICcnKTtcbiAgICAgIGNhbGxiYWNrKG51bGwsIHV1aWQpO1xuICAgIH0pO1xuICB9KTtcblxuICBhcGkucmVxdWVzdCA9IHV0aWxzLmFkYXB0ZXJGdW4oJ3JlcXVlc3QnLCBmdW5jdGlvbiAob3B0aW9ucywgY2FsbGJhY2spIHtcbiAgICBvcHRpb25zLmhlYWRlcnMgPSBob3N0LmhlYWRlcnM7XG4gICAgb3B0aW9ucy51cmwgPSBnZW5EQlVybChob3N0LCBvcHRpb25zLnVybCk7XG4gICAgYWpheChvcHRpb25zLCBjYWxsYmFjayk7XG4gIH0pO1xuXG4gIC8vIFNlbmRzIGEgUE9TVCByZXF1ZXN0IHRvIHRoZSBob3N0IGNhbGxpbmcgdGhlIGNvdWNoZGIgX2NvbXBhY3QgZnVuY3Rpb25cbiAgLy8gICAgdmVyc2lvbjogVGhlIHZlcnNpb24gb2YgQ291Y2hEQiBpdCBpcyBydW5uaW5nXG4gIGFwaS5jb21wYWN0ID0gdXRpbHMuYWRhcHRlckZ1bignY29tcGFjdCcsIGZ1bmN0aW9uIChvcHRzLCBjYWxsYmFjaykge1xuICAgIGlmICh0eXBlb2Ygb3B0cyA9PT0gJ2Z1bmN0aW9uJykge1xuICAgICAgY2FsbGJhY2sgPSBvcHRzO1xuICAgICAgb3B0cyA9IHt9O1xuICAgIH1cbiAgICBvcHRzID0gdXRpbHMuY2xvbmUob3B0cyk7XG4gICAgYWpheCh7XG4gICAgICBoZWFkZXJzOiBob3N0LmhlYWRlcnMsXG4gICAgICB1cmw6IGdlbkRCVXJsKGhvc3QsICdfY29tcGFjdCcpLFxuICAgICAgbWV0aG9kOiAnUE9TVCdcbiAgICB9LCBmdW5jdGlvbiAoKSB7XG4gICAgICBmdW5jdGlvbiBwaW5nKCkge1xuICAgICAgICBhcGkuaW5mbyhmdW5jdGlvbiAoZXJyLCByZXMpIHtcbiAgICAgICAgICBpZiAoIXJlcy5jb21wYWN0X3J1bm5pbmcpIHtcbiAgICAgICAgICAgIGNhbGxiYWNrKCk7XG4gICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIHNldFRpbWVvdXQocGluZywgb3B0cy5pbnRlcnZhbCB8fCAyMDApO1xuICAgICAgICAgIH1cbiAgICAgICAgfSk7XG4gICAgICB9XG4gICAgICAvLyBQaW5nIHRoZSBodHRwIGlmIGl0J3MgZmluaXNoZWQgY29tcGFjdGlvblxuICAgICAgaWYgKHR5cGVvZiBjYWxsYmFjayA9PT0gXCJmdW5jdGlvblwiKSB7XG4gICAgICAgIHBpbmcoKTtcbiAgICAgIH1cbiAgICB9KTtcbiAgfSk7XG5cbiAgLy8gQ2FsbHMgR0VUIG9uIHRoZSBob3N0LCB3aGljaCBnZXRzIGJhY2sgYSBKU09OIHN0cmluZyBjb250YWluaW5nXG4gIC8vICAgIGNvdWNoZGI6IEEgd2VsY29tZSBzdHJpbmdcbiAgLy8gICAgdmVyc2lvbjogVGhlIHZlcnNpb24gb2YgQ291Y2hEQiBpdCBpcyBydW5uaW5nXG4gIGFwaS5faW5mbyA9IGZ1bmN0aW9uIChjYWxsYmFjaykge1xuICAgIGFqYXgoe1xuICAgICAgaGVhZGVyczogaG9zdC5oZWFkZXJzLFxuICAgICAgbWV0aG9kOiAnR0VUJyxcbiAgICAgIHVybDogZ2VuREJVcmwoaG9zdCwgJycpXG4gICAgfSwgZnVuY3Rpb24gKGVyciwgcmVzKSB7XG4gICAgICBpZiAoZXJyKSB7XG4gICAgICAgIGNhbGxiYWNrKGVycik7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICByZXMuaG9zdCA9IGdlbkRCVXJsKGhvc3QsICcnKTtcbiAgICAgICAgY2FsbGJhY2sobnVsbCwgcmVzKTtcbiAgICAgIH1cbiAgICB9KTtcbiAgfTtcblxuICAvLyBHZXQgdGhlIGRvY3VtZW50IHdpdGggdGhlIGdpdmVuIGlkIGZyb20gdGhlIGRhdGFiYXNlIGdpdmVuIGJ5IGhvc3QuXG4gIC8vIFRoZSBpZCBjb3VsZCBiZSBzb2xlbHkgdGhlIF9pZCBpbiB0aGUgZGF0YWJhc2UsIG9yIGl0IG1heSBiZSBhXG4gIC8vIF9kZXNpZ24vSUQgb3IgX2xvY2FsL0lEIHBhdGhcbiAgYXBpLmdldCA9IHV0aWxzLmFkYXB0ZXJGdW4oJ2dldCcsIGZ1bmN0aW9uIChpZCwgb3B0cywgY2FsbGJhY2spIHtcbiAgICAvLyBJZiBubyBvcHRpb25zIHdlcmUgZ2l2ZW4sIHNldCB0aGUgY2FsbGJhY2sgdG8gdGhlIHNlY29uZCBwYXJhbWV0ZXJcbiAgICBpZiAodHlwZW9mIG9wdHMgPT09ICdmdW5jdGlvbicpIHtcbiAgICAgIGNhbGxiYWNrID0gb3B0cztcbiAgICAgIG9wdHMgPSB7fTtcbiAgICB9XG4gICAgb3B0cyA9IHV0aWxzLmNsb25lKG9wdHMpO1xuICAgIGlmIChvcHRzLmF1dG9fZW5jb2RlID09PSB1bmRlZmluZWQpIHtcbiAgICAgIG9wdHMuYXV0b19lbmNvZGUgPSB0cnVlO1xuICAgIH1cblxuICAgIC8vIExpc3Qgb2YgcGFyYW1ldGVycyB0byBhZGQgdG8gdGhlIEdFVCByZXF1ZXN0XG4gICAgdmFyIHBhcmFtcyA9IFtdO1xuXG4gICAgLy8gSWYgaXQgZXhpc3RzLCBhZGQgdGhlIG9wdHMucmV2cyB2YWx1ZSB0byB0aGUgbGlzdCBvZiBwYXJhbWV0ZXJzLlxuICAgIC8vIElmIHJldnM9dHJ1ZSB0aGVuIHRoZSByZXN1bHRpbmcgSlNPTiB3aWxsIGluY2x1ZGUgYSBmaWVsZFxuICAgIC8vIF9yZXZpc2lvbnMgY29udGFpbmluZyBhbiBhcnJheSBvZiB0aGUgcmV2aXNpb24gSURzLlxuICAgIGlmIChvcHRzLnJldnMpIHtcbiAgICAgIHBhcmFtcy5wdXNoKCdyZXZzPXRydWUnKTtcbiAgICB9XG5cbiAgICAvLyBJZiBpdCBleGlzdHMsIGFkZCB0aGUgb3B0cy5yZXZzX2luZm8gdmFsdWUgdG8gdGhlIGxpc3Qgb2YgcGFyYW1ldGVycy5cbiAgICAvLyBJZiByZXZzX2luZm89dHJ1ZSB0aGVuIHRoZSByZXN1bHRpbmcgSlNPTiB3aWxsIGluY2x1ZGUgdGhlIGZpZWxkXG4gICAgLy8gX3JldnNfaW5mbyBjb250YWluaW5nIGFuIGFycmF5IG9mIG9iamVjdHMgaW4gd2hpY2ggZWFjaCBvYmplY3RcbiAgICAvLyByZXByZXNlbnRpbmcgYW4gYXZhaWxhYmxlIHJldmlzaW9uLlxuICAgIGlmIChvcHRzLnJldnNfaW5mbykge1xuICAgICAgcGFyYW1zLnB1c2goJ3JldnNfaW5mbz10cnVlJyk7XG4gICAgfVxuXG4gICAgaWYgKG9wdHMubG9jYWxfc2VxKSB7XG4gICAgICBwYXJhbXMucHVzaCgnbG9jYWxfc2VxPXRydWUnKTtcbiAgICB9XG4gICAgLy8gSWYgaXQgZXhpc3RzLCBhZGQgdGhlIG9wdHMub3Blbl9yZXZzIHZhbHVlIHRvIHRoZSBsaXN0IG9mIHBhcmFtZXRlcnMuXG4gICAgLy8gSWYgb3Blbl9yZXZzPWFsbCB0aGVuIHRoZSByZXN1bHRpbmcgSlNPTiB3aWxsIGluY2x1ZGUgYWxsIHRoZSBsZWFmXG4gICAgLy8gcmV2aXNpb25zLiBJZiBvcGVuX3JldnM9W1wicmV2MVwiLCBcInJldjJcIiwuLi5dIHRoZW4gdGhlIHJlc3VsdGluZyBKU09OXG4gICAgLy8gd2lsbCBjb250YWluIGFuIGFycmF5IG9mIG9iamVjdHMgY29udGFpbmluZyBkYXRhIG9mIGFsbCByZXZpc2lvbnNcbiAgICBpZiAob3B0cy5vcGVuX3JldnMpIHtcbiAgICAgIGlmIChvcHRzLm9wZW5fcmV2cyAhPT0gXCJhbGxcIikge1xuICAgICAgICBvcHRzLm9wZW5fcmV2cyA9IEpTT04uc3RyaW5naWZ5KG9wdHMub3Blbl9yZXZzKTtcbiAgICAgIH1cbiAgICAgIHBhcmFtcy5wdXNoKCdvcGVuX3JldnM9JyArIG9wdHMub3Blbl9yZXZzKTtcbiAgICB9XG5cbiAgICAvLyBJZiBpdCBleGlzdHMsIGFkZCB0aGUgb3B0cy5hdHRhY2htZW50cyB2YWx1ZSB0byB0aGUgbGlzdCBvZiBwYXJhbWV0ZXJzLlxuICAgIC8vIElmIGF0dGFjaG1lbnRzPXRydWUgdGhlIHJlc3VsdGluZyBKU09OIHdpbGwgaW5jbHVkZSB0aGUgYmFzZTY0LWVuY29kZWRcbiAgICAvLyBjb250ZW50cyBpbiB0aGUgXCJkYXRhXCIgcHJvcGVydHkgb2YgZWFjaCBhdHRhY2htZW50LlxuICAgIGlmIChvcHRzLmF0dGFjaG1lbnRzKSB7XG4gICAgICBwYXJhbXMucHVzaCgnYXR0YWNobWVudHM9dHJ1ZScpO1xuICAgIH1cblxuICAgIC8vIElmIGl0IGV4aXN0cywgYWRkIHRoZSBvcHRzLnJldiB2YWx1ZSB0byB0aGUgbGlzdCBvZiBwYXJhbWV0ZXJzLlxuICAgIC8vIElmIHJldiBpcyBnaXZlbiBhIHJldmlzaW9uIG51bWJlciB0aGVuIGdldCB0aGUgc3BlY2lmaWVkIHJldmlzaW9uLlxuICAgIGlmIChvcHRzLnJldikge1xuICAgICAgcGFyYW1zLnB1c2goJ3Jldj0nICsgb3B0cy5yZXYpO1xuICAgIH1cblxuICAgIC8vIElmIGl0IGV4aXN0cywgYWRkIHRoZSBvcHRzLmNvbmZsaWN0cyB2YWx1ZSB0byB0aGUgbGlzdCBvZiBwYXJhbWV0ZXJzLlxuICAgIC8vIElmIGNvbmZsaWN0cz10cnVlIHRoZW4gdGhlIHJlc3VsdGluZyBKU09OIHdpbGwgaW5jbHVkZSB0aGUgZmllbGRcbiAgICAvLyBfY29uZmxpY3RzIGNvbnRhaW5pbmcgYWxsIHRoZSBjb25mbGljdGluZyByZXZpc2lvbnMuXG4gICAgaWYgKG9wdHMuY29uZmxpY3RzKSB7XG4gICAgICBwYXJhbXMucHVzaCgnY29uZmxpY3RzPScgKyBvcHRzLmNvbmZsaWN0cyk7XG4gICAgfVxuXG4gICAgLy8gRm9ybWF0IHRoZSBsaXN0IG9mIHBhcmFtZXRlcnMgaW50byBhIHZhbGlkIFVSSSBxdWVyeSBzdHJpbmdcbiAgICBwYXJhbXMgPSBwYXJhbXMuam9pbignJicpO1xuICAgIHBhcmFtcyA9IHBhcmFtcyA9PT0gJycgPyAnJyA6ICc/JyArIHBhcmFtcztcblxuICAgIGlmIChvcHRzLmF1dG9fZW5jb2RlKSB7XG4gICAgICBpZCA9IGVuY29kZURvY0lkKGlkKTtcbiAgICB9XG5cbiAgICAvLyBTZXQgdGhlIG9wdGlvbnMgZm9yIHRoZSBhamF4IGNhbGxcbiAgICB2YXIgb3B0aW9ucyA9IHtcbiAgICAgIGhlYWRlcnM6IGhvc3QuaGVhZGVycyxcbiAgICAgIG1ldGhvZDogJ0dFVCcsXG4gICAgICB1cmw6IGdlbkRCVXJsKGhvc3QsIGlkICsgcGFyYW1zKVxuICAgIH07XG5cbiAgICAvLyBJZiB0aGUgZ2l2ZW4gaWQgY29udGFpbnMgYXQgbGVhc3Qgb25lICcvJyBhbmQgdGhlIHBhcnQgYmVmb3JlIHRoZSAnLydcbiAgICAvLyBpcyBOT1QgXCJfZGVzaWduXCIgYW5kIGlzIE5PVCBcIl9sb2NhbFwiXG4gICAgLy8gT1JcbiAgICAvLyBJZiB0aGUgZ2l2ZW4gaWQgY29udGFpbnMgYXQgbGVhc3QgdHdvICcvJyBhbmQgdGhlIHBhcnQgYmVmb3JlIHRoZSBmaXJzdFxuICAgIC8vICcvJyBpcyBcIl9kZXNpZ25cIi5cbiAgICAvLyBUT0RPIFRoaXMgc2Vjb25kIGNvbmRpdGlvbiBzZWVtcyBzdHJhbmdlIHNpbmNlIGlmIHBhcnRzWzBdID09PSAnX2Rlc2lnbidcbiAgICAvLyB0aGVuIHdlIGFscmVhZHkga25vdyB0aGF0IHBhcnRzWzBdICE9PSAnX2xvY2FsJy5cbiAgICB2YXIgcGFydHMgPSBpZC5zcGxpdCgnLycpO1xuICAgIGlmICgocGFydHMubGVuZ3RoID4gMSAmJiBwYXJ0c1swXSAhPT0gJ19kZXNpZ24nICYmIHBhcnRzWzBdICE9PSAnX2xvY2FsJykgfHxcbiAgICAgICAgKHBhcnRzLmxlbmd0aCA+IDIgJiYgcGFydHNbMF0gPT09ICdfZGVzaWduJyAmJiBwYXJ0c1swXSAhPT0gJ19sb2NhbCcpKSB7XG4gICAgICAvLyBCaW5hcnkgaXMgZXhwZWN0ZWQgYmFjayBmcm9tIHRoZSBzZXJ2ZXJcbiAgICAgIG9wdGlvbnMuYmluYXJ5ID0gdHJ1ZTtcbiAgICB9XG5cbiAgICAvLyBHZXQgdGhlIGRvY3VtZW50XG4gICAgYWpheChvcHRpb25zLCBmdW5jdGlvbiAoZXJyLCBkb2MsIHhocikge1xuICAgICAgLy8gSWYgdGhlIGRvY3VtZW50IGRvZXMgbm90IGV4aXN0LCBzZW5kIGFuIGVycm9yIHRvIHRoZSBjYWxsYmFja1xuICAgICAgaWYgKGVycikge1xuICAgICAgICByZXR1cm4gY2FsbGJhY2soZXJyKTtcbiAgICAgIH1cblxuICAgICAgLy8gU2VuZCB0aGUgZG9jdW1lbnQgdG8gdGhlIGNhbGxiYWNrXG4gICAgICBjYWxsYmFjayhudWxsLCBkb2MsIHhocik7XG4gICAgfSk7XG4gIH0pO1xuXG4gIC8vIERlbGV0ZSB0aGUgZG9jdW1lbnQgZ2l2ZW4gYnkgZG9jIGZyb20gdGhlIGRhdGFiYXNlIGdpdmVuIGJ5IGhvc3QuXG4gIGFwaS5yZW1vdmUgPSB1dGlscy5hZGFwdGVyRnVuKCdyZW1vdmUnLCBmdW5jdGlvbiAoZG9jT3JJZCwgb3B0c09yUmV2LCBvcHRzLCBjYWxsYmFjaykge1xuICAgIHZhciBkb2M7XG4gICAgaWYgKHR5cGVvZiBvcHRzT3JSZXYgPT09ICdzdHJpbmcnKSB7XG4gICAgICAvLyBpZCwgcmV2LCBvcHRzLCBjYWxsYmFjayBzdHlsZVxuICAgICAgZG9jID0ge1xuICAgICAgICBfaWQ6IGRvY09ySWQsXG4gICAgICAgIF9yZXY6IG9wdHNPclJldlxuICAgICAgfTtcbiAgICAgIGlmICh0eXBlb2Ygb3B0cyA9PT0gJ2Z1bmN0aW9uJykge1xuICAgICAgICBjYWxsYmFjayA9IG9wdHM7XG4gICAgICAgIG9wdHMgPSB7fTtcbiAgICAgIH1cbiAgICB9IGVsc2Uge1xuICAgICAgLy8gZG9jLCBvcHRzLCBjYWxsYmFjayBzdHlsZVxuICAgICAgZG9jID0gZG9jT3JJZDtcbiAgICAgIGlmICh0eXBlb2Ygb3B0c09yUmV2ID09PSAnZnVuY3Rpb24nKSB7XG4gICAgICAgIGNhbGxiYWNrID0gb3B0c09yUmV2O1xuICAgICAgICBvcHRzID0ge307XG4gICAgICB9IGVsc2Uge1xuICAgICAgICBjYWxsYmFjayA9IG9wdHM7XG4gICAgICAgIG9wdHMgPSBvcHRzT3JSZXY7XG4gICAgICB9XG4gICAgfVxuXG4gICAgdmFyIHJldiA9IChkb2MuX3JldiB8fCBvcHRzLnJldik7XG5cbiAgICAvLyBEZWxldGUgdGhlIGRvY3VtZW50XG4gICAgYWpheCh7XG4gICAgICBoZWFkZXJzOiBob3N0LmhlYWRlcnMsXG4gICAgICBtZXRob2Q6ICdERUxFVEUnLFxuICAgICAgdXJsOiBnZW5EQlVybChob3N0LCBlbmNvZGVEb2NJZChkb2MuX2lkKSkgKyAnP3Jldj0nICsgcmV2XG4gICAgfSwgY2FsbGJhY2spO1xuICB9KTtcblxuICAvLyBHZXQgdGhlIGF0dGFjaG1lbnRcbiAgYXBpLmdldEF0dGFjaG1lbnQgPVxuICAgIHV0aWxzLmFkYXB0ZXJGdW4oJ2dldEF0dGFjaG1lbnQnLCBmdW5jdGlvbiAoZG9jSWQsIGF0dGFjaG1lbnRJZCwgb3B0cyxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNhbGxiYWNrKSB7XG4gICAgaWYgKHR5cGVvZiBvcHRzID09PSAnZnVuY3Rpb24nKSB7XG4gICAgICBjYWxsYmFjayA9IG9wdHM7XG4gICAgICBvcHRzID0ge307XG4gICAgfVxuICAgIG9wdHMgPSB1dGlscy5jbG9uZShvcHRzKTtcbiAgICBpZiAob3B0cy5hdXRvX2VuY29kZSA9PT0gdW5kZWZpbmVkKSB7XG4gICAgICBvcHRzLmF1dG9fZW5jb2RlID0gdHJ1ZTtcbiAgICB9XG4gICAgaWYgKG9wdHMuYXV0b19lbmNvZGUpIHtcbiAgICAgIGRvY0lkID0gZW5jb2RlRG9jSWQoZG9jSWQpO1xuICAgIH1cbiAgICBvcHRzLmF1dG9fZW5jb2RlID0gZmFsc2U7XG4gICAgYXBpLmdldChkb2NJZCArICcvJyArIGF0dGFjaG1lbnRJZCwgb3B0cywgY2FsbGJhY2spO1xuICB9KTtcblxuICAvLyBSZW1vdmUgdGhlIGF0dGFjaG1lbnQgZ2l2ZW4gYnkgdGhlIGlkIGFuZCByZXZcbiAgYXBpLnJlbW92ZUF0dGFjaG1lbnQgPVxuICAgIHV0aWxzLmFkYXB0ZXJGdW4oJ3JlbW92ZUF0dGFjaG1lbnQnLCBmdW5jdGlvbiAoZG9jSWQsIGF0dGFjaG1lbnRJZCwgcmV2LFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY2FsbGJhY2spIHtcbiAgICBhamF4KHtcbiAgICAgIGhlYWRlcnM6IGhvc3QuaGVhZGVycyxcbiAgICAgIG1ldGhvZDogJ0RFTEVURScsXG4gICAgICB1cmw6IGdlbkRCVXJsKGhvc3QsIGVuY29kZURvY0lkKGRvY0lkKSArICcvJyArIGF0dGFjaG1lbnRJZCkgKyAnP3Jldj0nICtcbiAgICAgICAgICAgcmV2XG4gICAgfSwgY2FsbGJhY2spO1xuICB9KTtcblxuICAvLyBBZGQgdGhlIGF0dGFjaG1lbnQgZ2l2ZW4gYnkgYmxvYiBhbmQgaXRzIGNvbnRlbnRUeXBlIHByb3BlcnR5XG4gIC8vIHRvIHRoZSBkb2N1bWVudCB3aXRoIHRoZSBnaXZlbiBpZCwgdGhlIHJldmlzaW9uIGdpdmVuIGJ5IHJldiwgYW5kXG4gIC8vIGFkZCBpdCB0byB0aGUgZGF0YWJhc2UgZ2l2ZW4gYnkgaG9zdC5cbiAgYXBpLnB1dEF0dGFjaG1lbnQgPVxuICAgIHV0aWxzLmFkYXB0ZXJGdW4oJ3B1dEF0dGFjaG1lbnQnLCBmdW5jdGlvbiAoZG9jSWQsIGF0dGFjaG1lbnRJZCwgcmV2LCBibG9iLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdHlwZSwgY2FsbGJhY2spIHtcbiAgICBpZiAodHlwZW9mIHR5cGUgPT09ICdmdW5jdGlvbicpIHtcbiAgICAgIGNhbGxiYWNrID0gdHlwZTtcbiAgICAgIHR5cGUgPSBibG9iO1xuICAgICAgYmxvYiA9IHJldjtcbiAgICAgIHJldiA9IG51bGw7XG4gICAgfVxuICAgIGlmICh0eXBlb2YgdHlwZSA9PT0gJ3VuZGVmaW5lZCcpIHtcbiAgICAgIHR5cGUgPSBibG9iO1xuICAgICAgYmxvYiA9IHJldjtcbiAgICAgIHJldiA9IG51bGw7XG4gICAgfVxuICAgIHZhciBpZCA9IGVuY29kZURvY0lkKGRvY0lkKSArICcvJyArIGF0dGFjaG1lbnRJZDtcbiAgICB2YXIgdXJsID0gZ2VuREJVcmwoaG9zdCwgaWQpO1xuICAgIGlmIChyZXYpIHtcbiAgICAgIHVybCArPSAnP3Jldj0nICsgcmV2O1xuICAgIH1cblxuICAgIHZhciBvcHRzID0ge1xuICAgICAgaGVhZGVyczogdXRpbHMuY2xvbmUoaG9zdC5oZWFkZXJzKSxcbiAgICAgIG1ldGhvZDogJ1BVVCcsXG4gICAgICB1cmw6IHVybCxcbiAgICAgIHByb2Nlc3NEYXRhOiBmYWxzZSxcbiAgICAgIGJvZHk6IGJsb2IsXG4gICAgICB0aW1lb3V0OiA2MDAwMFxuICAgIH07XG4gICAgb3B0cy5oZWFkZXJzWydDb250ZW50LVR5cGUnXSA9IHR5cGU7XG4gICAgLy8gQWRkIHRoZSBhdHRhY2htZW50XG4gICAgYWpheChvcHRzLCBjYWxsYmFjayk7XG4gIH0pO1xuXG4gIC8vIEFkZCB0aGUgZG9jdW1lbnQgZ2l2ZW4gYnkgZG9jIChpbiBKU09OIHN0cmluZyBmb3JtYXQpIHRvIHRoZSBkYXRhYmFzZVxuICAvLyBnaXZlbiBieSBob3N0LiBUaGlzIGZhaWxzIGlmIHRoZSBkb2MgaGFzIG5vIF9pZCBmaWVsZC5cbiAgYXBpLnB1dCA9IHV0aWxzLmFkYXB0ZXJGdW4oJ3B1dCcsIHV0aWxzLmdldEFyZ3VtZW50cyhmdW5jdGlvbiAoYXJncykge1xuICAgIHZhciB0ZW1wLCB0ZW1wdHlwZSwgb3B0cztcbiAgICB2YXIgZG9jID0gYXJncy5zaGlmdCgpO1xuICAgIHZhciBpZCA9ICdfaWQnIGluIGRvYztcbiAgICB2YXIgY2FsbGJhY2sgPSBhcmdzLnBvcCgpO1xuICAgIGlmICh0eXBlb2YgZG9jICE9PSAnb2JqZWN0JyB8fCBBcnJheS5pc0FycmF5KGRvYykpIHtcbiAgICAgIHJldHVybiBjYWxsYmFjayhlcnJvcnMuTk9UX0FOX09CSkVDVCk7XG4gICAgfVxuXG4gICAgZG9jID0gdXRpbHMuY2xvbmUoZG9jKTtcblxuICAgIHByZXByb2Nlc3NBdHRhY2htZW50cyhkb2MpLnRoZW4oZnVuY3Rpb24gKCkge1xuICAgICAgd2hpbGUgKHRydWUpIHtcbiAgICAgICAgdGVtcCA9IGFyZ3Muc2hpZnQoKTtcbiAgICAgICAgdGVtcHR5cGUgPSB0eXBlb2YgdGVtcDtcbiAgICAgICAgaWYgKHRlbXB0eXBlID09PSBcInN0cmluZ1wiICYmICFpZCkge1xuICAgICAgICAgIGRvYy5faWQgPSB0ZW1wO1xuICAgICAgICAgIGlkID0gdHJ1ZTtcbiAgICAgICAgfSBlbHNlIGlmICh0ZW1wdHlwZSA9PT0gXCJzdHJpbmdcIiAmJiBpZCAmJiAhKCdfcmV2JyBpbiBkb2MpKSB7XG4gICAgICAgICAgZG9jLl9yZXYgPSB0ZW1wO1xuICAgICAgICB9IGVsc2UgaWYgKHRlbXB0eXBlID09PSBcIm9iamVjdFwiKSB7XG4gICAgICAgICAgb3B0cyA9IHV0aWxzLmNsb25lKHRlbXApO1xuICAgICAgICB9XG4gICAgICAgIGlmICghYXJncy5sZW5ndGgpIHtcbiAgICAgICAgICBicmVhaztcbiAgICAgICAgfVxuICAgICAgfVxuICAgICAgb3B0cyA9IG9wdHMgfHwge307XG4gICAgICB2YXIgZXJyb3IgPSB1dGlscy5pbnZhbGlkSWRFcnJvcihkb2MuX2lkKTtcbiAgICAgIGlmIChlcnJvcikge1xuICAgICAgICB0aHJvdyBlcnJvcjtcbiAgICAgIH1cblxuICAgICAgLy8gTGlzdCBvZiBwYXJhbWV0ZXIgdG8gYWRkIHRvIHRoZSBQVVQgcmVxdWVzdFxuICAgICAgdmFyIHBhcmFtcyA9IFtdO1xuXG4gICAgICAvLyBJZiBpdCBleGlzdHMsIGFkZCB0aGUgb3B0cy5uZXdfZWRpdHMgdmFsdWUgdG8gdGhlIGxpc3Qgb2YgcGFyYW1ldGVycy5cbiAgICAgIC8vIElmIG5ld19lZGl0cyA9IGZhbHNlIHRoZW4gdGhlIGRhdGFiYXNlIHdpbGwgTk9UIGFzc2lnbiB0aGlzIGRvY3VtZW50IGFcbiAgICAgIC8vIG5ldyByZXZpc2lvbiBudW1iZXJcbiAgICAgIGlmIChvcHRzICYmIHR5cGVvZiBvcHRzLm5ld19lZGl0cyAhPT0gJ3VuZGVmaW5lZCcpIHtcbiAgICAgICAgcGFyYW1zLnB1c2goJ25ld19lZGl0cz0nICsgb3B0cy5uZXdfZWRpdHMpO1xuICAgICAgfVxuXG4gICAgICAvLyBGb3JtYXQgdGhlIGxpc3Qgb2YgcGFyYW1ldGVycyBpbnRvIGEgdmFsaWQgVVJJIHF1ZXJ5IHN0cmluZ1xuICAgICAgcGFyYW1zID0gcGFyYW1zLmpvaW4oJyYnKTtcbiAgICAgIGlmIChwYXJhbXMgIT09ICcnKSB7XG4gICAgICAgIHBhcmFtcyA9ICc/JyArIHBhcmFtcztcbiAgICAgIH1cblxuICAgICAgLy8gQWRkIHRoZSBkb2N1bWVudFxuICAgICAgYWpheCh7XG4gICAgICAgIGhlYWRlcnM6IGhvc3QuaGVhZGVycyxcbiAgICAgICAgbWV0aG9kOiAnUFVUJyxcbiAgICAgICAgdXJsOiBnZW5EQlVybChob3N0LCBlbmNvZGVEb2NJZChkb2MuX2lkKSkgKyBwYXJhbXMsXG4gICAgICAgIGJvZHk6IGRvY1xuICAgICAgfSwgZnVuY3Rpb24gKGVyciwgcmVzKSB7XG4gICAgICAgIGlmIChlcnIpIHtcbiAgICAgICAgICByZXR1cm4gY2FsbGJhY2soZXJyKTtcbiAgICAgICAgfVxuICAgICAgICByZXMub2sgPSB0cnVlO1xuICAgICAgICBjYWxsYmFjayhudWxsLCByZXMpO1xuICAgICAgfSk7XG4gICAgfSlbXCJjYXRjaFwiXShjYWxsYmFjayk7XG5cbiAgfSkpO1xuXG4gIC8vIEFkZCB0aGUgZG9jdW1lbnQgZ2l2ZW4gYnkgZG9jIChpbiBKU09OIHN0cmluZyBmb3JtYXQpIHRvIHRoZSBkYXRhYmFzZVxuICAvLyBnaXZlbiBieSBob3N0LiBUaGlzIGRvZXMgbm90IGFzc3VtZSB0aGF0IGRvYyBpcyBhIG5ldyBkb2N1bWVudCBcbiAgLy8gKGkuZS4gZG9lcyBub3QgaGF2ZSBhIF9pZCBvciBhIF9yZXYgZmllbGQuKVxuICBhcGkucG9zdCA9IHV0aWxzLmFkYXB0ZXJGdW4oJ3Bvc3QnLCBmdW5jdGlvbiAoZG9jLCBvcHRzLCBjYWxsYmFjaykge1xuICAgIC8vIElmIG5vIG9wdGlvbnMgd2VyZSBnaXZlbiwgc2V0IHRoZSBjYWxsYmFjayB0byBiZSB0aGUgc2Vjb25kIHBhcmFtZXRlclxuICAgIGlmICh0eXBlb2Ygb3B0cyA9PT0gJ2Z1bmN0aW9uJykge1xuICAgICAgY2FsbGJhY2sgPSBvcHRzO1xuICAgICAgb3B0cyA9IHt9O1xuICAgIH1cbiAgICBvcHRzID0gdXRpbHMuY2xvbmUob3B0cyk7XG4gICAgaWYgKHR5cGVvZiBkb2MgIT09ICdvYmplY3QnKSB7XG4gICAgICByZXR1cm4gY2FsbGJhY2soZXJyb3JzLk5PVF9BTl9PQkpFQ1QpO1xuICAgIH1cbiAgICBpZiAoISAoXCJfaWRcIiBpbiBkb2MpKSB7XG4gICAgICBkb2MuX2lkID0gdXRpbHMudXVpZCgpO1xuICAgIH1cbiAgICBhcGkucHV0KGRvYywgb3B0cywgZnVuY3Rpb24gKGVyciwgcmVzKSB7XG4gICAgICBpZiAoZXJyKSB7XG4gICAgICAgIHJldHVybiBjYWxsYmFjayhlcnIpO1xuICAgICAgfVxuICAgICAgcmVzLm9rID0gdHJ1ZTtcbiAgICAgIGNhbGxiYWNrKG51bGwsIHJlcyk7XG4gICAgfSk7XG4gIH0pO1xuXG4gIC8vIFVwZGF0ZS9jcmVhdGUgbXVsdGlwbGUgZG9jdW1lbnRzIGdpdmVuIGJ5IHJlcSBpbiB0aGUgZGF0YWJhc2VcbiAgLy8gZ2l2ZW4gYnkgaG9zdC5cbiAgYXBpLl9idWxrRG9jcyA9IGZ1bmN0aW9uIChyZXEsIG9wdHMsIGNhbGxiYWNrKSB7XG4gICAgLy8gSWYgb3B0cy5uZXdfZWRpdHMgZXhpc3RzIGFkZCBpdCB0byB0aGUgZG9jdW1lbnQgZGF0YSB0byBiZVxuICAgIC8vIHNlbmQgdG8gdGhlIGRhdGFiYXNlLlxuICAgIC8vIElmIG5ld19lZGl0cz1mYWxzZSB0aGVuIGl0IHByZXZlbnRzIHRoZSBkYXRhYmFzZSBmcm9tIGNyZWF0aW5nXG4gICAgLy8gbmV3IHJldmlzaW9uIG51bWJlcnMgZm9yIHRoZSBkb2N1bWVudHMuIEluc3RlYWQgaXQganVzdCB1c2VzXG4gICAgLy8gdGhlIG9sZCBvbmVzLiBUaGlzIGlzIHVzZWQgaW4gZGF0YWJhc2UgcmVwbGljYXRpb24uXG4gICAgaWYgKHR5cGVvZiBvcHRzLm5ld19lZGl0cyAhPT0gJ3VuZGVmaW5lZCcpIHtcbiAgICAgIHJlcS5uZXdfZWRpdHMgPSBvcHRzLm5ld19lZGl0cztcbiAgICB9XG5cbiAgICB1dGlscy5Qcm9taXNlLmFsbChyZXEuZG9jcy5tYXAocHJlcHJvY2Vzc0F0dGFjaG1lbnRzKSkudGhlbihmdW5jdGlvbiAoKSB7XG4gICAgICAvLyBVcGRhdGUvY3JlYXRlIHRoZSBkb2N1bWVudHNcbiAgICAgIGFqYXgoe1xuICAgICAgICBoZWFkZXJzOiBob3N0LmhlYWRlcnMsXG4gICAgICAgIG1ldGhvZDogJ1BPU1QnLFxuICAgICAgICB1cmw6IGdlbkRCVXJsKGhvc3QsICdfYnVsa19kb2NzJyksXG4gICAgICAgIGJvZHk6IHJlcVxuICAgICAgfSwgZnVuY3Rpb24gKGVyciwgcmVzdWx0cykge1xuICAgICAgICBpZiAoZXJyKSB7XG4gICAgICAgICAgcmV0dXJuIGNhbGxiYWNrKGVycik7XG4gICAgICAgIH1cbiAgICAgICAgcmVzdWx0cy5mb3JFYWNoKGZ1bmN0aW9uIChyZXN1bHQpIHtcbiAgICAgICAgICByZXN1bHQub2sgPSB0cnVlOyAvLyBzbW9vdGhzIG91dCBjbG91ZGFudCBub3QgYWRkaW5nIHRoaXNcbiAgICAgICAgfSk7XG4gICAgICAgIGNhbGxiYWNrKG51bGwsIHJlc3VsdHMpO1xuICAgICAgfSk7XG4gICAgfSlbXCJjYXRjaFwiXShjYWxsYmFjayk7XG4gIH07XG5cbiAgLy8gR2V0IGEgbGlzdGluZyBvZiB0aGUgZG9jdW1lbnRzIGluIHRoZSBkYXRhYmFzZSBnaXZlblxuICAvLyBieSBob3N0IGFuZCBvcmRlcmVkIGJ5IGluY3JlYXNpbmcgaWQuXG4gIGFwaS5hbGxEb2NzID0gdXRpbHMuYWRhcHRlckZ1bignYWxsRG9jcycsIGZ1bmN0aW9uIChvcHRzLCBjYWxsYmFjaykge1xuICAgIGlmICh0eXBlb2Ygb3B0cyA9PT0gJ2Z1bmN0aW9uJykge1xuICAgICAgY2FsbGJhY2sgPSBvcHRzO1xuICAgICAgb3B0cyA9IHt9O1xuICAgIH1cbiAgICBvcHRzID0gdXRpbHMuY2xvbmUob3B0cyk7XG4gICAgLy8gTGlzdCBvZiBwYXJhbWV0ZXJzIHRvIGFkZCB0byB0aGUgR0VUIHJlcXVlc3RcbiAgICB2YXIgcGFyYW1zID0gW107XG4gICAgdmFyIGJvZHk7XG4gICAgdmFyIG1ldGhvZCA9ICdHRVQnO1xuXG4gICAgLy8gVE9ETyBJIGRvbid0IHNlZSBjb25mbGljdHMgYXMgYSB2YWxpZCBwYXJhbWV0ZXIgZm9yIGFcbiAgICAvLyBfYWxsX2RvY3MgcmVxdWVzdCBcbiAgICAvLyAoc2VlIGh0dHA6Ly93aWtpLmFwYWNoZS5vcmcvY291Y2hkYi9IVFRQX0RvY3VtZW50X0FQSSNhbGxfZG9jcylcbiAgICBpZiAob3B0cy5jb25mbGljdHMpIHtcbiAgICAgIHBhcmFtcy5wdXNoKCdjb25mbGljdHM9dHJ1ZScpO1xuICAgIH1cblxuICAgIC8vIElmIG9wdHMuZGVzY2VuZGluZyBpcyB0cnV0aHkgYWRkIGl0IHRvIHBhcmFtc1xuICAgIGlmIChvcHRzLmRlc2NlbmRpbmcpIHtcbiAgICAgIHBhcmFtcy5wdXNoKCdkZXNjZW5kaW5nPXRydWUnKTtcbiAgICB9XG5cbiAgICAvLyBJZiBvcHRzLmluY2x1ZGVfZG9jcyBleGlzdHMsIGFkZCB0aGUgaW5jbHVkZV9kb2NzIHZhbHVlIHRvIHRoZVxuICAgIC8vIGxpc3Qgb2YgcGFyYW1ldGVycy5cbiAgICAvLyBJZiBpbmNsdWRlX2RvY3M9dHJ1ZSB0aGVuIGluY2x1ZGUgdGhlIGFzc29jaWF0ZWQgZG9jdW1lbnQgd2l0aCBlYWNoXG4gICAgLy8gcmVzdWx0LlxuICAgIGlmIChvcHRzLmluY2x1ZGVfZG9jcykge1xuICAgICAgcGFyYW1zLnB1c2goJ2luY2x1ZGVfZG9jcz10cnVlJyk7XG4gICAgfVxuXG4gICAgaWYgKG9wdHMua2V5KSB7XG4gICAgICBwYXJhbXMucHVzaCgna2V5PScgKyBlbmNvZGVVUklDb21wb25lbnQoSlNPTi5zdHJpbmdpZnkob3B0cy5rZXkpKSk7XG4gICAgfVxuXG4gICAgLy8gSWYgb3B0cy5zdGFydGtleSBleGlzdHMsIGFkZCB0aGUgc3RhcnRrZXkgdmFsdWUgdG8gdGhlIGxpc3Qgb2ZcbiAgICAvLyBwYXJhbWV0ZXJzLlxuICAgIC8vIElmIHN0YXJ0a2V5IGlzIGdpdmVuIHRoZW4gdGhlIHJldHVybmVkIGxpc3Qgb2YgZG9jdW1lbnRzIHdpbGxcbiAgICAvLyBzdGFydCB3aXRoIHRoZSBkb2N1bWVudCB3aG9zZSBpZCBpcyBzdGFydGtleS5cbiAgICBpZiAob3B0cy5zdGFydGtleSkge1xuICAgICAgcGFyYW1zLnB1c2goJ3N0YXJ0a2V5PScgK1xuICAgICAgICBlbmNvZGVVUklDb21wb25lbnQoSlNPTi5zdHJpbmdpZnkob3B0cy5zdGFydGtleSkpKTtcbiAgICB9XG5cbiAgICAvLyBJZiBvcHRzLmVuZGtleSBleGlzdHMsIGFkZCB0aGUgZW5ka2V5IHZhbHVlIHRvIHRoZSBsaXN0IG9mIHBhcmFtZXRlcnMuXG4gICAgLy8gSWYgZW5ka2V5IGlzIGdpdmVuIHRoZW4gdGhlIHJldHVybmVkIGxpc3Qgb2YgZG9jdWVtbnRzIHdpbGxcbiAgICAvLyBlbmQgd2l0aCB0aGUgZG9jdW1lbnQgd2hvc2UgaWQgaXMgZW5ka2V5LlxuICAgIGlmIChvcHRzLmVuZGtleSkge1xuICAgICAgcGFyYW1zLnB1c2goJ2VuZGtleT0nICsgZW5jb2RlVVJJQ29tcG9uZW50KEpTT04uc3RyaW5naWZ5KG9wdHMuZW5ka2V5KSkpO1xuICAgIH1cblxuICAgIGlmICh0eXBlb2Ygb3B0cy5pbmNsdXNpdmVfZW5kICE9PSAndW5kZWZpbmVkJykge1xuICAgICAgcGFyYW1zLnB1c2goJ2luY2x1c2l2ZV9lbmQ9JyArICEhb3B0cy5pbmNsdXNpdmVfZW5kKTtcbiAgICB9XG5cbiAgICAvLyBJZiBvcHRzLmxpbWl0IGV4aXN0cywgYWRkIHRoZSBsaW1pdCB2YWx1ZSB0byB0aGUgcGFyYW1ldGVyIGxpc3QuXG4gICAgaWYgKHR5cGVvZiBvcHRzLmxpbWl0ICE9PSAndW5kZWZpbmVkJykge1xuICAgICAgcGFyYW1zLnB1c2goJ2xpbWl0PScgKyBvcHRzLmxpbWl0KTtcbiAgICB9XG5cbiAgICBpZiAodHlwZW9mIG9wdHMuc2tpcCAhPT0gJ3VuZGVmaW5lZCcpIHtcbiAgICAgIHBhcmFtcy5wdXNoKCdza2lwPScgKyBvcHRzLnNraXApO1xuICAgIH1cblxuICAgIC8vIEZvcm1hdCB0aGUgbGlzdCBvZiBwYXJhbWV0ZXJzIGludG8gYSB2YWxpZCBVUkkgcXVlcnkgc3RyaW5nXG4gICAgcGFyYW1zID0gcGFyYW1zLmpvaW4oJyYnKTtcbiAgICBpZiAocGFyYW1zICE9PSAnJykge1xuICAgICAgcGFyYW1zID0gJz8nICsgcGFyYW1zO1xuICAgIH1cblxuICAgIGlmICh0eXBlb2Ygb3B0cy5rZXlzICE9PSAndW5kZWZpbmVkJykge1xuXG4gICAgICB2YXIgTUFYX1VSTF9MRU5HVEggPSAyMDAwO1xuICAgICAgLy8gYWNjb3JkaW5nIHRvIGh0dHA6Ly9zdGFja292ZXJmbG93LmNvbS9hLzQxNzE4NC82ODA3NDIsXG4gICAgICAvLyB0aGUgZGUgZmFjdG9yIFVSTCBsZW5ndGggbGltaXQgaXMgMjAwMCBjaGFyYWN0ZXJzXG5cbiAgICAgIHZhciBrZXlzQXNTdHJpbmcgPVxuICAgICAgICAna2V5cz0nICsgZW5jb2RlVVJJQ29tcG9uZW50KEpTT04uc3RyaW5naWZ5KG9wdHMua2V5cykpO1xuICAgICAgaWYgKGtleXNBc1N0cmluZy5sZW5ndGggKyBwYXJhbXMubGVuZ3RoICsgMSA8PSBNQVhfVVJMX0xFTkdUSCkge1xuICAgICAgICAvLyBJZiB0aGUga2V5cyBhcmUgc2hvcnQgZW5vdWdoLCBkbyBhIEdFVC4gd2UgZG8gdGhpcyB0byB3b3JrIGFyb3VuZFxuICAgICAgICAvLyBTYWZhcmkgbm90IHVuZGVyc3RhbmRpbmcgMzA0cyBvbiBQT1NUcyAoc2VlIGlzc3VlICMxMjM5KVxuICAgICAgICBwYXJhbXMgKz0gKHBhcmFtcy5pbmRleE9mKCc/JykgIT09IC0xID8gJyYnIDogJz8nKSArIGtleXNBc1N0cmluZztcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIC8vIElmIGtleXMgYXJlIHRvbyBsb25nLCBpc3N1ZSBhIFBPU1QgcmVxdWVzdCB0byBjaXJjdW12ZW50IEdFVFxuICAgICAgICAvLyBxdWVyeSBzdHJpbmcgbGltaXRzXG4gICAgICAgIC8vIHNlZSBodHRwOi8vd2lraS5hcGFjaGUub3JnL2NvdWNoZGIvSFRUUF92aWV3X0FQSSNRdWVyeWluZ19PcHRpb25zXG4gICAgICAgIG1ldGhvZCA9ICdQT1NUJztcbiAgICAgICAgYm9keSA9IEpTT04uc3RyaW5naWZ5KHtrZXlzOiBvcHRzLmtleXN9KTtcbiAgICAgIH1cbiAgICB9XG5cbiAgICAvLyBHZXQgdGhlIGRvY3VtZW50IGxpc3RpbmdcbiAgICBhamF4KHtcbiAgICAgIGhlYWRlcnM6IGhvc3QuaGVhZGVycyxcbiAgICAgIG1ldGhvZDogbWV0aG9kLFxuICAgICAgdXJsOiBnZW5EQlVybChob3N0LCAnX2FsbF9kb2NzJyArIHBhcmFtcyksXG4gICAgICBib2R5OiBib2R5XG4gICAgfSwgY2FsbGJhY2spO1xuICB9KTtcblxuICAvLyBHZXQgYSBsaXN0IG9mIGNoYW5nZXMgbWFkZSB0byBkb2N1bWVudHMgaW4gdGhlIGRhdGFiYXNlIGdpdmVuIGJ5IGhvc3QuXG4gIC8vIFRPRE8gQWNjb3JkaW5nIHRvIHRoZSBSRUFETUUsIHRoZXJlIHNob3VsZCBiZSB0d28gb3RoZXIgbWV0aG9kcyBoZXJlLFxuICAvLyBhcGkuY2hhbmdlcy5hZGRMaXN0ZW5lciBhbmQgYXBpLmNoYW5nZXMucmVtb3ZlTGlzdGVuZXIuXG4gIGFwaS5fY2hhbmdlcyA9IGZ1bmN0aW9uIChvcHRzKSB7XG4gICAgLy8gV2UgaW50ZXJuYWxseSBwYWdlIHRoZSByZXN1bHRzIG9mIGEgY2hhbmdlcyByZXF1ZXN0LCB0aGlzIG1lYW5zXG4gICAgLy8gaWYgdGhlcmUgaXMgYSBsYXJnZSBzZXQgb2YgY2hhbmdlcyB0byBiZSByZXR1cm5lZCB3ZSBjYW4gc3RhcnRcbiAgICAvLyBwcm9jZXNzaW5nIHRoZW0gcXVpY2tlciBpbnN0ZWFkIG9mIHdhaXRpbmcgb24gdGhlIGVudGlyZVxuICAgIC8vIHNldCBvZiBjaGFuZ2VzIHRvIHJldHVybiBhbmQgYXR0ZW1wdGluZyB0byBwcm9jZXNzIHRoZW0gYXQgb25jZVxuICAgIHZhciBiYXRjaFNpemUgPSAnYmF0Y2hfc2l6ZScgaW4gb3B0cyA/IG9wdHMuYmF0Y2hfc2l6ZSA6IENIQU5HRVNfQkFUQ0hfU0laRTtcblxuICAgIG9wdHMgPSB1dGlscy5jbG9uZShvcHRzKTtcbiAgICBvcHRzLnRpbWVvdXQgPSBvcHRzLnRpbWVvdXQgfHwgMzAgKiAxMDAwO1xuXG4gICAgLy8gV2UgZ2l2ZSBhIDUgc2Vjb25kIGJ1ZmZlciBmb3IgQ291Y2hEQiBjaGFuZ2VzIHRvIHJlc3BvbmQgd2l0aFxuICAgIC8vIGFuIG9rIHRpbWVvdXRcbiAgICB2YXIgcGFyYW1zID0geyB0aW1lb3V0OiBvcHRzLnRpbWVvdXQgLSAoNSAqIDEwMDApIH07XG4gICAgdmFyIGxpbWl0ID0gKHR5cGVvZiBvcHRzLmxpbWl0ICE9PSAndW5kZWZpbmVkJykgPyBvcHRzLmxpbWl0IDogZmFsc2U7XG4gICAgaWYgKGxpbWl0ID09PSAwKSB7XG4gICAgICBsaW1pdCA9IDE7XG4gICAgfVxuICAgIHZhciByZXR1cm5Eb2NzO1xuICAgIGlmICgncmV0dXJuRG9jcycgaW4gb3B0cykge1xuICAgICAgcmV0dXJuRG9jcyA9IG9wdHMucmV0dXJuRG9jcztcbiAgICB9IGVsc2Uge1xuICAgICAgcmV0dXJuRG9jcyA9IHRydWU7XG4gICAgfVxuICAgIC8vXG4gICAgdmFyIGxlZnRUb0ZldGNoID0gbGltaXQ7XG5cbiAgICBpZiAob3B0cy5zdHlsZSkge1xuICAgICAgcGFyYW1zLnN0eWxlID0gb3B0cy5zdHlsZTtcbiAgICB9XG5cbiAgICBpZiAob3B0cy5pbmNsdWRlX2RvY3MgfHwgb3B0cy5maWx0ZXIgJiYgdHlwZW9mIG9wdHMuZmlsdGVyID09PSAnZnVuY3Rpb24nKSB7XG4gICAgICBwYXJhbXMuaW5jbHVkZV9kb2NzID0gdHJ1ZTtcbiAgICB9XG5cbiAgICBpZiAob3B0cy5jb250aW51b3VzKSB7XG4gICAgICBwYXJhbXMuZmVlZCA9ICdsb25ncG9sbCc7XG4gICAgfVxuXG4gICAgaWYgKG9wdHMuY29uZmxpY3RzKSB7XG4gICAgICBwYXJhbXMuY29uZmxpY3RzID0gdHJ1ZTtcbiAgICB9XG5cbiAgICBpZiAob3B0cy5kZXNjZW5kaW5nKSB7XG4gICAgICBwYXJhbXMuZGVzY2VuZGluZyA9IHRydWU7XG4gICAgfVxuXG4gICAgaWYgKG9wdHMuZmlsdGVyICYmIHR5cGVvZiBvcHRzLmZpbHRlciA9PT0gJ3N0cmluZycpIHtcbiAgICAgIHBhcmFtcy5maWx0ZXIgPSBvcHRzLmZpbHRlcjtcbiAgICAgIGlmIChvcHRzLmZpbHRlciA9PT0gJ192aWV3JyAmJlxuICAgICAgICAgIG9wdHMudmlldyAmJlxuICAgICAgICAgIHR5cGVvZiBvcHRzLnZpZXcgPT09ICdzdHJpbmcnKSB7XG4gICAgICAgIHBhcmFtcy52aWV3ID0gb3B0cy52aWV3O1xuICAgICAgfVxuICAgIH1cblxuICAgIC8vIElmIG9wdHMucXVlcnlfcGFyYW1zIGV4aXN0cywgcGFzcyBpdCB0aHJvdWdoIHRvIHRoZSBjaGFuZ2VzIHJlcXVlc3QuXG4gICAgLy8gVGhlc2UgcGFyYW1ldGVycyBtYXkgYmUgdXNlZCBieSB0aGUgZmlsdGVyIG9uIHRoZSBzb3VyY2UgZGF0YWJhc2UuXG4gICAgaWYgKG9wdHMucXVlcnlfcGFyYW1zICYmIHR5cGVvZiBvcHRzLnF1ZXJ5X3BhcmFtcyA9PT0gJ29iamVjdCcpIHtcbiAgICAgIGZvciAodmFyIHBhcmFtX25hbWUgaW4gb3B0cy5xdWVyeV9wYXJhbXMpIHtcbiAgICAgICAgaWYgKG9wdHMucXVlcnlfcGFyYW1zLmhhc093blByb3BlcnR5KHBhcmFtX25hbWUpKSB7XG4gICAgICAgICAgcGFyYW1zW3BhcmFtX25hbWVdID0gb3B0cy5xdWVyeV9wYXJhbXNbcGFyYW1fbmFtZV07XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9XG5cbiAgICB2YXIgeGhyO1xuICAgIHZhciBsYXN0RmV0Y2hlZFNlcTtcblxuICAgIC8vIEdldCBhbGwgdGhlIGNoYW5nZXMgc3RhcnRpbmcgd3RpaCB0aGUgb25lIGltbWVkaWF0ZWx5IGFmdGVyIHRoZVxuICAgIC8vIHNlcXVlbmNlIG51bWJlciBnaXZlbiBieSBzaW5jZS5cbiAgICB2YXIgZmV0Y2ggPSBmdW5jdGlvbiAoc2luY2UsIGNhbGxiYWNrKSB7XG4gICAgICBpZiAob3B0cy5hYm9ydGVkKSB7XG4gICAgICAgIHJldHVybjtcbiAgICAgIH1cbiAgICAgIHBhcmFtcy5zaW5jZSA9IHNpbmNlO1xuICAgICAgaWYgKG9wdHMuZGVzY2VuZGluZykge1xuICAgICAgICBpZiAobGltaXQpIHtcbiAgICAgICAgICBwYXJhbXMubGltaXQgPSBsZWZ0VG9GZXRjaDtcbiAgICAgICAgfVxuICAgICAgfSBlbHNlIHtcbiAgICAgICAgcGFyYW1zLmxpbWl0ID0gKCFsaW1pdCB8fCBsZWZ0VG9GZXRjaCA+IGJhdGNoU2l6ZSkgP1xuICAgICAgICAgIGJhdGNoU2l6ZSA6IGxlZnRUb0ZldGNoO1xuICAgICAgfVxuXG4gICAgICB2YXIgcGFyYW1TdHIgPSAnPycgKyBPYmplY3Qua2V5cyhwYXJhbXMpLm1hcChmdW5jdGlvbiAoaykge1xuICAgICAgICByZXR1cm4gayArICc9JyArIHBhcmFtc1trXTtcbiAgICAgIH0pLmpvaW4oJyYnKTtcblxuICAgICAgLy8gU2V0IHRoZSBvcHRpb25zIGZvciB0aGUgYWpheCBjYWxsXG4gICAgICB2YXIgeGhyT3B0cyA9IHtcbiAgICAgICAgaGVhZGVyczogaG9zdC5oZWFkZXJzLFxuICAgICAgICBtZXRob2Q6ICdHRVQnLFxuICAgICAgICB1cmw6IGdlbkRCVXJsKGhvc3QsICdfY2hhbmdlcycgKyBwYXJhbVN0ciksXG4gICAgICAgIC8vIF9jaGFuZ2VzIGNhbiB0YWtlIGEgbG9uZyB0aW1lIHRvIGdlbmVyYXRlLCBlc3BlY2lhbGx5IHdoZW4gZmlsdGVyZWRcbiAgICAgICAgdGltZW91dDogb3B0cy50aW1lb3V0XG4gICAgICB9O1xuICAgICAgbGFzdEZldGNoZWRTZXEgPSBzaW5jZTtcblxuICAgICAgaWYgKG9wdHMuYWJvcnRlZCkge1xuICAgICAgICByZXR1cm47XG4gICAgICB9XG5cbiAgICAgIC8vIEdldCB0aGUgY2hhbmdlc1xuICAgICAgeGhyID0gYWpheCh4aHJPcHRzLCBjYWxsYmFjayk7XG4gICAgfTtcblxuICAgIC8vIElmIG9wdHMuc2luY2UgZXhpc3RzLCBnZXQgYWxsIHRoZSBjaGFuZ2VzIGZyb20gdGhlIHNlcXVlbmNlXG4gICAgLy8gbnVtYmVyIGdpdmVuIGJ5IG9wdHMuc2luY2UuIE90aGVyd2lzZSwgZ2V0IGFsbCB0aGUgY2hhbmdlc1xuICAgIC8vIGZyb20gdGhlIHNlcXVlbmNlIG51bWJlciAwLlxuICAgIHZhciBmZXRjaFRpbWVvdXQgPSAxMDtcbiAgICB2YXIgZmV0Y2hSZXRyeUNvdW50ID0gMDtcblxuICAgIHZhciByZXN1bHRzID0ge3Jlc3VsdHM6IFtdfTtcblxuICAgIHZhciBmZXRjaGVkID0gZnVuY3Rpb24gKGVyciwgcmVzKSB7XG4gICAgICBpZiAob3B0cy5hYm9ydGVkKSB7XG4gICAgICAgIHJldHVybjtcbiAgICAgIH1cbiAgICAgIHZhciByYXdfcmVzdWx0c19sZW5ndGggPSAwO1xuICAgICAgLy8gSWYgdGhlIHJlc3VsdCBvZiB0aGUgYWpheCBjYWxsIChyZXMpIGNvbnRhaW5zIGNoYW5nZXMgKHJlcy5yZXN1bHRzKVxuICAgICAgaWYgKHJlcyAmJiByZXMucmVzdWx0cykge1xuICAgICAgICByYXdfcmVzdWx0c19sZW5ndGggPSByZXMucmVzdWx0cy5sZW5ndGg7XG4gICAgICAgIHJlc3VsdHMubGFzdF9zZXEgPSByZXMubGFzdF9zZXE7XG4gICAgICAgIC8vIEZvciBlYWNoIGNoYW5nZVxuICAgICAgICB2YXIgcmVxID0ge307XG4gICAgICAgIHJlcS5xdWVyeSA9IG9wdHMucXVlcnlfcGFyYW1zO1xuICAgICAgICByZXMucmVzdWx0cyA9IHJlcy5yZXN1bHRzLmZpbHRlcihmdW5jdGlvbiAoYykge1xuICAgICAgICAgIGxlZnRUb0ZldGNoLS07XG4gICAgICAgICAgdmFyIHJldCA9IHV0aWxzLmZpbHRlckNoYW5nZShvcHRzKShjKTtcbiAgICAgICAgICBpZiAocmV0KSB7XG4gICAgICAgICAgICBpZiAocmV0dXJuRG9jcykge1xuICAgICAgICAgICAgICByZXN1bHRzLnJlc3VsdHMucHVzaChjKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHV0aWxzLmNhbGwob3B0cy5vbkNoYW5nZSwgYyk7XG4gICAgICAgICAgfVxuICAgICAgICAgIHJldHVybiByZXQ7XG4gICAgICAgIH0pO1xuICAgICAgfSBlbHNlIGlmIChlcnIpIHtcbiAgICAgICAgLy8gSW4gY2FzZSBvZiBhbiBlcnJvciwgc3RvcCBsaXN0ZW5pbmcgZm9yIGNoYW5nZXMgYW5kIGNhbGxcbiAgICAgICAgLy8gb3B0cy5jb21wbGV0ZVxuICAgICAgICBvcHRzLmFib3J0ZWQgPSB0cnVlO1xuICAgICAgICB1dGlscy5jYWxsKG9wdHMuY29tcGxldGUsIGVycik7XG4gICAgICAgIHJldHVybjtcbiAgICAgIH1cblxuICAgICAgLy8gVGhlIGNoYW5nZXMgZmVlZCBtYXkgaGF2ZSB0aW1lZCBvdXQgd2l0aCBubyByZXN1bHRzXG4gICAgICAvLyBpZiBzbyByZXVzZSBsYXN0IHVwZGF0ZSBzZXF1ZW5jZVxuICAgICAgaWYgKHJlcyAmJiByZXMubGFzdF9zZXEpIHtcbiAgICAgICAgbGFzdEZldGNoZWRTZXEgPSByZXMubGFzdF9zZXE7XG4gICAgICB9XG5cbiAgICAgIHZhciBmaW5pc2hlZCA9IChsaW1pdCAmJiBsZWZ0VG9GZXRjaCA8PSAwKSB8fFxuICAgICAgICAocmVzICYmIHJhd19yZXN1bHRzX2xlbmd0aCA8IGJhdGNoU2l6ZSkgfHxcbiAgICAgICAgKG9wdHMuZGVzY2VuZGluZyk7XG5cbiAgICAgIGlmICgob3B0cy5jb250aW51b3VzICYmICEobGltaXQgJiYgbGVmdFRvRmV0Y2ggPD0gMCkpIHx8ICFmaW5pc2hlZCkge1xuICAgICAgICAvLyBJbmNyZWFzZSByZXRyeSBkZWxheSBleHBvbmVudGlhbGx5IGFzIGxvbmcgYXMgZXJyb3JzIHBlcnNpc3RcbiAgICAgICAgaWYgKGVycikge1xuICAgICAgICAgIGZldGNoUmV0cnlDb3VudCArPSAxO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgIGZldGNoUmV0cnlDb3VudCA9IDA7XG4gICAgICAgIH1cbiAgICAgICAgdmFyIHRpbWVvdXRNdWx0aXBsaWVyID0gMSA8PCBmZXRjaFJldHJ5Q291bnQ7XG4gICAgICAgIHZhciByZXRyeVdhaXQgPSBmZXRjaFRpbWVvdXQgKiB0aW1lb3V0TXVsdGlwbGllcjtcbiAgICAgICAgdmFyIG1heGltdW1XYWl0ID0gb3B0cy5tYXhpbXVtV2FpdCB8fCAzMDAwMDtcblxuICAgICAgICBpZiAocmV0cnlXYWl0ID4gbWF4aW11bVdhaXQpIHtcbiAgICAgICAgICB1dGlscy5jYWxsKG9wdHMuY29tcGxldGUsIGVyciB8fCBlcnJvcnMuVU5LTk9XTl9FUlJPUik7XG4gICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG5cbiAgICAgICAgLy8gUXVldWUgYSBjYWxsIHRvIGZldGNoIGFnYWluIHdpdGggdGhlIG5ld2VzdCBzZXF1ZW5jZSBudW1iZXJcbiAgICAgICAgc2V0VGltZW91dChmdW5jdGlvbiAoKSB7IGZldGNoKGxhc3RGZXRjaGVkU2VxLCBmZXRjaGVkKTsgfSwgcmV0cnlXYWl0KTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIC8vIFdlJ3JlIGRvbmUsIGNhbGwgdGhlIGNhbGxiYWNrXG4gICAgICAgIHV0aWxzLmNhbGwob3B0cy5jb21wbGV0ZSwgbnVsbCwgcmVzdWx0cyk7XG4gICAgICB9XG4gICAgfTtcblxuICAgIGZldGNoKG9wdHMuc2luY2UgfHwgMCwgZmV0Y2hlZCk7XG5cbiAgICAvLyBSZXR1cm4gYSBtZXRob2QgdG8gY2FuY2VsIHRoaXMgbWV0aG9kIGZyb20gcHJvY2Vzc2luZyBhbnkgbW9yZVxuICAgIHJldHVybiB7XG4gICAgICBjYW5jZWw6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgb3B0cy5hYm9ydGVkID0gdHJ1ZTtcbiAgICAgICAgaWYgKHhocikge1xuICAgICAgICAgIHhoci5hYm9ydCgpO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgfTtcbiAgfTtcblxuICAvLyBHaXZlbiBhIHNldCBvZiBkb2N1bWVudC9yZXZpc2lvbiBJRHMgKGdpdmVuIGJ5IHJlcSksIHRldHMgdGhlIHN1YnNldCBvZlxuICAvLyB0aG9zZSB0aGF0IGRvIE5PVCBjb3JyZXNwb25kIHRvIHJldmlzaW9ucyBzdG9yZWQgaW4gdGhlIGRhdGFiYXNlLlxuICAvLyBTZWUgaHR0cDovL3dpa2kuYXBhY2hlLm9yZy9jb3VjaGRiL0h0dHBQb3N0UmV2c0RpZmZcbiAgYXBpLnJldnNEaWZmID0gdXRpbHMuYWRhcHRlckZ1bigncmV2c0RpZmYnLCBmdW5jdGlvbiAocmVxLCBvcHRzLCBjYWxsYmFjaykge1xuICAgIC8vIElmIG5vIG9wdGlvbnMgd2VyZSBnaXZlbiwgc2V0IHRoZSBjYWxsYmFjayB0byBiZSB0aGUgc2Vjb25kIHBhcmFtZXRlclxuICAgIGlmICh0eXBlb2Ygb3B0cyA9PT0gJ2Z1bmN0aW9uJykge1xuICAgICAgY2FsbGJhY2sgPSBvcHRzO1xuICAgICAgb3B0cyA9IHt9O1xuICAgIH1cblxuICAgIC8vIEdldCB0aGUgbWlzc2luZyBkb2N1bWVudC9yZXZpc2lvbiBJRHNcbiAgICBhamF4KHtcbiAgICAgIGhlYWRlcnM6IGhvc3QuaGVhZGVycyxcbiAgICAgIG1ldGhvZDogJ1BPU1QnLFxuICAgICAgdXJsOiBnZW5EQlVybChob3N0LCAnX3JldnNfZGlmZicpLFxuICAgICAgYm9keTogSlNPTi5zdHJpbmdpZnkocmVxKVxuICAgIH0sIGNhbGxiYWNrKTtcbiAgfSk7XG5cbiAgYXBpLl9jbG9zZSA9IGZ1bmN0aW9uIChjYWxsYmFjaykge1xuICAgIGNhbGxiYWNrKCk7XG4gIH07XG5cbiAgYXBpLmRlc3Ryb3kgPSB1dGlscy5hZGFwdGVyRnVuKCdkZXN0cm95JywgZnVuY3Rpb24gKGNhbGxiYWNrKSB7XG4gICAgYWpheCh7XG4gICAgICB1cmw6IGdlbkRCVXJsKGhvc3QsICcnKSxcbiAgICAgIG1ldGhvZDogJ0RFTEVURScsXG4gICAgICBoZWFkZXJzOiBob3N0LmhlYWRlcnNcbiAgICB9LCBmdW5jdGlvbiAoZXJyLCByZXNwKSB7XG4gICAgICBpZiAoZXJyKSB7XG4gICAgICAgIGFwaS5lbWl0KCdlcnJvcicsIGVycik7XG4gICAgICAgIGNhbGxiYWNrKGVycik7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICBhcGkuZW1pdCgnZGVzdHJveWVkJyk7XG4gICAgICAgIGNhbGxiYWNrKG51bGwsIHJlc3ApO1xuICAgICAgfVxuICAgIH0pO1xuICB9KTtcbn1cblxuLy8gRGVsZXRlIHRoZSBIdHRwUG91Y2ggc3BlY2lmaWVkIGJ5IHRoZSBnaXZlbiBuYW1lLlxuSHR0cFBvdWNoLmRlc3Ryb3kgPSB1dGlscy50b1Byb21pc2UoZnVuY3Rpb24gKG5hbWUsIG9wdHMsIGNhbGxiYWNrKSB7XG4gIHZhciBob3N0ID0gZ2V0SG9zdChuYW1lLCBvcHRzKTtcbiAgb3B0cyA9IG9wdHMgfHwge307XG4gIGlmICh0eXBlb2Ygb3B0cyA9PT0gJ2Z1bmN0aW9uJykge1xuICAgIGNhbGxiYWNrID0gb3B0cztcbiAgICBvcHRzID0ge307XG4gIH1cbiAgb3B0cyA9IHV0aWxzLmNsb25lKG9wdHMpO1xuICBvcHRzLmhlYWRlcnMgPSBob3N0LmhlYWRlcnM7XG4gIG9wdHMubWV0aG9kID0gJ0RFTEVURSc7XG4gIG9wdHMudXJsID0gZ2VuREJVcmwoaG9zdCwgJycpO1xuICB2YXIgYWpheE9wdHMgPSBvcHRzLmFqYXggfHwge307XG4gIG9wdHMgPSB1dGlscy5leHRlbmQoe30sIG9wdHMsIGFqYXhPcHRzKTtcbiAgdXRpbHMuYWpheChvcHRzLCBjYWxsYmFjayk7XG59KTtcblxuLy8gSHR0cFBvdWNoIGlzIGEgdmFsaWQgYWRhcHRlci5cbkh0dHBQb3VjaC52YWxpZCA9IGZ1bmN0aW9uICgpIHtcbiAgcmV0dXJuIHRydWU7XG59O1xuXG5tb2R1bGUuZXhwb3J0cyA9IEh0dHBQb3VjaDtcblxufSkuY2FsbCh0aGlzLF9kZXJlcV8oXCIvVXNlcnMvbm9sYW4vd29ya3NwYWNlL3BvdWNoZGIvbm9kZV9tb2R1bGVzL2Jyb3dzZXJpZnkvbm9kZV9tb2R1bGVzL2luc2VydC1tb2R1bGUtZ2xvYmFscy9ub2RlX21vZHVsZXMvcHJvY2Vzcy9icm93c2VyLmpzXCIpKVxufSx7XCIuLi9kZXBzL2Vycm9yc1wiOjExLFwiLi4vdXRpbHNcIjoyMyxcIi9Vc2Vycy9ub2xhbi93b3Jrc3BhY2UvcG91Y2hkYi9ub2RlX21vZHVsZXMvYnJvd3NlcmlmeS9ub2RlX21vZHVsZXMvaW5zZXJ0LW1vZHVsZS1nbG9iYWxzL25vZGVfbW9kdWxlcy9wcm9jZXNzL2Jyb3dzZXIuanNcIjoyOH1dLDM6W2Z1bmN0aW9uKF9kZXJlcV8sbW9kdWxlLGV4cG9ydHMpe1xuKGZ1bmN0aW9uIChwcm9jZXNzLGdsb2JhbCl7XG4ndXNlIHN0cmljdCc7XG5cbnZhciB1dGlscyA9IF9kZXJlcV8oJy4uL3V0aWxzJyk7XG52YXIgbWVyZ2UgPSBfZGVyZXFfKCcuLi9tZXJnZScpO1xudmFyIGVycm9ycyA9IF9kZXJlcV8oJy4uL2RlcHMvZXJyb3JzJyk7XG52YXIgdnV2dXplbGEgPSBfZGVyZXFfKCd2dXZ1emVsYScpO1xuXG52YXIgY2FjaGVkREJzID0ge307XG52YXIgdGFza1F1ZXVlID0ge1xuICBydW5uaW5nOiBmYWxzZSxcbiAgcXVldWU6IFtdXG59O1xuXG5mdW5jdGlvbiB0cnlDb2RlKGZ1biwgdGhhdCwgYXJncykge1xuICB0cnkge1xuICAgIGZ1bi5hcHBseSh0aGF0LCBhcmdzKTtcbiAgfSBjYXRjaCAoZXJyKSB7IC8vIHNob3VsZG4ndCBoYXBwZW5cbiAgICBpZiAod2luZG93LlBvdWNoREIpIHtcbiAgICAgIHdpbmRvdy5Qb3VjaERCLmVtaXQoJ2Vycm9yJywgZXJyKTtcbiAgICB9XG4gIH1cbn1cblxuZnVuY3Rpb24gYXBwbHlOZXh0KCkge1xuICBpZiAodGFza1F1ZXVlLnJ1bm5pbmcgfHwgIXRhc2tRdWV1ZS5xdWV1ZS5sZW5ndGgpIHtcbiAgICByZXR1cm47XG4gIH1cbiAgdGFza1F1ZXVlLnJ1bm5pbmcgPSB0cnVlO1xuICB2YXIgaXRlbSA9IHRhc2tRdWV1ZS5xdWV1ZS5zaGlmdCgpO1xuICBpdGVtLmFjdGlvbihmdW5jdGlvbiAoZXJyLCByZXMpIHtcbiAgICB0cnlDb2RlKGl0ZW0uY2FsbGJhY2ssIHRoaXMsIFtlcnIsIHJlc10pO1xuICAgIHRhc2tRdWV1ZS5ydW5uaW5nID0gZmFsc2U7XG4gICAgcHJvY2Vzcy5uZXh0VGljayhhcHBseU5leHQpO1xuICB9KTtcbn1cblxuZnVuY3Rpb24gaWRiRXJyb3IoY2FsbGJhY2spIHtcbiAgcmV0dXJuIGZ1bmN0aW9uIChldmVudCkge1xuICAgIHZhciBtZXNzYWdlID0gKGV2ZW50LnRhcmdldCAmJiBldmVudC50YXJnZXQuZXJyb3IgJiZcbiAgICAgIGV2ZW50LnRhcmdldC5lcnJvci5uYW1lKSB8fCBldmVudC50YXJnZXQ7XG4gICAgY2FsbGJhY2soZXJyb3JzLmVycm9yKGVycm9ycy5JREJfRVJST1IsIG1lc3NhZ2UsIGV2ZW50LnR5cGUpKTtcbiAgfTtcbn1cblxuZnVuY3Rpb24gaXNNb2Rlcm5JZGIoKSB7XG4gIC8vIGNoZWNrIGZvciBvdXRkYXRlZCBpbXBsZW1lbnRhdGlvbnMgb2YgSURCXG4gIC8vIHRoYXQgcmVseSBvbiB0aGUgc2V0VmVyc2lvbiBtZXRob2QgaW5zdGVhZCBvZiBvbnVwZ3JhZGVuZWVkZWQgKGlzc3VlICMxMjA3KVxuXG4gIC8vIGNhY2hlIGJhc2VkIG9uIGFwcFZlcnNpb24sIGluIGNhc2UgdGhlIGJyb3dzZXIgaXMgdXBkYXRlZFxuICB2YXIgY2FjaGVLZXkgPSBcIl9wb3VjaF9fY2hlY2tNb2Rlcm5JZGJfXCIgK1xuICAgIChnbG9iYWwubmF2aWdhdG9yICYmIGdsb2JhbC5uYXZpZ2F0b3IuYXBwVmVyc2lvbik7XG4gIHZhciBjYWNoZWQgPSB1dGlscy5oYXNMb2NhbFN0b3JhZ2UoKSAmJiBnbG9iYWwubG9jYWxTdG9yYWdlW2NhY2hlS2V5XTtcbiAgaWYgKGNhY2hlZCkge1xuICAgIHJldHVybiBKU09OLnBhcnNlKGNhY2hlZCk7XG4gIH1cblxuICB2YXIgZGJOYW1lID0gJ19wb3VjaF9fY2hlY2tNb2Rlcm5JZGInO1xuICB2YXIgcmVzdWx0ID0gZ2xvYmFsLmluZGV4ZWREQi5vcGVuKGRiTmFtZSwgMSkub251cGdyYWRlbmVlZGVkID09PSBudWxsO1xuXG4gIGlmIChnbG9iYWwuaW5kZXhlZERCLmRlbGV0ZURhdGFiYXNlKSB7XG4gICAgZ2xvYmFsLmluZGV4ZWREQi5kZWxldGVEYXRhYmFzZShkYk5hbWUpOyAvLyBkYiBubyBsb25nZXIgbmVlZGVkXG4gIH1cbiAgaWYgKHV0aWxzLmhhc0xvY2FsU3RvcmFnZSgpKSB7XG4gICAgZ2xvYmFsLmxvY2FsU3RvcmFnZVtjYWNoZUtleV0gPSBKU09OLnN0cmluZ2lmeShyZXN1bHQpOyAvLyBjYWNoZVxuICB9XG4gIHJldHVybiByZXN1bHQ7XG59XG5cbi8vIFVuZm9ydHVuYXRlbHksIHRoZSBtZXRhZGF0YSBoYXMgdG8gYmUgc3RyaW5naWZpZWRcbi8vIHdoZW4gaXQgaXMgcHV0IGludG8gdGhlIGRhdGFiYXNlLCBiZWNhdXNlIG90aGVyd2lzZVxuLy8gSW5kZXhlZERCIGNhbiB0aHJvdyBlcnJvcnMgZm9yIGRlZXBseS1uZXN0ZWQgb2JqZWN0cy5cbi8vIE9yaWdpbmFsbHkgd2UganVzdCB1c2VkIEpTT04ucGFyc2UvSlNPTi5zdHJpbmdpZnk7IG5vd1xuLy8gd2UgdXNlIHRoaXMgY3VzdG9tIHZ1dnV6ZWxhIGxpYnJhcnkgdGhhdCBhdm9pZHMgcmVjdXJzaW9uLlxuLy8gSWYgd2UgY291bGQgZG8gaXQgYWxsIG92ZXIgYWdhaW4sIHdlJ2QgcHJvYmFibHkgdXNlIGFcbi8vIGZvcm1hdCBmb3IgdGhlIHJldmlzaW9uIHRyZWVzIG90aGVyIHRoYW4gSlNPTi5cbmZ1bmN0aW9uIGVuY29kZU1ldGFkYXRhKG1ldGFkYXRhLCB3aW5uaW5nUmV2LCBkZWxldGVkKSB7XG4gIHZhciBzdG9yZWRPYmplY3QgPSB7ZGF0YTogdnV2dXplbGEuc3RyaW5naWZ5KG1ldGFkYXRhKX07XG4gIHN0b3JlZE9iamVjdC53aW5uaW5nUmV2ID0gd2lubmluZ1JldjtcbiAgc3RvcmVkT2JqZWN0LmRlbGV0ZWRPckxvY2FsID0gZGVsZXRlZCA/ICcxJyA6ICcwJztcbiAgc3RvcmVkT2JqZWN0LmlkID0gbWV0YWRhdGEuaWQ7XG4gIHJldHVybiBzdG9yZWRPYmplY3Q7XG59XG5cbmZ1bmN0aW9uIGRlY29kZU1ldGFkYXRhKHN0b3JlZE9iamVjdCkge1xuICBpZiAoIXN0b3JlZE9iamVjdCkge1xuICAgIHJldHVybiBudWxsO1xuICB9XG4gIGlmICghc3RvcmVkT2JqZWN0LmRhdGEpIHtcbiAgICAvLyBvbGQgZm9ybWF0LCB3aGVuIHdlIGRpZG4ndCBzdG9yZSBpdCBzdHJpbmdpZmllZFxuICAgIHJldHVybiBzdG9yZWRPYmplY3Q7XG4gIH1cbiAgdmFyIG1ldGFkYXRhID0gdnV2dXplbGEucGFyc2Uoc3RvcmVkT2JqZWN0LmRhdGEpO1xuICBtZXRhZGF0YS53aW5uaW5nUmV2ID0gc3RvcmVkT2JqZWN0Lndpbm5pbmdSZXY7XG4gIG1ldGFkYXRhLmRlbGV0ZWRPckxvY2FsID0gc3RvcmVkT2JqZWN0LmRlbGV0ZWRPckxvY2FsID09PSAnMSc7XG4gIHJldHVybiBtZXRhZGF0YTtcbn1cblxuZnVuY3Rpb24gSWRiUG91Y2gob3B0cywgY2FsbGJhY2spIHtcbiAgdmFyIGFwaSA9IHRoaXM7XG5cbiAgdGFza1F1ZXVlLnF1ZXVlLnB1c2goe1xuICAgIGFjdGlvbjogZnVuY3Rpb24gKHRoaXNDYWxsYmFjaykge1xuICAgICAgaW5pdChhcGksIG9wdHMsIHRoaXNDYWxsYmFjayk7XG4gICAgfSxcbiAgICBjYWxsYmFjazogY2FsbGJhY2tcbiAgfSk7XG4gIGFwcGx5TmV4dCgpO1xufVxuXG5mdW5jdGlvbiBpbml0KGFwaSwgb3B0cywgY2FsbGJhY2spIHtcblxuICAvLyBJbmRleGVkREIgcmVxdWlyZXMgYSB2ZXJzaW9uZWQgZGF0YWJhc2Ugc3RydWN0dXJlLCBzbyB3ZSB1c2UgdGhlXG4gIC8vIHZlcnNpb24gaGVyZSB0byBtYW5hZ2UgbWlncmF0aW9ucy5cbiAgdmFyIEFEQVBURVJfVkVSU0lPTiA9IDM7XG5cbiAgLy8gVGhlIG9iamVjdCBzdG9yZXMgY3JlYXRlZCBmb3IgZWFjaCBkYXRhYmFzZVxuICAvLyBET0NfU1RPUkUgc3RvcmVzIHRoZSBkb2N1bWVudCBtZXRhIGRhdGEsIGl0cyByZXZpc2lvbiBoaXN0b3J5IGFuZCBzdGF0ZVxuICAvLyBLZXllZCBieSBkb2N1bWVudCBpZFxuICB2YXIgRE9DX1NUT1JFID0gJ2RvY3VtZW50LXN0b3JlJztcbiAgLy8gQllfU0VRX1NUT1JFIHN0b3JlcyBhIHBhcnRpY3VsYXIgdmVyc2lvbiBvZiBhIGRvY3VtZW50LCBrZXllZCBieSBpdHNcbiAgLy8gc2VxdWVuY2UgaWRcbiAgdmFyIEJZX1NFUV9TVE9SRSA9ICdieS1zZXF1ZW5jZSc7XG4gIC8vIFdoZXJlIHdlIHN0b3JlIGF0dGFjaG1lbnRzXG4gIHZhciBBVFRBQ0hfU1RPUkUgPSAnYXR0YWNoLXN0b3JlJztcbiAgLy8gV2hlcmUgd2Ugc3RvcmUgZGF0YWJhc2Utd2lkZSBtZXRhIGRhdGEgaW4gYSBzaW5nbGUgcmVjb3JkXG4gIC8vIGtleWVkIGJ5IGlkOiBNRVRBX1NUT1JFXG4gIHZhciBNRVRBX1NUT1JFID0gJ21ldGEtc3RvcmUnO1xuICAvLyBXaGVyZSB3ZSBzdG9yZSBsb2NhbCBkb2N1bWVudHNcbiAgdmFyIExPQ0FMX1NUT1JFID0gJ2xvY2FsLXN0b3JlJztcbiAgLy8gV2hlcmUgd2UgZGV0ZWN0IGJsb2Igc3VwcG9ydFxuICB2YXIgREVURUNUX0JMT0JfU1VQUE9SVF9TVE9SRSA9ICdkZXRlY3QtYmxvYi1zdXBwb3J0JztcblxuICB2YXIgbmFtZSA9IG9wdHMubmFtZTtcblxuICB2YXIgYmxvYlN1cHBvcnQgPSBudWxsO1xuICB2YXIgaW5zdGFuY2VJZCA9IG51bGw7XG4gIHZhciBpZFN0b3JlZCA9IGZhbHNlO1xuICB2YXIgaWRiID0gbnVsbDtcbiAgdmFyIGRvY0NvdW50ID0gLTE7XG5cbiAgZnVuY3Rpb24gY3JlYXRlU2NoZW1hKGRiKSB7XG4gICAgZGIuY3JlYXRlT2JqZWN0U3RvcmUoRE9DX1NUT1JFLCB7a2V5UGF0aCA6ICdpZCd9KVxuICAgICAgLmNyZWF0ZUluZGV4KCdzZXEnLCAnc2VxJywge3VuaXF1ZTogdHJ1ZX0pO1xuICAgIGRiLmNyZWF0ZU9iamVjdFN0b3JlKEJZX1NFUV9TVE9SRSwge2F1dG9JbmNyZW1lbnQ6IHRydWV9KVxuICAgICAgLmNyZWF0ZUluZGV4KCdfZG9jX2lkX3JldicsICdfZG9jX2lkX3JldicsIHt1bmlxdWU6IHRydWV9KTtcbiAgICBkYi5jcmVhdGVPYmplY3RTdG9yZShBVFRBQ0hfU1RPUkUsIHtrZXlQYXRoOiAnZGlnZXN0J30pO1xuICAgIGRiLmNyZWF0ZU9iamVjdFN0b3JlKE1FVEFfU1RPUkUsIHtrZXlQYXRoOiAnaWQnLCBhdXRvSW5jcmVtZW50OiBmYWxzZX0pO1xuICAgIGRiLmNyZWF0ZU9iamVjdFN0b3JlKERFVEVDVF9CTE9CX1NVUFBPUlRfU1RPUkUpO1xuICB9XG5cbiAgLy8gbWlncmF0aW9uIHRvIHZlcnNpb24gMlxuICAvLyB1bmZvcnR1bmF0ZWx5IFwiZGVsZXRlZE9yTG9jYWxcIiBpcyBhIG1pc25vbWVyIG5vdyB0aGF0IHdlIG5vIGxvbmdlclxuICAvLyBzdG9yZSBsb2NhbCBkb2NzIGluIHRoZSBtYWluIGRvYy1zdG9yZSwgYnV0IHdoYWRkeWFnb25uYWRvXG4gIGZ1bmN0aW9uIGFkZERlbGV0ZWRPckxvY2FsSW5kZXgoZSwgY2FsbGJhY2spIHtcbiAgICB2YXIgdHJhbnNhY3Rpb24gPSBlLmN1cnJlbnRUYXJnZXQudHJhbnNhY3Rpb247XG4gICAgdmFyIGRvY1N0b3JlID0gdHJhbnNhY3Rpb24ub2JqZWN0U3RvcmUoRE9DX1NUT1JFKTtcbiAgICBkb2NTdG9yZS5jcmVhdGVJbmRleCgnZGVsZXRlZE9yTG9jYWwnLCAnZGVsZXRlZE9yTG9jYWwnLCB7dW5pcXVlIDogZmFsc2V9KTtcblxuICAgIGRvY1N0b3JlLm9wZW5DdXJzb3IoKS5vbnN1Y2Nlc3MgPSBmdW5jdGlvbiAoZXZlbnQpIHtcbiAgICAgIHZhciBjdXJzb3IgPSBldmVudC50YXJnZXQucmVzdWx0O1xuICAgICAgaWYgKGN1cnNvcikge1xuICAgICAgICB2YXIgbWV0YWRhdGEgPSBjdXJzb3IudmFsdWU7XG4gICAgICAgIHZhciBkZWxldGVkID0gdXRpbHMuaXNEZWxldGVkKG1ldGFkYXRhKTtcbiAgICAgICAgbWV0YWRhdGEuZGVsZXRlZE9yTG9jYWwgPSBkZWxldGVkID8gXCIxXCIgOiBcIjBcIjtcbiAgICAgICAgZG9jU3RvcmUucHV0KG1ldGFkYXRhKTtcbiAgICAgICAgY3Vyc29yW1wiY29udGludWVcIl0oKTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIGNhbGxiYWNrKHRyYW5zYWN0aW9uKTtcbiAgICAgIH1cbiAgICB9O1xuICB9XG5cbiAgLy8gbWlncmF0aW9ucyB0byBnZXQgdG8gdmVyc2lvbiAzXG5cbiAgZnVuY3Rpb24gY3JlYXRlTG9jYWxTdG9yZVNjaGVtYShkYikge1xuICAgIGRiLmNyZWF0ZU9iamVjdFN0b3JlKExPQ0FMX1NUT1JFLCB7a2V5UGF0aDogJ19pZCd9KVxuICAgICAgLmNyZWF0ZUluZGV4KCdfZG9jX2lkX3JldicsICdfZG9jX2lkX3JldicsIHt1bmlxdWU6IHRydWV9KTtcbiAgfVxuXG4gIGZ1bmN0aW9uIG1pZ3JhdGVMb2NhbFN0b3JlKGUsIHR4KSB7XG4gICAgdHggPSB0eCB8fCBlLmN1cnJlbnRUYXJnZXQudHJhbnNhY3Rpb247XG4gICAgdmFyIGxvY2FsU3RvcmUgPSB0eC5vYmplY3RTdG9yZShMT0NBTF9TVE9SRSk7XG4gICAgdmFyIGRvY1N0b3JlID0gdHgub2JqZWN0U3RvcmUoRE9DX1NUT1JFKTtcbiAgICB2YXIgc2VxU3RvcmUgPSB0eC5vYmplY3RTdG9yZShCWV9TRVFfU1RPUkUpO1xuXG4gICAgdmFyIGN1cnNvciA9IGRvY1N0b3JlLm9wZW5DdXJzb3IoKTtcbiAgICBjdXJzb3Iub25zdWNjZXNzID0gZnVuY3Rpb24gKGV2ZW50KSB7XG4gICAgICB2YXIgY3Vyc29yID0gZXZlbnQudGFyZ2V0LnJlc3VsdDtcbiAgICAgIGlmIChjdXJzb3IpIHtcbiAgICAgICAgdmFyIG1ldGFkYXRhID0gY3Vyc29yLnZhbHVlO1xuICAgICAgICB2YXIgZG9jSWQgPSBtZXRhZGF0YS5pZDtcbiAgICAgICAgdmFyIGxvY2FsID0gdXRpbHMuaXNMb2NhbElkKGRvY0lkKTtcbiAgICAgICAgdmFyIHJldiA9IG1lcmdlLndpbm5pbmdSZXYobWV0YWRhdGEpO1xuICAgICAgICBpZiAobG9jYWwpIHtcbiAgICAgICAgICB2YXIgZG9jSWRSZXYgPSBkb2NJZCArIFwiOjpcIiArIHJldjtcbiAgICAgICAgICAvLyByZW1vdmUgYWxsIHNlcSBlbnRyaWVzXG4gICAgICAgICAgLy8gYXNzb2NpYXRlZCB3aXRoIHRoaXMgZG9jSWRcbiAgICAgICAgICB2YXIgc3RhcnQgPSBkb2NJZCArIFwiOjpcIjtcbiAgICAgICAgICB2YXIgZW5kID0gZG9jSWQgKyBcIjo6flwiO1xuICAgICAgICAgIHZhciBpbmRleCA9IHNlcVN0b3JlLmluZGV4KCdfZG9jX2lkX3JldicpO1xuICAgICAgICAgIHZhciByYW5nZSA9IGdsb2JhbC5JREJLZXlSYW5nZS5ib3VuZChzdGFydCwgZW5kLCBmYWxzZSwgZmFsc2UpO1xuICAgICAgICAgIHZhciBzZXFDdXJzb3IgPSBpbmRleC5vcGVuQ3Vyc29yKHJhbmdlKTtcbiAgICAgICAgICBzZXFDdXJzb3Iub25zdWNjZXNzID0gZnVuY3Rpb24gKGUpIHtcbiAgICAgICAgICAgIHNlcUN1cnNvciA9IGUudGFyZ2V0LnJlc3VsdDtcbiAgICAgICAgICAgIGlmICghc2VxQ3Vyc29yKSB7XG4gICAgICAgICAgICAgIC8vIGRvbmVcbiAgICAgICAgICAgICAgZG9jU3RvcmVbXCJkZWxldGVcIl0oY3Vyc29yLnByaW1hcnlLZXkpO1xuICAgICAgICAgICAgICBjdXJzb3JbXCJjb250aW51ZVwiXSgpO1xuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgdmFyIGRhdGEgPSBzZXFDdXJzb3IudmFsdWU7XG4gICAgICAgICAgICAgIGlmIChkYXRhLl9kb2NfaWRfcmV2ID09PSBkb2NJZFJldikge1xuICAgICAgICAgICAgICAgIGxvY2FsU3RvcmUucHV0KGRhdGEpO1xuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgIHNlcVN0b3JlW1wiZGVsZXRlXCJdKHNlcUN1cnNvci5wcmltYXJ5S2V5KTtcbiAgICAgICAgICAgICAgc2VxQ3Vyc29yW1wiY29udGludWVcIl0oKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9O1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgIGN1cnNvcltcImNvbnRpbnVlXCJdKCk7XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9O1xuICB9XG5cbiAgYXBpLnR5cGUgPSBmdW5jdGlvbiAoKSB7XG4gICAgcmV0dXJuICdpZGInO1xuICB9O1xuXG4gIGFwaS5faWQgPSB1dGlscy50b1Byb21pc2UoZnVuY3Rpb24gKGNhbGxiYWNrKSB7XG4gICAgY2FsbGJhY2sobnVsbCwgaW5zdGFuY2VJZCk7XG4gIH0pO1xuXG4gIGFwaS5fYnVsa0RvY3MgPSBmdW5jdGlvbiBpZGJfYnVsa0RvY3MocmVxLCBvcHRzLCBjYWxsYmFjaykge1xuICAgIHZhciBuZXdFZGl0cyA9IG9wdHMubmV3X2VkaXRzO1xuICAgIHZhciB1c2VyRG9jcyA9IHJlcS5kb2NzO1xuICAgIC8vIFBhcnNlIHRoZSBkb2NzLCBnaXZlIHRoZW0gYSBzZXF1ZW5jZSBudW1iZXIgZm9yIHRoZSByZXN1bHRcbiAgICB2YXIgZG9jSW5mb3MgPSB1c2VyRG9jcy5tYXAoZnVuY3Rpb24gKGRvYywgaSkge1xuICAgICAgaWYgKGRvYy5faWQgJiYgdXRpbHMuaXNMb2NhbElkKGRvYy5faWQpKSB7XG4gICAgICAgIHJldHVybiBkb2M7XG4gICAgICB9XG4gICAgICB2YXIgbmV3RG9jID0gdXRpbHMucGFyc2VEb2MoZG9jLCBuZXdFZGl0cyk7XG4gICAgICBuZXdEb2MuX2J1bGtfc2VxID0gaTtcbiAgICAgIHJldHVybiBuZXdEb2M7XG4gICAgfSk7XG5cbiAgICB2YXIgZG9jSW5mb0Vycm9ycyA9IGRvY0luZm9zLmZpbHRlcihmdW5jdGlvbiAoZG9jSW5mbykge1xuICAgICAgcmV0dXJuIGRvY0luZm8uZXJyb3I7XG4gICAgfSk7XG4gICAgaWYgKGRvY0luZm9FcnJvcnMubGVuZ3RoKSB7XG4gICAgICByZXR1cm4gY2FsbGJhY2soZG9jSW5mb0Vycm9yc1swXSk7XG4gICAgfVxuXG4gICAgdmFyIHJlc3VsdHMgPSBuZXcgQXJyYXkoZG9jSW5mb3MubGVuZ3RoKTtcbiAgICB2YXIgZmV0Y2hlZERvY3MgPSBuZXcgdXRpbHMuTWFwKCk7XG4gICAgdmFyIHVwZGF0ZVNlcSA9IDA7XG4gICAgdmFyIG51bURvY3NXcml0dGVuID0gMDtcblxuICAgIGZ1bmN0aW9uIHdyaXRlTWV0YURhdGEoZSkge1xuICAgICAgdmFyIG1ldGEgPSBlLnRhcmdldC5yZXN1bHQ7XG4gICAgICBtZXRhLnVwZGF0ZVNlcSA9IChtZXRhLnVwZGF0ZVNlcSB8fCAwKSArIHVwZGF0ZVNlcTtcbiAgICAgIHR4bi5vYmplY3RTdG9yZShNRVRBX1NUT1JFKS5wdXQobWV0YSk7XG4gICAgfVxuXG4gICAgZnVuY3Rpb24gY2hlY2tEb25lV3JpdGluZ0RvY3MoKSB7XG4gICAgICBpZiAoKytudW1Eb2NzV3JpdHRlbiA9PT0gZG9jSW5mb3MubGVuZ3RoKSB7XG4gICAgICAgIHR4bi5vYmplY3RTdG9yZShNRVRBX1NUT1JFKS5nZXQoTUVUQV9TVE9SRSkub25zdWNjZXNzID0gd3JpdGVNZXRhRGF0YTtcbiAgICAgIH1cbiAgICB9XG5cbiAgICBmdW5jdGlvbiBwcm9jZXNzRG9jcygpIHtcbiAgICAgIGlmICghZG9jSW5mb3MubGVuZ3RoKSB7XG4gICAgICAgIHJldHVybjtcbiAgICAgIH1cblxuICAgICAgdmFyIGlkc1RvRG9jcyA9IG5ldyB1dGlscy5NYXAoKTtcblxuICAgICAgZG9jSW5mb3MuZm9yRWFjaChmdW5jdGlvbiAoY3VycmVudERvYywgcmVzdWx0c0lkeCkge1xuICAgICAgICBpZiAoY3VycmVudERvYy5faWQgJiYgdXRpbHMuaXNMb2NhbElkKGN1cnJlbnREb2MuX2lkKSkge1xuICAgICAgICAgIGFwaVtjdXJyZW50RG9jLl9kZWxldGVkID8gJ19yZW1vdmVMb2NhbCcgOiAnX3B1dExvY2FsJ10oXG4gICAgICAgICAgICAgIGN1cnJlbnREb2MsIHtjdHg6IHR4bn0sIGZ1bmN0aW9uIChlcnIsIHJlc3ApIHtcbiAgICAgICAgICAgIGlmIChlcnIpIHtcbiAgICAgICAgICAgICAgcmVzdWx0c1tyZXN1bHRzSWR4XSA9IGVycjtcbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgIHJlc3VsdHNbcmVzdWx0c0lkeF0gPSB7fTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGNoZWNrRG9uZVdyaXRpbmdEb2NzKCk7XG4gICAgICAgICAgfSk7XG4gICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG5cbiAgICAgICAgdmFyIGlkID0gY3VycmVudERvYy5tZXRhZGF0YS5pZDtcbiAgICAgICAgaWYgKGlkc1RvRG9jcy5oYXMoaWQpKSB7XG4gICAgICAgICAgaWRzVG9Eb2NzLmdldChpZCkucHVzaChbY3VycmVudERvYywgcmVzdWx0c0lkeF0pO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgIGlkc1RvRG9jcy5zZXQoaWQsIFtbY3VycmVudERvYywgcmVzdWx0c0lkeF1dKTtcbiAgICAgICAgfVxuICAgICAgfSk7XG5cbiAgICAgIC8vIGluIHRoZSBjYXNlIG9mIG5ld19lZGl0cywgdGhlIHVzZXIgY2FuIHByb3ZpZGUgbXVsdGlwbGUgZG9jc1xuICAgICAgLy8gd2l0aCB0aGUgc2FtZSBpZC4gdGhlc2UgbmVlZCB0byBiZSBwcm9jZXNzZWQgc2VxdWVudGlhbGx5XG4gICAgICBpZHNUb0RvY3MuZm9yRWFjaChmdW5jdGlvbiAoZG9jcywgaWQpIHtcbiAgICAgICAgdmFyIG51bURvbmUgPSAwO1xuXG4gICAgICAgIGZ1bmN0aW9uIGRvY1dyaXR0ZW4oKSB7XG4gICAgICAgICAgY2hlY2tEb25lV3JpdGluZ0RvY3MoKTtcbiAgICAgICAgICBpZiAoKytudW1Eb25lIDwgZG9jcy5sZW5ndGgpIHtcbiAgICAgICAgICAgIG5leHREb2MoKTtcbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgZnVuY3Rpb24gbmV4dERvYygpIHtcbiAgICAgICAgICB2YXIgdmFsdWUgPSBkb2NzW251bURvbmVdO1xuICAgICAgICAgIHZhciBjdXJyZW50RG9jID0gdmFsdWVbMF07XG4gICAgICAgICAgdmFyIHJlc3VsdHNJZHggPSB2YWx1ZVsxXTtcblxuICAgICAgICAgIGlmIChmZXRjaGVkRG9jcy5oYXMoaWQpKSB7XG4gICAgICAgICAgICB1cGRhdGVEb2MoZmV0Y2hlZERvY3MuZ2V0KGlkKSwgY3VycmVudERvYywgcmVzdWx0c0lkeCwgZG9jV3JpdHRlbik7XG4gICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIGluc2VydERvYyhjdXJyZW50RG9jLCByZXN1bHRzSWR4LCBkb2NXcml0dGVuKTtcbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgbmV4dERvYygpO1xuICAgICAgfSk7XG4gICAgfVxuXG4gICAgZnVuY3Rpb24gZmV0Y2hFeGlzdGluZ0RvY3MoY2FsbGJhY2spIHtcbiAgICAgIGlmICghZG9jSW5mb3MubGVuZ3RoKSB7XG4gICAgICAgIHJldHVybiBjYWxsYmFjaygpO1xuICAgICAgfVxuXG4gICAgICB2YXIgbnVtRmV0Y2hlZCA9IDA7XG5cbiAgICAgIGZ1bmN0aW9uIGNoZWNrRG9uZSgpIHtcbiAgICAgICAgaWYgKCsrbnVtRmV0Y2hlZCA9PT0gZG9jSW5mb3MubGVuZ3RoKSB7XG4gICAgICAgICAgY2FsbGJhY2soKTtcbiAgICAgICAgfVxuICAgICAgfVxuXG4gICAgICBkb2NJbmZvcy5mb3JFYWNoKGZ1bmN0aW9uIChkb2NJbmZvKSB7XG4gICAgICAgIGlmIChkb2NJbmZvLl9pZCAmJiB1dGlscy5pc0xvY2FsSWQoZG9jSW5mby5faWQpKSB7XG4gICAgICAgICAgcmV0dXJuIGNoZWNrRG9uZSgpOyAvLyBza2lwIGxvY2FsIGRvY3NcbiAgICAgICAgfVxuICAgICAgICB2YXIgaWQgPSBkb2NJbmZvLm1ldGFkYXRhLmlkO1xuICAgICAgICB2YXIgcmVxID0gdHhuLm9iamVjdFN0b3JlKERPQ19TVE9SRSkuZ2V0KGlkKTtcbiAgICAgICAgcmVxLm9uc3VjY2VzcyA9IGZ1bmN0aW9uIHByb2Nlc3NfZG9jUmVhZChldmVudCkge1xuICAgICAgICAgIHZhciBtZXRhZGF0YSA9IGRlY29kZU1ldGFkYXRhKGV2ZW50LnRhcmdldC5yZXN1bHQpO1xuICAgICAgICAgIGlmIChtZXRhZGF0YSkge1xuICAgICAgICAgICAgZmV0Y2hlZERvY3Muc2V0KGlkLCBtZXRhZGF0YSk7XG4gICAgICAgICAgfVxuICAgICAgICAgIGNoZWNrRG9uZSgpO1xuICAgICAgICB9O1xuICAgICAgfSk7XG4gICAgfVxuXG4gICAgZnVuY3Rpb24gY29tcGxldGUoKSB7XG4gICAgICB2YXIgYXJlc3VsdHMgPSByZXN1bHRzLm1hcChmdW5jdGlvbiAocmVzdWx0KSB7XG4gICAgICAgIGlmIChyZXN1bHQuX2J1bGtfc2VxKSB7XG4gICAgICAgICAgZGVsZXRlIHJlc3VsdC5fYnVsa19zZXE7XG4gICAgICAgIH0gZWxzZSBpZiAoIU9iamVjdC5rZXlzKHJlc3VsdCkubGVuZ3RoKSB7XG4gICAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgIG9rOiB0cnVlXG4gICAgICAgICAgfTtcbiAgICAgICAgfVxuICAgICAgICBpZiAocmVzdWx0LmVycm9yKSB7XG4gICAgICAgICAgcmV0dXJuIHJlc3VsdDtcbiAgICAgICAgfVxuXG4gICAgICAgIHZhciBtZXRhZGF0YSA9IHJlc3VsdC5tZXRhZGF0YTtcbiAgICAgICAgdmFyIHJldiA9IG1lcmdlLndpbm5pbmdSZXYobWV0YWRhdGEpO1xuXG4gICAgICAgIHJldHVybiB7XG4gICAgICAgICAgb2s6IHRydWUsXG4gICAgICAgICAgaWQ6IG1ldGFkYXRhLmlkLFxuICAgICAgICAgIHJldjogcmV2XG4gICAgICAgIH07XG4gICAgICB9KTtcbiAgICAgIElkYlBvdWNoLkNoYW5nZXMubm90aWZ5KG5hbWUpO1xuICAgICAgZG9jQ291bnQgPSAtMTsgLy8gaW52YWxpZGF0ZVxuICAgICAgY2FsbGJhY2sobnVsbCwgYXJlc3VsdHMpO1xuICAgIH1cblxuICAgIGZ1bmN0aW9uIHByZXByb2Nlc3NBdHRhY2htZW50KGF0dCwgZmluaXNoKSB7XG4gICAgICBpZiAoYXR0LnN0dWIpIHtcbiAgICAgICAgcmV0dXJuIGZpbmlzaCgpO1xuICAgICAgfVxuICAgICAgaWYgKHR5cGVvZiBhdHQuZGF0YSA9PT0gJ3N0cmluZycpIHtcbiAgICAgICAgdmFyIGRhdGE7XG4gICAgICAgIHRyeSB7XG4gICAgICAgICAgZGF0YSA9IGF0b2IoYXR0LmRhdGEpO1xuICAgICAgICB9IGNhdGNoIChlKSB7XG4gICAgICAgICAgdmFyIGVyciA9IGVycm9ycy5lcnJvcihlcnJvcnMuQkFEX0FSRyxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJBdHRhY2htZW50cyBuZWVkIHRvIGJlIGJhc2U2NCBlbmNvZGVkXCIpO1xuICAgICAgICAgIHJldHVybiBjYWxsYmFjayhlcnIpO1xuICAgICAgICB9XG4gICAgICAgIGlmIChibG9iU3VwcG9ydCkge1xuICAgICAgICAgIHZhciB0eXBlID0gYXR0LmNvbnRlbnRfdHlwZTtcbiAgICAgICAgICBkYXRhID0gdXRpbHMuZml4QmluYXJ5KGRhdGEpO1xuICAgICAgICAgIGF0dC5kYXRhID0gdXRpbHMuY3JlYXRlQmxvYihbZGF0YV0sIHt0eXBlOiB0eXBlfSk7XG4gICAgICAgIH1cbiAgICAgICAgdXRpbHMuTUQ1KGRhdGEpLnRoZW4oZnVuY3Rpb24gKHJlc3VsdCkge1xuICAgICAgICAgIGF0dC5kaWdlc3QgPSAnbWQ1LScgKyByZXN1bHQ7XG4gICAgICAgICAgZmluaXNoKCk7XG4gICAgICAgIH0pO1xuICAgICAgICByZXR1cm47XG4gICAgICB9XG4gICAgICB2YXIgcmVhZGVyID0gbmV3IEZpbGVSZWFkZXIoKTtcbiAgICAgIHJlYWRlci5vbmxvYWRlbmQgPSBmdW5jdGlvbiAoZSkge1xuICAgICAgICB2YXIgYmluYXJ5ID0gdXRpbHMuYXJyYXlCdWZmZXJUb0JpbmFyeVN0cmluZyh0aGlzLnJlc3VsdCB8fCAnJyk7XG4gICAgICAgIGlmICghYmxvYlN1cHBvcnQpIHtcbiAgICAgICAgICBhdHQuZGF0YSA9IGJ0b2EoYmluYXJ5KTtcbiAgICAgICAgfVxuICAgICAgICB1dGlscy5NRDUoYmluYXJ5KS50aGVuKGZ1bmN0aW9uIChyZXN1bHQpIHtcbiAgICAgICAgICBhdHQuZGlnZXN0ID0gJ21kNS0nICsgcmVzdWx0O1xuICAgICAgICAgIGZpbmlzaCgpO1xuICAgICAgICB9KTtcbiAgICAgIH07XG4gICAgICByZWFkZXIucmVhZEFzQXJyYXlCdWZmZXIoYXR0LmRhdGEpO1xuICAgIH1cblxuICAgIGZ1bmN0aW9uIHByZXByb2Nlc3NBdHRhY2htZW50cyhjYWxsYmFjaykge1xuICAgICAgaWYgKCFkb2NJbmZvcy5sZW5ndGgpIHtcbiAgICAgICAgcmV0dXJuIGNhbGxiYWNrKCk7XG4gICAgICB9XG5cbiAgICAgIHZhciBkb2N2ID0gMDtcbiAgICAgIGRvY0luZm9zLmZvckVhY2goZnVuY3Rpb24gKGRvY0luZm8pIHtcbiAgICAgICAgdmFyIGF0dGFjaG1lbnRzID0gZG9jSW5mby5kYXRhICYmIGRvY0luZm8uZGF0YS5fYXR0YWNobWVudHMgP1xuICAgICAgICAgIE9iamVjdC5rZXlzKGRvY0luZm8uZGF0YS5fYXR0YWNobWVudHMpIDogW107XG5cbiAgICAgICAgaWYgKCFhdHRhY2htZW50cy5sZW5ndGgpIHtcbiAgICAgICAgICByZXR1cm4gZG9uZSgpO1xuICAgICAgICB9XG5cbiAgICAgICAgdmFyIHJlY3YgPSAwO1xuICAgICAgICBmdW5jdGlvbiBhdHRhY2htZW50UHJvY2Vzc2VkKCkge1xuICAgICAgICAgIHJlY3YrKztcbiAgICAgICAgICBpZiAocmVjdiA9PT0gYXR0YWNobWVudHMubGVuZ3RoKSB7XG4gICAgICAgICAgICBkb25lKCk7XG4gICAgICAgICAgfVxuICAgICAgICB9XG5cbiAgICAgICAgZm9yICh2YXIga2V5IGluIGRvY0luZm8uZGF0YS5fYXR0YWNobWVudHMpIHtcbiAgICAgICAgICBpZiAoZG9jSW5mby5kYXRhLl9hdHRhY2htZW50cy5oYXNPd25Qcm9wZXJ0eShrZXkpKSB7XG4gICAgICAgICAgICBwcmVwcm9jZXNzQXR0YWNobWVudChkb2NJbmZvLmRhdGEuX2F0dGFjaG1lbnRzW2tleV0sXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBhdHRhY2htZW50UHJvY2Vzc2VkKTtcbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgIH0pO1xuXG4gICAgICBmdW5jdGlvbiBkb25lKCkge1xuICAgICAgICBkb2N2Kys7XG4gICAgICAgIGlmIChkb2NJbmZvcy5sZW5ndGggPT09IGRvY3YpIHtcbiAgICAgICAgICBjYWxsYmFjaygpO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgfVxuXG4gICAgZnVuY3Rpb24gd3JpdGVEb2MoZG9jSW5mbywgd2lubmluZ1JldiwgZGVsZXRlZCwgY2FsbGJhY2ssIHJlc3VsdHNJZHgpIHtcbiAgICAgIHZhciBlcnIgPSBudWxsO1xuICAgICAgdmFyIHJlY3YgPSAwO1xuICAgICAgZG9jSW5mby5kYXRhLl9pZCA9IGRvY0luZm8ubWV0YWRhdGEuaWQ7XG4gICAgICBkb2NJbmZvLmRhdGEuX3JldiA9IGRvY0luZm8ubWV0YWRhdGEucmV2O1xuXG4gICAgICBpZiAoZGVsZXRlZCkge1xuICAgICAgICBkb2NJbmZvLmRhdGEuX2RlbGV0ZWQgPSB0cnVlO1xuICAgICAgfVxuXG4gICAgICB2YXIgYXR0YWNobWVudHMgPSBkb2NJbmZvLmRhdGEuX2F0dGFjaG1lbnRzID9cbiAgICAgICAgT2JqZWN0LmtleXMoZG9jSW5mby5kYXRhLl9hdHRhY2htZW50cykgOiBbXTtcblxuICAgICAgZnVuY3Rpb24gY29sbGVjdFJlc3VsdHMoYXR0YWNobWVudEVycikge1xuICAgICAgICBpZiAoIWVycikge1xuICAgICAgICAgIGlmIChhdHRhY2htZW50RXJyKSB7XG4gICAgICAgICAgICBlcnIgPSBhdHRhY2htZW50RXJyO1xuICAgICAgICAgICAgY2FsbGJhY2soZXJyKTtcbiAgICAgICAgICB9IGVsc2UgaWYgKHJlY3YgPT09IGF0dGFjaG1lbnRzLmxlbmd0aCkge1xuICAgICAgICAgICAgZmluaXNoKCk7XG4gICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICB9XG5cbiAgICAgIGZ1bmN0aW9uIGF0dGFjaG1lbnRTYXZlZChlcnIpIHtcbiAgICAgICAgcmVjdisrO1xuICAgICAgICBjb2xsZWN0UmVzdWx0cyhlcnIpO1xuICAgICAgfVxuXG4gICAgICBmb3IgKHZhciBrZXkgaW4gZG9jSW5mby5kYXRhLl9hdHRhY2htZW50cykge1xuICAgICAgICBpZiAoIWRvY0luZm8uZGF0YS5fYXR0YWNobWVudHNba2V5XS5zdHViKSB7XG4gICAgICAgICAgdmFyIGRhdGEgPSBkb2NJbmZvLmRhdGEuX2F0dGFjaG1lbnRzW2tleV0uZGF0YTtcbiAgICAgICAgICBkZWxldGUgZG9jSW5mby5kYXRhLl9hdHRhY2htZW50c1trZXldLmRhdGE7XG4gICAgICAgICAgdmFyIGRpZ2VzdCA9IGRvY0luZm8uZGF0YS5fYXR0YWNobWVudHNba2V5XS5kaWdlc3Q7XG4gICAgICAgICAgc2F2ZUF0dGFjaG1lbnQoZG9jSW5mbywgZGlnZXN0LCBkYXRhLCBhdHRhY2htZW50U2F2ZWQpO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgIHJlY3YrKztcbiAgICAgICAgICBjb2xsZWN0UmVzdWx0cygpO1xuICAgICAgICB9XG4gICAgICB9XG5cbiAgICAgIGZ1bmN0aW9uIGZpbmlzaCgpIHtcbiAgICAgICAgdXBkYXRlU2VxKys7XG4gICAgICAgIGRvY0luZm8uZGF0YS5fZG9jX2lkX3JldiA9IGRvY0luZm8uZGF0YS5faWQgKyBcIjo6XCIgKyBkb2NJbmZvLmRhdGEuX3JldjtcbiAgICAgICAgdmFyIHNlcVN0b3JlID0gdHhuLm9iamVjdFN0b3JlKEJZX1NFUV9TVE9SRSk7XG4gICAgICAgIHZhciBpbmRleCA9IHNlcVN0b3JlLmluZGV4KCdfZG9jX2lkX3JldicpO1xuXG4gICAgICAgIGZ1bmN0aW9uIGFmdGVyUHV0KGUpIHtcbiAgICAgICAgICB2YXIgbWV0YWRhdGEgPSBkb2NJbmZvLm1ldGFkYXRhO1xuICAgICAgICAgIG1ldGFkYXRhLnNlcSA9IGUudGFyZ2V0LnJlc3VsdDtcbiAgICAgICAgICAvLyBDdXJyZW50IF9yZXYgaXMgY2FsY3VsYXRlZCBmcm9tIF9yZXZfdHJlZSBvbiByZWFkXG4gICAgICAgICAgZGVsZXRlIG1ldGFkYXRhLnJldjtcbiAgICAgICAgICB2YXIgbWV0YWRhdGFUb1N0b3JlID0gZW5jb2RlTWV0YWRhdGEobWV0YWRhdGEsIHdpbm5pbmdSZXYsIGRlbGV0ZWQpO1xuICAgICAgICAgIHZhciBtZXRhRGF0YVJlcSA9IHR4bi5vYmplY3RTdG9yZShET0NfU1RPUkUpLnB1dChtZXRhZGF0YVRvU3RvcmUpO1xuICAgICAgICAgIG1ldGFEYXRhUmVxLm9uc3VjY2VzcyA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIGRlbGV0ZSBtZXRhZGF0YS5kZWxldGVkT3JMb2NhbDtcbiAgICAgICAgICAgIGRlbGV0ZSBtZXRhZGF0YS53aW5uaW5nUmV2O1xuICAgICAgICAgICAgcmVzdWx0c1tyZXN1bHRzSWR4XSA9IGRvY0luZm87XG4gICAgICAgICAgICBmZXRjaGVkRG9jcy5zZXQoZG9jSW5mby5tZXRhZGF0YS5pZCwgZG9jSW5mby5tZXRhZGF0YSk7XG4gICAgICAgICAgICB1dGlscy5jYWxsKGNhbGxiYWNrKTtcbiAgICAgICAgICB9O1xuICAgICAgICB9XG5cbiAgICAgICAgdmFyIHB1dFJlcSA9IHNlcVN0b3JlLnB1dChkb2NJbmZvLmRhdGEpO1xuXG4gICAgICAgIHB1dFJlcS5vbnN1Y2Nlc3MgPSBhZnRlclB1dDtcbiAgICAgICAgcHV0UmVxLm9uZXJyb3IgPSBmdW5jdGlvbiAoZSkge1xuICAgICAgICAgIC8vIENvbnN0cmFpbnRFcnJvciwgbmVlZCB0byB1cGRhdGUsIG5vdCBwdXQgKHNlZSAjMTYzOCBmb3IgZGV0YWlscylcbiAgICAgICAgICBlLnByZXZlbnREZWZhdWx0KCk7IC8vIGF2b2lkIHRyYW5zYWN0aW9uIGFib3J0XG4gICAgICAgICAgZS5zdG9wUHJvcGFnYXRpb24oKTsgLy8gYXZvaWQgdHJhbnNhY3Rpb24gb25lcnJvclxuICAgICAgICAgIHZhciBnZXRLZXlSZXEgPSBpbmRleC5nZXRLZXkoZG9jSW5mby5kYXRhLl9kb2NfaWRfcmV2KTtcbiAgICAgICAgICBnZXRLZXlSZXEub25zdWNjZXNzID0gZnVuY3Rpb24gKGUpIHtcbiAgICAgICAgICAgIHZhciBwdXRSZXEgPSBzZXFTdG9yZS5wdXQoZG9jSW5mby5kYXRhLCBlLnRhcmdldC5yZXN1bHQpO1xuICAgICAgICAgICAgdXBkYXRlU2VxLS07IC8vIGRpc2NvdW50LCBzaW5jZSBpdCdzIGFuIHVwZGF0ZSwgbm90IGEgbmV3IHNlcVxuICAgICAgICAgICAgcHV0UmVxLm9uc3VjY2VzcyA9IGFmdGVyUHV0O1xuICAgICAgICAgIH07XG4gICAgICAgIH07XG4gICAgICB9XG5cbiAgICAgIGlmICghYXR0YWNobWVudHMubGVuZ3RoKSB7XG4gICAgICAgIGZpbmlzaCgpO1xuICAgICAgfVxuICAgIH1cblxuICAgIGZ1bmN0aW9uIHVwZGF0ZURvYyhvbGREb2MsIGRvY0luZm8sIHJlc3VsdHNJZHgsIGNhbGxiYWNrKSB7XG4gICAgICB2YXIgbWVyZ2VkID1cbiAgICAgICAgbWVyZ2UubWVyZ2Uob2xkRG9jLnJldl90cmVlLCBkb2NJbmZvLm1ldGFkYXRhLnJldl90cmVlWzBdLCAxMDAwKTtcbiAgICAgIHZhciB3YXNQcmV2aW91c2x5RGVsZXRlZCA9IHV0aWxzLmlzRGVsZXRlZChvbGREb2MpO1xuICAgICAgdmFyIGRlbGV0ZWQgPSB1dGlscy5pc0RlbGV0ZWQoZG9jSW5mby5tZXRhZGF0YSk7XG4gICAgICB2YXIgaW5Db25mbGljdCA9ICh3YXNQcmV2aW91c2x5RGVsZXRlZCAmJiBkZWxldGVkICYmIG5ld0VkaXRzKSB8fFxuICAgICAgICAoIXdhc1ByZXZpb3VzbHlEZWxldGVkICYmIG5ld0VkaXRzICYmIG1lcmdlZC5jb25mbGljdHMgIT09ICduZXdfbGVhZicpO1xuXG4gICAgICBpZiAoaW5Db25mbGljdCkge1xuICAgICAgICByZXN1bHRzW3Jlc3VsdHNJZHhdID0gbWFrZUVycihlcnJvcnMuUkVWX0NPTkZMSUNULCBkb2NJbmZvLl9idWxrX3NlcSk7XG4gICAgICAgIHJldHVybiBjYWxsYmFjaygpO1xuICAgICAgfVxuXG4gICAgICBkb2NJbmZvLm1ldGFkYXRhLnJldl90cmVlID0gbWVyZ2VkLnRyZWU7XG5cbiAgICAgIC8vIHJlY2FsY3VsYXRlXG4gICAgICB2YXIgd2lubmluZ1JldiA9IG1lcmdlLndpbm5pbmdSZXYoZG9jSW5mby5tZXRhZGF0YSk7XG4gICAgICBkZWxldGVkID0gdXRpbHMuaXNEZWxldGVkKGRvY0luZm8ubWV0YWRhdGEsIHdpbm5pbmdSZXYpO1xuXG4gICAgICB3cml0ZURvYyhkb2NJbmZvLCB3aW5uaW5nUmV2LCBkZWxldGVkLCBjYWxsYmFjaywgcmVzdWx0c0lkeCk7XG4gICAgfVxuXG4gICAgZnVuY3Rpb24gaW5zZXJ0RG9jKGRvY0luZm8sIHJlc3VsdHNJZHgsIGNhbGxiYWNrKSB7XG4gICAgICB2YXIgd2lubmluZ1JldiA9IG1lcmdlLndpbm5pbmdSZXYoZG9jSW5mby5tZXRhZGF0YSk7XG4gICAgICB2YXIgZGVsZXRlZCA9IHV0aWxzLmlzRGVsZXRlZChkb2NJbmZvLm1ldGFkYXRhLCB3aW5uaW5nUmV2KTtcbiAgICAgIC8vIENhbnQgaW5zZXJ0IG5ldyBkZWxldGVkIGRvY3VtZW50c1xuICAgICAgaWYgKCd3YXNfZGVsZXRlJyBpbiBvcHRzICYmIGRlbGV0ZWQpIHtcbiAgICAgICAgcmVzdWx0c1tyZXN1bHRzSWR4XSA9IGVycm9ycy5NSVNTSU5HX0RPQztcbiAgICAgICAgcmV0dXJuIGNhbGxiYWNrKCk7XG4gICAgICB9XG5cbiAgICAgIHdyaXRlRG9jKGRvY0luZm8sIHdpbm5pbmdSZXYsIGRlbGV0ZWQsIGNhbGxiYWNrLCByZXN1bHRzSWR4KTtcbiAgICB9XG5cbiAgICAvLyBJbnNlcnQgc2VxdWVuY2UgbnVtYmVyIGludG8gdGhlIGVycm9yIHNvIHdlIGNhbiBzb3J0IGxhdGVyXG4gICAgZnVuY3Rpb24gbWFrZUVycihlcnIsIHNlcSkge1xuICAgICAgZXJyLl9idWxrX3NlcSA9IHNlcTtcbiAgICAgIHJldHVybiBlcnI7XG4gICAgfVxuXG4gICAgZnVuY3Rpb24gc2F2ZUF0dGFjaG1lbnQoZG9jSW5mbywgZGlnZXN0LCBkYXRhLCBjYWxsYmFjaykge1xuICAgICAgdmFyIG9iamVjdFN0b3JlID0gdHhuLm9iamVjdFN0b3JlKEFUVEFDSF9TVE9SRSk7XG4gICAgICBvYmplY3RTdG9yZS5nZXQoZGlnZXN0KS5vbnN1Y2Nlc3MgPSBmdW5jdGlvbiAoZSkge1xuICAgICAgICB2YXIgb3JpZ2luYWxSZWZzID0gZS50YXJnZXQucmVzdWx0ICYmIGUudGFyZ2V0LnJlc3VsdC5yZWZzIHx8IHt9O1xuICAgICAgICB2YXIgcmVmID0gW2RvY0luZm8ubWV0YWRhdGEuaWQsIGRvY0luZm8ubWV0YWRhdGEucmV2XS5qb2luKCdAJyk7XG4gICAgICAgIHZhciBuZXdBdHQgPSB7XG4gICAgICAgICAgZGlnZXN0OiBkaWdlc3QsXG4gICAgICAgICAgYm9keTogZGF0YSxcbiAgICAgICAgICByZWZzOiBvcmlnaW5hbFJlZnNcbiAgICAgICAgfTtcbiAgICAgICAgbmV3QXR0LnJlZnNbcmVmXSA9IHRydWU7XG4gICAgICAgIG9iamVjdFN0b3JlLnB1dChuZXdBdHQpLm9uc3VjY2VzcyA9IGZ1bmN0aW9uIChlKSB7XG4gICAgICAgICAgdXRpbHMuY2FsbChjYWxsYmFjayk7XG4gICAgICAgIH07XG4gICAgICB9O1xuICAgIH1cblxuICAgIHZhciB0eG47XG4gICAgcHJlcHJvY2Vzc0F0dGFjaG1lbnRzKGZ1bmN0aW9uICgpIHtcbiAgICAgIHZhciBzdG9yZXMgPSBbRE9DX1NUT1JFLCBCWV9TRVFfU1RPUkUsIEFUVEFDSF9TVE9SRSwgTUVUQV9TVE9SRSxcbiAgICAgICAgTE9DQUxfU1RPUkVdO1xuICAgICAgdHhuID0gaWRiLnRyYW5zYWN0aW9uKHN0b3JlcywgJ3JlYWR3cml0ZScpO1xuICAgICAgdHhuLm9uZXJyb3IgPSBpZGJFcnJvcihjYWxsYmFjayk7XG4gICAgICB0eG4ub250aW1lb3V0ID0gaWRiRXJyb3IoY2FsbGJhY2spO1xuICAgICAgdHhuLm9uY29tcGxldGUgPSBjb21wbGV0ZTtcblxuICAgICAgZmV0Y2hFeGlzdGluZ0RvY3MocHJvY2Vzc0RvY3MpO1xuICAgIH0pO1xuICB9O1xuXG4gIC8vIEZpcnN0IHdlIGxvb2sgdXAgdGhlIG1ldGFkYXRhIGluIHRoZSBpZHMgZGF0YWJhc2UsIHRoZW4gd2UgZmV0Y2ggdGhlXG4gIC8vIGN1cnJlbnQgcmV2aXNpb24ocykgZnJvbSB0aGUgYnkgc2VxdWVuY2Ugc3RvcmVcbiAgYXBpLl9nZXQgPSBmdW5jdGlvbiBpZGJfZ2V0KGlkLCBvcHRzLCBjYWxsYmFjaykge1xuICAgIHZhciBkb2M7XG4gICAgdmFyIG1ldGFkYXRhO1xuICAgIHZhciBlcnI7XG4gICAgdmFyIHR4bjtcbiAgICBvcHRzID0gdXRpbHMuY2xvbmUob3B0cyk7XG4gICAgaWYgKG9wdHMuY3R4KSB7XG4gICAgICB0eG4gPSBvcHRzLmN0eDtcbiAgICB9IGVsc2Uge1xuICAgICAgdHhuID1cbiAgICAgICAgaWRiLnRyYW5zYWN0aW9uKFtET0NfU1RPUkUsIEJZX1NFUV9TVE9SRSwgQVRUQUNIX1NUT1JFXSwgJ3JlYWRvbmx5Jyk7XG4gICAgfVxuXG4gICAgZnVuY3Rpb24gZmluaXNoKCkge1xuICAgICAgY2FsbGJhY2soZXJyLCB7ZG9jOiBkb2MsIG1ldGFkYXRhOiBtZXRhZGF0YSwgY3R4OiB0eG59KTtcbiAgICB9XG5cbiAgICB0eG4ub2JqZWN0U3RvcmUoRE9DX1NUT1JFKS5nZXQoaWQpLm9uc3VjY2VzcyA9IGZ1bmN0aW9uIChlKSB7XG4gICAgICBtZXRhZGF0YSA9IGRlY29kZU1ldGFkYXRhKGUudGFyZ2V0LnJlc3VsdCk7XG4gICAgICAvLyB3ZSBjYW4gZGV0ZXJtaW5lIHRoZSByZXN1bHQgaGVyZSBpZjpcbiAgICAgIC8vIDEuIHRoZXJlIGlzIG5vIHN1Y2ggZG9jdW1lbnRcbiAgICAgIC8vIDIuIHRoZSBkb2N1bWVudCBpcyBkZWxldGVkIGFuZCB3ZSBkb24ndCBhc2sgYWJvdXQgc3BlY2lmaWMgcmV2XG4gICAgICAvLyBXaGVuIHdlIGFzayB3aXRoIG9wdHMucmV2IHdlIGV4cGVjdCB0aGUgYW5zd2VyIHRvIGJlIGVpdGhlclxuICAgICAgLy8gZG9jIChwb3NzaWJseSB3aXRoIF9kZWxldGVkPXRydWUpIG9yIG1pc3NpbmcgZXJyb3JcbiAgICAgIGlmICghbWV0YWRhdGEpIHtcbiAgICAgICAgZXJyID0gZXJyb3JzLk1JU1NJTkdfRE9DO1xuICAgICAgICByZXR1cm4gZmluaXNoKCk7XG4gICAgICB9XG4gICAgICBpZiAodXRpbHMuaXNEZWxldGVkKG1ldGFkYXRhKSAmJiAhb3B0cy5yZXYpIHtcbiAgICAgICAgZXJyID0gZXJyb3JzLmVycm9yKGVycm9ycy5NSVNTSU5HX0RPQywgXCJkZWxldGVkXCIpO1xuICAgICAgICByZXR1cm4gZmluaXNoKCk7XG4gICAgICB9XG4gICAgICB2YXIgb2JqZWN0U3RvcmUgPSB0eG4ub2JqZWN0U3RvcmUoQllfU0VRX1NUT1JFKTtcblxuICAgICAgLy8gbWV0YWRhdGEud2lubmluZ1JldiB3YXMgYWRkZWQgbGF0ZXIsIHNvIG9sZGVyIERCcyBtaWdodCBub3QgaGF2ZSBpdFxuICAgICAgdmFyIHJldiA9IG9wdHMucmV2IHx8IG1ldGFkYXRhLndpbm5pbmdSZXYgfHwgbWVyZ2Uud2lubmluZ1JldihtZXRhZGF0YSk7XG4gICAgICB2YXIga2V5ID0gbWV0YWRhdGEuaWQgKyAnOjonICsgcmV2O1xuXG4gICAgICBvYmplY3RTdG9yZS5pbmRleCgnX2RvY19pZF9yZXYnKS5nZXQoa2V5KS5vbnN1Y2Nlc3MgPSBmdW5jdGlvbiAoZSkge1xuICAgICAgICBkb2MgPSBlLnRhcmdldC5yZXN1bHQ7XG4gICAgICAgIGlmIChkb2MgJiYgZG9jLl9kb2NfaWRfcmV2KSB7XG4gICAgICAgICAgZGVsZXRlKGRvYy5fZG9jX2lkX3Jldik7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKCFkb2MpIHtcbiAgICAgICAgICBlcnIgPSBlcnJvcnMuTUlTU0lOR19ET0M7XG4gICAgICAgICAgcmV0dXJuIGZpbmlzaCgpO1xuICAgICAgICB9XG4gICAgICAgIGZpbmlzaCgpO1xuICAgICAgfTtcbiAgICB9O1xuICB9O1xuXG4gIGFwaS5fZ2V0QXR0YWNobWVudCA9IGZ1bmN0aW9uIChhdHRhY2htZW50LCBvcHRzLCBjYWxsYmFjaykge1xuICAgIHZhciB0eG47XG4gICAgb3B0cyA9IHV0aWxzLmNsb25lKG9wdHMpO1xuICAgIGlmIChvcHRzLmN0eCkge1xuICAgICAgdHhuID0gb3B0cy5jdHg7XG4gICAgfSBlbHNlIHtcbiAgICAgIHR4biA9XG4gICAgICAgIGlkYi50cmFuc2FjdGlvbihbRE9DX1NUT1JFLCBCWV9TRVFfU1RPUkUsIEFUVEFDSF9TVE9SRV0sICdyZWFkb25seScpO1xuICAgIH1cbiAgICB2YXIgZGlnZXN0ID0gYXR0YWNobWVudC5kaWdlc3Q7XG4gICAgdmFyIHR5cGUgPSBhdHRhY2htZW50LmNvbnRlbnRfdHlwZTtcblxuICAgIHR4bi5vYmplY3RTdG9yZShBVFRBQ0hfU1RPUkUpLmdldChkaWdlc3QpLm9uc3VjY2VzcyA9IGZ1bmN0aW9uIChlKSB7XG4gICAgICB2YXIgZGF0YSA9IGUudGFyZ2V0LnJlc3VsdC5ib2R5O1xuICAgICAgaWYgKG9wdHMuZW5jb2RlKSB7XG4gICAgICAgIGlmICghZGF0YSkge1xuICAgICAgICAgIGNhbGxiYWNrKG51bGwsICcnKTtcbiAgICAgICAgfSBlbHNlIGlmICh0eXBlb2YgZGF0YSAhPT0gJ3N0cmluZycpIHsgLy8gd2UgaGF2ZSBibG9iIHN1cHBvcnRcbiAgICAgICAgICB2YXIgcmVhZGVyID0gbmV3IEZpbGVSZWFkZXIoKTtcbiAgICAgICAgICByZWFkZXIub25sb2FkZW5kID0gZnVuY3Rpb24gKGUpIHtcbiAgICAgICAgICAgIHZhciBiaW5hcnkgPSB1dGlscy5hcnJheUJ1ZmZlclRvQmluYXJ5U3RyaW5nKHRoaXMucmVzdWx0IHx8ICcnKTtcbiAgICAgICAgICAgIGNhbGxiYWNrKG51bGwsIGJ0b2EoYmluYXJ5KSk7XG4gICAgICAgICAgfTtcbiAgICAgICAgICByZWFkZXIucmVhZEFzQXJyYXlCdWZmZXIoZGF0YSk7XG4gICAgICAgIH0gZWxzZSB7IC8vIG5vIGJsb2Igc3VwcG9ydFxuICAgICAgICAgIGNhbGxiYWNrKG51bGwsIGRhdGEpO1xuICAgICAgICB9XG4gICAgICB9IGVsc2Uge1xuICAgICAgICBpZiAoIWRhdGEpIHtcbiAgICAgICAgICBjYWxsYmFjayhudWxsLCB1dGlscy5jcmVhdGVCbG9iKFsnJ10sIHt0eXBlOiB0eXBlfSkpO1xuICAgICAgICB9IGVsc2UgaWYgKHR5cGVvZiBkYXRhICE9PSAnc3RyaW5nJykgeyAvLyB3ZSBoYXZlIGJsb2Igc3VwcG9ydFxuICAgICAgICAgIGNhbGxiYWNrKG51bGwsIGRhdGEpO1xuICAgICAgICB9IGVsc2UgeyAvLyBubyBibG9iIHN1cHBvcnRcbiAgICAgICAgICBkYXRhID0gdXRpbHMuZml4QmluYXJ5KGF0b2IoZGF0YSkpO1xuICAgICAgICAgIGNhbGxiYWNrKG51bGwsIHV0aWxzLmNyZWF0ZUJsb2IoW2RhdGFdLCB7dHlwZTogdHlwZX0pKTtcbiAgICAgICAgfVxuICAgICAgfVxuICAgIH07XG4gIH07XG5cbiAgZnVuY3Rpb24gYWxsRG9jc1F1ZXJ5KHRvdGFsUm93cywgb3B0cywgY2FsbGJhY2spIHtcbiAgICB2YXIgc3RhcnQgPSAnc3RhcnRrZXknIGluIG9wdHMgPyBvcHRzLnN0YXJ0a2V5IDogZmFsc2U7XG4gICAgdmFyIGVuZCA9ICdlbmRrZXknIGluIG9wdHMgPyBvcHRzLmVuZGtleSA6IGZhbHNlO1xuICAgIHZhciBrZXkgPSAna2V5JyBpbiBvcHRzID8gb3B0cy5rZXkgOiBmYWxzZTtcbiAgICB2YXIgc2tpcCA9IG9wdHMuc2tpcCB8fCAwO1xuICAgIHZhciBsaW1pdCA9IHR5cGVvZiBvcHRzLmxpbWl0ID09PSAnbnVtYmVyJyA/IG9wdHMubGltaXQgOiAtMTtcbiAgICB2YXIgaW5jbHVzaXZlRW5kID0gb3B0cy5pbmNsdXNpdmVfZW5kICE9PSBmYWxzZTtcbiAgICB2YXIgZGVzY2VuZGluZyA9ICdkZXNjZW5kaW5nJyBpbiBvcHRzICYmIG9wdHMuZGVzY2VuZGluZyA/ICdwcmV2JyA6IG51bGw7XG5cbiAgICB2YXIgbWFudWFsRGVzY0VuZCA9IGZhbHNlO1xuICAgIGlmIChkZXNjZW5kaW5nICYmIHN0YXJ0ICYmIGVuZCkge1xuICAgICAgLy8gdW5mb3J0dW5hdGVseSBJREIgaGFzIGEgcXVpcmsgd2hlcmUgSURCS2V5UmFuZ2UuYm91bmQgaXMgaW52YWxpZCBpZiB0aGVcbiAgICAgIC8vIHN0YXJ0IGlzIGxlc3MgdGhhbiB0aGUgZW5kLCBldmVuIGluIGRlc2NlbmRpbmcgbW9kZS4gIEJlc3QgYmV0XG4gICAgICAvLyBpcyBqdXN0IHRvIGhhbmRsZSBpdCBtYW51YWxseSBpbiB0aGF0IGNhc2UuXG4gICAgICBtYW51YWxEZXNjRW5kID0gZW5kO1xuICAgICAgZW5kID0gZmFsc2U7XG4gICAgfVxuXG4gICAgdmFyIGtleVJhbmdlID0gbnVsbDtcbiAgICB0cnkge1xuICAgICAgaWYgKHN0YXJ0ICYmIGVuZCkge1xuICAgICAgICBrZXlSYW5nZSA9IGdsb2JhbC5JREJLZXlSYW5nZS5ib3VuZChzdGFydCwgZW5kLCBmYWxzZSwgIWluY2x1c2l2ZUVuZCk7XG4gICAgICB9IGVsc2UgaWYgKHN0YXJ0KSB7XG4gICAgICAgIGlmIChkZXNjZW5kaW5nKSB7XG4gICAgICAgICAga2V5UmFuZ2UgPSBnbG9iYWwuSURCS2V5UmFuZ2UudXBwZXJCb3VuZChzdGFydCk7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAga2V5UmFuZ2UgPSBnbG9iYWwuSURCS2V5UmFuZ2UubG93ZXJCb3VuZChzdGFydCk7XG4gICAgICAgIH1cbiAgICAgIH0gZWxzZSBpZiAoZW5kKSB7XG4gICAgICAgIGlmIChkZXNjZW5kaW5nKSB7XG4gICAgICAgICAga2V5UmFuZ2UgPSBnbG9iYWwuSURCS2V5UmFuZ2UubG93ZXJCb3VuZChlbmQsICFpbmNsdXNpdmVFbmQpO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgIGtleVJhbmdlID0gZ2xvYmFsLklEQktleVJhbmdlLnVwcGVyQm91bmQoZW5kLCAhaW5jbHVzaXZlRW5kKTtcbiAgICAgICAgfVxuICAgICAgfSBlbHNlIGlmIChrZXkpIHtcbiAgICAgICAga2V5UmFuZ2UgPSBnbG9iYWwuSURCS2V5UmFuZ2Uub25seShrZXkpO1xuICAgICAgfVxuICAgIH0gY2F0Y2ggKGUpIHtcbiAgICAgIGlmIChlLm5hbWUgPT09IFwiRGF0YUVycm9yXCIgJiYgZS5jb2RlID09PSAwKSB7XG4gICAgICAgIC8vIGRhdGEgZXJyb3IsIHN0YXJ0IGlzIGxlc3MgdGhhbiBlbmRcbiAgICAgICAgcmV0dXJuIGNhbGxiYWNrKG51bGwsIHtcbiAgICAgICAgICB0b3RhbF9yb3dzIDogdG90YWxSb3dzLFxuICAgICAgICAgIG9mZnNldCA6IG9wdHMuc2tpcCxcbiAgICAgICAgICByb3dzIDogW11cbiAgICAgICAgfSk7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICByZXR1cm4gY2FsbGJhY2soZXJyb3JzLmVycm9yKGVycm9ycy5JREJfRVJST1IsIGUubmFtZSwgZS5tZXNzYWdlKSk7XG4gICAgICB9XG4gICAgfVxuXG4gICAgdmFyIHRyYW5zYWN0aW9uID0gaWRiLnRyYW5zYWN0aW9uKFtET0NfU1RPUkUsIEJZX1NFUV9TVE9SRV0sICdyZWFkb25seScpO1xuICAgIHRyYW5zYWN0aW9uLm9uY29tcGxldGUgPSBmdW5jdGlvbiAoKSB7XG4gICAgICBjYWxsYmFjayhudWxsLCB7XG4gICAgICAgIHRvdGFsX3Jvd3M6IHRvdGFsUm93cyxcbiAgICAgICAgb2Zmc2V0OiBvcHRzLnNraXAsXG4gICAgICAgIHJvd3M6IHJlc3VsdHNcbiAgICAgIH0pO1xuICAgIH07XG5cbiAgICB2YXIgb1N0b3JlID0gdHJhbnNhY3Rpb24ub2JqZWN0U3RvcmUoRE9DX1NUT1JFKTtcbiAgICB2YXIgb0N1cnNvciA9IGRlc2NlbmRpbmcgPyBvU3RvcmUub3BlbkN1cnNvcihrZXlSYW5nZSwgZGVzY2VuZGluZylcbiAgICAgIDogb1N0b3JlLm9wZW5DdXJzb3Ioa2V5UmFuZ2UpO1xuICAgIHZhciByZXN1bHRzID0gW107XG4gICAgb0N1cnNvci5vbnN1Y2Nlc3MgPSBmdW5jdGlvbiAoZSkge1xuICAgICAgaWYgKCFlLnRhcmdldC5yZXN1bHQpIHtcbiAgICAgICAgcmV0dXJuO1xuICAgICAgfVxuICAgICAgdmFyIGN1cnNvciA9IGUudGFyZ2V0LnJlc3VsdDtcbiAgICAgIHZhciBtZXRhZGF0YSA9IGRlY29kZU1ldGFkYXRhKGN1cnNvci52YWx1ZSk7XG4gICAgICAvLyBtZXRhZGF0YS53aW5uaW5nUmV2IGFkZGVkIGxhdGVyLCBzb21lIGRicyBtaWdodCBiZSBtaXNzaW5nIGl0XG4gICAgICB2YXIgd2lubmluZ1JldiA9IG1ldGFkYXRhLndpbm5pbmdSZXYgfHwgbWVyZ2Uud2lubmluZ1JldihtZXRhZGF0YSk7XG5cbiAgICAgIGZ1bmN0aW9uIGFsbERvY3NJbm5lcihtZXRhZGF0YSwgZGF0YSkge1xuICAgICAgICB2YXIgZG9jID0ge1xuICAgICAgICAgIGlkOiBtZXRhZGF0YS5pZCxcbiAgICAgICAgICBrZXk6IG1ldGFkYXRhLmlkLFxuICAgICAgICAgIHZhbHVlOiB7XG4gICAgICAgICAgICByZXY6IHdpbm5pbmdSZXZcbiAgICAgICAgICB9XG4gICAgICAgIH07XG4gICAgICAgIGlmIChvcHRzLmluY2x1ZGVfZG9jcykge1xuICAgICAgICAgIGRvYy5kb2MgPSBkYXRhO1xuICAgICAgICAgIGRvYy5kb2MuX3JldiA9IHdpbm5pbmdSZXY7XG4gICAgICAgICAgaWYgKGRvYy5kb2MuX2RvY19pZF9yZXYpIHtcbiAgICAgICAgICAgIGRlbGV0ZShkb2MuZG9jLl9kb2NfaWRfcmV2KTtcbiAgICAgICAgICB9XG4gICAgICAgICAgaWYgKG9wdHMuY29uZmxpY3RzKSB7XG4gICAgICAgICAgICBkb2MuZG9jLl9jb25mbGljdHMgPSBtZXJnZS5jb2xsZWN0Q29uZmxpY3RzKG1ldGFkYXRhKTtcbiAgICAgICAgICB9XG4gICAgICAgICAgZm9yICh2YXIgYXR0IGluIGRvYy5kb2MuX2F0dGFjaG1lbnRzKSB7XG4gICAgICAgICAgICBpZiAoZG9jLmRvYy5fYXR0YWNobWVudHMuaGFzT3duUHJvcGVydHkoYXR0KSkge1xuICAgICAgICAgICAgICBkb2MuZG9jLl9hdHRhY2htZW50c1thdHRdLnN0dWIgPSB0cnVlO1xuICAgICAgICAgICAgfVxuICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICB2YXIgZGVsZXRlZCA9IHV0aWxzLmlzRGVsZXRlZChtZXRhZGF0YSwgd2lubmluZ1Jldik7XG4gICAgICAgIGlmIChvcHRzLmRlbGV0ZWQgPT09ICdvaycpIHtcbiAgICAgICAgICAvLyBkZWxldGVkIGRvY3MgYXJlIG9rYXkgd2l0aCBrZXlzX3JlcXVlc3RzXG4gICAgICAgICAgaWYgKGRlbGV0ZWQpIHtcbiAgICAgICAgICAgIGRvYy52YWx1ZS5kZWxldGVkID0gdHJ1ZTtcbiAgICAgICAgICAgIGRvYy5kb2MgPSBudWxsO1xuICAgICAgICAgIH1cbiAgICAgICAgICByZXN1bHRzLnB1c2goZG9jKTtcbiAgICAgICAgfSBlbHNlIGlmICghZGVsZXRlZCAmJiBza2lwLS0gPD0gMCkge1xuICAgICAgICAgIGlmIChtYW51YWxEZXNjRW5kKSB7XG4gICAgICAgICAgICBpZiAoaW5jbHVzaXZlRW5kICYmIGRvYy5rZXkgPCBtYW51YWxEZXNjRW5kKSB7XG4gICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgIH0gZWxzZSBpZiAoIWluY2x1c2l2ZUVuZCAmJiBkb2Mua2V5IDw9IG1hbnVhbERlc2NFbmQpIHtcbiAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgfVxuICAgICAgICAgIH1cbiAgICAgICAgICByZXN1bHRzLnB1c2goZG9jKTtcbiAgICAgICAgICBpZiAoLS1saW1pdCA9PT0gMCkge1xuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICBjdXJzb3JbXCJjb250aW51ZVwiXSgpO1xuICAgICAgfVxuXG4gICAgICBpZiAoIW9wdHMuaW5jbHVkZV9kb2NzKSB7XG4gICAgICAgIGFsbERvY3NJbm5lcihtZXRhZGF0YSk7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICB2YXIgaW5kZXggPSB0cmFuc2FjdGlvbi5vYmplY3RTdG9yZShCWV9TRVFfU1RPUkUpLmluZGV4KCdfZG9jX2lkX3JldicpO1xuICAgICAgICB2YXIga2V5ID0gbWV0YWRhdGEuaWQgKyBcIjo6XCIgKyB3aW5uaW5nUmV2O1xuICAgICAgICBpbmRleC5nZXQoa2V5KS5vbnN1Y2Nlc3MgPSBmdW5jdGlvbiAoZXZlbnQpIHtcbiAgICAgICAgICBhbGxEb2NzSW5uZXIoZGVjb2RlTWV0YWRhdGEoY3Vyc29yLnZhbHVlKSwgZXZlbnQudGFyZ2V0LnJlc3VsdCk7XG4gICAgICAgIH07XG4gICAgICB9XG4gICAgfTtcbiAgfVxuXG4gIGZ1bmN0aW9uIGNvdW50RG9jcyhjYWxsYmFjaykge1xuICAgIGlmIChkb2NDb3VudCAhPT0gLTEpIHtcbiAgICAgIHJldHVybiBjYWxsYmFjayhudWxsLCBkb2NDb3VudCk7XG4gICAgfVxuXG4gICAgdmFyIGNvdW50O1xuICAgIHZhciB0eG4gPSBpZGIudHJhbnNhY3Rpb24oW0RPQ19TVE9SRV0sICdyZWFkb25seScpO1xuICAgIHZhciBpbmRleCA9IHR4bi5vYmplY3RTdG9yZShET0NfU1RPUkUpLmluZGV4KCdkZWxldGVkT3JMb2NhbCcpO1xuICAgIGluZGV4LmNvdW50KGdsb2JhbC5JREJLZXlSYW5nZS5vbmx5KFwiMFwiKSkub25zdWNjZXNzID0gZnVuY3Rpb24gKGUpIHtcbiAgICAgIGNvdW50ID0gZS50YXJnZXQucmVzdWx0O1xuICAgIH07XG4gICAgdHhuLm9uZXJyb3IgPSBpZGJFcnJvcihjYWxsYmFjayk7XG4gICAgdHhuLm9uY29tcGxldGUgPSBmdW5jdGlvbiAoKSB7XG4gICAgICBkb2NDb3VudCA9IGNvdW50O1xuICAgICAgY2FsbGJhY2sobnVsbCwgZG9jQ291bnQpO1xuICAgIH07XG4gIH1cblxuICBhcGkuX2FsbERvY3MgPSBmdW5jdGlvbiBpZGJfYWxsRG9jcyhvcHRzLCBjYWxsYmFjaykge1xuXG4gICAgLy8gZmlyc3QgY291bnQgdGhlIHRvdGFsX3Jvd3NcbiAgICBjb3VudERvY3MoZnVuY3Rpb24gKGVyciwgdG90YWxSb3dzKSB7XG4gICAgICBpZiAoZXJyKSB7XG4gICAgICAgIHJldHVybiBjYWxsYmFjayhlcnIpO1xuICAgICAgfVxuICAgICAgaWYgKG9wdHMubGltaXQgPT09IDApIHtcbiAgICAgICAgcmV0dXJuIGNhbGxiYWNrKG51bGwsIHtcbiAgICAgICAgICB0b3RhbF9yb3dzIDogdG90YWxSb3dzLFxuICAgICAgICAgIG9mZnNldCA6IG9wdHMuc2tpcCxcbiAgICAgICAgICByb3dzIDogW11cbiAgICAgICAgfSk7XG4gICAgICB9XG4gICAgICBhbGxEb2NzUXVlcnkodG90YWxSb3dzLCBvcHRzLCBjYWxsYmFjayk7XG4gICAgfSk7XG4gIH07XG5cbiAgYXBpLl9pbmZvID0gZnVuY3Rpb24gaWRiX2luZm8oY2FsbGJhY2spIHtcblxuICAgIGNvdW50RG9jcyhmdW5jdGlvbiAoZXJyLCBjb3VudCkge1xuICAgICAgaWYgKGVycikge1xuICAgICAgICByZXR1cm4gY2FsbGJhY2soZXJyKTtcbiAgICAgIH1cbiAgICAgIGlmIChpZGIgPT09IG51bGwpIHtcbiAgICAgICAgdmFyIGVycm9yID0gbmV3IEVycm9yKCdkYiBpc25cXCd0IG9wZW4nKTtcbiAgICAgICAgZXJyb3IuaWQgPSAnaWRiTnVsbCc7XG4gICAgICAgIHJldHVybiBjYWxsYmFjayhlcnJvcik7XG4gICAgICB9XG4gICAgICB2YXIgdXBkYXRlU2VxID0gMDtcbiAgICAgIHZhciB0eG4gPSBpZGIudHJhbnNhY3Rpb24oW01FVEFfU1RPUkVdLCAncmVhZG9ubHknKTtcblxuICAgICAgdHhuLm9iamVjdFN0b3JlKE1FVEFfU1RPUkUpLmdldChNRVRBX1NUT1JFKS5vbnN1Y2Nlc3MgPSBmdW5jdGlvbiAoZSkge1xuICAgICAgICB1cGRhdGVTZXEgPSBlLnRhcmdldC5yZXN1bHQgJiYgZS50YXJnZXQucmVzdWx0LnVwZGF0ZVNlcSB8fCAwO1xuICAgICAgfTtcblxuICAgICAgdHhuLm9uY29tcGxldGUgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIGNhbGxiYWNrKG51bGwsIHtcbiAgICAgICAgICBkb2NfY291bnQ6IGNvdW50LFxuICAgICAgICAgIHVwZGF0ZV9zZXE6IHVwZGF0ZVNlcVxuICAgICAgICB9KTtcbiAgICAgIH07XG4gICAgfSk7XG4gIH07XG5cbiAgYXBpLl9jaGFuZ2VzID0gZnVuY3Rpb24gKG9wdHMpIHtcbiAgICBvcHRzID0gdXRpbHMuY2xvbmUob3B0cyk7XG5cbiAgICBpZiAob3B0cy5jb250aW51b3VzKSB7XG4gICAgICB2YXIgaWQgPSBuYW1lICsgJzonICsgdXRpbHMudXVpZCgpO1xuICAgICAgSWRiUG91Y2guQ2hhbmdlcy5hZGRMaXN0ZW5lcihuYW1lLCBpZCwgYXBpLCBvcHRzKTtcbiAgICAgIElkYlBvdWNoLkNoYW5nZXMubm90aWZ5KG5hbWUpO1xuICAgICAgcmV0dXJuIHtcbiAgICAgICAgY2FuY2VsOiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgSWRiUG91Y2guQ2hhbmdlcy5yZW1vdmVMaXN0ZW5lcihuYW1lLCBpZCk7XG4gICAgICAgIH1cbiAgICAgIH07XG4gICAgfVxuXG4gICAgdmFyIGRlc2NlbmRpbmcgPSBvcHRzLmRlc2NlbmRpbmcgPyAncHJldicgOiBudWxsO1xuICAgIHZhciBsYXN0U2VxID0gMDtcblxuICAgIC8vIElnbm9yZSB0aGUgYHNpbmNlYCBwYXJhbWV0ZXIgd2hlbiBgZGVzY2VuZGluZ2AgaXMgdHJ1ZVxuICAgIG9wdHMuc2luY2UgPSBvcHRzLnNpbmNlICYmICFkZXNjZW5kaW5nID8gb3B0cy5zaW5jZSA6IDA7XG5cbiAgICB2YXIgbGltaXQgPSAnbGltaXQnIGluIG9wdHMgPyBvcHRzLmxpbWl0IDogLTE7XG4gICAgaWYgKGxpbWl0ID09PSAwKSB7XG4gICAgICBsaW1pdCA9IDE7IC8vIHBlciBDb3VjaERCIF9jaGFuZ2VzIHNwZWNcbiAgICB9XG4gICAgdmFyIHJldHVybkRvY3M7XG4gICAgaWYgKCdyZXR1cm5Eb2NzJyBpbiBvcHRzKSB7XG4gICAgICByZXR1cm5Eb2NzID0gb3B0cy5yZXR1cm5Eb2NzO1xuICAgIH0gZWxzZSB7XG4gICAgICByZXR1cm5Eb2NzID0gdHJ1ZTtcbiAgICB9XG5cbiAgICB2YXIgcmVzdWx0cyA9IFtdO1xuICAgIHZhciBudW1SZXN1bHRzID0gMDtcbiAgICB2YXIgZmlsdGVyID0gdXRpbHMuZmlsdGVyQ2hhbmdlKG9wdHMpO1xuXG4gICAgdmFyIHR4bjtcblxuICAgIGZ1bmN0aW9uIGZldGNoQ2hhbmdlcygpIHtcbiAgICAgIHR4biA9IGlkYi50cmFuc2FjdGlvbihbRE9DX1NUT1JFLCBCWV9TRVFfU1RPUkVdLCAncmVhZG9ubHknKTtcbiAgICAgIHR4bi5vbmNvbXBsZXRlID0gb25UeG5Db21wbGV0ZTtcblxuICAgICAgdmFyIHJlcTtcblxuICAgICAgaWYgKGRlc2NlbmRpbmcpIHtcbiAgICAgICAgcmVxID0gdHhuLm9iamVjdFN0b3JlKEJZX1NFUV9TVE9SRSlcbiAgICAgICAgICAgIC5vcGVuQ3Vyc29yKGdsb2JhbC5JREJLZXlSYW5nZS5sb3dlckJvdW5kKG9wdHMuc2luY2UsIHRydWUpLFxuICAgICAgICAgICAgICAgICAgICAgICAgZGVzY2VuZGluZyk7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICByZXEgPSB0eG4ub2JqZWN0U3RvcmUoQllfU0VRX1NUT1JFKVxuICAgICAgICAgICAgLm9wZW5DdXJzb3IoZ2xvYmFsLklEQktleVJhbmdlLmxvd2VyQm91bmQob3B0cy5zaW5jZSwgdHJ1ZSkpO1xuICAgICAgfVxuXG4gICAgICByZXEub25zdWNjZXNzID0gb25zdWNjZXNzO1xuICAgICAgcmVxLm9uZXJyb3IgPSBvbmVycm9yO1xuICAgIH1cblxuICAgIGZldGNoQ2hhbmdlcygpO1xuXG4gICAgZnVuY3Rpb24gb25zdWNjZXNzKGV2ZW50KSB7XG4gICAgICB2YXIgY3Vyc29yID0gZXZlbnQudGFyZ2V0LnJlc3VsdDtcblxuICAgICAgaWYgKCFjdXJzb3IpIHtcbiAgICAgICAgcmV0dXJuO1xuICAgICAgfVxuXG4gICAgICB2YXIgZG9jID0gY3Vyc29yLnZhbHVlO1xuXG4gICAgICBpZiAob3B0cy5kb2NfaWRzICYmIG9wdHMuZG9jX2lkcy5pbmRleE9mKGRvYy5faWQpID09PSAtMSkge1xuICAgICAgICByZXR1cm4gY3Vyc29yW1wiY29udGludWVcIl0oKTtcbiAgICAgIH1cblxuICAgICAgdmFyIGluZGV4ID0gdHhuLm9iamVjdFN0b3JlKERPQ19TVE9SRSk7XG4gICAgICBpbmRleC5nZXQoZG9jLl9pZCkub25zdWNjZXNzID0gZnVuY3Rpb24gKGV2ZW50KSB7XG4gICAgICAgIHZhciBtZXRhZGF0YSA9IGRlY29kZU1ldGFkYXRhKGV2ZW50LnRhcmdldC5yZXN1bHQpO1xuXG4gICAgICAgIGlmIChsYXN0U2VxIDwgbWV0YWRhdGEuc2VxKSB7XG4gICAgICAgICAgbGFzdFNlcSA9IG1ldGFkYXRhLnNlcTtcbiAgICAgICAgfVxuICAgICAgICAvLyBtZXRhZGF0YS53aW5uaW5nUmV2IHdhcyBvbmx5IGFkZGVkIGxhdGVyXG4gICAgICAgIHZhciB3aW5uaW5nUmV2ID0gbWV0YWRhdGEud2lubmluZ1JldiB8fCBtZXJnZS53aW5uaW5nUmV2KG1ldGFkYXRhKTtcbiAgICAgICAgaWYgKGRvYy5fcmV2ICE9PSB3aW5uaW5nUmV2KSB7XG4gICAgICAgICAgcmV0dXJuIGN1cnNvcltcImNvbnRpbnVlXCJdKCk7XG4gICAgICAgIH1cblxuICAgICAgICBkZWxldGUgZG9jWydfZG9jX2lkX3JldiddO1xuXG4gICAgICAgIHZhciBjaGFuZ2UgPSBvcHRzLnByb2Nlc3NDaGFuZ2UoZG9jLCBtZXRhZGF0YSwgb3B0cyk7XG4gICAgICAgIGNoYW5nZS5zZXEgPSBjdXJzb3Iua2V5O1xuICAgICAgICBpZiAoZmlsdGVyKGNoYW5nZSkpIHtcbiAgICAgICAgICBudW1SZXN1bHRzKys7XG4gICAgICAgICAgaWYgKHJldHVybkRvY3MpIHtcbiAgICAgICAgICAgIHJlc3VsdHMucHVzaChjaGFuZ2UpO1xuICAgICAgICAgIH1cbiAgICAgICAgICBvcHRzLm9uQ2hhbmdlKGNoYW5nZSk7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKG51bVJlc3VsdHMgIT09IGxpbWl0KSB7XG4gICAgICAgICAgY3Vyc29yW1wiY29udGludWVcIl0oKTtcbiAgICAgICAgfVxuICAgICAgfTtcbiAgICB9XG5cbiAgICBmdW5jdGlvbiBvblR4bkNvbXBsZXRlKCkge1xuICAgICAgaWYgKCFvcHRzLmNvbnRpbnVvdXMpIHtcbiAgICAgICAgb3B0cy5jb21wbGV0ZShudWxsLCB7XG4gICAgICAgICAgcmVzdWx0czogcmVzdWx0cyxcbiAgICAgICAgICBsYXN0X3NlcTogbGFzdFNlcVxuICAgICAgICB9KTtcbiAgICAgIH1cbiAgICB9XG4gIH07XG5cbiAgYXBpLl9jbG9zZSA9IGZ1bmN0aW9uIChjYWxsYmFjaykge1xuICAgIGlmIChpZGIgPT09IG51bGwpIHtcbiAgICAgIHJldHVybiBjYWxsYmFjayhlcnJvcnMuTk9UX09QRU4pO1xuICAgIH1cblxuICAgIC8vIGh0dHBzOi8vZGV2ZWxvcGVyLm1vemlsbGEub3JnL2VuLVVTL2RvY3MvSW5kZXhlZERCL0lEQkRhdGFiYXNlI2Nsb3NlXG4gICAgLy8gXCJSZXR1cm5zIGltbWVkaWF0ZWx5IGFuZCBjbG9zZXMgdGhlIGNvbm5lY3Rpb24gaW4gYSBzZXBhcmF0ZSB0aHJlYWQuLi5cIlxuICAgIGlkYi5jbG9zZSgpO1xuICAgIGRlbGV0ZSBjYWNoZWREQnNbbmFtZV07XG4gICAgaWRiID0gbnVsbDtcbiAgICBjYWxsYmFjaygpO1xuICB9O1xuXG4gIGFwaS5fZ2V0UmV2aXNpb25UcmVlID0gZnVuY3Rpb24gKGRvY0lkLCBjYWxsYmFjaykge1xuICAgIHZhciB0eG4gPSBpZGIudHJhbnNhY3Rpb24oW0RPQ19TVE9SRV0sICdyZWFkb25seScpO1xuICAgIHZhciByZXEgPSB0eG4ub2JqZWN0U3RvcmUoRE9DX1NUT1JFKS5nZXQoZG9jSWQpO1xuICAgIHJlcS5vbnN1Y2Nlc3MgPSBmdW5jdGlvbiAoZXZlbnQpIHtcbiAgICAgIHZhciBkb2MgPSBkZWNvZGVNZXRhZGF0YShldmVudC50YXJnZXQucmVzdWx0KTtcbiAgICAgIGlmICghZG9jKSB7XG4gICAgICAgIGNhbGxiYWNrKGVycm9ycy5NSVNTSU5HX0RPQyk7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICBjYWxsYmFjayhudWxsLCBkb2MucmV2X3RyZWUpO1xuICAgICAgfVxuICAgIH07XG4gIH07XG5cbiAgLy8gVGhpcyBmdW5jdGlvbiByZW1vdmVzIHJldmlzaW9ucyBvZiBkb2N1bWVudCBkb2NJZFxuICAvLyB3aGljaCBhcmUgbGlzdGVkIGluIHJldnMgYW5kIHNldHMgdGhpcyBkb2N1bWVudFxuICAvLyByZXZpc2lvbiB0byB0byByZXZfdHJlZVxuICBhcGkuX2RvQ29tcGFjdGlvbiA9IGZ1bmN0aW9uIChkb2NJZCwgcmV2X3RyZWUsIHJldnMsIGNhbGxiYWNrKSB7XG4gICAgdmFyIHR4biA9IGlkYi50cmFuc2FjdGlvbihbRE9DX1NUT1JFLCBCWV9TRVFfU1RPUkVdLCAncmVhZHdyaXRlJyk7XG5cbiAgICB2YXIgaW5kZXggPSB0eG4ub2JqZWN0U3RvcmUoRE9DX1NUT1JFKTtcbiAgICBpbmRleC5nZXQoZG9jSWQpLm9uc3VjY2VzcyA9IGZ1bmN0aW9uIChldmVudCkge1xuICAgICAgdmFyIG1ldGFkYXRhID0gZGVjb2RlTWV0YWRhdGEoZXZlbnQudGFyZ2V0LnJlc3VsdCk7XG4gICAgICBtZXRhZGF0YS5yZXZfdHJlZSA9IHJldl90cmVlO1xuXG4gICAgICB2YXIgY291bnQgPSByZXZzLmxlbmd0aDtcbiAgICAgIHJldnMuZm9yRWFjaChmdW5jdGlvbiAocmV2KSB7XG4gICAgICAgIHZhciBpbmRleCA9IHR4bi5vYmplY3RTdG9yZShCWV9TRVFfU1RPUkUpLmluZGV4KCdfZG9jX2lkX3JldicpO1xuICAgICAgICB2YXIga2V5ID0gZG9jSWQgKyBcIjo6XCIgKyByZXY7XG4gICAgICAgIGluZGV4LmdldEtleShrZXkpLm9uc3VjY2VzcyA9IGZ1bmN0aW9uIChlKSB7XG4gICAgICAgICAgdmFyIHNlcSA9IGUudGFyZ2V0LnJlc3VsdDtcbiAgICAgICAgICBpZiAoIXNlcSkge1xuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgIH1cbiAgICAgICAgICB0eG4ub2JqZWN0U3RvcmUoQllfU0VRX1NUT1JFKVtcImRlbGV0ZVwiXShzZXEpO1xuXG4gICAgICAgICAgY291bnQtLTtcbiAgICAgICAgICBpZiAoIWNvdW50KSB7XG4gICAgICAgICAgICAvLyB3aW5uaW5nUmV2IGlzIG5vdCBndWFyYW50ZWVkIHRvIGJlIHRoZXJlLCBzaW5jZSBpdCdzXG4gICAgICAgICAgICAvLyBub3QgZm9ybWFsbHkgbWlncmF0ZWQuIGRlbGV0ZWRPckxvY2FsIGlzIGFcbiAgICAgICAgICAgIC8vIG5vdy11bmZvcnR1bmF0ZSBuYW1lIHRoYXQgcmVhbGx5IGp1c3QgbWVhbnMgXCJkZWxldGVkXCJcbiAgICAgICAgICAgIHZhciB3aW5uaW5nUmV2ID0gbWV0YWRhdGEud2lubmluZ1JldiB8fFxuICAgICAgICAgICAgICBtZXJnZS53aW5uaW5nUmV2KG1ldGFkYXRhKTtcbiAgICAgICAgICAgIHZhciBkZWxldGVkID0gbWV0YWRhdGEuZGVsZXRlZE9yTG9jYWw7XG4gICAgICAgICAgICB0eG4ub2JqZWN0U3RvcmUoRE9DX1NUT1JFKS5wdXQoXG4gICAgICAgICAgICAgIGVuY29kZU1ldGFkYXRhKG1ldGFkYXRhLCB3aW5uaW5nUmV2LCBkZWxldGVkKSk7XG4gICAgICAgICAgfVxuICAgICAgICB9O1xuICAgICAgfSk7XG4gICAgfTtcbiAgICB0eG4ub25jb21wbGV0ZSA9IGZ1bmN0aW9uICgpIHtcbiAgICAgIHV0aWxzLmNhbGwoY2FsbGJhY2spO1xuICAgIH07XG4gIH07XG5cblxuICBhcGkuX2dldExvY2FsID0gZnVuY3Rpb24gKGlkLCBjYWxsYmFjaykge1xuICAgIHZhciB0eCA9IGlkYi50cmFuc2FjdGlvbihbTE9DQUxfU1RPUkVdLCAncmVhZG9ubHknKTtcbiAgICB2YXIgcmVxID0gdHgub2JqZWN0U3RvcmUoTE9DQUxfU1RPUkUpLmdldChpZCk7XG5cbiAgICByZXEub25lcnJvciA9IGlkYkVycm9yKGNhbGxiYWNrKTtcbiAgICByZXEub25zdWNjZXNzID0gZnVuY3Rpb24gKGUpIHtcbiAgICAgIHZhciBkb2MgPSBlLnRhcmdldC5yZXN1bHQ7XG4gICAgICBpZiAoIWRvYykge1xuICAgICAgICBjYWxsYmFjayhlcnJvcnMuTUlTU0lOR19ET0MpO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgZGVsZXRlIGRvY1snX2RvY19pZF9yZXYnXTtcbiAgICAgICAgY2FsbGJhY2sobnVsbCwgZG9jKTtcbiAgICAgIH1cbiAgICB9O1xuICB9O1xuXG4gIGFwaS5fcHV0TG9jYWwgPSBmdW5jdGlvbiAoZG9jLCBvcHRzLCBjYWxsYmFjaykge1xuICAgIGlmICh0eXBlb2Ygb3B0cyA9PT0gJ2Z1bmN0aW9uJykge1xuICAgICAgY2FsbGJhY2sgPSBvcHRzO1xuICAgICAgb3B0cyA9IHt9O1xuICAgIH1cbiAgICBkZWxldGUgZG9jLl9yZXZpc2lvbnM7IC8vIGlnbm9yZSB0aGlzLCB0cnVzdCB0aGUgcmV2XG4gICAgdmFyIG9sZFJldiA9IGRvYy5fcmV2O1xuICAgIHZhciBpZCA9IGRvYy5faWQ7XG4gICAgaWYgKCFvbGRSZXYpIHtcbiAgICAgIGRvYy5fcmV2ID0gJzAtMSc7XG4gICAgfSBlbHNlIHtcbiAgICAgIGRvYy5fcmV2ID0gJzAtJyArIChwYXJzZUludChvbGRSZXYuc3BsaXQoJy0nKVsxXSwgMTApICsgMSk7XG4gICAgfVxuICAgIGRvYy5fZG9jX2lkX3JldiA9IGlkICsgJzo6JyArIGRvYy5fcmV2O1xuXG4gICAgdmFyIHR4ID0gb3B0cy5jdHg7XG4gICAgdmFyIHJldDtcbiAgICBpZiAoIXR4KSB7XG4gICAgICB0eCA9IGlkYi50cmFuc2FjdGlvbihbTE9DQUxfU1RPUkVdLCAncmVhZHdyaXRlJyk7XG4gICAgICB0eC5vbmVycm9yID0gaWRiRXJyb3IoY2FsbGJhY2spO1xuICAgICAgdHgub25jb21wbGV0ZSA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgaWYgKHJldCkge1xuICAgICAgICAgIGNhbGxiYWNrKG51bGwsIHJldCk7XG4gICAgICAgIH1cbiAgICAgIH07XG4gICAgfVxuXG4gICAgdmFyIG9TdG9yZSA9IHR4Lm9iamVjdFN0b3JlKExPQ0FMX1NUT1JFKTtcbiAgICB2YXIgcmVxO1xuICAgIGlmIChvbGRSZXYpIHtcbiAgICAgIHZhciBpbmRleCA9IG9TdG9yZS5pbmRleCgnX2RvY19pZF9yZXYnKTtcbiAgICAgIHZhciBkb2NJZFJldiA9IGlkICsgJzo6JyArIG9sZFJldjtcbiAgICAgIHJlcSA9IGluZGV4LmdldChkb2NJZFJldik7XG4gICAgICByZXEub25zdWNjZXNzID0gZnVuY3Rpb24gKGUpIHtcbiAgICAgICAgaWYgKCFlLnRhcmdldC5yZXN1bHQpIHtcbiAgICAgICAgICBjYWxsYmFjayhlcnJvcnMuUkVWX0NPTkZMSUNUKTtcbiAgICAgICAgfSBlbHNlIHsgLy8gdXBkYXRlXG4gICAgICAgICAgdmFyIHJlcSA9IG9TdG9yZS5wdXQoZG9jKTtcbiAgICAgICAgICByZXEub25zdWNjZXNzID0gZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgcmV0ID0ge29rOiB0cnVlLCBpZDogZG9jLl9pZCwgcmV2OiBkb2MuX3Jldn07XG4gICAgICAgICAgICBpZiAob3B0cy5jdHgpIHsgLy8gcmV0dXRoaXMuaW1tZWRpYXRlbHlcbiAgICAgICAgICAgICAgY2FsbGJhY2sobnVsbCwgcmV0KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9O1xuICAgICAgICB9XG4gICAgICB9O1xuICAgIH0gZWxzZSB7IC8vIG5ldyBkb2NcbiAgICAgIHJlcSA9IG9TdG9yZS5nZXQoaWQpO1xuICAgICAgcmVxLm9uc3VjY2VzcyA9IGZ1bmN0aW9uIChlKSB7XG4gICAgICAgIGlmIChlLnRhcmdldC5yZXN1bHQpIHsgLy8gYWxyZWFkeSBleGlzdHNcbiAgICAgICAgICBjYWxsYmFjayhlcnJvcnMuUkVWX0NPTkZMSUNUKTtcbiAgICAgICAgfSBlbHNlIHsgLy8gaW5zZXJ0XG4gICAgICAgICAgdmFyIHJlcSA9IG9TdG9yZS5wdXQoZG9jKTtcbiAgICAgICAgICByZXEub25zdWNjZXNzID0gZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgcmV0ID0ge29rOiB0cnVlLCBpZDogZG9jLl9pZCwgcmV2OiBkb2MuX3Jldn07XG4gICAgICAgICAgICBpZiAob3B0cy5jdHgpIHsgLy8gcmV0dXJuIGltbWVkaWF0ZWx5XG4gICAgICAgICAgICAgIGNhbGxiYWNrKG51bGwsIHJldCk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgfTtcbiAgICAgICAgfVxuICAgICAgfTtcbiAgICB9XG4gIH07XG5cbiAgYXBpLl9yZW1vdmVMb2NhbCA9IGZ1bmN0aW9uIChkb2MsIGNhbGxiYWNrKSB7XG4gICAgdmFyIHR4ID0gaWRiLnRyYW5zYWN0aW9uKFtMT0NBTF9TVE9SRV0sICdyZWFkd3JpdGUnKTtcbiAgICB2YXIgcmV0O1xuICAgIHR4Lm9uY29tcGxldGUgPSBmdW5jdGlvbiAoKSB7XG4gICAgICBpZiAocmV0KSB7XG4gICAgICAgIGNhbGxiYWNrKG51bGwsIHJldCk7XG4gICAgICB9XG4gICAgfTtcbiAgICB2YXIgZG9jSWRSZXYgPSBkb2MuX2lkICsgJzo6JyArIGRvYy5fcmV2O1xuICAgIHZhciBvU3RvcmUgPSB0eC5vYmplY3RTdG9yZShMT0NBTF9TVE9SRSk7XG4gICAgdmFyIGluZGV4ID0gb1N0b3JlLmluZGV4KCdfZG9jX2lkX3JldicpO1xuICAgIHZhciByZXEgPSBpbmRleC5nZXQoZG9jSWRSZXYpO1xuXG4gICAgcmVxLm9uZXJyb3IgPSBpZGJFcnJvcihjYWxsYmFjayk7XG4gICAgcmVxLm9uc3VjY2VzcyA9IGZ1bmN0aW9uIChlKSB7XG4gICAgICB2YXIgZG9jID0gZS50YXJnZXQucmVzdWx0O1xuICAgICAgaWYgKCFkb2MpIHtcbiAgICAgICAgY2FsbGJhY2soZXJyb3JzLk1JU1NJTkdfRE9DKTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIHZhciByZXEgPSBpbmRleC5nZXRLZXkoZG9jSWRSZXYpO1xuICAgICAgICByZXEub25zdWNjZXNzID0gZnVuY3Rpb24gKGUpIHtcbiAgICAgICAgICB2YXIga2V5ID0gZS50YXJnZXQucmVzdWx0O1xuICAgICAgICAgIG9TdG9yZVtcImRlbGV0ZVwiXShrZXkpO1xuICAgICAgICAgIHJldCA9IHtvazogdHJ1ZSwgaWQ6IGRvYy5faWQsIHJldjogJzAtMCd9O1xuICAgICAgICB9O1xuICAgICAgfVxuICAgIH07XG4gIH07XG5cbiAgdmFyIGNhY2hlZCA9IGNhY2hlZERCc1tuYW1lXTtcblxuICBpZiAoY2FjaGVkKSB7XG4gICAgaWRiID0gY2FjaGVkLmlkYjtcbiAgICBibG9iU3VwcG9ydCA9IGNhY2hlZC5ibG9iU3VwcG9ydDtcbiAgICBpbnN0YW5jZUlkID0gY2FjaGVkLmluc3RhbmNlSWQ7XG4gICAgaWRTdG9yZWQgPSBjYWNoZWQuaWRTdG9yZWQ7XG4gICAgcHJvY2Vzcy5uZXh0VGljayhmdW5jdGlvbiAoKSB7XG4gICAgICBjYWxsYmFjayhudWxsLCBhcGkpO1xuICAgIH0pO1xuICAgIHJldHVybjtcbiAgfVxuXG4gIHZhciByZXEgPSBnbG9iYWwuaW5kZXhlZERCLm9wZW4obmFtZSwgQURBUFRFUl9WRVJTSU9OKTtcblxuICBpZiAoISgnb3BlblJlcUxpc3QnIGluIElkYlBvdWNoKSkge1xuICAgIElkYlBvdWNoLm9wZW5SZXFMaXN0ID0ge307XG4gIH1cbiAgSWRiUG91Y2gub3BlblJlcUxpc3RbbmFtZV0gPSByZXE7XG5cbiAgcmVxLm9udXBncmFkZW5lZWRlZCA9IGZ1bmN0aW9uIChlKSB7XG4gICAgdmFyIGRiID0gZS50YXJnZXQucmVzdWx0O1xuICAgIGlmIChlLm9sZFZlcnNpb24gPCAxKSB7XG4gICAgICAvLyBpbml0aWFsIHNjaGVtYVxuICAgICAgY3JlYXRlU2NoZW1hKGRiKTtcbiAgICB9XG4gICAgaWYgKGUub2xkVmVyc2lvbiA8IDMpIHtcbiAgICAgIGNyZWF0ZUxvY2FsU3RvcmVTY2hlbWEoZGIpO1xuICAgICAgaWYgKGUub2xkVmVyc2lvbiA8IDIpIHtcbiAgICAgICAgLy8gdmVyc2lvbiAyIGFkZHMgdGhlIGRlbGV0ZWRPckxvY2FsIGluZGV4XG4gICAgICAgIGFkZERlbGV0ZWRPckxvY2FsSW5kZXgoZSwgZnVuY3Rpb24gKHRyYW5zYWN0aW9uKSB7XG4gICAgICAgICAgbWlncmF0ZUxvY2FsU3RvcmUoZSwgdHJhbnNhY3Rpb24pO1xuICAgICAgICB9KTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIG1pZ3JhdGVMb2NhbFN0b3JlKGUpO1xuICAgICAgfVxuICAgIH1cbiAgfTtcblxuICByZXEub25zdWNjZXNzID0gZnVuY3Rpb24gKGUpIHtcblxuICAgIGlkYiA9IGUudGFyZ2V0LnJlc3VsdDtcblxuICAgIGlkYi5vbnZlcnNpb25jaGFuZ2UgPSBmdW5jdGlvbiAoKSB7XG4gICAgICBpZGIuY2xvc2UoKTtcbiAgICAgIGRlbGV0ZSBjYWNoZWREQnNbbmFtZV07XG4gICAgfTtcbiAgICBpZGIub25hYm9ydCA9IGZ1bmN0aW9uICgpIHtcbiAgICAgIGlkYi5jbG9zZSgpO1xuICAgICAgZGVsZXRlIGNhY2hlZERCc1tuYW1lXTtcbiAgICB9O1xuXG4gICAgdmFyIHR4biA9IGlkYi50cmFuc2FjdGlvbihbTUVUQV9TVE9SRSwgREVURUNUX0JMT0JfU1VQUE9SVF9TVE9SRV0sXG4gICAgICAncmVhZHdyaXRlJyk7XG5cbiAgICB2YXIgcmVxID0gdHhuLm9iamVjdFN0b3JlKE1FVEFfU1RPUkUpLmdldChNRVRBX1NUT1JFKTtcblxuICAgIHJlcS5vbnN1Y2Nlc3MgPSBmdW5jdGlvbiAoZSkge1xuXG4gICAgICB2YXIgY2hlY2tTZXR1cENvbXBsZXRlID0gZnVuY3Rpb24gKCkge1xuICAgICAgICBpZiAoYmxvYlN1cHBvcnQgPT09IG51bGwgfHwgIWlkU3RvcmVkKSB7XG4gICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgIGNhY2hlZERCc1tuYW1lXSA9IHtcbiAgICAgICAgICAgIGlkYjogaWRiLFxuICAgICAgICAgICAgYmxvYlN1cHBvcnQ6IGJsb2JTdXBwb3J0LFxuICAgICAgICAgICAgaW5zdGFuY2VJZDogaW5zdGFuY2VJZCxcbiAgICAgICAgICAgIGlkU3RvcmVkOiBpZFN0b3JlZCxcbiAgICAgICAgICAgIGxvYWRlZDogdHJ1ZVxuICAgICAgICAgIH07XG4gICAgICAgICAgY2FsbGJhY2sobnVsbCwgYXBpKTtcbiAgICAgICAgfVxuICAgICAgfTtcblxuICAgICAgdmFyIG1ldGEgPSBlLnRhcmdldC5yZXN1bHQgfHwge2lkOiBNRVRBX1NUT1JFfTtcbiAgICAgIGlmIChuYW1lICArICdfaWQnIGluIG1ldGEpIHtcbiAgICAgICAgaW5zdGFuY2VJZCA9IG1ldGFbbmFtZSArICdfaWQnXTtcbiAgICAgICAgaWRTdG9yZWQgPSB0cnVlO1xuICAgICAgICBjaGVja1NldHVwQ29tcGxldGUoKTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIGluc3RhbmNlSWQgPSB1dGlscy51dWlkKCk7XG4gICAgICAgIG1ldGFbbmFtZSArICdfaWQnXSA9IGluc3RhbmNlSWQ7XG4gICAgICAgIHR4bi5vYmplY3RTdG9yZShNRVRBX1NUT1JFKS5wdXQobWV0YSkub25zdWNjZXNzID0gZnVuY3Rpb24gKCkge1xuICAgICAgICAgIGlkU3RvcmVkID0gdHJ1ZTtcbiAgICAgICAgICBjaGVja1NldHVwQ29tcGxldGUoKTtcbiAgICAgICAgfTtcbiAgICAgIH1cblxuICAgICAgLy8gRGV0ZWN0IGJsb2Igc3VwcG9ydC4gQ2hyb21lIGRpZG4ndCBzdXBwb3J0IGl0IHVudGlsIHZlcnNpb24gMzguXG4gICAgICAvLyBpbiB2ZXJzaW9uIDM3IHRoZXkgaGFkIGEgYnJva2VuIHZlcnNpb24gd2hlcmUgUE5HcyAoYW5kIHBvc3NpYmx5XG4gICAgICAvLyBvdGhlciBiaW5hcnkgdHlwZXMpIGFyZW4ndCBzdG9yZWQgY29ycmVjdGx5LlxuICAgICAgdHJ5IHtcbiAgICAgICAgdmFyIGJsb2IgPSB1dGlscy5jcmVhdGVCbG9iKFsnJ10sIHt0eXBlOiAnaW1hZ2UvcG5nJ30pO1xuICAgICAgICB0eG4ub2JqZWN0U3RvcmUoREVURUNUX0JMT0JfU1VQUE9SVF9TVE9SRSkucHV0KGJsb2IsICdrZXknKTtcbiAgICAgICAgdHhuLm9uY29tcGxldGUgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgLy8gaGF2ZSB0byBkbyBpdCBpbiBhIHNlcGFyYXRlIHRyYW5zYWN0aW9uLCBlbHNlIHRoZSBjb3JyZWN0XG4gICAgICAgICAgLy8gY29udGVudCB0eXBlIGlzIGFsd2F5cyByZXR1cm5lZFxuICAgICAgICAgIHR4biA9IGlkYi50cmFuc2FjdGlvbihbTUVUQV9TVE9SRSwgREVURUNUX0JMT0JfU1VQUE9SVF9TVE9SRV0sXG4gICAgICAgICAgICAncmVhZHdyaXRlJyk7XG4gICAgICAgICAgdmFyIGdldEJsb2JSZXEgPSB0eG4ub2JqZWN0U3RvcmUoXG4gICAgICAgICAgICBERVRFQ1RfQkxPQl9TVVBQT1JUX1NUT1JFKS5nZXQoJ2tleScpO1xuICAgICAgICAgIGdldEJsb2JSZXEub25zdWNjZXNzID0gZnVuY3Rpb24gKGUpIHtcbiAgICAgICAgICAgIHZhciBzdG9yZWRCbG9iID0gZS50YXJnZXQucmVzdWx0O1xuICAgICAgICAgICAgdmFyIHVybCA9IFVSTC5jcmVhdGVPYmplY3RVUkwoc3RvcmVkQmxvYik7XG4gICAgICAgICAgICB1dGlscy5hamF4KHtcbiAgICAgICAgICAgICAgdXJsOiB1cmwsXG4gICAgICAgICAgICAgIGNhY2hlOiB0cnVlLFxuICAgICAgICAgICAgICBiaW5hcnk6IHRydWVcbiAgICAgICAgICAgIH0sIGZ1bmN0aW9uIChlcnIsIHJlcykge1xuICAgICAgICAgICAgICBpZiAoZXJyICYmIGVyci5zdGF0dXMgPT09IDQwNSkge1xuICAgICAgICAgICAgICAgIC8vIGZpcmVmb3ggd29uJ3QgbGV0IHVzIGRvIHRoYXQuIGJ1dCBmaXJlZm94IGRvZXNuJ3RcbiAgICAgICAgICAgICAgICAvLyBoYXZlIHRoZSBibG9iIHR5cGUgYnVnIHRoYXQgQ2hyb21lIGRvZXMsIHNvIHRoYXQncyBva1xuICAgICAgICAgICAgICAgIGJsb2JTdXBwb3J0ID0gdHJ1ZTtcbiAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICBibG9iU3VwcG9ydCA9ICEhKHJlcyAmJiByZXMudHlwZSA9PT0gJ2ltYWdlL3BuZycpO1xuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgIGNoZWNrU2V0dXBDb21wbGV0ZSgpO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgfTtcbiAgICAgICAgfTtcbiAgICAgIH0gY2F0Y2ggKGVycikge1xuICAgICAgICBibG9iU3VwcG9ydCA9IGZhbHNlO1xuICAgICAgICBjaGVja1NldHVwQ29tcGxldGUoKTtcbiAgICAgIH1cbiAgICB9O1xuICB9O1xuXG4gIHJlcS5vbmVycm9yID0gaWRiRXJyb3IoY2FsbGJhY2spO1xuXG59XG5cbklkYlBvdWNoLnZhbGlkID0gZnVuY3Rpb24gKCkge1xuICAvLyBJc3N1ZSAjMjUzMywgd2UgZmluYWxseSBnYXZlIHVwIG9uIGRvaW5nIGJ1Z1xuICAvLyBkZXRlY3Rpb24gaW5zdGVhZCBvZiBicm93c2VyIHNuaWZmaW5nLiBTYWZhcmkgYnJvdWdodCB1c1xuICAvLyB0byBvdXIga25lZXMuXG4gIHZhciBpc1NhZmFyaSA9IHR5cGVvZiBvcGVuRGF0YWJhc2UgIT09ICd1bmRlZmluZWQnICYmXG4gICAgL1NhZmFyaS8udGVzdChuYXZpZ2F0b3IudXNlckFnZW50KSAmJlxuICAgICEvQ2hyb21lLy50ZXN0KG5hdmlnYXRvci51c2VyQWdlbnQpO1xuICByZXR1cm4gIWlzU2FmYXJpICYmIGdsb2JhbC5pbmRleGVkREIgJiYgaXNNb2Rlcm5JZGIoKTtcbn07XG5cbmZ1bmN0aW9uIGRlc3Ryb3kobmFtZSwgb3B0cywgY2FsbGJhY2spIHtcbiAgaWYgKCEoJ29wZW5SZXFMaXN0JyBpbiBJZGJQb3VjaCkpIHtcbiAgICBJZGJQb3VjaC5vcGVuUmVxTGlzdCA9IHt9O1xuICB9XG4gIElkYlBvdWNoLkNoYW5nZXMucmVtb3ZlQWxsTGlzdGVuZXJzKG5hbWUpO1xuXG4gIC8vQ2xvc2Ugb3BlbiByZXF1ZXN0IGZvciBcIm5hbWVcIiBkYXRhYmFzZSB0byBmaXggaWUgZGVsYXkuXG4gIGlmIChJZGJQb3VjaC5vcGVuUmVxTGlzdFtuYW1lXSAmJiBJZGJQb3VjaC5vcGVuUmVxTGlzdFtuYW1lXS5yZXN1bHQpIHtcbiAgICBJZGJQb3VjaC5vcGVuUmVxTGlzdFtuYW1lXS5yZXN1bHQuY2xvc2UoKTtcbiAgfVxuICB2YXIgcmVxID0gZ2xvYmFsLmluZGV4ZWREQi5kZWxldGVEYXRhYmFzZShuYW1lKTtcblxuICByZXEub25zdWNjZXNzID0gZnVuY3Rpb24gKCkge1xuICAgIC8vUmVtb3ZlIG9wZW4gcmVxdWVzdCBmcm9tIHRoZSBsaXN0LlxuICAgIGlmIChJZGJQb3VjaC5vcGVuUmVxTGlzdFtuYW1lXSkge1xuICAgICAgSWRiUG91Y2gub3BlblJlcUxpc3RbbmFtZV0gPSBudWxsO1xuICAgIH1cbiAgICBpZiAodXRpbHMuaGFzTG9jYWxTdG9yYWdlKCkgJiYgKG5hbWUgaW4gZ2xvYmFsLmxvY2FsU3RvcmFnZSkpIHtcbiAgICAgIGRlbGV0ZSBnbG9iYWwubG9jYWxTdG9yYWdlW25hbWVdO1xuICAgIH1cbiAgICBkZWxldGUgY2FjaGVkREJzW25hbWVdO1xuICAgIGNhbGxiYWNrKG51bGwsIHsgJ29rJzogdHJ1ZSB9KTtcbiAgfTtcblxuICByZXEub25lcnJvciA9IGlkYkVycm9yKGNhbGxiYWNrKTtcbn1cblxuSWRiUG91Y2guZGVzdHJveSA9IHV0aWxzLnRvUHJvbWlzZShmdW5jdGlvbiAobmFtZSwgb3B0cywgY2FsbGJhY2spIHtcbiAgdGFza1F1ZXVlLnF1ZXVlLnB1c2goe1xuICAgIGFjdGlvbjogZnVuY3Rpb24gKHRoaXNDYWxsYmFjaykge1xuICAgICAgZGVzdHJveShuYW1lLCBvcHRzLCB0aGlzQ2FsbGJhY2spO1xuICAgIH0sXG4gICAgY2FsbGJhY2s6IGNhbGxiYWNrXG4gIH0pO1xuICBhcHBseU5leHQoKTtcbn0pO1xuXG5JZGJQb3VjaC5DaGFuZ2VzID0gbmV3IHV0aWxzLkNoYW5nZXMoKTtcblxubW9kdWxlLmV4cG9ydHMgPSBJZGJQb3VjaDtcblxufSkuY2FsbCh0aGlzLF9kZXJlcV8oXCIvVXNlcnMvbm9sYW4vd29ya3NwYWNlL3BvdWNoZGIvbm9kZV9tb2R1bGVzL2Jyb3dzZXJpZnkvbm9kZV9tb2R1bGVzL2luc2VydC1tb2R1bGUtZ2xvYmFscy9ub2RlX21vZHVsZXMvcHJvY2Vzcy9icm93c2VyLmpzXCIpLHR5cGVvZiBzZWxmICE9PSBcInVuZGVmaW5lZFwiID8gc2VsZiA6IHR5cGVvZiB3aW5kb3cgIT09IFwidW5kZWZpbmVkXCIgPyB3aW5kb3cgOiB7fSlcbn0se1wiLi4vZGVwcy9lcnJvcnNcIjoxMSxcIi4uL21lcmdlXCI6MTgsXCIuLi91dGlsc1wiOjIzLFwiL1VzZXJzL25vbGFuL3dvcmtzcGFjZS9wb3VjaGRiL25vZGVfbW9kdWxlcy9icm93c2VyaWZ5L25vZGVfbW9kdWxlcy9pbnNlcnQtbW9kdWxlLWdsb2JhbHMvbm9kZV9tb2R1bGVzL3Byb2Nlc3MvYnJvd3Nlci5qc1wiOjI4LFwidnV2dXplbGFcIjo1OH1dLDQ6W2Z1bmN0aW9uKF9kZXJlcV8sbW9kdWxlLGV4cG9ydHMpe1xubW9kdWxlLmV4cG9ydHMgPSBbJ2lkYicsICd3ZWJzcWwnXTtcbn0se31dLDU6W2Z1bmN0aW9uKF9kZXJlcV8sbW9kdWxlLGV4cG9ydHMpe1xuKGZ1bmN0aW9uIChnbG9iYWwpe1xuJ3VzZSBzdHJpY3QnO1xuXG52YXIgdXRpbHMgPSBfZGVyZXFfKCcuLi91dGlscycpO1xudmFyIG1lcmdlID0gX2RlcmVxXygnLi4vbWVyZ2UnKTtcbnZhciBlcnJvcnMgPSBfZGVyZXFfKCcuLi9kZXBzL2Vycm9ycycpO1xudmFyIHZ1dnV6ZWxhID0gX2RlcmVxXygndnV2dXplbGEnKTtcbmZ1bmN0aW9uIHF1b3RlKHN0cikge1xuICByZXR1cm4gXCInXCIgKyBzdHIgKyBcIidcIjtcbn1cblxudmFyIGNhY2hlZERhdGFiYXNlcyA9IHt9O1xuXG52YXIgb3BlbkRCID0gdXRpbHMuZ2V0QXJndW1lbnRzKGZ1bmN0aW9uIChhcmdzKSB7XG4gIGlmICh0eXBlb2YgZ2xvYmFsICE9PSAndW5kZWZpbmVkJykge1xuICAgIGlmIChnbG9iYWwubmF2aWdhdG9yICYmIGdsb2JhbC5uYXZpZ2F0b3Iuc3FsaXRlUGx1Z2luICYmXG4gICAgICAgIGdsb2JhbC5uYXZpZ2F0b3Iuc3FsaXRlUGx1Z2luLm9wZW5EYXRhYmFzZSkge1xuICAgICAgcmV0dXJuIG5hdmlnYXRvci5zcWxpdGVQbHVnaW4ub3BlbkRhdGFiYXNlXG4gICAgICAgIC5hcHBseShuYXZpZ2F0b3Iuc3FsaXRlUGx1Z2luLCBhcmdzKTtcbiAgICB9IGVsc2UgaWYgKGdsb2JhbC5zcWxpdGVQbHVnaW4gJiYgZ2xvYmFsLnNxbGl0ZVBsdWdpbi5vcGVuRGF0YWJhc2UpIHtcbiAgICAgIHJldHVybiBnbG9iYWwuc3FsaXRlUGx1Z2luLm9wZW5EYXRhYmFzZVxuICAgICAgICAuYXBwbHkoZ2xvYmFsLnNxbGl0ZVBsdWdpbiwgYXJncyk7XG4gICAgfSBlbHNlIHtcbiAgICAgIHZhciBkYiA9IGNhY2hlZERhdGFiYXNlc1thcmdzWzBdXTtcbiAgICAgIGlmICghZGIpIHtcbiAgICAgICAgZGIgPSBjYWNoZWREYXRhYmFzZXNbYXJnc1swXV0gPVxuICAgICAgICAgIGdsb2JhbC5vcGVuRGF0YWJhc2UuYXBwbHkoZ2xvYmFsLCBhcmdzKTtcbiAgICAgIH1cbiAgICAgIHJldHVybiBkYjtcbiAgICB9XG4gIH1cbn0pO1xuXG52YXIgUE9VQ0hfVkVSU0lPTiA9IDE7XG52YXIgQURBUFRFUl9WRVJTSU9OID0gNDsgLy8gdXNlZCB0byBtYW5hZ2UgbWlncmF0aW9uc1xuXG4vLyBUaGUgb2JqZWN0IHN0b3JlcyBjcmVhdGVkIGZvciBlYWNoIGRhdGFiYXNlXG4vLyBET0NfU1RPUkUgc3RvcmVzIHRoZSBkb2N1bWVudCBtZXRhIGRhdGEsIGl0cyByZXZpc2lvbiBoaXN0b3J5IGFuZCBzdGF0ZVxudmFyIERPQ19TVE9SRSA9IHF1b3RlKCdkb2N1bWVudC1zdG9yZScpO1xuLy8gQllfU0VRX1NUT1JFIHN0b3JlcyBhIHBhcnRpY3VsYXIgdmVyc2lvbiBvZiBhIGRvY3VtZW50LCBrZXllZCBieSBpdHNcbi8vIHNlcXVlbmNlIGlkXG52YXIgQllfU0VRX1NUT1JFID0gcXVvdGUoJ2J5LXNlcXVlbmNlJyk7XG4vLyBXaGVyZSB3ZSBzdG9yZSBhdHRhY2htZW50c1xudmFyIEFUVEFDSF9TVE9SRSA9IHF1b3RlKCdhdHRhY2gtc3RvcmUnKTtcbnZhciBMT0NBTF9TVE9SRSA9IHF1b3RlKCdsb2NhbC1zdG9yZScpO1xudmFyIE1FVEFfU1RPUkUgPSBxdW90ZSgnbWV0YWRhdGEtc3RvcmUnKTtcblxuLy8gdGhlc2UgaW5kZXhlcyBjb3ZlciB0aGUgZ3JvdW5kIGZvciBtb3N0IGFsbERvY3MgcXVlcmllc1xudmFyIEJZX1NFUV9TVE9SRV9ERUxFVEVEX0lOREVYX1NRTCA9XG4gICdDUkVBVEUgSU5ERVggSUYgTk9UIEVYSVNUUyBcXCdieS1zZXEtZGVsZXRlZC1pZHhcXCcgT04gJyArXG4gIEJZX1NFUV9TVE9SRSArICcgKHNlcSwgZGVsZXRlZCknO1xudmFyIEJZX1NFUV9TVE9SRV9ET0NfSURfUkVWX0lOREVYX1NRTCA9XG4gICdDUkVBVEUgVU5JUVVFIElOREVYIElGIE5PVCBFWElTVFMgXFwnYnktc2VxLWRvYy1pZC1yZXZcXCcgT04gJyArXG4gICAgQllfU0VRX1NUT1JFICsgJyAoZG9jX2lkLCByZXYpJztcbnZhciBET0NfU1RPUkVfV0lOTklOR1NFUV9JTkRFWF9TUUwgPVxuICAnQ1JFQVRFIElOREVYIElGIE5PVCBFWElTVFMgXFwnZG9jLXdpbm5pbmdzZXEtaWR4XFwnIE9OICcgK1xuICBET0NfU1RPUkUgKyAnICh3aW5uaW5nc2VxKSc7XG5cbnZhciBET0NfU1RPUkVfQU5EX0JZX1NFUV9KT0lORVIgPSBCWV9TRVFfU1RPUkUgK1xuICAnLnNlcSA9ICcgKyBET0NfU1RPUkUgKyAnLndpbm5pbmdzZXEnO1xuXG52YXIgU0VMRUNUX0RPQ1MgPSBCWV9TRVFfU1RPUkUgKyAnLnNlcSBBUyBzZXEsICcgK1xuICBCWV9TRVFfU1RPUkUgKyAnLmRlbGV0ZWQgQVMgZGVsZXRlZCwgJyArXG4gIEJZX1NFUV9TVE9SRSArICcuanNvbiBBUyBkYXRhLCAnICtcbiAgQllfU0VRX1NUT1JFICsgJy5yZXYgQVMgcmV2LCAnICtcbiAgRE9DX1NUT1JFICsgJy5qc29uIEFTIG1ldGFkYXRhJztcblxuZnVuY3Rpb24gc2VsZWN0KHNlbGVjdG9yLCB0YWJsZSwgam9pbmVyLCB3aGVyZSwgb3JkZXJCeSkge1xuICByZXR1cm4gJ1NFTEVDVCAnICsgc2VsZWN0b3IgKyAnIEZST00gJyArXG4gICAgKHR5cGVvZiB0YWJsZSA9PT0gJ3N0cmluZycgPyB0YWJsZSA6IHRhYmxlLmpvaW4oJyBKT0lOICcpKSArXG4gICAgKGpvaW5lciA/ICgnIE9OICcgKyBqb2luZXIpIDogJycpICtcbiAgICAod2hlcmUgPyAoJyBXSEVSRSAnICtcbiAgICAgICh0eXBlb2Ygd2hlcmUgPT09ICdzdHJpbmcnID8gd2hlcmUgOiB3aGVyZS5qb2luKCcgQU5EICcpKSkgOiAnJykgK1xuICAgIChvcmRlckJ5ID8gKCcgT1JERVIgQlkgJyArIG9yZGVyQnkpIDogJycpO1xufVxuXG5mdW5jdGlvbiB1bmtub3duRXJyb3IoY2FsbGJhY2spIHtcbiAgcmV0dXJuIGZ1bmN0aW9uIChldmVudCkge1xuICAgIC8vIGV2ZW50IG1heSBhY3R1YWxseSBiZSBhIFNRTEVycm9yIG9iamVjdCwgc28gcmVwb3J0IGlzIGFzIHN1Y2hcbiAgICB2YXIgZXJyb3JOYW1lTWF0Y2ggPSBldmVudCAmJiBldmVudC5jb25zdHJ1Y3Rvci50b1N0cmluZygpXG4gICAgICAubWF0Y2goL2Z1bmN0aW9uIChbXlxcKF0rKS8pO1xuICAgIHZhciBlcnJvck5hbWUgPSAoZXJyb3JOYW1lTWF0Y2ggJiYgZXJyb3JOYW1lTWF0Y2hbMV0pIHx8IGV2ZW50LnR5cGU7XG4gICAgdmFyIGVycm9yUmVhc29uID0gZXZlbnQudGFyZ2V0IHx8IGV2ZW50Lm1lc3NhZ2U7XG4gICAgY2FsbGJhY2soZXJyb3JzLmVycm9yKGVycm9ycy5XU1FfRVJST1IsIGVycm9yUmVhc29uLCBlcnJvck5hbWUpKTtcbiAgfTtcbn1cbmZ1bmN0aW9uIGRlY29kZVV0Zjgoc3RyKSB7XG4gIHJldHVybiBkZWNvZGVVUklDb21wb25lbnQod2luZG93LmVzY2FwZShzdHIpKTtcbn1cbmZ1bmN0aW9uIHBhcnNlSGV4U3RyaW5nKHN0ciwgZW5jb2RpbmcpIHtcbiAgdmFyIHJlc3VsdCA9ICcnO1xuICB2YXIgY2hhcldpZHRoID0gZW5jb2RpbmcgPT09ICdVVEYtOCcgPyAyIDogNDtcbiAgZm9yICh2YXIgaSA9IDAsIGxlbiA9IHN0ci5sZW5ndGg7IGkgPCBsZW47IGkgKz0gY2hhcldpZHRoKSB7XG4gICAgdmFyIHN1YnN0cmluZyA9IHN0ci5zdWJzdHJpbmcoaSwgaSArIGNoYXJXaWR0aCk7XG4gICAgaWYgKGNoYXJXaWR0aCA9PT0gNCkgeyAvLyBVVEYtMTYsIHR3aWRkbGUgdGhlIGJpdHNcbiAgICAgIHN1YnN0cmluZyA9IHN1YnN0cmluZy5zdWJzdHJpbmcoMiwgNCkgKyBzdWJzdHJpbmcuc3Vic3RyaW5nKDAsIDIpO1xuICAgIH1cbiAgICByZXN1bHQgKz0gU3RyaW5nLmZyb21DaGFyQ29kZShwYXJzZUludChzdWJzdHJpbmcsIDE2KSk7XG4gIH1cbiAgcmVzdWx0ID0gZW5jb2RpbmcgPT09ICdVVEYtOCcgPyBkZWNvZGVVdGY4KHJlc3VsdCkgOiByZXN1bHQ7XG4gIHJldHVybiByZXN1bHQ7XG59XG5cbmZ1bmN0aW9uIHN0cmluZ2lmeURvYyhkb2MpIHtcbiAgLy8gZG9uJ3QgYm90aGVyIHN0b3JpbmcgdGhlIGlkL3Jldi4gaXQgdXNlcyBsb3RzIG9mIHNwYWNlLFxuICAvLyBpbiBwZXJzaXN0ZW50IG1hcC9yZWR1Y2UgZXNwZWNpYWxseVxuICBkZWxldGUgZG9jLl9pZDtcbiAgZGVsZXRlIGRvYy5fcmV2O1xuICByZXR1cm4gSlNPTi5zdHJpbmdpZnkoZG9jKTtcbn1cblxuZnVuY3Rpb24gdW5zdHJpbmdpZnlEb2MoZG9jLCBpZCwgcmV2KSB7XG4gIGRvYyA9IEpTT04ucGFyc2UoZG9jKTtcbiAgZG9jLl9pZCA9IGlkO1xuICBkb2MuX3JldiA9IHJldjtcbiAgcmV0dXJuIGRvYztcbn1cblxuZnVuY3Rpb24gZ2V0U2l6ZShvcHRzKSB7XG4gIGlmICgnc2l6ZScgaW4gb3B0cykge1xuICAgIC8vIHRyaWdnZXJzIGltbWVkaWF0ZSBwb3B1cCBpbiBpT1MsIGZpeGVzICMyMzQ3XG4gICAgLy8gZS5nLiA1MDAwMDAxIGFza3MgZm9yIDUgTUIsIDEwMDAwMDAxIGFza3MgZm9yIDEwIE1CLFxuICAgIHJldHVybiBvcHRzLnNpemUgKiAxMDAwMDAwO1xuICB9XG4gIC8vIEluIGlPUywgZG9lc24ndCBtYXR0ZXIgYXMgbG9uZyBhcyBpdCdzIDw9IDUwMDAwMDAuXG4gIC8vIEV4Y2VwdCB0aGF0IGlmIHlvdSByZXF1ZXN0IHRvbyBtdWNoLCBvdXIgdGVzdHMgZmFpbFxuICAvLyBiZWNhdXNlIG9mIHRoZSBuYXRpdmUgXCJkbyB5b3UgYWNjZXB0P1wiIHBvcHVwLlxuICAvLyBJbiBBbmRyb2lkIDw9NC4zLCB0aGlzIHZhbHVlIGlzIGFjdHVhbGx5IHVzZWQgYXMgYW5cbiAgLy8gaG9uZXN0LXRvLWdvZCBjZWlsaW5nIGZvciBkYXRhLCBzbyB3ZSBuZWVkIHRvXG4gIC8vIHNldCBpdCB0byBhIGRlY2VudGx5IGhpZ2ggbnVtYmVyLlxuICB2YXIgaXNBbmRyb2lkID0gL0FuZHJvaWQvLnRlc3Qod2luZG93Lm5hdmlnYXRvci51c2VyQWdlbnQpO1xuICByZXR1cm4gaXNBbmRyb2lkID8gNTAwMDAwMCA6IDE7XG59XG5cbmZ1bmN0aW9uIFdlYlNxbFBvdWNoKG9wdHMsIGNhbGxiYWNrKSB7XG4gIHZhciBhcGkgPSB0aGlzO1xuICB2YXIgaW5zdGFuY2VJZCA9IG51bGw7XG4gIHZhciBuYW1lID0gb3B0cy5uYW1lO1xuICB2YXIgc2l6ZSA9IGdldFNpemUob3B0cyk7XG4gIHZhciBpZFJlcXVlc3RzID0gW107XG4gIHZhciBkb2NDb3VudCA9IC0xOyAvLyBjYWNoZSBzcWxpdGUgY291bnQoKikgZm9yIHBlcmZvcm1hbmNlXG4gIHZhciBlbmNvZGluZztcblxuICB2YXIgZGIgPSBvcGVuREIobmFtZSwgUE9VQ0hfVkVSU0lPTiwgbmFtZSwgc2l6ZSk7XG4gIGlmICghZGIpIHtcbiAgICByZXR1cm4gY2FsbGJhY2soZXJyb3JzLlVOS05PV05fRVJST1IpO1xuICB9IGVsc2UgaWYgKHR5cGVvZiBkYi5yZWFkVHJhbnNhY3Rpb24gIT09ICdmdW5jdGlvbicpIHtcbiAgICAvLyBkb2Vzbid0IGV4aXN0IGluIHNxbGl0ZSBwbHVnaW5cbiAgICBkYi5yZWFkVHJhbnNhY3Rpb24gPSBkYi50cmFuc2FjdGlvbjtcbiAgfVxuXG4gIGZ1bmN0aW9uIGRiQ3JlYXRlZCgpIHtcbiAgICAvLyBub3RlIHRoZSBkYiBuYW1lIGluIGNhc2UgdGhlIGJyb3dzZXIgdXBncmFkZXMgdG8gaWRiXG4gICAgaWYgKHV0aWxzLmhhc0xvY2FsU3RvcmFnZSgpKSB7XG4gICAgICBnbG9iYWwubG9jYWxTdG9yYWdlWydfcG91Y2hfX3dlYnNxbGRiXycgKyBuYW1lXSA9IHRydWU7XG4gICAgfVxuICAgIGNhbGxiYWNrKG51bGwsIGFwaSk7XG4gIH1cblxuICAvLyBJbiB0aGlzIG1pZ3JhdGlvbiwgd2UgYWRkZWQgdGhlICdkZWxldGVkJyBhbmQgJ2xvY2FsJyBjb2x1bW5zIHRvIHRoZVxuICAvLyBieS1zZXEgYW5kIGRvYyBzdG9yZSB0YWJsZXMuXG4gIC8vIFRvIHByZXNlcnZlIGV4aXN0aW5nIHVzZXIgZGF0YSwgd2UgcmUtcHJvY2VzcyBhbGwgdGhlIGV4aXN0aW5nIEpTT05cbiAgLy8gYW5kIGFkZCB0aGVzZSB2YWx1ZXMuXG4gIC8vIENhbGxlZCBtaWdyYXRpb24yIGJlY2F1c2UgaXQgY29ycmVzcG9uZHMgdG8gYWRhcHRlciB2ZXJzaW9uIChkYl92ZXJzaW9uKSAjMlxuICBmdW5jdGlvbiBydW5NaWdyYXRpb24yKHR4LCBjYWxsYmFjaykge1xuICAgIC8vIGluZGV4IHVzZWQgZm9yIHRoZSBqb2luIGluIHRoZSBhbGxEb2NzIHF1ZXJ5XG4gICAgdHguZXhlY3V0ZVNxbChET0NfU1RPUkVfV0lOTklOR1NFUV9JTkRFWF9TUUwpO1xuXG4gICAgdHguZXhlY3V0ZVNxbCgnQUxURVIgVEFCTEUgJyArIEJZX1NFUV9TVE9SRSArXG4gICAgICAnIEFERCBDT0xVTU4gZGVsZXRlZCBUSU5ZSU5UKDEpIERFRkFVTFQgMCcsIFtdLCBmdW5jdGlvbiAoKSB7XG4gICAgICB0eC5leGVjdXRlU3FsKEJZX1NFUV9TVE9SRV9ERUxFVEVEX0lOREVYX1NRTCk7XG4gICAgICB0eC5leGVjdXRlU3FsKCdBTFRFUiBUQUJMRSAnICsgRE9DX1NUT1JFICtcbiAgICAgICAgJyBBREQgQ09MVU1OIGxvY2FsIFRJTllJTlQoMSkgREVGQVVMVCAwJywgW10sIGZ1bmN0aW9uICgpIHtcbiAgICAgICAgdHguZXhlY3V0ZVNxbCgnQ1JFQVRFIElOREVYIElGIE5PVCBFWElTVFMgXFwnZG9jLXN0b3JlLWxvY2FsLWlkeFxcJyBPTiAnICtcbiAgICAgICAgICBET0NfU1RPUkUgKyAnIChsb2NhbCwgaWQpJyk7XG5cbiAgICAgICAgdmFyIHNxbCA9ICdTRUxFQ1QgJyArIERPQ19TVE9SRSArICcud2lubmluZ3NlcSBBUyBzZXEsICcgKyBET0NfU1RPUkUgK1xuICAgICAgICAgICcuanNvbiBBUyBtZXRhZGF0YSBGUk9NICcgKyBCWV9TRVFfU1RPUkUgKyAnIEpPSU4gJyArIERPQ19TVE9SRSArXG4gICAgICAgICAgJyBPTiAnICsgQllfU0VRX1NUT1JFICsgJy5zZXEgPSAnICsgRE9DX1NUT1JFICsgJy53aW5uaW5nc2VxJztcblxuICAgICAgICB0eC5leGVjdXRlU3FsKHNxbCwgW10sIGZ1bmN0aW9uICh0eCwgcmVzdWx0KSB7XG5cbiAgICAgICAgICB2YXIgZGVsZXRlZCA9IFtdO1xuICAgICAgICAgIHZhciBsb2NhbCA9IFtdO1xuXG4gICAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCByZXN1bHQucm93cy5sZW5ndGg7IGkrKykge1xuICAgICAgICAgICAgdmFyIGl0ZW0gPSByZXN1bHQucm93cy5pdGVtKGkpO1xuICAgICAgICAgICAgdmFyIHNlcSA9IGl0ZW0uc2VxO1xuICAgICAgICAgICAgdmFyIG1ldGFkYXRhID0gSlNPTi5wYXJzZShpdGVtLm1ldGFkYXRhKTtcbiAgICAgICAgICAgIGlmICh1dGlscy5pc0RlbGV0ZWQobWV0YWRhdGEpKSB7XG4gICAgICAgICAgICAgIGRlbGV0ZWQucHVzaChzZXEpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYgKHV0aWxzLmlzTG9jYWxJZChtZXRhZGF0YS5pZCkpIHtcbiAgICAgICAgICAgICAgbG9jYWwucHVzaChtZXRhZGF0YS5pZCk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgfVxuICAgICAgICAgIHR4LmV4ZWN1dGVTcWwoJ1VQREFURSAnICsgRE9DX1NUT1JFICsgJ1NFVCBsb2NhbCA9IDEgV0hFUkUgaWQgSU4gKCcgK1xuICAgICAgICAgICAgbG9jYWwubWFwKGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHJldHVybiAnPyc7XG4gICAgICAgICAgfSkuam9pbignLCcpICsgJyknLCBsb2NhbCwgZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgdHguZXhlY3V0ZVNxbCgnVVBEQVRFICcgKyBCWV9TRVFfU1RPUkUgK1xuICAgICAgICAgICAgICAnIFNFVCBkZWxldGVkID0gMSBXSEVSRSBzZXEgSU4gKCcgKyBkZWxldGVkLm1hcChmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgIHJldHVybiAnPyc7XG4gICAgICAgICAgICB9KS5qb2luKCcsJykgKyAnKScsIGRlbGV0ZWQsIGNhbGxiYWNrKTtcbiAgICAgICAgICB9KTtcbiAgICAgICAgfSk7XG4gICAgICB9KTtcbiAgICB9KTtcbiAgfVxuXG4gIC8vIGluIHRoaXMgbWlncmF0aW9uLCB3ZSBtYWtlIGFsbCB0aGUgbG9jYWwgZG9jcyB1bnZlcnNpb25lZFxuICBmdW5jdGlvbiBydW5NaWdyYXRpb24zKHR4LCBjYWxsYmFjaykge1xuICAgIHZhciBsb2NhbCA9ICdDUkVBVEUgVEFCTEUgSUYgTk9UIEVYSVNUUyAnICsgTE9DQUxfU1RPUkUgK1xuICAgICAgJyAoaWQgVU5JUVVFLCByZXYsIGpzb24pJztcbiAgICB0eC5leGVjdXRlU3FsKGxvY2FsLCBbXSwgZnVuY3Rpb24gKCkge1xuICAgICAgdmFyIHNxbCA9ICdTRUxFQ1QgJyArIERPQ19TVE9SRSArICcuaWQgQVMgaWQsICcgK1xuICAgICAgICBCWV9TRVFfU1RPUkUgKyAnLmpzb24gQVMgZGF0YSAnICtcbiAgICAgICAgJ0ZST00gJyArIEJZX1NFUV9TVE9SRSArICcgSk9JTiAnICtcbiAgICAgICAgRE9DX1NUT1JFICsgJyBPTiAnICsgQllfU0VRX1NUT1JFICsgJy5zZXEgPSAnICtcbiAgICAgICAgRE9DX1NUT1JFICsgJy53aW5uaW5nc2VxIFdIRVJFIGxvY2FsID0gMSc7XG4gICAgICB0eC5leGVjdXRlU3FsKHNxbCwgW10sIGZ1bmN0aW9uICh0eCwgcmVzKSB7XG4gICAgICAgIHZhciByb3dzID0gW107XG4gICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgcmVzLnJvd3MubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICByb3dzLnB1c2gocmVzLnJvd3MuaXRlbShpKSk7XG4gICAgICAgIH1cbiAgICAgICAgZnVuY3Rpb24gZG9OZXh0KCkge1xuICAgICAgICAgIGlmICghcm93cy5sZW5ndGgpIHtcbiAgICAgICAgICAgIHJldHVybiBjYWxsYmFjaygpO1xuICAgICAgICAgIH1cbiAgICAgICAgICB2YXIgcm93ID0gcm93cy5zaGlmdCgpO1xuICAgICAgICAgIHZhciByZXYgPSBKU09OLnBhcnNlKHJvdy5kYXRhKS5fcmV2O1xuICAgICAgICAgIHR4LmV4ZWN1dGVTcWwoJ0lOU0VSVCBJTlRPICcgKyBMT0NBTF9TVE9SRSArXG4gICAgICAgICAgICAgICcgKGlkLCByZXYsIGpzb24pIFZBTFVFUyAoPyw/LD8pJyxcbiAgICAgICAgICAgICAgW3Jvdy5pZCwgcmV2LCByb3cuZGF0YV0sIGZ1bmN0aW9uICh0eCkge1xuICAgICAgICAgICAgdHguZXhlY3V0ZVNxbCgnREVMRVRFIEZST00gJyArIERPQ19TVE9SRSArICcgV0hFUkUgaWQ9PycsXG4gICAgICAgICAgICAgICAgW3Jvdy5pZF0sIGZ1bmN0aW9uICh0eCkge1xuICAgICAgICAgICAgICB0eC5leGVjdXRlU3FsKCdERUxFVEUgRlJPTSAnICsgQllfU0VRX1NUT1JFICsgJyBXSEVSRSBzZXE9PycsXG4gICAgICAgICAgICAgICAgICBbcm93LnNlcV0sIGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICBkb05leHQoKTtcbiAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICB9KTtcbiAgICAgICAgfVxuICAgICAgICBkb05leHQoKTtcbiAgICAgIH0pO1xuICAgIH0pO1xuICB9XG5cbiAgLy8gaW4gdGhpcyBtaWdyYXRpb24sIHdlIHJlbW92ZSBkb2NfaWRfcmV2IGFuZCBqdXN0IHVzZSByZXZcbiAgZnVuY3Rpb24gcnVuTWlncmF0aW9uNCh0eCwgY2FsbGJhY2spIHtcblxuICAgIGZ1bmN0aW9uIHVwZGF0ZVJvd3Mocm93cywgZW5jb2RpbmcpIHtcbiAgICAgIGZ1bmN0aW9uIGRvTmV4dCgpIHtcbiAgICAgICAgaWYgKCFyb3dzLmxlbmd0aCkge1xuICAgICAgICAgIHJldHVybiBjYWxsYmFjaygpO1xuICAgICAgICB9XG4gICAgICAgIHZhciByb3cgPSByb3dzLnNoaWZ0KCk7XG4gICAgICAgIHZhciBkb2NfaWRfcmV2ID0gcGFyc2VIZXhTdHJpbmcocm93LmhleCwgZW5jb2RpbmcpO1xuICAgICAgICB2YXIgaWR4ID0gZG9jX2lkX3Jldi5sYXN0SW5kZXhPZignOjonKTtcbiAgICAgICAgdmFyIGRvY19pZCA9IGRvY19pZF9yZXYuc3Vic3RyaW5nKDAsIGlkeCk7XG4gICAgICAgIHZhciByZXYgPSBkb2NfaWRfcmV2LnN1YnN0cmluZyhpZHggKyAyKTtcbiAgICAgICAgdmFyIHNxbCA9ICdVUERBVEUgJyArIEJZX1NFUV9TVE9SRSArXG4gICAgICAgICAgJyBTRVQgZG9jX2lkPT8sIHJldj0/IFdIRVJFIGRvY19pZF9yZXY9Pyc7XG4gICAgICAgIHR4LmV4ZWN1dGVTcWwoc3FsLCBbZG9jX2lkLCByZXYsIGRvY19pZF9yZXZdLCBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgZG9OZXh0KCk7XG4gICAgICAgIH0pO1xuICAgICAgfVxuICAgICAgZG9OZXh0KCk7XG4gICAgfVxuXG4gICAgdmFyIHNxbCA9ICdBTFRFUiBUQUJMRSAnICsgQllfU0VRX1NUT1JFICsgJyBBREQgQ09MVU1OIGRvY19pZCc7XG4gICAgdHguZXhlY3V0ZVNxbChzcWwsIFtdLCBmdW5jdGlvbiAodHgpIHtcbiAgICAgIHZhciBzcWwgPSAnQUxURVIgVEFCTEUgJyArIEJZX1NFUV9TVE9SRSArICcgQUREIENPTFVNTiByZXYnO1xuICAgICAgdHguZXhlY3V0ZVNxbChzcWwsIFtdLCBmdW5jdGlvbiAodHgpIHtcbiAgICAgICAgdHguZXhlY3V0ZVNxbChCWV9TRVFfU1RPUkVfRE9DX0lEX1JFVl9JTkRFWF9TUUwsIFtdLCBmdW5jdGlvbiAodHgpIHtcbiAgICAgICAgICB2YXIgc3FsID0gJ1NFTEVDVCBoZXgoZG9jX2lkX3JldikgYXMgaGV4IEZST00gJyArIEJZX1NFUV9TVE9SRTtcbiAgICAgICAgICB0eC5leGVjdXRlU3FsKHNxbCwgW10sIGZ1bmN0aW9uICh0eCwgcmVzKSB7XG4gICAgICAgICAgICB2YXIgcm93cyA9IFtdO1xuICAgICAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCByZXMucm93cy5sZW5ndGg7IGkrKykge1xuICAgICAgICAgICAgICByb3dzLnB1c2gocmVzLnJvd3MuaXRlbShpKSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICAvLyBpdCBzdWNrcywgYnV0IHdlIGZldGNoIHRoZSBlbmNvZGluZyB0d2ljZVxuICAgICAgICAgICAgdHguZXhlY3V0ZVNxbChcbiAgICAgICAgICAgICAgICAnU0VMRUNUIGRiaWQsIGhleChkYmlkKSBBUyBoZXhJZCBGUk9NICcgKyBNRVRBX1NUT1JFLCBbXSxcbiAgICAgICAgICAgICAgZnVuY3Rpb24gKHR4LCByZXN1bHQpIHtcbiAgICAgICAgICAgICAgICB2YXIgaWQgPSByZXN1bHQucm93cy5pdGVtKDApLmRiaWQ7XG4gICAgICAgICAgICAgICAgdmFyIGhleElkID0gcmVzdWx0LnJvd3MuaXRlbSgwKS5oZXhJZDtcbiAgICAgICAgICAgICAgICB2YXIgZW5jb2RpbmcgPSAoaGV4SWQubGVuZ3RoID09PSBpZC5sZW5ndGggKiAyKSA/XG4gICAgICAgICAgICAgICAgICAnVVRGLTgnIDogJ1VURi0xNic7XG4gICAgICAgICAgICAgICAgdXBkYXRlUm93cyhyb3dzLCBlbmNvZGluZyk7XG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICk7XG4gICAgICAgICAgfSk7XG4gICAgICAgIH0pO1xuICAgICAgfSk7XG4gICAgfSk7XG4gIH1cblxuICBmdW5jdGlvbiBvbkdldEluc3RhbmNlSWQodHgpIHtcbiAgICB3aGlsZSAoaWRSZXF1ZXN0cy5sZW5ndGggPiAwKSB7XG4gICAgICB2YXIgaWRDYWxsYmFjayA9IGlkUmVxdWVzdHMucG9wKCk7XG4gICAgICBpZENhbGxiYWNrKG51bGwsIGluc3RhbmNlSWQpO1xuICAgIH1cbiAgICBjaGVja0RiRW5jb2RpbmcodHgpO1xuICB9XG5cbiAgZnVuY3Rpb24gY2hlY2tEYkVuY29kaW5nKHR4KSB7XG4gICAgLy8gY2hlY2sgZGIgZW5jb2RpbmcgLSB1dGYtOCAoY2hyb21lLCBvcGVyYSkgb3IgdXRmLTE2IChzYWZhcmkpP1xuICAgIHR4LmV4ZWN1dGVTcWwoJ1NFTEVDVCBkYmlkLCBoZXgoZGJpZCkgQVMgaGV4SWQgRlJPTSAnICsgTUVUQV9TVE9SRSwgW10sXG4gICAgICBmdW5jdGlvbiAodHgsIHJlc3VsdCkge1xuICAgICAgICB2YXIgaWQgPSByZXN1bHQucm93cy5pdGVtKDApLmRiaWQ7XG4gICAgICAgIHZhciBoZXhJZCA9IHJlc3VsdC5yb3dzLml0ZW0oMCkuaGV4SWQ7XG4gICAgICAgIGVuY29kaW5nID0gKGhleElkLmxlbmd0aCA9PT0gaWQubGVuZ3RoICogMikgPyAnVVRGLTgnIDogJ1VURi0xNic7XG4gICAgICB9XG4gICAgKTtcbiAgfVxuXG4gIGZ1bmN0aW9uIG9uR2V0VmVyc2lvbih0eCwgZGJWZXJzaW9uKSB7XG4gICAgaWYgKGRiVmVyc2lvbiA9PT0gMCkge1xuICAgICAgLy8gaW5pdGlhbCBzY2hlbWFcblxuICAgICAgdmFyIG1ldGEgPSAnQ1JFQVRFIFRBQkxFIElGIE5PVCBFWElTVFMgJyArIE1FVEFfU1RPUkUgK1xuICAgICAgICAnICh1cGRhdGVfc2VxIElOVEVHRVIsIGRiaWQsIGRiX3ZlcnNpb24gSU5URUdFUiknO1xuICAgICAgdmFyIGF0dGFjaCA9ICdDUkVBVEUgVEFCTEUgSUYgTk9UIEVYSVNUUyAnICsgQVRUQUNIX1NUT1JFICtcbiAgICAgICAgJyAoZGlnZXN0LCBqc29uLCBib2R5IEJMT0IpJztcbiAgICAgIHZhciBkb2MgPSAnQ1JFQVRFIFRBQkxFIElGIE5PVCBFWElTVFMgJyArIERPQ19TVE9SRSArXG4gICAgICAgICcgKGlkIHVuaXF1ZSwganNvbiwgd2lubmluZ3NlcSknO1xuICAgICAgdmFyIHNlcSA9ICdDUkVBVEUgVEFCTEUgSUYgTk9UIEVYSVNUUyAnICsgQllfU0VRX1NUT1JFICtcbiAgICAgICAgJyAoc2VxIElOVEVHRVIgTk9UIE5VTEwgUFJJTUFSWSBLRVkgQVVUT0lOQ1JFTUVOVCwgJyArXG4gICAgICAgICdqc29uLCBkZWxldGVkIFRJTllJTlQoMSksIGRvY19pZCwgcmV2KSc7XG4gICAgICB2YXIgbG9jYWwgPSAnQ1JFQVRFIFRBQkxFIElGIE5PVCBFWElTVFMgJyArIExPQ0FMX1NUT1JFICtcbiAgICAgICAgJyAoaWQgVU5JUVVFLCByZXYsIGpzb24pJztcblxuICAgICAgLy8gY3JlYXRlc1xuICAgICAgdHguZXhlY3V0ZVNxbChhdHRhY2gpO1xuICAgICAgdHguZXhlY3V0ZVNxbChsb2NhbCk7XG4gICAgICB0eC5leGVjdXRlU3FsKGRvYywgW10sIGZ1bmN0aW9uICgpIHtcbiAgICAgICAgdHguZXhlY3V0ZVNxbChET0NfU1RPUkVfV0lOTklOR1NFUV9JTkRFWF9TUUwpO1xuICAgICAgICB0eC5leGVjdXRlU3FsKHNlcSwgW10sIGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICB0eC5leGVjdXRlU3FsKEJZX1NFUV9TVE9SRV9ERUxFVEVEX0lOREVYX1NRTCk7XG4gICAgICAgICAgdHguZXhlY3V0ZVNxbChCWV9TRVFfU1RPUkVfRE9DX0lEX1JFVl9JTkRFWF9TUUwpO1xuICAgICAgICAgIHR4LmV4ZWN1dGVTcWwobWV0YSwgW10sIGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIC8vIG1hcmsgdGhlIHVwZGF0ZV9zZXEsIGRiIHZlcnNpb24sIGFuZCBuZXcgZGJpZFxuICAgICAgICAgICAgdmFyIGluaXRTZXEgPSAnSU5TRVJUIElOVE8gJyArIE1FVEFfU1RPUkUgK1xuICAgICAgICAgICAgICAnICh1cGRhdGVfc2VxLCBkYl92ZXJzaW9uLCBkYmlkKSBWQUxVRVMgKD8sID8sID8pJztcbiAgICAgICAgICAgIGluc3RhbmNlSWQgPSB1dGlscy51dWlkKCk7XG4gICAgICAgICAgICB2YXIgaW5pdFNlcUFyZ3MgPSBbMCwgQURBUFRFUl9WRVJTSU9OLCBpbnN0YW5jZUlkXTtcbiAgICAgICAgICAgIHR4LmV4ZWN1dGVTcWwoaW5pdFNlcSwgaW5pdFNlcUFyZ3MsIGZ1bmN0aW9uICh0eCkge1xuICAgICAgICAgICAgICBvbkdldEluc3RhbmNlSWQodHgpO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgfSk7XG4gICAgICAgIH0pO1xuICAgICAgfSk7XG4gICAgfSBlbHNlIHsgLy8gdmVyc2lvbiA+IDBcblxuICAgICAgdmFyIHNldHVwRG9uZSA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgdmFyIG1pZ3JhdGVkID0gZGJWZXJzaW9uIDwgQURBUFRFUl9WRVJTSU9OO1xuICAgICAgICBpZiAobWlncmF0ZWQpIHtcbiAgICAgICAgICAvLyB1cGRhdGUgdGhlIGRiIHZlcnNpb24gd2l0aGluIHRoaXMgdHJhbnNhY3Rpb25cbiAgICAgICAgICB0eC5leGVjdXRlU3FsKCdVUERBVEUgJyArIE1FVEFfU1RPUkUgKyAnIFNFVCBkYl92ZXJzaW9uID0gJyArXG4gICAgICAgICAgICBBREFQVEVSX1ZFUlNJT04pO1xuICAgICAgICB9XG4gICAgICAgIC8vIG5vdGlmeSBkYi5pZCgpIGNhbGxlcnNcbiAgICAgICAgdmFyIHNxbCA9ICdTRUxFQ1QgZGJpZCBGUk9NICcgKyBNRVRBX1NUT1JFO1xuICAgICAgICB0eC5leGVjdXRlU3FsKHNxbCwgW10sIGZ1bmN0aW9uICh0eCwgcmVzdWx0KSB7XG4gICAgICAgICAgaW5zdGFuY2VJZCA9IHJlc3VsdC5yb3dzLml0ZW0oMCkuZGJpZDtcbiAgICAgICAgICBvbkdldEluc3RhbmNlSWQodHgpO1xuICAgICAgICB9KTtcbiAgICAgIH07XG5cbiAgICAgIC8vIHdvdWxkIGxvdmUgdG8gdXNlIHByb21pc2VzIGhlcmUsIGJ1dCB0aGVuIHdlYnNxbFxuICAgICAgLy8gZW5kcyB0aGUgdHJhbnNhY3Rpb24gZWFybHlcbiAgICAgIHN3aXRjaCAoZGJWZXJzaW9uKSB7XG4gICAgICAgIGNhc2UgMTpcbiAgICAgICAgICBydW5NaWdyYXRpb24yKHR4LCBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICBydW5NaWdyYXRpb24zKHR4LCBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgIHJ1bk1pZ3JhdGlvbjQodHgsIHNldHVwRG9uZSk7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICB9KTtcbiAgICAgICAgICBicmVhaztcbiAgICAgICAgY2FzZSAyOlxuICAgICAgICAgIHJ1bk1pZ3JhdGlvbjModHgsIGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHJ1bk1pZ3JhdGlvbjQodHgsIHNldHVwRG9uZSk7XG4gICAgICAgICAgfSk7XG4gICAgICAgICAgYnJlYWs7XG4gICAgICAgIGNhc2UgMzpcbiAgICAgICAgICBydW5NaWdyYXRpb240KHR4LCBzZXR1cERvbmUpO1xuICAgICAgICAgIGJyZWFrO1xuICAgICAgICBkZWZhdWx0OlxuICAgICAgICAgIHNldHVwRG9uZSgpO1xuICAgICAgICAgIGJyZWFrO1xuICAgICAgfVxuICAgIH1cbiAgfVxuXG4gIGZ1bmN0aW9uIHNldHVwKCkge1xuXG4gICAgZGIudHJhbnNhY3Rpb24oZnVuY3Rpb24gKHR4KSB7XG4gICAgICAvLyBmaXJzdCBnZXQgdGhlIHZlcnNpb25cbiAgICAgIHR4LmV4ZWN1dGVTcWwoJ1NFTEVDVCBzcWwgRlJPTSBzcWxpdGVfbWFzdGVyIFdIRVJFIHRibF9uYW1lID0gJyArXG4gICAgICAgICAgICAgICAgICAgIE1FVEFfU1RPUkUsIFtdLCBmdW5jdGlvbiAodHgsIHJlc3VsdCkge1xuICAgICAgICBpZiAoIXJlc3VsdC5yb3dzLmxlbmd0aCkge1xuICAgICAgICAgIC8vIGRhdGFiYXNlIGhhc24ndCBldmVuIGJlZW4gY3JlYXRlZCB5ZXQgKHZlcnNpb24gMClcbiAgICAgICAgICBvbkdldFZlcnNpb24odHgsIDApO1xuICAgICAgICB9IGVsc2UgaWYgKCEvZGJfdmVyc2lvbi8udGVzdChyZXN1bHQucm93cy5pdGVtKDApLnNxbCkpIHtcbiAgICAgICAgICAvLyB0YWJsZSB3YXMgY3JlYXRlZCwgYnV0IHdpdGhvdXQgdGhlIG5ldyBkYl92ZXJzaW9uIGNvbHVtbixcbiAgICAgICAgICAvLyBzbyBhZGQgaXQuXG4gICAgICAgICAgdHguZXhlY3V0ZVNxbCgnQUxURVIgVEFCTEUgJyArIE1FVEFfU1RPUkUgK1xuICAgICAgICAgICAgJyBBREQgQ09MVU1OIGRiX3ZlcnNpb24gSU5URUdFUicsIFtdLCBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAvLyBiZWZvcmUgdmVyc2lvbiAyLCB0aGlzIGNvbHVtbiBkaWRuJ3QgZXZlbiBleGlzdFxuICAgICAgICAgICAgb25HZXRWZXJzaW9uKHR4LCAxKTtcbiAgICAgICAgICB9KTtcbiAgICAgICAgfSBlbHNlIHsgLy8gY29sdW1uIGV4aXN0cywgd2UgY2FuIHNhZmVseSBnZXQgaXRcbiAgICAgICAgICB0eC5leGVjdXRlU3FsKCdTRUxFQ1QgZGJfdmVyc2lvbiBGUk9NICcgKyBNRVRBX1NUT1JFLCBbXSxcbiAgICAgICAgICAgIGZ1bmN0aW9uICh0eCwgcmVzdWx0KSB7XG4gICAgICAgICAgICB2YXIgZGJWZXJzaW9uID0gcmVzdWx0LnJvd3MuaXRlbSgwKS5kYl92ZXJzaW9uO1xuICAgICAgICAgICAgb25HZXRWZXJzaW9uKHR4LCBkYlZlcnNpb24pO1xuICAgICAgICAgIH0pO1xuICAgICAgICB9XG4gICAgICB9KTtcbiAgICB9LCB1bmtub3duRXJyb3IoY2FsbGJhY2spLCBkYkNyZWF0ZWQpO1xuICB9XG5cbiAgaWYgKHV0aWxzLmlzQ29yZG92YSgpICYmIHR5cGVvZiBnbG9iYWwgIT09ICd1bmRlZmluZWQnKSB7XG4gICAgLy90byB3YWl0IHVudGlsIGN1c3RvbSBhcGkgaXMgbWFkZSBpbiBwb3VjaC5hZGFwdGVycyBiZWZvcmUgZG9pbmcgc2V0dXBcbiAgICBnbG9iYWwuYWRkRXZlbnRMaXN0ZW5lcihuYW1lICsgJ19wb3VjaCcsIGZ1bmN0aW9uIGNvcmRvdmFfaW5pdCgpIHtcbiAgICAgIGdsb2JhbC5yZW1vdmVFdmVudExpc3RlbmVyKG5hbWUgKyAnX3BvdWNoJywgY29yZG92YV9pbml0LCBmYWxzZSk7XG4gICAgICBzZXR1cCgpO1xuICAgIH0sIGZhbHNlKTtcbiAgfSBlbHNlIHtcbiAgICBzZXR1cCgpO1xuICB9XG5cbiAgYXBpLnR5cGUgPSBmdW5jdGlvbiAoKSB7XG4gICAgcmV0dXJuICd3ZWJzcWwnO1xuICB9O1xuXG4gIGFwaS5faWQgPSB1dGlscy50b1Byb21pc2UoZnVuY3Rpb24gKGNhbGxiYWNrKSB7XG4gICAgY2FsbGJhY2sobnVsbCwgaW5zdGFuY2VJZCk7XG4gIH0pO1xuXG4gIGFwaS5faW5mbyA9IGZ1bmN0aW9uIChjYWxsYmFjaykge1xuICAgIGRiLnJlYWRUcmFuc2FjdGlvbihmdW5jdGlvbiAodHgpIHtcbiAgICAgIGNvdW50RG9jcyh0eCwgZnVuY3Rpb24gKGRvY0NvdW50KSB7XG4gICAgICAgIHZhciBzcWwgPSAnU0VMRUNUIHVwZGF0ZV9zZXEgRlJPTSAnICsgTUVUQV9TVE9SRTtcbiAgICAgICAgdHguZXhlY3V0ZVNxbChzcWwsIFtdLCBmdW5jdGlvbiAodHgsIHJlc3VsdCkge1xuICAgICAgICAgIHZhciB1cGRhdGVTZXEgPSByZXN1bHQucm93cy5pdGVtKDApLnVwZGF0ZV9zZXE7XG4gICAgICAgICAgY2FsbGJhY2sobnVsbCwge1xuICAgICAgICAgICAgZG9jX2NvdW50OiBkb2NDb3VudCxcbiAgICAgICAgICAgIHVwZGF0ZV9zZXE6IHVwZGF0ZVNlcVxuICAgICAgICAgIH0pO1xuICAgICAgICB9KTtcbiAgICAgIH0pO1xuICAgIH0sIHVua25vd25FcnJvcihjYWxsYmFjaykpO1xuICB9O1xuXG4gIGFwaS5fYnVsa0RvY3MgPSBmdW5jdGlvbiAocmVxLCBvcHRzLCBjYWxsYmFjaykge1xuXG4gICAgdmFyIG5ld0VkaXRzID0gb3B0cy5uZXdfZWRpdHM7XG4gICAgdmFyIHVzZXJEb2NzID0gcmVxLmRvY3M7XG5cbiAgICAvLyBQYXJzZSB0aGUgZG9jcywgZ2l2ZSB0aGVtIGEgc2VxdWVuY2UgbnVtYmVyIGZvciB0aGUgcmVzdWx0XG4gICAgdmFyIGRvY0luZm9zID0gdXNlckRvY3MubWFwKGZ1bmN0aW9uIChkb2MsIGkpIHtcbiAgICAgIGlmIChkb2MuX2lkICYmIHV0aWxzLmlzTG9jYWxJZChkb2MuX2lkKSkge1xuICAgICAgICByZXR1cm4gZG9jO1xuICAgICAgfVxuICAgICAgdmFyIG5ld0RvYyA9IHV0aWxzLnBhcnNlRG9jKGRvYywgbmV3RWRpdHMpO1xuICAgICAgbmV3RG9jLl9idWxrX3NlcSA9IGk7XG4gICAgICByZXR1cm4gbmV3RG9jO1xuICAgIH0pO1xuXG4gICAgdmFyIGRvY0luZm9FcnJvcnMgPSBkb2NJbmZvcy5maWx0ZXIoZnVuY3Rpb24gKGRvY0luZm8pIHtcbiAgICAgIHJldHVybiBkb2NJbmZvLmVycm9yO1xuICAgIH0pO1xuICAgIGlmIChkb2NJbmZvRXJyb3JzLmxlbmd0aCkge1xuICAgICAgcmV0dXJuIGNhbGxiYWNrKGRvY0luZm9FcnJvcnNbMF0pO1xuICAgIH1cblxuICAgIHZhciB0eDtcbiAgICB2YXIgcmVzdWx0cyA9IG5ldyBBcnJheShkb2NJbmZvcy5sZW5ndGgpO1xuICAgIHZhciB1cGRhdGVTZXEgPSAwO1xuICAgIHZhciBmZXRjaGVkRG9jcyA9IG5ldyB1dGlscy5NYXAoKTtcbiAgICB2YXIgbnVtRG9jc1dyaXR0ZW4gPSAwO1xuXG4gICAgZnVuY3Rpb24gY29tcGxldGUoKSB7XG4gICAgICB2YXIgYXJlc3VsdHMgPSByZXN1bHRzLm1hcChmdW5jdGlvbiAocmVzdWx0KSB7XG4gICAgICAgIGlmIChyZXN1bHQuX2J1bGtfc2VxKSB7XG4gICAgICAgICAgZGVsZXRlIHJlc3VsdC5fYnVsa19zZXE7XG4gICAgICAgIH0gZWxzZSBpZiAoIU9iamVjdC5rZXlzKHJlc3VsdCkubGVuZ3RoKSB7XG4gICAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgIG9rOiB0cnVlXG4gICAgICAgICAgfTtcbiAgICAgICAgfVxuICAgICAgICBpZiAocmVzdWx0LmVycm9yKSB7XG4gICAgICAgICAgcmV0dXJuIHJlc3VsdDtcbiAgICAgICAgfVxuXG4gICAgICAgIHZhciBtZXRhZGF0YSA9IHJlc3VsdC5tZXRhZGF0YTtcbiAgICAgICAgdmFyIHJldiA9IG1lcmdlLndpbm5pbmdSZXYobWV0YWRhdGEpO1xuXG4gICAgICAgIHJldHVybiB7XG4gICAgICAgICAgb2s6IHRydWUsXG4gICAgICAgICAgaWQ6IG1ldGFkYXRhLmlkLFxuICAgICAgICAgIHJldjogcmV2XG4gICAgICAgIH07XG4gICAgICB9KTtcbiAgICAgIFdlYlNxbFBvdWNoLkNoYW5nZXMubm90aWZ5KG5hbWUpO1xuXG4gICAgICB2YXIgdXBkYXRlc2VxID0gJ1NFTEVDVCB1cGRhdGVfc2VxIEZST00gJyArIE1FVEFfU1RPUkU7XG4gICAgICB0eC5leGVjdXRlU3FsKHVwZGF0ZXNlcSwgW10sIGZ1bmN0aW9uICh0eCwgcmVzdWx0KSB7XG4gICAgICAgIHZhciB1cGRhdGVfc2VxID0gcmVzdWx0LnJvd3MuaXRlbSgwKS51cGRhdGVfc2VxICsgdXBkYXRlU2VxO1xuICAgICAgICB2YXIgc3FsID0gJ1VQREFURSAnICsgTUVUQV9TVE9SRSArICcgU0VUIHVwZGF0ZV9zZXE9Pyc7XG4gICAgICAgIHR4LmV4ZWN1dGVTcWwoc3FsLCBbdXBkYXRlX3NlcV0sIGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICBjYWxsYmFjayhudWxsLCBhcmVzdWx0cyk7XG4gICAgICAgIH0pO1xuICAgICAgfSk7XG4gICAgfVxuXG4gICAgZnVuY3Rpb24gcHJlcHJvY2Vzc0F0dGFjaG1lbnQoYXR0LCBmaW5pc2gpIHtcbiAgICAgIGlmIChhdHQuc3R1Yikge1xuICAgICAgICByZXR1cm4gZmluaXNoKCk7XG4gICAgICB9XG4gICAgICBpZiAodHlwZW9mIGF0dC5kYXRhID09PSAnc3RyaW5nJykge1xuICAgICAgICB0cnkge1xuICAgICAgICAgIGF0dC5kYXRhID0gYXRvYihhdHQuZGF0YSk7XG4gICAgICAgIH0gY2F0Y2ggKGUpIHtcbiAgICAgICAgICB2YXIgZXJyID0gZXJyb3JzLmVycm9yKGVycm9ycy5CQURfQVJHLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcIkF0dGFjaG1lbnRzIG5lZWQgdG8gYmUgYmFzZTY0IGVuY29kZWRcIik7XG4gICAgICAgICAgcmV0dXJuIGNhbGxiYWNrKGVycik7XG4gICAgICAgIH1cbiAgICAgICAgdmFyIGRhdGEgPSB1dGlscy5maXhCaW5hcnkoYXR0LmRhdGEpO1xuICAgICAgICBhdHQuZGF0YSA9IHV0aWxzLmNyZWF0ZUJsb2IoW2RhdGFdLCB7dHlwZTogYXR0LmNvbnRlbnRfdHlwZX0pO1xuICAgICAgfVxuICAgICAgdmFyIHJlYWRlciA9IG5ldyBGaWxlUmVhZGVyKCk7XG4gICAgICByZWFkZXIub25sb2FkZW5kID0gZnVuY3Rpb24gKGUpIHtcbiAgICAgICAgdmFyIGJpbmFyeSA9IHV0aWxzLmFycmF5QnVmZmVyVG9CaW5hcnlTdHJpbmcodGhpcy5yZXN1bHQpO1xuICAgICAgICBhdHQuZGF0YSA9IGJpbmFyeTtcbiAgICAgICAgdXRpbHMuTUQ1KGJpbmFyeSkudGhlbihmdW5jdGlvbiAocmVzdWx0KSB7XG4gICAgICAgICAgYXR0LmRpZ2VzdCA9ICdtZDUtJyArIHJlc3VsdDtcbiAgICAgICAgICBmaW5pc2goKTtcbiAgICAgICAgfSk7XG4gICAgICB9O1xuICAgICAgcmVhZGVyLnJlYWRBc0FycmF5QnVmZmVyKGF0dC5kYXRhKTtcbiAgICB9XG5cbiAgICBmdW5jdGlvbiBwcmVwcm9jZXNzQXR0YWNobWVudHMoY2FsbGJhY2spIHtcbiAgICAgIGlmICghZG9jSW5mb3MubGVuZ3RoKSB7XG4gICAgICAgIHJldHVybiBjYWxsYmFjaygpO1xuICAgICAgfVxuXG4gICAgICB2YXIgZG9jdiA9IDA7XG5cbiAgICAgIGRvY0luZm9zLmZvckVhY2goZnVuY3Rpb24gKGRvY0luZm8pIHtcbiAgICAgICAgdmFyIGF0dGFjaG1lbnRzID0gZG9jSW5mby5kYXRhICYmIGRvY0luZm8uZGF0YS5fYXR0YWNobWVudHMgP1xuICAgICAgICAgIE9iamVjdC5rZXlzKGRvY0luZm8uZGF0YS5fYXR0YWNobWVudHMpIDogW107XG4gICAgICAgIHZhciByZWN2ID0gMDtcblxuICAgICAgICBpZiAoIWF0dGFjaG1lbnRzLmxlbmd0aCkge1xuICAgICAgICAgIHJldHVybiBkb25lKCk7XG4gICAgICAgIH1cblxuICAgICAgICBmdW5jdGlvbiBwcm9jZXNzZWRBdHRhY2htZW50KCkge1xuICAgICAgICAgIHJlY3YrKztcbiAgICAgICAgICBpZiAocmVjdiA9PT0gYXR0YWNobWVudHMubGVuZ3RoKSB7XG4gICAgICAgICAgICBkb25lKCk7XG4gICAgICAgICAgfVxuICAgICAgICB9XG5cbiAgICAgICAgZm9yICh2YXIga2V5IGluIGRvY0luZm8uZGF0YS5fYXR0YWNobWVudHMpIHtcbiAgICAgICAgICBpZiAoZG9jSW5mby5kYXRhLl9hdHRhY2htZW50cy5oYXNPd25Qcm9wZXJ0eShrZXkpKSB7XG4gICAgICAgICAgICBwcmVwcm9jZXNzQXR0YWNobWVudChkb2NJbmZvLmRhdGEuX2F0dGFjaG1lbnRzW2tleV0sXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBwcm9jZXNzZWRBdHRhY2htZW50KTtcbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgIH0pO1xuXG4gICAgICBmdW5jdGlvbiBkb25lKCkge1xuICAgICAgICBkb2N2Kys7XG4gICAgICAgIGlmIChkb2NJbmZvcy5sZW5ndGggPT09IGRvY3YpIHtcbiAgICAgICAgICBjYWxsYmFjaygpO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgfVxuXG4gICAgZnVuY3Rpb24gd3JpdGVEb2MoZG9jSW5mbywgd2lubmluZ1JldiwgZGVsZXRlZCwgY2FsbGJhY2ssIGlzVXBkYXRlLFxuICAgICAgICAgICAgICAgICAgICAgIHJlc3VsdHNJZHgpIHtcblxuICAgICAgZnVuY3Rpb24gZmluaXNoKCkge1xuICAgICAgICB1cGRhdGVTZXErKztcbiAgICAgICAgdmFyIGRhdGEgPSBkb2NJbmZvLmRhdGE7XG4gICAgICAgIHZhciBkZWxldGVkSW50ID0gZGVsZXRlZCA/IDEgOiAwO1xuXG4gICAgICAgIHZhciBpZCA9IGRhdGEuX2lkO1xuICAgICAgICB2YXIgcmV2ID0gZGF0YS5fcmV2O1xuICAgICAgICB2YXIganNvbiA9IHN0cmluZ2lmeURvYyhkYXRhKTtcbiAgICAgICAgdmFyIHNxbCA9ICdJTlNFUlQgSU5UTyAnICsgQllfU0VRX1NUT1JFICtcbiAgICAgICAgICAnIChkb2NfaWQsIHJldiwganNvbiwgZGVsZXRlZCkgVkFMVUVTICg/LCA/LCA/LCA/KTsnO1xuICAgICAgICB2YXIgc3FsQXJncyA9IFtpZCwgcmV2LCBqc29uLCBkZWxldGVkSW50XTtcblxuICAgICAgICB0eC5leGVjdXRlU3FsKHNxbCwgc3FsQXJncywgZnVuY3Rpb24gKHR4LCByZXN1bHQpIHtcbiAgICAgICAgICBkYXRhV3JpdHRlbih0eCwgcmVzdWx0Lmluc2VydElkKTtcbiAgICAgICAgfSwgZnVuY3Rpb24gKCkge1xuICAgICAgICAgIC8vIGNvbnN0cmFpbnQgZXJyb3IsIHJlY292ZXIgYnkgdXBkYXRpbmcgaW5zdGVhZCAoc2VlICMxNjM4KVxuICAgICAgICAgIHZhciBmZXRjaFNxbCA9IHNlbGVjdCgnc2VxJywgQllfU0VRX1NUT1JFLCBudWxsLFxuICAgICAgICAgICAgJ2RvY19pZD0/IEFORCByZXY9PycpO1xuICAgICAgICAgIHR4LmV4ZWN1dGVTcWwoZmV0Y2hTcWwsIFtpZCwgcmV2XSwgZnVuY3Rpb24gKHR4LCByZXMpIHtcbiAgICAgICAgICAgIHZhciBzZXEgPSByZXMucm93cy5pdGVtKDApLnNlcTtcbiAgICAgICAgICAgIHZhciBzcWwgPSAnVVBEQVRFICcgKyBCWV9TRVFfU1RPUkUgK1xuICAgICAgICAgICAgICAnIFNFVCBqc29uPT8sIGRlbGV0ZWQ9PyBXSEVSRSBkb2NfaWQ9PyBBTkQgcmV2PT87JztcbiAgICAgICAgICAgIHZhciBzcWxBcmdzID0gW2pzb24sIGRlbGV0ZWRJbnQsIGlkLCByZXZdO1xuICAgICAgICAgICAgdHguZXhlY3V0ZVNxbChzcWwsIHNxbEFyZ3MsIGZ1bmN0aW9uICh0eCkge1xuICAgICAgICAgICAgICB1cGRhdGVTZXEtLTsgLy8gZGlzY291bnQsIHNpbmNlIGl0J3MgYW4gdXBkYXRlLCBub3QgYSBuZXcgc2VxXG4gICAgICAgICAgICAgIGRhdGFXcml0dGVuKHR4LCBzZXEpO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgfSk7XG4gICAgICAgICAgcmV0dXJuIGZhbHNlOyAvLyBhY2sgdGhhdCB3ZSd2ZSBoYW5kbGVkIHRoZSBlcnJvclxuICAgICAgICB9KTtcbiAgICAgIH1cblxuICAgICAgZnVuY3Rpb24gY29sbGVjdFJlc3VsdHMoYXR0YWNobWVudEVycikge1xuICAgICAgICBpZiAoIWVycikge1xuICAgICAgICAgIGlmIChhdHRhY2htZW50RXJyKSB7XG4gICAgICAgICAgICBlcnIgPSBhdHRhY2htZW50RXJyO1xuICAgICAgICAgICAgY2FsbGJhY2soZXJyKTtcbiAgICAgICAgICB9IGVsc2UgaWYgKHJlY3YgPT09IGF0dGFjaG1lbnRzLmxlbmd0aCkge1xuICAgICAgICAgICAgZmluaXNoKCk7XG4gICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICB9XG5cbiAgICAgIHZhciBlcnIgPSBudWxsO1xuICAgICAgdmFyIHJlY3YgPSAwO1xuXG4gICAgICBkb2NJbmZvLmRhdGEuX2lkID0gZG9jSW5mby5tZXRhZGF0YS5pZDtcbiAgICAgIGRvY0luZm8uZGF0YS5fcmV2ID0gZG9jSW5mby5tZXRhZGF0YS5yZXY7XG5cbiAgICAgIGlmIChkZWxldGVkKSB7XG4gICAgICAgIGRvY0luZm8uZGF0YS5fZGVsZXRlZCA9IHRydWU7XG4gICAgICB9XG5cbiAgICAgIHZhciBhdHRhY2htZW50cyA9IGRvY0luZm8uZGF0YS5fYXR0YWNobWVudHMgP1xuICAgICAgICBPYmplY3Qua2V5cyhkb2NJbmZvLmRhdGEuX2F0dGFjaG1lbnRzKSA6IFtdO1xuXG4gICAgICBmdW5jdGlvbiBhdHRhY2htZW50U2F2ZWQoZXJyKSB7XG4gICAgICAgIHJlY3YrKztcbiAgICAgICAgY29sbGVjdFJlc3VsdHMoZXJyKTtcbiAgICAgIH1cblxuICAgICAgZm9yICh2YXIga2V5IGluIGRvY0luZm8uZGF0YS5fYXR0YWNobWVudHMpIHtcbiAgICAgICAgaWYgKCFkb2NJbmZvLmRhdGEuX2F0dGFjaG1lbnRzW2tleV0uc3R1Yikge1xuICAgICAgICAgIHZhciBkYXRhID0gZG9jSW5mby5kYXRhLl9hdHRhY2htZW50c1trZXldLmRhdGE7XG4gICAgICAgICAgZGVsZXRlIGRvY0luZm8uZGF0YS5fYXR0YWNobWVudHNba2V5XS5kYXRhO1xuICAgICAgICAgIHZhciBkaWdlc3QgPSBkb2NJbmZvLmRhdGEuX2F0dGFjaG1lbnRzW2tleV0uZGlnZXN0O1xuICAgICAgICAgIHNhdmVBdHRhY2htZW50KGRvY0luZm8sIGRpZ2VzdCwgZGF0YSwgYXR0YWNobWVudFNhdmVkKTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICByZWN2Kys7XG4gICAgICAgICAgY29sbGVjdFJlc3VsdHMoKTtcbiAgICAgICAgfVxuICAgICAgfVxuXG4gICAgICBpZiAoIWF0dGFjaG1lbnRzLmxlbmd0aCkge1xuICAgICAgICBmaW5pc2goKTtcbiAgICAgIH1cblxuICAgICAgZnVuY3Rpb24gZGF0YVdyaXR0ZW4odHgsIHNlcSkge1xuICAgICAgICBkb2NJbmZvLm1ldGFkYXRhLnNlcSA9IHNlcTtcbiAgICAgICAgZGVsZXRlIGRvY0luZm8ubWV0YWRhdGEucmV2O1xuXG4gICAgICAgIHZhciBzcWwgPSBpc1VwZGF0ZSA/XG4gICAgICAgICAgJ1VQREFURSAnICsgRE9DX1NUT1JFICtcbiAgICAgICAgICAnIFNFVCBqc29uPT8sIHdpbm5pbmdzZXE9KFNFTEVDVCBzZXEgRlJPTSAnICsgQllfU0VRX1NUT1JFICtcbiAgICAgICAgICAnIFdIRVJFIGRvY19pZD0nICsgRE9DX1NUT1JFICsgJy5pZCBBTkQgcmV2PT8pIFdIRVJFIGlkPT8nXG4gICAgICAgICAgOiAnSU5TRVJUIElOVE8gJyArIERPQ19TVE9SRSArXG4gICAgICAgICAgJyAoaWQsIHdpbm5pbmdzZXEsIGpzb24pIFZBTFVFUyAoPywgPywgPyk7JztcbiAgICAgICAgdmFyIG1ldGFkYXRhU3RyID0gdnV2dXplbGEuc3RyaW5naWZ5KGRvY0luZm8ubWV0YWRhdGEpO1xuICAgICAgICB2YXIgaWQgPSBkb2NJbmZvLm1ldGFkYXRhLmlkO1xuICAgICAgICB2YXIgcGFyYW1zID0gaXNVcGRhdGUgP1xuICAgICAgICAgIFttZXRhZGF0YVN0ciwgd2lubmluZ1JldiwgaWRdIDpcbiAgICAgICAgICBbaWQsIHNlcSwgbWV0YWRhdGFTdHJdO1xuICAgICAgICB0eC5leGVjdXRlU3FsKHNxbCwgcGFyYW1zLCBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgcmVzdWx0c1tyZXN1bHRzSWR4XSA9IGRvY0luZm87XG4gICAgICAgICAgZmV0Y2hlZERvY3Muc2V0KGlkLCBkb2NJbmZvLm1ldGFkYXRhKTtcbiAgICAgICAgICBjYWxsYmFjaygpO1xuICAgICAgICB9KTtcbiAgICAgIH1cbiAgICB9XG5cbiAgICBmdW5jdGlvbiB1cGRhdGVEb2Mob2xkRG9jLCBkb2NJbmZvLCByZXN1bHRzSWR4LCBjYWxsYmFjaykge1xuICAgICAgdmFyIG1lcmdlZCA9XG4gICAgICAgIG1lcmdlLm1lcmdlKG9sZERvYy5yZXZfdHJlZSwgZG9jSW5mby5tZXRhZGF0YS5yZXZfdHJlZVswXSwgMTAwMCk7XG4gICAgICB2YXIgZGVsZXRlZCA9IHV0aWxzLmlzRGVsZXRlZChkb2NJbmZvLm1ldGFkYXRhKTtcbiAgICAgIHZhciBvbGREb2NEZWxldGVkID0gdXRpbHMuaXNEZWxldGVkKG9sZERvYyk7XG4gICAgICB2YXIgaW5Db25mbGljdCA9IChvbGREb2NEZWxldGVkICYmIGRlbGV0ZWQgJiYgbmV3RWRpdHMpIHx8XG4gICAgICAgICghb2xkRG9jRGVsZXRlZCAmJiBuZXdFZGl0cyAmJiBtZXJnZWQuY29uZmxpY3RzICE9PSAnbmV3X2xlYWYnKTtcbiAgICAgIGlmIChpbkNvbmZsaWN0KSB7XG4gICAgICAgIHJlc3VsdHNbcmVzdWx0c0lkeF0gPSBtYWtlRXJyKGVycm9ycy5SRVZfQ09ORkxJQ1QsIGRvY0luZm8uX2J1bGtfc2VxKTtcbiAgICAgICAgcmV0dXJuIGNhbGxiYWNrKCk7XG4gICAgICB9XG5cbiAgICAgIGRvY0luZm8ubWV0YWRhdGEucmV2X3RyZWUgPSBtZXJnZWQudHJlZTtcblxuICAgICAgLy8gcmVjYWxjdWxhdGVcbiAgICAgIHZhciB3aW5uaW5nUmV2ID0gbWVyZ2Uud2lubmluZ1Jldihkb2NJbmZvLm1ldGFkYXRhKTtcbiAgICAgIGRlbGV0ZWQgPSB1dGlscy5pc0RlbGV0ZWQoZG9jSW5mby5tZXRhZGF0YSwgd2lubmluZ1Jldik7XG5cbiAgICAgIHdyaXRlRG9jKGRvY0luZm8sIHdpbm5pbmdSZXYsIGRlbGV0ZWQsIGNhbGxiYWNrLCB0cnVlLCByZXN1bHRzSWR4KTtcbiAgICB9XG5cbiAgICBmdW5jdGlvbiBpbnNlcnREb2MoZG9jSW5mbywgcmVzdWx0c0lkeCwgY2FsbGJhY2spIHtcbiAgICAgIC8vIENhbnQgaW5zZXJ0IG5ldyBkZWxldGVkIGRvY3VtZW50c1xuICAgICAgdmFyIHdpbm5pbmdSZXYgPSBtZXJnZS53aW5uaW5nUmV2KGRvY0luZm8ubWV0YWRhdGEpO1xuICAgICAgdmFyIGRlbGV0ZWQgPSB1dGlscy5pc0RlbGV0ZWQoZG9jSW5mby5tZXRhZGF0YSwgd2lubmluZ1Jldik7XG4gICAgICBpZiAoJ3dhc19kZWxldGUnIGluIG9wdHMgJiYgZGVsZXRlZCkge1xuICAgICAgICByZXN1bHRzW3Jlc3VsdHNJZHhdID0gZXJyb3JzLk1JU1NJTkdfRE9DO1xuICAgICAgICByZXR1cm4gY2FsbGJhY2soKTtcbiAgICAgIH1cbiAgICAgIHdyaXRlRG9jKGRvY0luZm8sIHdpbm5pbmdSZXYsIGRlbGV0ZWQsIGNhbGxiYWNrLCBmYWxzZSwgcmVzdWx0c0lkeCk7XG4gICAgfVxuXG4gICAgZnVuY3Rpb24gY2hlY2tEb25lV3JpdGluZ0RvY3MoKSB7XG4gICAgICBpZiAoKytudW1Eb2NzV3JpdHRlbiA9PT0gZG9jSW5mb3MubGVuZ3RoKSB7XG4gICAgICAgIGNvbXBsZXRlKCk7XG4gICAgICB9XG4gICAgfVxuXG4gICAgZnVuY3Rpb24gcHJvY2Vzc0RvY3MoKSB7XG4gICAgICBpZiAoIWRvY0luZm9zLmxlbmd0aCkge1xuICAgICAgICByZXR1cm4gY29tcGxldGUoKTtcbiAgICAgIH1cblxuICAgICAgdmFyIGlkc1RvRG9jcyA9IG5ldyB1dGlscy5NYXAoKTtcblxuICAgICAgZG9jSW5mb3MuZm9yRWFjaChmdW5jdGlvbiAoY3VycmVudERvYywgcmVzdWx0c0lkeCkge1xuXG4gICAgICAgIGlmIChjdXJyZW50RG9jLl9pZCAmJiB1dGlscy5pc0xvY2FsSWQoY3VycmVudERvYy5faWQpKSB7XG4gICAgICAgICAgYXBpW2N1cnJlbnREb2MuX2RlbGV0ZWQgPyAnX3JlbW92ZUxvY2FsJyA6ICdfcHV0TG9jYWwnXShcbiAgICAgICAgICAgICAgY3VycmVudERvYywge2N0eDogdHh9LCBmdW5jdGlvbiAoZXJyLCByZXNwKSB7XG4gICAgICAgICAgICBpZiAoZXJyKSB7XG4gICAgICAgICAgICAgIHJlc3VsdHNbcmVzdWx0c0lkeF0gPSBlcnI7XG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICByZXN1bHRzW3Jlc3VsdHNJZHhdID0ge307XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBjaGVja0RvbmVXcml0aW5nRG9jcygpO1xuICAgICAgICAgIH0pO1xuICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuXG4gICAgICAgIHZhciBpZCA9IGN1cnJlbnREb2MubWV0YWRhdGEuaWQ7XG4gICAgICAgIGlmIChpZHNUb0RvY3MuaGFzKGlkKSkge1xuICAgICAgICAgIGlkc1RvRG9jcy5nZXQoaWQpLnB1c2goW2N1cnJlbnREb2MsIHJlc3VsdHNJZHhdKTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICBpZHNUb0RvY3Muc2V0KGlkLCBbW2N1cnJlbnREb2MsIHJlc3VsdHNJZHhdXSk7XG4gICAgICAgIH1cbiAgICAgIH0pO1xuXG4gICAgICAvLyBpbiB0aGUgY2FzZSBvZiBuZXdfZWRpdHMsIHRoZSB1c2VyIGNhbiBwcm92aWRlIG11bHRpcGxlIGRvY3NcbiAgICAgIC8vIHdpdGggdGhlIHNhbWUgaWQuIHRoZXNlIG5lZWQgdG8gYmUgcHJvY2Vzc2VkIHNlcXVlbnRpYWxseVxuICAgICAgaWRzVG9Eb2NzLmZvckVhY2goZnVuY3Rpb24gKGRvY3MsIGlkKSB7XG4gICAgICAgIHZhciBudW1Eb25lID0gMDtcblxuICAgICAgICBmdW5jdGlvbiBkb2NXcml0dGVuKCkge1xuICAgICAgICAgIGNoZWNrRG9uZVdyaXRpbmdEb2NzKCk7XG4gICAgICAgICAgaWYgKCsrbnVtRG9uZSA8IGRvY3MubGVuZ3RoKSB7XG4gICAgICAgICAgICBuZXh0RG9jKCk7XG4gICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIGZ1bmN0aW9uIG5leHREb2MoKSB7XG4gICAgICAgICAgdmFyIHZhbHVlID0gZG9jc1tudW1Eb25lXTtcbiAgICAgICAgICB2YXIgY3VycmVudERvYyA9IHZhbHVlWzBdO1xuICAgICAgICAgIHZhciByZXN1bHRzSWR4ID0gdmFsdWVbMV07XG5cbiAgICAgICAgICBpZiAoZmV0Y2hlZERvY3MuaGFzKGlkKSkge1xuICAgICAgICAgICAgdXBkYXRlRG9jKGZldGNoZWREb2NzLmdldChpZCksIGN1cnJlbnREb2MsIHJlc3VsdHNJZHgsIGRvY1dyaXR0ZW4pO1xuICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICBpbnNlcnREb2MoY3VycmVudERvYywgcmVzdWx0c0lkeCwgZG9jV3JpdHRlbik7XG4gICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIG5leHREb2MoKTtcbiAgICAgIH0pO1xuICAgIH1cblxuICAgIGZ1bmN0aW9uIGZldGNoRXhpc3RpbmdEb2NzKGNhbGxiYWNrKSB7XG4gICAgICBpZiAoIWRvY0luZm9zLmxlbmd0aCkge1xuICAgICAgICByZXR1cm4gY2FsbGJhY2soKTtcbiAgICAgIH1cblxuICAgICAgdmFyIG51bUZldGNoZWQgPSAwO1xuXG4gICAgICBmdW5jdGlvbiBjaGVja0RvbmUoKSB7XG4gICAgICAgIGlmICgrK251bUZldGNoZWQgPT09IGRvY0luZm9zLmxlbmd0aCkge1xuICAgICAgICAgIGNhbGxiYWNrKCk7XG4gICAgICAgIH1cbiAgICAgIH1cblxuICAgICAgZG9jSW5mb3MuZm9yRWFjaChmdW5jdGlvbiAoZG9jSW5mbykge1xuICAgICAgICBpZiAoZG9jSW5mby5faWQgJiYgdXRpbHMuaXNMb2NhbElkKGRvY0luZm8uX2lkKSkge1xuICAgICAgICAgIHJldHVybiBjaGVja0RvbmUoKTsgLy8gc2tpcCBsb2NhbCBkb2NzXG4gICAgICAgIH1cbiAgICAgICAgdmFyIGlkID0gZG9jSW5mby5tZXRhZGF0YS5pZDtcbiAgICAgICAgdHguZXhlY3V0ZVNxbCgnU0VMRUNUIGpzb24gRlJPTSAnICsgRE9DX1NUT1JFICtcbiAgICAgICAgICAnIFdIRVJFIGlkID0gPycsIFtpZF0sIGZ1bmN0aW9uICh0eCwgcmVzdWx0KSB7XG4gICAgICAgICAgaWYgKHJlc3VsdC5yb3dzLmxlbmd0aCkge1xuICAgICAgICAgICAgdmFyIG1ldGFkYXRhID0gdnV2dXplbGEucGFyc2UocmVzdWx0LnJvd3MuaXRlbSgwKS5qc29uKTtcbiAgICAgICAgICAgIGZldGNoZWREb2NzLnNldChpZCwgbWV0YWRhdGEpO1xuICAgICAgICAgIH1cbiAgICAgICAgICBjaGVja0RvbmUoKTtcbiAgICAgICAgfSk7XG4gICAgICB9KTtcbiAgICB9XG5cbiAgICAvLyBJbnNlcnQgc2VxdWVuY2UgbnVtYmVyIGludG8gdGhlIGVycm9yIHNvIHdlIGNhbiBzb3J0IGxhdGVyXG4gICAgZnVuY3Rpb24gbWFrZUVycihlcnIsIHNlcSkge1xuICAgICAgZXJyLl9idWxrX3NlcSA9IHNlcTtcbiAgICAgIHJldHVybiBlcnI7XG4gICAgfVxuXG4gICAgZnVuY3Rpb24gc2F2ZUF0dGFjaG1lbnQoZG9jSW5mbywgZGlnZXN0LCBkYXRhLCBjYWxsYmFjaykge1xuICAgICAgdmFyIHJlZiA9IFtkb2NJbmZvLm1ldGFkYXRhLmlkLCBkb2NJbmZvLm1ldGFkYXRhLnJldl0uam9pbignQCcpO1xuICAgICAgdmFyIG5ld0F0dCA9IHtkaWdlc3Q6IGRpZ2VzdH07XG4gICAgICB2YXIgc3FsID0gJ1NFTEVDVCBkaWdlc3QsIGpzb24gRlJPTSAnICsgQVRUQUNIX1NUT1JFICsgJyBXSEVSRSBkaWdlc3Q9Pyc7XG4gICAgICB0eC5leGVjdXRlU3FsKHNxbCwgW2RpZ2VzdF0sIGZ1bmN0aW9uICh0eCwgcmVzdWx0KSB7XG4gICAgICAgIGlmICghcmVzdWx0LnJvd3MubGVuZ3RoKSB7XG4gICAgICAgICAgbmV3QXR0LnJlZnMgPSB7fTtcbiAgICAgICAgICBuZXdBdHQucmVmc1tyZWZdID0gdHJ1ZTtcbiAgICAgICAgICBzcWwgPSAnSU5TRVJUIElOVE8gJyArIEFUVEFDSF9TVE9SRSArXG4gICAgICAgICAgICAgICAgJyhkaWdlc3QsIGpzb24sIGJvZHkpIFZBTFVFUyAoPywgPywgPyknO1xuICAgICAgICAgIHR4LmV4ZWN1dGVTcWwoc3FsLCBbZGlnZXN0LCBKU09OLnN0cmluZ2lmeShuZXdBdHQpLCBkYXRhXSxcbiAgICAgICAgICAgIGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIGNhbGxiYWNrKCk7XG4gICAgICAgICAgfSk7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgbmV3QXR0LnJlZnMgPSBKU09OLnBhcnNlKHJlc3VsdC5yb3dzLml0ZW0oMCkuanNvbikucmVmcztcbiAgICAgICAgICBzcWwgPSAnVVBEQVRFICcgKyBBVFRBQ0hfU1RPUkUgKyAnIFNFVCBqc29uPT8sIGJvZHk9PyBXSEVSRSBkaWdlc3Q9Pyc7XG4gICAgICAgICAgdHguZXhlY3V0ZVNxbChzcWwsIFtKU09OLnN0cmluZ2lmeShuZXdBdHQpLCBkYXRhLCBkaWdlc3RdLFxuICAgICAgICAgICAgZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgY2FsbGJhY2soKTtcbiAgICAgICAgICB9KTtcbiAgICAgICAgfVxuICAgICAgfSk7XG4gICAgfVxuXG4gICAgcHJlcHJvY2Vzc0F0dGFjaG1lbnRzKGZ1bmN0aW9uICgpIHtcbiAgICAgIGRiLnRyYW5zYWN0aW9uKGZ1bmN0aW9uICh0eG4pIHtcbiAgICAgICAgdHggPSB0eG47XG4gICAgICAgIGZldGNoRXhpc3RpbmdEb2NzKHByb2Nlc3NEb2NzKTtcbiAgICAgIH0sIHVua25vd25FcnJvcihjYWxsYmFjayksIGZ1bmN0aW9uICgpIHtcbiAgICAgICAgZG9jQ291bnQgPSAtMTtcbiAgICAgIH0pO1xuICAgIH0pO1xuICB9O1xuXG4gIGFwaS5fZ2V0ID0gZnVuY3Rpb24gKGlkLCBvcHRzLCBjYWxsYmFjaykge1xuICAgIG9wdHMgPSB1dGlscy5jbG9uZShvcHRzKTtcbiAgICB2YXIgZG9jO1xuICAgIHZhciBtZXRhZGF0YTtcbiAgICB2YXIgZXJyO1xuICAgIGlmICghb3B0cy5jdHgpIHtcbiAgICAgIGRiLnJlYWRUcmFuc2FjdGlvbihmdW5jdGlvbiAodHhuKSB7XG4gICAgICAgIG9wdHMuY3R4ID0gdHhuO1xuICAgICAgICBhcGkuX2dldChpZCwgb3B0cywgY2FsbGJhY2spO1xuICAgICAgfSk7XG4gICAgICByZXR1cm47XG4gICAgfVxuICAgIHZhciB0eCA9IG9wdHMuY3R4O1xuXG4gICAgZnVuY3Rpb24gZmluaXNoKCkge1xuICAgICAgY2FsbGJhY2soZXJyLCB7ZG9jOiBkb2MsIG1ldGFkYXRhOiBtZXRhZGF0YSwgY3R4OiB0eH0pO1xuICAgIH1cblxuICAgIHZhciBzcWw7XG4gICAgdmFyIHNxbEFyZ3M7XG4gICAgaWYgKG9wdHMucmV2KSB7XG4gICAgICBzcWwgPSBzZWxlY3QoXG4gICAgICAgIFNFTEVDVF9ET0NTLFxuICAgICAgICBbRE9DX1NUT1JFLCBCWV9TRVFfU1RPUkVdLFxuICAgICAgICBET0NfU1RPUkUgKyAnLmlkPScgKyBCWV9TRVFfU1RPUkUgKyAnLmRvY19pZCcsXG4gICAgICAgIFtCWV9TRVFfU1RPUkUgKyAnLmRvY19pZD0/JywgQllfU0VRX1NUT1JFICsgJy5yZXY9PyddKTtcbiAgICAgIHNxbEFyZ3MgPSBbaWQsIG9wdHMucmV2XTtcbiAgICB9IGVsc2Uge1xuICAgICAgc3FsID0gc2VsZWN0KFxuICAgICAgICBTRUxFQ1RfRE9DUyxcbiAgICAgICAgW0RPQ19TVE9SRSwgQllfU0VRX1NUT1JFXSxcbiAgICAgICAgRE9DX1NUT1JFX0FORF9CWV9TRVFfSk9JTkVSLFxuICAgICAgICBET0NfU1RPUkUgKyAnLmlkPT8nKTtcbiAgICAgIHNxbEFyZ3MgPSBbaWRdO1xuICAgIH1cbiAgICB0eC5leGVjdXRlU3FsKHNxbCwgc3FsQXJncywgZnVuY3Rpb24gKGEsIHJlc3VsdHMpIHtcbiAgICAgIGlmICghcmVzdWx0cy5yb3dzLmxlbmd0aCkge1xuICAgICAgICBlcnIgPSBlcnJvcnMuTUlTU0lOR19ET0M7XG4gICAgICAgIHJldHVybiBmaW5pc2goKTtcbiAgICAgIH1cbiAgICAgIHZhciBpdGVtID0gcmVzdWx0cy5yb3dzLml0ZW0oMCk7XG4gICAgICBtZXRhZGF0YSA9IHZ1dnV6ZWxhLnBhcnNlKGl0ZW0ubWV0YWRhdGEpO1xuICAgICAgaWYgKGl0ZW0uZGVsZXRlZCAmJiAhb3B0cy5yZXYpIHtcbiAgICAgICAgZXJyID0gZXJyb3JzLmVycm9yKGVycm9ycy5NSVNTSU5HX0RPQywgJ2RlbGV0ZWQnKTtcbiAgICAgICAgcmV0dXJuIGZpbmlzaCgpO1xuICAgICAgfVxuICAgICAgZG9jID0gdW5zdHJpbmdpZnlEb2MoaXRlbS5kYXRhLCBtZXRhZGF0YS5pZCwgaXRlbS5yZXYpO1xuICAgICAgZmluaXNoKCk7XG4gICAgfSk7XG4gIH07XG5cbiAgZnVuY3Rpb24gY291bnREb2NzKHR4LCBjYWxsYmFjaykge1xuXG4gICAgaWYgKGRvY0NvdW50ICE9PSAtMSkge1xuICAgICAgcmV0dXJuIGNhbGxiYWNrKGRvY0NvdW50KTtcbiAgICB9XG5cbiAgICAvLyBjb3VudCB0aGUgdG90YWwgcm93c1xuICAgIHZhciBzcWwgPSBzZWxlY3QoXG4gICAgICAnQ09VTlQoJyArIERPQ19TVE9SRSArICcuaWQpIEFTIFxcJ251bVxcJycsXG4gICAgICBbRE9DX1NUT1JFLCBCWV9TRVFfU1RPUkVdLFxuICAgICAgRE9DX1NUT1JFX0FORF9CWV9TRVFfSk9JTkVSLFxuICAgICAgQllfU0VRX1NUT1JFICsgJy5kZWxldGVkPTAnKTtcblxuICAgIHR4LmV4ZWN1dGVTcWwoc3FsLCBbXSwgZnVuY3Rpb24gKHR4LCByZXN1bHQpIHtcbiAgICAgIGRvY0NvdW50ID0gcmVzdWx0LnJvd3MuaXRlbSgwKS5udW07XG4gICAgICBjYWxsYmFjayhkb2NDb3VudCk7XG4gICAgfSk7XG4gIH1cblxuICBhcGkuX2FsbERvY3MgPSBmdW5jdGlvbiAob3B0cywgY2FsbGJhY2spIHtcbiAgICB2YXIgcmVzdWx0cyA9IFtdO1xuICAgIHZhciB0b3RhbFJvd3M7XG5cbiAgICB2YXIgc3RhcnQgPSAnc3RhcnRrZXknIGluIG9wdHMgPyBvcHRzLnN0YXJ0a2V5IDogZmFsc2U7XG4gICAgdmFyIGVuZCA9ICdlbmRrZXknIGluIG9wdHMgPyBvcHRzLmVuZGtleSA6IGZhbHNlO1xuICAgIHZhciBrZXkgPSAna2V5JyBpbiBvcHRzID8gb3B0cy5rZXkgOiBmYWxzZTtcbiAgICB2YXIgZGVzY2VuZGluZyA9ICdkZXNjZW5kaW5nJyBpbiBvcHRzID8gb3B0cy5kZXNjZW5kaW5nIDogZmFsc2U7XG4gICAgdmFyIGxpbWl0ID0gJ2xpbWl0JyBpbiBvcHRzID8gb3B0cy5saW1pdCA6IC0xO1xuICAgIHZhciBvZmZzZXQgPSAnc2tpcCcgaW4gb3B0cyA/IG9wdHMuc2tpcCA6IDA7XG4gICAgdmFyIGluY2x1c2l2ZUVuZCA9IG9wdHMuaW5jbHVzaXZlX2VuZCAhPT0gZmFsc2U7XG5cbiAgICB2YXIgc3FsQXJncyA9IFtdO1xuICAgIHZhciBjcml0ZXJpYSA9IFtdO1xuXG4gICAgaWYgKGtleSAhPT0gZmFsc2UpIHtcbiAgICAgIGNyaXRlcmlhLnB1c2goRE9DX1NUT1JFICsgJy5pZCA9ID8nKTtcbiAgICAgIHNxbEFyZ3MucHVzaChrZXkpO1xuICAgIH0gZWxzZSBpZiAoc3RhcnQgIT09IGZhbHNlIHx8IGVuZCAhPT0gZmFsc2UpIHtcbiAgICAgIGlmIChzdGFydCAhPT0gZmFsc2UpIHtcbiAgICAgICAgY3JpdGVyaWEucHVzaChET0NfU1RPUkUgKyAnLmlkICcgKyAoZGVzY2VuZGluZyA/ICc8PScgOiAnPj0nKSArICcgPycpO1xuICAgICAgICBzcWxBcmdzLnB1c2goc3RhcnQpO1xuICAgICAgfVxuICAgICAgaWYgKGVuZCAhPT0gZmFsc2UpIHtcbiAgICAgICAgdmFyIGNvbXBhcmF0b3IgPSBkZXNjZW5kaW5nID8gJz4nIDogJzwnO1xuICAgICAgICBpZiAoaW5jbHVzaXZlRW5kKSB7XG4gICAgICAgICAgY29tcGFyYXRvciArPSAnPSc7XG4gICAgICAgIH1cbiAgICAgICAgY3JpdGVyaWEucHVzaChET0NfU1RPUkUgKyAnLmlkICcgKyBjb21wYXJhdG9yICsgJyA/Jyk7XG4gICAgICAgIHNxbEFyZ3MucHVzaChlbmQpO1xuICAgICAgfVxuICAgICAgaWYgKGtleSAhPT0gZmFsc2UpIHtcbiAgICAgICAgY3JpdGVyaWEucHVzaChET0NfU1RPUkUgKyAnLmlkID0gPycpO1xuICAgICAgICBzcWxBcmdzLnB1c2goa2V5KTtcbiAgICAgIH1cbiAgICB9XG5cbiAgICBpZiAob3B0cy5kZWxldGVkICE9PSAnb2snKSB7XG4gICAgICAvLyByZXBvcnQgZGVsZXRlZCBpZiBrZXlzIGFyZSBzcGVjaWZpZWRcbiAgICAgIGNyaXRlcmlhLnB1c2goQllfU0VRX1NUT1JFICsgJy5kZWxldGVkID0gMCcpO1xuICAgIH1cblxuICAgIGRiLnJlYWRUcmFuc2FjdGlvbihmdW5jdGlvbiAodHgpIHtcblxuICAgICAgLy8gZmlyc3QgY291bnQgdXAgdGhlIHRvdGFsIHJvd3NcbiAgICAgIGNvdW50RG9jcyh0eCwgZnVuY3Rpb24gKGNvdW50KSB7XG4gICAgICAgIHRvdGFsUm93cyA9IGNvdW50O1xuXG4gICAgICAgIGlmIChsaW1pdCA9PT0gMCkge1xuICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuXG4gICAgICAgIC8vIHRoZW4gYWN0dWFsbHkgZmV0Y2ggdGhlIGRvY3VtZW50c1xuICAgICAgICB2YXIgc3FsID0gc2VsZWN0KFxuICAgICAgICAgIFNFTEVDVF9ET0NTLFxuICAgICAgICAgIFtET0NfU1RPUkUsIEJZX1NFUV9TVE9SRV0sXG4gICAgICAgICAgRE9DX1NUT1JFX0FORF9CWV9TRVFfSk9JTkVSLFxuICAgICAgICAgIGNyaXRlcmlhLFxuICAgICAgICAgIERPQ19TVE9SRSArICcuaWQgJyArIChkZXNjZW5kaW5nID8gJ0RFU0MnIDogJ0FTQycpXG4gICAgICAgICAgKTtcbiAgICAgICAgc3FsICs9ICcgTElNSVQgJyArIGxpbWl0ICsgJyBPRkZTRVQgJyArIG9mZnNldDtcblxuICAgICAgICB0eC5leGVjdXRlU3FsKHNxbCwgc3FsQXJncywgZnVuY3Rpb24gKHR4LCByZXN1bHQpIHtcbiAgICAgICAgICBmb3IgKHZhciBpID0gMCwgbCA9IHJlc3VsdC5yb3dzLmxlbmd0aDsgaSA8IGw7IGkrKykge1xuICAgICAgICAgICAgdmFyIGl0ZW0gPSByZXN1bHQucm93cy5pdGVtKGkpO1xuICAgICAgICAgICAgdmFyIG1ldGFkYXRhID0gdnV2dXplbGEucGFyc2UoaXRlbS5tZXRhZGF0YSk7XG4gICAgICAgICAgICB2YXIgZGF0YSA9IHVuc3RyaW5naWZ5RG9jKGl0ZW0uZGF0YSwgbWV0YWRhdGEuaWQsIGl0ZW0ucmV2KTtcbiAgICAgICAgICAgIHZhciB3aW5uaW5nUmV2ID0gZGF0YS5fcmV2O1xuICAgICAgICAgICAgdmFyIGRvYyA9IHtcbiAgICAgICAgICAgICAgaWQ6IG1ldGFkYXRhLmlkLFxuICAgICAgICAgICAgICBrZXk6IG1ldGFkYXRhLmlkLFxuICAgICAgICAgICAgICB2YWx1ZToge3Jldjogd2lubmluZ1Jldn1cbiAgICAgICAgICAgIH07XG4gICAgICAgICAgICBpZiAob3B0cy5pbmNsdWRlX2RvY3MpIHtcbiAgICAgICAgICAgICAgZG9jLmRvYyA9IGRhdGE7XG4gICAgICAgICAgICAgIGRvYy5kb2MuX3JldiA9IHdpbm5pbmdSZXY7XG4gICAgICAgICAgICAgIGlmIChvcHRzLmNvbmZsaWN0cykge1xuICAgICAgICAgICAgICAgIGRvYy5kb2MuX2NvbmZsaWN0cyA9IG1lcmdlLmNvbGxlY3RDb25mbGljdHMobWV0YWRhdGEpO1xuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgIGZvciAodmFyIGF0dCBpbiBkb2MuZG9jLl9hdHRhY2htZW50cykge1xuICAgICAgICAgICAgICAgIGlmIChkb2MuZG9jLl9hdHRhY2htZW50cy5oYXNPd25Qcm9wZXJ0eShhdHQpKSB7XG4gICAgICAgICAgICAgICAgICBkb2MuZG9jLl9hdHRhY2htZW50c1thdHRdLnN0dWIgPSB0cnVlO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYgKGl0ZW0uZGVsZXRlZCkge1xuICAgICAgICAgICAgICBpZiAob3B0cy5kZWxldGVkID09PSAnb2snKSB7XG4gICAgICAgICAgICAgICAgZG9jLnZhbHVlLmRlbGV0ZWQgPSB0cnVlO1xuICAgICAgICAgICAgICAgIGRvYy5kb2MgPSBudWxsO1xuICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgIGNvbnRpbnVlO1xuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICByZXN1bHRzLnB1c2goZG9jKTtcbiAgICAgICAgICB9XG4gICAgICAgIH0pO1xuICAgICAgfSk7XG4gICAgfSwgdW5rbm93bkVycm9yKGNhbGxiYWNrKSwgZnVuY3Rpb24gKCkge1xuICAgICAgY2FsbGJhY2sobnVsbCwge1xuICAgICAgICB0b3RhbF9yb3dzOiB0b3RhbFJvd3MsXG4gICAgICAgIG9mZnNldDogb3B0cy5za2lwLFxuICAgICAgICByb3dzOiByZXN1bHRzXG4gICAgICB9KTtcbiAgICB9KTtcbiAgfTtcblxuICBhcGkuX2NoYW5nZXMgPSBmdW5jdGlvbiAob3B0cykge1xuICAgIG9wdHMgPSB1dGlscy5jbG9uZShvcHRzKTtcblxuICAgIGlmIChvcHRzLmNvbnRpbnVvdXMpIHtcbiAgICAgIHZhciBpZCA9IG5hbWUgKyAnOicgKyB1dGlscy51dWlkKCk7XG4gICAgICBXZWJTcWxQb3VjaC5DaGFuZ2VzLmFkZExpc3RlbmVyKG5hbWUsIGlkLCBhcGksIG9wdHMpO1xuICAgICAgV2ViU3FsUG91Y2guQ2hhbmdlcy5ub3RpZnkobmFtZSk7XG4gICAgICByZXR1cm4ge1xuICAgICAgICBjYW5jZWw6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICBXZWJTcWxQb3VjaC5DaGFuZ2VzLnJlbW92ZUxpc3RlbmVyKG5hbWUsIGlkKTtcbiAgICAgICAgfVxuICAgICAgfTtcbiAgICB9XG5cbiAgICB2YXIgZGVzY2VuZGluZyA9IG9wdHMuZGVzY2VuZGluZztcblxuICAgIC8vIElnbm9yZSB0aGUgYHNpbmNlYCBwYXJhbWV0ZXIgd2hlbiBgZGVzY2VuZGluZ2AgaXMgdHJ1ZVxuICAgIG9wdHMuc2luY2UgPSBvcHRzLnNpbmNlICYmICFkZXNjZW5kaW5nID8gb3B0cy5zaW5jZSA6IDA7XG5cbiAgICB2YXIgbGltaXQgPSAnbGltaXQnIGluIG9wdHMgPyBvcHRzLmxpbWl0IDogLTE7XG4gICAgaWYgKGxpbWl0ID09PSAwKSB7XG4gICAgICBsaW1pdCA9IDE7IC8vIHBlciBDb3VjaERCIF9jaGFuZ2VzIHNwZWNcbiAgICB9XG5cbiAgICB2YXIgcmV0dXJuRG9jcztcbiAgICBpZiAoJ3JldHVybkRvY3MnIGluIG9wdHMpIHtcbiAgICAgIHJldHVybkRvY3MgPSBvcHRzLnJldHVybkRvY3M7XG4gICAgfSBlbHNlIHtcbiAgICAgIHJldHVybkRvY3MgPSB0cnVlO1xuICAgIH1cbiAgICB2YXIgcmVzdWx0cyA9IFtdO1xuICAgIHZhciBudW1SZXN1bHRzID0gMDtcbiAgICBmdW5jdGlvbiBmZXRjaENoYW5nZXMoKSB7XG5cbiAgICAgIHZhciBjcml0ZXJpYSA9IFtcbiAgICAgICAgRE9DX1NUT1JFICsgJy53aW5uaW5nc2VxID4gJyArIG9wdHMuc2luY2VcbiAgICAgIF07XG4gICAgICB2YXIgc3FsQXJncyA9IFtdO1xuICAgICAgaWYgKG9wdHMuZG9jX2lkcykge1xuICAgICAgICBjcml0ZXJpYS5wdXNoKERPQ19TVE9SRSArICcuaWQgSU4gKCcgKyBvcHRzLmRvY19pZHMubWFwKGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICByZXR1cm4gJz8nO1xuICAgICAgICB9KS5qb2luKCcsJykgKyAnKScpO1xuICAgICAgICBzcWxBcmdzID0gb3B0cy5kb2NfaWRzO1xuICAgICAgfVxuXG4gICAgICB2YXIgc3FsID0gc2VsZWN0KFNFTEVDVF9ET0NTLCBbRE9DX1NUT1JFLCBCWV9TRVFfU1RPUkVdLFxuICAgICAgICBET0NfU1RPUkVfQU5EX0JZX1NFUV9KT0lORVIsIGNyaXRlcmlhLFxuICAgICAgICBET0NfU1RPUkUgKyAnLndpbm5pbmdzZXEgJyArIChkZXNjZW5kaW5nID8gJ0RFU0MnIDogJ0FTQycpKTtcblxuICAgICAgdmFyIGZpbHRlciA9IHV0aWxzLmZpbHRlckNoYW5nZShvcHRzKTtcbiAgICAgIGlmICghb3B0cy52aWV3ICYmICFvcHRzLmZpbHRlcikge1xuICAgICAgICAvLyB3ZSBjYW4ganVzdCBsaW1pdCBpbiB0aGUgcXVlcnlcbiAgICAgICAgc3FsICs9ICcgTElNSVQgJyArIGxpbWl0O1xuICAgICAgfVxuXG4gICAgICBkYi5yZWFkVHJhbnNhY3Rpb24oZnVuY3Rpb24gKHR4KSB7XG4gICAgICAgIHR4LmV4ZWN1dGVTcWwoc3FsLCBzcWxBcmdzLCBmdW5jdGlvbiAodHgsIHJlc3VsdCkge1xuICAgICAgICAgIHZhciBsYXN0U2VxID0gMDtcbiAgICAgICAgICBmb3IgKHZhciBpID0gMCwgbCA9IHJlc3VsdC5yb3dzLmxlbmd0aDsgaSA8IGw7IGkrKykge1xuICAgICAgICAgICAgdmFyIHJlcyA9IHJlc3VsdC5yb3dzLml0ZW0oaSk7XG4gICAgICAgICAgICB2YXIgbWV0YWRhdGEgPSB2dXZ1emVsYS5wYXJzZShyZXMubWV0YWRhdGEpO1xuICAgICAgICAgICAgaWYgKGxhc3RTZXEgPCByZXMuc2VxKSB7XG4gICAgICAgICAgICAgIGxhc3RTZXEgPSByZXMuc2VxO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgdmFyIGRvYyA9IHVuc3RyaW5naWZ5RG9jKHJlcy5kYXRhLCBtZXRhZGF0YS5pZCwgcmVzLnJldik7XG4gICAgICAgICAgICB2YXIgY2hhbmdlID0gb3B0cy5wcm9jZXNzQ2hhbmdlKGRvYywgbWV0YWRhdGEsIG9wdHMpO1xuICAgICAgICAgICAgY2hhbmdlLnNlcSA9IHJlcy5zZXE7XG4gICAgICAgICAgICBpZiAoZmlsdGVyKGNoYW5nZSkpIHtcbiAgICAgICAgICAgICAgbnVtUmVzdWx0cysrO1xuICAgICAgICAgICAgICBpZiAocmV0dXJuRG9jcykge1xuICAgICAgICAgICAgICAgIHJlc3VsdHMucHVzaChjaGFuZ2UpO1xuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgIG9wdHMub25DaGFuZ2UoY2hhbmdlKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmIChudW1SZXN1bHRzID09PSBsaW1pdCkge1xuICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9XG4gICAgICAgICAgaWYgKCFvcHRzLmNvbnRpbnVvdXMpIHtcbiAgICAgICAgICAgIG9wdHMuY29tcGxldGUobnVsbCwge1xuICAgICAgICAgICAgICByZXN1bHRzOiByZXN1bHRzLFxuICAgICAgICAgICAgICBsYXN0X3NlcTogbGFzdFNlcVxuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgfVxuICAgICAgICB9KTtcbiAgICAgIH0pO1xuICAgIH1cblxuICAgIGZldGNoQ2hhbmdlcygpO1xuICB9O1xuXG4gIGFwaS5fY2xvc2UgPSBmdW5jdGlvbiAoY2FsbGJhY2spIHtcbiAgICAvL1dlYlNRTCBkYXRhYmFzZXMgZG8gbm90IG5lZWQgdG8gYmUgY2xvc2VkXG4gICAgY2FsbGJhY2soKTtcbiAgfTtcblxuICBhcGkuX2dldEF0dGFjaG1lbnQgPSBmdW5jdGlvbiAoYXR0YWNobWVudCwgb3B0cywgY2FsbGJhY2spIHtcbiAgICB2YXIgcmVzO1xuICAgIHZhciB0eCA9IG9wdHMuY3R4O1xuICAgIHZhciBkaWdlc3QgPSBhdHRhY2htZW50LmRpZ2VzdDtcbiAgICB2YXIgdHlwZSA9IGF0dGFjaG1lbnQuY29udGVudF90eXBlO1xuICAgIHZhciBzcWwgPSAnU0VMRUNUIGhleChib2R5KSBhcyBib2R5IEZST00gJyArIEFUVEFDSF9TVE9SRSArXG4gICAgICAgICAgICAgICcgV0hFUkUgZGlnZXN0PT8nO1xuICAgIHR4LmV4ZWN1dGVTcWwoc3FsLCBbZGlnZXN0XSwgZnVuY3Rpb24gKHR4LCByZXN1bHQpIHtcbiAgICAgIC8vIHNxbGl0ZSBub3JtYWxseSBzdG9yZXMgZGF0YSBhcyB1dGY4LCBzbyBldmVuIHRoZSBoZXgoKSBmdW5jdGlvblxuICAgICAgLy8gXCJlbmNvZGVzXCIgdGhlIGJpbmFyeSBkYXRhIGluIHV0ZjgvMTYgYmVmb3JlIHJldHVybmluZyBpdC4geWV0IGhleCgpXG4gICAgICAvLyBpcyB0aGUgb25seSB3YXkgdG8gZ2V0IHRoZSBmdWxsIGRhdGEsIHNvIHdlIGRvIHRoaXMuXG4gICAgICB2YXIgZGF0YSA9IHBhcnNlSGV4U3RyaW5nKHJlc3VsdC5yb3dzLml0ZW0oMCkuYm9keSwgZW5jb2RpbmcpO1xuICAgICAgaWYgKG9wdHMuZW5jb2RlKSB7XG4gICAgICAgIHJlcyA9IGJ0b2EoZGF0YSk7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICBkYXRhID0gdXRpbHMuZml4QmluYXJ5KGRhdGEpO1xuICAgICAgICByZXMgPSB1dGlscy5jcmVhdGVCbG9iKFtkYXRhXSwge3R5cGU6IHR5cGV9KTtcbiAgICAgIH1cbiAgICAgIGNhbGxiYWNrKG51bGwsIHJlcyk7XG4gICAgfSk7XG4gIH07XG5cbiAgYXBpLl9nZXRSZXZpc2lvblRyZWUgPSBmdW5jdGlvbiAoZG9jSWQsIGNhbGxiYWNrKSB7XG4gICAgZGIucmVhZFRyYW5zYWN0aW9uKGZ1bmN0aW9uICh0eCkge1xuICAgICAgdmFyIHNxbCA9ICdTRUxFQ1QganNvbiBBUyBtZXRhZGF0YSBGUk9NICcgKyBET0NfU1RPUkUgKyAnIFdIRVJFIGlkID0gPyc7XG4gICAgICB0eC5leGVjdXRlU3FsKHNxbCwgW2RvY0lkXSwgZnVuY3Rpb24gKHR4LCByZXN1bHQpIHtcbiAgICAgICAgaWYgKCFyZXN1bHQucm93cy5sZW5ndGgpIHtcbiAgICAgICAgICBjYWxsYmFjayhlcnJvcnMuTUlTU0lOR19ET0MpO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgIHZhciBkYXRhID0gdnV2dXplbGEucGFyc2UocmVzdWx0LnJvd3MuaXRlbSgwKS5tZXRhZGF0YSk7XG4gICAgICAgICAgY2FsbGJhY2sobnVsbCwgZGF0YS5yZXZfdHJlZSk7XG4gICAgICAgIH1cbiAgICAgIH0pO1xuICAgIH0pO1xuICB9O1xuXG4gIGFwaS5fZG9Db21wYWN0aW9uID0gZnVuY3Rpb24gKGRvY0lkLCByZXZfdHJlZSwgcmV2cywgY2FsbGJhY2spIHtcbiAgICBpZiAoIXJldnMubGVuZ3RoKSB7XG4gICAgICByZXR1cm4gY2FsbGJhY2soKTtcbiAgICB9XG4gICAgZGIudHJhbnNhY3Rpb24oZnVuY3Rpb24gKHR4KSB7XG4gICAgICB2YXIgc3FsID0gJ1NFTEVDVCBqc29uIEFTIG1ldGFkYXRhIEZST00gJyArIERPQ19TVE9SRSArICcgV0hFUkUgaWQgPSA/JztcbiAgICAgIHR4LmV4ZWN1dGVTcWwoc3FsLCBbZG9jSWRdLCBmdW5jdGlvbiAodHgsIHJlc3VsdCkge1xuICAgICAgICBpZiAoIXJlc3VsdC5yb3dzLmxlbmd0aCkge1xuICAgICAgICAgIHJldHVybiB1dGlscy5jYWxsKGNhbGxiYWNrKTtcbiAgICAgICAgfVxuICAgICAgICB2YXIgbWV0YWRhdGEgPSB2dXZ1emVsYS5wYXJzZShyZXN1bHQucm93cy5pdGVtKDApLm1ldGFkYXRhKTtcbiAgICAgICAgbWV0YWRhdGEucmV2X3RyZWUgPSByZXZfdHJlZTtcblxuICAgICAgICB2YXIgbnVtRG9uZSA9IDA7XG4gICAgICAgIHJldnMuZm9yRWFjaChmdW5jdGlvbiAocmV2KSB7XG4gICAgICAgICAgdmFyIHNxbCA9ICdERUxFVEUgRlJPTSAnICsgQllfU0VRX1NUT1JFICsgJyBXSEVSRSBkb2NfaWQ9PyBBTkQgcmV2PT8nO1xuICAgICAgICAgIHR4LmV4ZWN1dGVTcWwoc3FsLCBbZG9jSWQsIHJldl0sIGZ1bmN0aW9uICh0eCkge1xuICAgICAgICAgICAgaWYgKCsrbnVtRG9uZSA9PT0gcmV2cy5sZW5ndGgpIHtcbiAgICAgICAgICAgICAgdmFyIHNxbCA9ICdVUERBVEUgJyArIERPQ19TVE9SRSArICcgU0VUIGpzb24gPSA/IFdIRVJFIGlkID0gPyc7XG4gICAgICAgICAgICAgIHR4LmV4ZWN1dGVTcWwoc3FsLCBbdnV2dXplbGEuc3RyaW5naWZ5KG1ldGFkYXRhKSwgZG9jSWRdLFxuICAgICAgICAgICAgICAgIGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICBjYWxsYmFjaygpO1xuICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9KTtcbiAgICAgICAgfSk7XG4gICAgICB9KTtcbiAgICB9KTtcbiAgfTtcblxuICBhcGkuX2dldExvY2FsID0gZnVuY3Rpb24gKGlkLCBjYWxsYmFjaykge1xuICAgIGRiLnJlYWRUcmFuc2FjdGlvbihmdW5jdGlvbiAodHgpIHtcbiAgICAgIHZhciBzcWwgPSAnU0VMRUNUIGpzb24sIHJldiBGUk9NICcgKyBMT0NBTF9TVE9SRSArICcgV0hFUkUgaWQ9Pyc7XG4gICAgICB0eC5leGVjdXRlU3FsKHNxbCwgW2lkXSwgZnVuY3Rpb24gKHR4LCByZXMpIHtcbiAgICAgICAgaWYgKHJlcy5yb3dzLmxlbmd0aCkge1xuICAgICAgICAgIHZhciBpdGVtID0gcmVzLnJvd3MuaXRlbSgwKTtcbiAgICAgICAgICB2YXIgZG9jID0gdW5zdHJpbmdpZnlEb2MoaXRlbS5qc29uLCBpZCwgaXRlbS5yZXYpO1xuICAgICAgICAgIGNhbGxiYWNrKG51bGwsIGRvYyk7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgY2FsbGJhY2soZXJyb3JzLk1JU1NJTkdfRE9DKTtcbiAgICAgICAgfVxuICAgICAgfSk7XG4gICAgfSk7XG4gIH07XG5cbiAgYXBpLl9wdXRMb2NhbCA9IGZ1bmN0aW9uIChkb2MsIG9wdHMsIGNhbGxiYWNrKSB7XG4gICAgaWYgKHR5cGVvZiBvcHRzID09PSAnZnVuY3Rpb24nKSB7XG4gICAgICBjYWxsYmFjayA9IG9wdHM7XG4gICAgICBvcHRzID0ge307XG4gICAgfVxuICAgIGRlbGV0ZSBkb2MuX3JldmlzaW9uczsgLy8gaWdub3JlIHRoaXMsIHRydXN0IHRoZSByZXZcbiAgICB2YXIgb2xkUmV2ID0gZG9jLl9yZXY7XG4gICAgdmFyIGlkID0gZG9jLl9pZDtcbiAgICB2YXIgbmV3UmV2O1xuICAgIGlmICghb2xkUmV2KSB7XG4gICAgICBuZXdSZXYgPSBkb2MuX3JldiA9ICcwLTEnO1xuICAgIH0gZWxzZSB7XG4gICAgICBuZXdSZXYgPSBkb2MuX3JldiA9ICcwLScgKyAocGFyc2VJbnQob2xkUmV2LnNwbGl0KCctJylbMV0sIDEwKSArIDEpO1xuICAgIH1cbiAgICB2YXIganNvbiA9IHN0cmluZ2lmeURvYyhkb2MpO1xuXG4gICAgdmFyIHJldDtcbiAgICBmdW5jdGlvbiBwdXRMb2NhbCh0eCkge1xuICAgICAgdmFyIHNxbDtcbiAgICAgIHZhciB2YWx1ZXM7XG4gICAgICBpZiAob2xkUmV2KSB7XG4gICAgICAgIHNxbCA9ICdVUERBVEUgJyArIExPQ0FMX1NUT1JFICsgJyBTRVQgcmV2PT8sIGpzb249PyAnICtcbiAgICAgICAgICAnV0hFUkUgaWQ9PyBBTkQgcmV2PT8nO1xuICAgICAgICB2YWx1ZXMgPSBbbmV3UmV2LCBqc29uLCBpZCwgb2xkUmV2XTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIHNxbCA9ICdJTlNFUlQgSU5UTyAnICsgTE9DQUxfU1RPUkUgKyAnIChpZCwgcmV2LCBqc29uKSBWQUxVRVMgKD8sPyw/KSc7XG4gICAgICAgIHZhbHVlcyA9IFtpZCwgbmV3UmV2LCBqc29uXTtcbiAgICAgIH1cbiAgICAgIHR4LmV4ZWN1dGVTcWwoc3FsLCB2YWx1ZXMsIGZ1bmN0aW9uICh0eCwgcmVzKSB7XG4gICAgICAgIGlmIChyZXMucm93c0FmZmVjdGVkKSB7XG4gICAgICAgICAgcmV0ID0ge29rOiB0cnVlLCBpZDogaWQsIHJldjogbmV3UmV2fTtcbiAgICAgICAgICBpZiAob3B0cy5jdHgpIHsgLy8gcmV0dXJuIGltbWVkaWF0ZWx5XG4gICAgICAgICAgICBjYWxsYmFjayhudWxsLCByZXQpO1xuICAgICAgICAgIH1cbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICBjYWxsYmFjayhlcnJvcnMuUkVWX0NPTkZMSUNUKTtcbiAgICAgICAgfVxuICAgICAgfSwgZnVuY3Rpb24gKCkge1xuICAgICAgICBjYWxsYmFjayhlcnJvcnMuUkVWX0NPTkZMSUNUKTtcbiAgICAgICAgcmV0dXJuIGZhbHNlOyAvLyBhY2sgdGhhdCB3ZSBoYW5kbGVkIHRoZSBlcnJvclxuICAgICAgfSk7XG4gICAgfVxuXG4gICAgaWYgKG9wdHMuY3R4KSB7XG4gICAgICBwdXRMb2NhbChvcHRzLmN0eCk7XG4gICAgfSBlbHNlIHtcbiAgICAgIGRiLnRyYW5zYWN0aW9uKGZ1bmN0aW9uICh0eCkge1xuICAgICAgICBwdXRMb2NhbCh0eCk7XG4gICAgICB9LCB1bmtub3duRXJyb3IoY2FsbGJhY2spLCBmdW5jdGlvbiAoKSB7XG4gICAgICAgIGlmIChyZXQpIHtcbiAgICAgICAgICBjYWxsYmFjayhudWxsLCByZXQpO1xuICAgICAgICB9XG4gICAgICB9KTtcbiAgICB9XG4gIH07XG5cbiAgYXBpLl9yZW1vdmVMb2NhbCA9IGZ1bmN0aW9uIChkb2MsIGNhbGxiYWNrKSB7XG4gICAgdmFyIHJldDtcbiAgICBkYi50cmFuc2FjdGlvbihmdW5jdGlvbiAodHgpIHtcbiAgICAgIHZhciBzcWwgPSAnREVMRVRFIEZST00gJyArIExPQ0FMX1NUT1JFICsgJyBXSEVSRSBpZD0/IEFORCByZXY9Pyc7XG4gICAgICB2YXIgcGFyYW1zID0gW2RvYy5faWQsIGRvYy5fcmV2XTtcbiAgICAgIHR4LmV4ZWN1dGVTcWwoc3FsLCBwYXJhbXMsIGZ1bmN0aW9uICh0eCwgcmVzKSB7XG4gICAgICAgIGlmICghcmVzLnJvd3NBZmZlY3RlZCkge1xuICAgICAgICAgIHJldHVybiBjYWxsYmFjayhlcnJvcnMuUkVWX0NPTkZMSUNUKTtcbiAgICAgICAgfVxuICAgICAgICByZXQgPSB7b2s6IHRydWUsIGlkOiBkb2MuX2lkLCByZXY6ICcwLTAnfTtcbiAgICAgIH0pO1xuICAgIH0sIHVua25vd25FcnJvcihjYWxsYmFjayksIGZ1bmN0aW9uICgpIHtcbiAgICAgIGNhbGxiYWNrKG51bGwsIHJldCk7XG4gICAgfSk7XG4gIH07XG59XG5cbldlYlNxbFBvdWNoLnZhbGlkID0gZnVuY3Rpb24gKCkge1xuICBpZiAodHlwZW9mIGdsb2JhbCAhPT0gJ3VuZGVmaW5lZCcpIHtcbiAgICBpZiAoZ2xvYmFsLm5hdmlnYXRvciAmJlxuICAgICAgICBnbG9iYWwubmF2aWdhdG9yLnNxbGl0ZVBsdWdpbiAmJlxuICAgICAgICBnbG9iYWwubmF2aWdhdG9yLnNxbGl0ZVBsdWdpbi5vcGVuRGF0YWJhc2UpIHtcbiAgICAgIHJldHVybiB0cnVlO1xuICAgIH0gZWxzZSBpZiAoZ2xvYmFsLnNxbGl0ZVBsdWdpbiAmJiBnbG9iYWwuc3FsaXRlUGx1Z2luLm9wZW5EYXRhYmFzZSkge1xuICAgICAgcmV0dXJuIHRydWU7XG4gICAgfSBlbHNlIGlmIChnbG9iYWwub3BlbkRhdGFiYXNlKSB7XG4gICAgICByZXR1cm4gdHJ1ZTtcbiAgICB9XG4gIH1cbiAgcmV0dXJuIGZhbHNlO1xufTtcblxuV2ViU3FsUG91Y2guZGVzdHJveSA9IHV0aWxzLnRvUHJvbWlzZShmdW5jdGlvbiAobmFtZSwgb3B0cywgY2FsbGJhY2spIHtcbiAgV2ViU3FsUG91Y2guQ2hhbmdlcy5yZW1vdmVBbGxMaXN0ZW5lcnMobmFtZSk7XG4gIHZhciBzaXplID0gZ2V0U2l6ZShvcHRzKTtcbiAgdmFyIGRiID0gb3BlbkRCKG5hbWUsIFBPVUNIX1ZFUlNJT04sIG5hbWUsIHNpemUpO1xuICBkYi50cmFuc2FjdGlvbihmdW5jdGlvbiAodHgpIHtcbiAgICB2YXIgc3RvcmVzID0gW0RPQ19TVE9SRSwgQllfU0VRX1NUT1JFLCBBVFRBQ0hfU1RPUkUsIE1FVEFfU1RPUkUsXG4gICAgICBMT0NBTF9TVE9SRV07XG4gICAgc3RvcmVzLmZvckVhY2goZnVuY3Rpb24gKHN0b3JlKSB7XG4gICAgICB0eC5leGVjdXRlU3FsKCdEUk9QIFRBQkxFIElGIEVYSVNUUyAnICsgc3RvcmUsIFtdKTtcbiAgICB9KTtcbiAgfSwgdW5rbm93bkVycm9yKGNhbGxiYWNrKSwgZnVuY3Rpb24gKCkge1xuICAgIGlmICh1dGlscy5oYXNMb2NhbFN0b3JhZ2UoKSkge1xuICAgICAgZGVsZXRlIGdsb2JhbC5sb2NhbFN0b3JhZ2VbJ19wb3VjaF9fd2Vic3FsZGJfJyArIG5hbWVdO1xuICAgICAgZGVsZXRlIGdsb2JhbC5sb2NhbFN0b3JhZ2VbbmFtZV07XG4gICAgfVxuICAgIGNhbGxiYWNrKG51bGwsIHsnb2snOiB0cnVlfSk7XG4gIH0pO1xufSk7XG5cbldlYlNxbFBvdWNoLkNoYW5nZXMgPSBuZXcgdXRpbHMuQ2hhbmdlcygpO1xuXG5tb2R1bGUuZXhwb3J0cyA9IFdlYlNxbFBvdWNoO1xuXG59KS5jYWxsKHRoaXMsdHlwZW9mIHNlbGYgIT09IFwidW5kZWZpbmVkXCIgPyBzZWxmIDogdHlwZW9mIHdpbmRvdyAhPT0gXCJ1bmRlZmluZWRcIiA/IHdpbmRvdyA6IHt9KVxufSx7XCIuLi9kZXBzL2Vycm9yc1wiOjExLFwiLi4vbWVyZ2VcIjoxOCxcIi4uL3V0aWxzXCI6MjMsXCJ2dXZ1emVsYVwiOjU4fV0sNjpbZnVuY3Rpb24oX2RlcmVxXyxtb2R1bGUsZXhwb3J0cyl7XG4ndXNlIHN0cmljdCc7XG52YXIgdXRpbHMgPSBfZGVyZXFfKCcuL3V0aWxzJyk7XG52YXIgbWVyZ2UgPSBfZGVyZXFfKCcuL21lcmdlJyk7XG52YXIgZXJyb3JzID0gX2RlcmVxXygnLi9kZXBzL2Vycm9ycycpO1xudmFyIEVFID0gX2RlcmVxXygnZXZlbnRzJykuRXZlbnRFbWl0dGVyO1xudmFyIGV2YWxGaWx0ZXIgPSBfZGVyZXFfKCcuL2V2YWxGaWx0ZXInKTtcbnZhciBldmFsVmlldyA9IF9kZXJlcV8oJy4vZXZhbFZpZXcnKTtcbm1vZHVsZS5leHBvcnRzID0gQ2hhbmdlcztcbnV0aWxzLmluaGVyaXRzKENoYW5nZXMsIEVFKTtcblxuZnVuY3Rpb24gQ2hhbmdlcyhkYiwgb3B0cywgY2FsbGJhY2spIHtcbiAgRUUuY2FsbCh0aGlzKTtcbiAgdmFyIHNlbGYgPSB0aGlzO1xuICB0aGlzLmRiID0gZGI7XG4gIG9wdHMgPSBvcHRzID8gdXRpbHMuY2xvbmUob3B0cykgOiB7fTtcbiAgdmFyIG9sZENvbXBsZXRlID0gY2FsbGJhY2sgfHwgb3B0cy5jb21wbGV0ZSB8fCBmdW5jdGlvbiAoKSB7fTtcbiAgdmFyIGNvbXBsZXRlID0gb3B0cy5jb21wbGV0ZSA9IHV0aWxzLm9uY2UoZnVuY3Rpb24gKGVyciwgcmVzcCkge1xuICAgIGlmIChlcnIpIHtcbiAgICAgIHNlbGYuZW1pdCgnZXJyb3InLCBlcnIpO1xuICAgIH0gZWxzZSB7XG4gICAgICBzZWxmLmVtaXQoJ2NvbXBsZXRlJywgcmVzcCk7XG4gICAgfVxuICAgIHNlbGYucmVtb3ZlQWxsTGlzdGVuZXJzKCk7XG4gICAgZGIucmVtb3ZlTGlzdGVuZXIoJ2Rlc3Ryb3llZCcsIG9uRGVzdHJveSk7XG4gIH0pO1xuICBpZiAob2xkQ29tcGxldGUpIHtcbiAgICBzZWxmLm9uKCdjb21wbGV0ZScsIGZ1bmN0aW9uIChyZXNwKSB7XG4gICAgICBvbGRDb21wbGV0ZShudWxsLCByZXNwKTtcbiAgICB9KTtcbiAgICBzZWxmLm9uKCdlcnJvcicsIGZ1bmN0aW9uIChlcnIpIHtcbiAgICAgIG9sZENvbXBsZXRlKGVycik7XG4gICAgfSk7XG4gIH1cbiAgdmFyIG9sZE9uQ2hhbmdlID0gb3B0cy5vbkNoYW5nZTtcbiAgaWYgKG9sZE9uQ2hhbmdlKSB7XG4gICAgc2VsZi5vbignY2hhbmdlJywgb2xkT25DaGFuZ2UpO1xuICB9XG4gIGZ1bmN0aW9uIG9uRGVzdHJveSgpIHtcbiAgICBzZWxmLmNhbmNlbCgpO1xuICB9XG4gIGRiLm9uY2UoJ2Rlc3Ryb3llZCcsIG9uRGVzdHJveSk7XG5cbiAgb3B0cy5vbkNoYW5nZSA9IGZ1bmN0aW9uIChjaGFuZ2UpIHtcbiAgICBpZiAob3B0cy5pc0NhbmNlbGxlZCkge1xuICAgICAgcmV0dXJuO1xuICAgIH1cbiAgICBzZWxmLmVtaXQoJ2NoYW5nZScsIGNoYW5nZSk7XG4gICAgaWYgKHNlbGYuc3RhcnRTZXEgJiYgc2VsZi5zdGFydFNlcSA8PSBjaGFuZ2Uuc2VxKSB7XG4gICAgICBzZWxmLmVtaXQoJ3VwdG9kYXRlJyk7XG4gICAgICBzZWxmLnN0YXJ0U2VxID0gZmFsc2U7XG4gICAgfVxuICAgIGlmIChjaGFuZ2UuZGVsZXRlZCkge1xuICAgICAgc2VsZi5lbWl0KCdkZWxldGUnLCBjaGFuZ2UpO1xuICAgIH0gZWxzZSBpZiAoY2hhbmdlLmNoYW5nZXMubGVuZ3RoID09PSAxICYmXG4gICAgICBjaGFuZ2UuY2hhbmdlc1swXS5yZXYuc2xpY2UoMCwgMikgPT09ICcxLScpIHtcbiAgICAgIHNlbGYuZW1pdCgnY3JlYXRlJywgY2hhbmdlKTtcbiAgICB9IGVsc2Uge1xuICAgICAgc2VsZi5lbWl0KCd1cGRhdGUnLCBjaGFuZ2UpO1xuICAgIH1cbiAgfTtcblxuICB2YXIgcHJvbWlzZSA9IG5ldyB1dGlscy5Qcm9taXNlKGZ1bmN0aW9uIChmdWxmaWxsLCByZWplY3QpIHtcbiAgICBvcHRzLmNvbXBsZXRlID0gZnVuY3Rpb24gKGVyciwgcmVzKSB7XG4gICAgICBpZiAoZXJyKSB7XG4gICAgICAgIHJlamVjdChlcnIpO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgZnVsZmlsbChyZXMpO1xuICAgICAgfVxuICAgIH07XG4gIH0pO1xuICBzZWxmLm9uY2UoJ2NhbmNlbCcsIGZ1bmN0aW9uICgpIHtcbiAgICBpZiAob2xkT25DaGFuZ2UpIHtcbiAgICAgIHNlbGYucmVtb3ZlTGlzdGVuZXIoJ2NoYW5nZScsIG9sZE9uQ2hhbmdlKTtcbiAgICB9XG4gICAgb3B0cy5jb21wbGV0ZShudWxsLCB7c3RhdHVzOiAnY2FuY2VsbGVkJ30pO1xuICB9KTtcbiAgdGhpcy50aGVuID0gcHJvbWlzZS50aGVuLmJpbmQocHJvbWlzZSk7XG4gIHRoaXNbJ2NhdGNoJ10gPSBwcm9taXNlWydjYXRjaCddLmJpbmQocHJvbWlzZSk7XG4gIHRoaXMudGhlbihmdW5jdGlvbiAocmVzdWx0KSB7XG4gICAgY29tcGxldGUobnVsbCwgcmVzdWx0KTtcbiAgfSwgY29tcGxldGUpO1xuXG5cblxuICBpZiAoIWRiLnRhc2txdWV1ZS5pc1JlYWR5KSB7XG4gICAgZGIudGFza3F1ZXVlLmFkZFRhc2soZnVuY3Rpb24gKCkge1xuICAgICAgaWYgKHNlbGYuaXNDYW5jZWxsZWQpIHtcbiAgICAgICAgc2VsZi5lbWl0KCdjYW5jZWwnKTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIHNlbGYuZG9DaGFuZ2VzKG9wdHMpO1xuICAgICAgfVxuICAgIH0pO1xuICB9IGVsc2Uge1xuICAgIHNlbGYuZG9DaGFuZ2VzKG9wdHMpO1xuICB9XG59XG5DaGFuZ2VzLnByb3RvdHlwZS5jYW5jZWwgPSBmdW5jdGlvbiAoKSB7XG4gIHRoaXMuaXNDYW5jZWxsZWQgPSB0cnVlO1xuICBpZiAodGhpcy5kYi50YXNrcXVldWUuaXNSZWFkeSkge1xuICAgIHRoaXMuZW1pdCgnY2FuY2VsJyk7XG4gIH1cbn07XG5mdW5jdGlvbiBwcm9jZXNzQ2hhbmdlKGRvYywgbWV0YWRhdGEsIG9wdHMpIHtcbiAgdmFyIGNoYW5nZUxpc3QgPSBbe3JldjogZG9jLl9yZXZ9XTtcbiAgaWYgKG9wdHMuc3R5bGUgPT09ICdhbGxfZG9jcycpIHtcbiAgICBjaGFuZ2VMaXN0ID0gbWVyZ2UuY29sbGVjdExlYXZlcyhtZXRhZGF0YS5yZXZfdHJlZSlcbiAgICAubWFwKGZ1bmN0aW9uICh4KSB7IHJldHVybiB7cmV2OiB4LnJldn07IH0pO1xuICB9XG4gIHZhciBjaGFuZ2UgPSB7XG4gICAgaWQ6IG1ldGFkYXRhLmlkLFxuICAgIGNoYW5nZXM6IGNoYW5nZUxpc3QsXG4gICAgZG9jOiBkb2NcbiAgfTtcblxuICBpZiAodXRpbHMuaXNEZWxldGVkKG1ldGFkYXRhLCBkb2MuX3JldikpIHtcbiAgICBjaGFuZ2UuZGVsZXRlZCA9IHRydWU7XG4gIH1cbiAgaWYgKG9wdHMuY29uZmxpY3RzKSB7XG4gICAgY2hhbmdlLmRvYy5fY29uZmxpY3RzID0gbWVyZ2UuY29sbGVjdENvbmZsaWN0cyhtZXRhZGF0YSk7XG4gICAgaWYgKCFjaGFuZ2UuZG9jLl9jb25mbGljdHMubGVuZ3RoKSB7XG4gICAgICBkZWxldGUgY2hhbmdlLmRvYy5fY29uZmxpY3RzO1xuICAgIH1cbiAgfVxuICByZXR1cm4gY2hhbmdlO1xufVxuXG5DaGFuZ2VzLnByb3RvdHlwZS5kb0NoYW5nZXMgPSBmdW5jdGlvbiAob3B0cykge1xuICB2YXIgc2VsZiA9IHRoaXM7XG4gIHZhciBjYWxsYmFjayA9IG9wdHMuY29tcGxldGU7XG5cbiAgb3B0cyA9IHV0aWxzLmNsb25lKG9wdHMpO1xuICBpZiAoJ2xpdmUnIGluIG9wdHMgJiYgISgnY29udGludW91cycgaW4gb3B0cykpIHtcbiAgICBvcHRzLmNvbnRpbnVvdXMgPSBvcHRzLmxpdmU7XG4gIH1cbiAgb3B0cy5wcm9jZXNzQ2hhbmdlID0gcHJvY2Vzc0NoYW5nZTtcblxuICBpZiAob3B0cy5zaW5jZSA9PT0gJ2xhdGVzdCcpIHtcbiAgICBvcHRzLnNpbmNlID0gJ25vdyc7XG4gIH1cbiAgaWYgKCFvcHRzLnNpbmNlKSB7XG4gICAgb3B0cy5zaW5jZSA9IDA7XG4gIH1cbiAgaWYgKG9wdHMuc2luY2UgPT09ICdub3cnKSB7XG4gICAgdGhpcy5kYi5pbmZvKCkudGhlbihmdW5jdGlvbiAoaW5mbykge1xuICAgICAgaWYgKHNlbGYuaXNDYW5jZWxsZWQpIHtcbiAgICAgICAgY2FsbGJhY2sobnVsbCwge3N0YXR1czogJ2NhbmNlbGxlZCd9KTtcbiAgICAgICAgcmV0dXJuO1xuICAgICAgfVxuICAgICAgb3B0cy5zaW5jZSA9IGluZm8udXBkYXRlX3NlcSAgLSAxO1xuICAgICAgc2VsZi5kb0NoYW5nZXMob3B0cyk7XG4gICAgfSwgY2FsbGJhY2spO1xuICAgIHJldHVybjtcbiAgfVxuXG4gIGlmIChvcHRzLmNvbnRpbnVvdXMgJiYgb3B0cy5zaW5jZSAhPT0gJ25vdycpIHtcbiAgICB0aGlzLmRiLmluZm8oKS50aGVuKGZ1bmN0aW9uIChpbmZvKSB7XG4gICAgICBzZWxmLnN0YXJ0U2VxID0gaW5mby51cGRhdGVfc2VxIC0gMTtcbiAgICB9LCBmdW5jdGlvbiAoZXJyKSB7XG4gICAgICBpZiAoZXJyLmlkID09PSAnaWRiTnVsbCcpIHtcbiAgICAgICAgLy9kYiBjbG9zZWQgYmVmb3JlIHRoaXMgcmV0dXJuZWRcbiAgICAgICAgLy90aGF0cyBva1xuICAgICAgICByZXR1cm47XG4gICAgICB9XG4gICAgICB0aHJvdyBlcnI7XG4gICAgfSk7XG4gIH1cblxuICBpZiAodGhpcy5kYi50eXBlKCkgIT09ICdodHRwJyAmJlxuICAgIG9wdHMuZmlsdGVyICYmIHR5cGVvZiBvcHRzLmZpbHRlciA9PT0gJ3N0cmluZycpIHtcbiAgICByZXR1cm4gdGhpcy5maWx0ZXJDaGFuZ2VzKG9wdHMpO1xuICB9XG5cbiAgaWYgKCEoJ2Rlc2NlbmRpbmcnIGluIG9wdHMpKSB7XG4gICAgb3B0cy5kZXNjZW5kaW5nID0gZmFsc2U7XG4gIH1cblxuICAvLyAwIGFuZCAxIHNob3VsZCByZXR1cm4gMSBkb2N1bWVudFxuICBvcHRzLmxpbWl0ID0gb3B0cy5saW1pdCA9PT0gMCA/IDEgOiBvcHRzLmxpbWl0O1xuICBvcHRzLmNvbXBsZXRlID0gY2FsbGJhY2s7XG4gIHZhciBuZXdQcm9taXNlID0gdGhpcy5kYi5fY2hhbmdlcyhvcHRzKTtcbiAgaWYgKG5ld1Byb21pc2UgJiYgdHlwZW9mIG5ld1Byb21pc2UuY2FuY2VsID09PSAnZnVuY3Rpb24nKSB7XG4gICAgdmFyIGNhbmNlbCA9IHNlbGYuY2FuY2VsO1xuICAgIHNlbGYuY2FuY2VsID0gdXRpbHMuZ2V0QXJndW1lbnRzKGZ1bmN0aW9uIChhcmdzKSB7XG4gICAgICBuZXdQcm9taXNlLmNhbmNlbCgpO1xuICAgICAgY2FuY2VsLmFwcGx5KHRoaXMsIGFyZ3MpO1xuICAgIH0pO1xuICB9XG59O1xuXG5DaGFuZ2VzLnByb3RvdHlwZS5maWx0ZXJDaGFuZ2VzID0gZnVuY3Rpb24gKG9wdHMpIHtcbiAgdmFyIHNlbGYgPSB0aGlzO1xuICB2YXIgY2FsbGJhY2sgPSBvcHRzLmNvbXBsZXRlO1xuICBpZiAob3B0cy5maWx0ZXIgPT09ICdfdmlldycpIHtcbiAgICBpZiAoIW9wdHMudmlldyB8fCB0eXBlb2Ygb3B0cy52aWV3ICE9PSAnc3RyaW5nJykge1xuICAgICAgdmFyIGVyciA9IG5ldyAgRXJyb3IoJ2B2aWV3YCBmaWx0ZXIgcGFyYW1ldGVyIGlzIG5vdCBwcm92aWRlZC4nKTtcbiAgICAgIGVyci5zdGF0dXMgPSBlcnJvcnMuQkFEX1JFUVVFU1Quc3RhdHVzO1xuICAgICAgZXJyLm5hbWUgPSBlcnJvcnMuQkFEX1JFUVVFU1QubmFtZTtcbiAgICAgIGVyci5lcnJvciA9IHRydWU7XG4gICAgICBjYWxsYmFjayhlcnIpO1xuICAgICAgcmV0dXJuO1xuICAgIH1cbiAgICAvLyBmZXRjaCBhIHZpZXcgZnJvbSBhIGRlc2lnbiBkb2MsIG1ha2UgaXQgYmVoYXZlIGxpa2UgYSBmaWx0ZXJcbiAgICB2YXIgdmlld05hbWUgPSBvcHRzLnZpZXcuc3BsaXQoJy8nKTtcbiAgICB0aGlzLmRiLmdldCgnX2Rlc2lnbi8nICsgdmlld05hbWVbMF0sIGZ1bmN0aW9uIChlcnIsIGRkb2MpIHtcbiAgICAgIGlmIChzZWxmLmlzQ2FuY2VsbGVkKSB7XG4gICAgICAgIGNhbGxiYWNrKG51bGwsIHtzdGF0dXM6ICdjYW5jZWxsZWQnfSk7XG4gICAgICAgIHJldHVybjtcbiAgICAgIH1cbiAgICAgIGlmIChlcnIpIHtcbiAgICAgICAgY2FsbGJhY2soZXJyKTtcbiAgICAgICAgcmV0dXJuO1xuICAgICAgfVxuICAgICAgaWYgKGRkb2MgJiYgZGRvYy52aWV3cyAmJiBkZG9jLnZpZXdzW3ZpZXdOYW1lWzFdXSkge1xuICAgICAgICBcbiAgICAgICAgdmFyIGZpbHRlciA9IGV2YWxWaWV3KGRkb2Mudmlld3Nbdmlld05hbWVbMV1dLm1hcCk7XG4gICAgICAgIG9wdHMuZmlsdGVyID0gZmlsdGVyO1xuICAgICAgICBzZWxmLmRvQ2hhbmdlcyhvcHRzKTtcbiAgICAgICAgcmV0dXJuO1xuICAgICAgfVxuICAgICAgdmFyIG1zZyA9IGRkb2Mudmlld3MgPyAnbWlzc2luZyBqc29uIGtleTogJyArIHZpZXdOYW1lWzFdIDpcbiAgICAgICAgJ21pc3NpbmcganNvbiBrZXk6IHZpZXdzJztcbiAgICAgIGlmICghZXJyKSB7XG4gICAgICAgIGVyciA9IG5ldyAgRXJyb3IobXNnKTtcbiAgICAgICAgZXJyLnN0YXR1cyA9IGVycm9ycy5NSVNTSU5HX0RPQy5zdGF0dXM7XG4gICAgICAgIGVyci5uYW1lID0gZXJyb3JzLk1JU1NJTkdfRE9DLm5hbWU7XG4gICAgICAgIGVyci5lcnJvciA9IHRydWU7XG4gICAgICB9XG4gICAgICBjYWxsYmFjayhlcnIpO1xuICAgICAgcmV0dXJuO1xuICAgIH0pO1xuICB9IGVsc2Uge1xuICAgIC8vIGZldGNoIGEgZmlsdGVyIGZyb20gYSBkZXNpZ24gZG9jXG4gICAgdmFyIGZpbHRlck5hbWUgPSBvcHRzLmZpbHRlci5zcGxpdCgnLycpO1xuICAgIHRoaXMuZGIuZ2V0KCdfZGVzaWduLycgKyBmaWx0ZXJOYW1lWzBdLCBmdW5jdGlvbiAoZXJyLCBkZG9jKSB7XG4gICAgICBpZiAoc2VsZi5pc0NhbmNlbGxlZCkge1xuICAgICAgICBjYWxsYmFjayhudWxsLCB7c3RhdHVzOiAnY2FuY2VsbGVkJ30pO1xuICAgICAgICByZXR1cm47XG4gICAgICB9XG4gICAgICBpZiAoZXJyKSB7XG4gICAgICAgIGNhbGxiYWNrKGVycik7XG4gICAgICAgIHJldHVybjtcbiAgICAgIH1cbiAgICAgIGlmIChkZG9jICYmIGRkb2MuZmlsdGVycyAmJiBkZG9jLmZpbHRlcnNbZmlsdGVyTmFtZVsxXV0pIHtcbiAgICAgICAgdmFyIGZpbHRlciA9IGV2YWxGaWx0ZXIoZGRvYy5maWx0ZXJzW2ZpbHRlck5hbWVbMV1dKTtcbiAgICAgICAgb3B0cy5maWx0ZXIgPSBmaWx0ZXI7XG4gICAgICAgIHNlbGYuZG9DaGFuZ2VzKG9wdHMpO1xuICAgICAgICByZXR1cm47XG4gICAgICB9IGVsc2Uge1xuICAgICAgICB2YXIgbXNnID0gKGRkb2MgJiYgZGRvYy5maWx0ZXJzKSA/ICdtaXNzaW5nIGpzb24ga2V5OiAnICsgZmlsdGVyTmFtZVsxXVxuICAgICAgICAgIDogJ21pc3NpbmcganNvbiBrZXk6IGZpbHRlcnMnO1xuICAgICAgICBpZiAoIWVycikge1xuICAgICAgICAgIGVyciA9IG5ldyAgRXJyb3IobXNnKTtcbiAgICAgICAgICBlcnIuc3RhdHVzID0gZXJyb3JzLk1JU1NJTkdfRE9DLnN0YXR1cztcbiAgICAgICAgICBlcnIubmFtZSA9IGVycm9ycy5NSVNTSU5HX0RPQy5uYW1lO1xuICAgICAgICAgIGVyci5lcnJvciA9IHRydWU7XG4gICAgICAgIH1cbiAgICAgICAgY2FsbGJhY2soZXJyKTtcbiAgICAgICAgcmV0dXJuO1xuICAgICAgfVxuICAgIH0pO1xuICB9XG59O1xufSx7XCIuL2RlcHMvZXJyb3JzXCI6MTEsXCIuL2V2YWxGaWx0ZXJcIjoxNSxcIi4vZXZhbFZpZXdcIjoxNixcIi4vbWVyZ2VcIjoxOCxcIi4vdXRpbHNcIjoyMyxcImV2ZW50c1wiOjI3fV0sNzpbZnVuY3Rpb24oX2RlcmVxXyxtb2R1bGUsZXhwb3J0cyl7XG4oZnVuY3Rpb24gKGdsb2JhbCl7XG4vKmdsb2JhbHMgY29yZG92YSAqL1xuXCJ1c2Ugc3RyaWN0XCI7XG5cbnZhciBBZGFwdGVyID0gX2RlcmVxXygnLi9hZGFwdGVyJyk7XG52YXIgdXRpbHMgPSBfZGVyZXFfKCcuL3V0aWxzJyk7XG52YXIgVGFza1F1ZXVlID0gX2RlcmVxXygnLi90YXNrcXVldWUnKTtcbnZhciBQcm9taXNlID0gdXRpbHMuUHJvbWlzZTtcblxuZnVuY3Rpb24gZGVmYXVsdENhbGxiYWNrKGVycikge1xuICBpZiAoZXJyICYmIGdsb2JhbC5kZWJ1Zykge1xuICAgIGNvbnNvbGUuZXJyb3IoZXJyKTtcbiAgfVxufVxuXG51dGlscy5pbmhlcml0cyhQb3VjaERCLCBBZGFwdGVyKTtcbmZ1bmN0aW9uIFBvdWNoREIobmFtZSwgb3B0cywgY2FsbGJhY2spIHtcblxuICBpZiAoISh0aGlzIGluc3RhbmNlb2YgUG91Y2hEQikpIHtcbiAgICByZXR1cm4gbmV3IFBvdWNoREIobmFtZSwgb3B0cywgY2FsbGJhY2spO1xuICB9XG4gIHZhciBzZWxmID0gdGhpcztcbiAgaWYgKHR5cGVvZiBvcHRzID09PSAnZnVuY3Rpb24nIHx8IHR5cGVvZiBvcHRzID09PSAndW5kZWZpbmVkJykge1xuICAgIGNhbGxiYWNrID0gb3B0cztcbiAgICBvcHRzID0ge307XG4gIH1cblxuICBpZiAobmFtZSAmJiB0eXBlb2YgbmFtZSA9PT0gJ29iamVjdCcpIHtcbiAgICBvcHRzID0gbmFtZTtcbiAgICBuYW1lID0gdW5kZWZpbmVkO1xuICB9XG4gIGlmICh0eXBlb2YgY2FsbGJhY2sgPT09ICd1bmRlZmluZWQnKSB7XG4gICAgY2FsbGJhY2sgPSBkZWZhdWx0Q2FsbGJhY2s7XG4gIH1cbiAgb3B0cyA9IG9wdHMgfHwge307XG4gIHZhciBvbGRDQiA9IGNhbGxiYWNrO1xuICBzZWxmLmF1dG9fY29tcGFjdGlvbiA9IG9wdHMuYXV0b19jb21wYWN0aW9uO1xuICBzZWxmLnByZWZpeCA9IFBvdWNoREIucHJlZml4O1xuICBBZGFwdGVyLmNhbGwoc2VsZik7XG4gIHNlbGYudGFza3F1ZXVlID0gbmV3IFRhc2tRdWV1ZSgpO1xuICB2YXIgcHJvbWlzZSA9IG5ldyBQcm9taXNlKGZ1bmN0aW9uIChmdWxmaWxsLCByZWplY3QpIHtcbiAgICBjYWxsYmFjayA9IGZ1bmN0aW9uIChlcnIsIHJlc3ApIHtcbiAgICAgIGlmIChlcnIpIHtcbiAgICAgICAgcmV0dXJuIHJlamVjdChlcnIpO1xuICAgICAgfVxuICAgICAgZGVsZXRlIHJlc3AudGhlbjtcbiAgICAgIGZ1bGZpbGwocmVzcCk7XG4gICAgfTtcbiAgXG4gICAgb3B0cyA9IHV0aWxzLmNsb25lKG9wdHMpO1xuICAgIHZhciBvcmlnaW5hbE5hbWUgPSBvcHRzLm5hbWUgfHwgbmFtZTtcbiAgICB2YXIgYmFja2VuZCwgZXJyb3I7XG4gICAgKGZ1bmN0aW9uICgpIHtcbiAgICAgIHRyeSB7XG5cbiAgICAgICAgaWYgKHR5cGVvZiBvcmlnaW5hbE5hbWUgIT09ICdzdHJpbmcnKSB7XG4gICAgICAgICAgZXJyb3IgPSBuZXcgRXJyb3IoJ01pc3NpbmcvaW52YWxpZCBEQiBuYW1lJyk7XG4gICAgICAgICAgZXJyb3IuY29kZSA9IDQwMDtcbiAgICAgICAgICB0aHJvdyBlcnJvcjtcbiAgICAgICAgfVxuXG4gICAgICAgIGJhY2tlbmQgPSBQb3VjaERCLnBhcnNlQWRhcHRlcihvcmlnaW5hbE5hbWUsIG9wdHMpO1xuICAgICAgICBcbiAgICAgICAgb3B0cy5vcmlnaW5hbE5hbWUgPSBvcmlnaW5hbE5hbWU7XG4gICAgICAgIG9wdHMubmFtZSA9IGJhY2tlbmQubmFtZTtcbiAgICAgICAgaWYgKG9wdHMucHJlZml4ICYmIGJhY2tlbmQuYWRhcHRlciAhPT0gJ2h0dHAnICYmXG4gICAgICAgICAgICBiYWNrZW5kLmFkYXB0ZXIgIT09ICdodHRwcycpIHtcbiAgICAgICAgICBvcHRzLm5hbWUgPSBvcHRzLnByZWZpeCArIG9wdHMubmFtZTtcbiAgICAgICAgfVxuICAgICAgICBvcHRzLmFkYXB0ZXIgPSBvcHRzLmFkYXB0ZXIgfHwgYmFja2VuZC5hZGFwdGVyO1xuICAgICAgICBzZWxmLl9hZGFwdGVyID0gb3B0cy5hZGFwdGVyO1xuICAgICAgICBzZWxmLl9kYl9uYW1lID0gb3JpZ2luYWxOYW1lO1xuICAgICAgICBpZiAoIVBvdWNoREIuYWRhcHRlcnNbb3B0cy5hZGFwdGVyXSkge1xuICAgICAgICAgIGVycm9yID0gbmV3IEVycm9yKCdBZGFwdGVyIGlzIG1pc3NpbmcnKTtcbiAgICAgICAgICBlcnJvci5jb2RlID0gNDA0O1xuICAgICAgICAgIHRocm93IGVycm9yO1xuICAgICAgICB9XG5cbiAgICAgICAgaWYgKCFQb3VjaERCLmFkYXB0ZXJzW29wdHMuYWRhcHRlcl0udmFsaWQoKSkge1xuICAgICAgICAgIGVycm9yID0gbmV3IEVycm9yKCdJbnZhbGlkIEFkYXB0ZXInKTtcbiAgICAgICAgICBlcnJvci5jb2RlID0gNDA0O1xuICAgICAgICAgIHRocm93IGVycm9yO1xuICAgICAgICB9XG4gICAgICB9IGNhdGNoIChlcnIpIHtcbiAgICAgICAgc2VsZi50YXNrcXVldWUuZmFpbChlcnIpO1xuICAgICAgICBzZWxmLmNoYW5nZXMgPSB1dGlscy50b1Byb21pc2UoZnVuY3Rpb24gKG9wdHMpIHtcbiAgICAgICAgICBpZiAob3B0cy5jb21wbGV0ZSkge1xuICAgICAgICAgICAgb3B0cy5jb21wbGV0ZShlcnIpO1xuICAgICAgICAgIH1cbiAgICAgICAgfSk7XG4gICAgICB9XG4gICAgfSgpKTtcbiAgICBpZiAoZXJyb3IpIHtcbiAgICAgIHJldHVybiByZWplY3QoZXJyb3IpOyAvLyBjb25zdHJ1Y3RvciBlcnJvciwgc2VlIGFib3ZlXG4gICAgfVxuICAgIHNlbGYuYWRhcHRlciA9IG9wdHMuYWRhcHRlcjtcblxuICAgIC8vIG5lZWRzIGFjY2VzcyB0byBQb3VjaERCO1xuICAgIHNlbGYucmVwbGljYXRlID0ge307XG5cbiAgICBzZWxmLnJlcGxpY2F0ZS5mcm9tID0gZnVuY3Rpb24gKHVybCwgb3B0cywgY2FsbGJhY2spIHtcbiAgICAgIHJldHVybiBzZWxmLmNvbnN0cnVjdG9yLnJlcGxpY2F0ZSh1cmwsIHNlbGYsIG9wdHMsIGNhbGxiYWNrKTtcbiAgICB9O1xuXG4gICAgc2VsZi5yZXBsaWNhdGUudG8gPSBmdW5jdGlvbiAodXJsLCBvcHRzLCBjYWxsYmFjaykge1xuICAgICAgcmV0dXJuIHNlbGYuY29uc3RydWN0b3IucmVwbGljYXRlKHNlbGYsIHVybCwgb3B0cywgY2FsbGJhY2spO1xuICAgIH07XG5cbiAgICBzZWxmLnN5bmMgPSBmdW5jdGlvbiAoZGJOYW1lLCBvcHRzLCBjYWxsYmFjaykge1xuICAgICAgcmV0dXJuIHNlbGYuY29uc3RydWN0b3Iuc3luYyhzZWxmLCBkYk5hbWUsIG9wdHMsIGNhbGxiYWNrKTtcbiAgICB9O1xuXG4gICAgc2VsZi5yZXBsaWNhdGUuc3luYyA9IHNlbGYuc3luYztcblxuICAgIHNlbGYuZGVzdHJveSA9IHV0aWxzLmFkYXB0ZXJGdW4oJ2Rlc3Ryb3knLCBmdW5jdGlvbiAoY2FsbGJhY2spIHtcbiAgICAgIHZhciBzZWxmID0gdGhpcztcbiAgICAgIHNlbGYuaW5mbyhmdW5jdGlvbiAoZXJyLCBpbmZvKSB7XG4gICAgICAgIGlmIChlcnIpIHtcbiAgICAgICAgICByZXR1cm4gY2FsbGJhY2soZXJyKTtcbiAgICAgICAgfVxuICAgICAgICBzZWxmLmNvbnN0cnVjdG9yLmRlc3Ryb3koaW5mby5kYl9uYW1lLCBjYWxsYmFjayk7XG4gICAgICB9KTtcbiAgICB9KTtcblxuICAgIFBvdWNoREIuYWRhcHRlcnNbb3B0cy5hZGFwdGVyXS5jYWxsKHNlbGYsIG9wdHMsIGZ1bmN0aW9uIChlcnIsIGRiKSB7XG4gICAgICBpZiAoZXJyKSB7XG4gICAgICAgIGlmIChjYWxsYmFjaykge1xuICAgICAgICAgIHNlbGYudGFza3F1ZXVlLmZhaWwoZXJyKTtcbiAgICAgICAgICBjYWxsYmFjayhlcnIpO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybjtcbiAgICAgIH1cbiAgICAgIGZ1bmN0aW9uIGRlc3RydWN0aW9uTGlzdGVuZXIoZXZlbnQpIHtcbiAgICAgICAgaWYgKGV2ZW50ID09PSAnZGVzdHJveWVkJykge1xuICAgICAgICAgIHNlbGYuZW1pdCgnZGVzdHJveWVkJyk7XG4gICAgICAgICAgUG91Y2hEQi5yZW1vdmVMaXN0ZW5lcihvcmlnaW5hbE5hbWUsIGRlc3RydWN0aW9uTGlzdGVuZXIpO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgICBQb3VjaERCLm9uKG9yaWdpbmFsTmFtZSwgZGVzdHJ1Y3Rpb25MaXN0ZW5lcik7XG4gICAgICBzZWxmLmVtaXQoJ2NyZWF0ZWQnLCBzZWxmKTtcbiAgICAgIFBvdWNoREIuZW1pdCgnY3JlYXRlZCcsIG9wdHMub3JpZ2luYWxOYW1lKTtcbiAgICAgIHNlbGYudGFza3F1ZXVlLnJlYWR5KHNlbGYpO1xuICAgICAgY2FsbGJhY2sobnVsbCwgc2VsZik7XG4gICAgICBcbiAgICB9KTtcbiAgICBpZiAob3B0cy5za2lwU2V0dXApIHtcbiAgICAgIHNlbGYudGFza3F1ZXVlLnJlYWR5KHNlbGYpO1xuICAgIH1cblxuICAgIGlmICh1dGlscy5pc0NvcmRvdmEoKSkge1xuICAgICAgLy90byBpbmZvcm0gd2Vic3FsIGFkYXB0ZXIgdGhhdCB3ZSBjYW4gdXNlIGFwaVxuICAgICAgY29yZG92YS5maXJlV2luZG93RXZlbnQob3B0cy5uYW1lICsgXCJfcG91Y2hcIiwge30pO1xuICAgIH1cbiAgfSk7XG4gIHByb21pc2UudGhlbihmdW5jdGlvbiAocmVzcCkge1xuICAgIG9sZENCKG51bGwsIHJlc3ApO1xuICB9LCBvbGRDQik7XG4gIHNlbGYudGhlbiA9IHByb21pc2UudGhlbi5iaW5kKHByb21pc2UpO1xuICBzZWxmW1wiY2F0Y2hcIl0gPSBwcm9taXNlW1wiY2F0Y2hcIl0uYmluZChwcm9taXNlKTtcblxufVxuXG5tb2R1bGUuZXhwb3J0cyA9IFBvdWNoREI7XG5cbn0pLmNhbGwodGhpcyx0eXBlb2Ygc2VsZiAhPT0gXCJ1bmRlZmluZWRcIiA/IHNlbGYgOiB0eXBlb2Ygd2luZG93ICE9PSBcInVuZGVmaW5lZFwiID8gd2luZG93IDoge30pXG59LHtcIi4vYWRhcHRlclwiOjEsXCIuL3Rhc2txdWV1ZVwiOjIyLFwiLi91dGlsc1wiOjIzfV0sODpbZnVuY3Rpb24oX2RlcmVxXyxtb2R1bGUsZXhwb3J0cyl7XG5cInVzZSBzdHJpY3RcIjtcblxudmFyIGNyZWF0ZUJsb2IgPSBfZGVyZXFfKCcuL2Jsb2IuanMnKTtcbnZhciBlcnJvcnMgPSBfZGVyZXFfKCcuL2Vycm9ycycpO1xudmFyIHV0aWxzID0gX2RlcmVxXyhcIi4uL3V0aWxzXCIpO1xudmFyIGhhc1VwbG9hZDtcblxuZnVuY3Rpb24gYWpheChvcHRpb25zLCBhZGFwdGVyQ2FsbGJhY2spIHtcblxuICB2YXIgcmVxdWVzdENvbXBsZXRlZCA9IGZhbHNlO1xuICB2YXIgY2FsbGJhY2sgPSB1dGlscy5nZXRBcmd1bWVudHMoZnVuY3Rpb24gKGFyZ3MpIHtcbiAgICBpZiAocmVxdWVzdENvbXBsZXRlZCkge1xuICAgICAgcmV0dXJuO1xuICAgIH1cbiAgICBhZGFwdGVyQ2FsbGJhY2suYXBwbHkodGhpcywgYXJncyk7XG4gICAgcmVxdWVzdENvbXBsZXRlZCA9IHRydWU7XG4gIH0pO1xuXG4gIGlmICh0eXBlb2Ygb3B0aW9ucyA9PT0gXCJmdW5jdGlvblwiKSB7XG4gICAgY2FsbGJhY2sgPSBvcHRpb25zO1xuICAgIG9wdGlvbnMgPSB7fTtcbiAgfVxuXG4gIG9wdGlvbnMgPSB1dGlscy5jbG9uZShvcHRpb25zKTtcblxuICB2YXIgZGVmYXVsdE9wdGlvbnMgPSB7XG4gICAgbWV0aG9kIDogXCJHRVRcIixcbiAgICBoZWFkZXJzOiB7fSxcbiAgICBqc29uOiB0cnVlLFxuICAgIHByb2Nlc3NEYXRhOiB0cnVlLFxuICAgIHRpbWVvdXQ6IDEwMDAwLFxuICAgIGNhY2hlOiBmYWxzZVxuICB9O1xuXG4gIG9wdGlvbnMgPSB1dGlscy5leHRlbmQodHJ1ZSwgZGVmYXVsdE9wdGlvbnMsIG9wdGlvbnMpO1xuXG4gIC8vIGNhY2hlLWJ1c3Rlciwgc3BlY2lmaWNhbGx5IGRlc2lnbmVkIHRvIHdvcmsgYXJvdW5kIElFJ3MgYWdncmVzc2l2ZSBjYWNoaW5nXG4gIC8vIHNlZSBodHRwOi8vd3d3LmRhc2hiYXkuY29tLzIwMTEvMDUvaW50ZXJuZXQtZXhwbG9yZXItY2FjaGVzLWFqYXgvXG4gIGlmIChvcHRpb25zLm1ldGhvZCA9PT0gJ0dFVCcgJiYgIW9wdGlvbnMuY2FjaGUpIHtcbiAgICB2YXIgaGFzQXJncyA9IG9wdGlvbnMudXJsLmluZGV4T2YoJz8nKSAhPT0gLTE7XG4gICAgb3B0aW9ucy51cmwgKz0gKGhhc0FyZ3MgPyAnJicgOiAnPycpICsgJ19ub25jZT0nICsgdXRpbHMudXVpZCgxNik7XG4gIH1cblxuICBmdW5jdGlvbiBvblN1Y2Nlc3Mob2JqLCByZXNwLCBjYikge1xuICAgIGlmICghb3B0aW9ucy5iaW5hcnkgJiYgIW9wdGlvbnMuanNvbiAmJiBvcHRpb25zLnByb2Nlc3NEYXRhICYmXG4gICAgICB0eXBlb2Ygb2JqICE9PSAnc3RyaW5nJykge1xuICAgICAgb2JqID0gSlNPTi5zdHJpbmdpZnkob2JqKTtcbiAgICB9IGVsc2UgaWYgKCFvcHRpb25zLmJpbmFyeSAmJiBvcHRpb25zLmpzb24gJiYgdHlwZW9mIG9iaiA9PT0gJ3N0cmluZycpIHtcbiAgICAgIHRyeSB7XG4gICAgICAgIG9iaiA9IEpTT04ucGFyc2Uob2JqKTtcbiAgICAgIH0gY2F0Y2ggKGUpIHtcbiAgICAgICAgLy8gUHJvYmFibHkgYSBtYWxmb3JtZWQgSlNPTiBmcm9tIHNlcnZlclxuICAgICAgICByZXR1cm4gY2IoZSk7XG4gICAgICB9XG4gICAgfVxuICAgIGlmIChBcnJheS5pc0FycmF5KG9iaikpIHtcbiAgICAgIG9iaiA9IG9iai5tYXAoZnVuY3Rpb24gKHYpIHtcbiAgICAgICAgdmFyIG9iajtcbiAgICAgICAgaWYgKHYub2spIHtcbiAgICAgICAgICByZXR1cm4gdjtcbiAgICAgICAgfSBlbHNlIGlmICh2LmVycm9yICYmIHYuZXJyb3IgPT09ICdjb25mbGljdCcpIHtcbiAgICAgICAgICBvYmogPSBlcnJvcnMuUkVWX0NPTkZMSUNUO1xuICAgICAgICAgIG9iai5pZCA9IHYuaWQ7XG4gICAgICAgICAgcmV0dXJuIG9iajtcbiAgICAgICAgfSBlbHNlIGlmICh2LmVycm9yICYmIHYuZXJyb3IgPT09ICdmb3JiaWRkZW4nKSB7XG4gICAgICAgICAgb2JqID0gZXJyb3JzLkZPUkJJRERFTjtcbiAgICAgICAgICBvYmouaWQgPSB2LmlkO1xuICAgICAgICAgIG9iai5yZWFzb24gPSB2LnJlYXNvbjtcbiAgICAgICAgICByZXR1cm4gb2JqO1xuICAgICAgICB9IGVsc2UgaWYgKHYubWlzc2luZykge1xuICAgICAgICAgIG9iaiA9IGVycm9ycy5NSVNTSU5HX0RPQztcbiAgICAgICAgICBvYmoubWlzc2luZyA9IHYubWlzc2luZztcbiAgICAgICAgICByZXR1cm4gb2JqO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgIHJldHVybiB2O1xuICAgICAgICB9XG4gICAgICB9KTtcbiAgICB9XG4gICAgY2IobnVsbCwgb2JqLCByZXNwKTtcbiAgfVxuXG4gIGZ1bmN0aW9uIG9uRXJyb3IoZXJyLCBjYikge1xuICAgIHZhciBlcnJQYXJzZWQsIGVyck9iaiwgZXJyVHlwZSwga2V5O1xuICAgIHRyeSB7XG4gICAgICBlcnJQYXJzZWQgPSBKU09OLnBhcnNlKGVyci5yZXNwb25zZVRleHQpO1xuICAgICAgLy93b3VsZCBwcmVmZXIgbm90IHRvIGhhdmUgYSB0cnkvY2F0Y2ggY2xhdXNlXG4gICAgICBmb3IgKGtleSBpbiBlcnJvcnMpIHtcbiAgICAgICAgaWYgKGVycm9ycy5oYXNPd25Qcm9wZXJ0eShrZXkpICYmXG4gICAgICAgICAgICBlcnJvcnNba2V5XS5uYW1lID09PSBlcnJQYXJzZWQuZXJyb3IpIHtcbiAgICAgICAgICBlcnJUeXBlID0gZXJyb3JzW2tleV07XG4gICAgICAgICAgYnJlYWs7XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICAgIGlmICghZXJyVHlwZSkge1xuICAgICAgICBlcnJUeXBlID0gZXJyb3JzLlVOS05PV05fRVJST1I7XG4gICAgICAgIGlmIChlcnIuc3RhdHVzKSB7XG4gICAgICAgICAgZXJyVHlwZS5zdGF0dXMgPSBlcnIuc3RhdHVzO1xuICAgICAgICB9XG4gICAgICAgIGlmIChlcnIuc3RhdHVzVGV4dCkge1xuICAgICAgICAgIGVyci5uYW1lID0gZXJyLnN0YXR1c1RleHQ7XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICAgIGVyck9iaiA9IGVycm9ycy5lcnJvcihlcnJUeXBlLCBlcnJQYXJzZWQucmVhc29uKTtcbiAgICB9IGNhdGNoIChlKSB7XG4gICAgICBmb3IgKHZhciBrZXkgaW4gZXJyb3JzKSB7XG4gICAgICAgIGlmIChlcnJvcnMuaGFzT3duUHJvcGVydHkoa2V5KSAmJiBlcnJvcnNba2V5XS5zdGF0dXMgPT09IGVyci5zdGF0dXMpIHtcbiAgICAgICAgICBlcnJUeXBlID0gZXJyb3JzW2tleV07XG4gICAgICAgICAgYnJlYWs7XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICAgIGlmICghZXJyVHlwZSkge1xuICAgICAgICBlcnJUeXBlID0gZXJyb3JzLlVOS05PV05fRVJST1I7XG4gICAgICAgIGlmIChlcnIuc3RhdHVzKSB7XG4gICAgICAgICAgZXJyVHlwZS5zdGF0dXMgPSBlcnIuc3RhdHVzO1xuICAgICAgICB9XG4gICAgICAgIGlmIChlcnIuc3RhdHVzVGV4dCkge1xuICAgICAgICAgIGVyci5uYW1lID0gZXJyLnN0YXR1c1RleHQ7XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICAgIGVyck9iaiA9IGVycm9ycy5lcnJvcihlcnJUeXBlKTtcbiAgICB9XG4gICAgaWYgKGVyci53aXRoQ3JlZGVudGlhbHMgJiYgZXJyLnN0YXR1cyA9PT0gMCkge1xuICAgICAgLy8gYXBwYXJlbnRseSB0aGlzIGlzIHdoYXQgd2UgZ2V0IHdoZW4gdGhlIG1ldGhvZFxuICAgICAgLy8gaXMgcmVwb3J0ZWQgYXMgbm90IGFsbG93ZWQgYnkgQ09SUy4gc28gZnVkZ2UgaXRcbiAgICAgIGVyck9iai5zdGF0dXMgPSA0MDU7XG4gICAgICBlcnJPYmouc3RhdHVzVGV4dCA9IFwiTWV0aG9kIE5vdCBBbGxvd2VkXCI7XG4gICAgfVxuICAgIGNiKGVyck9iaik7XG4gIH1cblxuICB2YXIgdGltZXI7XG4gIHZhciB4aHI7XG4gIGlmIChvcHRpb25zLnhocikge1xuICAgIHhociA9IG5ldyBvcHRpb25zLnhocigpO1xuICB9IGVsc2Uge1xuICAgIHhociA9IG5ldyBYTUxIdHRwUmVxdWVzdCgpO1xuICB9XG4gIHhoci5vcGVuKG9wdGlvbnMubWV0aG9kLCBvcHRpb25zLnVybCk7XG4gIHhoci53aXRoQ3JlZGVudGlhbHMgPSB0cnVlO1xuXG4gIGlmIChvcHRpb25zLmpzb24pIHtcbiAgICBvcHRpb25zLmhlYWRlcnMuQWNjZXB0ID0gJ2FwcGxpY2F0aW9uL2pzb24nO1xuICAgIG9wdGlvbnMuaGVhZGVyc1snQ29udGVudC1UeXBlJ10gPSBvcHRpb25zLmhlYWRlcnNbJ0NvbnRlbnQtVHlwZSddIHx8XG4gICAgICAnYXBwbGljYXRpb24vanNvbic7XG4gICAgaWYgKG9wdGlvbnMuYm9keSAmJlxuICAgICAgICBvcHRpb25zLnByb2Nlc3NEYXRhICYmXG4gICAgICAgIHR5cGVvZiBvcHRpb25zLmJvZHkgIT09IFwic3RyaW5nXCIpIHtcbiAgICAgIG9wdGlvbnMuYm9keSA9IEpTT04uc3RyaW5naWZ5KG9wdGlvbnMuYm9keSk7XG4gICAgfVxuICB9XG5cbiAgaWYgKG9wdGlvbnMuYmluYXJ5KSB7XG4gICAgeGhyLnJlc3BvbnNlVHlwZSA9ICdhcnJheWJ1ZmZlcic7XG4gIH1cblxuICB2YXIgY3JlYXRlQ29va2llID0gZnVuY3Rpb24gKG5hbWUsIHZhbHVlLCBkYXlzKSB7XG4gICAgdmFyIGV4cGlyZXMgPSBcIlwiO1xuICAgIGlmIChkYXlzKSB7XG4gICAgICB2YXIgZGF0ZSA9IG5ldyBEYXRlKCk7XG4gICAgICBkYXRlLnNldFRpbWUoZGF0ZS5nZXRUaW1lKCkgKyAoZGF5cyAqIDI0ICogNjAgKiA2MCAqIDEwMDApKTtcbiAgICAgIGV4cGlyZXMgPSBcIjsgZXhwaXJlcz1cIiArIGRhdGUudG9HTVRTdHJpbmcoKTtcbiAgICB9XG4gICAgZG9jdW1lbnQuY29va2llID0gbmFtZSArIFwiPVwiICsgdmFsdWUgKyBleHBpcmVzICsgXCI7IHBhdGg9L1wiO1xuICB9O1xuXG4gIGZvciAodmFyIGtleSBpbiBvcHRpb25zLmhlYWRlcnMpIHtcbiAgICBpZiAoa2V5ID09PSAnQ29va2llJykge1xuICAgICAgdmFyIGNvb2tpZSA9IG9wdGlvbnMuaGVhZGVyc1trZXldLnNwbGl0KCc9Jyk7XG4gICAgICBjcmVhdGVDb29raWUoY29va2llWzBdLCBjb29raWVbMV0sIDEwKTtcbiAgICB9IGVsc2Uge1xuICAgICAgeGhyLnNldFJlcXVlc3RIZWFkZXIoa2V5LCBvcHRpb25zLmhlYWRlcnNba2V5XSk7XG4gICAgfVxuICB9XG5cbiAgaWYgKCEoXCJib2R5XCIgaW4gb3B0aW9ucykpIHtcbiAgICBvcHRpb25zLmJvZHkgPSBudWxsO1xuICB9XG5cbiAgdmFyIGFib3J0UmVxID0gZnVuY3Rpb24gKCkge1xuICAgIGlmIChyZXF1ZXN0Q29tcGxldGVkKSB7XG4gICAgICByZXR1cm47XG4gICAgfVxuICAgIHhoci5hYm9ydCgpO1xuICAgIG9uRXJyb3IoeGhyLCBjYWxsYmFjayk7XG4gIH07XG5cbiAgeGhyLm9ucmVhZHlzdGF0ZWNoYW5nZSA9IGZ1bmN0aW9uICgpIHtcbiAgICBpZiAoeGhyLnJlYWR5U3RhdGUgIT09IDQgfHwgcmVxdWVzdENvbXBsZXRlZCkge1xuICAgICAgcmV0dXJuO1xuICAgIH1cbiAgICBjbGVhclRpbWVvdXQodGltZXIpO1xuICAgIGlmICh4aHIuc3RhdHVzID49IDIwMCAmJiB4aHIuc3RhdHVzIDwgMzAwKSB7XG4gICAgICB2YXIgZGF0YTtcbiAgICAgIGlmIChvcHRpb25zLmJpbmFyeSkge1xuICAgICAgICBkYXRhID0gY3JlYXRlQmxvYihbeGhyLnJlc3BvbnNlIHx8ICcnXSwge1xuICAgICAgICAgIHR5cGU6IHhoci5nZXRSZXNwb25zZUhlYWRlcignQ29udGVudC1UeXBlJylcbiAgICAgICAgfSk7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICBkYXRhID0geGhyLnJlc3BvbnNlVGV4dDtcbiAgICAgIH1cbiAgICAgIG9uU3VjY2VzcyhkYXRhLCB4aHIsIGNhbGxiYWNrKTtcbiAgICB9IGVsc2Uge1xuICAgICAgb25FcnJvcih4aHIsIGNhbGxiYWNrKTtcbiAgICB9XG4gIH07XG5cbiAgaWYgKG9wdGlvbnMudGltZW91dCA+IDApIHtcbiAgICB0aW1lciA9IHNldFRpbWVvdXQoYWJvcnRSZXEsIG9wdGlvbnMudGltZW91dCk7XG4gICAgeGhyLm9ucHJvZ3Jlc3MgPSBmdW5jdGlvbiAoKSB7XG4gICAgICBjbGVhclRpbWVvdXQodGltZXIpO1xuICAgICAgdGltZXIgPSBzZXRUaW1lb3V0KGFib3J0UmVxLCBvcHRpb25zLnRpbWVvdXQpO1xuICAgIH07XG4gICAgaWYgKHR5cGVvZiBoYXNVcGxvYWQgPT09ICd1bmRlZmluZWQnKSB7XG4gICAgICAvLyBJRSB0aHJvd3MgYW4gZXJyb3IgaWYgeW91IHRyeSB0byBhY2Nlc3MgaXQgZGlyZWN0bHlcbiAgICAgIGhhc1VwbG9hZCA9IE9iamVjdC5rZXlzKHhocikuaW5kZXhPZigndXBsb2FkJykgIT09IC0xO1xuICAgIH1cbiAgICBpZiAoaGFzVXBsb2FkKSB7IC8vIGRvZXMgbm90IGV4aXN0IGluIGllOVxuICAgICAgeGhyLnVwbG9hZC5vbnByb2dyZXNzID0geGhyLm9ucHJvZ3Jlc3M7XG4gICAgfVxuICB9XG4gIGlmIChvcHRpb25zLmJvZHkgJiYgKG9wdGlvbnMuYm9keSBpbnN0YW5jZW9mIEJsb2IpKSB7XG4gICAgdmFyIHJlYWRlciA9IG5ldyBGaWxlUmVhZGVyKCk7XG4gICAgcmVhZGVyLm9ubG9hZGVuZCA9IGZ1bmN0aW9uIChlKSB7XG5cbiAgICAgIHZhciBiaW5hcnkgPSBcIlwiO1xuICAgICAgdmFyIGJ5dGVzID0gbmV3IFVpbnQ4QXJyYXkodGhpcy5yZXN1bHQpO1xuICAgICAgdmFyIGxlbmd0aCA9IGJ5dGVzLmJ5dGVMZW5ndGg7XG5cbiAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgbGVuZ3RoOyBpKyspIHtcbiAgICAgICAgYmluYXJ5ICs9IFN0cmluZy5mcm9tQ2hhckNvZGUoYnl0ZXNbaV0pO1xuICAgICAgfVxuXG4gICAgICBiaW5hcnkgPSB1dGlscy5maXhCaW5hcnkoYmluYXJ5KTtcbiAgICAgIHhoci5zZW5kKGJpbmFyeSk7XG4gICAgfTtcbiAgICByZWFkZXIucmVhZEFzQXJyYXlCdWZmZXIob3B0aW9ucy5ib2R5KTtcbiAgfSBlbHNlIHtcbiAgICB4aHIuc2VuZChvcHRpb25zLmJvZHkpO1xuICB9XG4gIHJldHVybiB7YWJvcnQ6IGFib3J0UmVxfTtcbn1cblxubW9kdWxlLmV4cG9ydHMgPSBhamF4O1xuXG59LHtcIi4uL3V0aWxzXCI6MjMsXCIuL2Jsb2IuanNcIjo5LFwiLi9lcnJvcnNcIjoxMX1dLDk6W2Z1bmN0aW9uKF9kZXJlcV8sbW9kdWxlLGV4cG9ydHMpe1xuKGZ1bmN0aW9uIChnbG9iYWwpe1xuXCJ1c2Ugc3RyaWN0XCI7XG5cbi8vQWJzdHJhY3RzIGNvbnN0cnVjdGluZyBhIEJsb2Igb2JqZWN0LCBzbyBpdCBhbHNvIHdvcmtzIGluIG9sZGVyXG4vL2Jyb3dzZXJzIHRoYXQgZG9uJ3Qgc3VwcG9ydCB0aGUgbmF0aXZlIEJsb2IgY29uc3RydWN0b3IuIChpLmUuXG4vL29sZCBRdFdlYktpdCB2ZXJzaW9ucywgYXQgbGVhc3QpLlxuZnVuY3Rpb24gY3JlYXRlQmxvYihwYXJ0cywgcHJvcGVydGllcykge1xuICBwYXJ0cyA9IHBhcnRzIHx8IFtdO1xuICBwcm9wZXJ0aWVzID0gcHJvcGVydGllcyB8fCB7fTtcbiAgdHJ5IHtcbiAgICByZXR1cm4gbmV3IEJsb2IocGFydHMsIHByb3BlcnRpZXMpO1xuICB9IGNhdGNoIChlKSB7XG4gICAgaWYgKGUubmFtZSAhPT0gXCJUeXBlRXJyb3JcIikge1xuICAgICAgdGhyb3cgZTtcbiAgICB9XG4gICAgdmFyIEJsb2JCdWlsZGVyID0gZ2xvYmFsLkJsb2JCdWlsZGVyIHx8XG4gICAgICAgICAgICAgICAgICAgICAgZ2xvYmFsLk1TQmxvYkJ1aWxkZXIgfHxcbiAgICAgICAgICAgICAgICAgICAgICBnbG9iYWwuTW96QmxvYkJ1aWxkZXIgfHxcbiAgICAgICAgICAgICAgICAgICAgICBnbG9iYWwuV2ViS2l0QmxvYkJ1aWxkZXI7XG4gICAgdmFyIGJ1aWxkZXIgPSBuZXcgQmxvYkJ1aWxkZXIoKTtcbiAgICBmb3IgKHZhciBpID0gMDsgaSA8IHBhcnRzLmxlbmd0aDsgaSArPSAxKSB7XG4gICAgICBidWlsZGVyLmFwcGVuZChwYXJ0c1tpXSk7XG4gICAgfVxuICAgIHJldHVybiBidWlsZGVyLmdldEJsb2IocHJvcGVydGllcy50eXBlKTtcbiAgfVxufVxuXG5tb2R1bGUuZXhwb3J0cyA9IGNyZWF0ZUJsb2I7XG5cblxufSkuY2FsbCh0aGlzLHR5cGVvZiBzZWxmICE9PSBcInVuZGVmaW5lZFwiID8gc2VsZiA6IHR5cGVvZiB3aW5kb3cgIT09IFwidW5kZWZpbmVkXCIgPyB3aW5kb3cgOiB7fSlcbn0se31dLDEwOltmdW5jdGlvbihfZGVyZXFfLG1vZHVsZSxleHBvcnRzKXtcbid1c2Ugc3RyaWN0JztcbmV4cG9ydHMuTWFwID0gTGF6eU1hcDsgLy8gVE9ETzogdXNlIEVTNiBtYXBcbmV4cG9ydHMuU2V0ID0gTGF6eVNldDsgLy8gVE9ETzogdXNlIEVTNiBzZXRcbi8vIGJhc2VkIG9uIGh0dHBzOi8vZ2l0aHViLmNvbS9tb250YWdlanMvY29sbGVjdGlvbnNcbmZ1bmN0aW9uIExhenlNYXAoKSB7XG4gIHRoaXMuc3RvcmUgPSB7fTtcbn1cbkxhenlNYXAucHJvdG90eXBlLm1hbmdsZSA9IGZ1bmN0aW9uIChrZXkpIHtcbiAgaWYgKHR5cGVvZiBrZXkgIT09IFwic3RyaW5nXCIpIHtcbiAgICB0aHJvdyBuZXcgVHlwZUVycm9yKFwia2V5IG11c3QgYmUgYSBzdHJpbmcgYnV0IEdvdCBcIiArIGtleSk7XG4gIH1cbiAgcmV0dXJuICckJyArIGtleTtcbn07XG5MYXp5TWFwLnByb3RvdHlwZS51bm1hbmdsZSA9IGZ1bmN0aW9uIChrZXkpIHtcbiAgcmV0dXJuIGtleS5zdWJzdHJpbmcoMSk7XG59O1xuTGF6eU1hcC5wcm90b3R5cGUuZ2V0ID0gZnVuY3Rpb24gKGtleSkge1xuICB2YXIgbWFuZ2xlZCA9IHRoaXMubWFuZ2xlKGtleSk7XG4gIGlmIChtYW5nbGVkIGluIHRoaXMuc3RvcmUpIHtcbiAgICByZXR1cm4gdGhpcy5zdG9yZVttYW5nbGVkXTtcbiAgfSBlbHNlIHtcbiAgICByZXR1cm4gdm9pZCAwO1xuICB9XG59O1xuTGF6eU1hcC5wcm90b3R5cGUuc2V0ID0gZnVuY3Rpb24gKGtleSwgdmFsdWUpIHtcbiAgdmFyIG1hbmdsZWQgPSB0aGlzLm1hbmdsZShrZXkpO1xuICB0aGlzLnN0b3JlW21hbmdsZWRdID0gdmFsdWU7XG4gIHJldHVybiB0cnVlO1xufTtcbkxhenlNYXAucHJvdG90eXBlLmhhcyA9IGZ1bmN0aW9uIChrZXkpIHtcbiAgdmFyIG1hbmdsZWQgPSB0aGlzLm1hbmdsZShrZXkpO1xuICByZXR1cm4gbWFuZ2xlZCBpbiB0aGlzLnN0b3JlO1xufTtcbkxhenlNYXAucHJvdG90eXBlW1wiZGVsZXRlXCJdID0gZnVuY3Rpb24gKGtleSkge1xuICB2YXIgbWFuZ2xlZCA9IHRoaXMubWFuZ2xlKGtleSk7XG4gIGlmIChtYW5nbGVkIGluIHRoaXMuc3RvcmUpIHtcbiAgICBkZWxldGUgdGhpcy5zdG9yZVttYW5nbGVkXTtcbiAgICByZXR1cm4gdHJ1ZTtcbiAgfVxuICByZXR1cm4gZmFsc2U7XG59O1xuTGF6eU1hcC5wcm90b3R5cGUuZm9yRWFjaCA9IGZ1bmN0aW9uIChjYikge1xuICB2YXIgc2VsZiA9IHRoaXM7XG4gIHZhciBrZXlzID0gT2JqZWN0LmtleXMoc2VsZi5zdG9yZSk7XG4gIGtleXMuZm9yRWFjaChmdW5jdGlvbiAoa2V5KSB7XG4gICAgdmFyIHZhbHVlID0gc2VsZi5zdG9yZVtrZXldO1xuICAgIGtleSA9IHNlbGYudW5tYW5nbGUoa2V5KTtcbiAgICBjYih2YWx1ZSwga2V5KTtcbiAgfSk7XG59O1xuXG5mdW5jdGlvbiBMYXp5U2V0KCkge1xuICB0aGlzLnN0b3JlID0gbmV3IExhenlNYXAoKTtcbn1cbkxhenlTZXQucHJvdG90eXBlLmFkZCA9IGZ1bmN0aW9uIChrZXkpIHtcbiAgcmV0dXJuIHRoaXMuc3RvcmUuc2V0KGtleSwgdHJ1ZSk7XG59O1xuTGF6eVNldC5wcm90b3R5cGUuaGFzID0gZnVuY3Rpb24gKGtleSkge1xuICByZXR1cm4gdGhpcy5zdG9yZS5oYXMoa2V5KTtcbn07XG5MYXp5U2V0LnByb3RvdHlwZVtcImRlbGV0ZVwiXSA9IGZ1bmN0aW9uIChrZXkpIHtcbiAgcmV0dXJuIHRoaXMuc3RvcmVbXCJkZWxldGVcIl0oa2V5KTtcbn07XG59LHt9XSwxMTpbZnVuY3Rpb24oX2RlcmVxXyxtb2R1bGUsZXhwb3J0cyl7XG5cInVzZSBzdHJpY3RcIjtcblxuZnVuY3Rpb24gUG91Y2hFcnJvcihvcHRzKSB7XG4gIHRoaXMuc3RhdHVzID0gb3B0cy5zdGF0dXM7XG4gIHRoaXMubmFtZSA9IG9wdHMuZXJyb3I7XG4gIHRoaXMubWVzc2FnZSA9IG9wdHMucmVhc29uO1xuICB0aGlzLmVycm9yID0gdHJ1ZTtcbn1cblxuUG91Y2hFcnJvci5wcm90b3R5cGVfX3Byb3RvX18gPSBFcnJvci5wcm90b3R5cGU7XG5cblBvdWNoRXJyb3IucHJvdG90eXBlLnRvU3RyaW5nID0gZnVuY3Rpb24gKCkge1xuICByZXR1cm4gSlNPTi5zdHJpbmdpZnkoe1xuICAgIHN0YXR1czogdGhpcy5zdGF0dXMsXG4gICAgbmFtZTogdGhpcy5uYW1lLFxuICAgIG1lc3NhZ2U6IHRoaXMubWVzc2FnZVxuICB9KTtcbn07XG5cbmV4cG9ydHMuVU5BVVRIT1JJWkVEID0gbmV3IFBvdWNoRXJyb3Ioe1xuICBzdGF0dXM6IDQwMSxcbiAgZXJyb3I6ICd1bmF1dGhvcml6ZWQnLFxuICByZWFzb246IFwiTmFtZSBvciBwYXNzd29yZCBpcyBpbmNvcnJlY3QuXCJcbn0pO1xuZXhwb3J0cy5NSVNTSU5HX0JVTEtfRE9DUyA9IG5ldyBQb3VjaEVycm9yKHtcbiAgc3RhdHVzOiA0MDAsXG4gIGVycm9yOiAnYmFkX3JlcXVlc3QnLFxuICByZWFzb246IFwiTWlzc2luZyBKU09OIGxpc3Qgb2YgJ2RvY3MnXCJcbn0pO1xuZXhwb3J0cy5NSVNTSU5HX0RPQyA9IG5ldyBQb3VjaEVycm9yKHtcbiAgc3RhdHVzOiA0MDQsXG4gIGVycm9yOiAnbm90X2ZvdW5kJyxcbiAgcmVhc29uOiAnbWlzc2luZydcbn0pO1xuZXhwb3J0cy5SRVZfQ09ORkxJQ1QgPSBuZXcgUG91Y2hFcnJvcih7XG4gIHN0YXR1czogNDA5LFxuICBlcnJvcjogJ2NvbmZsaWN0JyxcbiAgcmVhc29uOiAnRG9jdW1lbnQgdXBkYXRlIGNvbmZsaWN0J1xufSk7XG5leHBvcnRzLklOVkFMSURfSUQgPSBuZXcgUG91Y2hFcnJvcih7XG4gIHN0YXR1czogNDAwLFxuICBlcnJvcjogJ2ludmFsaWRfaWQnLFxuICByZWFzb246ICdfaWQgZmllbGQgbXVzdCBjb250YWluIGEgc3RyaW5nJ1xufSk7XG5leHBvcnRzLk1JU1NJTkdfSUQgPSBuZXcgUG91Y2hFcnJvcih7XG4gIHN0YXR1czogNDEyLFxuICBlcnJvcjogJ21pc3NpbmdfaWQnLFxuICByZWFzb246ICdfaWQgaXMgcmVxdWlyZWQgZm9yIHB1dHMnXG59KTtcbmV4cG9ydHMuUkVTRVJWRURfSUQgPSBuZXcgUG91Y2hFcnJvcih7XG4gIHN0YXR1czogNDAwLFxuICBlcnJvcjogJ2JhZF9yZXF1ZXN0JyxcbiAgcmVhc29uOiAnT25seSByZXNlcnZlZCBkb2N1bWVudCBpZHMgbWF5IHN0YXJ0IHdpdGggdW5kZXJzY29yZS4nXG59KTtcbmV4cG9ydHMuTk9UX09QRU4gPSBuZXcgUG91Y2hFcnJvcih7XG4gIHN0YXR1czogNDEyLFxuICBlcnJvcjogJ3ByZWNvbmRpdGlvbl9mYWlsZWQnLFxuICByZWFzb246ICdEYXRhYmFzZSBub3Qgb3Blbidcbn0pO1xuZXhwb3J0cy5VTktOT1dOX0VSUk9SID0gbmV3IFBvdWNoRXJyb3Ioe1xuICBzdGF0dXM6IDUwMCxcbiAgZXJyb3I6ICd1bmtub3duX2Vycm9yJyxcbiAgcmVhc29uOiAnRGF0YWJhc2UgZW5jb3VudGVyZWQgYW4gdW5rbm93biBlcnJvcidcbn0pO1xuZXhwb3J0cy5CQURfQVJHID0gbmV3IFBvdWNoRXJyb3Ioe1xuICBzdGF0dXM6IDUwMCxcbiAgZXJyb3I6ICdiYWRhcmcnLFxuICByZWFzb246ICdTb21lIHF1ZXJ5IGFyZ3VtZW50IGlzIGludmFsaWQnXG59KTtcbmV4cG9ydHMuSU5WQUxJRF9SRVFVRVNUID0gbmV3IFBvdWNoRXJyb3Ioe1xuICBzdGF0dXM6IDQwMCxcbiAgZXJyb3I6ICdpbnZhbGlkX3JlcXVlc3QnLFxuICByZWFzb246ICdSZXF1ZXN0IHdhcyBpbnZhbGlkJ1xufSk7XG5leHBvcnRzLlFVRVJZX1BBUlNFX0VSUk9SID0gbmV3IFBvdWNoRXJyb3Ioe1xuICBzdGF0dXM6IDQwMCxcbiAgZXJyb3I6ICdxdWVyeV9wYXJzZV9lcnJvcicsXG4gIHJlYXNvbjogJ1NvbWUgcXVlcnkgcGFyYW1ldGVyIGlzIGludmFsaWQnXG59KTtcbmV4cG9ydHMuRE9DX1ZBTElEQVRJT04gPSBuZXcgUG91Y2hFcnJvcih7XG4gIHN0YXR1czogNTAwLFxuICBlcnJvcjogJ2RvY192YWxpZGF0aW9uJyxcbiAgcmVhc29uOiAnQmFkIHNwZWNpYWwgZG9jdW1lbnQgbWVtYmVyJ1xufSk7XG5leHBvcnRzLkJBRF9SRVFVRVNUID0gbmV3IFBvdWNoRXJyb3Ioe1xuICBzdGF0dXM6IDQwMCxcbiAgZXJyb3I6ICdiYWRfcmVxdWVzdCcsXG4gIHJlYXNvbjogJ1NvbWV0aGluZyB3cm9uZyB3aXRoIHRoZSByZXF1ZXN0J1xufSk7XG5leHBvcnRzLk5PVF9BTl9PQkpFQ1QgPSBuZXcgUG91Y2hFcnJvcih7XG4gIHN0YXR1czogNDAwLFxuICBlcnJvcjogJ2JhZF9yZXF1ZXN0JyxcbiAgcmVhc29uOiAnRG9jdW1lbnQgbXVzdCBiZSBhIEpTT04gb2JqZWN0J1xufSk7XG5leHBvcnRzLkRCX01JU1NJTkcgPSBuZXcgUG91Y2hFcnJvcih7XG4gIHN0YXR1czogNDA0LFxuICBlcnJvcjogJ25vdF9mb3VuZCcsXG4gIHJlYXNvbjogJ0RhdGFiYXNlIG5vdCBmb3VuZCdcbn0pO1xuZXhwb3J0cy5JREJfRVJST1IgPSBuZXcgUG91Y2hFcnJvcih7XG4gIHN0YXR1czogNTAwLFxuICBlcnJvcjogJ2luZGV4ZWRfZGJfd2VudF9iYWQnLFxuICByZWFzb246ICd1bmtub3duJ1xufSk7XG5leHBvcnRzLldTUV9FUlJPUiA9IG5ldyBQb3VjaEVycm9yKHtcbiAgc3RhdHVzOiA1MDAsXG4gIGVycm9yOiAnd2ViX3NxbF93ZW50X2JhZCcsXG4gIHJlYXNvbjogJ3Vua25vd24nXG59KTtcbmV4cG9ydHMuTERCX0VSUk9SID0gbmV3IFBvdWNoRXJyb3Ioe1xuICBzdGF0dXM6IDUwMCxcbiAgZXJyb3I6ICdsZXZlbERCX3dlbnRfd2VudF9iYWQnLFxuICByZWFzb246ICd1bmtub3duJ1xufSk7XG5leHBvcnRzLkZPUkJJRERFTiA9IG5ldyBQb3VjaEVycm9yKHtcbiAgc3RhdHVzOiA0MDMsXG4gIGVycm9yOiAnZm9yYmlkZGVuJyxcbiAgcmVhc29uOiAnRm9yYmlkZGVuIGJ5IGRlc2lnbiBkb2MgdmFsaWRhdGVfZG9jX3VwZGF0ZSBmdW5jdGlvbidcbn0pO1xuZXhwb3J0cy5lcnJvciA9IGZ1bmN0aW9uIChlcnJvciwgcmVhc29uLCBuYW1lKSB7XG4gIGZ1bmN0aW9uIEN1c3RvbVBvdWNoRXJyb3IobXNnKSB7XG4gICAgdGhpcy5tZXNzYWdlID0gcmVhc29uO1xuICAgIGlmIChuYW1lKSB7XG4gICAgICB0aGlzLm5hbWUgPSBuYW1lO1xuICAgIH1cbiAgfVxuICBDdXN0b21Qb3VjaEVycm9yLnByb3RvdHlwZSA9IGVycm9yO1xuICByZXR1cm4gbmV3IEN1c3RvbVBvdWNoRXJyb3IocmVhc29uKTtcbn07XG5cbn0se31dLDEyOltmdW5jdGlvbihfZGVyZXFfLG1vZHVsZSxleHBvcnRzKXtcbihmdW5jdGlvbiAocHJvY2VzcyxnbG9iYWwpe1xuJ3VzZSBzdHJpY3QnO1xuXG52YXIgY3J5cHRvID0gX2RlcmVxXygnY3J5cHRvJyk7XG52YXIgTWQ1ID0gX2RlcmVxXygnc3BhcmstbWQ1Jyk7XG52YXIgc2V0SW1tZWRpYXRlU2hpbSA9IGdsb2JhbC5zZXRJbW1lZGlhdGUgfHwgZ2xvYmFsLnNldFRpbWVvdXQ7XG5cbmZ1bmN0aW9uIHNsaWNlU2hpbShhcnJheUJ1ZmZlciwgYmVnaW4sIGVuZCkge1xuICBpZiAodHlwZW9mIGFycmF5QnVmZmVyLnNsaWNlID09PSAnZnVuY3Rpb24nKSB7XG4gICAgaWYgKCFiZWdpbikge1xuICAgICAgcmV0dXJuIGFycmF5QnVmZmVyLnNsaWNlKCk7XG4gICAgfSBlbHNlIGlmICghZW5kKSB7XG4gICAgICByZXR1cm4gYXJyYXlCdWZmZXIuc2xpY2UoYmVnaW4pO1xuICAgIH0gZWxzZSB7XG4gICAgICByZXR1cm4gYXJyYXlCdWZmZXIuc2xpY2UoYmVnaW4sIGVuZCk7XG4gICAgfVxuICB9XG4gIC8vXG4gIC8vIHNoaW0gZm9yIElFIGNvdXJ0ZXN5IG9mIGh0dHA6Ly9zdGFja292ZXJmbG93LmNvbS9hLzIxNDQwMjE3XG4gIC8vXG5cbiAgLy9JZiBgYmVnaW5gL2BlbmRgIGlzIHVuc3BlY2lmaWVkLCBDaHJvbWUgYXNzdW1lcyAwLCBzbyB3ZSBkbyB0aGUgc2FtZVxuICAvL0Nocm9tZSBhbHNvIGNvbnZlcnRzIHRoZSB2YWx1ZXMgdG8gaW50ZWdlcnMgdmlhIGZsb29yaW5nXG4gIGJlZ2luID0gTWF0aC5mbG9vcihiZWdpbiB8fCAwKTtcbiAgZW5kID0gTWF0aC5mbG9vcihlbmQgfHwgMCk7XG5cbiAgdmFyIGxlbiA9IGFycmF5QnVmZmVyLmJ5dGVMZW5ndGg7XG5cbiAgLy9JZiBlaXRoZXIgYGJlZ2luYCBvciBgZW5kYCBpcyBuZWdhdGl2ZSwgaXQgcmVmZXJzIHRvIGFuXG4gIC8vaW5kZXggZnJvbSB0aGUgZW5kIG9mIHRoZSBhcnJheSwgYXMgb3Bwb3NlZCB0byBmcm9tIHRoZSBiZWdpbm5pbmcuXG4gIC8vVGhlIHJhbmdlIHNwZWNpZmllZCBieSB0aGUgYGJlZ2luYCBhbmQgYGVuZGAgdmFsdWVzIGlzIGNsYW1wZWQgdG8gdGhlXG4gIC8vdmFsaWQgaW5kZXggcmFuZ2UgZm9yIHRoZSBjdXJyZW50IGFycmF5LlxuICBiZWdpbiA9IGJlZ2luIDwgMCA/IE1hdGgubWF4KGJlZ2luICsgbGVuLCAwKSA6IE1hdGgubWluKGxlbiwgYmVnaW4pO1xuICBlbmQgPSBlbmQgPCAwID8gTWF0aC5tYXgoZW5kICsgbGVuLCAwKSA6IE1hdGgubWluKGxlbiwgZW5kKTtcblxuICAvL0lmIHRoZSBjb21wdXRlZCBsZW5ndGggb2YgdGhlIG5ldyBBcnJheUJ1ZmZlciB3b3VsZCBiZSBuZWdhdGl2ZSwgaXRcbiAgLy9pcyBjbGFtcGVkIHRvIHplcm8uXG4gIGlmIChlbmQgLSBiZWdpbiA8PSAwKSB7XG4gICAgcmV0dXJuIG5ldyBBcnJheUJ1ZmZlcigwKTtcbiAgfVxuXG4gIHZhciByZXN1bHQgPSBuZXcgQXJyYXlCdWZmZXIoZW5kIC0gYmVnaW4pO1xuICB2YXIgcmVzdWx0Qnl0ZXMgPSBuZXcgVWludDhBcnJheShyZXN1bHQpO1xuICB2YXIgc291cmNlQnl0ZXMgPSBuZXcgVWludDhBcnJheShhcnJheUJ1ZmZlciwgYmVnaW4sIGVuZCAtIGJlZ2luKTtcblxuICByZXN1bHRCeXRlcy5zZXQoc291cmNlQnl0ZXMpO1xuXG4gIHJldHVybiByZXN1bHQ7XG59XG5cbi8vIGNvbnZlcnQgYSA2NC1iaXQgaW50IHRvIGEgYmluYXJ5IHN0cmluZ1xuZnVuY3Rpb24gaW50VG9TdHJpbmcoaW50KSB7XG4gIHZhciBieXRlcyA9IFtcbiAgICAoaW50ICYgMHhmZiksXG4gICAgKChpbnQgPj4+IDgpICYgMHhmZiksXG4gICAgKChpbnQgPj4+IDE2KSAmIDB4ZmYpLFxuICAgICgoaW50ID4+PiAyNCkgJiAweGZmKVxuICBdO1xuICByZXR1cm4gYnl0ZXMubWFwKGZ1bmN0aW9uIChieXRlKSB7XG4gICAgcmV0dXJuIFN0cmluZy5mcm9tQ2hhckNvZGUoYnl0ZSk7XG4gIH0pLmpvaW4oJycpO1xufVxuXG4vLyBjb252ZXJ0IGFuIGFycmF5IG9mIDY0LWJpdCBpbnRzIGludG9cbi8vIGEgYmFzZTY0LWVuY29kZWQgc3RyaW5nXG5mdW5jdGlvbiByYXdUb0Jhc2U2NChyYXcpIHtcbiAgdmFyIHJlcyA9ICcnO1xuICBmb3IgKHZhciBpID0gMDsgaSA8IHJhdy5sZW5ndGg7IGkrKykge1xuICAgIHJlcyArPSBpbnRUb1N0cmluZyhyYXdbaV0pO1xuICB9XG4gIHJldHVybiBnbG9iYWwuYnRvYShyZXMpO1xufVxuXG5tb2R1bGUuZXhwb3J0cyA9IGZ1bmN0aW9uIChkYXRhLCBjYWxsYmFjaykge1xuICBpZiAoIXByb2Nlc3MuYnJvd3Nlcikge1xuICAgIHZhciBiYXNlNjQgPSBjcnlwdG8uY3JlYXRlSGFzaCgnbWQ1JykudXBkYXRlKGRhdGEpLmRpZ2VzdCgnYmFzZTY0Jyk7XG4gICAgY2FsbGJhY2sobnVsbCwgYmFzZTY0KTtcbiAgICByZXR1cm47XG4gIH1cbiAgdmFyIGlucHV0SXNTdHJpbmcgPSB0eXBlb2YgZGF0YSA9PT0gJ3N0cmluZyc7XG4gIHZhciBsZW4gPSBpbnB1dElzU3RyaW5nID8gZGF0YS5sZW5ndGggOiBkYXRhLmJ5dGVMZW5ndGg7XG4gIHZhciBjaHVua1NpemUgPSBNYXRoLm1pbig1MjQyODgsIGxlbik7XG4gIHZhciBjaHVua3MgPSBNYXRoLmNlaWwobGVuIC8gY2h1bmtTaXplKTtcbiAgdmFyIGN1cnJlbnRDaHVuayA9IDA7XG4gIHZhciBidWZmZXIgPSBpbnB1dElzU3RyaW5nID8gbmV3IE1kNSgpIDogbmV3IE1kNS5BcnJheUJ1ZmZlcigpO1xuXG4gIGZ1bmN0aW9uIGFwcGVuZChidWZmZXIsIGRhdGEsIHN0YXJ0LCBlbmQpIHtcbiAgICBpZiAoaW5wdXRJc1N0cmluZykge1xuICAgICAgYnVmZmVyLmFwcGVuZEJpbmFyeShkYXRhLnN1YnN0cmluZyhzdGFydCwgZW5kKSk7XG4gICAgfSBlbHNlIHtcbiAgICAgIGJ1ZmZlci5hcHBlbmQoc2xpY2VTaGltKGRhdGEsIHN0YXJ0LCBlbmQpKTtcbiAgICB9XG4gIH1cblxuICBmdW5jdGlvbiBsb2FkTmV4dENodW5rKCkge1xuICAgIHZhciBzdGFydCA9IGN1cnJlbnRDaHVuayAqIGNodW5rU2l6ZTtcbiAgICB2YXIgZW5kID0gc3RhcnQgKyBjaHVua1NpemU7XG4gICAgaWYgKChzdGFydCArIGNodW5rU2l6ZSkgPj0gZGF0YS5zaXplKSB7XG4gICAgICBlbmQgPSBkYXRhLnNpemU7XG4gICAgfVxuICAgIGN1cnJlbnRDaHVuaysrO1xuICAgIGlmIChjdXJyZW50Q2h1bmsgPCBjaHVua3MpIHtcbiAgICAgIGFwcGVuZChidWZmZXIsIGRhdGEsIHN0YXJ0LCBlbmQpO1xuICAgICAgc2V0SW1tZWRpYXRlU2hpbShsb2FkTmV4dENodW5rKTtcbiAgICB9IGVsc2Uge1xuICAgICAgYXBwZW5kKGJ1ZmZlciwgZGF0YSwgc3RhcnQsIGVuZCk7XG4gICAgICB2YXIgcmF3ID0gYnVmZmVyLmVuZCh0cnVlKTtcbiAgICAgIHZhciBiYXNlNjQgPSByYXdUb0Jhc2U2NChyYXcpO1xuICAgICAgY2FsbGJhY2sobnVsbCwgYmFzZTY0KTtcbiAgICAgIGJ1ZmZlci5kZXN0cm95KCk7XG4gICAgfVxuICB9XG4gIGxvYWROZXh0Q2h1bmsoKTtcbn07XG5cbn0pLmNhbGwodGhpcyxfZGVyZXFfKFwiL1VzZXJzL25vbGFuL3dvcmtzcGFjZS9wb3VjaGRiL25vZGVfbW9kdWxlcy9icm93c2VyaWZ5L25vZGVfbW9kdWxlcy9pbnNlcnQtbW9kdWxlLWdsb2JhbHMvbm9kZV9tb2R1bGVzL3Byb2Nlc3MvYnJvd3Nlci5qc1wiKSx0eXBlb2Ygc2VsZiAhPT0gXCJ1bmRlZmluZWRcIiA/IHNlbGYgOiB0eXBlb2Ygd2luZG93ICE9PSBcInVuZGVmaW5lZFwiID8gd2luZG93IDoge30pXG59LHtcIi9Vc2Vycy9ub2xhbi93b3Jrc3BhY2UvcG91Y2hkYi9ub2RlX21vZHVsZXMvYnJvd3NlcmlmeS9ub2RlX21vZHVsZXMvaW5zZXJ0LW1vZHVsZS1nbG9iYWxzL25vZGVfbW9kdWxlcy9wcm9jZXNzL2Jyb3dzZXIuanNcIjoyOCxcImNyeXB0b1wiOjI2LFwic3BhcmstbWQ1XCI6NTd9XSwxMzpbZnVuY3Rpb24oX2RlcmVxXyxtb2R1bGUsZXhwb3J0cyl7XG4ndXNlIHN0cmljdCc7XG52YXIgUHJvbWlzZSA9IF9kZXJlcV8oJy4uL3V0aWxzJykuUHJvbWlzZTtcblxuLy8gdGhpcyBpcyBlc3NlbnRpYWxseSB0aGUgXCJ1cGRhdGUgc3VnYXJcIiBmdW5jdGlvbiBmcm9tIGRhbGVoYXJ2ZXkvcG91Y2hkYiMxMzg4XG4vLyB0aGUgZGlmZkZ1biB0ZWxscyB1cyB3aGF0IGRlbHRhIHRvIGFwcGx5IHRvIHRoZSBkb2MuICBpdCBlaXRoZXIgcmV0dXJuc1xuLy8gdGhlIGRvYywgb3IgZmFsc2UgaWYgaXQgZG9lc24ndCBuZWVkIHRvIGRvIGFuIHVwZGF0ZSBhZnRlciBhbGxcbmZ1bmN0aW9uIHVwc2VydChkYiwgZG9jSWQsIGRpZmZGdW4pIHtcbiAgcmV0dXJuIG5ldyBQcm9taXNlKGZ1bmN0aW9uIChmdWxmaWxsLCByZWplY3QpIHtcbiAgICBpZiAoZG9jSWQgJiYgdHlwZW9mIGRvY0lkID09PSAnb2JqZWN0Jykge1xuICAgICAgZG9jSWQgPSBkb2NJZC5faWQ7XG4gICAgfVxuICAgIGlmICh0eXBlb2YgZG9jSWQgIT09ICdzdHJpbmcnKSB7XG4gICAgICByZXR1cm4gcmVqZWN0KG5ldyBFcnJvcignZG9jIGlkIGlzIHJlcXVpcmVkJykpO1xuICAgIH1cblxuICAgIGRiLmdldChkb2NJZCwgZnVuY3Rpb24gKGVyciwgZG9jKSB7XG4gICAgICBpZiAoZXJyKSB7XG4gICAgICAgIGlmIChlcnIuc3RhdHVzICE9PSA0MDQpIHtcbiAgICAgICAgICByZXR1cm4gcmVqZWN0KGVycik7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIGZ1bGZpbGwodHJ5QW5kUHV0KGRiLCBkaWZmRnVuKHtfaWQgOiBkb2NJZH0pLCBkaWZmRnVuKSk7XG4gICAgICB9XG4gICAgICB2YXIgbmV3RG9jID0gZGlmZkZ1bihkb2MpO1xuICAgICAgaWYgKCFuZXdEb2MpIHtcbiAgICAgICAgcmV0dXJuIGZ1bGZpbGwoZG9jKTtcbiAgICAgIH1cbiAgICAgIGZ1bGZpbGwodHJ5QW5kUHV0KGRiLCBuZXdEb2MsIGRpZmZGdW4pKTtcbiAgICB9KTtcbiAgfSk7XG59XG5cbmZ1bmN0aW9uIHRyeUFuZFB1dChkYiwgZG9jLCBkaWZmRnVuKSB7XG4gIHJldHVybiBkYi5wdXQoZG9jKVtcImNhdGNoXCJdKGZ1bmN0aW9uIChlcnIpIHtcbiAgICBpZiAoZXJyLnN0YXR1cyAhPT0gNDA5KSB7XG4gICAgICB0aHJvdyBlcnI7XG4gICAgfVxuICAgIHJldHVybiB1cHNlcnQoZGIsIGRvYywgZGlmZkZ1bik7XG4gIH0pO1xufVxuXG5tb2R1bGUuZXhwb3J0cyA9IGZ1bmN0aW9uIChkYiwgZG9jSWQsIGRpZmZGdW4sIGNiKSB7XG4gIGlmICh0eXBlb2YgY2IgPT09ICdmdW5jdGlvbicpIHtcbiAgICB1cHNlcnQoZGIsIGRvY0lkLCBkaWZmRnVuKS50aGVuKGZ1bmN0aW9uIChyZXNwKSB7XG4gICAgICBjYihudWxsLCByZXNwKTtcbiAgICB9LCBjYik7XG4gIH0gZWxzZSB7XG4gICAgcmV0dXJuIHVwc2VydChkYiwgZG9jSWQsIGRpZmZGdW4pO1xuICB9XG59O1xuXG59LHtcIi4uL3V0aWxzXCI6MjN9XSwxNDpbZnVuY3Rpb24oX2RlcmVxXyxtb2R1bGUsZXhwb3J0cyl7XG5cInVzZSBzdHJpY3RcIjtcblxuLy8gQkVHSU4gTWF0aC51dWlkLmpzXG5cbi8qIVxuTWF0aC51dWlkLmpzICh2MS40KVxuaHR0cDovL3d3dy5icm9vZmEuY29tXG5tYWlsdG86cm9iZXJ0QGJyb29mYS5jb21cblxuQ29weXJpZ2h0IChjKSAyMDEwIFJvYmVydCBLaWVmZmVyXG5EdWFsIGxpY2Vuc2VkIHVuZGVyIHRoZSBNSVQgYW5kIEdQTCBsaWNlbnNlcy5cbiovXG5cbi8qXG4gKiBHZW5lcmF0ZSBhIHJhbmRvbSB1dWlkLlxuICpcbiAqIFVTQUdFOiBNYXRoLnV1aWQobGVuZ3RoLCByYWRpeClcbiAqICAgbGVuZ3RoIC0gdGhlIGRlc2lyZWQgbnVtYmVyIG9mIGNoYXJhY3RlcnNcbiAqICAgcmFkaXggIC0gdGhlIG51bWJlciBvZiBhbGxvd2FibGUgdmFsdWVzIGZvciBlYWNoIGNoYXJhY3Rlci5cbiAqXG4gKiBFWEFNUExFUzpcbiAqICAgLy8gTm8gYXJndW1lbnRzICAtIHJldHVybnMgUkZDNDEyMiwgdmVyc2lvbiA0IElEXG4gKiAgID4+PiBNYXRoLnV1aWQoKVxuICogICBcIjkyMzI5RDM5LTZGNUMtNDUyMC1BQkZDLUFBQjY0NTQ0RTE3MlwiXG4gKlxuICogICAvLyBPbmUgYXJndW1lbnQgLSByZXR1cm5zIElEIG9mIHRoZSBzcGVjaWZpZWQgbGVuZ3RoXG4gKiAgID4+PiBNYXRoLnV1aWQoMTUpICAgICAvLyAxNSBjaGFyYWN0ZXIgSUQgKGRlZmF1bHQgYmFzZT02MilcbiAqICAgXCJWY3lkeGdsdHhyVlpTVFZcIlxuICpcbiAqICAgLy8gVHdvIGFyZ3VtZW50cyAtIHJldHVybnMgSUQgb2YgdGhlIHNwZWNpZmllZCBsZW5ndGgsIGFuZCByYWRpeC4gXG4gKiAgIC8vIChSYWRpeCBtdXN0IGJlIDw9IDYyKVxuICogICA+Pj4gTWF0aC51dWlkKDgsIDIpICAvLyA4IGNoYXJhY3RlciBJRCAoYmFzZT0yKVxuICogICBcIjAxMDAxMDEwXCJcbiAqICAgPj4+IE1hdGgudXVpZCg4LCAxMCkgLy8gOCBjaGFyYWN0ZXIgSUQgKGJhc2U9MTApXG4gKiAgIFwiNDc0NzMwNDZcIlxuICogICA+Pj4gTWF0aC51dWlkKDgsIDE2KSAvLyA4IGNoYXJhY3RlciBJRCAoYmFzZT0xNilcbiAqICAgXCIwOThGNEQzNVwiXG4gKi9cbnZhciBjaGFycyA9IChcbiAgJzAxMjM0NTY3ODlBQkNERUZHSElKS0xNTk9QUVJTVFVWV1hZWicgK1xuICAnYWJjZGVmZ2hpamtsbW5vcHFyc3R1dnd4eXonXG4pLnNwbGl0KCcnKTtcbmZ1bmN0aW9uIGdldFZhbHVlKHJhZGl4KSB7XG4gIHJldHVybiAwIHwgTWF0aC5yYW5kb20oKSAqIHJhZGl4O1xufVxuZnVuY3Rpb24gdXVpZChsZW4sIHJhZGl4KSB7XG4gIHJhZGl4ID0gcmFkaXggfHwgY2hhcnMubGVuZ3RoO1xuICB2YXIgb3V0ID0gJyc7XG4gIHZhciBpID0gLTE7XG5cbiAgaWYgKGxlbikge1xuICAgIC8vIENvbXBhY3QgZm9ybVxuICAgIHdoaWxlICgrK2kgPCBsZW4pIHtcbiAgICAgIG91dCArPSBjaGFyc1tnZXRWYWx1ZShyYWRpeCldO1xuICAgIH1cbiAgICByZXR1cm4gb3V0O1xuICB9XG4gICAgLy8gcmZjNDEyMiwgdmVyc2lvbiA0IGZvcm1cbiAgICAvLyBGaWxsIGluIHJhbmRvbSBkYXRhLiAgQXQgaT09MTkgc2V0IHRoZSBoaWdoIGJpdHMgb2YgY2xvY2sgc2VxdWVuY2UgYXNcbiAgICAvLyBwZXIgcmZjNDEyMiwgc2VjLiA0LjEuNVxuICB3aGlsZSAoKytpIDwgMzYpIHtcbiAgICBzd2l0Y2ggKGkpIHtcbiAgICAgIGNhc2UgODpcbiAgICAgIGNhc2UgMTM6XG4gICAgICBjYXNlIDE4OlxuICAgICAgY2FzZSAyMzpcbiAgICAgICAgb3V0ICs9ICctJztcbiAgICAgICAgYnJlYWs7XG4gICAgICBjYXNlIDE5OlxuICAgICAgICBvdXQgKz0gY2hhcnNbKGdldFZhbHVlKDE2KSAmIDB4MykgfCAweDhdO1xuICAgICAgICBicmVhaztcbiAgICAgIGRlZmF1bHQ6XG4gICAgICAgIG91dCArPSBjaGFyc1tnZXRWYWx1ZSgxNildO1xuICAgIH1cbiAgfVxuXG4gIHJldHVybiBvdXQ7XG59XG5cblxuXG5tb2R1bGUuZXhwb3J0cyA9IHV1aWQ7XG5cblxufSx7fV0sMTU6W2Z1bmN0aW9uKF9kZXJlcV8sbW9kdWxlLGV4cG9ydHMpe1xuJ3VzZSBzdHJpY3QnO1xuXG5tb2R1bGUuZXhwb3J0cyA9IGV2YWxGaWx0ZXI7XG5mdW5jdGlvbiBldmFsRmlsdGVyKGlucHV0KSB7XG4gIC8qanNoaW50IGV2aWw6IHRydWUgKi9cbiAgcmV0dXJuIGV2YWwoW1xuICAgICcoZnVuY3Rpb24gKCkgeyByZXR1cm4gJyxcbiAgICBpbnB1dCxcbiAgICAnIH0pKCknXG4gIF0uam9pbignJykpO1xufVxufSx7fV0sMTY6W2Z1bmN0aW9uKF9kZXJlcV8sbW9kdWxlLGV4cG9ydHMpe1xuJ3VzZSBzdHJpY3QnO1xuXG5tb2R1bGUuZXhwb3J0cyA9IGV2YWxWaWV3O1xuZnVuY3Rpb24gZXZhbFZpZXcoaW5wdXQpIHtcbiAgLypqc2hpbnQgZXZpbDogdHJ1ZSAqL1xuICByZXR1cm4gZXZhbChbXG4gICAgJyhmdW5jdGlvbiAoKSB7JyxcbiAgICAnICByZXR1cm4gZnVuY3Rpb24gKGRvYykgeycsXG4gICAgJyAgICB2YXIgZW1pdHRlZCA9IGZhbHNlOycsXG4gICAgJyAgICB2YXIgZW1pdCA9IGZ1bmN0aW9uIChhLCBiKSB7JyxcbiAgICAnICAgICAgZW1pdHRlZCA9IHRydWU7JyxcbiAgICAnICAgIH07JyxcbiAgICAnICAgIHZhciB2aWV3ID0gJyArIGlucHV0ICsgJzsnLFxuICAgICcgICAgdmlldyhkb2MpOycsXG4gICAgJyAgICBpZiAoZW1pdHRlZCkgeycsXG4gICAgJyAgICAgIHJldHVybiB0cnVlOycsXG4gICAgJyAgICB9JyxcbiAgICAnICB9JyxcbiAgICAnfSkoKSdcbiAgXS5qb2luKCdcXG4nKSk7XG59XG59LHt9XSwxNzpbZnVuY3Rpb24oX2RlcmVxXyxtb2R1bGUsZXhwb3J0cyl7XG4oZnVuY3Rpb24gKHByb2Nlc3Mpe1xuXCJ1c2Ugc3RyaWN0XCI7XG5cbnZhciBQb3VjaERCID0gX2RlcmVxXygnLi9zZXR1cCcpO1xuXG5tb2R1bGUuZXhwb3J0cyA9IFBvdWNoREI7XG5cblBvdWNoREIuYWpheCA9IF9kZXJlcV8oJy4vZGVwcy9hamF4Jyk7XG5Qb3VjaERCLmV4dGVuZCA9IF9kZXJlcV8oJ3BvdWNoZGItZXh0ZW5kJyk7XG5Qb3VjaERCLnV0aWxzID0gX2RlcmVxXygnLi91dGlscycpO1xuUG91Y2hEQi5FcnJvcnMgPSBfZGVyZXFfKCcuL2RlcHMvZXJyb3JzJyk7XG5Qb3VjaERCLnJlcGxpY2F0ZSA9IF9kZXJlcV8oJy4vcmVwbGljYXRlJykucmVwbGljYXRlO1xuUG91Y2hEQi5zeW5jID0gX2RlcmVxXygnLi9zeW5jJyk7XG5Qb3VjaERCLnZlcnNpb24gPSBfZGVyZXFfKCcuL3ZlcnNpb24nKTtcbnZhciBodHRwQWRhcHRlciA9IF9kZXJlcV8oJy4vYWRhcHRlcnMvaHR0cCcpO1xuUG91Y2hEQi5hZGFwdGVyKCdodHRwJywgaHR0cEFkYXB0ZXIpO1xuUG91Y2hEQi5hZGFwdGVyKCdodHRwcycsIGh0dHBBZGFwdGVyKTtcblxuUG91Y2hEQi5hZGFwdGVyKCdpZGInLCBfZGVyZXFfKCcuL2FkYXB0ZXJzL2lkYicpKTtcblBvdWNoREIuYWRhcHRlcignd2Vic3FsJywgX2RlcmVxXygnLi9hZGFwdGVycy93ZWJzcWwnKSk7XG5Qb3VjaERCLnBsdWdpbihfZGVyZXFfKCdwb3VjaGRiLW1hcHJlZHVjZScpKTtcblxuaWYgKCFwcm9jZXNzLmJyb3dzZXIpIHtcbiAgdmFyIGxkYkFkYXB0ZXIgPSBfZGVyZXFfKCcuL2FkYXB0ZXJzL2xldmVsZGInKTtcbiAgUG91Y2hEQi5hZGFwdGVyKCdsZGInLCBsZGJBZGFwdGVyKTtcbiAgUG91Y2hEQi5hZGFwdGVyKCdsZXZlbGRiJywgbGRiQWRhcHRlcik7XG59XG5cbn0pLmNhbGwodGhpcyxfZGVyZXFfKFwiL1VzZXJzL25vbGFuL3dvcmtzcGFjZS9wb3VjaGRiL25vZGVfbW9kdWxlcy9icm93c2VyaWZ5L25vZGVfbW9kdWxlcy9pbnNlcnQtbW9kdWxlLWdsb2JhbHMvbm9kZV9tb2R1bGVzL3Byb2Nlc3MvYnJvd3Nlci5qc1wiKSlcbn0se1wiLi9hZGFwdGVycy9odHRwXCI6MixcIi4vYWRhcHRlcnMvaWRiXCI6MyxcIi4vYWRhcHRlcnMvbGV2ZWxkYlwiOjI2LFwiLi9hZGFwdGVycy93ZWJzcWxcIjo1LFwiLi9kZXBzL2FqYXhcIjo4LFwiLi9kZXBzL2Vycm9yc1wiOjExLFwiLi9yZXBsaWNhdGVcIjoxOSxcIi4vc2V0dXBcIjoyMCxcIi4vc3luY1wiOjIxLFwiLi91dGlsc1wiOjIzLFwiLi92ZXJzaW9uXCI6MjQsXCIvVXNlcnMvbm9sYW4vd29ya3NwYWNlL3BvdWNoZGIvbm9kZV9tb2R1bGVzL2Jyb3dzZXJpZnkvbm9kZV9tb2R1bGVzL2luc2VydC1tb2R1bGUtZ2xvYmFscy9ub2RlX21vZHVsZXMvcHJvY2Vzcy9icm93c2VyLmpzXCI6MjgsXCJwb3VjaGRiLWV4dGVuZFwiOjQ4LFwicG91Y2hkYi1tYXByZWR1Y2VcIjo1MX1dLDE4OltmdW5jdGlvbihfZGVyZXFfLG1vZHVsZSxleHBvcnRzKXtcbid1c2Ugc3RyaWN0JztcbnZhciBleHRlbmQgPSBfZGVyZXFfKCdwb3VjaGRiLWV4dGVuZCcpO1xuXG5cbi8vIGZvciBhIGJldHRlciBvdmVydmlldyBvZiB3aGF0IHRoaXMgaXMgZG9pbmcsIHJlYWQ6XG4vLyBodHRwczovL2dpdGh1Yi5jb20vYXBhY2hlL2NvdWNoZGIvYmxvYi9tYXN0ZXIvc3JjL2NvdWNoZGIvY291Y2hfa2V5X3RyZWUuZXJsXG4vL1xuLy8gQnV0IGZvciBhIHF1aWNrIGludHJvLCBDb3VjaERCIHVzZXMgYSByZXZpc2lvbiB0cmVlIHRvIHN0b3JlIGEgZG9jdW1lbnRzXG4vLyBoaXN0b3J5LCBBIC0+IEIgLT4gQywgd2hlbiBhIGRvY3VtZW50IGhhcyBjb25mbGljdHMsIHRoYXQgaXMgYSBicmFuY2ggaW4gdGhlXG4vLyB0cmVlLCBBIC0+IChCMSB8IEIyIC0+IEMpLCBXZSBzdG9yZSB0aGVzZSBhcyBhIG5lc3RlZCBhcnJheSBpbiB0aGUgZm9ybWF0XG4vL1xuLy8gS2V5VHJlZSA9IFtQYXRoIC4uLiBdXG4vLyBQYXRoID0ge3BvczogcG9zaXRpb25fZnJvbV9yb290LCBpZHM6IFRyZWV9XG4vLyBUcmVlID0gW0tleSwgT3B0cywgW1RyZWUsIC4uLl1dLCBpbiBwYXJ0aWN1bGFyIHNpbmdsZSBub2RlOiBbS2V5LCBbXV1cblxuLy8gVHVybiBhIHBhdGggYXMgYSBmbGF0IGFycmF5IGludG8gYSB0cmVlIHdpdGggYSBzaW5nbGUgYnJhbmNoXG5mdW5jdGlvbiBwYXRoVG9UcmVlKHBhdGgpIHtcbiAgdmFyIGRvYyA9IHBhdGguc2hpZnQoKTtcbiAgdmFyIHJvb3QgPSBbZG9jLmlkLCBkb2Mub3B0cywgW11dO1xuICB2YXIgbGVhZiA9IHJvb3Q7XG4gIHZhciBubGVhZjtcblxuICB3aGlsZSAocGF0aC5sZW5ndGgpIHtcbiAgICBkb2MgPSBwYXRoLnNoaWZ0KCk7XG4gICAgbmxlYWYgPSBbZG9jLmlkLCBkb2Mub3B0cywgW11dO1xuICAgIGxlYWZbMl0ucHVzaChubGVhZik7XG4gICAgbGVhZiA9IG5sZWFmO1xuICB9XG4gIHJldHVybiByb290O1xufVxuXG4vLyBNZXJnZSB0d28gdHJlZXMgdG9nZXRoZXJcbi8vIFRoZSByb290cyBvZiB0cmVlMSBhbmQgdHJlZTIgbXVzdCBiZSB0aGUgc2FtZSByZXZpc2lvblxuZnVuY3Rpb24gbWVyZ2VUcmVlKGluX3RyZWUxLCBpbl90cmVlMikge1xuICB2YXIgcXVldWUgPSBbe3RyZWUxOiBpbl90cmVlMSwgdHJlZTI6IGluX3RyZWUyfV07XG4gIHZhciBjb25mbGljdHMgPSBmYWxzZTtcbiAgd2hpbGUgKHF1ZXVlLmxlbmd0aCA+IDApIHtcbiAgICB2YXIgaXRlbSA9IHF1ZXVlLnBvcCgpO1xuICAgIHZhciB0cmVlMSA9IGl0ZW0udHJlZTE7XG4gICAgdmFyIHRyZWUyID0gaXRlbS50cmVlMjtcblxuICAgIGlmICh0cmVlMVsxXS5zdGF0dXMgfHwgdHJlZTJbMV0uc3RhdHVzKSB7XG4gICAgICB0cmVlMVsxXS5zdGF0dXMgPVxuICAgICAgICAodHJlZTFbMV0uc3RhdHVzID09PSAgJ2F2YWlsYWJsZScgfHxcbiAgICAgICAgIHRyZWUyWzFdLnN0YXR1cyA9PT0gJ2F2YWlsYWJsZScpID8gJ2F2YWlsYWJsZScgOiAnbWlzc2luZyc7XG4gICAgfVxuXG4gICAgZm9yICh2YXIgaSA9IDA7IGkgPCB0cmVlMlsyXS5sZW5ndGg7IGkrKykge1xuICAgICAgaWYgKCF0cmVlMVsyXVswXSkge1xuICAgICAgICBjb25mbGljdHMgPSAnbmV3X2xlYWYnO1xuICAgICAgICB0cmVlMVsyXVswXSA9IHRyZWUyWzJdW2ldO1xuICAgICAgICBjb250aW51ZTtcbiAgICAgIH1cblxuICAgICAgdmFyIG1lcmdlZCA9IGZhbHNlO1xuICAgICAgZm9yICh2YXIgaiA9IDA7IGogPCB0cmVlMVsyXS5sZW5ndGg7IGorKykge1xuICAgICAgICBpZiAodHJlZTFbMl1bal1bMF0gPT09IHRyZWUyWzJdW2ldWzBdKSB7XG4gICAgICAgICAgcXVldWUucHVzaCh7dHJlZTE6IHRyZWUxWzJdW2pdLCB0cmVlMjogdHJlZTJbMl1baV19KTtcbiAgICAgICAgICBtZXJnZWQgPSB0cnVlO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgICBpZiAoIW1lcmdlZCkge1xuICAgICAgICBjb25mbGljdHMgPSAnbmV3X2JyYW5jaCc7XG4gICAgICAgIHRyZWUxWzJdLnB1c2godHJlZTJbMl1baV0pO1xuICAgICAgICB0cmVlMVsyXS5zb3J0KCk7XG4gICAgICB9XG4gICAgfVxuICB9XG4gIHJldHVybiB7Y29uZmxpY3RzOiBjb25mbGljdHMsIHRyZWU6IGluX3RyZWUxfTtcbn1cblxuZnVuY3Rpb24gZG9NZXJnZSh0cmVlLCBwYXRoLCBkb250RXhwYW5kKSB7XG4gIHZhciByZXN0cmVlID0gW107XG4gIHZhciBjb25mbGljdHMgPSBmYWxzZTtcbiAgdmFyIG1lcmdlZCA9IGZhbHNlO1xuICB2YXIgcmVzO1xuXG4gIGlmICghdHJlZS5sZW5ndGgpIHtcbiAgICByZXR1cm4ge3RyZWU6IFtwYXRoXSwgY29uZmxpY3RzOiAnbmV3X2xlYWYnfTtcbiAgfVxuXG4gIHRyZWUuZm9yRWFjaChmdW5jdGlvbiAoYnJhbmNoKSB7XG4gICAgaWYgKGJyYW5jaC5wb3MgPT09IHBhdGgucG9zICYmIGJyYW5jaC5pZHNbMF0gPT09IHBhdGguaWRzWzBdKSB7XG4gICAgICAvLyBQYXRocyBzdGFydCBhdCB0aGUgc2FtZSBwb3NpdGlvbiBhbmQgaGF2ZSB0aGUgc2FtZSByb290LCBzbyB0aGV5IG5lZWRcbiAgICAgIC8vIG1lcmdlZFxuICAgICAgcmVzID0gbWVyZ2VUcmVlKGJyYW5jaC5pZHMsIHBhdGguaWRzKTtcbiAgICAgIHJlc3RyZWUucHVzaCh7cG9zOiBicmFuY2gucG9zLCBpZHM6IHJlcy50cmVlfSk7XG4gICAgICBjb25mbGljdHMgPSBjb25mbGljdHMgfHwgcmVzLmNvbmZsaWN0cztcbiAgICAgIG1lcmdlZCA9IHRydWU7XG4gICAgfSBlbHNlIGlmIChkb250RXhwYW5kICE9PSB0cnVlKSB7XG4gICAgICAvLyBUaGUgcGF0aHMgc3RhcnQgYXQgYSBkaWZmZXJlbnQgcG9zaXRpb24sIHRha2UgdGhlIGVhcmxpZXN0IHBhdGggYW5kXG4gICAgICAvLyB0cmF2ZXJzZSB1cCB1bnRpbCBpdCBhcyBhdCB0aGUgc2FtZSBwb2ludCBmcm9tIHJvb3QgYXMgdGhlIHBhdGggd2VcbiAgICAgIC8vIHdhbnQgdG8gbWVyZ2UuICBJZiB0aGUga2V5cyBtYXRjaCB3ZSByZXR1cm4gdGhlIGxvbmdlciBwYXRoIHdpdGggdGhlXG4gICAgICAvLyBvdGhlciBtZXJnZWQgQWZ0ZXIgc3RlbW1pbmcgd2UgZG9udCB3YW50IHRvIGV4cGFuZCB0aGUgdHJlZXNcblxuICAgICAgdmFyIHQxID0gYnJhbmNoLnBvcyA8IHBhdGgucG9zID8gYnJhbmNoIDogcGF0aDtcbiAgICAgIHZhciB0MiA9IGJyYW5jaC5wb3MgPCBwYXRoLnBvcyA/IHBhdGggOiBicmFuY2g7XG4gICAgICB2YXIgZGlmZiA9IHQyLnBvcyAtIHQxLnBvcztcblxuICAgICAgdmFyIGNhbmRpZGF0ZVBhcmVudHMgPSBbXTtcblxuICAgICAgdmFyIHRyZWVzID0gW107XG4gICAgICB0cmVlcy5wdXNoKHtpZHM6IHQxLmlkcywgZGlmZjogZGlmZiwgcGFyZW50OiBudWxsLCBwYXJlbnRJZHg6IG51bGx9KTtcbiAgICAgIHdoaWxlICh0cmVlcy5sZW5ndGggPiAwKSB7XG4gICAgICAgIHZhciBpdGVtID0gdHJlZXMucG9wKCk7XG4gICAgICAgIGlmIChpdGVtLmRpZmYgPT09IDApIHtcbiAgICAgICAgICBpZiAoaXRlbS5pZHNbMF0gPT09IHQyLmlkc1swXSkge1xuICAgICAgICAgICAgY2FuZGlkYXRlUGFyZW50cy5wdXNoKGl0ZW0pO1xuICAgICAgICAgIH1cbiAgICAgICAgICBjb250aW51ZTtcbiAgICAgICAgfVxuICAgICAgICBpZiAoIWl0ZW0uaWRzKSB7XG4gICAgICAgICAgY29udGludWU7XG4gICAgICAgIH1cbiAgICAgICAgLypqc2hpbnQgbG9vcGZ1bmM6dHJ1ZSAqL1xuICAgICAgICBpdGVtLmlkc1syXS5mb3JFYWNoKGZ1bmN0aW9uIChlbCwgaWR4KSB7XG4gICAgICAgICAgdHJlZXMucHVzaChcbiAgICAgICAgICAgIHtpZHM6IGVsLCBkaWZmOiBpdGVtLmRpZmYgLSAxLCBwYXJlbnQ6IGl0ZW0uaWRzLCBwYXJlbnRJZHg6IGlkeH0pO1xuICAgICAgICB9KTtcbiAgICAgIH1cblxuICAgICAgdmFyIGVsID0gY2FuZGlkYXRlUGFyZW50c1swXTtcblxuICAgICAgaWYgKCFlbCkge1xuICAgICAgICByZXN0cmVlLnB1c2goYnJhbmNoKTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIHJlcyA9IG1lcmdlVHJlZShlbC5pZHMsIHQyLmlkcyk7XG4gICAgICAgIGVsLnBhcmVudFsyXVtlbC5wYXJlbnRJZHhdID0gcmVzLnRyZWU7XG4gICAgICAgIHJlc3RyZWUucHVzaCh7cG9zOiB0MS5wb3MsIGlkczogdDEuaWRzfSk7XG4gICAgICAgIGNvbmZsaWN0cyA9IGNvbmZsaWN0cyB8fCByZXMuY29uZmxpY3RzO1xuICAgICAgICBtZXJnZWQgPSB0cnVlO1xuICAgICAgfVxuICAgIH0gZWxzZSB7XG4gICAgICByZXN0cmVlLnB1c2goYnJhbmNoKTtcbiAgICB9XG4gIH0pO1xuXG4gIC8vIFdlIGRpZG50IGZpbmRcbiAgaWYgKCFtZXJnZWQpIHtcbiAgICByZXN0cmVlLnB1c2gocGF0aCk7XG4gIH1cblxuICByZXN0cmVlLnNvcnQoZnVuY3Rpb24gKGEsIGIpIHtcbiAgICByZXR1cm4gYS5wb3MgLSBiLnBvcztcbiAgfSk7XG5cbiAgcmV0dXJuIHtcbiAgICB0cmVlOiByZXN0cmVlLFxuICAgIGNvbmZsaWN0czogY29uZmxpY3RzIHx8ICdpbnRlcm5hbF9ub2RlJ1xuICB9O1xufVxuXG4vLyBUbyBlbnN1cmUgd2UgZG9udCBncm93IHRoZSByZXZpc2lvbiB0cmVlIGluZmluaXRlbHksIHdlIHN0ZW0gb2xkIHJldmlzaW9uc1xuZnVuY3Rpb24gc3RlbSh0cmVlLCBkZXB0aCkge1xuICAvLyBGaXJzdCB3ZSBicmVhayBvdXQgdGhlIHRyZWUgaW50byBhIGNvbXBsZXRlIGxpc3Qgb2Ygcm9vdCB0byBsZWFmIHBhdGhzLFxuICAvLyB3ZSBjdXQgb2ZmIHRoZSBzdGFydCBvZiB0aGUgcGF0aCBhbmQgZ2VuZXJhdGUgYSBuZXcgc2V0IG9mIGZsYXQgdHJlZXNcbiAgdmFyIHN0ZW1tZWRQYXRocyA9IFBvdWNoTWVyZ2Uucm9vdFRvTGVhZih0cmVlKS5tYXAoZnVuY3Rpb24gKHBhdGgpIHtcbiAgICB2YXIgc3RlbW1lZCA9IHBhdGguaWRzLnNsaWNlKC1kZXB0aCk7XG4gICAgcmV0dXJuIHtcbiAgICAgIHBvczogcGF0aC5wb3MgKyAocGF0aC5pZHMubGVuZ3RoIC0gc3RlbW1lZC5sZW5ndGgpLFxuICAgICAgaWRzOiBwYXRoVG9UcmVlKHN0ZW1tZWQpXG4gICAgfTtcbiAgfSk7XG4gIC8vIFRoZW4gd2UgcmVtZXJnZSBhbGwgdGhvc2UgZmxhdCB0cmVlcyB0b2dldGhlciwgZW5zdXJpbmcgdGhhdCB3ZSBkb250XG4gIC8vIGNvbm5lY3QgdHJlZXMgdGhhdCB3b3VsZCBnbyBiZXlvbmQgdGhlIGRlcHRoIGxpbWl0XG4gIHJldHVybiBzdGVtbWVkUGF0aHMucmVkdWNlKGZ1bmN0aW9uIChwcmV2LCBjdXJyZW50LCBpLCBhcnIpIHtcbiAgICByZXR1cm4gZG9NZXJnZShwcmV2LCBjdXJyZW50LCB0cnVlKS50cmVlO1xuICB9LCBbc3RlbW1lZFBhdGhzLnNoaWZ0KCldKTtcbn1cblxudmFyIFBvdWNoTWVyZ2UgPSB7fTtcblxuUG91Y2hNZXJnZS5tZXJnZSA9IGZ1bmN0aW9uICh0cmVlLCBwYXRoLCBkZXB0aCkge1xuICAvLyBVZ2gsIG5pY2VyIHdheSB0byBub3QgbW9kaWZ5IGFyZ3VtZW50cyBpbiBwbGFjZT9cbiAgdHJlZSA9IGV4dGVuZCh0cnVlLCBbXSwgdHJlZSk7XG4gIHBhdGggPSBleHRlbmQodHJ1ZSwge30sIHBhdGgpO1xuICB2YXIgbmV3VHJlZSA9IGRvTWVyZ2UodHJlZSwgcGF0aCk7XG4gIHJldHVybiB7XG4gICAgdHJlZTogc3RlbShuZXdUcmVlLnRyZWUsIGRlcHRoKSxcbiAgICBjb25mbGljdHM6IG5ld1RyZWUuY29uZmxpY3RzXG4gIH07XG59O1xuXG4vLyBXZSBmZXRjaCBhbGwgbGVhZnMgb2YgdGhlIHJldmlzaW9uIHRyZWUsIGFuZCBzb3J0IHRoZW0gYmFzZWQgb24gdHJlZSBsZW5ndGhcbi8vIGFuZCB3aGV0aGVyIHRoZXkgd2VyZSBkZWxldGVkLCB1bmRlbGV0ZWQgZG9jdW1lbnRzIHdpdGggdGhlIGxvbmdlc3QgcmV2aXNpb25cbi8vIHRyZWUgKG1vc3QgZWRpdHMpIHdpblxuLy8gVGhlIGZpbmFsIHNvcnQgYWxnb3JpdGhtIGlzIHNsaWdodGx5IGRvY3VtZW50ZWQgaW4gYSBzaWRlYmFyIGhlcmU6XG4vLyBodHRwOi8vZ3VpZGUuY291Y2hkYi5vcmcvZHJhZnQvY29uZmxpY3RzLmh0bWxcblBvdWNoTWVyZ2Uud2lubmluZ1JldiA9IGZ1bmN0aW9uIChtZXRhZGF0YSkge1xuICB2YXIgbGVhZnMgPSBbXTtcbiAgUG91Y2hNZXJnZS50cmF2ZXJzZVJldlRyZWUobWV0YWRhdGEucmV2X3RyZWUsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICBmdW5jdGlvbiAoaXNMZWFmLCBwb3MsIGlkLCBzb21ldGhpbmcsIG9wdHMpIHtcbiAgICBpZiAoaXNMZWFmKSB7XG4gICAgICBsZWFmcy5wdXNoKHtwb3M6IHBvcywgaWQ6IGlkLCBkZWxldGVkOiAhIW9wdHMuZGVsZXRlZH0pO1xuICAgIH1cbiAgfSk7XG4gIGxlYWZzLnNvcnQoZnVuY3Rpb24gKGEsIGIpIHtcbiAgICBpZiAoYS5kZWxldGVkICE9PSBiLmRlbGV0ZWQpIHtcbiAgICAgIHJldHVybiBhLmRlbGV0ZWQgPiBiLmRlbGV0ZWQgPyAxIDogLTE7XG4gICAgfVxuICAgIGlmIChhLnBvcyAhPT0gYi5wb3MpIHtcbiAgICAgIHJldHVybiBiLnBvcyAtIGEucG9zO1xuICAgIH1cbiAgICByZXR1cm4gYS5pZCA8IGIuaWQgPyAxIDogLTE7XG4gIH0pO1xuXG4gIHJldHVybiBsZWFmc1swXS5wb3MgKyAnLScgKyBsZWFmc1swXS5pZDtcbn07XG5cbi8vIFByZXR0eSBtdWNoIGFsbCBiZWxvdyBjYW4gYmUgY29tYmluZWQgaW50byBhIGhpZ2hlciBvcmRlciBmdW5jdGlvbiB0b1xuLy8gdHJhdmVyc2UgcmV2aXNpb25zXG4vLyBUaGUgcmV0dXJuIHZhbHVlIGZyb20gdGhlIGNhbGxiYWNrIHdpbGwgYmUgcGFzc2VkIGFzIGNvbnRleHQgdG8gYWxsXG4vLyBjaGlsZHJlbiBvZiB0aGF0IG5vZGVcblBvdWNoTWVyZ2UudHJhdmVyc2VSZXZUcmVlID0gZnVuY3Rpb24gKHJldnMsIGNhbGxiYWNrKSB7XG4gIHZhciB0b1Zpc2l0ID0gcmV2cy5zbGljZSgpO1xuXG4gIHZhciBub2RlO1xuICB3aGlsZSAoKG5vZGUgPSB0b1Zpc2l0LnBvcCgpKSkge1xuICAgIHZhciBwb3MgPSBub2RlLnBvcztcbiAgICB2YXIgdHJlZSA9IG5vZGUuaWRzO1xuICAgIHZhciBicmFuY2hlcyA9IHRyZWVbMl07XG4gICAgdmFyIG5ld0N0eCA9XG4gICAgICBjYWxsYmFjayhicmFuY2hlcy5sZW5ndGggPT09IDAsIHBvcywgdHJlZVswXSwgbm9kZS5jdHgsIHRyZWVbMV0pO1xuICAgIGZvciAodmFyIGkgPSAwLCBsZW4gPSBicmFuY2hlcy5sZW5ndGg7IGkgPCBsZW47IGkrKykge1xuICAgICAgdG9WaXNpdC5wdXNoKHtwb3M6IHBvcyArIDEsIGlkczogYnJhbmNoZXNbaV0sIGN0eDogbmV3Q3R4fSk7XG4gICAgfVxuICB9XG59O1xuXG5Qb3VjaE1lcmdlLmNvbGxlY3RMZWF2ZXMgPSBmdW5jdGlvbiAocmV2cykge1xuICB2YXIgbGVhdmVzID0gW107XG4gIFBvdWNoTWVyZ2UudHJhdmVyc2VSZXZUcmVlKHJldnMsIGZ1bmN0aW9uIChpc0xlYWYsIHBvcywgaWQsIGFjYywgb3B0cykge1xuICAgIGlmIChpc0xlYWYpIHtcbiAgICAgIGxlYXZlcy51bnNoaWZ0KHtyZXY6IHBvcyArIFwiLVwiICsgaWQsIHBvczogcG9zLCBvcHRzOiBvcHRzfSk7XG4gICAgfVxuICB9KTtcbiAgbGVhdmVzLnNvcnQoZnVuY3Rpb24gKGEsIGIpIHtcbiAgICByZXR1cm4gYi5wb3MgLSBhLnBvcztcbiAgfSk7XG4gIGxlYXZlcy5tYXAoZnVuY3Rpb24gKGxlYWYpIHsgZGVsZXRlIGxlYWYucG9zOyB9KTtcbiAgcmV0dXJuIGxlYXZlcztcbn07XG5cbi8vIHJldHVybnMgcmV2cyBvZiBhbGwgY29uZmxpY3RzIHRoYXQgaXMgbGVhdmVzIHN1Y2ggdGhhdFxuLy8gMS4gYXJlIG5vdCBkZWxldGVkIGFuZFxuLy8gMi4gYXJlIGRpZmZlcmVudCB0aGFuIHdpbm5pbmcgcmV2aXNpb25cblBvdWNoTWVyZ2UuY29sbGVjdENvbmZsaWN0cyA9IGZ1bmN0aW9uIChtZXRhZGF0YSkge1xuICB2YXIgd2luID0gUG91Y2hNZXJnZS53aW5uaW5nUmV2KG1ldGFkYXRhKTtcbiAgdmFyIGxlYXZlcyA9IFBvdWNoTWVyZ2UuY29sbGVjdExlYXZlcyhtZXRhZGF0YS5yZXZfdHJlZSk7XG4gIHZhciBjb25mbGljdHMgPSBbXTtcbiAgbGVhdmVzLmZvckVhY2goZnVuY3Rpb24gKGxlYWYpIHtcbiAgICBpZiAobGVhZi5yZXYgIT09IHdpbiAmJiAhbGVhZi5vcHRzLmRlbGV0ZWQpIHtcbiAgICAgIGNvbmZsaWN0cy5wdXNoKGxlYWYucmV2KTtcbiAgICB9XG4gIH0pO1xuICByZXR1cm4gY29uZmxpY3RzO1xufTtcblxuUG91Y2hNZXJnZS5yb290VG9MZWFmID0gZnVuY3Rpb24gKHRyZWUpIHtcbiAgdmFyIHBhdGhzID0gW107XG4gIFBvdWNoTWVyZ2UudHJhdmVyc2VSZXZUcmVlKHRyZWUsIGZ1bmN0aW9uIChpc0xlYWYsIHBvcywgaWQsIGhpc3RvcnksIG9wdHMpIHtcbiAgICBoaXN0b3J5ID0gaGlzdG9yeSA/IGhpc3Rvcnkuc2xpY2UoMCkgOiBbXTtcbiAgICBoaXN0b3J5LnB1c2goe2lkOiBpZCwgb3B0czogb3B0c30pO1xuICAgIGlmIChpc0xlYWYpIHtcbiAgICAgIHZhciByb290UG9zID0gcG9zICsgMSAtIGhpc3RvcnkubGVuZ3RoO1xuICAgICAgcGF0aHMudW5zaGlmdCh7cG9zOiByb290UG9zLCBpZHM6IGhpc3Rvcnl9KTtcbiAgICB9XG4gICAgcmV0dXJuIGhpc3Rvcnk7XG4gIH0pO1xuICByZXR1cm4gcGF0aHM7XG59O1xuXG5cbm1vZHVsZS5leHBvcnRzID0gUG91Y2hNZXJnZTtcblxufSx7XCJwb3VjaGRiLWV4dGVuZFwiOjQ4fV0sMTk6W2Z1bmN0aW9uKF9kZXJlcV8sbW9kdWxlLGV4cG9ydHMpe1xuJ3VzZSBzdHJpY3QnO1xuXG52YXIgdXRpbHMgPSBfZGVyZXFfKCcuL3V0aWxzJyk7XG52YXIgRUUgPSBfZGVyZXFfKCdldmVudHMnKS5FdmVudEVtaXR0ZXI7XG5cbnZhciBNQVhfU0lNVUxUQU5FT1VTX1JFVlMgPSA1MDtcblxuLy8gV2UgY3JlYXRlIGEgYmFzaWMgcHJvbWlzZSBzbyB0aGUgY2FsbGVyIGNhbiBjYW5jZWwgdGhlIHJlcGxpY2F0aW9uIHBvc3NpYmx5XG4vLyBiZWZvcmUgd2UgaGF2ZSBhY3R1YWxseSBzdGFydGVkIGxpc3RlbmluZyB0byBjaGFuZ2VzIGV0Y1xudXRpbHMuaW5oZXJpdHMoUmVwbGljYXRpb24sIEVFKTtcbmZ1bmN0aW9uIFJlcGxpY2F0aW9uKG9wdHMpIHtcbiAgRUUuY2FsbCh0aGlzKTtcbiAgdGhpcy5jYW5jZWxsZWQgPSBmYWxzZTtcbiAgdmFyIHNlbGYgPSB0aGlzO1xuICB2YXIgcHJvbWlzZSA9IG5ldyB1dGlscy5Qcm9taXNlKGZ1bmN0aW9uIChmdWxmaWxsLCByZWplY3QpIHtcbiAgICBzZWxmLm9uY2UoJ2NvbXBsZXRlJywgZnVsZmlsbCk7XG4gICAgc2VsZi5vbmNlKCdlcnJvcicsIHJlamVjdCk7XG4gIH0pO1xuICBzZWxmLnRoZW4gPSBmdW5jdGlvbiAocmVzb2x2ZSwgcmVqZWN0KSB7XG4gICAgcmV0dXJuIHByb21pc2UudGhlbihyZXNvbHZlLCByZWplY3QpO1xuICB9O1xuICBzZWxmW1wiY2F0Y2hcIl0gPSBmdW5jdGlvbiAocmVqZWN0KSB7XG4gICAgcmV0dXJuIHByb21pc2VbXCJjYXRjaFwiXShyZWplY3QpO1xuICB9O1xuICAvLyBBcyB3ZSBhbGxvdyBlcnJvciBoYW5kbGluZyB2aWEgXCJlcnJvclwiIGV2ZW50IGFzIHdlbGwsXG4gIC8vIHB1dCBhIHN0dWIgaW4gaGVyZSBzbyB0aGF0IHJlamVjdGluZyBuZXZlciB0aHJvd3MgVW5oYW5kbGVkRXJyb3IuXG4gIHNlbGZbXCJjYXRjaFwiXShmdW5jdGlvbiAoZXJyKSB7fSk7XG59XG5cblJlcGxpY2F0aW9uLnByb3RvdHlwZS5jYW5jZWwgPSBmdW5jdGlvbiAoKSB7XG4gIHRoaXMuY2FuY2VsbGVkID0gdHJ1ZTtcbiAgdGhpcy5lbWl0KCdjYW5jZWwnKTtcbn07XG5cblJlcGxpY2F0aW9uLnByb3RvdHlwZS5yZWFkeSA9IGZ1bmN0aW9uIChzcmMsIHRhcmdldCkge1xuICB2YXIgc2VsZiA9IHRoaXM7XG4gIGZ1bmN0aW9uIG9uRGVzdHJveSgpIHtcbiAgICBzZWxmLmNhbmNlbCgpO1xuICB9XG4gIHNyYy5vbmNlKCdkZXN0cm95ZWQnLCBvbkRlc3Ryb3kpO1xuICB0YXJnZXQub25jZSgnZGVzdHJveWVkJywgb25EZXN0cm95KTtcbiAgZnVuY3Rpb24gY2xlYW51cCgpIHtcbiAgICBzcmMucmVtb3ZlTGlzdGVuZXIoJ2Rlc3Ryb3llZCcsIG9uRGVzdHJveSk7XG4gICAgdGFyZ2V0LnJlbW92ZUxpc3RlbmVyKCdkZXN0cm95ZWQnLCBvbkRlc3Ryb3kpO1xuICB9XG4gIHRoaXMudGhlbihjbGVhbnVwLCBjbGVhbnVwKTtcbn07XG5cblxuLy8gVE9ETzogY2hlY2sgQ291Y2hEQidzIHJlcGxpY2F0aW9uIGlkIGdlbmVyYXRpb25cbi8vIEdlbmVyYXRlIGEgdW5pcXVlIGlkIHBhcnRpY3VsYXIgdG8gdGhpcyByZXBsaWNhdGlvblxuZnVuY3Rpb24gZ2VuUmVwbGljYXRpb25JZChzcmMsIHRhcmdldCwgb3B0cykge1xuICB2YXIgZmlsdGVyRnVuID0gb3B0cy5maWx0ZXIgPyBvcHRzLmZpbHRlci50b1N0cmluZygpIDogJyc7XG4gIHJldHVybiBzcmMuaWQoKS50aGVuKGZ1bmN0aW9uIChzcmNfaWQpIHtcbiAgICByZXR1cm4gdGFyZ2V0LmlkKCkudGhlbihmdW5jdGlvbiAodGFyZ2V0X2lkKSB7XG4gICAgICB2YXIgcXVlcnlEYXRhID0gc3JjX2lkICsgdGFyZ2V0X2lkICsgZmlsdGVyRnVuICtcbiAgICAgICAgSlNPTi5zdHJpbmdpZnkob3B0cy5xdWVyeV9wYXJhbXMpICsgb3B0cy5kb2NfaWRzO1xuICAgICAgcmV0dXJuIHV0aWxzLk1ENShxdWVyeURhdGEpLnRoZW4oZnVuY3Rpb24gKG1kNSkge1xuICAgICAgICAvLyBjYW4ndCB1c2Ugc3RyYWlnaHQtdXAgbWQ1IGFscGhhYmV0LCBiZWNhdXNlXG4gICAgICAgIC8vIHRoZSBjaGFyICcvJyBpcyBpbnRlcnByZXRlZCBhcyBiZWluZyBmb3IgYXR0YWNobWVudHMsXG4gICAgICAgIC8vIGFuZCArIGlzIGFsc28gbm90IHVybC1zYWZlXG4gICAgICAgIG1kNSA9IG1kNS5yZXBsYWNlKC9cXC8vZywgJy4nKS5yZXBsYWNlKC9cXCsvZywgJ18nKTtcbiAgICAgICAgcmV0dXJuICdfbG9jYWwvJyArIG1kNTtcbiAgICAgIH0pO1xuICAgIH0pO1xuICB9KTtcbn1cblxuXG5mdW5jdGlvbiB1cGRhdGVDaGVja3BvaW50KGRiLCBpZCwgY2hlY2twb2ludCwgcmV0dXJuVmFsdWUpIHtcbiAgICByZXR1cm4gZGIuZ2V0KGlkKVtcImNhdGNoXCJdKGZ1bmN0aW9uIChlcnIpIHtcbiAgICAgIGlmIChlcnIuc3RhdHVzID09PSA0MDQpIHtcbiAgICAgICAgcmV0dXJuIHtfaWQ6IGlkfTtcbiAgICAgIH1cbiAgICAgIHRocm93IGVycjtcbiAgICB9KS50aGVuKGZ1bmN0aW9uIChkb2MpIHtcbiAgICAgIGlmIChyZXR1cm5WYWx1ZS5jYW5jZWxsZWQpIHtcbiAgICAgICAgcmV0dXJuO1xuICAgICAgfVxuICAgICAgZG9jLmxhc3Rfc2VxID0gY2hlY2twb2ludDtcbiAgICAgIHJldHVybiBkYi5wdXQoZG9jKTtcbiAgICB9KTtcbiAgfVxuXG5mdW5jdGlvbiBDaGVja3BvaW50ZXIoc3JjLCB0YXJnZXQsIGlkLCByZXR1cm5WYWx1ZSkge1xuICB0aGlzLnNyYyA9IHNyYztcbiAgdGhpcy50YXJnZXQgPSB0YXJnZXQ7XG4gIHRoaXMuaWQgPSBpZDtcbiAgdGhpcy5yZXR1cm5WYWx1ZSA9IHJldHVyblZhbHVlO1xufVxuXG5DaGVja3BvaW50ZXIucHJvdG90eXBlLndyaXRlQ2hlY2twb2ludCA9IGZ1bmN0aW9uIChjaGVja3BvaW50KSB7XG4gIHZhciBzZWxmID0gdGhpcztcbiAgcmV0dXJuIHRoaXMudXBkYXRlVGFyZ2V0KGNoZWNrcG9pbnQpLnRoZW4oZnVuY3Rpb24gKCkge1xuICAgIHJldHVybiBzZWxmLnVwZGF0ZVNvdXJjZShjaGVja3BvaW50KTtcbiAgfSk7XG59O1xuQ2hlY2twb2ludGVyLnByb3RvdHlwZS51cGRhdGVUYXJnZXQgPSBmdW5jdGlvbiAoY2hlY2twb2ludCkge1xuICByZXR1cm4gdXBkYXRlQ2hlY2twb2ludCh0aGlzLnRhcmdldCwgdGhpcy5pZCwgY2hlY2twb2ludCwgdGhpcy5yZXR1cm5WYWx1ZSk7XG59O1xuQ2hlY2twb2ludGVyLnByb3RvdHlwZS51cGRhdGVTb3VyY2UgPSBmdW5jdGlvbiAoY2hlY2twb2ludCkge1xuICB2YXIgc2VsZiA9IHRoaXM7XG4gIGlmICh0aGlzLnJlYWRPbmx5U291cmNlKSB7XG4gICAgcmV0dXJuIHV0aWxzLlByb21pc2UucmVzb2x2ZSh0cnVlKTtcbiAgfVxuICByZXR1cm4gdXBkYXRlQ2hlY2twb2ludCh0aGlzLnNyYywgdGhpcy5pZCwgY2hlY2twb2ludCwgdGhpcy5yZXR1cm5WYWx1ZSlbXG4gICAgXCJjYXRjaFwiXShmdW5jdGlvbiAoZXJyKSB7XG4gICAgdmFyIGlzRm9yYmlkZGVuID0gdHlwZW9mIGVyci5zdGF0dXMgPT09ICdudW1iZXInICYmXG4gICAgICBNYXRoLmZsb29yKGVyci5zdGF0dXMgLyAxMDApID09PSA0O1xuICAgIGlmIChpc0ZvcmJpZGRlbikge1xuICAgICAgc2VsZi5yZWFkT25seVNvdXJjZSA9IHRydWU7XG4gICAgICByZXR1cm4gdHJ1ZTtcbiAgICB9XG4gICAgdGhyb3cgZXJyO1xuICB9KTtcbn07XG5DaGVja3BvaW50ZXIucHJvdG90eXBlLmdldENoZWNrcG9pbnQgPSBmdW5jdGlvbiAoKSB7XG4gIHZhciBzZWxmID0gdGhpcztcbiAgcmV0dXJuIHNlbGYudGFyZ2V0LmdldChzZWxmLmlkKS50aGVuKGZ1bmN0aW9uICh0YXJnZXREb2MpIHtcbiAgICByZXR1cm4gc2VsZi5zcmMuZ2V0KHNlbGYuaWQpLnRoZW4oZnVuY3Rpb24gKHNvdXJjZURvYykge1xuICAgICAgaWYgKHRhcmdldERvYy5sYXN0X3NlcSA9PT0gc291cmNlRG9jLmxhc3Rfc2VxKSB7XG4gICAgICAgIHJldHVybiBzb3VyY2VEb2MubGFzdF9zZXE7XG4gICAgICB9XG4gICAgICByZXR1cm4gMDtcbiAgICB9LCBmdW5jdGlvbiAoZXJyKSB7XG4gICAgICBpZiAoZXJyLnN0YXR1cyA9PT0gNDA0ICYmIHRhcmdldERvYy5sYXN0X3NlcSkge1xuICAgICAgICByZXR1cm4gc2VsZi5zcmMucHV0KHtcbiAgICAgICAgICBfaWQ6IHNlbGYuaWQsXG4gICAgICAgICAgbGFzdF9zZXE6IDBcbiAgICAgICAgfSkudGhlbihmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgcmV0dXJuIDA7XG4gICAgICAgIH0sIGZ1bmN0aW9uIChlcnIpIHtcbiAgICAgICAgICBpZiAoZXJyLnN0YXR1cyA9PT0gNDAxKSB7XG4gICAgICAgICAgICBzZWxmLnJlYWRPbmx5U291cmNlID0gdHJ1ZTtcbiAgICAgICAgICAgIHJldHVybiB0YXJnZXREb2MubGFzdF9zZXE7XG4gICAgICAgICAgfVxuICAgICAgICAgIHJldHVybiAwO1xuICAgICAgICB9KTtcbiAgICAgIH1cbiAgICAgIHRocm93IGVycjtcbiAgICB9KTtcbiAgfSlbXCJjYXRjaFwiXShmdW5jdGlvbiAoZXJyKSB7XG4gICAgaWYgKGVyci5zdGF0dXMgIT09IDQwNCkge1xuICAgICAgdGhyb3cgZXJyO1xuICAgIH1cbiAgICByZXR1cm4gMDtcbiAgfSk7XG59O1xuZnVuY3Rpb24gcmVwbGljYXRlKHJlcElkLCBzcmMsIHRhcmdldCwgb3B0cywgcmV0dXJuVmFsdWUpIHtcbiAgdmFyIGJhdGNoZXMgPSBbXTsgICAgICAgICAgICAgICAvLyBsaXN0IG9mIGJhdGNoZXMgdG8gYmUgcHJvY2Vzc2VkXG4gIHZhciBjdXJyZW50QmF0Y2g7ICAgICAgICAgICAgICAgLy8gdGhlIGJhdGNoIGN1cnJlbnRseSBiZWluZyBwcm9jZXNzZWRcbiAgdmFyIHBlbmRpbmdCYXRjaCA9IHtcbiAgICBzZXE6IDAsXG4gICAgY2hhbmdlczogW10sXG4gICAgZG9jczogW11cbiAgfTsgLy8gbmV4dCBiYXRjaCwgbm90IHlldCByZWFkeSB0byBiZSBwcm9jZXNzZWRcbiAgdmFyIHdyaXRpbmdDaGVja3BvaW50ID0gZmFsc2U7ICAvLyB0cnVlIHdoaWxlIGNoZWNrcG9pbnQgaXMgYmVpbmcgd3JpdHRlblxuICB2YXIgY2hhbmdlc0NvbXBsZXRlZCA9IGZhbHNlOyAgIC8vIHRydWUgd2hlbiBhbGwgY2hhbmdlcyByZWNlaXZlZFxuICB2YXIgcmVwbGljYXRpb25Db21wbGV0ZWQgPSBmYWxzZTsgLy8gdHJ1ZSB3aGVuIHJlcGxpY2F0aW9uIGhhcyBjb21wbGV0ZWRcbiAgdmFyIGxhc3Rfc2VxID0gMDtcbiAgdmFyIGNvbnRpbnVvdXMgPSBvcHRzLmNvbnRpbnVvdXMgfHwgb3B0cy5saXZlIHx8IGZhbHNlO1xuICB2YXIgYmF0Y2hfc2l6ZSA9IG9wdHMuYmF0Y2hfc2l6ZSB8fCAxMDA7XG4gIHZhciBiYXRjaGVzX2xpbWl0ID0gb3B0cy5iYXRjaGVzX2xpbWl0IHx8IDEwO1xuICB2YXIgY2hhbmdlc1BlbmRpbmcgPSBmYWxzZTsgICAgIC8vIHRydWUgd2hpbGUgc3JjLmNoYW5nZXMgaXMgcnVubmluZ1xuICB2YXIgZG9jX2lkcyA9IG9wdHMuZG9jX2lkcztcbiAgdmFyIGNoZWNrcG9pbnRlciA9IG5ldyBDaGVja3BvaW50ZXIoc3JjLCB0YXJnZXQsIHJlcElkLCByZXR1cm5WYWx1ZSk7XG4gIHZhciByZXN1bHQgPSB7XG4gICAgb2s6IHRydWUsXG4gICAgc3RhcnRfdGltZTogbmV3IERhdGUoKSxcbiAgICBkb2NzX3JlYWQ6IDAsXG4gICAgZG9jc193cml0dGVuOiAwLFxuICAgIGRvY193cml0ZV9mYWlsdXJlczogMCxcbiAgICBlcnJvcnM6IFtdXG4gIH07XG4gIHZhciBjaGFuZ2VzT3B0cyA9IHt9O1xuICByZXR1cm5WYWx1ZS5yZWFkeShzcmMsIHRhcmdldCk7XG5cblxuICBmdW5jdGlvbiB3cml0ZURvY3MoKSB7XG4gICAgaWYgKGN1cnJlbnRCYXRjaC5kb2NzLmxlbmd0aCA9PT0gMCkge1xuICAgICAgcmV0dXJuO1xuICAgIH1cbiAgICB2YXIgZG9jcyA9IGN1cnJlbnRCYXRjaC5kb2NzO1xuICAgIHJldHVybiB0YXJnZXQuYnVsa0RvY3Moe1xuICAgICAgZG9jczogZG9jc1xuICAgIH0sIHtcbiAgICAgIG5ld19lZGl0czogZmFsc2VcbiAgICB9KS50aGVuKGZ1bmN0aW9uIChyZXMpIHtcbiAgICAgIGlmIChyZXR1cm5WYWx1ZS5jYW5jZWxsZWQpIHtcbiAgICAgICAgY29tcGxldGVSZXBsaWNhdGlvbigpO1xuICAgICAgICB0aHJvdyBuZXcgRXJyb3IoJ2NhbmNlbGxlZCcpO1xuICAgICAgfVxuICAgICAgdmFyIGVycm9ycyA9IFtdO1xuICAgICAgcmVzLmZvckVhY2goZnVuY3Rpb24gKHJlcykge1xuICAgICAgICBpZiAocmVzLmVycm9yKSB7XG4gICAgICAgICAgcmVzdWx0LmRvY193cml0ZV9mYWlsdXJlcysrO1xuICAgICAgICAgIHZhciBlcnJvciA9IG5ldyBFcnJvcihyZXMucmVhc29uIHx8IHJlcy5tZXNzYWdlIHx8ICdVbmtub3duIHJlYXNvbicpO1xuICAgICAgICAgIGVycm9yLm5hbWUgPSByZXMubmFtZSB8fCByZXMuZXJyb3I7XG4gICAgICAgICAgZXJyb3JzLnB1c2goZXJyb3IpO1xuICAgICAgICB9XG4gICAgICB9KTtcbiAgICAgIHJlc3VsdC5lcnJvcnMgPSByZXN1bHQuZXJyb3JzLmNvbmNhdChlcnJvcnMpO1xuICAgICAgcmVzdWx0LmRvY3Nfd3JpdHRlbiArPSBjdXJyZW50QmF0Y2guZG9jcy5sZW5ndGggLSBlcnJvcnMubGVuZ3RoO1xuICAgICAgdmFyIG5vbjQwM3MgPSBlcnJvcnMuZmlsdGVyKGZ1bmN0aW9uIChlcnJvcikge1xuICAgICAgICByZXR1cm4gZXJyb3IubmFtZSAhPT0gJ3VuYXV0aG9yaXplZCcgJiYgZXJyb3IubmFtZSAhPT0gJ2ZvcmJpZGRlbic7XG4gICAgICB9KTtcbiAgICAgIGlmIChub240MDNzLmxlbmd0aCA+IDApIHtcbiAgICAgICAgdmFyIGVycm9yID0gbmV3IEVycm9yKCdidWxrRG9jcyBlcnJvcicpO1xuICAgICAgICBlcnJvci5vdGhlcl9lcnJvcnMgPSBlcnJvcnM7XG4gICAgICAgIGFib3J0UmVwbGljYXRpb24oJ3RhcmdldC5idWxrRG9jcyBmYWlsZWQgdG8gd3JpdGUgZG9jcycsIGVycm9yKTtcbiAgICAgICAgdGhyb3cgbmV3IEVycm9yKCdidWxrV3JpdGUgcGFydGlhbCBmYWlsdXJlJyk7XG4gICAgICB9XG4gICAgfSwgZnVuY3Rpb24gKGVycikge1xuICAgICAgcmVzdWx0LmRvY193cml0ZV9mYWlsdXJlcyArPSBkb2NzLmxlbmd0aDtcbiAgICAgIHRocm93IGVycjtcbiAgICB9KTtcbiAgfVxuXG5cbiAgZnVuY3Rpb24gZ2V0TmV4dERvYygpIHtcbiAgICB2YXIgZGlmZnMgPSBjdXJyZW50QmF0Y2guZGlmZnM7XG4gICAgdmFyIGlkID0gT2JqZWN0LmtleXMoZGlmZnMpWzBdO1xuICAgIHZhciBhbGxNaXNzaW5nID0gZGlmZnNbaWRdLm1pc3Npbmc7XG4gICAgLy8gYXZvaWQgdXJsIHRvbyBsb25nIGVycm9yIGJ5IGJhdGNoaW5nXG4gICAgdmFyIG1pc3NpbmdCYXRjaGVzID0gW107XG4gICAgZm9yICh2YXIgaSA9IDA7IGkgPCBhbGxNaXNzaW5nLmxlbmd0aDsgaSArPSBNQVhfU0lNVUxUQU5FT1VTX1JFVlMpIHtcbiAgICAgIG1pc3NpbmdCYXRjaGVzLnB1c2goYWxsTWlzc2luZy5zbGljZShpLCBNYXRoLm1pbihhbGxNaXNzaW5nLmxlbmd0aCxcbiAgICAgICAgaSArIE1BWF9TSU1VTFRBTkVPVVNfUkVWUykpKTtcbiAgICB9XG5cbiAgICByZXR1cm4gdXRpbHMuUHJvbWlzZS5hbGwobWlzc2luZ0JhdGNoZXMubWFwKGZ1bmN0aW9uIChtaXNzaW5nKSB7XG4gICAgICByZXR1cm4gc3JjLmdldChpZCwge3JldnM6IHRydWUsIG9wZW5fcmV2czogbWlzc2luZywgYXR0YWNobWVudHM6IHRydWV9KVxuICAgICAgICAudGhlbihmdW5jdGlvbiAoZG9jcykge1xuICAgICAgICAgIGRvY3MuZm9yRWFjaChmdW5jdGlvbiAoZG9jKSB7XG4gICAgICAgICAgICBpZiAocmV0dXJuVmFsdWUuY2FuY2VsbGVkKSB7XG4gICAgICAgICAgICAgIHJldHVybiBjb21wbGV0ZVJlcGxpY2F0aW9uKCk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpZiAoZG9jLm9rKSB7XG4gICAgICAgICAgICAgIHJlc3VsdC5kb2NzX3JlYWQrKztcbiAgICAgICAgICAgICAgY3VycmVudEJhdGNoLnBlbmRpbmdSZXZzKys7XG4gICAgICAgICAgICAgIGN1cnJlbnRCYXRjaC5kb2NzLnB1c2goZG9jLm9rKTtcbiAgICAgICAgICAgICAgZGVsZXRlIGRpZmZzW2RvYy5vay5faWRdO1xuICAgICAgICAgICAgfVxuICAgICAgICAgIH0pO1xuICAgICAgICB9KTtcbiAgICB9KSk7XG4gIH1cblxuICBmdW5jdGlvbiBnZXRBbGxEb2NzKCkge1xuICAgIGlmIChPYmplY3Qua2V5cyhjdXJyZW50QmF0Y2guZGlmZnMpLmxlbmd0aCA+IDApIHtcbiAgICAgIHJldHVybiBnZXROZXh0RG9jKCkudGhlbihnZXRBbGxEb2NzKTtcbiAgICB9IGVsc2Uge1xuICAgICAgcmV0dXJuIHV0aWxzLlByb21pc2UucmVzb2x2ZSgpO1xuICAgIH1cbiAgfVxuXG5cbiAgZnVuY3Rpb24gZ2V0UmV2aXNpb25PbmVEb2NzKCkge1xuICAgIC8vIGZpbHRlciBvdXQgdGhlIGdlbmVyYXRpb24gMSBkb2NzIGFuZCBnZXQgdGhlbVxuICAgIC8vIGxlYXZpbmcgdGhlIG5vbi1nZW5lcmF0aW9uIG9uZSBkb2NzIHRvIGJlIGdvdCBvdGhlcndpc2VcbiAgICB2YXIgaWRzID0gT2JqZWN0LmtleXMoY3VycmVudEJhdGNoLmRpZmZzKS5maWx0ZXIoZnVuY3Rpb24gKGlkKSB7XG4gICAgICB2YXIgbWlzc2luZyA9IGN1cnJlbnRCYXRjaC5kaWZmc1tpZF0ubWlzc2luZztcbiAgICAgIHJldHVybiBtaXNzaW5nLmxlbmd0aCA9PT0gMSAmJiBtaXNzaW5nWzBdLnNsaWNlKDAsIDIpID09PSAnMS0nO1xuICAgIH0pO1xuICAgIHJldHVybiBzcmMuYWxsRG9jcyh7XG4gICAgICBrZXlzOiBpZHMsXG4gICAgICBpbmNsdWRlX2RvY3M6IHRydWVcbiAgICB9KS50aGVuKGZ1bmN0aW9uIChyZXMpIHtcbiAgICAgIGlmIChyZXR1cm5WYWx1ZS5jYW5jZWxsZWQpIHtcbiAgICAgICAgY29tcGxldGVSZXBsaWNhdGlvbigpO1xuICAgICAgICB0aHJvdyAobmV3IEVycm9yKCdjYW5jZWxsZWQnKSk7XG4gICAgICB9XG4gICAgICByZXMucm93cy5mb3JFYWNoKGZ1bmN0aW9uIChyb3cpIHtcbiAgICAgICAgaWYgKHJvdy5kb2MgJiYgIXJvdy5kZWxldGVkICYmXG4gICAgICAgICAgcm93LnZhbHVlLnJldi5zbGljZSgwLCAyKSA9PT0gJzEtJyAmJiAoXG4gICAgICAgICAgICAhcm93LmRvYy5fYXR0YWNobWVudHMgfHxcbiAgICAgICAgICAgIE9iamVjdC5rZXlzKHJvdy5kb2MuX2F0dGFjaG1lbnRzKS5sZW5ndGggPT09IDBcbiAgICAgICAgICApXG4gICAgICAgICkge1xuICAgICAgICAgIHJlc3VsdC5kb2NzX3JlYWQrKztcbiAgICAgICAgICBjdXJyZW50QmF0Y2gucGVuZGluZ1JldnMrKztcbiAgICAgICAgICBjdXJyZW50QmF0Y2guZG9jcy5wdXNoKHJvdy5kb2MpO1xuICAgICAgICAgIGRlbGV0ZSBjdXJyZW50QmF0Y2guZGlmZnNbcm93LmlkXTtcbiAgICAgICAgfVxuICAgICAgfSk7XG4gICAgfSk7XG4gIH1cblxuXG4gIGZ1bmN0aW9uIGdldERvY3MoKSB7XG4gICAgcmV0dXJuIGdldFJldmlzaW9uT25lRG9jcygpLnRoZW4oZ2V0QWxsRG9jcyk7XG4gIH1cblxuXG4gIGZ1bmN0aW9uIGZpbmlzaEJhdGNoKCkge1xuICAgIHdyaXRpbmdDaGVja3BvaW50ID0gdHJ1ZTtcbiAgICByZXR1cm4gY2hlY2twb2ludGVyLndyaXRlQ2hlY2twb2ludChcbiAgICAgIGN1cnJlbnRCYXRjaC5zZXFcbiAgICApLnRoZW4oZnVuY3Rpb24gKHJlcykge1xuICAgICAgd3JpdGluZ0NoZWNrcG9pbnQgPSBmYWxzZTtcbiAgICAgIGlmIChyZXR1cm5WYWx1ZS5jYW5jZWxsZWQpIHtcbiAgICAgICAgY29tcGxldGVSZXBsaWNhdGlvbigpO1xuICAgICAgICB0aHJvdyBuZXcgRXJyb3IoJ2NhbmNlbGxlZCcpO1xuICAgICAgfVxuICAgICAgcmVzdWx0Lmxhc3Rfc2VxID0gbGFzdF9zZXEgPSBjdXJyZW50QmF0Y2guc2VxO1xuICAgICAgcmV0dXJuVmFsdWUuZW1pdCgnY2hhbmdlJywgdXRpbHMuY2xvbmUocmVzdWx0KSk7XG4gICAgICBjdXJyZW50QmF0Y2ggPSB1bmRlZmluZWQ7XG4gICAgICBnZXRDaGFuZ2VzKCk7XG4gICAgfSlbXCJjYXRjaFwiXShmdW5jdGlvbiAoZXJyKSB7XG4gICAgICB3cml0aW5nQ2hlY2twb2ludCA9IGZhbHNlO1xuICAgICAgYWJvcnRSZXBsaWNhdGlvbignd3JpdGVDaGVja3BvaW50IGNvbXBsZXRlZCB3aXRoIGVycm9yJywgZXJyKTtcbiAgICAgIHRocm93IGVycjtcbiAgICB9KTtcbiAgfVxuXG5cbiAgZnVuY3Rpb24gZ2V0RGlmZnMoKSB7XG4gICAgdmFyIGRpZmYgPSB7fTtcbiAgICBjdXJyZW50QmF0Y2guY2hhbmdlcy5mb3JFYWNoKGZ1bmN0aW9uIChjaGFuZ2UpIHtcbiAgICAgIGRpZmZbY2hhbmdlLmlkXSA9IGNoYW5nZS5jaGFuZ2VzLm1hcChmdW5jdGlvbiAoeCkge1xuICAgICAgICByZXR1cm4geC5yZXY7XG4gICAgICB9KTtcbiAgICB9KTtcbiAgICByZXR1cm4gdGFyZ2V0LnJldnNEaWZmKGRpZmYpLnRoZW4oZnVuY3Rpb24gKGRpZmZzKSB7XG4gICAgICBpZiAocmV0dXJuVmFsdWUuY2FuY2VsbGVkKSB7XG4gICAgICAgIGNvbXBsZXRlUmVwbGljYXRpb24oKTtcbiAgICAgICAgdGhyb3cgbmV3IEVycm9yKCdjYW5jZWxsZWQnKTtcbiAgICAgIH1cbiAgICAgIC8vIGN1cnJlbnRCYXRjaC5kaWZmcyBlbGVtZW50cyBhcmUgZGVsZXRlZCBhcyB0aGUgZG9jdW1lbnRzIGFyZSB3cml0dGVuXG4gICAgICBjdXJyZW50QmF0Y2guZGlmZnMgPSBkaWZmcztcbiAgICAgIGN1cnJlbnRCYXRjaC5wZW5kaW5nUmV2cyA9IDA7XG4gICAgfSk7XG4gIH1cblxuXG4gIGZ1bmN0aW9uIHN0YXJ0TmV4dEJhdGNoKCkge1xuICAgIGlmIChyZXR1cm5WYWx1ZS5jYW5jZWxsZWQgfHwgY3VycmVudEJhdGNoKSB7XG4gICAgICByZXR1cm47XG4gICAgfVxuICAgIGlmIChiYXRjaGVzLmxlbmd0aCA9PT0gMCkge1xuICAgICAgcHJvY2Vzc1BlbmRpbmdCYXRjaCh0cnVlKTtcbiAgICAgIHJldHVybjtcbiAgICB9XG4gICAgY3VycmVudEJhdGNoID0gYmF0Y2hlcy5zaGlmdCgpO1xuICAgIGdldERpZmZzKClcbiAgICAudGhlbihnZXREb2NzKVxuICAgIC50aGVuKHdyaXRlRG9jcylcbiAgICAudGhlbihmaW5pc2hCYXRjaClcbiAgICAudGhlbihzdGFydE5leHRCYXRjaClbXG4gICAgXCJjYXRjaFwiXShmdW5jdGlvbiAoZXJyKSB7XG4gICAgICBhYm9ydFJlcGxpY2F0aW9uKCdiYXRjaCBwcm9jZXNzaW5nIHRlcm1pbmF0ZWQgd2l0aCBlcnJvcicsIGVycik7XG4gICAgfSk7XG4gIH1cblxuXG4gIGZ1bmN0aW9uIHByb2Nlc3NQZW5kaW5nQmF0Y2goaW1tZWRpYXRlKSB7XG4gICAgaWYgKHBlbmRpbmdCYXRjaC5jaGFuZ2VzLmxlbmd0aCA9PT0gMCkge1xuICAgICAgaWYgKGJhdGNoZXMubGVuZ3RoID09PSAwICYmICFjdXJyZW50QmF0Y2gpIHtcbiAgICAgICAgaWYgKChjb250aW51b3VzICYmIGNoYW5nZXNPcHRzLmxpdmUpIHx8IGNoYW5nZXNDb21wbGV0ZWQpIHtcbiAgICAgICAgICByZXR1cm5WYWx1ZS5lbWl0KCd1cHRvZGF0ZScsIHV0aWxzLmNsb25lKHJlc3VsdCkpO1xuICAgICAgICB9XG4gICAgICAgIGlmIChjaGFuZ2VzQ29tcGxldGVkKSB7XG4gICAgICAgICAgY29tcGxldGVSZXBsaWNhdGlvbigpO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgICByZXR1cm47XG4gICAgfVxuICAgIGlmIChcbiAgICAgIGltbWVkaWF0ZSB8fFxuICAgICAgY2hhbmdlc0NvbXBsZXRlZCB8fFxuICAgICAgcGVuZGluZ0JhdGNoLmNoYW5nZXMubGVuZ3RoID49IGJhdGNoX3NpemVcbiAgICApIHtcbiAgICAgIGJhdGNoZXMucHVzaChwZW5kaW5nQmF0Y2gpO1xuICAgICAgcGVuZGluZ0JhdGNoID0ge1xuICAgICAgICBzZXE6IDAsXG4gICAgICAgIGNoYW5nZXM6IFtdLFxuICAgICAgICBkb2NzOiBbXVxuICAgICAgfTtcbiAgICAgIHN0YXJ0TmV4dEJhdGNoKCk7XG4gICAgfVxuICB9XG5cblxuICBmdW5jdGlvbiBhYm9ydFJlcGxpY2F0aW9uKHJlYXNvbiwgZXJyKSB7XG4gICAgaWYgKHJlcGxpY2F0aW9uQ29tcGxldGVkKSB7XG4gICAgICByZXR1cm47XG4gICAgfVxuICAgIHJlc3VsdC5vayA9IGZhbHNlO1xuICAgIHJlc3VsdC5zdGF0dXMgPSAnYWJvcnRlZCc7XG4gICAgcmVzdWx0LmVycm9ycy5wdXNoKGVycik7XG4gICAgYmF0Y2hlcyA9IFtdO1xuICAgIHBlbmRpbmdCYXRjaCA9IHtcbiAgICAgIHNlcTogMCxcbiAgICAgIGNoYW5nZXM6IFtdLFxuICAgICAgZG9jczogW11cbiAgICB9O1xuICAgIGNvbXBsZXRlUmVwbGljYXRpb24oKTtcbiAgfVxuXG5cbiAgZnVuY3Rpb24gY29tcGxldGVSZXBsaWNhdGlvbigpIHtcbiAgICBpZiAocmVwbGljYXRpb25Db21wbGV0ZWQpIHtcbiAgICAgIHJldHVybjtcbiAgICB9XG4gICAgaWYgKHJldHVyblZhbHVlLmNhbmNlbGxlZCkge1xuICAgICAgcmVzdWx0LnN0YXR1cyA9ICdjYW5jZWxsZWQnO1xuICAgICAgaWYgKHdyaXRpbmdDaGVja3BvaW50KSB7XG4gICAgICAgIHJldHVybjtcbiAgICAgIH1cbiAgICB9XG4gICAgcmVzdWx0LnN0YXR1cyA9IHJlc3VsdC5zdGF0dXMgfHwgJ2NvbXBsZXRlJztcbiAgICByZXN1bHQuZW5kX3RpbWUgPSBuZXcgRGF0ZSgpO1xuICAgIHJlc3VsdC5sYXN0X3NlcSA9IGxhc3Rfc2VxO1xuICAgIHJlcGxpY2F0aW9uQ29tcGxldGVkID0gcmV0dXJuVmFsdWUuY2FuY2VsbGVkID0gdHJ1ZTtcbiAgICB2YXIgbm9uNDAzcyA9IHJlc3VsdC5lcnJvcnMuZmlsdGVyKGZ1bmN0aW9uIChlcnJvcikge1xuICAgICAgcmV0dXJuIGVycm9yLm5hbWUgIT09ICd1bmF1dGhvcml6ZWQnICYmIGVycm9yLm5hbWUgIT09ICdmb3JiaWRkZW4nO1xuICAgIH0pO1xuICAgIGlmIChub240MDNzLmxlbmd0aCA+IDApIHtcbiAgICAgIHZhciBlcnJvciA9IHJlc3VsdC5lcnJvcnMucG9wKCk7XG4gICAgICBpZiAocmVzdWx0LmVycm9ycy5sZW5ndGggPiAwKSB7XG4gICAgICAgIGVycm9yLm90aGVyX2Vycm9ycyA9IHJlc3VsdC5lcnJvcnM7XG4gICAgICB9XG4gICAgICBlcnJvci5yZXN1bHQgPSByZXN1bHQ7XG4gICAgICByZXR1cm5WYWx1ZS5lbWl0KCdlcnJvcicsIGVycm9yKTtcbiAgICB9IGVsc2Uge1xuICAgICAgcmV0dXJuVmFsdWUuZW1pdCgnY29tcGxldGUnLCByZXN1bHQpO1xuICAgIH1cbiAgICByZXR1cm5WYWx1ZS5yZW1vdmVBbGxMaXN0ZW5lcnMoKTtcbiAgfVxuXG5cbiAgZnVuY3Rpb24gb25DaGFuZ2UoY2hhbmdlKSB7XG4gICAgaWYgKHJldHVyblZhbHVlLmNhbmNlbGxlZCkge1xuICAgICAgcmV0dXJuIGNvbXBsZXRlUmVwbGljYXRpb24oKTtcbiAgICB9XG4gICAgaWYgKFxuICAgICAgcGVuZGluZ0JhdGNoLmNoYW5nZXMubGVuZ3RoID09PSAwICYmXG4gICAgICBiYXRjaGVzLmxlbmd0aCA9PT0gMCAmJlxuICAgICAgIWN1cnJlbnRCYXRjaFxuICAgICkge1xuICAgICAgcmV0dXJuVmFsdWUuZW1pdCgnb3V0b2ZkYXRlJywgdXRpbHMuY2xvbmUocmVzdWx0KSk7XG4gICAgfVxuICAgIHBlbmRpbmdCYXRjaC5zZXEgPSBjaGFuZ2Uuc2VxO1xuICAgIHBlbmRpbmdCYXRjaC5jaGFuZ2VzLnB1c2goY2hhbmdlKTtcbiAgICBwcm9jZXNzUGVuZGluZ0JhdGNoKGJhdGNoZXMubGVuZ3RoID09PSAwKTtcbiAgfVxuXG5cbiAgZnVuY3Rpb24gb25DaGFuZ2VzQ29tcGxldGUoY2hhbmdlcykge1xuICAgIGNoYW5nZXNQZW5kaW5nID0gZmFsc2U7XG4gICAgaWYgKHJldHVyblZhbHVlLmNhbmNlbGxlZCkge1xuICAgICAgcmV0dXJuIGNvbXBsZXRlUmVwbGljYXRpb24oKTtcbiAgICB9XG4gICAgaWYgKGNoYW5nZXNPcHRzLnNpbmNlIDwgY2hhbmdlcy5sYXN0X3NlcSkge1xuICAgICAgY2hhbmdlc09wdHMuc2luY2UgPSBjaGFuZ2VzLmxhc3Rfc2VxO1xuICAgICAgZ2V0Q2hhbmdlcygpO1xuICAgIH0gZWxzZSB7XG4gICAgICBpZiAoY29udGludW91cykge1xuICAgICAgICBjaGFuZ2VzT3B0cy5saXZlID0gdHJ1ZTtcbiAgICAgICAgZ2V0Q2hhbmdlcygpO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgY2hhbmdlc0NvbXBsZXRlZCA9IHRydWU7XG4gICAgICB9XG4gICAgfVxuICAgIHByb2Nlc3NQZW5kaW5nQmF0Y2godHJ1ZSk7XG4gIH1cblxuXG4gIGZ1bmN0aW9uIG9uQ2hhbmdlc0Vycm9yKGVycikge1xuICAgIGNoYW5nZXNQZW5kaW5nID0gZmFsc2U7XG4gICAgaWYgKHJldHVyblZhbHVlLmNhbmNlbGxlZCkge1xuICAgICAgcmV0dXJuIGNvbXBsZXRlUmVwbGljYXRpb24oKTtcbiAgICB9XG4gICAgYWJvcnRSZXBsaWNhdGlvbignY2hhbmdlcyByZWplY3RlZCcsIGVycik7XG4gIH1cblxuXG4gIGZ1bmN0aW9uIGdldENoYW5nZXMoKSB7XG4gICAgaWYgKCEoXG4gICAgICAhY2hhbmdlc1BlbmRpbmcgJiZcbiAgICAgICFjaGFuZ2VzQ29tcGxldGVkICYmXG4gICAgICBiYXRjaGVzLmxlbmd0aCA8IGJhdGNoZXNfbGltaXRcbiAgICApKSB7XG4gICAgICByZXR1cm47XG4gICAgfVxuICAgIGNoYW5nZXNQZW5kaW5nID0gdHJ1ZTtcbiAgICBmdW5jdGlvbiBhYm9ydENoYW5nZXMoKSB7XG4gICAgICBjaGFuZ2VzLmNhbmNlbCgpO1xuICAgIH1cbiAgICBmdW5jdGlvbiByZW1vdmVMaXN0ZW5lcigpIHtcbiAgICAgIHJldHVyblZhbHVlLnJlbW92ZUxpc3RlbmVyKCdjYW5jZWwnLCBhYm9ydENoYW5nZXMpO1xuICAgIH1cbiAgICByZXR1cm5WYWx1ZS5vbmNlKCdjYW5jZWwnLCBhYm9ydENoYW5nZXMpO1xuICAgIHZhciBjaGFuZ2VzID0gc3JjLmNoYW5nZXMoY2hhbmdlc09wdHMpXG4gICAgLm9uKCdjaGFuZ2UnLCBvbkNoYW5nZSk7XG4gICAgY2hhbmdlcy50aGVuKHJlbW92ZUxpc3RlbmVyLCByZW1vdmVMaXN0ZW5lcik7XG4gICAgY2hhbmdlcy50aGVuKG9uQ2hhbmdlc0NvbXBsZXRlKVtcbiAgICBcImNhdGNoXCJdKG9uQ2hhbmdlc0Vycm9yKTtcbiAgfVxuXG5cbiAgZnVuY3Rpb24gc3RhcnRDaGFuZ2VzKCkge1xuICAgIGNoZWNrcG9pbnRlci5nZXRDaGVja3BvaW50KCkudGhlbihmdW5jdGlvbiAoY2hlY2twb2ludCkge1xuICAgICAgbGFzdF9zZXEgPSBjaGVja3BvaW50O1xuICAgICAgY2hhbmdlc09wdHMgPSB7XG4gICAgICAgIHNpbmNlOiBsYXN0X3NlcSxcbiAgICAgICAgbGltaXQ6IGJhdGNoX3NpemUsXG4gICAgICAgIGJhdGNoX3NpemU6IGJhdGNoX3NpemUsXG4gICAgICAgIHN0eWxlOiAnYWxsX2RvY3MnLFxuICAgICAgICBkb2NfaWRzOiBkb2NfaWRzLFxuICAgICAgICByZXR1cm5Eb2NzOiBmYWxzZVxuICAgICAgfTtcbiAgICAgIGlmIChvcHRzLmZpbHRlcikge1xuICAgICAgICBjaGFuZ2VzT3B0cy5maWx0ZXIgPSBvcHRzLmZpbHRlcjtcbiAgICAgIH1cbiAgICAgIGlmIChvcHRzLnF1ZXJ5X3BhcmFtcykge1xuICAgICAgICBjaGFuZ2VzT3B0cy5xdWVyeV9wYXJhbXMgPSBvcHRzLnF1ZXJ5X3BhcmFtcztcbiAgICAgIH1cbiAgICAgIGdldENoYW5nZXMoKTtcbiAgICB9KVtcImNhdGNoXCJdKGZ1bmN0aW9uIChlcnIpIHtcbiAgICAgIGFib3J0UmVwbGljYXRpb24oJ2dldENoZWNrcG9pbnQgcmVqZWN0ZWQgd2l0aCAnLCBlcnIpO1xuICAgIH0pO1xuICB9XG5cblxuICByZXR1cm5WYWx1ZS5vbmNlKCdjYW5jZWwnLCBjb21wbGV0ZVJlcGxpY2F0aW9uKTtcblxuICBpZiAodHlwZW9mIG9wdHMub25DaGFuZ2UgPT09ICdmdW5jdGlvbicpIHtcbiAgICByZXR1cm5WYWx1ZS5vbignY2hhbmdlJywgb3B0cy5vbkNoYW5nZSk7XG4gIH1cblxuICBpZiAodHlwZW9mIG9wdHMuY29tcGxldGUgPT09ICdmdW5jdGlvbicpIHtcbiAgICByZXR1cm5WYWx1ZS5vbmNlKCdlcnJvcicsIG9wdHMuY29tcGxldGUpO1xuICAgIHJldHVyblZhbHVlLm9uY2UoJ2NvbXBsZXRlJywgZnVuY3Rpb24gKHJlc3VsdCkge1xuICAgICAgb3B0cy5jb21wbGV0ZShudWxsLCByZXN1bHQpO1xuICAgIH0pO1xuICB9XG5cbiAgaWYgKHR5cGVvZiBvcHRzLnNpbmNlID09PSAndW5kZWZpbmVkJykge1xuICAgIHN0YXJ0Q2hhbmdlcygpO1xuICB9IGVsc2Uge1xuICAgIHdyaXRpbmdDaGVja3BvaW50ID0gdHJ1ZTtcbiAgICBjaGVja3BvaW50ZXIud3JpdGVDaGVja3BvaW50KG9wdHMuc2luY2UpLnRoZW4oZnVuY3Rpb24gKHJlcykge1xuICAgICAgd3JpdGluZ0NoZWNrcG9pbnQgPSBmYWxzZTtcbiAgICAgIGlmIChyZXR1cm5WYWx1ZS5jYW5jZWxsZWQpIHtcbiAgICAgICAgY29tcGxldGVSZXBsaWNhdGlvbigpO1xuICAgICAgICByZXR1cm47XG4gICAgICB9XG4gICAgICBsYXN0X3NlcSA9IG9wdHMuc2luY2U7XG4gICAgICBzdGFydENoYW5nZXMoKTtcbiAgICB9KVtcImNhdGNoXCJdKGZ1bmN0aW9uIChlcnIpIHtcbiAgICAgIHdyaXRpbmdDaGVja3BvaW50ID0gZmFsc2U7XG4gICAgICBhYm9ydFJlcGxpY2F0aW9uKCd3cml0ZUNoZWNrcG9pbnQgY29tcGxldGVkIHdpdGggZXJyb3InLCBlcnIpO1xuICAgICAgdGhyb3cgZXJyO1xuICAgIH0pO1xuICB9XG59XG5cbmV4cG9ydHMudG9Qb3VjaCA9IHRvUG91Y2g7XG5mdW5jdGlvbiB0b1BvdWNoKGRiLCBvcHRzKSB7XG4gIHZhciBQb3VjaENvbnN0cnVjdG9yID0gb3B0cy5Qb3VjaENvbnN0cnVjdG9yO1xuICBpZiAodHlwZW9mIGRiID09PSAnc3RyaW5nJykge1xuICAgIHJldHVybiBuZXcgUG91Y2hDb25zdHJ1Y3RvcihkYik7XG4gIH0gZWxzZSBpZiAoZGIudGhlbikge1xuICAgIHJldHVybiBkYjtcbiAgfSBlbHNlIHtcbiAgICByZXR1cm4gdXRpbHMuUHJvbWlzZS5yZXNvbHZlKGRiKTtcbiAgfVxufVxuXG5cbmV4cG9ydHMucmVwbGljYXRlID0gcmVwbGljYXRlV3JhcHBlcjtcbmZ1bmN0aW9uIHJlcGxpY2F0ZVdyYXBwZXIoc3JjLCB0YXJnZXQsIG9wdHMsIGNhbGxiYWNrKSB7XG4gIGlmICh0eXBlb2Ygb3B0cyA9PT0gJ2Z1bmN0aW9uJykge1xuICAgIGNhbGxiYWNrID0gb3B0cztcbiAgICBvcHRzID0ge307XG4gIH1cbiAgaWYgKHR5cGVvZiBvcHRzID09PSAndW5kZWZpbmVkJykge1xuICAgIG9wdHMgPSB7fTtcbiAgfVxuICBpZiAoIW9wdHMuY29tcGxldGUpIHtcbiAgICBvcHRzLmNvbXBsZXRlID0gY2FsbGJhY2sgfHwgZnVuY3Rpb24gKCkge307XG4gIH1cbiAgb3B0cyA9IHV0aWxzLmNsb25lKG9wdHMpO1xuICBvcHRzLmNvbnRpbnVvdXMgPSBvcHRzLmNvbnRpbnVvdXMgfHwgb3B0cy5saXZlO1xuICAvKmpzaGludCB2YWxpZHRoaXM6dHJ1ZSAqL1xuICBvcHRzLlBvdWNoQ29uc3RydWN0b3IgPSBvcHRzLlBvdWNoQ29uc3RydWN0b3IgfHwgdGhpcztcbiAgdmFyIHJlcGxpY2F0ZVJldCA9IG5ldyBSZXBsaWNhdGlvbihvcHRzKTtcbiAgdG9Qb3VjaChzcmMsIG9wdHMpLnRoZW4oZnVuY3Rpb24gKHNyYykge1xuICAgIHJldHVybiB0b1BvdWNoKHRhcmdldCwgb3B0cykudGhlbihmdW5jdGlvbiAodGFyZ2V0KSB7XG4gICAgICByZXR1cm4gZ2VuUmVwbGljYXRpb25JZChzcmMsIHRhcmdldCwgb3B0cykudGhlbihmdW5jdGlvbiAocmVwSWQpIHtcbiAgICAgICAgcmVwbGljYXRlKHJlcElkLCBzcmMsIHRhcmdldCwgb3B0cywgcmVwbGljYXRlUmV0KTtcbiAgICAgIH0pO1xuICAgIH0pO1xuICB9KVtcImNhdGNoXCJdKGZ1bmN0aW9uIChlcnIpIHtcbiAgICByZXBsaWNhdGVSZXQuZW1pdCgnZXJyb3InLCBlcnIpO1xuICAgIG9wdHMuY29tcGxldGUoZXJyKTtcbiAgfSk7XG4gIHJldHVybiByZXBsaWNhdGVSZXQ7XG59XG5cbn0se1wiLi91dGlsc1wiOjIzLFwiZXZlbnRzXCI6Mjd9XSwyMDpbZnVuY3Rpb24oX2RlcmVxXyxtb2R1bGUsZXhwb3J0cyl7XG4oZnVuY3Rpb24gKGdsb2JhbCl7XG5cInVzZSBzdHJpY3RcIjtcblxudmFyIFBvdWNoREIgPSBfZGVyZXFfKFwiLi9jb25zdHJ1Y3RvclwiKTtcbnZhciB1dGlscyA9IF9kZXJlcV8oJy4vdXRpbHMnKTtcbnZhciBQcm9taXNlID0gdXRpbHMuUHJvbWlzZTtcbnZhciBFdmVudEVtaXR0ZXIgPSBfZGVyZXFfKCdldmVudHMnKS5FdmVudEVtaXR0ZXI7XG5Qb3VjaERCLmFkYXB0ZXJzID0ge307XG5Qb3VjaERCLnByZWZlcnJlZEFkYXB0ZXJzID0gX2RlcmVxXygnLi9hZGFwdGVycy9wcmVmZXJyZWRBZGFwdGVycy5qcycpO1xuXG5Qb3VjaERCLnByZWZpeCA9ICdfcG91Y2hfJztcblxudmFyIGV2ZW50RW1pdHRlciA9IG5ldyBFdmVudEVtaXR0ZXIoKTtcblxudmFyIGV2ZW50RW1pdHRlck1ldGhvZHMgPSBbXG4gICdvbicsXG4gICdhZGRMaXN0ZW5lcicsXG4gICdlbWl0JyxcbiAgJ2xpc3RlbmVycycsXG4gICdvbmNlJyxcbiAgJ3JlbW92ZUFsbExpc3RlbmVycycsXG4gICdyZW1vdmVMaXN0ZW5lcicsXG4gICdzZXRNYXhMaXN0ZW5lcnMnXG5dO1xuXG5ldmVudEVtaXR0ZXJNZXRob2RzLmZvckVhY2goZnVuY3Rpb24gKG1ldGhvZCkge1xuICBQb3VjaERCW21ldGhvZF0gPSBldmVudEVtaXR0ZXJbbWV0aG9kXS5iaW5kKGV2ZW50RW1pdHRlcik7XG59KTtcblBvdWNoREIuc2V0TWF4TGlzdGVuZXJzKDApO1xuUG91Y2hEQi5wYXJzZUFkYXB0ZXIgPSBmdW5jdGlvbiAobmFtZSwgb3B0cykge1xuICB2YXIgbWF0Y2ggPSBuYW1lLm1hdGNoKC8oW2EtelxcLV0qKTpcXC9cXC8oLiopLyk7XG4gIHZhciBhZGFwdGVyLCBhZGFwdGVyTmFtZTtcbiAgaWYgKG1hdGNoKSB7XG4gICAgLy8gdGhlIGh0dHAgYWRhcHRlciBleHBlY3RzIHRoZSBmdWxseSBxdWFsaWZpZWQgbmFtZVxuICAgIG5hbWUgPSAvaHR0cChzPykvLnRlc3QobWF0Y2hbMV0pID8gbWF0Y2hbMV0gKyAnOi8vJyArIG1hdGNoWzJdIDogbWF0Y2hbMl07XG4gICAgYWRhcHRlciA9IG1hdGNoWzFdO1xuICAgIGlmICghUG91Y2hEQi5hZGFwdGVyc1thZGFwdGVyXS52YWxpZCgpKSB7XG4gICAgICB0aHJvdyAnSW52YWxpZCBhZGFwdGVyJztcbiAgICB9XG4gICAgcmV0dXJuIHtuYW1lOiBuYW1lLCBhZGFwdGVyOiBtYXRjaFsxXX07XG4gIH1cblxuICAvLyBjaGVjayBmb3IgYnJvd3NlcnMgdGhhdCBoYXZlIGJlZW4gdXBncmFkZWQgZnJvbSB3ZWJzcWwtb25seSB0byB3ZWJzcWwraWRiXG4gIHZhciBza2lwSWRiID0gJ2lkYicgaW4gUG91Y2hEQi5hZGFwdGVycyAmJiAnd2Vic3FsJyBpbiBQb3VjaERCLmFkYXB0ZXJzICYmXG4gICAgdXRpbHMuaGFzTG9jYWxTdG9yYWdlKCkgJiZcbiAgICBnbG9iYWwubG9jYWxTdG9yYWdlWydfcG91Y2hfX3dlYnNxbGRiXycgKyBQb3VjaERCLnByZWZpeCArIG5hbWVdO1xuXG4gIGlmICh0eXBlb2Ygb3B0cyAhPT0gJ3VuZGVmaW5lZCcgJiYgb3B0cy5kYikge1xuICAgIGFkYXB0ZXJOYW1lID0gJ2xldmVsZGInO1xuICB9IGVsc2Uge1xuICAgIGZvciAodmFyIGkgPSAwOyBpIDwgUG91Y2hEQi5wcmVmZXJyZWRBZGFwdGVycy5sZW5ndGg7ICsraSkge1xuICAgICAgYWRhcHRlck5hbWUgPSBQb3VjaERCLnByZWZlcnJlZEFkYXB0ZXJzW2ldO1xuICAgICAgaWYgKGFkYXB0ZXJOYW1lIGluIFBvdWNoREIuYWRhcHRlcnMpIHtcbiAgICAgICAgaWYgKHNraXBJZGIgJiYgYWRhcHRlck5hbWUgPT09ICdpZGInKSB7XG4gICAgICAgICAgY29udGludWU7IC8vIGtlZXAgdXNpbmcgd2Vic3FsIHRvIGF2b2lkIHVzZXIgZGF0YSBsb3NzXG4gICAgICAgIH1cbiAgICAgICAgYnJlYWs7XG4gICAgICB9XG4gICAgfVxuICB9XG5cbiAgYWRhcHRlciA9IFBvdWNoREIuYWRhcHRlcnNbYWRhcHRlck5hbWVdO1xuICBpZiAoYWRhcHRlck5hbWUgJiYgYWRhcHRlcikge1xuICAgIHZhciB1c2VfcHJlZml4ID0gJ3VzZV9wcmVmaXgnIGluIGFkYXB0ZXIgPyBhZGFwdGVyLnVzZV9wcmVmaXggOiB0cnVlO1xuXG4gICAgcmV0dXJuIHtcbiAgICAgIG5hbWU6IHVzZV9wcmVmaXggPyBQb3VjaERCLnByZWZpeCArIG5hbWUgOiBuYW1lLFxuICAgICAgYWRhcHRlcjogYWRhcHRlck5hbWVcbiAgICB9O1xuICB9XG5cbiAgdGhyb3cgJ05vIHZhbGlkIGFkYXB0ZXIgZm91bmQnO1xufTtcblxuUG91Y2hEQi5kZXN0cm95ID0gdXRpbHMudG9Qcm9taXNlKGZ1bmN0aW9uIChuYW1lLCBvcHRzLCBjYWxsYmFjaykge1xuICBpZiAodHlwZW9mIG9wdHMgPT09ICdmdW5jdGlvbicgfHwgdHlwZW9mIG9wdHMgPT09ICd1bmRlZmluZWQnKSB7XG4gICAgY2FsbGJhY2sgPSBvcHRzO1xuICAgIG9wdHMgPSB7fTtcbiAgfVxuXG4gIGlmIChuYW1lICYmIHR5cGVvZiBuYW1lID09PSAnb2JqZWN0Jykge1xuICAgIG9wdHMgPSBuYW1lO1xuICAgIG5hbWUgPSB1bmRlZmluZWQ7XG4gIH1cblxuICB2YXIgYmFja2VuZCA9IFBvdWNoREIucGFyc2VBZGFwdGVyKG9wdHMubmFtZSB8fCBuYW1lLCBvcHRzKTtcbiAgdmFyIGRiTmFtZSA9IGJhY2tlbmQubmFtZTtcbiAgdmFyIGFkYXB0ZXIgPSBQb3VjaERCLmFkYXB0ZXJzW2JhY2tlbmQuYWRhcHRlcl07XG4gIHZhciB1c2VQcmVmaXggPSAndXNlX3ByZWZpeCcgaW4gYWRhcHRlciA/IGFkYXB0ZXIudXNlX3ByZWZpeCA6IHRydWU7XG4gIHZhciBiYXNlTmFtZSA9IHVzZVByZWZpeCA/XG4gICAgZGJOYW1lLnJlcGxhY2UobmV3IFJlZ0V4cCgnXicgKyBQb3VjaERCLnByZWZpeCksICcnKSA6IGRiTmFtZTtcbiAgdmFyIGZ1bGxOYW1lID0gKGJhY2tlbmQuYWRhcHRlciA9PT0gJ2h0dHAnIHx8IGJhY2tlbmQuYWRhcHRlciA9PT0gJ2h0dHBzJyA/XG4gICAgICAnJyA6IChvcHRzLnByZWZpeCB8fCAnJykpICsgZGJOYW1lO1xuICBmdW5jdGlvbiBkZXN0cm95RGIoKSB7XG4gICAgLy8gY2FsbCBkZXN0cm95IG1ldGhvZCBvZiB0aGUgcGFydGljdWxhciBhZGFwdG9yXG4gICAgYWRhcHRlci5kZXN0cm95KGZ1bGxOYW1lLCBvcHRzLCBmdW5jdGlvbiAoZXJyLCByZXNwKSB7XG4gICAgICBpZiAoZXJyKSB7XG4gICAgICAgIGNhbGxiYWNrKGVycik7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICBQb3VjaERCLmVtaXQoJ2Rlc3Ryb3llZCcsIG5hbWUpO1xuICAgICAgICAvL3NvIHdlIGRvbid0IGhhdmUgdG8gc2lmdCB0aHJvdWdoIGFsbCBkYm5hbWVzXG4gICAgICAgIFBvdWNoREIuZW1pdChuYW1lLCAnZGVzdHJveWVkJyk7XG4gICAgICAgIGNhbGxiYWNrKG51bGwsIHJlc3AgfHwgeyAnb2snOiB0cnVlIH0pO1xuICAgICAgfVxuICAgIH0pO1xuICB9XG5cbiAgdmFyIGNyZWF0ZU9wdHMgPSB1dGlscy5leHRlbmQodHJ1ZSwge30sIG9wdHMsIHthZGFwdGVyIDogYmFja2VuZC5hZGFwdGVyfSk7XG4gIG5ldyBQb3VjaERCKGJhc2VOYW1lLCBjcmVhdGVPcHRzLCBmdW5jdGlvbiAoZXJyLCBkYikge1xuICAgIGlmIChlcnIpIHtcbiAgICAgIHJldHVybiBjYWxsYmFjayhlcnIpO1xuICAgIH1cbiAgICBkYi5nZXQoJ19sb2NhbC9fcG91Y2hfZGVwZW5kZW50RGJzJywgZnVuY3Rpb24gKGVyciwgbG9jYWxEb2MpIHtcbiAgICAgIGlmIChlcnIpIHtcbiAgICAgICAgaWYgKGVyci5zdGF0dXMgIT09IDQwNCkge1xuICAgICAgICAgIHJldHVybiBjYWxsYmFjayhlcnIpO1xuICAgICAgICB9IGVsc2UgeyAvLyBubyBkZXBlbmRlbmNpZXNcbiAgICAgICAgICByZXR1cm4gZGVzdHJveURiKCk7XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICAgIHZhciBkZXBlbmRlbnREYnMgPSBsb2NhbERvYy5kZXBlbmRlbnREYnM7XG4gICAgICB2YXIgZGVsZXRlZE1hcCA9IE9iamVjdC5rZXlzKGRlcGVuZGVudERicykubWFwKGZ1bmN0aW9uIChuYW1lKSB7XG4gICAgICAgIHZhciB0cnVlTmFtZSA9IHVzZVByZWZpeCA/XG4gICAgICAgICAgbmFtZS5yZXBsYWNlKG5ldyBSZWdFeHAoJ14nICsgUG91Y2hEQi5wcmVmaXgpLCAnJykgOiBuYW1lO1xuICAgICAgICB2YXIgc3ViT3B0cyA9IHV0aWxzLmV4dGVuZCh0cnVlLCBvcHRzLCB7YWRhcHRlcjogYmFja2VuZC5hZGFwdGVyfSk7XG4gICAgICAgIHJldHVybiBQb3VjaERCLmRlc3Ryb3kodHJ1ZU5hbWUsIHN1Yk9wdHMpO1xuICAgICAgfSk7XG4gICAgICBQcm9taXNlLmFsbChkZWxldGVkTWFwKS50aGVuKGRlc3Ryb3lEYiwgZnVuY3Rpb24gKGVycm9yKSB7XG4gICAgICAgIGNhbGxiYWNrKGVycm9yKTtcbiAgICAgIH0pO1xuICAgIH0pO1xuICB9KTtcbn0pO1xuXG5Qb3VjaERCLmFsbERicyA9IHV0aWxzLnRvUHJvbWlzZShmdW5jdGlvbiAoY2FsbGJhY2spIHtcbiAgdmFyIGVyciA9IG5ldyBFcnJvcignYWxsRGJzIG1ldGhvZCByZW1vdmVkJyk7XG4gIGVyci5zdGF0cyA9ICc0MDAnO1xuICBjYWxsYmFjayhlcnIpO1xufSk7XG5Qb3VjaERCLmFkYXB0ZXIgPSBmdW5jdGlvbiAoaWQsIG9iaikge1xuICBpZiAob2JqLnZhbGlkKCkpIHtcbiAgICBQb3VjaERCLmFkYXB0ZXJzW2lkXSA9IG9iajtcbiAgfVxufTtcblxuUG91Y2hEQi5wbHVnaW4gPSBmdW5jdGlvbiAob2JqKSB7XG4gIE9iamVjdC5rZXlzKG9iaikuZm9yRWFjaChmdW5jdGlvbiAoaWQpIHtcbiAgICBQb3VjaERCLnByb3RvdHlwZVtpZF0gPSBvYmpbaWRdO1xuICB9KTtcbn07XG5cblBvdWNoREIuZGVmYXVsdHMgPSBmdW5jdGlvbiAoZGVmYXVsdE9wdHMpIHtcbiAgZnVuY3Rpb24gUG91Y2hBbHQobmFtZSwgb3B0cywgY2FsbGJhY2spIHtcbiAgICBpZiAodHlwZW9mIG9wdHMgPT09ICdmdW5jdGlvbicgfHwgdHlwZW9mIG9wdHMgPT09ICd1bmRlZmluZWQnKSB7XG4gICAgICBjYWxsYmFjayA9IG9wdHM7XG4gICAgICBvcHRzID0ge307XG4gICAgfVxuICAgIGlmIChuYW1lICYmIHR5cGVvZiBuYW1lID09PSAnb2JqZWN0Jykge1xuICAgICAgb3B0cyA9IG5hbWU7XG4gICAgICBuYW1lID0gdW5kZWZpbmVkO1xuICAgIH1cblxuICAgIG9wdHMgPSB1dGlscy5leHRlbmQodHJ1ZSwge30sIGRlZmF1bHRPcHRzLCBvcHRzKTtcbiAgICBQb3VjaERCLmNhbGwodGhpcywgbmFtZSwgb3B0cywgY2FsbGJhY2spO1xuICB9XG5cbiAgdXRpbHMuaW5oZXJpdHMoUG91Y2hBbHQsIFBvdWNoREIpO1xuXG4gIFBvdWNoQWx0LmRlc3Ryb3kgPSB1dGlscy50b1Byb21pc2UoZnVuY3Rpb24gKG5hbWUsIG9wdHMsIGNhbGxiYWNrKSB7XG4gICAgaWYgKHR5cGVvZiBvcHRzID09PSAnZnVuY3Rpb24nIHx8IHR5cGVvZiBvcHRzID09PSAndW5kZWZpbmVkJykge1xuICAgICAgY2FsbGJhY2sgPSBvcHRzO1xuICAgICAgb3B0cyA9IHt9O1xuICAgIH1cblxuICAgIGlmIChuYW1lICYmIHR5cGVvZiBuYW1lID09PSAnb2JqZWN0Jykge1xuICAgICAgb3B0cyA9IG5hbWU7XG4gICAgICBuYW1lID0gdW5kZWZpbmVkO1xuICAgIH1cbiAgICBvcHRzID0gdXRpbHMuZXh0ZW5kKHRydWUsIHt9LCBkZWZhdWx0T3B0cywgb3B0cyk7XG4gICAgcmV0dXJuIFBvdWNoREIuZGVzdHJveShuYW1lLCBvcHRzLCBjYWxsYmFjayk7XG4gIH0pO1xuXG4gIGV2ZW50RW1pdHRlck1ldGhvZHMuZm9yRWFjaChmdW5jdGlvbiAobWV0aG9kKSB7XG4gICAgUG91Y2hBbHRbbWV0aG9kXSA9IGV2ZW50RW1pdHRlclttZXRob2RdLmJpbmQoZXZlbnRFbWl0dGVyKTtcbiAgfSk7XG4gIFBvdWNoQWx0LnNldE1heExpc3RlbmVycygwKTtcblxuICBQb3VjaEFsdC5wcmVmZXJyZWRBZGFwdGVycyA9IFBvdWNoREIucHJlZmVycmVkQWRhcHRlcnMuc2xpY2UoKTtcbiAgT2JqZWN0LmtleXMoUG91Y2hEQikuZm9yRWFjaChmdW5jdGlvbiAoa2V5KSB7XG4gICAgaWYgKCEoa2V5IGluIFBvdWNoQWx0KSkge1xuICAgICAgUG91Y2hBbHRba2V5XSA9IFBvdWNoREJba2V5XTtcbiAgICB9XG4gIH0pO1xuXG4gIHJldHVybiBQb3VjaEFsdDtcbn07XG5cbm1vZHVsZS5leHBvcnRzID0gUG91Y2hEQjtcblxufSkuY2FsbCh0aGlzLHR5cGVvZiBzZWxmICE9PSBcInVuZGVmaW5lZFwiID8gc2VsZiA6IHR5cGVvZiB3aW5kb3cgIT09IFwidW5kZWZpbmVkXCIgPyB3aW5kb3cgOiB7fSlcbn0se1wiLi9hZGFwdGVycy9wcmVmZXJyZWRBZGFwdGVycy5qc1wiOjQsXCIuL2NvbnN0cnVjdG9yXCI6NyxcIi4vdXRpbHNcIjoyMyxcImV2ZW50c1wiOjI3fV0sMjE6W2Z1bmN0aW9uKF9kZXJlcV8sbW9kdWxlLGV4cG9ydHMpe1xuJ3VzZSBzdHJpY3QnO1xudmFyIHV0aWxzID0gX2RlcmVxXygnLi91dGlscycpO1xudmFyIHJlcGxpY2F0aW9uID0gX2RlcmVxXygnLi9yZXBsaWNhdGUnKTtcbnZhciByZXBsaWNhdGUgPSByZXBsaWNhdGlvbi5yZXBsaWNhdGU7XG52YXIgRUUgPSBfZGVyZXFfKCdldmVudHMnKS5FdmVudEVtaXR0ZXI7XG5cbnV0aWxzLmluaGVyaXRzKFN5bmMsIEVFKTtcbm1vZHVsZS5leHBvcnRzID0gc3luYztcbmZ1bmN0aW9uIHN5bmMoc3JjLCB0YXJnZXQsIG9wdHMsIGNhbGxiYWNrKSB7XG4gIGlmICh0eXBlb2Ygb3B0cyA9PT0gJ2Z1bmN0aW9uJykge1xuICAgIGNhbGxiYWNrID0gb3B0cztcbiAgICBvcHRzID0ge307XG4gIH1cbiAgaWYgKHR5cGVvZiBvcHRzID09PSAndW5kZWZpbmVkJykge1xuICAgIG9wdHMgPSB7fTtcbiAgfVxuICBvcHRzID0gdXRpbHMuY2xvbmUob3B0cyk7XG4gIC8qanNoaW50IHZhbGlkdGhpczp0cnVlICovXG4gIG9wdHMuUG91Y2hDb25zdHJ1Y3RvciA9IG9wdHMuUG91Y2hDb25zdHJ1Y3RvciB8fCB0aGlzO1xuICBzcmMgPSByZXBsaWNhdGlvbi50b1BvdWNoKHNyYywgb3B0cyk7XG4gIHRhcmdldCA9IHJlcGxpY2F0aW9uLnRvUG91Y2godGFyZ2V0LCBvcHRzKTtcbiAgcmV0dXJuIG5ldyBTeW5jKHNyYywgdGFyZ2V0LCBvcHRzLCBjYWxsYmFjayk7XG59XG5mdW5jdGlvbiBTeW5jKHNyYywgdGFyZ2V0LCBvcHRzLCBjYWxsYmFjaykge1xuICB2YXIgc2VsZiA9IHRoaXM7XG4gIHRoaXMuY2FuY2VsZWQgPSBmYWxzZTtcbiAgXG4gIHZhciBvbkNoYW5nZSwgY29tcGxldGU7XG4gIGlmICgnb25DaGFuZ2UnIGluIG9wdHMpIHtcbiAgICBvbkNoYW5nZSA9IG9wdHMub25DaGFuZ2U7XG4gICAgZGVsZXRlIG9wdHMub25DaGFuZ2U7XG4gIH1cbiAgaWYgKHR5cGVvZiBjYWxsYmFjayA9PT0gJ2Z1bmN0aW9uJyAmJiAhb3B0cy5jb21wbGV0ZSkge1xuICAgIGNvbXBsZXRlID0gY2FsbGJhY2s7XG4gIH0gZWxzZSBpZiAoJ2NvbXBsZXRlJyBpbiBvcHRzKSB7XG4gICAgY29tcGxldGUgPSBvcHRzLmNvbXBsZXRlO1xuICAgIGRlbGV0ZSBvcHRzLmNvbXBsZXRlO1xuICB9XG5cbiAgdGhpcy5wdXNoID0gcmVwbGljYXRlKHNyYywgdGFyZ2V0LCBvcHRzKTtcblxuICB0aGlzLnB1bGwgPSByZXBsaWNhdGUodGFyZ2V0LCBzcmMsIG9wdHMpO1xuICB2YXIgZW1pdHRlZENhbmNlbCA9IGZhbHNlO1xuICBmdW5jdGlvbiBvbkNhbmNlbChkYXRhKSB7XG4gICAgaWYgKCFlbWl0dGVkQ2FuY2VsKSB7XG4gICAgICBlbWl0dGVkQ2FuY2VsID0gdHJ1ZTtcbiAgICAgIHNlbGYuZW1pdCgnY2FuY2VsJywgZGF0YSk7XG4gICAgfVxuICB9XG5cbiAgZnVuY3Rpb24gcHVsbENoYW5nZShjaGFuZ2UpIHtcbiAgICBzZWxmLmVtaXQoJ2NoYW5nZScsIHtcbiAgICAgIGRpcmVjdGlvbjogJ3B1bGwnLFxuICAgICAgY2hhbmdlOiBjaGFuZ2VcbiAgICB9KTtcbiAgfVxuICBmdW5jdGlvbiBwdXNoQ2hhbmdlKGNoYW5nZSkge1xuICAgIHNlbGYuZW1pdCgnY2hhbmdlJywge1xuICAgICAgZGlyZWN0aW9uOiAncHVzaCcsXG4gICAgICBjaGFuZ2U6IGNoYW5nZVxuICAgIH0pO1xuICB9XG4gIHZhciBsaXN0ZW5lcnMgPSB7fTtcblxuICB2YXIgcmVtb3ZlZCA9IHt9O1xuICBmdW5jdGlvbiByZW1vdmVBbGwodHlwZSkgeyAvLyB0eXBlIGlzICdwdXNoJyBvciAncHVsbCdcbiAgICByZXR1cm4gZnVuY3Rpb24gKGV2ZW50LCBmdW5jKSB7XG4gICAgICB2YXIgaXNDaGFuZ2UgPSBldmVudCA9PT0gJ2NoYW5nZScgJiZcbiAgICAgICAgKGZ1bmMgPT09IHB1bGxDaGFuZ2UgfHwgZnVuYyA9PT0gcHVzaENoYW5nZSk7XG4gICAgICB2YXIgaXNDYW5jZWwgPSBldmVudCA9PT0gJ2NhbmNlbCcgJiYgZnVuYyA9PT0gb25DYW5jZWw7XG4gICAgICB2YXIgaXNPdGhlckV2ZW50ID0gZXZlbnQgaW4gbGlzdGVuZXJzICYmIGZ1bmMgPT09IGxpc3RlbmVyc1tldmVudF07XG5cbiAgICAgIGlmIChpc0NoYW5nZSB8fCBpc0NhbmNlbCB8fCBpc090aGVyRXZlbnQpIHtcbiAgICAgICAgaWYgKCEoZXZlbnQgaW4gcmVtb3ZlZCkpIHtcbiAgICAgICAgICByZW1vdmVkW2V2ZW50XSA9IHt9O1xuICAgICAgICB9XG4gICAgICAgIHJlbW92ZWRbZXZlbnRdW3R5cGVdID0gdHJ1ZTtcbiAgICAgICAgaWYgKE9iamVjdC5rZXlzKHJlbW92ZWRbZXZlbnRdKS5sZW5ndGggPT09IDIpIHtcbiAgICAgICAgICAvLyBib3RoIHB1c2ggYW5kIHB1bGwgaGF2ZSBhc2tlZCB0byBiZSByZW1vdmVkXG4gICAgICAgICAgc2VsZi5yZW1vdmVBbGxMaXN0ZW5lcnMoZXZlbnQpO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgfTtcbiAgfVxuXG4gIHRoaXMub24oJ25ld0xpc3RlbmVyJywgZnVuY3Rpb24gKGV2ZW50KSB7XG4gICAgaWYgKGV2ZW50ID09PSAnY2hhbmdlJykge1xuICAgICAgc2VsZi5wdWxsLm9uKCdjaGFuZ2UnLCBwdWxsQ2hhbmdlKTtcbiAgICAgIHNlbGYucHVzaC5vbignY2hhbmdlJywgcHVzaENoYW5nZSk7XG4gICAgfSBlbHNlIGlmIChldmVudCA9PT0gJ2NhbmNlbCcpIHtcbiAgICAgIHNlbGYucHVsbC5vbignY2FuY2VsJywgb25DYW5jZWwpO1xuICAgICAgc2VsZi5wdXNoLm9uKCdjYW5jZWwnLCBvbkNhbmNlbCk7XG4gICAgfSBlbHNlIGlmIChldmVudCAhPT0gJ2Vycm9yJyAmJlxuICAgICAgZXZlbnQgIT09ICdyZW1vdmVMaXN0ZW5lcicgJiZcbiAgICAgIGV2ZW50ICE9PSAnY29tcGxldGUnICYmICEoZXZlbnQgaW4gbGlzdGVuZXJzKSkge1xuICAgICAgbGlzdGVuZXJzW2V2ZW50XSA9IGZ1bmN0aW9uIChlKSB7XG4gICAgICAgIHNlbGYuZW1pdChldmVudCwgZSk7XG4gICAgICB9O1xuICAgICAgc2VsZi5wdWxsLm9uKGV2ZW50LCBsaXN0ZW5lcnNbZXZlbnRdKTtcbiAgICAgIHNlbGYucHVzaC5vbihldmVudCwgbGlzdGVuZXJzW2V2ZW50XSk7XG4gICAgfVxuICB9KTtcblxuICB0aGlzLm9uKCdyZW1vdmVMaXN0ZW5lcicsIGZ1bmN0aW9uIChldmVudCkge1xuICAgIGlmIChldmVudCA9PT0gJ2NoYW5nZScpIHtcbiAgICAgIHNlbGYucHVsbC5yZW1vdmVMaXN0ZW5lcignY2hhbmdlJywgcHVsbENoYW5nZSk7XG4gICAgICBzZWxmLnB1c2gucmVtb3ZlTGlzdGVuZXIoJ2NoYW5nZScsIHB1c2hDaGFuZ2UpO1xuICAgIH0gZWxzZSBpZiAoZXZlbnQgPT09ICdjYW5jZWwnKSB7XG4gICAgICBzZWxmLnB1bGwucmVtb3ZlTGlzdGVuZXIoJ2NhbmNlbCcsIG9uQ2FuY2VsKTtcbiAgICAgIHNlbGYucHVzaC5yZW1vdmVMaXN0ZW5lcignY2FuY2VsJywgb25DYW5jZWwpO1xuICAgIH0gZWxzZSBpZiAoZXZlbnQgaW4gbGlzdGVuZXJzKSB7XG4gICAgICBpZiAodHlwZW9mIGxpc3RlbmVyc1tldmVudF0gPT09ICdmdW5jdGlvbicpIHtcbiAgICAgICAgc2VsZi5wdWxsLnJlbW92ZUxpc3RlbmVyKGV2ZW50LCBsaXN0ZW5lcnNbZXZlbnRdKTtcbiAgICAgICAgc2VsZi5wdXNoLnJlbW92ZUxpc3RlbmVyKGV2ZW50LCBsaXN0ZW5lcnNbZXZlbnRdKTtcbiAgICAgICAgZGVsZXRlIGxpc3RlbmVyc1tldmVudF07XG4gICAgICB9XG4gICAgfVxuICB9KTtcblxuICB0aGlzLnB1bGwub24oJ3JlbW92ZUxpc3RlbmVyJywgcmVtb3ZlQWxsKCdwdWxsJykpO1xuICB0aGlzLnB1c2gub24oJ3JlbW92ZUxpc3RlbmVyJywgcmVtb3ZlQWxsKCdwdXNoJykpO1xuXG4gIHZhciBwcm9taXNlID0gdXRpbHMuUHJvbWlzZS5hbGwoW1xuICAgIHRoaXMucHVzaCxcbiAgICB0aGlzLnB1bGxcbiAgXSkudGhlbihmdW5jdGlvbiAocmVzcCkge1xuICAgIHZhciBvdXQgPSB7XG4gICAgICBwdXNoOiByZXNwWzBdLFxuICAgICAgcHVsbDogcmVzcFsxXVxuICAgIH07XG4gICAgc2VsZi5lbWl0KCdjb21wbGV0ZScsIG91dCk7XG4gICAgaWYgKGNvbXBsZXRlKSB7XG4gICAgICBjb21wbGV0ZShudWxsLCBvdXQpO1xuICAgIH1cbiAgICBzZWxmLnJlbW92ZUFsbExpc3RlbmVycygpO1xuICAgIHJldHVybiBvdXQ7XG4gIH0sIGZ1bmN0aW9uIChlcnIpIHtcbiAgICBzZWxmLmNhbmNlbCgpO1xuICAgIHNlbGYuZW1pdCgnZXJyb3InLCBlcnIpO1xuICAgIGlmIChjb21wbGV0ZSkge1xuICAgICAgY29tcGxldGUoZXJyKTtcbiAgICB9XG4gICAgc2VsZi5yZW1vdmVBbGxMaXN0ZW5lcnMoKTtcbiAgICB0aHJvdyBlcnI7XG4gIH0pO1xuXG4gIHRoaXMudGhlbiA9IGZ1bmN0aW9uIChzdWNjZXNzLCBlcnIpIHtcbiAgICByZXR1cm4gcHJvbWlzZS50aGVuKHN1Y2Nlc3MsIGVycik7XG4gIH07XG5cbiAgdGhpc1tcImNhdGNoXCJdID0gZnVuY3Rpb24gKGVycikge1xuICAgIHJldHVybiBwcm9taXNlW1wiY2F0Y2hcIl0oZXJyKTtcbiAgfTtcbn1cblxuU3luYy5wcm90b3R5cGUuY2FuY2VsID0gZnVuY3Rpb24gKCkge1xuICBpZiAoIXRoaXMuY2FuY2VsZWQpIHtcbiAgICB0aGlzLmNhbmNlbGVkID0gdHJ1ZTtcbiAgICB0aGlzLnB1c2guY2FuY2VsKCk7XG4gICAgdGhpcy5wdWxsLmNhbmNlbCgpO1xuICB9XG59O1xuXG59LHtcIi4vcmVwbGljYXRlXCI6MTksXCIuL3V0aWxzXCI6MjMsXCJldmVudHNcIjoyN31dLDIyOltmdW5jdGlvbihfZGVyZXFfLG1vZHVsZSxleHBvcnRzKXtcbid1c2Ugc3RyaWN0JztcblxubW9kdWxlLmV4cG9ydHMgPSBUYXNrUXVldWU7XG5cbmZ1bmN0aW9uIFRhc2tRdWV1ZSgpIHtcbiAgdGhpcy5pc1JlYWR5ID0gZmFsc2U7XG4gIHRoaXMuZmFpbGVkID0gZmFsc2U7XG4gIHRoaXMucXVldWUgPSBbXTtcbn1cblxuVGFza1F1ZXVlLnByb3RvdHlwZS5leGVjdXRlID0gZnVuY3Rpb24gKCkge1xuICB2YXIgZCwgZnVuYztcbiAgaWYgKHRoaXMuZmFpbGVkKSB7XG4gICAgd2hpbGUgKChkID0gdGhpcy5xdWV1ZS5zaGlmdCgpKSkge1xuICAgICAgaWYgKHR5cGVvZiBkID09PSAnZnVuY3Rpb24nKSB7XG4gICAgICAgIGQodGhpcy5mYWlsZWQpO1xuICAgICAgICBjb250aW51ZTtcbiAgICAgIH1cbiAgICAgIGZ1bmMgPSBkLnBhcmFtZXRlcnNbZC5wYXJhbWV0ZXJzLmxlbmd0aCAtIDFdO1xuICAgICAgaWYgKHR5cGVvZiBmdW5jID09PSAnZnVuY3Rpb24nKSB7XG4gICAgICAgIGZ1bmModGhpcy5mYWlsZWQpO1xuICAgICAgfSBlbHNlIGlmIChkLm5hbWUgPT09ICdjaGFuZ2VzJyAmJiB0eXBlb2YgZnVuYy5jb21wbGV0ZSA9PT0gJ2Z1bmN0aW9uJykge1xuICAgICAgICBmdW5jLmNvbXBsZXRlKHRoaXMuZmFpbGVkKTtcbiAgICAgIH1cbiAgICB9XG4gIH0gZWxzZSBpZiAodGhpcy5pc1JlYWR5KSB7XG4gICAgd2hpbGUgKChkID0gdGhpcy5xdWV1ZS5zaGlmdCgpKSkge1xuXG4gICAgICBpZiAodHlwZW9mIGQgPT09ICdmdW5jdGlvbicpIHtcbiAgICAgICAgZCgpO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgZC50YXNrID0gdGhpcy5kYltkLm5hbWVdLmFwcGx5KHRoaXMuZGIsIGQucGFyYW1ldGVycyk7XG4gICAgICB9XG4gICAgfVxuICB9XG59O1xuXG5UYXNrUXVldWUucHJvdG90eXBlLmZhaWwgPSBmdW5jdGlvbiAoZXJyKSB7XG4gIHRoaXMuZmFpbGVkID0gZXJyO1xuICB0aGlzLmV4ZWN1dGUoKTtcbn07XG5cblRhc2tRdWV1ZS5wcm90b3R5cGUucmVhZHkgPSBmdW5jdGlvbiAoZGIpIHtcbiAgaWYgKHRoaXMuZmFpbGVkKSB7XG4gICAgcmV0dXJuIGZhbHNlO1xuICB9IGVsc2UgaWYgKGFyZ3VtZW50cy5sZW5ndGggPT09IDApIHtcbiAgICByZXR1cm4gdGhpcy5pc1JlYWR5O1xuICB9XG4gIHRoaXMuaXNSZWFkeSA9IGRiID8gdHJ1ZTogZmFsc2U7XG4gIHRoaXMuZGIgPSBkYjtcbiAgdGhpcy5leGVjdXRlKCk7XG59O1xuXG5UYXNrUXVldWUucHJvdG90eXBlLmFkZFRhc2sgPSBmdW5jdGlvbiAobmFtZSwgcGFyYW1ldGVycykge1xuICBpZiAodHlwZW9mIG5hbWUgPT09ICdmdW5jdGlvbicpIHtcbiAgICB0aGlzLnF1ZXVlLnB1c2gobmFtZSk7XG4gICAgaWYgKHRoaXMuZmFpbGVkKSB7XG4gICAgICB0aGlzLmV4ZWN1dGUoKTtcbiAgICB9XG4gIH0gZWxzZSB7XG4gICAgdmFyIHRhc2sgPSB7IG5hbWU6IG5hbWUsIHBhcmFtZXRlcnM6IHBhcmFtZXRlcnMgfTtcbiAgICB0aGlzLnF1ZXVlLnB1c2godGFzayk7XG4gICAgaWYgKHRoaXMuZmFpbGVkKSB7XG4gICAgICB0aGlzLmV4ZWN1dGUoKTtcbiAgICB9XG4gICAgcmV0dXJuIHRhc2s7XG4gIH1cbn07XG5cbn0se31dLDIzOltmdW5jdGlvbihfZGVyZXFfLG1vZHVsZSxleHBvcnRzKXtcbihmdW5jdGlvbiAocHJvY2VzcyxnbG9iYWwpe1xuLypqc2hpbnQgc3RyaWN0OiBmYWxzZSAqL1xuLypnbG9iYWwgY2hyb21lICovXG52YXIgbWVyZ2UgPSBfZGVyZXFfKCcuL21lcmdlJyk7XG5leHBvcnRzLmV4dGVuZCA9IF9kZXJlcV8oJ3BvdWNoZGItZXh0ZW5kJyk7XG5leHBvcnRzLmFqYXggPSBfZGVyZXFfKCcuL2RlcHMvYWpheCcpO1xuZXhwb3J0cy5jcmVhdGVCbG9iID0gX2RlcmVxXygnLi9kZXBzL2Jsb2InKTtcbmV4cG9ydHMudXVpZCA9IF9kZXJlcV8oJy4vZGVwcy91dWlkJyk7XG5leHBvcnRzLmdldEFyZ3VtZW50cyA9IF9kZXJlcV8oJ2FyZ3NhcnJheScpO1xudmFyIGJ1ZmZlciA9IF9kZXJlcV8oJy4vZGVwcy9idWZmZXInKTtcbnZhciBlcnJvcnMgPSBfZGVyZXFfKCcuL2RlcHMvZXJyb3JzJyk7XG52YXIgRXZlbnRFbWl0dGVyID0gX2RlcmVxXygnZXZlbnRzJykuRXZlbnRFbWl0dGVyO1xudmFyIGNvbGxlY3Rpb25zID0gX2RlcmVxXygnLi9kZXBzL2NvbGxlY3Rpb25zJyk7XG5leHBvcnRzLk1hcCA9IGNvbGxlY3Rpb25zLk1hcDtcbmV4cG9ydHMuU2V0ID0gY29sbGVjdGlvbnMuU2V0O1xuXG5pZiAodHlwZW9mIGdsb2JhbC5Qcm9taXNlID09PSAnZnVuY3Rpb24nKSB7XG4gIGV4cG9ydHMuUHJvbWlzZSA9IGdsb2JhbC5Qcm9taXNlO1xufSBlbHNlIHtcbiAgZXhwb3J0cy5Qcm9taXNlID0gX2RlcmVxXygnYmx1ZWJpcmQnKTtcbn1cbnZhciBQcm9taXNlID0gZXhwb3J0cy5Qcm9taXNlO1xuXG5mdW5jdGlvbiB0b09iamVjdChhcnJheSkge1xuICB2YXIgb2JqID0ge307XG4gIGFycmF5LmZvckVhY2goZnVuY3Rpb24gKGl0ZW0pIHsgb2JqW2l0ZW1dID0gdHJ1ZTsgfSk7XG4gIHJldHVybiBvYmo7XG59XG4vLyBMaXN0IG9mIHRvcCBsZXZlbCByZXNlcnZlZCB3b3JkcyBmb3IgZG9jXG52YXIgcmVzZXJ2ZWRXb3JkcyA9IHRvT2JqZWN0KFtcbiAgJ19pZCcsXG4gICdfcmV2JyxcbiAgJ19hdHRhY2htZW50cycsXG4gICdfZGVsZXRlZCcsXG4gICdfcmV2aXNpb25zJyxcbiAgJ19yZXZzX2luZm8nLFxuICAnX2NvbmZsaWN0cycsXG4gICdfZGVsZXRlZF9jb25mbGljdHMnLFxuICAnX2xvY2FsX3NlcScsXG4gICdfcmV2X3RyZWUnLFxuICAvL3JlcGxpY2F0aW9uIGRvY3VtZW50c1xuICAnX3JlcGxpY2F0aW9uX2lkJyxcbiAgJ19yZXBsaWNhdGlvbl9zdGF0ZScsXG4gICdfcmVwbGljYXRpb25fc3RhdGVfdGltZScsXG4gICdfcmVwbGljYXRpb25fc3RhdGVfcmVhc29uJyxcbiAgJ19yZXBsaWNhdGlvbl9zdGF0cydcbl0pO1xuXG4vLyBMaXN0IG9mIHJlc2VydmVkIHdvcmRzIHRoYXQgc2hvdWxkIGVuZCB1cCB0aGUgZG9jdW1lbnRcbnZhciBkYXRhV29yZHMgPSB0b09iamVjdChbXG4gICdfYXR0YWNobWVudHMnLFxuICAvL3JlcGxpY2F0aW9uIGRvY3VtZW50c1xuICAnX3JlcGxpY2F0aW9uX2lkJyxcbiAgJ19yZXBsaWNhdGlvbl9zdGF0ZScsXG4gICdfcmVwbGljYXRpb25fc3RhdGVfdGltZScsXG4gICdfcmVwbGljYXRpb25fc3RhdGVfcmVhc29uJyxcbiAgJ19yZXBsaWNhdGlvbl9zdGF0cydcbl0pO1xuXG5leHBvcnRzLmNsb25lID0gZnVuY3Rpb24gKG9iaikge1xuICByZXR1cm4gZXhwb3J0cy5leHRlbmQodHJ1ZSwge30sIG9iaik7XG59O1xuZXhwb3J0cy5pbmhlcml0cyA9IF9kZXJlcV8oJ2luaGVyaXRzJyk7XG4vLyBEZXRlcm1pbmUgaWQgYW4gSUQgaXMgdmFsaWRcbi8vICAgLSBpbnZhbGlkIElEcyBiZWdpbiB3aXRoIGFuIHVuZGVyZXNjb3JlIHRoYXQgZG9lcyBub3QgYmVnaW4gJ19kZXNpZ24nIG9yXG4vLyAgICAgJ19sb2NhbCdcbi8vICAgLSBhbnkgb3RoZXIgc3RyaW5nIHZhbHVlIGlzIGEgdmFsaWQgaWRcbi8vIFJldHVybnMgdGhlIHNwZWNpZmljIGVycm9yIG9iamVjdCBmb3IgZWFjaCBjYXNlXG5leHBvcnRzLmludmFsaWRJZEVycm9yID0gZnVuY3Rpb24gKGlkKSB7XG4gIHZhciBlcnI7XG4gIGlmICghaWQpIHtcbiAgICBlcnIgPSBuZXcgVHlwZUVycm9yKGVycm9ycy5NSVNTSU5HX0lELm1lc3NhZ2UpO1xuICAgIGVyci5zdGF0dXMgPSA0MTI7XG4gIH0gZWxzZSBpZiAodHlwZW9mIGlkICE9PSAnc3RyaW5nJykge1xuICAgIGVyciA9IG5ldyBUeXBlRXJyb3IoZXJyb3JzLklOVkFMSURfSUQubWVzc2FnZSk7XG4gICAgZXJyLnN0YXR1cyA9IDQwMDtcbiAgfSBlbHNlIGlmICgvXl8vLnRlc3QoaWQpICYmICEoL15fKGRlc2lnbnxsb2NhbCkvKS50ZXN0KGlkKSkge1xuICAgIGVyciA9IG5ldyBUeXBlRXJyb3IoZXJyb3JzLlJFU0VSVkVEX0lELm1lc3NhZ2UpO1xuICAgIGVyci5zdGF0dXMgPSA0MDA7XG4gIH1cbiAgaWYgKGVycikge1xuICAgIHRocm93IGVycjtcbiAgfVxufTtcblxuZnVuY3Rpb24gaXNDaHJvbWVBcHAoKSB7XG4gIHJldHVybiAodHlwZW9mIGNocm9tZSAhPT0gXCJ1bmRlZmluZWRcIiAmJlxuICAgICAgICAgIHR5cGVvZiBjaHJvbWUuc3RvcmFnZSAhPT0gXCJ1bmRlZmluZWRcIiAmJlxuICAgICAgICAgIHR5cGVvZiBjaHJvbWUuc3RvcmFnZS5sb2NhbCAhPT0gXCJ1bmRlZmluZWRcIik7XG59XG5cbi8vIFByZXR0eSBkdW1iIG5hbWUgZm9yIGEgZnVuY3Rpb24sIGp1c3Qgd3JhcHMgY2FsbGJhY2sgY2FsbHMgc28gd2UgZG9udFxuLy8gdG8gaWYgKGNhbGxiYWNrKSBjYWxsYmFjaygpIGV2ZXJ5d2hlcmVcbmV4cG9ydHMuY2FsbCA9IGV4cG9ydHMuZ2V0QXJndW1lbnRzKGZ1bmN0aW9uIChhcmdzKSB7XG4gIGlmICghYXJncy5sZW5ndGgpIHtcbiAgICByZXR1cm47XG4gIH1cbiAgdmFyIGZ1biA9IGFyZ3Muc2hpZnQoKTtcbiAgaWYgKHR5cGVvZiBmdW4gPT09ICdmdW5jdGlvbicpIHtcbiAgICBmdW4uYXBwbHkodGhpcywgYXJncyk7XG4gIH1cbn0pO1xuXG5leHBvcnRzLmlzTG9jYWxJZCA9IGZ1bmN0aW9uIChpZCkge1xuICByZXR1cm4gKC9eX2xvY2FsLykudGVzdChpZCk7XG59O1xuXG4vLyBjaGVjayBpZiBhIHNwZWNpZmljIHJldmlzaW9uIG9mIGEgZG9jIGhhcyBiZWVuIGRlbGV0ZWRcbi8vICAtIG1ldGFkYXRhOiB0aGUgbWV0YWRhdGEgb2JqZWN0IGZyb20gdGhlIGRvYyBzdG9yZVxuLy8gIC0gcmV2OiAob3B0aW9uYWwpIHRoZSByZXZpc2lvbiB0byBjaGVjay4gZGVmYXVsdHMgdG8gd2lubmluZyByZXZpc2lvblxuZXhwb3J0cy5pc0RlbGV0ZWQgPSBmdW5jdGlvbiAobWV0YWRhdGEsIHJldikge1xuICBpZiAoIXJldikge1xuICAgIHJldiA9IG1lcmdlLndpbm5pbmdSZXYobWV0YWRhdGEpO1xuICB9XG4gIHZhciBkYXNoSW5kZXggPSByZXYuaW5kZXhPZignLScpO1xuICBpZiAoZGFzaEluZGV4ICE9PSAtMSkge1xuICAgIHJldiA9IHJldi5zdWJzdHJpbmcoZGFzaEluZGV4ICsgMSk7XG4gIH1cbiAgdmFyIGRlbGV0ZWQgPSBmYWxzZTtcbiAgbWVyZ2UudHJhdmVyc2VSZXZUcmVlKG1ldGFkYXRhLnJldl90cmVlLFxuICBmdW5jdGlvbiAoaXNMZWFmLCBwb3MsIGlkLCBhY2MsIG9wdHMpIHtcbiAgICBpZiAoaWQgPT09IHJldikge1xuICAgICAgZGVsZXRlZCA9ICEhb3B0cy5kZWxldGVkO1xuICAgIH1cbiAgfSk7XG5cbiAgcmV0dXJuIGRlbGV0ZWQ7XG59O1xuXG5leHBvcnRzLmZpbHRlckNoYW5nZSA9IGZ1bmN0aW9uIChvcHRzKSB7XG4gIHJldHVybiBmdW5jdGlvbiAoY2hhbmdlKSB7XG4gICAgdmFyIHJlcSA9IHt9O1xuICAgIHZhciBoYXNGaWx0ZXIgPSBvcHRzLmZpbHRlciAmJiB0eXBlb2Ygb3B0cy5maWx0ZXIgPT09ICdmdW5jdGlvbic7XG5cbiAgICByZXEucXVlcnkgPSBvcHRzLnF1ZXJ5X3BhcmFtcztcbiAgICBpZiAob3B0cy5maWx0ZXIgJiYgaGFzRmlsdGVyICYmICFvcHRzLmZpbHRlci5jYWxsKHRoaXMsIGNoYW5nZS5kb2MsIHJlcSkpIHtcbiAgICAgIHJldHVybiBmYWxzZTtcbiAgICB9XG4gICAgaWYgKG9wdHMuZG9jX2lkcyAmJiBvcHRzLmRvY19pZHMuaW5kZXhPZihjaGFuZ2UuaWQpID09PSAtMSkge1xuICAgICAgcmV0dXJuIGZhbHNlO1xuICAgIH1cbiAgICBpZiAoIW9wdHMuaW5jbHVkZV9kb2NzKSB7XG4gICAgICBkZWxldGUgY2hhbmdlLmRvYztcbiAgICB9IGVsc2Uge1xuICAgICAgZm9yICh2YXIgYXR0IGluIGNoYW5nZS5kb2MuX2F0dGFjaG1lbnRzKSB7XG4gICAgICAgIGlmIChjaGFuZ2UuZG9jLl9hdHRhY2htZW50cy5oYXNPd25Qcm9wZXJ0eShhdHQpKSB7XG4gICAgICAgICAgY2hhbmdlLmRvYy5fYXR0YWNobWVudHNbYXR0XS5zdHViID0gdHJ1ZTtcbiAgICAgICAgfVxuICAgICAgfVxuICAgIH1cbiAgICByZXR1cm4gdHJ1ZTtcbiAgfTtcbn07XG5cbi8vIFByZXByb2Nlc3MgZG9jdW1lbnRzLCBwYXJzZSB0aGVpciByZXZpc2lvbnMsIGFzc2lnbiBhbiBpZCBhbmQgYVxuLy8gcmV2aXNpb24gZm9yIG5ldyB3cml0ZXMgdGhhdCBhcmUgbWlzc2luZyB0aGVtLCBldGNcbmV4cG9ydHMucGFyc2VEb2MgPSBmdW5jdGlvbiAoZG9jLCBuZXdFZGl0cykge1xuICB2YXIgblJldk51bTtcbiAgdmFyIG5ld1JldklkO1xuICB2YXIgcmV2SW5mbztcbiAgdmFyIGVycm9yO1xuICB2YXIgb3B0cyA9IHtzdGF0dXM6ICdhdmFpbGFibGUnfTtcbiAgaWYgKGRvYy5fZGVsZXRlZCkge1xuICAgIG9wdHMuZGVsZXRlZCA9IHRydWU7XG4gIH1cblxuICBpZiAobmV3RWRpdHMpIHtcbiAgICBpZiAoIWRvYy5faWQpIHtcbiAgICAgIGRvYy5faWQgPSBleHBvcnRzLnV1aWQoKTtcbiAgICB9XG4gICAgbmV3UmV2SWQgPSBleHBvcnRzLnV1aWQoMzIsIDE2KS50b0xvd2VyQ2FzZSgpO1xuICAgIGlmIChkb2MuX3Jldikge1xuICAgICAgcmV2SW5mbyA9IC9eKFxcZCspLSguKykkLy5leGVjKGRvYy5fcmV2KTtcbiAgICAgIGlmICghcmV2SW5mbykge1xuICAgICAgICB2YXIgZXJyID0gbmV3IFR5cGVFcnJvcihcImludmFsaWQgdmFsdWUgZm9yIHByb3BlcnR5ICdfcmV2J1wiKTtcbiAgICAgICAgZXJyLnN0YXR1cyA9IDQwMDtcbiAgICAgIH1cbiAgICAgIGRvYy5fcmV2X3RyZWUgPSBbe1xuICAgICAgICBwb3M6IHBhcnNlSW50KHJldkluZm9bMV0sIDEwKSxcbiAgICAgICAgaWRzOiBbcmV2SW5mb1syXSwge3N0YXR1czogJ21pc3NpbmcnfSwgW1tuZXdSZXZJZCwgb3B0cywgW11dXV1cbiAgICAgIH1dO1xuICAgICAgblJldk51bSA9IHBhcnNlSW50KHJldkluZm9bMV0sIDEwKSArIDE7XG4gICAgfSBlbHNlIHtcbiAgICAgIGRvYy5fcmV2X3RyZWUgPSBbe1xuICAgICAgICBwb3M6IDEsXG4gICAgICAgIGlkcyA6IFtuZXdSZXZJZCwgb3B0cywgW11dXG4gICAgICB9XTtcbiAgICAgIG5SZXZOdW0gPSAxO1xuICAgIH1cbiAgfSBlbHNlIHtcbiAgICBpZiAoZG9jLl9yZXZpc2lvbnMpIHtcbiAgICAgIGRvYy5fcmV2X3RyZWUgPSBbe1xuICAgICAgICBwb3M6IGRvYy5fcmV2aXNpb25zLnN0YXJ0IC0gZG9jLl9yZXZpc2lvbnMuaWRzLmxlbmd0aCArIDEsXG4gICAgICAgIGlkczogZG9jLl9yZXZpc2lvbnMuaWRzLnJlZHVjZShmdW5jdGlvbiAoYWNjLCB4KSB7XG4gICAgICAgICAgaWYgKGFjYyA9PT0gbnVsbCkge1xuICAgICAgICAgICAgcmV0dXJuIFt4LCBvcHRzLCBbXV07XG4gICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIHJldHVybiBbeCwge3N0YXR1czogJ21pc3NpbmcnfSwgW2FjY11dO1xuICAgICAgICAgIH1cbiAgICAgICAgfSwgbnVsbClcbiAgICAgIH1dO1xuICAgICAgblJldk51bSA9IGRvYy5fcmV2aXNpb25zLnN0YXJ0O1xuICAgICAgbmV3UmV2SWQgPSBkb2MuX3JldmlzaW9ucy5pZHNbMF07XG4gICAgfVxuICAgIGlmICghZG9jLl9yZXZfdHJlZSkge1xuICAgICAgcmV2SW5mbyA9IC9eKFxcZCspLSguKykkLy5leGVjKGRvYy5fcmV2KTtcbiAgICAgIGlmICghcmV2SW5mbykge1xuICAgICAgICBlcnJvciA9IG5ldyBUeXBlRXJyb3IoZXJyb3JzLkJBRF9BUkcubWVzc2FnZSk7XG4gICAgICAgIGVycm9yLnN0YXR1cyA9IGVycm9ycy5CQURfQVJHLnN0YXR1cztcbiAgICAgICAgdGhyb3cgZXJyb3I7XG4gICAgICB9XG4gICAgICBuUmV2TnVtID0gcGFyc2VJbnQocmV2SW5mb1sxXSwgMTApO1xuICAgICAgbmV3UmV2SWQgPSByZXZJbmZvWzJdO1xuICAgICAgZG9jLl9yZXZfdHJlZSA9IFt7XG4gICAgICAgIHBvczogcGFyc2VJbnQocmV2SW5mb1sxXSwgMTApLFxuICAgICAgICBpZHM6IFtyZXZJbmZvWzJdLCBvcHRzLCBbXV1cbiAgICAgIH1dO1xuICAgIH1cbiAgfVxuXG4gIGV4cG9ydHMuaW52YWxpZElkRXJyb3IoZG9jLl9pZCk7XG5cbiAgZG9jLl9yZXYgPSBbblJldk51bSwgbmV3UmV2SWRdLmpvaW4oJy0nKTtcblxuICB2YXIgcmVzdWx0ID0ge21ldGFkYXRhIDoge30sIGRhdGEgOiB7fX07XG4gIGZvciAodmFyIGtleSBpbiBkb2MpIHtcbiAgICBpZiAoZG9jLmhhc093blByb3BlcnR5KGtleSkpIHtcbiAgICAgIHZhciBzcGVjaWFsS2V5ID0ga2V5WzBdID09PSAnXyc7XG4gICAgICBpZiAoc3BlY2lhbEtleSAmJiAhcmVzZXJ2ZWRXb3Jkc1trZXldKSB7XG4gICAgICAgIGVycm9yID0gbmV3IEVycm9yKGVycm9ycy5ET0NfVkFMSURBVElPTi5tZXNzYWdlICsgJzogJyArIGtleSk7XG4gICAgICAgIGVycm9yLnN0YXR1cyA9IGVycm9ycy5ET0NfVkFMSURBVElPTi5zdGF0dXM7XG4gICAgICAgIHRocm93IGVycm9yO1xuICAgICAgfSBlbHNlIGlmIChzcGVjaWFsS2V5ICYmICFkYXRhV29yZHNba2V5XSkge1xuICAgICAgICByZXN1bHQubWV0YWRhdGFba2V5LnNsaWNlKDEpXSA9IGRvY1trZXldO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgcmVzdWx0LmRhdGFba2V5XSA9IGRvY1trZXldO1xuICAgICAgfVxuICAgIH1cbiAgfVxuICByZXR1cm4gcmVzdWx0O1xufTtcblxuZXhwb3J0cy5pc0NvcmRvdmEgPSBmdW5jdGlvbiAoKSB7XG4gIHJldHVybiAodHlwZW9mIGNvcmRvdmEgIT09IFwidW5kZWZpbmVkXCIgfHxcbiAgICAgICAgICB0eXBlb2YgUGhvbmVHYXAgIT09IFwidW5kZWZpbmVkXCIgfHxcbiAgICAgICAgICB0eXBlb2YgcGhvbmVnYXAgIT09IFwidW5kZWZpbmVkXCIpO1xufTtcblxuZXhwb3J0cy5oYXNMb2NhbFN0b3JhZ2UgPSBmdW5jdGlvbiAoKSB7XG4gIGlmIChpc0Nocm9tZUFwcCgpKSB7XG4gICAgcmV0dXJuIGZhbHNlO1xuICB9XG4gIHRyeSB7XG4gICAgcmV0dXJuIGdsb2JhbC5sb2NhbFN0b3JhZ2U7XG4gIH0gY2F0Y2ggKGUpIHtcbiAgICByZXR1cm4gZmFsc2U7XG4gIH1cbn07XG5leHBvcnRzLkNoYW5nZXMgPSBDaGFuZ2VzO1xuZXhwb3J0cy5pbmhlcml0cyhDaGFuZ2VzLCBFdmVudEVtaXR0ZXIpO1xuZnVuY3Rpb24gQ2hhbmdlcygpIHtcbiAgaWYgKCEodGhpcyBpbnN0YW5jZW9mIENoYW5nZXMpKSB7XG4gICAgcmV0dXJuIG5ldyBDaGFuZ2VzKCk7XG4gIH1cbiAgdmFyIHNlbGYgPSB0aGlzO1xuICBFdmVudEVtaXR0ZXIuY2FsbCh0aGlzKTtcbiAgdGhpcy5pc0Nocm9tZSA9IGlzQ2hyb21lQXBwKCk7XG4gIHRoaXMubGlzdGVuZXJzID0ge307XG4gIHRoaXMuaGFzTG9jYWwgPSBmYWxzZTtcbiAgaWYgKCF0aGlzLmlzQ2hyb21lKSB7XG4gICAgdGhpcy5oYXNMb2NhbCA9IGV4cG9ydHMuaGFzTG9jYWxTdG9yYWdlKCk7XG4gIH1cbiAgaWYgKHRoaXMuaXNDaHJvbWUpIHtcbiAgICBjaHJvbWUuc3RvcmFnZS5vbkNoYW5nZWQuYWRkTGlzdGVuZXIoZnVuY3Rpb24gKGUpIHtcbiAgICAgIC8vIG1ha2Ugc3VyZSBpdCdzIGV2ZW50IGFkZHJlc3NlZCB0byB1c1xuICAgICAgaWYgKGUuZGJfbmFtZSAhPSBudWxsKSB7XG4gICAgICAgIC8vb2JqZWN0IG9ubHkgaGFzIG9sZFZhbHVlLCBuZXdWYWx1ZSBtZW1iZXJzXG4gICAgICAgIHNlbGYuZW1pdChlLmRiTmFtZS5uZXdWYWx1ZSk7XG4gICAgICB9XG4gICAgfSk7XG4gIH0gZWxzZSBpZiAodGhpcy5oYXNMb2NhbCkge1xuICAgIGlmIChnbG9iYWwuYWRkRXZlbnRMaXN0ZW5lcikge1xuICAgICAgZ2xvYmFsLmFkZEV2ZW50TGlzdGVuZXIoXCJzdG9yYWdlXCIsIGZ1bmN0aW9uIChlKSB7XG4gICAgICAgIHNlbGYuZW1pdChlLmtleSk7XG4gICAgICB9KTtcbiAgICB9IGVsc2Uge1xuICAgICAgZ2xvYmFsLmF0dGFjaEV2ZW50KFwic3RvcmFnZVwiLCBmdW5jdGlvbiAoZSkge1xuICAgICAgICBzZWxmLmVtaXQoZS5rZXkpO1xuICAgICAgfSk7XG4gICAgfVxuICB9XG5cbn1cbkNoYW5nZXMucHJvdG90eXBlLmFkZExpc3RlbmVyID0gZnVuY3Rpb24gKGRiTmFtZSwgaWQsIGRiLCBvcHRzKSB7XG4gIGlmICh0aGlzLmxpc3RlbmVyc1tpZF0pIHtcbiAgICByZXR1cm47XG4gIH1cbiAgZnVuY3Rpb24gZXZlbnRGdW5jdGlvbigpIHtcbiAgICBkYi5jaGFuZ2VzKHtcbiAgICAgIGluY2x1ZGVfZG9jczogb3B0cy5pbmNsdWRlX2RvY3MsXG4gICAgICBjb25mbGljdHM6IG9wdHMuY29uZmxpY3RzLFxuICAgICAgY29udGludW91czogZmFsc2UsXG4gICAgICBkZXNjZW5kaW5nOiBmYWxzZSxcbiAgICAgIGZpbHRlcjogb3B0cy5maWx0ZXIsXG4gICAgICB2aWV3OiBvcHRzLnZpZXcsXG4gICAgICBzaW5jZTogb3B0cy5zaW5jZSxcbiAgICAgIHF1ZXJ5X3BhcmFtczogb3B0cy5xdWVyeV9wYXJhbXMsXG4gICAgICBvbkNoYW5nZTogZnVuY3Rpb24gKGMpIHtcbiAgICAgICAgaWYgKGMuc2VxID4gb3B0cy5zaW5jZSAmJiAhb3B0cy5jYW5jZWxsZWQpIHtcbiAgICAgICAgICBvcHRzLnNpbmNlID0gYy5zZXE7XG4gICAgICAgICAgZXhwb3J0cy5jYWxsKG9wdHMub25DaGFuZ2UsIGMpO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgfSk7XG4gIH1cbiAgdGhpcy5saXN0ZW5lcnNbaWRdID0gZXZlbnRGdW5jdGlvbjtcbiAgdGhpcy5vbihkYk5hbWUsIGV2ZW50RnVuY3Rpb24pO1xufTtcblxuQ2hhbmdlcy5wcm90b3R5cGUucmVtb3ZlTGlzdGVuZXIgPSBmdW5jdGlvbiAoZGJOYW1lLCBpZCkge1xuICBpZiAoIShpZCBpbiB0aGlzLmxpc3RlbmVycykpIHtcbiAgICByZXR1cm47XG4gIH1cbiAgRXZlbnRFbWl0dGVyLnByb3RvdHlwZS5yZW1vdmVMaXN0ZW5lci5jYWxsKHRoaXMsIGRiTmFtZSxcbiAgICB0aGlzLmxpc3RlbmVyc1tpZF0pO1xufTtcblxuXG5DaGFuZ2VzLnByb3RvdHlwZS5ub3RpZnlMb2NhbFdpbmRvd3MgPSBmdW5jdGlvbiAoZGJOYW1lKSB7XG4gIC8vZG8gYSB1c2VsZXNzIGNoYW5nZSBvbiBhIHN0b3JhZ2UgdGhpbmdcbiAgLy9pbiBvcmRlciB0byBnZXQgb3RoZXIgd2luZG93cydzIGxpc3RlbmVycyB0byBhY3RpdmF0ZVxuICBpZiAodGhpcy5pc0Nocm9tZSkge1xuICAgIGNocm9tZS5zdG9yYWdlLmxvY2FsLnNldCh7ZGJOYW1lOiBkYk5hbWV9KTtcbiAgfSBlbHNlIGlmICh0aGlzLmhhc0xvY2FsKSB7XG4gICAgbG9jYWxTdG9yYWdlW2RiTmFtZV0gPSAobG9jYWxTdG9yYWdlW2RiTmFtZV0gPT09IFwiYVwiKSA/IFwiYlwiIDogXCJhXCI7XG4gIH1cbn07XG5cbkNoYW5nZXMucHJvdG90eXBlLm5vdGlmeSA9IGZ1bmN0aW9uIChkYk5hbWUpIHtcbiAgdGhpcy5lbWl0KGRiTmFtZSk7XG4gIHRoaXMubm90aWZ5TG9jYWxXaW5kb3dzKGRiTmFtZSk7XG59O1xuXG5pZiAoIXByb2Nlc3MuYnJvd3NlciB8fCAhKCdhdG9iJyBpbiBnbG9iYWwpKSB7XG4gIGV4cG9ydHMuYXRvYiA9IGZ1bmN0aW9uIChzdHIpIHtcbiAgICB2YXIgYmFzZTY0ID0gbmV3IGJ1ZmZlcihzdHIsICdiYXNlNjQnKTtcbiAgICAvLyBOb2RlLmpzIHdpbGwganVzdCBza2lwIHRoZSBjaGFyYWN0ZXJzIGl0IGNhbid0IGVuY29kZSBpbnN0ZWFkIG9mXG4gICAgLy8gdGhyb3dpbmcgYW5kIGV4Y2VwdGlvblxuICAgIGlmIChiYXNlNjQudG9TdHJpbmcoJ2Jhc2U2NCcpICE9PSBzdHIpIHtcbiAgICAgIHRocm93IChcIkNhbm5vdCBiYXNlNjQgZW5jb2RlIGZ1bGwgc3RyaW5nXCIpO1xuICAgIH1cbiAgICByZXR1cm4gYmFzZTY0LnRvU3RyaW5nKCdiaW5hcnknKTtcbiAgfTtcbn0gZWxzZSB7XG4gIGV4cG9ydHMuYXRvYiA9IGZ1bmN0aW9uIChzdHIpIHtcbiAgICByZXR1cm4gYXRvYihzdHIpO1xuICB9O1xufVxuXG5pZiAoIXByb2Nlc3MuYnJvd3NlciB8fCAhKCdidG9hJyBpbiBnbG9iYWwpKSB7XG4gIGV4cG9ydHMuYnRvYSA9IGZ1bmN0aW9uIChzdHIpIHtcbiAgICByZXR1cm4gbmV3IGJ1ZmZlcihzdHIsICdiaW5hcnknKS50b1N0cmluZygnYmFzZTY0Jyk7XG4gIH07XG59IGVsc2Uge1xuICBleHBvcnRzLmJ0b2EgPSBmdW5jdGlvbiAoc3RyKSB7XG4gICAgcmV0dXJuIGJ0b2Eoc3RyKTtcbiAgfTtcbn1cblxuLy8gRnJvbSBodHRwOi8vc3RhY2tvdmVyZmxvdy5jb20vcXVlc3Rpb25zLzE0OTY3NjQ3LyAoY29udGludWVzIG9uIG5leHQgbGluZSlcbi8vIGVuY29kZS1kZWNvZGUtaW1hZ2Utd2l0aC1iYXNlNjQtYnJlYWtzLWltYWdlICgyMDEzLTA0LTIxKVxuZXhwb3J0cy5maXhCaW5hcnkgPSBmdW5jdGlvbiAoYmluKSB7XG4gIGlmICghcHJvY2Vzcy5icm93c2VyKSB7XG4gICAgLy8gZG9uJ3QgbmVlZCB0byBkbyB0aGlzIGluIE5vZGVcbiAgICByZXR1cm4gYmluO1xuICB9XG5cbiAgdmFyIGxlbmd0aCA9IGJpbi5sZW5ndGg7XG4gIHZhciBidWYgPSBuZXcgQXJyYXlCdWZmZXIobGVuZ3RoKTtcbiAgdmFyIGFyciA9IG5ldyBVaW50OEFycmF5KGJ1Zik7XG4gIGZvciAodmFyIGkgPSAwOyBpIDwgbGVuZ3RoOyBpKyspIHtcbiAgICBhcnJbaV0gPSBiaW4uY2hhckNvZGVBdChpKTtcbiAgfVxuICByZXR1cm4gYnVmO1xufTtcblxuZXhwb3J0cy5vbmNlID0gZnVuY3Rpb24gKGZ1bikge1xuICB2YXIgY2FsbGVkID0gZmFsc2U7XG4gIHJldHVybiBleHBvcnRzLmdldEFyZ3VtZW50cyhmdW5jdGlvbiAoYXJncykge1xuICAgIGlmIChjYWxsZWQpIHtcbiAgICAgIGlmICh0eXBlb2YgY29uc29sZS50cmFjZSA9PT0gJ2Z1bmN0aW9uJykge1xuICAgICAgICBjb25zb2xlLnRyYWNlKCk7XG4gICAgICB9XG4gICAgICB0aHJvdyBuZXcgRXJyb3IoJ29uY2UgY2FsbGVkICBtb3JlIHRoYW4gb25jZScpO1xuICAgIH0gZWxzZSB7XG4gICAgICBjYWxsZWQgPSB0cnVlO1xuICAgICAgZnVuLmFwcGx5KHRoaXMsIGFyZ3MpO1xuICAgIH1cbiAgfSk7XG59O1xuXG5leHBvcnRzLnRvUHJvbWlzZSA9IGZ1bmN0aW9uIChmdW5jKSB7XG4gIC8vY3JlYXRlIHRoZSBmdW5jdGlvbiB3ZSB3aWxsIGJlIHJldHVybmluZ1xuICByZXR1cm4gZXhwb3J0cy5nZXRBcmd1bWVudHMoZnVuY3Rpb24gKGFyZ3MpIHtcbiAgICB2YXIgc2VsZiA9IHRoaXM7XG4gICAgdmFyIHRlbXBDQiA9XG4gICAgICAodHlwZW9mIGFyZ3NbYXJncy5sZW5ndGggLSAxXSA9PT0gJ2Z1bmN0aW9uJykgPyBhcmdzLnBvcCgpIDogZmFsc2U7XG4gICAgLy8gaWYgdGhlIGxhc3QgYXJndW1lbnQgaXMgYSBmdW5jdGlvbiwgYXNzdW1lIGl0cyBhIGNhbGxiYWNrXG4gICAgdmFyIHVzZWRDQjtcbiAgICBpZiAodGVtcENCKSB7XG4gICAgICAvLyBpZiBpdCB3YXMgYSBjYWxsYmFjaywgY3JlYXRlIGEgbmV3IGNhbGxiYWNrIHdoaWNoIGNhbGxzIGl0LFxuICAgICAgLy8gYnV0IGRvIHNvIGFzeW5jIHNvIHdlIGRvbid0IHRyYXAgYW55IGVycm9yc1xuICAgICAgdXNlZENCID0gZnVuY3Rpb24gKGVyciwgcmVzcCkge1xuICAgICAgICBwcm9jZXNzLm5leHRUaWNrKGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICB0ZW1wQ0IoZXJyLCByZXNwKTtcbiAgICAgICAgfSk7XG4gICAgICB9O1xuICAgIH1cbiAgICB2YXIgcHJvbWlzZSA9IG5ldyBQcm9taXNlKGZ1bmN0aW9uIChmdWxmaWxsLCByZWplY3QpIHtcbiAgICAgIHZhciByZXNwO1xuICAgICAgdHJ5IHtcbiAgICAgICAgdmFyIGNhbGxiYWNrID0gZXhwb3J0cy5vbmNlKGZ1bmN0aW9uIChlcnIsIG1lc2cpIHtcbiAgICAgICAgICBpZiAoZXJyKSB7XG4gICAgICAgICAgICByZWplY3QoZXJyKTtcbiAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgZnVsZmlsbChtZXNnKTtcbiAgICAgICAgICB9XG4gICAgICAgIH0pO1xuICAgICAgICAvLyBjcmVhdGUgYSBjYWxsYmFjayBmb3IgdGhpcyBpbnZvY2F0aW9uXG4gICAgICAgIC8vIGFwcGx5IHRoZSBmdW5jdGlvbiBpbiB0aGUgb3JpZyBjb250ZXh0XG4gICAgICAgIGFyZ3MucHVzaChjYWxsYmFjayk7XG4gICAgICAgIHJlc3AgPSBmdW5jLmFwcGx5KHNlbGYsIGFyZ3MpO1xuICAgICAgICBpZiAocmVzcCAmJiB0eXBlb2YgcmVzcC50aGVuID09PSAnZnVuY3Rpb24nKSB7XG4gICAgICAgICAgZnVsZmlsbChyZXNwKTtcbiAgICAgICAgfVxuICAgICAgfSBjYXRjaCAoZSkge1xuICAgICAgICByZWplY3QoZSk7XG4gICAgICB9XG4gICAgfSk7XG4gICAgLy8gaWYgdGhlcmUgaXMgYSBjYWxsYmFjaywgY2FsbCBpdCBiYWNrXG4gICAgaWYgKHVzZWRDQikge1xuICAgICAgcHJvbWlzZS50aGVuKGZ1bmN0aW9uIChyZXN1bHQpIHtcbiAgICAgICAgdXNlZENCKG51bGwsIHJlc3VsdCk7XG4gICAgICB9LCB1c2VkQ0IpO1xuICAgIH1cbiAgICBwcm9taXNlLmNhbmNlbCA9IGZ1bmN0aW9uICgpIHtcbiAgICAgIHJldHVybiB0aGlzO1xuICAgIH07XG4gICAgcmV0dXJuIHByb21pc2U7XG4gIH0pO1xufTtcblxuZXhwb3J0cy5hZGFwdGVyRnVuID0gZnVuY3Rpb24gKG5hbWUsIGNhbGxiYWNrKSB7XG4gIHJldHVybiBleHBvcnRzLnRvUHJvbWlzZShleHBvcnRzLmdldEFyZ3VtZW50cyhmdW5jdGlvbiAoYXJncykge1xuICAgIGlmICh0aGlzLl9jbG9zZWQpIHtcbiAgICAgIHJldHVybiBQcm9taXNlLnJlamVjdChuZXcgRXJyb3IoJ2RhdGFiYXNlIGlzIGNsb3NlZCcpKTtcbiAgICB9XG4gICAgdmFyIHNlbGYgPSB0aGlzO1xuICAgIGlmICghdGhpcy50YXNrcXVldWUuaXNSZWFkeSkge1xuICAgICAgcmV0dXJuIG5ldyBleHBvcnRzLlByb21pc2UoZnVuY3Rpb24gKGZ1bGZpbGwsIHJlamVjdCkge1xuICAgICAgICBzZWxmLnRhc2txdWV1ZS5hZGRUYXNrKGZ1bmN0aW9uIChmYWlsZWQpIHtcbiAgICAgICAgICBpZiAoZmFpbGVkKSB7XG4gICAgICAgICAgICByZWplY3QoZmFpbGVkKTtcbiAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgZnVsZmlsbChzZWxmW25hbWVdLmFwcGx5KHNlbGYsIGFyZ3MpKTtcbiAgICAgICAgICB9XG4gICAgICAgIH0pO1xuICAgICAgfSk7XG4gICAgfVxuICAgIHJldHVybiBjYWxsYmFjay5hcHBseSh0aGlzLCBhcmdzKTtcbiAgfSkpO1xufTtcbi8vQ2FuJ3QgZmluZCBvcmlnaW5hbCBwb3N0LCBidXQgdGhpcyBpcyBjbG9zZVxuLy9odHRwOi8vc3RhY2tvdmVyZmxvdy5jb20vcXVlc3Rpb25zLzY5NjUxMDcvIChjb250aW51ZXMgb24gbmV4dCBsaW5lKVxuLy9jb252ZXJ0aW5nLWJldHdlZW4tc3RyaW5ncy1hbmQtYXJyYXlidWZmZXJzXG5leHBvcnRzLmFycmF5QnVmZmVyVG9CaW5hcnlTdHJpbmcgPSBmdW5jdGlvbiAoYnVmZmVyKSB7XG4gIHZhciBiaW5hcnkgPSBcIlwiO1xuICB2YXIgYnl0ZXMgPSBuZXcgVWludDhBcnJheShidWZmZXIpO1xuICB2YXIgbGVuZ3RoID0gYnl0ZXMuYnl0ZUxlbmd0aDtcbiAgZm9yICh2YXIgaSA9IDA7IGkgPCBsZW5ndGg7IGkrKykge1xuICAgIGJpbmFyeSArPSBTdHJpbmcuZnJvbUNoYXJDb2RlKGJ5dGVzW2ldKTtcbiAgfVxuICByZXR1cm4gYmluYXJ5O1xufTtcblxuZXhwb3J0cy5jYW5jZWxsYWJsZUZ1biA9IGZ1bmN0aW9uIChmdW4sIHNlbGYsIG9wdHMpIHtcblxuICBvcHRzID0gb3B0cyA/IGV4cG9ydHMuY2xvbmUodHJ1ZSwge30sIG9wdHMpIDoge307XG5cbiAgdmFyIGVtaXR0ZXIgPSBuZXcgRXZlbnRFbWl0dGVyKCk7XG4gIHZhciBvbGRDb21wbGV0ZSA9IG9wdHMuY29tcGxldGUgfHwgZnVuY3Rpb24gKCkgeyB9O1xuICB2YXIgY29tcGxldGUgPSBvcHRzLmNvbXBsZXRlID0gZXhwb3J0cy5vbmNlKGZ1bmN0aW9uIChlcnIsIHJlc3ApIHtcbiAgICBpZiAoZXJyKSB7XG4gICAgICBvbGRDb21wbGV0ZShlcnIpO1xuICAgIH0gZWxzZSB7XG4gICAgICBlbWl0dGVyLmVtaXQoJ2VuZCcsIHJlc3ApO1xuICAgICAgb2xkQ29tcGxldGUobnVsbCwgcmVzcCk7XG4gICAgfVxuICAgIGVtaXR0ZXIucmVtb3ZlQWxsTGlzdGVuZXJzKCk7XG4gIH0pO1xuICB2YXIgb2xkT25DaGFuZ2UgPSBvcHRzLm9uQ2hhbmdlIHx8IGZ1bmN0aW9uICgpIHt9O1xuICB2YXIgbGFzdENoYW5nZSA9IDA7XG4gIHNlbGYub24oJ2Rlc3Ryb3llZCcsIGZ1bmN0aW9uICgpIHtcbiAgICBlbWl0dGVyLnJlbW92ZUFsbExpc3RlbmVycygpO1xuICB9KTtcbiAgb3B0cy5vbkNoYW5nZSA9IGZ1bmN0aW9uIChjaGFuZ2UpIHtcbiAgICBvbGRPbkNoYW5nZShjaGFuZ2UpO1xuICAgIGlmIChjaGFuZ2Uuc2VxIDw9IGxhc3RDaGFuZ2UpIHtcbiAgICAgIHJldHVybjtcbiAgICB9XG4gICAgbGFzdENoYW5nZSA9IGNoYW5nZS5zZXE7XG4gICAgZW1pdHRlci5lbWl0KCdjaGFuZ2UnLCBjaGFuZ2UpO1xuICAgIGlmIChjaGFuZ2UuZGVsZXRlZCkge1xuICAgICAgZW1pdHRlci5lbWl0KCdkZWxldGUnLCBjaGFuZ2UpO1xuICAgIH0gZWxzZSBpZiAoY2hhbmdlLmNoYW5nZXMubGVuZ3RoID09PSAxICYmXG4gICAgICBjaGFuZ2UuY2hhbmdlc1swXS5yZXYuc2xpY2UoMCwgMSkgPT09ICcxLScpIHtcbiAgICAgIGVtaXR0ZXIuZW1pdCgnY3JlYXRlJywgY2hhbmdlKTtcbiAgICB9IGVsc2Uge1xuICAgICAgZW1pdHRlci5lbWl0KCd1cGRhdGUnLCBjaGFuZ2UpO1xuICAgIH1cbiAgfTtcbiAgdmFyIHByb21pc2UgPSBuZXcgUHJvbWlzZShmdW5jdGlvbiAoZnVsZmlsbCwgcmVqZWN0KSB7XG4gICAgb3B0cy5jb21wbGV0ZSA9IGZ1bmN0aW9uIChlcnIsIHJlcykge1xuICAgICAgaWYgKGVycikge1xuICAgICAgICByZWplY3QoZXJyKTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIGZ1bGZpbGwocmVzKTtcbiAgICAgIH1cbiAgICB9O1xuICB9KTtcblxuICBwcm9taXNlLnRoZW4oZnVuY3Rpb24gKHJlc3VsdCkge1xuICAgIGNvbXBsZXRlKG51bGwsIHJlc3VsdCk7XG4gIH0sIGNvbXBsZXRlKTtcblxuICAvLyB0aGlzIG5lZWRzIHRvIGJlIG92ZXJ3cmlkZGVuIGJ5IGNhbGxlciwgZG9udCBmaXJlIGNvbXBsZXRlIHVudGlsXG4gIC8vIHRoZSB0YXNrIGlzIHJlYWR5XG4gIHByb21pc2UuY2FuY2VsID0gZnVuY3Rpb24gKCkge1xuICAgIHByb21pc2UuaXNDYW5jZWxsZWQgPSB0cnVlO1xuICAgIGlmIChzZWxmLnRhc2txdWV1ZS5pc1JlYWR5KSB7XG4gICAgICBvcHRzLmNvbXBsZXRlKG51bGwsIHtzdGF0dXM6ICdjYW5jZWxsZWQnfSk7XG4gICAgfVxuICB9O1xuXG4gIGlmICghc2VsZi50YXNrcXVldWUuaXNSZWFkeSkge1xuICAgIHNlbGYudGFza3F1ZXVlLmFkZFRhc2soZnVuY3Rpb24gKCkge1xuICAgICAgaWYgKHByb21pc2UuaXNDYW5jZWxsZWQpIHtcbiAgICAgICAgb3B0cy5jb21wbGV0ZShudWxsLCB7c3RhdHVzOiAnY2FuY2VsbGVkJ30pO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgZnVuKHNlbGYsIG9wdHMsIHByb21pc2UpO1xuICAgICAgfVxuICAgIH0pO1xuICB9IGVsc2Uge1xuICAgIGZ1bihzZWxmLCBvcHRzLCBwcm9taXNlKTtcbiAgfVxuICBwcm9taXNlLm9uID0gZW1pdHRlci5vbi5iaW5kKGVtaXR0ZXIpO1xuICBwcm9taXNlLm9uY2UgPSBlbWl0dGVyLm9uY2UuYmluZChlbWl0dGVyKTtcbiAgcHJvbWlzZS5hZGRMaXN0ZW5lciA9IGVtaXR0ZXIuYWRkTGlzdGVuZXIuYmluZChlbWl0dGVyKTtcbiAgcHJvbWlzZS5yZW1vdmVMaXN0ZW5lciA9IGVtaXR0ZXIucmVtb3ZlTGlzdGVuZXIuYmluZChlbWl0dGVyKTtcbiAgcHJvbWlzZS5yZW1vdmVBbGxMaXN0ZW5lcnMgPSBlbWl0dGVyLnJlbW92ZUFsbExpc3RlbmVycy5iaW5kKGVtaXR0ZXIpO1xuICBwcm9taXNlLnNldE1heExpc3RlbmVycyA9IGVtaXR0ZXIuc2V0TWF4TGlzdGVuZXJzLmJpbmQoZW1pdHRlcik7XG4gIHByb21pc2UubGlzdGVuZXJzID0gZW1pdHRlci5saXN0ZW5lcnMuYmluZChlbWl0dGVyKTtcbiAgcHJvbWlzZS5lbWl0ID0gZW1pdHRlci5lbWl0LmJpbmQoZW1pdHRlcik7XG4gIHJldHVybiBwcm9taXNlO1xufTtcblxuZXhwb3J0cy5NRDUgPSBleHBvcnRzLnRvUHJvbWlzZShfZGVyZXFfKCcuL2RlcHMvbWQ1JykpO1xuXG59KS5jYWxsKHRoaXMsX2RlcmVxXyhcIi9Vc2Vycy9ub2xhbi93b3Jrc3BhY2UvcG91Y2hkYi9ub2RlX21vZHVsZXMvYnJvd3NlcmlmeS9ub2RlX21vZHVsZXMvaW5zZXJ0LW1vZHVsZS1nbG9iYWxzL25vZGVfbW9kdWxlcy9wcm9jZXNzL2Jyb3dzZXIuanNcIiksdHlwZW9mIHNlbGYgIT09IFwidW5kZWZpbmVkXCIgPyBzZWxmIDogdHlwZW9mIHdpbmRvdyAhPT0gXCJ1bmRlZmluZWRcIiA/IHdpbmRvdyA6IHt9KVxufSx7XCIuL2RlcHMvYWpheFwiOjgsXCIuL2RlcHMvYmxvYlwiOjksXCIuL2RlcHMvYnVmZmVyXCI6MjYsXCIuL2RlcHMvY29sbGVjdGlvbnNcIjoxMCxcIi4vZGVwcy9lcnJvcnNcIjoxMSxcIi4vZGVwcy9tZDVcIjoxMixcIi4vZGVwcy91dWlkXCI6MTQsXCIuL21lcmdlXCI6MTgsXCIvVXNlcnMvbm9sYW4vd29ya3NwYWNlL3BvdWNoZGIvbm9kZV9tb2R1bGVzL2Jyb3dzZXJpZnkvbm9kZV9tb2R1bGVzL2luc2VydC1tb2R1bGUtZ2xvYmFscy9ub2RlX21vZHVsZXMvcHJvY2Vzcy9icm93c2VyLmpzXCI6MjgsXCJhcmdzYXJyYXlcIjoyNSxcImJsdWViaXJkXCI6MzMsXCJldmVudHNcIjoyNyxcImluaGVyaXRzXCI6MjksXCJwb3VjaGRiLWV4dGVuZFwiOjQ4fV0sMjQ6W2Z1bmN0aW9uKF9kZXJlcV8sbW9kdWxlLGV4cG9ydHMpe1xubW9kdWxlLmV4cG9ydHMgPSBcIjMuMC42XCI7XG5cbn0se31dLDI1OltmdW5jdGlvbihfZGVyZXFfLG1vZHVsZSxleHBvcnRzKXtcbid1c2Ugc3RyaWN0JztcblxubW9kdWxlLmV4cG9ydHMgPSBhcmdzQXJyYXk7XG5cbmZ1bmN0aW9uIGFyZ3NBcnJheShmdW4pIHtcbiAgcmV0dXJuIGZ1bmN0aW9uICgpIHtcbiAgICB2YXIgbGVuID0gYXJndW1lbnRzLmxlbmd0aDtcbiAgICBpZiAobGVuKSB7XG4gICAgICB2YXIgYXJncyA9IFtdO1xuICAgICAgdmFyIGkgPSAtMTtcbiAgICAgIHdoaWxlICgrK2kgPCBsZW4pIHtcbiAgICAgICAgYXJnc1tpXSA9IGFyZ3VtZW50c1tpXTtcbiAgICAgIH1cbiAgICAgIHJldHVybiBmdW4uY2FsbCh0aGlzLCBhcmdzKTtcbiAgICB9IGVsc2Uge1xuICAgICAgcmV0dXJuIGZ1bi5jYWxsKHRoaXMsIFtdKTtcbiAgICB9XG4gIH07XG59XG59LHt9XSwyNjpbZnVuY3Rpb24oX2RlcmVxXyxtb2R1bGUsZXhwb3J0cyl7XG5cbn0se31dLDI3OltmdW5jdGlvbihfZGVyZXFfLG1vZHVsZSxleHBvcnRzKXtcbi8vIENvcHlyaWdodCBKb3llbnQsIEluYy4gYW5kIG90aGVyIE5vZGUgY29udHJpYnV0b3JzLlxuLy9cbi8vIFBlcm1pc3Npb24gaXMgaGVyZWJ5IGdyYW50ZWQsIGZyZWUgb2YgY2hhcmdlLCB0byBhbnkgcGVyc29uIG9idGFpbmluZyBhXG4vLyBjb3B5IG9mIHRoaXMgc29mdHdhcmUgYW5kIGFzc29jaWF0ZWQgZG9jdW1lbnRhdGlvbiBmaWxlcyAodGhlXG4vLyBcIlNvZnR3YXJlXCIpLCB0byBkZWFsIGluIHRoZSBTb2Z0d2FyZSB3aXRob3V0IHJlc3RyaWN0aW9uLCBpbmNsdWRpbmdcbi8vIHdpdGhvdXQgbGltaXRhdGlvbiB0aGUgcmlnaHRzIHRvIHVzZSwgY29weSwgbW9kaWZ5LCBtZXJnZSwgcHVibGlzaCxcbi8vIGRpc3RyaWJ1dGUsIHN1YmxpY2Vuc2UsIGFuZC9vciBzZWxsIGNvcGllcyBvZiB0aGUgU29mdHdhcmUsIGFuZCB0byBwZXJtaXRcbi8vIHBlcnNvbnMgdG8gd2hvbSB0aGUgU29mdHdhcmUgaXMgZnVybmlzaGVkIHRvIGRvIHNvLCBzdWJqZWN0IHRvIHRoZVxuLy8gZm9sbG93aW5nIGNvbmRpdGlvbnM6XG4vL1xuLy8gVGhlIGFib3ZlIGNvcHlyaWdodCBub3RpY2UgYW5kIHRoaXMgcGVybWlzc2lvbiBub3RpY2Ugc2hhbGwgYmUgaW5jbHVkZWRcbi8vIGluIGFsbCBjb3BpZXMgb3Igc3Vic3RhbnRpYWwgcG9ydGlvbnMgb2YgdGhlIFNvZnR3YXJlLlxuLy9cbi8vIFRIRSBTT0ZUV0FSRSBJUyBQUk9WSURFRCBcIkFTIElTXCIsIFdJVEhPVVQgV0FSUkFOVFkgT0YgQU5ZIEtJTkQsIEVYUFJFU1Ncbi8vIE9SIElNUExJRUQsIElOQ0xVRElORyBCVVQgTk9UIExJTUlURUQgVE8gVEhFIFdBUlJBTlRJRVMgT0Zcbi8vIE1FUkNIQU5UQUJJTElUWSwgRklUTkVTUyBGT1IgQSBQQVJUSUNVTEFSIFBVUlBPU0UgQU5EIE5PTklORlJJTkdFTUVOVC4gSU5cbi8vIE5PIEVWRU5UIFNIQUxMIFRIRSBBVVRIT1JTIE9SIENPUFlSSUdIVCBIT0xERVJTIEJFIExJQUJMRSBGT1IgQU5ZIENMQUlNLFxuLy8gREFNQUdFUyBPUiBPVEhFUiBMSUFCSUxJVFksIFdIRVRIRVIgSU4gQU4gQUNUSU9OIE9GIENPTlRSQUNULCBUT1JUIE9SXG4vLyBPVEhFUldJU0UsIEFSSVNJTkcgRlJPTSwgT1VUIE9GIE9SIElOIENPTk5FQ1RJT04gV0lUSCBUSEUgU09GVFdBUkUgT1IgVEhFXG4vLyBVU0UgT1IgT1RIRVIgREVBTElOR1MgSU4gVEhFIFNPRlRXQVJFLlxuXG5mdW5jdGlvbiBFdmVudEVtaXR0ZXIoKSB7XG4gIHRoaXMuX2V2ZW50cyA9IHRoaXMuX2V2ZW50cyB8fCB7fTtcbiAgdGhpcy5fbWF4TGlzdGVuZXJzID0gdGhpcy5fbWF4TGlzdGVuZXJzIHx8IHVuZGVmaW5lZDtcbn1cbm1vZHVsZS5leHBvcnRzID0gRXZlbnRFbWl0dGVyO1xuXG4vLyBCYWNrd2FyZHMtY29tcGF0IHdpdGggbm9kZSAwLjEwLnhcbkV2ZW50RW1pdHRlci5FdmVudEVtaXR0ZXIgPSBFdmVudEVtaXR0ZXI7XG5cbkV2ZW50RW1pdHRlci5wcm90b3R5cGUuX2V2ZW50cyA9IHVuZGVmaW5lZDtcbkV2ZW50RW1pdHRlci5wcm90b3R5cGUuX21heExpc3RlbmVycyA9IHVuZGVmaW5lZDtcblxuLy8gQnkgZGVmYXVsdCBFdmVudEVtaXR0ZXJzIHdpbGwgcHJpbnQgYSB3YXJuaW5nIGlmIG1vcmUgdGhhbiAxMCBsaXN0ZW5lcnMgYXJlXG4vLyBhZGRlZCB0byBpdC4gVGhpcyBpcyBhIHVzZWZ1bCBkZWZhdWx0IHdoaWNoIGhlbHBzIGZpbmRpbmcgbWVtb3J5IGxlYWtzLlxuRXZlbnRFbWl0dGVyLmRlZmF1bHRNYXhMaXN0ZW5lcnMgPSAxMDtcblxuLy8gT2J2aW91c2x5IG5vdCBhbGwgRW1pdHRlcnMgc2hvdWxkIGJlIGxpbWl0ZWQgdG8gMTAuIFRoaXMgZnVuY3Rpb24gYWxsb3dzXG4vLyB0aGF0IHRvIGJlIGluY3JlYXNlZC4gU2V0IHRvIHplcm8gZm9yIHVubGltaXRlZC5cbkV2ZW50RW1pdHRlci5wcm90b3R5cGUuc2V0TWF4TGlzdGVuZXJzID0gZnVuY3Rpb24obikge1xuICBpZiAoIWlzTnVtYmVyKG4pIHx8IG4gPCAwIHx8IGlzTmFOKG4pKVxuICAgIHRocm93IFR5cGVFcnJvcignbiBtdXN0IGJlIGEgcG9zaXRpdmUgbnVtYmVyJyk7XG4gIHRoaXMuX21heExpc3RlbmVycyA9IG47XG4gIHJldHVybiB0aGlzO1xufTtcblxuRXZlbnRFbWl0dGVyLnByb3RvdHlwZS5lbWl0ID0gZnVuY3Rpb24odHlwZSkge1xuICB2YXIgZXIsIGhhbmRsZXIsIGxlbiwgYXJncywgaSwgbGlzdGVuZXJzO1xuXG4gIGlmICghdGhpcy5fZXZlbnRzKVxuICAgIHRoaXMuX2V2ZW50cyA9IHt9O1xuXG4gIC8vIElmIHRoZXJlIGlzIG5vICdlcnJvcicgZXZlbnQgbGlzdGVuZXIgdGhlbiB0aHJvdy5cbiAgaWYgKHR5cGUgPT09ICdlcnJvcicpIHtcbiAgICBpZiAoIXRoaXMuX2V2ZW50cy5lcnJvciB8fFxuICAgICAgICAoaXNPYmplY3QodGhpcy5fZXZlbnRzLmVycm9yKSAmJiAhdGhpcy5fZXZlbnRzLmVycm9yLmxlbmd0aCkpIHtcbiAgICAgIGVyID0gYXJndW1lbnRzWzFdO1xuICAgICAgaWYgKGVyIGluc3RhbmNlb2YgRXJyb3IpIHtcbiAgICAgICAgdGhyb3cgZXI7IC8vIFVuaGFuZGxlZCAnZXJyb3InIGV2ZW50XG4gICAgICB9XG4gICAgICB0aHJvdyBUeXBlRXJyb3IoJ1VuY2F1Z2h0LCB1bnNwZWNpZmllZCBcImVycm9yXCIgZXZlbnQuJyk7XG4gICAgfVxuICB9XG5cbiAgaGFuZGxlciA9IHRoaXMuX2V2ZW50c1t0eXBlXTtcblxuICBpZiAoaXNVbmRlZmluZWQoaGFuZGxlcikpXG4gICAgcmV0dXJuIGZhbHNlO1xuXG4gIGlmIChpc0Z1bmN0aW9uKGhhbmRsZXIpKSB7XG4gICAgc3dpdGNoIChhcmd1bWVudHMubGVuZ3RoKSB7XG4gICAgICAvLyBmYXN0IGNhc2VzXG4gICAgICBjYXNlIDE6XG4gICAgICAgIGhhbmRsZXIuY2FsbCh0aGlzKTtcbiAgICAgICAgYnJlYWs7XG4gICAgICBjYXNlIDI6XG4gICAgICAgIGhhbmRsZXIuY2FsbCh0aGlzLCBhcmd1bWVudHNbMV0pO1xuICAgICAgICBicmVhaztcbiAgICAgIGNhc2UgMzpcbiAgICAgICAgaGFuZGxlci5jYWxsKHRoaXMsIGFyZ3VtZW50c1sxXSwgYXJndW1lbnRzWzJdKTtcbiAgICAgICAgYnJlYWs7XG4gICAgICAvLyBzbG93ZXJcbiAgICAgIGRlZmF1bHQ6XG4gICAgICAgIGxlbiA9IGFyZ3VtZW50cy5sZW5ndGg7XG4gICAgICAgIGFyZ3MgPSBuZXcgQXJyYXkobGVuIC0gMSk7XG4gICAgICAgIGZvciAoaSA9IDE7IGkgPCBsZW47IGkrKylcbiAgICAgICAgICBhcmdzW2kgLSAxXSA9IGFyZ3VtZW50c1tpXTtcbiAgICAgICAgaGFuZGxlci5hcHBseSh0aGlzLCBhcmdzKTtcbiAgICB9XG4gIH0gZWxzZSBpZiAoaXNPYmplY3QoaGFuZGxlcikpIHtcbiAgICBsZW4gPSBhcmd1bWVudHMubGVuZ3RoO1xuICAgIGFyZ3MgPSBuZXcgQXJyYXkobGVuIC0gMSk7XG4gICAgZm9yIChpID0gMTsgaSA8IGxlbjsgaSsrKVxuICAgICAgYXJnc1tpIC0gMV0gPSBhcmd1bWVudHNbaV07XG5cbiAgICBsaXN0ZW5lcnMgPSBoYW5kbGVyLnNsaWNlKCk7XG4gICAgbGVuID0gbGlzdGVuZXJzLmxlbmd0aDtcbiAgICBmb3IgKGkgPSAwOyBpIDwgbGVuOyBpKyspXG4gICAgICBsaXN0ZW5lcnNbaV0uYXBwbHkodGhpcywgYXJncyk7XG4gIH1cblxuICByZXR1cm4gdHJ1ZTtcbn07XG5cbkV2ZW50RW1pdHRlci5wcm90b3R5cGUuYWRkTGlzdGVuZXIgPSBmdW5jdGlvbih0eXBlLCBsaXN0ZW5lcikge1xuICB2YXIgbTtcblxuICBpZiAoIWlzRnVuY3Rpb24obGlzdGVuZXIpKVxuICAgIHRocm93IFR5cGVFcnJvcignbGlzdGVuZXIgbXVzdCBiZSBhIGZ1bmN0aW9uJyk7XG5cbiAgaWYgKCF0aGlzLl9ldmVudHMpXG4gICAgdGhpcy5fZXZlbnRzID0ge307XG5cbiAgLy8gVG8gYXZvaWQgcmVjdXJzaW9uIGluIHRoZSBjYXNlIHRoYXQgdHlwZSA9PT0gXCJuZXdMaXN0ZW5lclwiISBCZWZvcmVcbiAgLy8gYWRkaW5nIGl0IHRvIHRoZSBsaXN0ZW5lcnMsIGZpcnN0IGVtaXQgXCJuZXdMaXN0ZW5lclwiLlxuICBpZiAodGhpcy5fZXZlbnRzLm5ld0xpc3RlbmVyKVxuICAgIHRoaXMuZW1pdCgnbmV3TGlzdGVuZXInLCB0eXBlLFxuICAgICAgICAgICAgICBpc0Z1bmN0aW9uKGxpc3RlbmVyLmxpc3RlbmVyKSA/XG4gICAgICAgICAgICAgIGxpc3RlbmVyLmxpc3RlbmVyIDogbGlzdGVuZXIpO1xuXG4gIGlmICghdGhpcy5fZXZlbnRzW3R5cGVdKVxuICAgIC8vIE9wdGltaXplIHRoZSBjYXNlIG9mIG9uZSBsaXN0ZW5lci4gRG9uJ3QgbmVlZCB0aGUgZXh0cmEgYXJyYXkgb2JqZWN0LlxuICAgIHRoaXMuX2V2ZW50c1t0eXBlXSA9IGxpc3RlbmVyO1xuICBlbHNlIGlmIChpc09iamVjdCh0aGlzLl9ldmVudHNbdHlwZV0pKVxuICAgIC8vIElmIHdlJ3ZlIGFscmVhZHkgZ290IGFuIGFycmF5LCBqdXN0IGFwcGVuZC5cbiAgICB0aGlzLl9ldmVudHNbdHlwZV0ucHVzaChsaXN0ZW5lcik7XG4gIGVsc2VcbiAgICAvLyBBZGRpbmcgdGhlIHNlY29uZCBlbGVtZW50LCBuZWVkIHRvIGNoYW5nZSB0byBhcnJheS5cbiAgICB0aGlzLl9ldmVudHNbdHlwZV0gPSBbdGhpcy5fZXZlbnRzW3R5cGVdLCBsaXN0ZW5lcl07XG5cbiAgLy8gQ2hlY2sgZm9yIGxpc3RlbmVyIGxlYWtcbiAgaWYgKGlzT2JqZWN0KHRoaXMuX2V2ZW50c1t0eXBlXSkgJiYgIXRoaXMuX2V2ZW50c1t0eXBlXS53YXJuZWQpIHtcbiAgICB2YXIgbTtcbiAgICBpZiAoIWlzVW5kZWZpbmVkKHRoaXMuX21heExpc3RlbmVycykpIHtcbiAgICAgIG0gPSB0aGlzLl9tYXhMaXN0ZW5lcnM7XG4gICAgfSBlbHNlIHtcbiAgICAgIG0gPSBFdmVudEVtaXR0ZXIuZGVmYXVsdE1heExpc3RlbmVycztcbiAgICB9XG5cbiAgICBpZiAobSAmJiBtID4gMCAmJiB0aGlzLl9ldmVudHNbdHlwZV0ubGVuZ3RoID4gbSkge1xuICAgICAgdGhpcy5fZXZlbnRzW3R5cGVdLndhcm5lZCA9IHRydWU7XG4gICAgICBjb25zb2xlLmVycm9yKCcobm9kZSkgd2FybmluZzogcG9zc2libGUgRXZlbnRFbWl0dGVyIG1lbW9yeSAnICtcbiAgICAgICAgICAgICAgICAgICAgJ2xlYWsgZGV0ZWN0ZWQuICVkIGxpc3RlbmVycyBhZGRlZC4gJyArXG4gICAgICAgICAgICAgICAgICAgICdVc2UgZW1pdHRlci5zZXRNYXhMaXN0ZW5lcnMoKSB0byBpbmNyZWFzZSBsaW1pdC4nLFxuICAgICAgICAgICAgICAgICAgICB0aGlzLl9ldmVudHNbdHlwZV0ubGVuZ3RoKTtcbiAgICAgIGlmICh0eXBlb2YgY29uc29sZS50cmFjZSA9PT0gJ2Z1bmN0aW9uJykge1xuICAgICAgICAvLyBub3Qgc3VwcG9ydGVkIGluIElFIDEwXG4gICAgICAgIGNvbnNvbGUudHJhY2UoKTtcbiAgICAgIH1cbiAgICB9XG4gIH1cblxuICByZXR1cm4gdGhpcztcbn07XG5cbkV2ZW50RW1pdHRlci5wcm90b3R5cGUub24gPSBFdmVudEVtaXR0ZXIucHJvdG90eXBlLmFkZExpc3RlbmVyO1xuXG5FdmVudEVtaXR0ZXIucHJvdG90eXBlLm9uY2UgPSBmdW5jdGlvbih0eXBlLCBsaXN0ZW5lcikge1xuICBpZiAoIWlzRnVuY3Rpb24obGlzdGVuZXIpKVxuICAgIHRocm93IFR5cGVFcnJvcignbGlzdGVuZXIgbXVzdCBiZSBhIGZ1bmN0aW9uJyk7XG5cbiAgdmFyIGZpcmVkID0gZmFsc2U7XG5cbiAgZnVuY3Rpb24gZygpIHtcbiAgICB0aGlzLnJlbW92ZUxpc3RlbmVyKHR5cGUsIGcpO1xuXG4gICAgaWYgKCFmaXJlZCkge1xuICAgICAgZmlyZWQgPSB0cnVlO1xuICAgICAgbGlzdGVuZXIuYXBwbHkodGhpcywgYXJndW1lbnRzKTtcbiAgICB9XG4gIH1cblxuICBnLmxpc3RlbmVyID0gbGlzdGVuZXI7XG4gIHRoaXMub24odHlwZSwgZyk7XG5cbiAgcmV0dXJuIHRoaXM7XG59O1xuXG4vLyBlbWl0cyBhICdyZW1vdmVMaXN0ZW5lcicgZXZlbnQgaWZmIHRoZSBsaXN0ZW5lciB3YXMgcmVtb3ZlZFxuRXZlbnRFbWl0dGVyLnByb3RvdHlwZS5yZW1vdmVMaXN0ZW5lciA9IGZ1bmN0aW9uKHR5cGUsIGxpc3RlbmVyKSB7XG4gIHZhciBsaXN0LCBwb3NpdGlvbiwgbGVuZ3RoLCBpO1xuXG4gIGlmICghaXNGdW5jdGlvbihsaXN0ZW5lcikpXG4gICAgdGhyb3cgVHlwZUVycm9yKCdsaXN0ZW5lciBtdXN0IGJlIGEgZnVuY3Rpb24nKTtcblxuICBpZiAoIXRoaXMuX2V2ZW50cyB8fCAhdGhpcy5fZXZlbnRzW3R5cGVdKVxuICAgIHJldHVybiB0aGlzO1xuXG4gIGxpc3QgPSB0aGlzLl9ldmVudHNbdHlwZV07XG4gIGxlbmd0aCA9IGxpc3QubGVuZ3RoO1xuICBwb3NpdGlvbiA9IC0xO1xuXG4gIGlmIChsaXN0ID09PSBsaXN0ZW5lciB8fFxuICAgICAgKGlzRnVuY3Rpb24obGlzdC5saXN0ZW5lcikgJiYgbGlzdC5saXN0ZW5lciA9PT0gbGlzdGVuZXIpKSB7XG4gICAgZGVsZXRlIHRoaXMuX2V2ZW50c1t0eXBlXTtcbiAgICBpZiAodGhpcy5fZXZlbnRzLnJlbW92ZUxpc3RlbmVyKVxuICAgICAgdGhpcy5lbWl0KCdyZW1vdmVMaXN0ZW5lcicsIHR5cGUsIGxpc3RlbmVyKTtcblxuICB9IGVsc2UgaWYgKGlzT2JqZWN0KGxpc3QpKSB7XG4gICAgZm9yIChpID0gbGVuZ3RoOyBpLS0gPiAwOykge1xuICAgICAgaWYgKGxpc3RbaV0gPT09IGxpc3RlbmVyIHx8XG4gICAgICAgICAgKGxpc3RbaV0ubGlzdGVuZXIgJiYgbGlzdFtpXS5saXN0ZW5lciA9PT0gbGlzdGVuZXIpKSB7XG4gICAgICAgIHBvc2l0aW9uID0gaTtcbiAgICAgICAgYnJlYWs7XG4gICAgICB9XG4gICAgfVxuXG4gICAgaWYgKHBvc2l0aW9uIDwgMClcbiAgICAgIHJldHVybiB0aGlzO1xuXG4gICAgaWYgKGxpc3QubGVuZ3RoID09PSAxKSB7XG4gICAgICBsaXN0Lmxlbmd0aCA9IDA7XG4gICAgICBkZWxldGUgdGhpcy5fZXZlbnRzW3R5cGVdO1xuICAgIH0gZWxzZSB7XG4gICAgICBsaXN0LnNwbGljZShwb3NpdGlvbiwgMSk7XG4gICAgfVxuXG4gICAgaWYgKHRoaXMuX2V2ZW50cy5yZW1vdmVMaXN0ZW5lcilcbiAgICAgIHRoaXMuZW1pdCgncmVtb3ZlTGlzdGVuZXInLCB0eXBlLCBsaXN0ZW5lcik7XG4gIH1cblxuICByZXR1cm4gdGhpcztcbn07XG5cbkV2ZW50RW1pdHRlci5wcm90b3R5cGUucmVtb3ZlQWxsTGlzdGVuZXJzID0gZnVuY3Rpb24odHlwZSkge1xuICB2YXIga2V5LCBsaXN0ZW5lcnM7XG5cbiAgaWYgKCF0aGlzLl9ldmVudHMpXG4gICAgcmV0dXJuIHRoaXM7XG5cbiAgLy8gbm90IGxpc3RlbmluZyBmb3IgcmVtb3ZlTGlzdGVuZXIsIG5vIG5lZWQgdG8gZW1pdFxuICBpZiAoIXRoaXMuX2V2ZW50cy5yZW1vdmVMaXN0ZW5lcikge1xuICAgIGlmIChhcmd1bWVudHMubGVuZ3RoID09PSAwKVxuICAgICAgdGhpcy5fZXZlbnRzID0ge307XG4gICAgZWxzZSBpZiAodGhpcy5fZXZlbnRzW3R5cGVdKVxuICAgICAgZGVsZXRlIHRoaXMuX2V2ZW50c1t0eXBlXTtcbiAgICByZXR1cm4gdGhpcztcbiAgfVxuXG4gIC8vIGVtaXQgcmVtb3ZlTGlzdGVuZXIgZm9yIGFsbCBsaXN0ZW5lcnMgb24gYWxsIGV2ZW50c1xuICBpZiAoYXJndW1lbnRzLmxlbmd0aCA9PT0gMCkge1xuICAgIGZvciAoa2V5IGluIHRoaXMuX2V2ZW50cykge1xuICAgICAgaWYgKGtleSA9PT0gJ3JlbW92ZUxpc3RlbmVyJykgY29udGludWU7XG4gICAgICB0aGlzLnJlbW92ZUFsbExpc3RlbmVycyhrZXkpO1xuICAgIH1cbiAgICB0aGlzLnJlbW92ZUFsbExpc3RlbmVycygncmVtb3ZlTGlzdGVuZXInKTtcbiAgICB0aGlzLl9ldmVudHMgPSB7fTtcbiAgICByZXR1cm4gdGhpcztcbiAgfVxuXG4gIGxpc3RlbmVycyA9IHRoaXMuX2V2ZW50c1t0eXBlXTtcblxuICBpZiAoaXNGdW5jdGlvbihsaXN0ZW5lcnMpKSB7XG4gICAgdGhpcy5yZW1vdmVMaXN0ZW5lcih0eXBlLCBsaXN0ZW5lcnMpO1xuICB9IGVsc2Uge1xuICAgIC8vIExJRk8gb3JkZXJcbiAgICB3aGlsZSAobGlzdGVuZXJzLmxlbmd0aClcbiAgICAgIHRoaXMucmVtb3ZlTGlzdGVuZXIodHlwZSwgbGlzdGVuZXJzW2xpc3RlbmVycy5sZW5ndGggLSAxXSk7XG4gIH1cbiAgZGVsZXRlIHRoaXMuX2V2ZW50c1t0eXBlXTtcblxuICByZXR1cm4gdGhpcztcbn07XG5cbkV2ZW50RW1pdHRlci5wcm90b3R5cGUubGlzdGVuZXJzID0gZnVuY3Rpb24odHlwZSkge1xuICB2YXIgcmV0O1xuICBpZiAoIXRoaXMuX2V2ZW50cyB8fCAhdGhpcy5fZXZlbnRzW3R5cGVdKVxuICAgIHJldCA9IFtdO1xuICBlbHNlIGlmIChpc0Z1bmN0aW9uKHRoaXMuX2V2ZW50c1t0eXBlXSkpXG4gICAgcmV0ID0gW3RoaXMuX2V2ZW50c1t0eXBlXV07XG4gIGVsc2VcbiAgICByZXQgPSB0aGlzLl9ldmVudHNbdHlwZV0uc2xpY2UoKTtcbiAgcmV0dXJuIHJldDtcbn07XG5cbkV2ZW50RW1pdHRlci5saXN0ZW5lckNvdW50ID0gZnVuY3Rpb24oZW1pdHRlciwgdHlwZSkge1xuICB2YXIgcmV0O1xuICBpZiAoIWVtaXR0ZXIuX2V2ZW50cyB8fCAhZW1pdHRlci5fZXZlbnRzW3R5cGVdKVxuICAgIHJldCA9IDA7XG4gIGVsc2UgaWYgKGlzRnVuY3Rpb24oZW1pdHRlci5fZXZlbnRzW3R5cGVdKSlcbiAgICByZXQgPSAxO1xuICBlbHNlXG4gICAgcmV0ID0gZW1pdHRlci5fZXZlbnRzW3R5cGVdLmxlbmd0aDtcbiAgcmV0dXJuIHJldDtcbn07XG5cbmZ1bmN0aW9uIGlzRnVuY3Rpb24oYXJnKSB7XG4gIHJldHVybiB0eXBlb2YgYXJnID09PSAnZnVuY3Rpb24nO1xufVxuXG5mdW5jdGlvbiBpc051bWJlcihhcmcpIHtcbiAgcmV0dXJuIHR5cGVvZiBhcmcgPT09ICdudW1iZXInO1xufVxuXG5mdW5jdGlvbiBpc09iamVjdChhcmcpIHtcbiAgcmV0dXJuIHR5cGVvZiBhcmcgPT09ICdvYmplY3QnICYmIGFyZyAhPT0gbnVsbDtcbn1cblxuZnVuY3Rpb24gaXNVbmRlZmluZWQoYXJnKSB7XG4gIHJldHVybiBhcmcgPT09IHZvaWQgMDtcbn1cblxufSx7fV0sMjg6W2Z1bmN0aW9uKF9kZXJlcV8sbW9kdWxlLGV4cG9ydHMpe1xuLy8gc2hpbSBmb3IgdXNpbmcgcHJvY2VzcyBpbiBicm93c2VyXG5cbnZhciBwcm9jZXNzID0gbW9kdWxlLmV4cG9ydHMgPSB7fTtcblxucHJvY2Vzcy5uZXh0VGljayA9IChmdW5jdGlvbiAoKSB7XG4gICAgdmFyIGNhblNldEltbWVkaWF0ZSA9IHR5cGVvZiB3aW5kb3cgIT09ICd1bmRlZmluZWQnXG4gICAgJiYgd2luZG93LnNldEltbWVkaWF0ZTtcbiAgICB2YXIgY2FuUG9zdCA9IHR5cGVvZiB3aW5kb3cgIT09ICd1bmRlZmluZWQnXG4gICAgJiYgd2luZG93LnBvc3RNZXNzYWdlICYmIHdpbmRvdy5hZGRFdmVudExpc3RlbmVyXG4gICAgO1xuXG4gICAgaWYgKGNhblNldEltbWVkaWF0ZSkge1xuICAgICAgICByZXR1cm4gZnVuY3Rpb24gKGYpIHsgcmV0dXJuIHdpbmRvdy5zZXRJbW1lZGlhdGUoZikgfTtcbiAgICB9XG5cbiAgICBpZiAoY2FuUG9zdCkge1xuICAgICAgICB2YXIgcXVldWUgPSBbXTtcbiAgICAgICAgd2luZG93LmFkZEV2ZW50TGlzdGVuZXIoJ21lc3NhZ2UnLCBmdW5jdGlvbiAoZXYpIHtcbiAgICAgICAgICAgIHZhciBzb3VyY2UgPSBldi5zb3VyY2U7XG4gICAgICAgICAgICBpZiAoKHNvdXJjZSA9PT0gd2luZG93IHx8IHNvdXJjZSA9PT0gbnVsbCkgJiYgZXYuZGF0YSA9PT0gJ3Byb2Nlc3MtdGljaycpIHtcbiAgICAgICAgICAgICAgICBldi5zdG9wUHJvcGFnYXRpb24oKTtcbiAgICAgICAgICAgICAgICBpZiAocXVldWUubGVuZ3RoID4gMCkge1xuICAgICAgICAgICAgICAgICAgICB2YXIgZm4gPSBxdWV1ZS5zaGlmdCgpO1xuICAgICAgICAgICAgICAgICAgICBmbigpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgfSwgdHJ1ZSk7XG5cbiAgICAgICAgcmV0dXJuIGZ1bmN0aW9uIG5leHRUaWNrKGZuKSB7XG4gICAgICAgICAgICBxdWV1ZS5wdXNoKGZuKTtcbiAgICAgICAgICAgIHdpbmRvdy5wb3N0TWVzc2FnZSgncHJvY2Vzcy10aWNrJywgJyonKTtcbiAgICAgICAgfTtcbiAgICB9XG5cbiAgICByZXR1cm4gZnVuY3Rpb24gbmV4dFRpY2soZm4pIHtcbiAgICAgICAgc2V0VGltZW91dChmbiwgMCk7XG4gICAgfTtcbn0pKCk7XG5cbnByb2Nlc3MudGl0bGUgPSAnYnJvd3Nlcic7XG5wcm9jZXNzLmJyb3dzZXIgPSB0cnVlO1xucHJvY2Vzcy5lbnYgPSB7fTtcbnByb2Nlc3MuYXJndiA9IFtdO1xuXG5wcm9jZXNzLmJpbmRpbmcgPSBmdW5jdGlvbiAobmFtZSkge1xuICAgIHRocm93IG5ldyBFcnJvcigncHJvY2Vzcy5iaW5kaW5nIGlzIG5vdCBzdXBwb3J0ZWQnKTtcbn1cblxuLy8gVE9ETyhzaHR5bG1hbilcbnByb2Nlc3MuY3dkID0gZnVuY3Rpb24gKCkgeyByZXR1cm4gJy8nIH07XG5wcm9jZXNzLmNoZGlyID0gZnVuY3Rpb24gKGRpcikge1xuICAgIHRocm93IG5ldyBFcnJvcigncHJvY2Vzcy5jaGRpciBpcyBub3Qgc3VwcG9ydGVkJyk7XG59O1xuXG59LHt9XSwyOTpbZnVuY3Rpb24oX2RlcmVxXyxtb2R1bGUsZXhwb3J0cyl7XG5pZiAodHlwZW9mIE9iamVjdC5jcmVhdGUgPT09ICdmdW5jdGlvbicpIHtcbiAgLy8gaW1wbGVtZW50YXRpb24gZnJvbSBzdGFuZGFyZCBub2RlLmpzICd1dGlsJyBtb2R1bGVcbiAgbW9kdWxlLmV4cG9ydHMgPSBmdW5jdGlvbiBpbmhlcml0cyhjdG9yLCBzdXBlckN0b3IpIHtcbiAgICBjdG9yLnN1cGVyXyA9IHN1cGVyQ3RvclxuICAgIGN0b3IucHJvdG90eXBlID0gT2JqZWN0LmNyZWF0ZShzdXBlckN0b3IucHJvdG90eXBlLCB7XG4gICAgICBjb25zdHJ1Y3Rvcjoge1xuICAgICAgICB2YWx1ZTogY3RvcixcbiAgICAgICAgZW51bWVyYWJsZTogZmFsc2UsXG4gICAgICAgIHdyaXRhYmxlOiB0cnVlLFxuICAgICAgICBjb25maWd1cmFibGU6IHRydWVcbiAgICAgIH1cbiAgICB9KTtcbiAgfTtcbn0gZWxzZSB7XG4gIC8vIG9sZCBzY2hvb2wgc2hpbSBmb3Igb2xkIGJyb3dzZXJzXG4gIG1vZHVsZS5leHBvcnRzID0gZnVuY3Rpb24gaW5oZXJpdHMoY3Rvciwgc3VwZXJDdG9yKSB7XG4gICAgY3Rvci5zdXBlcl8gPSBzdXBlckN0b3JcbiAgICB2YXIgVGVtcEN0b3IgPSBmdW5jdGlvbiAoKSB7fVxuICAgIFRlbXBDdG9yLnByb3RvdHlwZSA9IHN1cGVyQ3Rvci5wcm90b3R5cGVcbiAgICBjdG9yLnByb3RvdHlwZSA9IG5ldyBUZW1wQ3RvcigpXG4gICAgY3Rvci5wcm90b3R5cGUuY29uc3RydWN0b3IgPSBjdG9yXG4gIH1cbn1cblxufSx7fV0sMzA6W2Z1bmN0aW9uKF9kZXJlcV8sbW9kdWxlLGV4cG9ydHMpe1xuJ3VzZSBzdHJpY3QnO1xuXG5tb2R1bGUuZXhwb3J0cyA9IElOVEVSTkFMO1xuXG5mdW5jdGlvbiBJTlRFUk5BTCgpIHt9XG59LHt9XSwzMTpbZnVuY3Rpb24oX2RlcmVxXyxtb2R1bGUsZXhwb3J0cyl7XG4ndXNlIHN0cmljdCc7XG52YXIgUHJvbWlzZSA9IF9kZXJlcV8oJy4vcHJvbWlzZScpO1xudmFyIHJlamVjdCA9IF9kZXJlcV8oJy4vcmVqZWN0Jyk7XG52YXIgcmVzb2x2ZSA9IF9kZXJlcV8oJy4vcmVzb2x2ZScpO1xudmFyIElOVEVSTkFMID0gX2RlcmVxXygnLi9JTlRFUk5BTCcpO1xudmFyIGhhbmRsZXJzID0gX2RlcmVxXygnLi9oYW5kbGVycycpO1xubW9kdWxlLmV4cG9ydHMgPSBhbGw7XG5mdW5jdGlvbiBhbGwoaXRlcmFibGUpIHtcbiAgaWYgKE9iamVjdC5wcm90b3R5cGUudG9TdHJpbmcuY2FsbChpdGVyYWJsZSkgIT09ICdbb2JqZWN0IEFycmF5XScpIHtcbiAgICByZXR1cm4gcmVqZWN0KG5ldyBUeXBlRXJyb3IoJ211c3QgYmUgYW4gYXJyYXknKSk7XG4gIH1cblxuICB2YXIgbGVuID0gaXRlcmFibGUubGVuZ3RoO1xuICB2YXIgY2FsbGVkID0gZmFsc2U7XG4gIGlmICghbGVuKSB7XG4gICAgcmV0dXJuIHJlc29sdmUoW10pO1xuICB9XG5cbiAgdmFyIHZhbHVlcyA9IG5ldyBBcnJheShsZW4pO1xuICB2YXIgcmVzb2x2ZWQgPSAwO1xuICB2YXIgaSA9IC0xO1xuICB2YXIgcHJvbWlzZSA9IG5ldyBQcm9taXNlKElOVEVSTkFMKTtcbiAgXG4gIHdoaWxlICgrK2kgPCBsZW4pIHtcbiAgICBhbGxSZXNvbHZlcihpdGVyYWJsZVtpXSwgaSk7XG4gIH1cbiAgcmV0dXJuIHByb21pc2U7XG4gIGZ1bmN0aW9uIGFsbFJlc29sdmVyKHZhbHVlLCBpKSB7XG4gICAgcmVzb2x2ZSh2YWx1ZSkudGhlbihyZXNvbHZlRnJvbUFsbCwgZnVuY3Rpb24gKGVycm9yKSB7XG4gICAgICBpZiAoIWNhbGxlZCkge1xuICAgICAgICBjYWxsZWQgPSB0cnVlO1xuICAgICAgICBoYW5kbGVycy5yZWplY3QocHJvbWlzZSwgZXJyb3IpO1xuICAgICAgfVxuICAgIH0pO1xuICAgIGZ1bmN0aW9uIHJlc29sdmVGcm9tQWxsKG91dFZhbHVlKSB7XG4gICAgICB2YWx1ZXNbaV0gPSBvdXRWYWx1ZTtcbiAgICAgIGlmICgrK3Jlc29sdmVkID09PSBsZW4gJiAhY2FsbGVkKSB7XG4gICAgICAgIGNhbGxlZCA9IHRydWU7XG4gICAgICAgIGhhbmRsZXJzLnJlc29sdmUocHJvbWlzZSwgdmFsdWVzKTtcbiAgICAgIH1cbiAgICB9XG4gIH1cbn1cbn0se1wiLi9JTlRFUk5BTFwiOjMwLFwiLi9oYW5kbGVyc1wiOjMyLFwiLi9wcm9taXNlXCI6MzQsXCIuL3JlamVjdFwiOjM3LFwiLi9yZXNvbHZlXCI6Mzh9XSwzMjpbZnVuY3Rpb24oX2RlcmVxXyxtb2R1bGUsZXhwb3J0cyl7XG4ndXNlIHN0cmljdCc7XG52YXIgdHJ5Q2F0Y2ggPSBfZGVyZXFfKCcuL3RyeUNhdGNoJyk7XG52YXIgcmVzb2x2ZVRoZW5hYmxlID0gX2RlcmVxXygnLi9yZXNvbHZlVGhlbmFibGUnKTtcbnZhciBzdGF0ZXMgPSBfZGVyZXFfKCcuL3N0YXRlcycpO1xuXG5leHBvcnRzLnJlc29sdmUgPSBmdW5jdGlvbiAoc2VsZiwgdmFsdWUpIHtcbiAgdmFyIHJlc3VsdCA9IHRyeUNhdGNoKGdldFRoZW4sIHZhbHVlKTtcbiAgaWYgKHJlc3VsdC5zdGF0dXMgPT09ICdlcnJvcicpIHtcbiAgICByZXR1cm4gZXhwb3J0cy5yZWplY3Qoc2VsZiwgcmVzdWx0LnZhbHVlKTtcbiAgfVxuICB2YXIgdGhlbmFibGUgPSByZXN1bHQudmFsdWU7XG5cbiAgaWYgKHRoZW5hYmxlKSB7XG4gICAgcmVzb2x2ZVRoZW5hYmxlLnNhZmVseShzZWxmLCB0aGVuYWJsZSk7XG4gIH0gZWxzZSB7XG4gICAgc2VsZi5zdGF0ZSA9IHN0YXRlcy5GVUxGSUxMRUQ7XG4gICAgc2VsZi5vdXRjb21lID0gdmFsdWU7XG4gICAgdmFyIGkgPSAtMTtcbiAgICB2YXIgbGVuID0gc2VsZi5xdWV1ZS5sZW5ndGg7XG4gICAgd2hpbGUgKCsraSA8IGxlbikge1xuICAgICAgc2VsZi5xdWV1ZVtpXS5jYWxsRnVsZmlsbGVkKHZhbHVlKTtcbiAgICB9XG4gIH1cbiAgcmV0dXJuIHNlbGY7XG59O1xuZXhwb3J0cy5yZWplY3QgPSBmdW5jdGlvbiAoc2VsZiwgZXJyb3IpIHtcbiAgc2VsZi5zdGF0ZSA9IHN0YXRlcy5SRUpFQ1RFRDtcbiAgc2VsZi5vdXRjb21lID0gZXJyb3I7XG4gIHZhciBpID0gLTE7XG4gIHZhciBsZW4gPSBzZWxmLnF1ZXVlLmxlbmd0aDtcbiAgd2hpbGUgKCsraSA8IGxlbikge1xuICAgIHNlbGYucXVldWVbaV0uY2FsbFJlamVjdGVkKGVycm9yKTtcbiAgfVxuICByZXR1cm4gc2VsZjtcbn07XG5cbmZ1bmN0aW9uIGdldFRoZW4ob2JqKSB7XG4gIC8vIE1ha2Ugc3VyZSB3ZSBvbmx5IGFjY2VzcyB0aGUgYWNjZXNzb3Igb25jZSBhcyByZXF1aXJlZCBieSB0aGUgc3BlY1xuICB2YXIgdGhlbiA9IG9iaiAmJiBvYmoudGhlbjtcbiAgaWYgKG9iaiAmJiB0eXBlb2Ygb2JqID09PSAnb2JqZWN0JyAmJiB0eXBlb2YgdGhlbiA9PT0gJ2Z1bmN0aW9uJykge1xuICAgIHJldHVybiBmdW5jdGlvbiBhcHB5VGhlbigpIHtcbiAgICAgIHRoZW4uYXBwbHkob2JqLCBhcmd1bWVudHMpO1xuICAgIH07XG4gIH1cbn1cbn0se1wiLi9yZXNvbHZlVGhlbmFibGVcIjozOSxcIi4vc3RhdGVzXCI6NDAsXCIuL3RyeUNhdGNoXCI6NDF9XSwzMzpbZnVuY3Rpb24oX2RlcmVxXyxtb2R1bGUsZXhwb3J0cyl7XG5tb2R1bGUuZXhwb3J0cyA9IGV4cG9ydHMgPSBfZGVyZXFfKCcuL3Byb21pc2UnKTtcblxuZXhwb3J0cy5yZXNvbHZlID0gX2RlcmVxXygnLi9yZXNvbHZlJyk7XG5leHBvcnRzLnJlamVjdCA9IF9kZXJlcV8oJy4vcmVqZWN0Jyk7XG5leHBvcnRzLmFsbCA9IF9kZXJlcV8oJy4vYWxsJyk7XG5leHBvcnRzLnJhY2UgPSBfZGVyZXFfKCcuL3JhY2UnKTtcbn0se1wiLi9hbGxcIjozMSxcIi4vcHJvbWlzZVwiOjM0LFwiLi9yYWNlXCI6MzYsXCIuL3JlamVjdFwiOjM3LFwiLi9yZXNvbHZlXCI6Mzh9XSwzNDpbZnVuY3Rpb24oX2RlcmVxXyxtb2R1bGUsZXhwb3J0cyl7XG4ndXNlIHN0cmljdCc7XG5cbnZhciB1bndyYXAgPSBfZGVyZXFfKCcuL3Vud3JhcCcpO1xudmFyIElOVEVSTkFMID0gX2RlcmVxXygnLi9JTlRFUk5BTCcpO1xudmFyIHJlc29sdmVUaGVuYWJsZSA9IF9kZXJlcV8oJy4vcmVzb2x2ZVRoZW5hYmxlJyk7XG52YXIgc3RhdGVzID0gX2RlcmVxXygnLi9zdGF0ZXMnKTtcbnZhciBRdWV1ZUl0ZW0gPSBfZGVyZXFfKCcuL3F1ZXVlSXRlbScpO1xuXG5tb2R1bGUuZXhwb3J0cyA9IFByb21pc2U7XG5mdW5jdGlvbiBQcm9taXNlKHJlc29sdmVyKSB7XG4gIGlmICghKHRoaXMgaW5zdGFuY2VvZiBQcm9taXNlKSkge1xuICAgIHJldHVybiBuZXcgUHJvbWlzZShyZXNvbHZlcik7XG4gIH1cbiAgaWYgKHR5cGVvZiByZXNvbHZlciAhPT0gJ2Z1bmN0aW9uJykge1xuICAgIHRocm93IG5ldyBUeXBlRXJyb3IoJ3Jlc2xvdmVyIG11c3QgYmUgYSBmdW5jdGlvbicpO1xuICB9XG4gIHRoaXMuc3RhdGUgPSBzdGF0ZXMuUEVORElORztcbiAgdGhpcy5xdWV1ZSA9IFtdO1xuICB0aGlzLm91dGNvbWUgPSB2b2lkIDA7XG4gIGlmIChyZXNvbHZlciAhPT0gSU5URVJOQUwpIHtcbiAgICByZXNvbHZlVGhlbmFibGUuc2FmZWx5KHRoaXMsIHJlc29sdmVyKTtcbiAgfVxufVxuXG5Qcm9taXNlLnByb3RvdHlwZVsnY2F0Y2gnXSA9IGZ1bmN0aW9uIChvblJlamVjdGVkKSB7XG4gIHJldHVybiB0aGlzLnRoZW4obnVsbCwgb25SZWplY3RlZCk7XG59O1xuUHJvbWlzZS5wcm90b3R5cGUudGhlbiA9IGZ1bmN0aW9uIChvbkZ1bGZpbGxlZCwgb25SZWplY3RlZCkge1xuICBpZiAodHlwZW9mIG9uRnVsZmlsbGVkICE9PSAnZnVuY3Rpb24nICYmIHRoaXMuc3RhdGUgPT09IHN0YXRlcy5GVUxGSUxMRUQgfHxcbiAgICB0eXBlb2Ygb25SZWplY3RlZCAhPT0gJ2Z1bmN0aW9uJyAmJiB0aGlzLnN0YXRlID09PSBzdGF0ZXMuUkVKRUNURUQpIHtcbiAgICByZXR1cm4gdGhpcztcbiAgfVxuICB2YXIgcHJvbWlzZSA9IG5ldyBQcm9taXNlKElOVEVSTkFMKTtcblxuICBcbiAgaWYgKHRoaXMuc3RhdGUgIT09IHN0YXRlcy5QRU5ESU5HKSB7XG4gICAgdmFyIHJlc29sdmVyID0gdGhpcy5zdGF0ZSA9PT0gc3RhdGVzLkZVTEZJTExFRCA/IG9uRnVsZmlsbGVkOiBvblJlamVjdGVkO1xuICAgIHVud3JhcChwcm9taXNlLCByZXNvbHZlciwgdGhpcy5vdXRjb21lKTtcbiAgfSBlbHNlIHtcbiAgICB0aGlzLnF1ZXVlLnB1c2gobmV3IFF1ZXVlSXRlbShwcm9taXNlLCBvbkZ1bGZpbGxlZCwgb25SZWplY3RlZCkpO1xuICB9XG5cbiAgcmV0dXJuIHByb21pc2U7XG59O1xuXG59LHtcIi4vSU5URVJOQUxcIjozMCxcIi4vcXVldWVJdGVtXCI6MzUsXCIuL3Jlc29sdmVUaGVuYWJsZVwiOjM5LFwiLi9zdGF0ZXNcIjo0MCxcIi4vdW53cmFwXCI6NDJ9XSwzNTpbZnVuY3Rpb24oX2RlcmVxXyxtb2R1bGUsZXhwb3J0cyl7XG4ndXNlIHN0cmljdCc7XG52YXIgaGFuZGxlcnMgPSBfZGVyZXFfKCcuL2hhbmRsZXJzJyk7XG52YXIgdW53cmFwID0gX2RlcmVxXygnLi91bndyYXAnKTtcblxubW9kdWxlLmV4cG9ydHMgPSBRdWV1ZUl0ZW07XG5mdW5jdGlvbiBRdWV1ZUl0ZW0ocHJvbWlzZSwgb25GdWxmaWxsZWQsIG9uUmVqZWN0ZWQpIHtcbiAgdGhpcy5wcm9taXNlID0gcHJvbWlzZTtcbiAgaWYgKHR5cGVvZiBvbkZ1bGZpbGxlZCA9PT0gJ2Z1bmN0aW9uJykge1xuICAgIHRoaXMub25GdWxmaWxsZWQgPSBvbkZ1bGZpbGxlZDtcbiAgICB0aGlzLmNhbGxGdWxmaWxsZWQgPSB0aGlzLm90aGVyQ2FsbEZ1bGZpbGxlZDtcbiAgfVxuICBpZiAodHlwZW9mIG9uUmVqZWN0ZWQgPT09ICdmdW5jdGlvbicpIHtcbiAgICB0aGlzLm9uUmVqZWN0ZWQgPSBvblJlamVjdGVkO1xuICAgIHRoaXMuY2FsbFJlamVjdGVkID0gdGhpcy5vdGhlckNhbGxSZWplY3RlZDtcbiAgfVxufVxuUXVldWVJdGVtLnByb3RvdHlwZS5jYWxsRnVsZmlsbGVkID0gZnVuY3Rpb24gKHZhbHVlKSB7XG4gIGhhbmRsZXJzLnJlc29sdmUodGhpcy5wcm9taXNlLCB2YWx1ZSk7XG59O1xuUXVldWVJdGVtLnByb3RvdHlwZS5vdGhlckNhbGxGdWxmaWxsZWQgPSBmdW5jdGlvbiAodmFsdWUpIHtcbiAgdW53cmFwKHRoaXMucHJvbWlzZSwgdGhpcy5vbkZ1bGZpbGxlZCwgdmFsdWUpO1xufTtcblF1ZXVlSXRlbS5wcm90b3R5cGUuY2FsbFJlamVjdGVkID0gZnVuY3Rpb24gKHZhbHVlKSB7XG4gIGhhbmRsZXJzLnJlamVjdCh0aGlzLnByb21pc2UsIHZhbHVlKTtcbn07XG5RdWV1ZUl0ZW0ucHJvdG90eXBlLm90aGVyQ2FsbFJlamVjdGVkID0gZnVuY3Rpb24gKHZhbHVlKSB7XG4gIHVud3JhcCh0aGlzLnByb21pc2UsIHRoaXMub25SZWplY3RlZCwgdmFsdWUpO1xufTtcbn0se1wiLi9oYW5kbGVyc1wiOjMyLFwiLi91bndyYXBcIjo0Mn1dLDM2OltmdW5jdGlvbihfZGVyZXFfLG1vZHVsZSxleHBvcnRzKXtcbid1c2Ugc3RyaWN0JztcbnZhciBQcm9taXNlID0gX2RlcmVxXygnLi9wcm9taXNlJyk7XG52YXIgcmVqZWN0ID0gX2RlcmVxXygnLi9yZWplY3QnKTtcbnZhciByZXNvbHZlID0gX2RlcmVxXygnLi9yZXNvbHZlJyk7XG52YXIgSU5URVJOQUwgPSBfZGVyZXFfKCcuL0lOVEVSTkFMJyk7XG52YXIgaGFuZGxlcnMgPSBfZGVyZXFfKCcuL2hhbmRsZXJzJyk7XG5tb2R1bGUuZXhwb3J0cyA9IHJhY2U7XG5mdW5jdGlvbiByYWNlKGl0ZXJhYmxlKSB7XG4gIGlmIChPYmplY3QucHJvdG90eXBlLnRvU3RyaW5nLmNhbGwoaXRlcmFibGUpICE9PSAnW29iamVjdCBBcnJheV0nKSB7XG4gICAgcmV0dXJuIHJlamVjdChuZXcgVHlwZUVycm9yKCdtdXN0IGJlIGFuIGFycmF5JykpO1xuICB9XG5cbiAgdmFyIGxlbiA9IGl0ZXJhYmxlLmxlbmd0aDtcbiAgdmFyIGNhbGxlZCA9IGZhbHNlO1xuICBpZiAoIWxlbikge1xuICAgIHJldHVybiByZXNvbHZlKFtdKTtcbiAgfVxuXG4gIHZhciByZXNvbHZlZCA9IDA7XG4gIHZhciBpID0gLTE7XG4gIHZhciBwcm9taXNlID0gbmV3IFByb21pc2UoSU5URVJOQUwpO1xuICBcbiAgd2hpbGUgKCsraSA8IGxlbikge1xuICAgIHJlc29sdmVyKGl0ZXJhYmxlW2ldKTtcbiAgfVxuICByZXR1cm4gcHJvbWlzZTtcbiAgZnVuY3Rpb24gcmVzb2x2ZXIodmFsdWUpIHtcbiAgICByZXNvbHZlKHZhbHVlKS50aGVuKGZ1bmN0aW9uIChyZXNwb25zZSkge1xuICAgICAgaWYgKCFjYWxsZWQpIHtcbiAgICAgICAgY2FsbGVkID0gdHJ1ZTtcbiAgICAgICAgaGFuZGxlcnMucmVzb2x2ZShwcm9taXNlLCByZXNwb25zZSk7XG4gICAgICB9XG4gICAgfSwgZnVuY3Rpb24gKGVycm9yKSB7XG4gICAgICBpZiAoIWNhbGxlZCkge1xuICAgICAgICBjYWxsZWQgPSB0cnVlO1xuICAgICAgICBoYW5kbGVycy5yZWplY3QocHJvbWlzZSwgZXJyb3IpO1xuICAgICAgfVxuICAgIH0pO1xuICB9XG59XG59LHtcIi4vSU5URVJOQUxcIjozMCxcIi4vaGFuZGxlcnNcIjozMixcIi4vcHJvbWlzZVwiOjM0LFwiLi9yZWplY3RcIjozNyxcIi4vcmVzb2x2ZVwiOjM4fV0sMzc6W2Z1bmN0aW9uKF9kZXJlcV8sbW9kdWxlLGV4cG9ydHMpe1xuJ3VzZSBzdHJpY3QnO1xuXG52YXIgUHJvbWlzZSA9IF9kZXJlcV8oJy4vcHJvbWlzZScpO1xudmFyIElOVEVSTkFMID0gX2RlcmVxXygnLi9JTlRFUk5BTCcpO1xudmFyIGhhbmRsZXJzID0gX2RlcmVxXygnLi9oYW5kbGVycycpO1xubW9kdWxlLmV4cG9ydHMgPSByZWplY3Q7XG5cbmZ1bmN0aW9uIHJlamVjdChyZWFzb24pIHtcblx0dmFyIHByb21pc2UgPSBuZXcgUHJvbWlzZShJTlRFUk5BTCk7XG5cdHJldHVybiBoYW5kbGVycy5yZWplY3QocHJvbWlzZSwgcmVhc29uKTtcbn1cbn0se1wiLi9JTlRFUk5BTFwiOjMwLFwiLi9oYW5kbGVyc1wiOjMyLFwiLi9wcm9taXNlXCI6MzR9XSwzODpbZnVuY3Rpb24oX2RlcmVxXyxtb2R1bGUsZXhwb3J0cyl7XG4ndXNlIHN0cmljdCc7XG5cbnZhciBQcm9taXNlID0gX2RlcmVxXygnLi9wcm9taXNlJyk7XG52YXIgSU5URVJOQUwgPSBfZGVyZXFfKCcuL0lOVEVSTkFMJyk7XG52YXIgaGFuZGxlcnMgPSBfZGVyZXFfKCcuL2hhbmRsZXJzJyk7XG5tb2R1bGUuZXhwb3J0cyA9IHJlc29sdmU7XG5cbnZhciBGQUxTRSA9IGhhbmRsZXJzLnJlc29sdmUobmV3IFByb21pc2UoSU5URVJOQUwpLCBmYWxzZSk7XG52YXIgTlVMTCA9IGhhbmRsZXJzLnJlc29sdmUobmV3IFByb21pc2UoSU5URVJOQUwpLCBudWxsKTtcbnZhciBVTkRFRklORUQgPSBoYW5kbGVycy5yZXNvbHZlKG5ldyBQcm9taXNlKElOVEVSTkFMKSwgdm9pZCAwKTtcbnZhciBaRVJPID0gaGFuZGxlcnMucmVzb2x2ZShuZXcgUHJvbWlzZShJTlRFUk5BTCksIDApO1xudmFyIEVNUFRZU1RSSU5HID0gaGFuZGxlcnMucmVzb2x2ZShuZXcgUHJvbWlzZShJTlRFUk5BTCksICcnKTtcblxuZnVuY3Rpb24gcmVzb2x2ZSh2YWx1ZSkge1xuICBpZiAodmFsdWUpIHtcbiAgICBpZiAodmFsdWUgaW5zdGFuY2VvZiBQcm9taXNlKSB7XG4gICAgICByZXR1cm4gdmFsdWU7XG4gICAgfVxuICAgIHJldHVybiBoYW5kbGVycy5yZXNvbHZlKG5ldyBQcm9taXNlKElOVEVSTkFMKSwgdmFsdWUpO1xuICB9XG4gIHZhciB2YWx1ZVR5cGUgPSB0eXBlb2YgdmFsdWU7XG4gIHN3aXRjaCAodmFsdWVUeXBlKSB7XG4gICAgY2FzZSAnYm9vbGVhbic6XG4gICAgICByZXR1cm4gRkFMU0U7XG4gICAgY2FzZSAndW5kZWZpbmVkJzpcbiAgICAgIHJldHVybiBVTkRFRklORUQ7XG4gICAgY2FzZSAnb2JqZWN0JzpcbiAgICAgIHJldHVybiBOVUxMO1xuICAgIGNhc2UgJ251bWJlcic6XG4gICAgICByZXR1cm4gWkVSTztcbiAgICBjYXNlICdzdHJpbmcnOlxuICAgICAgcmV0dXJuIEVNUFRZU1RSSU5HO1xuICB9XG59XG59LHtcIi4vSU5URVJOQUxcIjozMCxcIi4vaGFuZGxlcnNcIjozMixcIi4vcHJvbWlzZVwiOjM0fV0sMzk6W2Z1bmN0aW9uKF9kZXJlcV8sbW9kdWxlLGV4cG9ydHMpe1xuJ3VzZSBzdHJpY3QnO1xudmFyIGhhbmRsZXJzID0gX2RlcmVxXygnLi9oYW5kbGVycycpO1xudmFyIHRyeUNhdGNoID0gX2RlcmVxXygnLi90cnlDYXRjaCcpO1xuZnVuY3Rpb24gc2FmZWx5UmVzb2x2ZVRoZW5hYmxlKHNlbGYsIHRoZW5hYmxlKSB7XG4gIC8vIEVpdGhlciBmdWxmaWxsLCByZWplY3Qgb3IgcmVqZWN0IHdpdGggZXJyb3JcbiAgdmFyIGNhbGxlZCA9IGZhbHNlO1xuICBmdW5jdGlvbiBvbkVycm9yKHZhbHVlKSB7XG4gICAgaWYgKGNhbGxlZCkge1xuICAgICAgcmV0dXJuO1xuICAgIH1cbiAgICBjYWxsZWQgPSB0cnVlO1xuICAgIGhhbmRsZXJzLnJlamVjdChzZWxmLCB2YWx1ZSk7XG4gIH1cblxuICBmdW5jdGlvbiBvblN1Y2Nlc3ModmFsdWUpIHtcbiAgICBpZiAoY2FsbGVkKSB7XG4gICAgICByZXR1cm47XG4gICAgfVxuICAgIGNhbGxlZCA9IHRydWU7XG4gICAgaGFuZGxlcnMucmVzb2x2ZShzZWxmLCB2YWx1ZSk7XG4gIH1cblxuICBmdW5jdGlvbiB0cnlUb1Vud3JhcCgpIHtcbiAgICB0aGVuYWJsZShvblN1Y2Nlc3MsIG9uRXJyb3IpO1xuICB9XG4gIFxuICB2YXIgcmVzdWx0ID0gdHJ5Q2F0Y2godHJ5VG9VbndyYXApO1xuICBpZiAocmVzdWx0LnN0YXR1cyA9PT0gJ2Vycm9yJykge1xuICAgIG9uRXJyb3IocmVzdWx0LnZhbHVlKTtcbiAgfVxufVxuZXhwb3J0cy5zYWZlbHkgPSBzYWZlbHlSZXNvbHZlVGhlbmFibGU7XG59LHtcIi4vaGFuZGxlcnNcIjozMixcIi4vdHJ5Q2F0Y2hcIjo0MX1dLDQwOltmdW5jdGlvbihfZGVyZXFfLG1vZHVsZSxleHBvcnRzKXtcbi8vIExhenkgbWFuJ3Mgc3ltYm9scyBmb3Igc3RhdGVzXG5cbmV4cG9ydHMuUkVKRUNURUQgPSBbJ1JFSkVDVEVEJ107XG5leHBvcnRzLkZVTEZJTExFRCA9IFsnRlVMRklMTEVEJ107XG5leHBvcnRzLlBFTkRJTkcgPSBbJ1BFTkRJTkcnXTtcbn0se31dLDQxOltmdW5jdGlvbihfZGVyZXFfLG1vZHVsZSxleHBvcnRzKXtcbid1c2Ugc3RyaWN0JztcblxubW9kdWxlLmV4cG9ydHMgPSB0cnlDYXRjaDtcblxuZnVuY3Rpb24gdHJ5Q2F0Y2goZnVuYywgdmFsdWUpIHtcbiAgdmFyIG91dCA9IHt9O1xuICB0cnkge1xuICAgIG91dC52YWx1ZSA9IGZ1bmModmFsdWUpO1xuICAgIG91dC5zdGF0dXMgPSAnc3VjY2Vzcyc7XG4gIH0gY2F0Y2ggKGUpIHtcbiAgICBvdXQuc3RhdHVzID0gJ2Vycm9yJztcbiAgICBvdXQudmFsdWUgPSBlO1xuICB9XG4gIHJldHVybiBvdXQ7XG59XG59LHt9XSw0MjpbZnVuY3Rpb24oX2RlcmVxXyxtb2R1bGUsZXhwb3J0cyl7XG4ndXNlIHN0cmljdCc7XG5cbnZhciBpbW1lZGlhdGUgPSBfZGVyZXFfKCdpbW1lZGlhdGUnKTtcbnZhciBoYW5kbGVycyA9IF9kZXJlcV8oJy4vaGFuZGxlcnMnKTtcbm1vZHVsZS5leHBvcnRzID0gdW53cmFwO1xuXG5mdW5jdGlvbiB1bndyYXAocHJvbWlzZSwgZnVuYywgdmFsdWUpIHtcbiAgaW1tZWRpYXRlKGZ1bmN0aW9uICgpIHtcbiAgICB2YXIgcmV0dXJuVmFsdWU7XG4gICAgdHJ5IHtcbiAgICAgIHJldHVyblZhbHVlID0gZnVuYyh2YWx1ZSk7XG4gICAgfSBjYXRjaCAoZSkge1xuICAgICAgcmV0dXJuIGhhbmRsZXJzLnJlamVjdChwcm9taXNlLCBlKTtcbiAgICB9XG4gICAgaWYgKHJldHVyblZhbHVlID09PSBwcm9taXNlKSB7XG4gICAgICBoYW5kbGVycy5yZWplY3QocHJvbWlzZSwgbmV3IFR5cGVFcnJvcignQ2Fubm90IHJlc29sdmUgcHJvbWlzZSB3aXRoIGl0c2VsZicpKTtcbiAgICB9IGVsc2Uge1xuICAgICAgaGFuZGxlcnMucmVzb2x2ZShwcm9taXNlLCByZXR1cm5WYWx1ZSk7XG4gICAgfVxuICB9KTtcbn1cbn0se1wiLi9oYW5kbGVyc1wiOjMyLFwiaW1tZWRpYXRlXCI6NDN9XSw0MzpbZnVuY3Rpb24oX2RlcmVxXyxtb2R1bGUsZXhwb3J0cyl7XG4ndXNlIHN0cmljdCc7XG52YXIgdHlwZXMgPSBbXG4gIF9kZXJlcV8oJy4vbmV4dFRpY2snKSxcbiAgX2RlcmVxXygnLi9tdXRhdGlvbi5qcycpLFxuICBfZGVyZXFfKCcuL21lc3NhZ2VDaGFubmVsJyksXG4gIF9kZXJlcV8oJy4vc3RhdGVDaGFuZ2UnKSxcbiAgX2RlcmVxXygnLi90aW1lb3V0Jylcbl07XG52YXIgZHJhaW5pbmc7XG52YXIgcXVldWUgPSBbXTtcbmZ1bmN0aW9uIGRyYWluUXVldWUoKSB7XG4gIGRyYWluaW5nID0gdHJ1ZTtcbiAgdmFyIGksIG9sZFF1ZXVlO1xuICB2YXIgbGVuID0gcXVldWUubGVuZ3RoO1xuICB3aGlsZSAobGVuKSB7XG4gICAgb2xkUXVldWUgPSBxdWV1ZTtcbiAgICBxdWV1ZSA9IFtdO1xuICAgIGkgPSAtMTtcbiAgICB3aGlsZSAoKytpIDwgbGVuKSB7XG4gICAgICBvbGRRdWV1ZVtpXSgpO1xuICAgIH1cbiAgICBsZW4gPSBxdWV1ZS5sZW5ndGg7XG4gIH1cbiAgZHJhaW5pbmcgPSBmYWxzZTtcbn1cbnZhciBzY2hlZHVsZURyYWluO1xudmFyIGkgPSAtMTtcbnZhciBsZW4gPSB0eXBlcy5sZW5ndGg7XG53aGlsZSAoKysgaSA8IGxlbikge1xuICBpZiAodHlwZXNbaV0gJiYgdHlwZXNbaV0udGVzdCAmJiB0eXBlc1tpXS50ZXN0KCkpIHtcbiAgICBzY2hlZHVsZURyYWluID0gdHlwZXNbaV0uaW5zdGFsbChkcmFpblF1ZXVlKTtcbiAgICBicmVhaztcbiAgfVxufVxubW9kdWxlLmV4cG9ydHMgPSBpbW1lZGlhdGU7XG5mdW5jdGlvbiBpbW1lZGlhdGUodGFzaykge1xuICBpZiAocXVldWUucHVzaCh0YXNrKSA9PT0gMSAmJiAhZHJhaW5pbmcpIHtcbiAgICBzY2hlZHVsZURyYWluKCk7XG4gIH1cbn1cbn0se1wiLi9tZXNzYWdlQ2hhbm5lbFwiOjQ0LFwiLi9tdXRhdGlvbi5qc1wiOjQ1LFwiLi9uZXh0VGlja1wiOjI2LFwiLi9zdGF0ZUNoYW5nZVwiOjQ2LFwiLi90aW1lb3V0XCI6NDd9XSw0NDpbZnVuY3Rpb24oX2RlcmVxXyxtb2R1bGUsZXhwb3J0cyl7XG4oZnVuY3Rpb24gKGdsb2JhbCl7XG4ndXNlIHN0cmljdCc7XG5cbmV4cG9ydHMudGVzdCA9IGZ1bmN0aW9uICgpIHtcbiAgaWYgKGdsb2JhbC5zZXRJbW1lZGlhdGUpIHtcbiAgICAvLyB3ZSBjYW4gb25seSBnZXQgaGVyZSBpbiBJRTEwXG4gICAgLy8gd2hpY2ggZG9lc24ndCBoYW5kZWwgcG9zdE1lc3NhZ2Ugd2VsbFxuICAgIHJldHVybiBmYWxzZTtcbiAgfVxuICByZXR1cm4gdHlwZW9mIGdsb2JhbC5NZXNzYWdlQ2hhbm5lbCAhPT0gJ3VuZGVmaW5lZCc7XG59O1xuXG5leHBvcnRzLmluc3RhbGwgPSBmdW5jdGlvbiAoZnVuYykge1xuICB2YXIgY2hhbm5lbCA9IG5ldyBnbG9iYWwuTWVzc2FnZUNoYW5uZWwoKTtcbiAgY2hhbm5lbC5wb3J0MS5vbm1lc3NhZ2UgPSBmdW5jO1xuICByZXR1cm4gZnVuY3Rpb24gKCkge1xuICAgIGNoYW5uZWwucG9ydDIucG9zdE1lc3NhZ2UoMCk7XG4gIH07XG59O1xufSkuY2FsbCh0aGlzLHR5cGVvZiBzZWxmICE9PSBcInVuZGVmaW5lZFwiID8gc2VsZiA6IHR5cGVvZiB3aW5kb3cgIT09IFwidW5kZWZpbmVkXCIgPyB3aW5kb3cgOiB7fSlcbn0se31dLDQ1OltmdW5jdGlvbihfZGVyZXFfLG1vZHVsZSxleHBvcnRzKXtcbihmdW5jdGlvbiAoZ2xvYmFsKXtcbid1c2Ugc3RyaWN0Jztcbi8vYmFzZWQgb2ZmIHJzdnAgaHR0cHM6Ly9naXRodWIuY29tL3RpbGRlaW8vcnN2cC5qc1xuLy9saWNlbnNlIGh0dHBzOi8vZ2l0aHViLmNvbS90aWxkZWlvL3JzdnAuanMvYmxvYi9tYXN0ZXIvTElDRU5TRVxuLy9odHRwczovL2dpdGh1Yi5jb20vdGlsZGVpby9yc3ZwLmpzL2Jsb2IvbWFzdGVyL2xpYi9yc3ZwL2FzYXAuanNcblxudmFyIE11dGF0aW9uID0gZ2xvYmFsLk11dGF0aW9uT2JzZXJ2ZXIgfHwgZ2xvYmFsLldlYktpdE11dGF0aW9uT2JzZXJ2ZXI7XG5cbmV4cG9ydHMudGVzdCA9IGZ1bmN0aW9uICgpIHtcbiAgcmV0dXJuIE11dGF0aW9uO1xufTtcblxuZXhwb3J0cy5pbnN0YWxsID0gZnVuY3Rpb24gKGhhbmRsZSkge1xuICB2YXIgY2FsbGVkID0gMDtcbiAgdmFyIG9ic2VydmVyID0gbmV3IE11dGF0aW9uKGhhbmRsZSk7XG4gIHZhciBlbGVtZW50ID0gZ2xvYmFsLmRvY3VtZW50LmNyZWF0ZVRleHROb2RlKCcnKTtcbiAgb2JzZXJ2ZXIub2JzZXJ2ZShlbGVtZW50LCB7XG4gICAgY2hhcmFjdGVyRGF0YTogdHJ1ZVxuICB9KTtcbiAgcmV0dXJuIGZ1bmN0aW9uICgpIHtcbiAgICBlbGVtZW50LmRhdGEgPSAoY2FsbGVkID0gKytjYWxsZWQgJSAyKTtcbiAgfTtcbn07XG59KS5jYWxsKHRoaXMsdHlwZW9mIHNlbGYgIT09IFwidW5kZWZpbmVkXCIgPyBzZWxmIDogdHlwZW9mIHdpbmRvdyAhPT0gXCJ1bmRlZmluZWRcIiA/IHdpbmRvdyA6IHt9KVxufSx7fV0sNDY6W2Z1bmN0aW9uKF9kZXJlcV8sbW9kdWxlLGV4cG9ydHMpe1xuKGZ1bmN0aW9uIChnbG9iYWwpe1xuJ3VzZSBzdHJpY3QnO1xuXG5leHBvcnRzLnRlc3QgPSBmdW5jdGlvbiAoKSB7XG4gIHJldHVybiAnZG9jdW1lbnQnIGluIGdsb2JhbCAmJiAnb25yZWFkeXN0YXRlY2hhbmdlJyBpbiBnbG9iYWwuZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnc2NyaXB0Jyk7XG59O1xuXG5leHBvcnRzLmluc3RhbGwgPSBmdW5jdGlvbiAoaGFuZGxlKSB7XG4gIHJldHVybiBmdW5jdGlvbiAoKSB7XG5cbiAgICAvLyBDcmVhdGUgYSA8c2NyaXB0PiBlbGVtZW50OyBpdHMgcmVhZHlzdGF0ZWNoYW5nZSBldmVudCB3aWxsIGJlIGZpcmVkIGFzeW5jaHJvbm91c2x5IG9uY2UgaXQgaXMgaW5zZXJ0ZWRcbiAgICAvLyBpbnRvIHRoZSBkb2N1bWVudC4gRG8gc28sIHRodXMgcXVldWluZyB1cCB0aGUgdGFzay4gUmVtZW1iZXIgdG8gY2xlYW4gdXAgb25jZSBpdCdzIGJlZW4gY2FsbGVkLlxuICAgIHZhciBzY3JpcHRFbCA9IGdsb2JhbC5kb2N1bWVudC5jcmVhdGVFbGVtZW50KCdzY3JpcHQnKTtcbiAgICBzY3JpcHRFbC5vbnJlYWR5c3RhdGVjaGFuZ2UgPSBmdW5jdGlvbiAoKSB7XG4gICAgICBoYW5kbGUoKTtcblxuICAgICAgc2NyaXB0RWwub25yZWFkeXN0YXRlY2hhbmdlID0gbnVsbDtcbiAgICAgIHNjcmlwdEVsLnBhcmVudE5vZGUucmVtb3ZlQ2hpbGQoc2NyaXB0RWwpO1xuICAgICAgc2NyaXB0RWwgPSBudWxsO1xuICAgIH07XG4gICAgZ2xvYmFsLmRvY3VtZW50LmRvY3VtZW50RWxlbWVudC5hcHBlbmRDaGlsZChzY3JpcHRFbCk7XG5cbiAgICByZXR1cm4gaGFuZGxlO1xuICB9O1xufTtcbn0pLmNhbGwodGhpcyx0eXBlb2Ygc2VsZiAhPT0gXCJ1bmRlZmluZWRcIiA/IHNlbGYgOiB0eXBlb2Ygd2luZG93ICE9PSBcInVuZGVmaW5lZFwiID8gd2luZG93IDoge30pXG59LHt9XSw0NzpbZnVuY3Rpb24oX2RlcmVxXyxtb2R1bGUsZXhwb3J0cyl7XG4ndXNlIHN0cmljdCc7XG5leHBvcnRzLnRlc3QgPSBmdW5jdGlvbiAoKSB7XG4gIHJldHVybiB0cnVlO1xufTtcblxuZXhwb3J0cy5pbnN0YWxsID0gZnVuY3Rpb24gKHQpIHtcbiAgcmV0dXJuIGZ1bmN0aW9uICgpIHtcbiAgICBzZXRUaW1lb3V0KHQsIDApO1xuICB9O1xufTtcbn0se31dLDQ4OltmdW5jdGlvbihfZGVyZXFfLG1vZHVsZSxleHBvcnRzKXtcblwidXNlIHN0cmljdFwiO1xuXG4vLyBFeHRlbmRzIG1ldGhvZFxuLy8gKHRha2VuIGZyb20gaHR0cDovL2NvZGUuanF1ZXJ5LmNvbS9qcXVlcnktMS45LjAuanMpXG4vLyBQb3B1bGF0ZSB0aGUgY2xhc3MydHlwZSBtYXBcbnZhciBjbGFzczJ0eXBlID0ge307XG5cbnZhciB0eXBlcyA9IFtcbiAgXCJCb29sZWFuXCIsIFwiTnVtYmVyXCIsIFwiU3RyaW5nXCIsIFwiRnVuY3Rpb25cIiwgXCJBcnJheVwiLFxuICBcIkRhdGVcIiwgXCJSZWdFeHBcIiwgXCJPYmplY3RcIiwgXCJFcnJvclwiXG5dO1xuZm9yICh2YXIgaSA9IDA7IGkgPCB0eXBlcy5sZW5ndGg7IGkrKykge1xuICB2YXIgdHlwZW5hbWUgPSB0eXBlc1tpXTtcbiAgY2xhc3MydHlwZVtcIltvYmplY3QgXCIgKyB0eXBlbmFtZSArIFwiXVwiXSA9IHR5cGVuYW1lLnRvTG93ZXJDYXNlKCk7XG59XG5cbnZhciBjb3JlX3RvU3RyaW5nID0gY2xhc3MydHlwZS50b1N0cmluZztcbnZhciBjb3JlX2hhc093biA9IGNsYXNzMnR5cGUuaGFzT3duUHJvcGVydHk7XG5cbmZ1bmN0aW9uIHR5cGUob2JqKSB7XG4gIGlmIChvYmogPT09IG51bGwpIHtcbiAgICByZXR1cm4gU3RyaW5nKG9iaik7XG4gIH1cbiAgcmV0dXJuIHR5cGVvZiBvYmogPT09IFwib2JqZWN0XCIgfHwgdHlwZW9mIG9iaiA9PT0gXCJmdW5jdGlvblwiID9cbiAgICBjbGFzczJ0eXBlW2NvcmVfdG9TdHJpbmcuY2FsbChvYmopXSB8fCBcIm9iamVjdFwiIDpcbiAgICB0eXBlb2Ygb2JqO1xufVxuXG5mdW5jdGlvbiBpc1dpbmRvdyhvYmopIHtcbiAgcmV0dXJuIG9iaiAhPT0gbnVsbCAmJiBvYmogPT09IG9iai53aW5kb3c7XG59XG5cbmZ1bmN0aW9uIGlzUGxhaW5PYmplY3Qob2JqKSB7XG4gIC8vIE11c3QgYmUgYW4gT2JqZWN0LlxuICAvLyBCZWNhdXNlIG9mIElFLCB3ZSBhbHNvIGhhdmUgdG8gY2hlY2sgdGhlIHByZXNlbmNlIG9mXG4gIC8vIHRoZSBjb25zdHJ1Y3RvciBwcm9wZXJ0eS5cbiAgLy8gTWFrZSBzdXJlIHRoYXQgRE9NIG5vZGVzIGFuZCB3aW5kb3cgb2JqZWN0cyBkb24ndCBwYXNzIHRocm91Z2gsIGFzIHdlbGxcbiAgaWYgKCFvYmogfHwgdHlwZShvYmopICE9PSBcIm9iamVjdFwiIHx8IG9iai5ub2RlVHlwZSB8fCBpc1dpbmRvdyhvYmopKSB7XG4gICAgcmV0dXJuIGZhbHNlO1xuICB9XG5cbiAgdHJ5IHtcbiAgICAvLyBOb3Qgb3duIGNvbnN0cnVjdG9yIHByb3BlcnR5IG11c3QgYmUgT2JqZWN0XG4gICAgaWYgKG9iai5jb25zdHJ1Y3RvciAmJlxuICAgICAgIWNvcmVfaGFzT3duLmNhbGwob2JqLCBcImNvbnN0cnVjdG9yXCIpICYmXG4gICAgICAhY29yZV9oYXNPd24uY2FsbChvYmouY29uc3RydWN0b3IucHJvdG90eXBlLCBcImlzUHJvdG90eXBlT2ZcIikpIHtcbiAgICAgIHJldHVybiBmYWxzZTtcbiAgICB9XG4gIH0gY2F0Y2ggKCBlICkge1xuICAgIC8vIElFOCw5IFdpbGwgdGhyb3cgZXhjZXB0aW9ucyBvbiBjZXJ0YWluIGhvc3Qgb2JqZWN0cyAjOTg5N1xuICAgIHJldHVybiBmYWxzZTtcbiAgfVxuXG4gIC8vIE93biBwcm9wZXJ0aWVzIGFyZSBlbnVtZXJhdGVkIGZpcnN0bHksIHNvIHRvIHNwZWVkIHVwLFxuICAvLyBpZiBsYXN0IG9uZSBpcyBvd24sIHRoZW4gYWxsIHByb3BlcnRpZXMgYXJlIG93bi5cbiAgdmFyIGtleTtcbiAgZm9yIChrZXkgaW4gb2JqKSB7fVxuXG4gIHJldHVybiBrZXkgPT09IHVuZGVmaW5lZCB8fCBjb3JlX2hhc093bi5jYWxsKG9iaiwga2V5KTtcbn1cblxuXG5mdW5jdGlvbiBpc0Z1bmN0aW9uKG9iaikge1xuICByZXR1cm4gdHlwZShvYmopID09PSBcImZ1bmN0aW9uXCI7XG59XG5cbnZhciBpc0FycmF5ID0gQXJyYXkuaXNBcnJheSB8fCBmdW5jdGlvbiAob2JqKSB7XG4gIHJldHVybiB0eXBlKG9iaikgPT09IFwiYXJyYXlcIjtcbn07XG5cbmZ1bmN0aW9uIGV4dGVuZCgpIHtcbiAgLy8gb3JpZ2luYWxseSBleHRlbmQoKSB3YXMgcmVjdXJzaXZlLCBidXQgdGhpcyBlbmRlZCB1cCBnaXZpbmcgdXNcbiAgLy8gXCJjYWxsIHN0YWNrIGV4Y2VlZGVkXCIsIHNvIGl0J3MgYmVlbiB1bnJvbGxlZCB0byB1c2UgYSBsaXRlcmFsIHN0YWNrXG4gIC8vIChzZWUgaHR0cHM6Ly9naXRodWIuY29tL3BvdWNoZGIvcG91Y2hkYi9pc3N1ZXMvMjU0MylcbiAgdmFyIHN0YWNrID0gW107XG4gIHZhciBpID0gLTE7XG4gIHZhciBsZW4gPSBhcmd1bWVudHMubGVuZ3RoO1xuICB2YXIgYXJncyA9IG5ldyBBcnJheShsZW4pO1xuICB3aGlsZSAoKytpIDwgbGVuKSB7XG4gICAgYXJnc1tpXSA9IGFyZ3VtZW50c1tpXTtcbiAgfVxuICB2YXIgY29udGFpbmVyID0ge307XG4gIHN0YWNrLnB1c2goe2FyZ3M6IGFyZ3MsIHJlc3VsdDoge2NvbnRhaW5lcjogY29udGFpbmVyLCBrZXk6ICdrZXknfX0pO1xuICB2YXIgbmV4dDtcbiAgd2hpbGUgKChuZXh0ID0gc3RhY2sucG9wKCkpKSB7XG4gICAgZXh0ZW5kSW5uZXIoc3RhY2ssIG5leHQuYXJncywgbmV4dC5yZXN1bHQpO1xuICB9XG4gIHJldHVybiBjb250YWluZXIua2V5O1xufVxuXG5mdW5jdGlvbiBleHRlbmRJbm5lcihzdGFjaywgYXJncywgcmVzdWx0KSB7XG4gIHZhciBvcHRpb25zLCBuYW1lLCBzcmMsIGNvcHksIGNvcHlJc0FycmF5LCBjbG9uZSxcbiAgICB0YXJnZXQgPSBhcmdzWzBdIHx8IHt9LFxuICAgIGkgPSAxLFxuICAgIGxlbmd0aCA9IGFyZ3MubGVuZ3RoLFxuICAgIGRlZXAgPSBmYWxzZSxcbiAgICBudW1lcmljU3RyaW5nUmVnZXggPSAvXFxkKy8sXG4gICAgb3B0aW9uc0lzQXJyYXk7XG5cbiAgLy8gSGFuZGxlIGEgZGVlcCBjb3B5IHNpdHVhdGlvblxuICBpZiAodHlwZW9mIHRhcmdldCA9PT0gXCJib29sZWFuXCIpIHtcbiAgICBkZWVwID0gdGFyZ2V0O1xuICAgIHRhcmdldCA9IGFyZ3NbMV0gfHwge307XG4gICAgLy8gc2tpcCB0aGUgYm9vbGVhbiBhbmQgdGhlIHRhcmdldFxuICAgIGkgPSAyO1xuICB9XG5cbiAgLy8gSGFuZGxlIGNhc2Ugd2hlbiB0YXJnZXQgaXMgYSBzdHJpbmcgb3Igc29tZXRoaW5nIChwb3NzaWJsZSBpbiBkZWVwIGNvcHkpXG4gIGlmICh0eXBlb2YgdGFyZ2V0ICE9PSBcIm9iamVjdFwiICYmICFpc0Z1bmN0aW9uKHRhcmdldCkpIHtcbiAgICB0YXJnZXQgPSB7fTtcbiAgfVxuXG4gIC8vIGV4dGVuZCBqUXVlcnkgaXRzZWxmIGlmIG9ubHkgb25lIGFyZ3VtZW50IGlzIHBhc3NlZFxuICBpZiAobGVuZ3RoID09PSBpKSB7XG4gICAgLyoganNoaW50IHZhbGlkdGhpczogdHJ1ZSAqL1xuICAgIHRhcmdldCA9IHRoaXM7XG4gICAgLS1pO1xuICB9XG5cbiAgZm9yICg7IGkgPCBsZW5ndGg7IGkrKykge1xuICAgIC8vIE9ubHkgZGVhbCB3aXRoIG5vbi1udWxsL3VuZGVmaW5lZCB2YWx1ZXNcbiAgICBpZiAoKG9wdGlvbnMgPSBhcmdzW2ldKSAhPSBudWxsKSB7XG4gICAgICBvcHRpb25zSXNBcnJheSA9IGlzQXJyYXkob3B0aW9ucyk7XG4gICAgICAvLyBFeHRlbmQgdGhlIGJhc2Ugb2JqZWN0XG4gICAgICBmb3IgKG5hbWUgaW4gb3B0aW9ucykge1xuICAgICAgICAvL2lmIChvcHRpb25zLmhhc093blByb3BlcnR5KG5hbWUpKSB7XG4gICAgICAgIGlmICghKG5hbWUgaW4gT2JqZWN0LnByb3RvdHlwZSkpIHtcbiAgICAgICAgICBpZiAob3B0aW9uc0lzQXJyYXkgJiYgIW51bWVyaWNTdHJpbmdSZWdleC50ZXN0KG5hbWUpKSB7XG4gICAgICAgICAgICBjb250aW51ZTtcbiAgICAgICAgICB9XG5cbiAgICAgICAgICBzcmMgPSB0YXJnZXRbbmFtZV07XG4gICAgICAgICAgY29weSA9IG9wdGlvbnNbbmFtZV07XG5cbiAgICAgICAgICAvLyBQcmV2ZW50IG5ldmVyLWVuZGluZyBsb29wXG4gICAgICAgICAgaWYgKHRhcmdldCA9PT0gY29weSkge1xuICAgICAgICAgICAgY29udGludWU7XG4gICAgICAgICAgfVxuXG4gICAgICAgICAgLy8gUmVjdXJzZSBpZiB3ZSdyZSBtZXJnaW5nIHBsYWluIG9iamVjdHMgb3IgYXJyYXlzXG4gICAgICAgICAgaWYgKGRlZXAgJiYgY29weSAmJiAoaXNQbGFpbk9iamVjdChjb3B5KSB8fFxuICAgICAgICAgICAgICAoY29weUlzQXJyYXkgPSBpc0FycmF5KGNvcHkpKSkpIHtcbiAgICAgICAgICAgIGlmIChjb3B5SXNBcnJheSkge1xuICAgICAgICAgICAgICBjb3B5SXNBcnJheSA9IGZhbHNlO1xuICAgICAgICAgICAgICBjbG9uZSA9IHNyYyAmJiBpc0FycmF5KHNyYykgPyBzcmMgOiBbXTtcblxuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgY2xvbmUgPSBzcmMgJiYgaXNQbGFpbk9iamVjdChzcmMpID8gc3JjIDoge307XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIC8vIE5ldmVyIG1vdmUgb3JpZ2luYWwgb2JqZWN0cywgY2xvbmUgdGhlbVxuICAgICAgICAgICAgc3RhY2sucHVzaCh7XG4gICAgICAgICAgICAgIGFyZ3M6IFtkZWVwLCBjbG9uZSwgY29weV0sXG4gICAgICAgICAgICAgIHJlc3VsdDoge1xuICAgICAgICAgICAgICAgIGNvbnRhaW5lcjogdGFyZ2V0LFxuICAgICAgICAgICAgICAgIGtleTogbmFtZVxuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9KTtcblxuICAgICAgICAgIC8vIERvbid0IGJyaW5nIGluIHVuZGVmaW5lZCB2YWx1ZXNcbiAgICAgICAgICB9IGVsc2UgaWYgKGNvcHkgIT09IHVuZGVmaW5lZCkge1xuICAgICAgICAgICAgaWYgKCEoaXNBcnJheShvcHRpb25zKSAmJiBpc0Z1bmN0aW9uKGNvcHkpKSkge1xuICAgICAgICAgICAgICB0YXJnZXRbbmFtZV0gPSBjb3B5O1xuICAgICAgICAgICAgfVxuICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgfVxuICAgIH1cbiAgfVxuXG4gIC8vIFwiUmV0dXJuXCIgdGhlIG1vZGlmaWVkIG9iamVjdCBieSBzZXR0aW5nIHRoZSBrZXlcbiAgLy8gb24gdGhlIGdpdmVuIGNvbnRhaW5lclxuICByZXN1bHQuY29udGFpbmVyW3Jlc3VsdC5rZXldID0gdGFyZ2V0O1xufVxuXG5cbm1vZHVsZS5leHBvcnRzID0gZXh0ZW5kO1xuXG5cblxufSx7fV0sNDk6W2Z1bmN0aW9uKF9kZXJlcV8sbW9kdWxlLGV4cG9ydHMpe1xuJ3VzZSBzdHJpY3QnO1xuXG52YXIgdXBzZXJ0ID0gX2RlcmVxXygnLi91cHNlcnQnKTtcbnZhciB1dGlscyA9IF9kZXJlcV8oJy4vdXRpbHMnKTtcbnZhciBQcm9taXNlID0gdXRpbHMuUHJvbWlzZTtcblxubW9kdWxlLmV4cG9ydHMgPSBmdW5jdGlvbiAob3B0cykge1xuICB2YXIgc291cmNlREIgPSBvcHRzLmRiO1xuICB2YXIgdmlld05hbWUgPSBvcHRzLnZpZXdOYW1lO1xuICB2YXIgbWFwRnVuID0gb3B0cy5tYXA7XG4gIHZhciByZWR1Y2VGdW4gPSBvcHRzLnJlZHVjZTtcbiAgdmFyIHRlbXBvcmFyeSA9IG9wdHMudGVtcG9yYXJ5O1xuXG4gIC8vIHRoZSBcInVuZGVmaW5lZFwiIHBhcnQgaXMgZm9yIGJhY2t3YXJkcyBjb21wYXRpYmlsaXR5XG4gIHZhciB2aWV3U2lnbmF0dXJlID0gbWFwRnVuLnRvU3RyaW5nKCkgKyAocmVkdWNlRnVuICYmIHJlZHVjZUZ1bi50b1N0cmluZygpKSArXG4gICAgJ3VuZGVmaW5lZCc7XG5cbiAgaWYgKCF0ZW1wb3JhcnkgJiYgc291cmNlREIuX2NhY2hlZFZpZXdzKSB7XG4gICAgdmFyIGNhY2hlZFZpZXcgPSBzb3VyY2VEQi5fY2FjaGVkVmlld3Nbdmlld1NpZ25hdHVyZV07XG4gICAgaWYgKGNhY2hlZFZpZXcpIHtcbiAgICAgIHJldHVybiBQcm9taXNlLnJlc29sdmUoY2FjaGVkVmlldyk7XG4gICAgfVxuICB9XG5cbiAgcmV0dXJuIHNvdXJjZURCLmluZm8oKS50aGVuKGZ1bmN0aW9uIChpbmZvKSB7XG5cbiAgICB2YXIgZGVwRGJOYW1lID0gaW5mby5kYl9uYW1lICsgJy1tcnZpZXctJyArXG4gICAgICAodGVtcG9yYXJ5ID8gJ3RlbXAnIDogdXRpbHMuTUQ1KHZpZXdTaWduYXR1cmUpKTtcblxuICAgIC8vIHNhdmUgdGhlIHZpZXcgbmFtZSBpbiB0aGUgc291cmNlIFBvdWNoREIgc28gaXQgY2FuIGJlIGNsZWFuZWQgdXAgaWYgbmVjZXNzYXJ5XG4gICAgLy8gKGUuZy4gd2hlbiB0aGUgX2Rlc2lnbiBkb2MgaXMgZGVsZXRlZCwgcmVtb3ZlIGFsbCBhc3NvY2lhdGVkIHZpZXcgZGF0YSlcbiAgICBmdW5jdGlvbiBkaWZmRnVuY3Rpb24oZG9jKSB7XG4gICAgICBkb2Mudmlld3MgPSBkb2Mudmlld3MgfHwge307XG4gICAgICB2YXIgZnVsbFZpZXdOYW1lID0gdmlld05hbWU7XG4gICAgICBpZiAoZnVsbFZpZXdOYW1lLmluZGV4T2YoJy8nKSA9PT0gLTEpIHtcbiAgICAgICAgZnVsbFZpZXdOYW1lID0gdmlld05hbWUgKyAnLycgKyB2aWV3TmFtZTtcbiAgICAgIH1cbiAgICAgIHZhciBkZXBEYnMgPSBkb2Mudmlld3NbZnVsbFZpZXdOYW1lXSA9IGRvYy52aWV3c1tmdWxsVmlld05hbWVdIHx8IHt9O1xuICAgICAgLyogaXN0YW5idWwgaWdub3JlIGlmICovXG4gICAgICBpZiAoZGVwRGJzW2RlcERiTmFtZV0pIHtcbiAgICAgICAgcmV0dXJuOyAvLyBubyB1cGRhdGUgbmVjZXNzYXJ5XG4gICAgICB9XG4gICAgICBkZXBEYnNbZGVwRGJOYW1lXSA9IHRydWU7XG4gICAgICByZXR1cm4gZG9jO1xuICAgIH1cbiAgICByZXR1cm4gdXBzZXJ0KHNvdXJjZURCLCAnX2xvY2FsL21ydmlld3MnLCBkaWZmRnVuY3Rpb24pLnRoZW4oZnVuY3Rpb24gKCkge1xuICAgICAgcmV0dXJuIHNvdXJjZURCLnJlZ2lzdGVyRGVwZW5kZW50RGF0YWJhc2UoZGVwRGJOYW1lKS50aGVuKGZ1bmN0aW9uIChyZXMpIHtcbiAgICAgICAgdmFyIGRiID0gcmVzLmRiO1xuICAgICAgICBkYi5hdXRvX2NvbXBhY3Rpb24gPSB0cnVlO1xuICAgICAgICB2YXIgdmlldyA9IHtcbiAgICAgICAgICBuYW1lOiBkZXBEYk5hbWUsXG4gICAgICAgICAgZGI6IGRiLCBcbiAgICAgICAgICBzb3VyY2VEQjogc291cmNlREIsXG4gICAgICAgICAgYWRhcHRlcjogc291cmNlREIuYWRhcHRlcixcbiAgICAgICAgICBtYXBGdW46IG1hcEZ1bixcbiAgICAgICAgICByZWR1Y2VGdW46IHJlZHVjZUZ1blxuICAgICAgICB9O1xuICAgICAgICByZXR1cm4gdmlldy5kYi5nZXQoJ19sb2NhbC9sYXN0U2VxJylbXCJjYXRjaFwiXShmdW5jdGlvbiAoZXJyKSB7XG4gICAgICAgICAgLyogaXN0YW5idWwgaWdub3JlIGlmICovXG4gICAgICAgICAgaWYgKGVyci5zdGF0dXMgIT09IDQwNCkge1xuICAgICAgICAgICAgdGhyb3cgZXJyO1xuICAgICAgICAgIH1cbiAgICAgICAgfSkudGhlbihmdW5jdGlvbiAobGFzdFNlcURvYykge1xuICAgICAgICAgIHZpZXcuc2VxID0gbGFzdFNlcURvYyA/IGxhc3RTZXFEb2Muc2VxIDogMDtcbiAgICAgICAgICBpZiAoIXRlbXBvcmFyeSkge1xuICAgICAgICAgICAgc291cmNlREIuX2NhY2hlZFZpZXdzID0gc291cmNlREIuX2NhY2hlZFZpZXdzIHx8IHt9O1xuICAgICAgICAgICAgc291cmNlREIuX2NhY2hlZFZpZXdzW3ZpZXdTaWduYXR1cmVdID0gdmlldztcbiAgICAgICAgICAgIHZpZXcuZGIub24oJ2Rlc3Ryb3llZCcsIGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgZGVsZXRlIHNvdXJjZURCLl9jYWNoZWRWaWV3c1t2aWV3U2lnbmF0dXJlXTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgIH1cbiAgICAgICAgICByZXR1cm4gdmlldztcbiAgICAgICAgfSk7XG4gICAgICB9KTtcbiAgICB9KTtcbiAgfSk7XG59O1xuXG59LHtcIi4vdXBzZXJ0XCI6NTUsXCIuL3V0aWxzXCI6NTZ9XSw1MDpbZnVuY3Rpb24oX2RlcmVxXyxtb2R1bGUsZXhwb3J0cyl7XG4ndXNlIHN0cmljdCc7XG5cbm1vZHVsZS5leHBvcnRzID0gZnVuY3Rpb24gKGZ1bmMsIGVtaXQsIHN1bSwgbG9nLCBpc0FycmF5LCB0b0pTT04pIHtcbiAgLypqc2hpbnQgZXZpbDp0cnVlLHVudXNlZDpmYWxzZSAqL1xuICByZXR1cm4gZXZhbChcIid1c2Ugc3RyaWN0JzsgKFwiICsgZnVuYy5yZXBsYWNlKC87XFxzKiQvLCBcIlwiKSArIFwiKTtcIik7XG59O1xuXG59LHt9XSw1MTpbZnVuY3Rpb24oX2RlcmVxXyxtb2R1bGUsZXhwb3J0cyl7XG4oZnVuY3Rpb24gKHByb2Nlc3Mpe1xuJ3VzZSBzdHJpY3QnO1xuXG52YXIgcG91Y2hDb2xsYXRlID0gX2RlcmVxXygncG91Y2hkYi1jb2xsYXRlJyk7XG52YXIgVGFza1F1ZXVlID0gX2RlcmVxXygnLi90YXNrcXVldWUnKTtcbnZhciBjb2xsYXRlID0gcG91Y2hDb2xsYXRlLmNvbGxhdGU7XG52YXIgdG9JbmRleGFibGVTdHJpbmcgPSBwb3VjaENvbGxhdGUudG9JbmRleGFibGVTdHJpbmc7XG52YXIgbm9ybWFsaXplS2V5ID0gcG91Y2hDb2xsYXRlLm5vcm1hbGl6ZUtleTtcbnZhciBjcmVhdGVWaWV3ID0gX2RlcmVxXygnLi9jcmVhdGUtdmlldycpO1xudmFyIGV2YWxGdW5jID0gX2RlcmVxXygnLi9ldmFsZnVuYycpO1xudmFyIGxvZzsgXG4vKiBpc3RhbmJ1bCBpZ25vcmUgZWxzZSAqL1xuaWYgKCh0eXBlb2YgY29uc29sZSAhPT0gJ3VuZGVmaW5lZCcpICYmICh0eXBlb2YgY29uc29sZS5sb2cgPT09ICdmdW5jdGlvbicpKSB7XG4gIGxvZyA9IEZ1bmN0aW9uLnByb3RvdHlwZS5iaW5kLmNhbGwoY29uc29sZS5sb2csIGNvbnNvbGUpO1xufSBlbHNlIHtcbiAgbG9nID0gZnVuY3Rpb24gKCkge307XG59XG52YXIgdXRpbHMgPSBfZGVyZXFfKCcuL3V0aWxzJyk7XG52YXIgUHJvbWlzZSA9IHV0aWxzLlByb21pc2U7XG52YXIgbWFpblF1ZXVlID0gbmV3IFRhc2tRdWV1ZSgpO1xudmFyIHRlbXBWaWV3UXVldWUgPSBuZXcgVGFza1F1ZXVlKCk7XG52YXIgQ0hBTkdFU19CQVRDSF9TSVpFID0gNTA7XG5cbmZ1bmN0aW9uIHBhcnNlVmlld05hbWUobmFtZSkge1xuICAvLyBjYW4gYmUgZWl0aGVyICdkZG9jbmFtZS92aWV3bmFtZScgb3IganVzdCAndmlld25hbWUnXG4gIC8vICh3aGVyZSB0aGUgZGRvYyBuYW1lIGlzIHRoZSBzYW1lKVxuICByZXR1cm4gbmFtZS5pbmRleE9mKCcvJykgPT09IC0xID8gW25hbWUsIG5hbWVdIDogbmFtZS5zcGxpdCgnLycpO1xufVxuXG5mdW5jdGlvbiB0cnlDb2RlKGRiLCBmdW4sIGFyZ3MpIHtcbiAgLy8gZW1pdCBhbiBldmVudCBpZiB0aGVyZSB3YXMgYW4gZXJyb3IgdGhyb3duIGJ5IGEgbWFwL3JlZHVjZSBmdW5jdGlvbi5cbiAgLy8gcHV0dGluZyB0cnkvY2F0Y2hlcyBpbiBhIHNpbmdsZSBmdW5jdGlvbiBhbHNvIGF2b2lkcyBkZW9wdGltaXphdGlvbnMuXG4gIHRyeSB7XG4gICAgcmV0dXJuIHtcbiAgICAgIG91dHB1dCA6IGZ1bi5hcHBseShudWxsLCBhcmdzKVxuICAgIH07XG4gIH0gY2F0Y2ggKGUpIHtcbiAgICBkYi5lbWl0KCdlcnJvcicsIGUpO1xuICAgIHJldHVybiB7ZXJyb3IgOiBlfTtcbiAgfVxufVxuXG5mdW5jdGlvbiBzb3J0QnlLZXlUaGVuVmFsdWUoeCwgeSkge1xuICB2YXIga2V5Q29tcGFyZSA9IGNvbGxhdGUoeC5rZXksIHkua2V5KTtcbiAgcmV0dXJuIGtleUNvbXBhcmUgIT09IDAgPyBrZXlDb21wYXJlIDogY29sbGF0ZSh4LnZhbHVlLCB5LnZhbHVlKTtcbn1cblxuZnVuY3Rpb24gc2xpY2VSZXN1bHRzKHJlc3VsdHMsIGxpbWl0LCBza2lwKSB7XG4gIHNraXAgPSBza2lwIHx8IDA7XG4gIGlmICh0eXBlb2YgbGltaXQgPT09ICdudW1iZXInKSB7XG4gICAgcmV0dXJuIHJlc3VsdHMuc2xpY2Uoc2tpcCwgbGltaXQgKyBza2lwKTtcbiAgfSBlbHNlIGlmIChza2lwID4gMCkge1xuICAgIHJldHVybiByZXN1bHRzLnNsaWNlKHNraXApO1xuICB9XG4gIHJldHVybiByZXN1bHRzO1xufVxuXG5mdW5jdGlvbiBjcmVhdGVCdWlsdEluRXJyb3IobmFtZSkge1xuICB2YXIgZXJyb3IgPSBuZXcgRXJyb3IoJ2J1aWx0aW4gJyArIG5hbWUgK1xuICAgICcgZnVuY3Rpb24gcmVxdWlyZXMgbWFwIHZhbHVlcyB0byBiZSBudW1iZXJzJyArXG4gICAgJyBvciBudW1iZXIgYXJyYXlzJyk7XG4gIGVycm9yLm5hbWUgPSAnaW52YWxpZF92YWx1ZSc7XG4gIGVycm9yLnN0YXR1cyA9IDUwMDtcbiAgcmV0dXJuIGVycm9yO1xufVxuXG5mdW5jdGlvbiBzdW0odmFsdWVzKSB7XG4gIHZhciByZXN1bHQgPSAwO1xuICBmb3IgKHZhciBpID0gMCwgbGVuID0gdmFsdWVzLmxlbmd0aDsgaSA8IGxlbjsgaSsrKSB7XG4gICAgdmFyIG51bSA9IHZhbHVlc1tpXTtcbiAgICBpZiAodHlwZW9mIG51bSAhPT0gJ251bWJlcicpIHtcbiAgICAgIGlmIChBcnJheS5pc0FycmF5KG51bSkpIHtcbiAgICAgICAgLy8gbGlzdHMgb2YgbnVtYmVycyBhcmUgYWxzbyBhbGxvd2VkLCBzdW0gdGhlbSBzZXBhcmF0ZWx5XG4gICAgICAgIHJlc3VsdCA9IHR5cGVvZiByZXN1bHQgPT09ICdudW1iZXInID8gW3Jlc3VsdF0gOiByZXN1bHQ7XG4gICAgICAgIGZvciAodmFyIGogPSAwLCBqTGVuID0gbnVtLmxlbmd0aDsgaiA8IGpMZW47IGorKykge1xuICAgICAgICAgIHZhciBqTnVtID0gbnVtW2pdO1xuICAgICAgICAgIGlmICh0eXBlb2Ygak51bSAhPT0gJ251bWJlcicpIHtcbiAgICAgICAgICAgIHRocm93IGNyZWF0ZUJ1aWx0SW5FcnJvcignX3N1bScpO1xuICAgICAgICAgIH0gZWxzZSBpZiAodHlwZW9mIHJlc3VsdFtqXSA9PT0gJ3VuZGVmaW5lZCcpIHtcbiAgICAgICAgICAgIHJlc3VsdC5wdXNoKGpOdW0pO1xuICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICByZXN1bHRbal0gKz0gak51bTtcbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgIH0gZWxzZSB7IC8vIG5vdCBhcnJheS9udW1iZXJcbiAgICAgICAgdGhyb3cgY3JlYXRlQnVpbHRJbkVycm9yKCdfc3VtJyk7XG4gICAgICB9XG4gICAgfSBlbHNlIGlmICh0eXBlb2YgcmVzdWx0ID09PSAnbnVtYmVyJykge1xuICAgICAgcmVzdWx0ICs9IG51bTtcbiAgICB9IGVsc2UgeyAvLyBhZGQgbnVtYmVyIHRvIGFycmF5XG4gICAgICByZXN1bHRbMF0gKz0gbnVtO1xuICAgIH1cbiAgfVxuICByZXR1cm4gcmVzdWx0O1xufVxuXG52YXIgYnVpbHRJblJlZHVjZSA9IHtcbiAgX3N1bTogZnVuY3Rpb24gKGtleXMsIHZhbHVlcykge1xuICAgIHJldHVybiBzdW0odmFsdWVzKTtcbiAgfSxcblxuICBfY291bnQ6IGZ1bmN0aW9uIChrZXlzLCB2YWx1ZXMpIHtcbiAgICByZXR1cm4gdmFsdWVzLmxlbmd0aDtcbiAgfSxcblxuICBfc3RhdHM6IGZ1bmN0aW9uIChrZXlzLCB2YWx1ZXMpIHtcbiAgICAvLyBubyBuZWVkIHRvIGltcGxlbWVudCByZXJlZHVjZT10cnVlLCBiZWNhdXNlIFBvdWNoXG4gICAgLy8gd2lsbCBuZXZlciBjYWxsIGl0XG4gICAgZnVuY3Rpb24gc3Vtc3FyKHZhbHVlcykge1xuICAgICAgdmFyIF9zdW1zcXIgPSAwO1xuICAgICAgZm9yICh2YXIgaSA9IDAsIGxlbiA9IHZhbHVlcy5sZW5ndGg7IGkgPCBsZW47IGkrKykge1xuICAgICAgICB2YXIgbnVtID0gdmFsdWVzW2ldO1xuICAgICAgICBfc3Vtc3FyICs9IChudW0gKiBudW0pO1xuICAgICAgfVxuICAgICAgcmV0dXJuIF9zdW1zcXI7XG4gICAgfVxuICAgIHJldHVybiB7XG4gICAgICBzdW0gICAgIDogc3VtKHZhbHVlcyksXG4gICAgICBtaW4gICAgIDogTWF0aC5taW4uYXBwbHkobnVsbCwgdmFsdWVzKSxcbiAgICAgIG1heCAgICAgOiBNYXRoLm1heC5hcHBseShudWxsLCB2YWx1ZXMpLFxuICAgICAgY291bnQgICA6IHZhbHVlcy5sZW5ndGgsXG4gICAgICBzdW1zcXIgOiBzdW1zcXIodmFsdWVzKVxuICAgIH07XG4gIH1cbn07XG5cbmZ1bmN0aW9uIGFkZEh0dHBQYXJhbShwYXJhbU5hbWUsIG9wdHMsIHBhcmFtcywgYXNKc29uKSB7XG4gIC8vIGFkZCBhbiBodHRwIHBhcmFtIGZyb20gb3B0cyB0byBwYXJhbXMsIG9wdGlvbmFsbHkganNvbi1lbmNvZGVkXG4gIHZhciB2YWwgPSBvcHRzW3BhcmFtTmFtZV07XG4gIGlmICh0eXBlb2YgdmFsICE9PSAndW5kZWZpbmVkJykge1xuICAgIGlmIChhc0pzb24pIHtcbiAgICAgIHZhbCA9IGVuY29kZVVSSUNvbXBvbmVudChKU09OLnN0cmluZ2lmeSh2YWwpKTtcbiAgICB9XG4gICAgcGFyYW1zLnB1c2gocGFyYW1OYW1lICsgJz0nICsgdmFsKTtcbiAgfVxufVxuXG5mdW5jdGlvbiBjaGVja1F1ZXJ5UGFyc2VFcnJvcihvcHRpb25zLCBmdW4pIHtcbiAgdmFyIHN0YXJ0a2V5TmFtZSA9IG9wdGlvbnMuZGVzY2VuZGluZyA/ICdlbmRrZXknIDogJ3N0YXJ0a2V5JztcbiAgdmFyIGVuZGtleU5hbWUgPSBvcHRpb25zLmRlc2NlbmRpbmcgPyAnc3RhcnRrZXknIDogJ2VuZGtleSc7XG5cbiAgaWYgKHR5cGVvZiBvcHRpb25zW3N0YXJ0a2V5TmFtZV0gIT09ICd1bmRlZmluZWQnICYmXG4gICAgdHlwZW9mIG9wdGlvbnNbZW5ka2V5TmFtZV0gIT09ICd1bmRlZmluZWQnICYmXG4gICAgY29sbGF0ZShvcHRpb25zW3N0YXJ0a2V5TmFtZV0sIG9wdGlvbnNbZW5ka2V5TmFtZV0pID4gMCkge1xuICAgIHRocm93IG5ldyBRdWVyeVBhcnNlRXJyb3IoJ05vIHJvd3MgY2FuIG1hdGNoIHlvdXIga2V5IHJhbmdlLCByZXZlcnNlIHlvdXIgJyArXG4gICAgICAgICdzdGFydF9rZXkgYW5kIGVuZF9rZXkgb3Igc2V0IHtkZXNjZW5kaW5nIDogdHJ1ZX0nKTtcbiAgfSBlbHNlIGlmIChmdW4ucmVkdWNlICYmIG9wdGlvbnMucmVkdWNlICE9PSBmYWxzZSkge1xuICAgIGlmIChvcHRpb25zLmluY2x1ZGVfZG9jcykge1xuICAgICAgdGhyb3cgbmV3IFF1ZXJ5UGFyc2VFcnJvcigne2luY2x1ZGVfZG9jczp0cnVlfSBpcyBpbnZhbGlkIGZvciByZWR1Y2UnKTtcbiAgICB9IGVsc2UgaWYgKG9wdGlvbnMua2V5cyAmJiBvcHRpb25zLmtleXMubGVuZ3RoID4gMSAmJlxuICAgICAgICAhb3B0aW9ucy5ncm91cCAmJiAhb3B0aW9ucy5ncm91cF9sZXZlbCkge1xuICAgICAgdGhyb3cgbmV3IFF1ZXJ5UGFyc2VFcnJvcignTXVsdGkta2V5IGZldGNoZXMgZm9yIHJlZHVjZSB2aWV3cyBtdXN0IHVzZSB7Z3JvdXA6IHRydWV9Jyk7XG4gICAgfVxuICB9XG4gIGlmIChvcHRpb25zLmdyb3VwX2xldmVsKSB7XG4gICAgaWYgKHR5cGVvZiBvcHRpb25zLmdyb3VwX2xldmVsICE9PSAnbnVtYmVyJykge1xuICAgICAgdGhyb3cgbmV3IFF1ZXJ5UGFyc2VFcnJvcignSW52YWxpZCB2YWx1ZSBmb3IgaW50ZWdlcjogXCInICsgb3B0aW9ucy5ncm91cF9sZXZlbCArICdcIicpO1xuICAgIH1cbiAgICBpZiAob3B0aW9ucy5ncm91cF9sZXZlbCA8IDApIHtcbiAgICAgIHRocm93IG5ldyBRdWVyeVBhcnNlRXJyb3IoJ0ludmFsaWQgdmFsdWUgZm9yIHBvc2l0aXZlIGludGVnZXI6ICcgK1xuICAgICAgICAnXCInICsgb3B0aW9ucy5ncm91cF9sZXZlbCArICdcIicpO1xuICAgIH1cbiAgfVxufVxuXG5mdW5jdGlvbiBodHRwUXVlcnkoZGIsIGZ1biwgb3B0cykge1xuICAvLyBMaXN0IG9mIHBhcmFtZXRlcnMgdG8gYWRkIHRvIHRoZSBQVVQgcmVxdWVzdFxuICB2YXIgcGFyYW1zID0gW107XG4gIHZhciBib2R5O1xuICB2YXIgbWV0aG9kID0gJ0dFVCc7XG5cbiAgLy8gSWYgb3B0cy5yZWR1Y2UgZXhpc3RzIGFuZCBpcyBkZWZpbmVkLCB0aGVuIGFkZCBpdCB0byB0aGUgbGlzdFxuICAvLyBvZiBwYXJhbWV0ZXJzLlxuICAvLyBJZiByZWR1Y2U9ZmFsc2UgdGhlbiB0aGUgcmVzdWx0cyBhcmUgdGhhdCBvZiBvbmx5IHRoZSBtYXAgZnVuY3Rpb25cbiAgLy8gbm90IHRoZSBmaW5hbCByZXN1bHQgb2YgbWFwIGFuZCByZWR1Y2UuXG4gIGFkZEh0dHBQYXJhbSgncmVkdWNlJywgb3B0cywgcGFyYW1zKTtcbiAgYWRkSHR0cFBhcmFtKCdpbmNsdWRlX2RvY3MnLCBvcHRzLCBwYXJhbXMpO1xuICBhZGRIdHRwUGFyYW0oJ2xpbWl0Jywgb3B0cywgcGFyYW1zKTtcbiAgYWRkSHR0cFBhcmFtKCdkZXNjZW5kaW5nJywgb3B0cywgcGFyYW1zKTtcbiAgYWRkSHR0cFBhcmFtKCdncm91cCcsIG9wdHMsIHBhcmFtcyk7XG4gIGFkZEh0dHBQYXJhbSgnZ3JvdXBfbGV2ZWwnLCBvcHRzLCBwYXJhbXMpO1xuICBhZGRIdHRwUGFyYW0oJ3NraXAnLCBvcHRzLCBwYXJhbXMpO1xuICBhZGRIdHRwUGFyYW0oJ3N0YWxlJywgb3B0cywgcGFyYW1zKTtcbiAgYWRkSHR0cFBhcmFtKCdzdGFydGtleScsIG9wdHMsIHBhcmFtcywgdHJ1ZSk7XG4gIGFkZEh0dHBQYXJhbSgnZW5ka2V5Jywgb3B0cywgcGFyYW1zLCB0cnVlKTtcbiAgYWRkSHR0cFBhcmFtKCdpbmNsdXNpdmVfZW5kJywgb3B0cywgcGFyYW1zKTtcbiAgYWRkSHR0cFBhcmFtKCdrZXknLCBvcHRzLCBwYXJhbXMsIHRydWUpO1xuXG4gIC8vIEZvcm1hdCB0aGUgbGlzdCBvZiBwYXJhbWV0ZXJzIGludG8gYSB2YWxpZCBVUkkgcXVlcnkgc3RyaW5nXG4gIHBhcmFtcyA9IHBhcmFtcy5qb2luKCcmJyk7XG4gIHBhcmFtcyA9IHBhcmFtcyA9PT0gJycgPyAnJyA6ICc/JyArIHBhcmFtcztcblxuICAvLyBJZiBrZXlzIGFyZSBzdXBwbGllZCwgaXNzdWUgYSBQT1NUIHJlcXVlc3QgdG8gY2lyY3VtdmVudCBHRVQgcXVlcnkgc3RyaW5nIGxpbWl0c1xuICAvLyBzZWUgaHR0cDovL3dpa2kuYXBhY2hlLm9yZy9jb3VjaGRiL0hUVFBfdmlld19BUEkjUXVlcnlpbmdfT3B0aW9uc1xuICBpZiAodHlwZW9mIG9wdHMua2V5cyAhPT0gJ3VuZGVmaW5lZCcpIHtcbiAgICB2YXIgTUFYX1VSTF9MRU5HVEggPSAyMDAwO1xuICAgIC8vIGFjY29yZGluZyB0byBodHRwOi8vc3RhY2tvdmVyZmxvdy5jb20vYS80MTcxODQvNjgwNzQyLFxuICAgIC8vIHRoZSBkZSBmYWN0byBVUkwgbGVuZ3RoIGxpbWl0IGlzIDIwMDAgY2hhcmFjdGVyc1xuXG4gICAgdmFyIGtleXNBc1N0cmluZyA9XG4gICAgICAna2V5cz0nICsgZW5jb2RlVVJJQ29tcG9uZW50KEpTT04uc3RyaW5naWZ5KG9wdHMua2V5cykpO1xuICAgIGlmIChrZXlzQXNTdHJpbmcubGVuZ3RoICsgcGFyYW1zLmxlbmd0aCArIDEgPD0gTUFYX1VSTF9MRU5HVEgpIHtcbiAgICAgIC8vIElmIHRoZSBrZXlzIGFyZSBzaG9ydCBlbm91Z2gsIGRvIGEgR0VULiB3ZSBkbyB0aGlzIHRvIHdvcmsgYXJvdW5kXG4gICAgICAvLyBTYWZhcmkgbm90IHVuZGVyc3RhbmRpbmcgMzA0cyBvbiBQT1NUcyAoc2VlIHBvdWNoZGIvcG91Y2hkYiMxMjM5KVxuICAgICAgcGFyYW1zICs9IChwYXJhbXNbMF0gPT09ICc/JyA/ICcmJyA6ICc/JykgKyBrZXlzQXNTdHJpbmc7XG4gICAgfSBlbHNlIHtcbiAgICAgIG1ldGhvZCA9ICdQT1NUJztcbiAgICAgIGlmICh0eXBlb2YgZnVuID09PSAnc3RyaW5nJykge1xuICAgICAgICBib2R5ID0gSlNPTi5zdHJpbmdpZnkoe2tleXM6IG9wdHMua2V5c30pO1xuICAgICAgfSBlbHNlIHsgLy8gZnVuIGlzIHttYXAgOiBtYXBmdW59LCBzbyBhcHBlbmQgdG8gdGhpc1xuICAgICAgICBmdW4ua2V5cyA9IG9wdHMua2V5cztcbiAgICAgIH1cbiAgICB9XG4gIH1cblxuICAvLyBXZSBhcmUgcmVmZXJlbmNpbmcgYSBxdWVyeSBkZWZpbmVkIGluIHRoZSBkZXNpZ24gZG9jXG4gIGlmICh0eXBlb2YgZnVuID09PSAnc3RyaW5nJykge1xuICAgIHZhciBwYXJ0cyA9IHBhcnNlVmlld05hbWUoZnVuKTtcbiAgICByZXR1cm4gZGIucmVxdWVzdCh7XG4gICAgICBtZXRob2Q6IG1ldGhvZCxcbiAgICAgIHVybDogJ19kZXNpZ24vJyArIHBhcnRzWzBdICsgJy9fdmlldy8nICsgcGFydHNbMV0gKyBwYXJhbXMsXG4gICAgICBib2R5OiBib2R5XG4gICAgfSk7XG4gIH1cblxuICAvLyBXZSBhcmUgdXNpbmcgYSB0ZW1wb3JhcnkgdmlldywgdGVycmlibGUgZm9yIHBlcmZvcm1hbmNlIGJ1dCBnb29kIGZvciB0ZXN0aW5nXG4gIGJvZHkgPSBib2R5IHx8IHt9O1xuICBPYmplY3Qua2V5cyhmdW4pLmZvckVhY2goZnVuY3Rpb24gKGtleSkge1xuICAgIGlmIChBcnJheS5pc0FycmF5KGZ1bltrZXldKSkge1xuICAgICAgYm9keVtrZXldID0gZnVuW2tleV07XG4gICAgfSBlbHNlIHtcbiAgICAgIGJvZHlba2V5XSA9IGZ1bltrZXldLnRvU3RyaW5nKCk7XG4gICAgfVxuICB9KTtcbiAgcmV0dXJuIGRiLnJlcXVlc3Qoe1xuICAgIG1ldGhvZDogJ1BPU1QnLFxuICAgIHVybDogJ190ZW1wX3ZpZXcnICsgcGFyYW1zLFxuICAgIGJvZHk6IGJvZHlcbiAgfSk7XG59XG5cbmZ1bmN0aW9uIGRlZmF1bHRzVG8odmFsdWUpIHtcbiAgcmV0dXJuIGZ1bmN0aW9uIChyZWFzb24pIHtcbiAgICAvKiBpc3RhbmJ1bCBpZ25vcmUgZWxzZSAqL1xuICAgIGlmIChyZWFzb24uc3RhdHVzID09PSA0MDQpIHtcbiAgICAgIHJldHVybiB2YWx1ZTtcbiAgICB9IGVsc2Uge1xuICAgICAgdGhyb3cgcmVhc29uO1xuICAgIH1cbiAgfTtcbn1cblxuLy8gcmV0dXJucyBhIHByb21pc2UgZm9yIGEgbGlzdCBvZiBkb2NzIHRvIHVwZGF0ZSwgYmFzZWQgb24gdGhlIGlucHV0IGRvY0lkLlxuLy8gd2UgdXBkYXRlIHRoZSBtZXRhRG9jIGZpcnN0IChpLmUuIHRoZSBkb2MgdGhhdCBwb2ludHMgZnJvbSB0aGUgc291cmNlREJcbi8vIGRvY3VtZW50IElkIHRvIHRoZSBpZHMgb2YgdGhlIGRvY3VtZW50cyBpbiB0aGUgbXJ2aWV3IGRhdGFiYXNlKSwgdGhlblxuLy8gdGhlIGtleS92YWx1ZSBkb2NzLiAgdGhhdCB3YXksIGlmIGxpZ2h0bmluZyBzdHJpa2VzIHRoZSB1c2VyJ3MgY29tcHV0ZXJcbi8vIGluIHRoZSBtaWRkbGUgb2YgYW4gdXBkYXRlLCB3ZSBkb24ndCB3cml0ZSBhbnkgZG9jcyB0aGF0IHdlIHdvdWxkbid0XG4vLyBiZSBhYmxlIHRvIGZpbmQgbGF0ZXIgdXNpbmcgdGhlIG1ldGFEb2MuXG5mdW5jdGlvbiBnZXREb2NzVG9QZXJzaXN0KGRvY0lkLCB2aWV3LCBkb2NJZHNUb0VtaXRzKSB7XG4gIHZhciBtZXRhRG9jSWQgPSAnX2xvY2FsL2RvY18nICsgZG9jSWQ7XG4gIHJldHVybiB2aWV3LmRiLmdldChtZXRhRG9jSWQpW1xuICAgIFwiY2F0Y2hcIl0oZGVmYXVsdHNUbyh7X2lkOiBtZXRhRG9jSWQsIGtleXM6IFtdfSkpXG4gICAgLnRoZW4oZnVuY3Rpb24gKG1ldGFEb2MpIHtcbiAgICAgIHJldHVybiBQcm9taXNlLnJlc29sdmUoKS50aGVuKGZ1bmN0aW9uICgpIHtcbiAgICAgICAgaWYgKG1ldGFEb2Mua2V5cy5sZW5ndGgpIHtcbiAgICAgICAgICByZXR1cm4gdmlldy5kYi5hbGxEb2NzKHtcbiAgICAgICAgICAgIGtleXM6IG1ldGFEb2Mua2V5cyxcbiAgICAgICAgICAgIGluY2x1ZGVfZG9jczogdHJ1ZVxuICAgICAgICAgIH0pO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiB7cm93czogW119OyAvLyBubyBrZXlzLCBubyBuZWVkIGZvciBhIGxvb2t1cFxuICAgICAgfSkudGhlbihmdW5jdGlvbiAocmVzKSB7XG4gICAgICAgIHZhciBrdkRvY3MgPSByZXMucm93cy5tYXAoZnVuY3Rpb24gKHJvdykge1xuICAgICAgICAgIHJldHVybiByb3cuZG9jO1xuICAgICAgICB9KS5maWx0ZXIoZnVuY3Rpb24gKHJvdykge1xuICAgICAgICAgIHJldHVybiByb3c7XG4gICAgICAgIH0pO1xuXG4gICAgICAgIHZhciBpbmRleGFibGVLZXlzVG9LZXlWYWx1ZXMgPSBkb2NJZHNUb0VtaXRzW2RvY0lkXTtcbiAgICAgICAgdmFyIG9sZEtleXNNYXAgPSB7fTtcbiAgICAgICAga3ZEb2NzLmZvckVhY2goZnVuY3Rpb24gKGt2RG9jKSB7XG4gICAgICAgICAgb2xkS2V5c01hcFtrdkRvYy5faWRdID0gdHJ1ZTtcbiAgICAgICAgICBrdkRvYy5fZGVsZXRlZCA9ICFpbmRleGFibGVLZXlzVG9LZXlWYWx1ZXNba3ZEb2MuX2lkXTtcbiAgICAgICAgICBpZiAoIWt2RG9jLl9kZWxldGVkKSB7XG4gICAgICAgICAgICB2YXIga2V5VmFsdWUgPSBpbmRleGFibGVLZXlzVG9LZXlWYWx1ZXNba3ZEb2MuX2lkXTtcbiAgICAgICAgICAgIGlmICgndmFsdWUnIGluIGtleVZhbHVlKSB7XG4gICAgICAgICAgICAgIGt2RG9jLnZhbHVlID0ga2V5VmFsdWUudmFsdWU7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgfVxuICAgICAgICB9KTtcblxuICAgICAgICB2YXIgbmV3S2V5cyA9IE9iamVjdC5rZXlzKGluZGV4YWJsZUtleXNUb0tleVZhbHVlcyk7XG4gICAgICAgIG5ld0tleXMuZm9yRWFjaChmdW5jdGlvbiAoa2V5KSB7XG4gICAgICAgICAgaWYgKCFvbGRLZXlzTWFwW2tleV0pIHtcbiAgICAgICAgICAgIC8vIG5ldyBkb2NcbiAgICAgICAgICAgIHZhciBrdkRvYyA9IHtcbiAgICAgICAgICAgICAgX2lkOiBrZXlcbiAgICAgICAgICAgIH07XG4gICAgICAgICAgICB2YXIga2V5VmFsdWUgPSBpbmRleGFibGVLZXlzVG9LZXlWYWx1ZXNba2V5XTtcbiAgICAgICAgICAgIGlmICgndmFsdWUnIGluIGtleVZhbHVlKSB7XG4gICAgICAgICAgICAgIGt2RG9jLnZhbHVlID0ga2V5VmFsdWUudmFsdWU7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBrdkRvY3MucHVzaChrdkRvYyk7XG4gICAgICAgICAgfVxuICAgICAgICB9KTtcbiAgICAgICAgbWV0YURvYy5rZXlzID0gdXRpbHMudW5pcShuZXdLZXlzLmNvbmNhdChtZXRhRG9jLmtleXMpKTtcbiAgICAgICAga3ZEb2NzLnNwbGljZSgwLCAwLCBtZXRhRG9jKTtcblxuICAgICAgICByZXR1cm4ga3ZEb2NzO1xuICAgICAgfSk7XG4gICAgfSk7XG59XG5cbi8vIHVwZGF0ZXMgYWxsIGVtaXR0ZWQga2V5L3ZhbHVlIGRvY3MgYW5kIG1ldGFEb2NzIGluIHRoZSBtcnZpZXcgZGF0YWJhc2Vcbi8vIGZvciB0aGUgZ2l2ZW4gYmF0Y2ggb2YgZG9jdW1lbnRzIGZyb20gdGhlIHNvdXJjZSBkYXRhYmFzZVxuZnVuY3Rpb24gc2F2ZUtleVZhbHVlcyh2aWV3LCBkb2NJZHNUb0VtaXRzLCBzZXEpIHtcbiAgdmFyIHNlcURvY0lkID0gJ19sb2NhbC9sYXN0U2VxJztcbiAgcmV0dXJuIHZpZXcuZGIuZ2V0KHNlcURvY0lkKVtcbiAgXCJjYXRjaFwiXShkZWZhdWx0c1RvKHtfaWQ6IHNlcURvY0lkLCBzZXE6IDB9KSlcbiAgLnRoZW4oZnVuY3Rpb24gKGxhc3RTZXFEb2MpIHtcbiAgICB2YXIgZG9jSWRzID0gT2JqZWN0LmtleXMoZG9jSWRzVG9FbWl0cyk7XG4gICAgcmV0dXJuIFByb21pc2UuYWxsKGRvY0lkcy5tYXAoZnVuY3Rpb24gKGRvY0lkKSB7XG4gICAgICAgIHJldHVybiBnZXREb2NzVG9QZXJzaXN0KGRvY0lkLCB2aWV3LCBkb2NJZHNUb0VtaXRzKTtcbiAgICAgIH0pKS50aGVuKGZ1bmN0aW9uIChsaXN0T2ZEb2NzVG9QZXJzaXN0KSB7XG4gICAgICAgIHZhciBkb2NzVG9QZXJzaXN0ID0gW107XG4gICAgICAgIGxpc3RPZkRvY3NUb1BlcnNpc3QuZm9yRWFjaChmdW5jdGlvbiAoZG9jTGlzdCkge1xuICAgICAgICAgIGRvY3NUb1BlcnNpc3QgPSBkb2NzVG9QZXJzaXN0LmNvbmNhdChkb2NMaXN0KTtcbiAgICAgICAgfSk7XG5cbiAgICAgICAgLy8gdXBkYXRlIHRoZSBzZXEgZG9jIGxhc3QsIHNvIHRoYXQgaWYgYSBtZXRlb3Igc3RyaWtlcyB0aGUgdXNlcidzXG4gICAgICAgIC8vIGNvbXB1dGVyIGluIHRoZSBtaWRkbGUgb2YgYW4gdXBkYXRlLCB3ZSBjYW4gYXBwbHkgdGhlIGlkZW1wb3RlbnRcbiAgICAgICAgLy8gYmF0Y2ggdXBkYXRlIG9wZXJhdGlvbiBhZ2FpblxuICAgICAgICBsYXN0U2VxRG9jLnNlcSA9IHNlcTtcbiAgICAgICAgZG9jc1RvUGVyc2lzdC5wdXNoKGxhc3RTZXFEb2MpO1xuXG4gICAgICAgIHJldHVybiB2aWV3LmRiLmJ1bGtEb2NzKHtkb2NzIDogZG9jc1RvUGVyc2lzdH0pO1xuICAgICAgfSk7XG4gIH0pO1xufVxuXG52YXIgdXBkYXRlVmlldyA9IHV0aWxzLnNlcXVlbnRpYWxpemUobWFpblF1ZXVlLCBmdW5jdGlvbiAodmlldykge1xuICAvLyBiaW5kIHRoZSBlbWl0IGZ1bmN0aW9uIG9uY2VcbiAgdmFyIG1hcFJlc3VsdHM7XG4gIHZhciBkb2M7XG5cbiAgZnVuY3Rpb24gZW1pdChrZXksIHZhbHVlKSB7XG4gICAgdmFyIG91dHB1dCA9IHsgaWQ6IGRvYy5faWQsIGtleTogbm9ybWFsaXplS2V5KGtleSkgfTtcbiAgICAvLyBEb24ndCBleHBsaWNpdGx5IHN0b3JlIHRoZSB2YWx1ZSB1bmxlc3MgaXQncyBkZWZpbmVkIGFuZCBub24tbnVsbC5cbiAgICAvLyBUaGlzIHNhdmVzIG9uIHN0b3JhZ2Ugc3BhY2UsIGJlY2F1c2Ugb2Z0ZW4gcGVvcGxlIGRvbid0IHVzZSBpdC5cbiAgICBpZiAodHlwZW9mIHZhbHVlICE9PSAndW5kZWZpbmVkJyAmJiB2YWx1ZSAhPT0gbnVsbCkge1xuICAgICAgb3V0cHV0LnZhbHVlID0gbm9ybWFsaXplS2V5KHZhbHVlKTtcbiAgICB9XG4gICAgbWFwUmVzdWx0cy5wdXNoKG91dHB1dCk7XG4gIH1cblxuICB2YXIgbWFwRnVuO1xuICAvLyBmb3IgdGVtcF92aWV3cyBvbmUgY2FuIHVzZSBlbWl0KGRvYywgZW1pdCksIHNlZSAjMzhcbiAgaWYgKHR5cGVvZiB2aWV3Lm1hcEZ1biA9PT0gXCJmdW5jdGlvblwiICYmIHZpZXcubWFwRnVuLmxlbmd0aCA9PT0gMikge1xuICAgIHZhciBvcmlnTWFwID0gdmlldy5tYXBGdW47XG4gICAgbWFwRnVuID0gZnVuY3Rpb24gKGRvYykge1xuICAgICAgcmV0dXJuIG9yaWdNYXAoZG9jLCBlbWl0KTtcbiAgICB9O1xuICB9IGVsc2Uge1xuICAgIG1hcEZ1biA9IGV2YWxGdW5jKHZpZXcubWFwRnVuLnRvU3RyaW5nKCksIGVtaXQsIHN1bSwgbG9nLCBBcnJheS5pc0FycmF5LCBKU09OLnBhcnNlKTtcbiAgfVxuXG4gIHZhciBjdXJyZW50U2VxID0gdmlldy5zZXEgfHwgMDtcblxuICBmdW5jdGlvbiBwcm9jZXNzQ2hhbmdlKGRvY0lkc1RvRW1pdHMsIHNlcSkge1xuICAgIHJldHVybiBmdW5jdGlvbiAoKSB7XG4gICAgICByZXR1cm4gc2F2ZUtleVZhbHVlcyh2aWV3LCBkb2NJZHNUb0VtaXRzLCBzZXEpO1xuICAgIH07XG4gIH1cbiAgdmFyIHF1ZXVlID0gbmV3IFRhc2tRdWV1ZSgpO1xuICAvLyBUT0RPKG5lb2pza2kpOiBodHRwczovL2dpdGh1Yi5jb20vZGFsZWhhcnZleS9wb3VjaGRiL2lzc3Vlcy8xNTIxXG5cbiAgcmV0dXJuIG5ldyBQcm9taXNlKGZ1bmN0aW9uIChyZXNvbHZlLCByZWplY3QpIHtcblxuICAgIGZ1bmN0aW9uIGNvbXBsZXRlKCkge1xuICAgICAgcXVldWUuZmluaXNoKCkudGhlbihmdW5jdGlvbiAoKSB7XG4gICAgICAgIHZpZXcuc2VxID0gY3VycmVudFNlcTtcbiAgICAgICAgcmVzb2x2ZSgpO1xuICAgICAgfSk7XG4gICAgfVxuXG4gICAgZnVuY3Rpb24gcHJvY2Vzc05leHRCYXRjaCgpIHtcbiAgICAgIHZpZXcuc291cmNlREIuY2hhbmdlcyh7XG4gICAgICAgIGNvbmZsaWN0czogdHJ1ZSxcbiAgICAgICAgaW5jbHVkZV9kb2NzOiB0cnVlLFxuICAgICAgICBzaW5jZSA6IGN1cnJlbnRTZXEsXG4gICAgICAgIGxpbWl0IDogQ0hBTkdFU19CQVRDSF9TSVpFXG4gICAgICB9KS5vbignY29tcGxldGUnLCBmdW5jdGlvbiAocmVzcG9uc2UpIHtcbiAgICAgICAgdmFyIHJlc3VsdHMgPSByZXNwb25zZS5yZXN1bHRzO1xuICAgICAgICBpZiAoIXJlc3VsdHMubGVuZ3RoKSB7XG4gICAgICAgICAgcmV0dXJuIGNvbXBsZXRlKCk7XG4gICAgICAgIH1cbiAgICAgICAgdmFyIGRvY0lkc1RvRW1pdHMgPSB7fTtcbiAgICAgICAgZm9yICh2YXIgaSA9IDAsIGwgPSByZXN1bHRzLmxlbmd0aDsgaSA8IGw7IGkrKykge1xuICAgICAgICAgIHZhciBjaGFuZ2UgPSByZXN1bHRzW2ldO1xuICAgICAgICAgIGlmIChjaGFuZ2UuZG9jLl9pZFswXSAhPT0gJ18nKSB7XG4gICAgICAgICAgICBtYXBSZXN1bHRzID0gW107XG4gICAgICAgICAgICBkb2MgPSBjaGFuZ2UuZG9jO1xuXG4gICAgICAgICAgICBpZiAoIWRvYy5fZGVsZXRlZCkge1xuICAgICAgICAgICAgICB0cnlDb2RlKHZpZXcuc291cmNlREIsIG1hcEZ1biwgW2RvY10pO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgbWFwUmVzdWx0cy5zb3J0KHNvcnRCeUtleVRoZW5WYWx1ZSk7XG5cbiAgICAgICAgICAgIHZhciBpbmRleGFibGVLZXlzVG9LZXlWYWx1ZXMgPSB7fTtcbiAgICAgICAgICAgIHZhciBsYXN0S2V5O1xuICAgICAgICAgICAgZm9yICh2YXIgaiA9IDAsIGpsID0gbWFwUmVzdWx0cy5sZW5ndGg7IGogPCBqbDsgaisrKSB7XG4gICAgICAgICAgICAgIHZhciBvYmogPSBtYXBSZXN1bHRzW2pdO1xuICAgICAgICAgICAgICB2YXIgY29tcGxleEtleSA9IFtvYmoua2V5LCBvYmouaWRdO1xuICAgICAgICAgICAgICBpZiAob2JqLmtleSA9PT0gbGFzdEtleSkge1xuICAgICAgICAgICAgICAgIGNvbXBsZXhLZXkucHVzaChqKTsgLy8gZHVwIGtleStpZCwgc28gbWFrZSBpdCB1bmlxdWVcbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICB2YXIgaW5kZXhhYmxlS2V5ID0gdG9JbmRleGFibGVTdHJpbmcoY29tcGxleEtleSk7XG4gICAgICAgICAgICAgIGluZGV4YWJsZUtleXNUb0tleVZhbHVlc1tpbmRleGFibGVLZXldID0gb2JqO1xuICAgICAgICAgICAgICBsYXN0S2V5ID0gb2JqLmtleTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGRvY0lkc1RvRW1pdHNbY2hhbmdlLmRvYy5faWRdID0gaW5kZXhhYmxlS2V5c1RvS2V5VmFsdWVzO1xuICAgICAgICAgIH1cbiAgICAgICAgICBjdXJyZW50U2VxID0gY2hhbmdlLnNlcTtcbiAgICAgICAgfVxuICAgICAgICBxdWV1ZS5hZGQocHJvY2Vzc0NoYW5nZShkb2NJZHNUb0VtaXRzLCBjdXJyZW50U2VxKSk7XG4gICAgICAgIGlmIChyZXN1bHRzLmxlbmd0aCA8IENIQU5HRVNfQkFUQ0hfU0laRSkge1xuICAgICAgICAgIHJldHVybiBjb21wbGV0ZSgpO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBwcm9jZXNzTmV4dEJhdGNoKCk7XG4gICAgICB9KS5vbignZXJyb3InLCBvbkVycm9yKTtcbiAgICAgIC8qIGlzdGFuYnVsIGlnbm9yZSBuZXh0ICovXG4gICAgICBmdW5jdGlvbiBvbkVycm9yKGVycikge1xuICAgICAgICByZWplY3QoZXJyKTtcbiAgICAgIH1cbiAgICB9XG4gICAgcHJvY2Vzc05leHRCYXRjaCgpO1xuICB9KTtcbn0pO1xuXG5mdW5jdGlvbiByZWR1Y2VWaWV3KHZpZXcsIHJlc3VsdHMsIG9wdGlvbnMpIHtcbiAgaWYgKG9wdGlvbnMuZ3JvdXBfbGV2ZWwgPT09IDApIHtcbiAgICBkZWxldGUgb3B0aW9ucy5ncm91cF9sZXZlbDtcbiAgfVxuXG4gIHZhciBzaG91bGRHcm91cCA9IG9wdGlvbnMuZ3JvdXAgfHwgb3B0aW9ucy5ncm91cF9sZXZlbDtcblxuICB2YXIgcmVkdWNlRnVuO1xuICBpZiAoYnVpbHRJblJlZHVjZVt2aWV3LnJlZHVjZUZ1bl0pIHtcbiAgICByZWR1Y2VGdW4gPSBidWlsdEluUmVkdWNlW3ZpZXcucmVkdWNlRnVuXTtcbiAgfSBlbHNlIHtcbiAgICByZWR1Y2VGdW4gPSBldmFsRnVuYyhcbiAgICAgIHZpZXcucmVkdWNlRnVuLnRvU3RyaW5nKCksIG51bGwsIHN1bSwgbG9nLCBBcnJheS5pc0FycmF5LCBKU09OLnBhcnNlKTtcbiAgfVxuXG4gIHZhciBncm91cHMgPSBbXTtcbiAgdmFyIGx2bCA9IG9wdGlvbnMuZ3JvdXBfbGV2ZWw7XG4gIHJlc3VsdHMuZm9yRWFjaChmdW5jdGlvbiAoZSkge1xuICAgIHZhciBsYXN0ID0gZ3JvdXBzW2dyb3Vwcy5sZW5ndGggLSAxXTtcbiAgICB2YXIga2V5ID0gc2hvdWxkR3JvdXAgPyBlLmtleSA6IG51bGw7XG5cbiAgICAvLyBvbmx5IHNldCBncm91cF9sZXZlbCBmb3IgYXJyYXkga2V5c1xuICAgIGlmIChzaG91bGRHcm91cCAmJiBBcnJheS5pc0FycmF5KGtleSkgJiYgdHlwZW9mIGx2bCA9PT0gJ251bWJlcicpIHtcbiAgICAgIGtleSA9IGtleS5sZW5ndGggPiBsdmwgPyBrZXkuc2xpY2UoMCwgbHZsKSA6IGtleTtcbiAgICB9XG5cbiAgICBpZiAobGFzdCAmJiBjb2xsYXRlKGxhc3Qua2V5WzBdWzBdLCBrZXkpID09PSAwKSB7XG4gICAgICBsYXN0LmtleS5wdXNoKFtrZXksIGUuaWRdKTtcbiAgICAgIGxhc3QudmFsdWUucHVzaChlLnZhbHVlKTtcbiAgICAgIHJldHVybjtcbiAgICB9XG4gICAgZ3JvdXBzLnB1c2goe2tleTogW1xuICAgICAgW2tleSwgZS5pZF1cbiAgICBdLCB2YWx1ZTogW2UudmFsdWVdfSk7XG4gIH0pO1xuICBmb3IgKHZhciBpID0gMCwgbGVuID0gZ3JvdXBzLmxlbmd0aDsgaSA8IGxlbjsgaSsrKSB7XG4gICAgdmFyIGUgPSBncm91cHNbaV07XG4gICAgdmFyIHJlZHVjZVRyeSA9IHRyeUNvZGUodmlldy5zb3VyY2VEQiwgcmVkdWNlRnVuLCBbZS5rZXksIGUudmFsdWUsIGZhbHNlXSk7XG4gICAgLy8gQ291Y2hEQiB0eXBpY2FsbHkganVzdCBzZXRzIHRoZSB2YWx1ZSB0byBudWxsIGlmIHJlZHVjZSBlcnJvcnMgb3V0XG4gICAgZS52YWx1ZSA9IHJlZHVjZVRyeS5lcnJvciA/IG51bGwgOiByZWR1Y2VUcnkub3V0cHV0O1xuICAgIGUua2V5ID0gZS5rZXlbMF1bMF07XG4gIH1cbiAgLy8gbm8gdG90YWxfcm93cy9vZmZzZXQgd2hlbiByZWR1Y2luZ1xuICByZXR1cm4ge3Jvd3M6IHNsaWNlUmVzdWx0cyhncm91cHMsIG9wdGlvbnMubGltaXQsIG9wdGlvbnMuc2tpcCl9O1xufVxuXG52YXIgcXVlcnlWaWV3ID0gdXRpbHMuc2VxdWVudGlhbGl6ZShtYWluUXVldWUsIGZ1bmN0aW9uICh2aWV3LCBvcHRzKSB7XG4gIHZhciB0b3RhbFJvd3M7XG4gIHZhciBzaG91bGRSZWR1Y2UgPSB2aWV3LnJlZHVjZUZ1biAmJiBvcHRzLnJlZHVjZSAhPT0gZmFsc2U7XG4gIHZhciBza2lwID0gb3B0cy5za2lwIHx8IDA7XG4gIGlmICh0eXBlb2Ygb3B0cy5rZXlzICE9PSAndW5kZWZpbmVkJyAmJiAhb3B0cy5rZXlzLmxlbmd0aCkge1xuICAgIC8vIGVxdWl2YWxlbnQgcXVlcnlcbiAgICBvcHRzLmxpbWl0ID0gMDtcbiAgICBkZWxldGUgb3B0cy5rZXlzO1xuICB9XG5cbiAgZnVuY3Rpb24gZmV0Y2hGcm9tVmlldyh2aWV3T3B0cykge1xuICAgIHZpZXdPcHRzLmluY2x1ZGVfZG9jcyA9IHRydWU7XG4gICAgcmV0dXJuIHZpZXcuZGIuYWxsRG9jcyh2aWV3T3B0cykudGhlbihmdW5jdGlvbiAocmVzKSB7XG4gICAgICB0b3RhbFJvd3MgPSByZXMudG90YWxfcm93cztcbiAgICAgIHJldHVybiByZXMucm93cy5tYXAoZnVuY3Rpb24gKHJlc3VsdCkge1xuXG4gICAgICAgIC8vIGltcGxpY2l0IG1pZ3JhdGlvbiAtIGluIG9sZGVyIHZlcnNpb25zIG9mIFBvdWNoREIsXG4gICAgICAgIC8vIHdlIGV4cGxpY2l0bHkgc3RvcmVkIHRoZSBkb2MgYXMge2lkOiAuLi4sIGtleTogLi4uLCB2YWx1ZTogLi4ufVxuICAgICAgICAvLyB0aGlzIGlzIHRlc3RlZCBpbiBhIG1pZ3JhdGlvbiB0ZXN0XG4gICAgICAgIC8qIGlzdGFuYnVsIGlnbm9yZSBuZXh0ICovXG4gICAgICAgIGlmICgndmFsdWUnIGluIHJlc3VsdC5kb2MgJiYgdHlwZW9mIHJlc3VsdC5kb2MudmFsdWUgPT09ICdvYmplY3QnICYmXG4gICAgICAgICAgICByZXN1bHQuZG9jLnZhbHVlICE9PSBudWxsKSB7XG4gICAgICAgICAgdmFyIGtleXMgPSBPYmplY3Qua2V5cyhyZXN1bHQuZG9jLnZhbHVlKS5zb3J0KCk7XG4gICAgICAgICAgLy8gdGhpcyBkZXRlY3Rpb24gbWV0aG9kIGlzIG5vdCBwZXJmZWN0LCBidXQgaXQncyB1bmxpa2VseSB0aGUgdXNlclxuICAgICAgICAgIC8vIGVtaXR0ZWQgYSB2YWx1ZSB3aGljaCB3YXMgYW4gb2JqZWN0IHdpdGggdGhlc2UgMyBleGFjdCBrZXlzXG4gICAgICAgICAgdmFyIGV4cGVjdGVkS2V5cyA9IFsnaWQnLCAna2V5JywgJ3ZhbHVlJ107XG4gICAgICAgICAgaWYgKCEoa2V5cyA8IGV4cGVjdGVkS2V5cyB8fCBrZXlzID4gZXhwZWN0ZWRLZXlzKSkge1xuICAgICAgICAgICAgcmV0dXJuIHJlc3VsdC5kb2MudmFsdWU7XG4gICAgICAgICAgfVxuICAgICAgICB9XG5cbiAgICAgICAgdmFyIHBhcnNlZEtleUFuZERvY0lkID0gcG91Y2hDb2xsYXRlLnBhcnNlSW5kZXhhYmxlU3RyaW5nKHJlc3VsdC5kb2MuX2lkKTtcbiAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICBrZXk6IHBhcnNlZEtleUFuZERvY0lkWzBdLFxuICAgICAgICAgIGlkOiBwYXJzZWRLZXlBbmREb2NJZFsxXSxcbiAgICAgICAgICB2YWx1ZTogKCd2YWx1ZScgaW4gcmVzdWx0LmRvYyA/IHJlc3VsdC5kb2MudmFsdWUgOiBudWxsKVxuICAgICAgICB9O1xuICAgICAgfSk7XG4gICAgfSk7XG4gIH1cblxuICBmdW5jdGlvbiBvbk1hcFJlc3VsdHNSZWFkeShyZXN1bHRzKSB7XG4gICAgdmFyIHJlcztcbiAgICBpZiAoc2hvdWxkUmVkdWNlKSB7XG4gICAgICByZXMgPSByZWR1Y2VWaWV3KHZpZXcsIHJlc3VsdHMsIG9wdHMpO1xuICAgIH0gZWxzZSB7XG4gICAgICByZXMgPSB7XG4gICAgICAgIHRvdGFsX3Jvd3M6IHRvdGFsUm93cyxcbiAgICAgICAgb2Zmc2V0OiBza2lwLFxuICAgICAgICByb3dzOiByZXN1bHRzXG4gICAgICB9O1xuICAgIH1cbiAgICBpZiAob3B0cy5pbmNsdWRlX2RvY3MpIHtcbiAgICAgIHZhciBnZXREb2NzUHJvbWlzZXMgPSByZXN1bHRzLm1hcChmdW5jdGlvbiAocm93KSB7XG4gICAgICAgIHZhciB2YWwgPSByb3cudmFsdWU7XG4gICAgICAgIHZhciBkb2NJZCA9ICh2YWwgJiYgdHlwZW9mIHZhbCA9PT0gJ29iamVjdCcgJiYgdmFsLl9pZCkgfHwgcm93LmlkO1xuICAgICAgICByZXR1cm4gdmlldy5zb3VyY2VEQi5nZXQoZG9jSWQpLnRoZW4oZnVuY3Rpb24gKGpvaW5lZERvYykge1xuICAgICAgICAgIHJvdy5kb2MgPSBqb2luZWREb2M7XG4gICAgICAgIH0sIGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAvLyBkb2N1bWVudCBlcnJvciA9IGRvbid0IGpvaW5cbiAgICAgICAgfSk7XG4gICAgICB9KTtcbiAgICAgIHJldHVybiBQcm9taXNlLmFsbChnZXREb2NzUHJvbWlzZXMpLnRoZW4oZnVuY3Rpb24gKCkge1xuICAgICAgICByZXR1cm4gcmVzO1xuICAgICAgfSk7XG4gICAgfSBlbHNlIHtcbiAgICAgIHJldHVybiByZXM7XG4gICAgfVxuICB9XG5cbiAgdmFyIGZsYXR0ZW4gPSBmdW5jdGlvbiAoYXJyYXkpIHtcbiAgICByZXR1cm4gYXJyYXkucmVkdWNlKGZ1bmN0aW9uIChwcmV2LCBjdXIpIHtcbiAgICAgIHJldHVybiBwcmV2LmNvbmNhdChjdXIpO1xuICAgIH0pO1xuICB9O1xuXG4gIGlmICh0eXBlb2Ygb3B0cy5rZXlzICE9PSAndW5kZWZpbmVkJykge1xuICAgIHZhciBrZXlzID0gb3B0cy5rZXlzO1xuICAgIHZhciBmZXRjaFByb21pc2VzID0ga2V5cy5tYXAoZnVuY3Rpb24gKGtleSkge1xuICAgICAgdmFyIHZpZXdPcHRzID0ge1xuICAgICAgICBzdGFydGtleSA6IHRvSW5kZXhhYmxlU3RyaW5nKFtrZXldKSxcbiAgICAgICAgZW5ka2V5ICAgOiB0b0luZGV4YWJsZVN0cmluZyhba2V5LCB7fV0pXG4gICAgICB9O1xuICAgICAgcmV0dXJuIGZldGNoRnJvbVZpZXcodmlld09wdHMpO1xuICAgIH0pO1xuICAgIHJldHVybiBQcm9taXNlLmFsbChmZXRjaFByb21pc2VzKS50aGVuKGZsYXR0ZW4pLnRoZW4ob25NYXBSZXN1bHRzUmVhZHkpO1xuICB9IGVsc2UgeyAvLyBub3JtYWwgcXVlcnksIG5vICdrZXlzJ1xuICAgIHZhciB2aWV3T3B0cyA9IHtcbiAgICAgIGRlc2NlbmRpbmcgOiBvcHRzLmRlc2NlbmRpbmdcbiAgICB9O1xuICAgIGlmICh0eXBlb2Ygb3B0cy5zdGFydGtleSAhPT0gJ3VuZGVmaW5lZCcpIHtcbiAgICAgIHZpZXdPcHRzLnN0YXJ0a2V5ID0gb3B0cy5kZXNjZW5kaW5nID9cbiAgICAgICAgdG9JbmRleGFibGVTdHJpbmcoW29wdHMuc3RhcnRrZXksIHt9XSkgOlxuICAgICAgICB0b0luZGV4YWJsZVN0cmluZyhbb3B0cy5zdGFydGtleV0pO1xuICAgIH1cbiAgICBpZiAodHlwZW9mIG9wdHMuZW5ka2V5ICE9PSAndW5kZWZpbmVkJykge1xuICAgICAgdmFyIGluY2x1c2l2ZUVuZCA9IG9wdHMuaW5jbHVzaXZlX2VuZCAhPT0gZmFsc2U7XG4gICAgICBpZiAob3B0cy5kZXNjZW5kaW5nKSB7XG4gICAgICAgIGluY2x1c2l2ZUVuZCA9ICFpbmNsdXNpdmVFbmQ7XG4gICAgICB9XG5cbiAgICAgIHZpZXdPcHRzLmVuZGtleSA9IHRvSW5kZXhhYmxlU3RyaW5nKGluY2x1c2l2ZUVuZCA/IFtvcHRzLmVuZGtleSwge31dIDogW29wdHMuZW5ka2V5XSk7XG4gICAgfVxuICAgIGlmICh0eXBlb2Ygb3B0cy5rZXkgIT09ICd1bmRlZmluZWQnKSB7XG4gICAgICB2YXIga2V5U3RhcnQgPSB0b0luZGV4YWJsZVN0cmluZyhbb3B0cy5rZXldKTtcbiAgICAgIHZhciBrZXlFbmQgPSB0b0luZGV4YWJsZVN0cmluZyhbb3B0cy5rZXksIHt9XSk7XG4gICAgICBpZiAodmlld09wdHMuZGVzY2VuZGluZykge1xuICAgICAgICB2aWV3T3B0cy5lbmRrZXkgPSBrZXlTdGFydDtcbiAgICAgICAgdmlld09wdHMuc3RhcnRrZXkgPSBrZXlFbmQ7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICB2aWV3T3B0cy5zdGFydGtleSA9IGtleVN0YXJ0O1xuICAgICAgICB2aWV3T3B0cy5lbmRrZXkgPSBrZXlFbmQ7XG4gICAgICB9XG4gICAgfVxuICAgIGlmICghc2hvdWxkUmVkdWNlKSB7XG4gICAgICBpZiAodHlwZW9mIG9wdHMubGltaXQgPT09ICdudW1iZXInKSB7XG4gICAgICAgIHZpZXdPcHRzLmxpbWl0ID0gb3B0cy5saW1pdDtcbiAgICAgIH1cbiAgICAgIHZpZXdPcHRzLnNraXAgPSBza2lwO1xuICAgIH1cbiAgICByZXR1cm4gZmV0Y2hGcm9tVmlldyh2aWV3T3B0cykudGhlbihvbk1hcFJlc3VsdHNSZWFkeSk7XG4gIH1cbn0pO1xuXG5mdW5jdGlvbiBodHRwVmlld0NsZWFudXAoZGIpIHtcbiAgcmV0dXJuIGRiLnJlcXVlc3Qoe1xuICAgIG1ldGhvZDogJ1BPU1QnLFxuICAgIHVybDogJ192aWV3X2NsZWFudXAnXG4gIH0pO1xufVxuXG52YXIgbG9jYWxWaWV3Q2xlYW51cCA9IHV0aWxzLnNlcXVlbnRpYWxpemUobWFpblF1ZXVlLCBmdW5jdGlvbiAoZGIpIHtcbiAgcmV0dXJuIGRiLmdldCgnX2xvY2FsL21ydmlld3MnKS50aGVuKGZ1bmN0aW9uIChtZXRhRG9jKSB7XG4gICAgdmFyIGRvY3NUb1ZpZXdzID0ge307XG4gICAgT2JqZWN0LmtleXMobWV0YURvYy52aWV3cykuZm9yRWFjaChmdW5jdGlvbiAoZnVsbFZpZXdOYW1lKSB7XG4gICAgICB2YXIgcGFydHMgPSBwYXJzZVZpZXdOYW1lKGZ1bGxWaWV3TmFtZSk7XG4gICAgICB2YXIgZGVzaWduRG9jTmFtZSA9ICdfZGVzaWduLycgKyBwYXJ0c1swXTtcbiAgICAgIHZhciB2aWV3TmFtZSA9IHBhcnRzWzFdO1xuICAgICAgZG9jc1RvVmlld3NbZGVzaWduRG9jTmFtZV0gPSBkb2NzVG9WaWV3c1tkZXNpZ25Eb2NOYW1lXSB8fCB7fTtcbiAgICAgIGRvY3NUb1ZpZXdzW2Rlc2lnbkRvY05hbWVdW3ZpZXdOYW1lXSA9IHRydWU7XG4gICAgfSk7XG4gICAgdmFyIG9wdHMgPSB7XG4gICAgICBrZXlzIDogT2JqZWN0LmtleXMoZG9jc1RvVmlld3MpLFxuICAgICAgaW5jbHVkZV9kb2NzIDogdHJ1ZVxuICAgIH07XG4gICAgcmV0dXJuIGRiLmFsbERvY3Mob3B0cykudGhlbihmdW5jdGlvbiAocmVzKSB7XG4gICAgICB2YXIgdmlld3NUb1N0YXR1cyA9IHt9O1xuICAgICAgcmVzLnJvd3MuZm9yRWFjaChmdW5jdGlvbiAocm93KSB7XG4gICAgICAgIHZhciBkZG9jTmFtZSA9IHJvdy5rZXkuc3Vic3RyaW5nKDgpO1xuICAgICAgICBPYmplY3Qua2V5cyhkb2NzVG9WaWV3c1tyb3cua2V5XSkuZm9yRWFjaChmdW5jdGlvbiAodmlld05hbWUpIHtcbiAgICAgICAgICB2YXIgZnVsbFZpZXdOYW1lID0gZGRvY05hbWUgKyAnLycgKyB2aWV3TmFtZTtcbiAgICAgICAgICAvKiBpc3RhbmJ1bCBpZ25vcmUgaWYgKi9cbiAgICAgICAgICBpZiAoIW1ldGFEb2Mudmlld3NbZnVsbFZpZXdOYW1lXSkge1xuICAgICAgICAgICAgLy8gbmV3IGZvcm1hdCwgd2l0aG91dCBzbGFzaGVzLCB0byBzdXBwb3J0IFBvdWNoREIgMi4yLjBcbiAgICAgICAgICAgIC8vIG1pZ3JhdGlvbiB0ZXN0IGluIHBvdWNoZGIncyBicm93c2VyLm1pZ3JhdGlvbi5qcyB2ZXJpZmllcyB0aGlzXG4gICAgICAgICAgICBmdWxsVmlld05hbWUgPSB2aWV3TmFtZTtcbiAgICAgICAgICB9XG4gICAgICAgICAgdmFyIHZpZXdEQk5hbWVzID0gT2JqZWN0LmtleXMobWV0YURvYy52aWV3c1tmdWxsVmlld05hbWVdKTtcbiAgICAgICAgICAvLyBkZXNpZ24gZG9jIGRlbGV0ZWQsIG9yIHZpZXcgZnVuY3Rpb24gbm9uZXhpc3RlbnRcbiAgICAgICAgICB2YXIgc3RhdHVzSXNHb29kID0gcm93LmRvYyAmJiByb3cuZG9jLnZpZXdzICYmIHJvdy5kb2Mudmlld3Nbdmlld05hbWVdO1xuICAgICAgICAgIHZpZXdEQk5hbWVzLmZvckVhY2goZnVuY3Rpb24gKHZpZXdEQk5hbWUpIHtcbiAgICAgICAgICAgIHZpZXdzVG9TdGF0dXNbdmlld0RCTmFtZV0gPSB2aWV3c1RvU3RhdHVzW3ZpZXdEQk5hbWVdIHx8IHN0YXR1c0lzR29vZDtcbiAgICAgICAgICB9KTtcbiAgICAgICAgfSk7XG4gICAgICB9KTtcbiAgICAgIHZhciBkYnNUb0RlbGV0ZSA9IE9iamVjdC5rZXlzKHZpZXdzVG9TdGF0dXMpLmZpbHRlcihmdW5jdGlvbiAodmlld0RCTmFtZSkge1xuICAgICAgICByZXR1cm4gIXZpZXdzVG9TdGF0dXNbdmlld0RCTmFtZV07XG4gICAgICB9KTtcbiAgICAgIHZhciBkZXN0cm95UHJvbWlzZXMgPSBkYnNUb0RlbGV0ZS5tYXAoZnVuY3Rpb24gKHZpZXdEQk5hbWUpIHtcbiAgICAgICAgcmV0dXJuIGRiLmNvbnN0cnVjdG9yLmRlc3Ryb3kodmlld0RCTmFtZSwge2FkYXB0ZXIgOiBkYi5hZGFwdGVyfSk7XG4gICAgICB9KTtcbiAgICAgIHJldHVybiBQcm9taXNlLmFsbChkZXN0cm95UHJvbWlzZXMpLnRoZW4oZnVuY3Rpb24gKCkge1xuICAgICAgICByZXR1cm4ge29rOiB0cnVlfTtcbiAgICAgIH0pO1xuICAgIH0pO1xuICB9LCBkZWZhdWx0c1RvKHtvazogdHJ1ZX0pKTtcbn0pO1xuXG5leHBvcnRzLnZpZXdDbGVhbnVwID0gdXRpbHMuY2FsbGJhY2tpZnkoZnVuY3Rpb24gKCkge1xuICB2YXIgZGIgPSB0aGlzO1xuICBpZiAoZGIudHlwZSgpID09PSAnaHR0cCcpIHtcbiAgICByZXR1cm4gaHR0cFZpZXdDbGVhbnVwKGRiKTtcbiAgfVxuICByZXR1cm4gbG9jYWxWaWV3Q2xlYW51cChkYik7XG59KTtcblxuZnVuY3Rpb24gcXVlcnlQcm9taXNlZChkYiwgZnVuLCBvcHRzKSB7XG4gIGlmIChkYi50eXBlKCkgPT09ICdodHRwJykge1xuICAgIHJldHVybiBodHRwUXVlcnkoZGIsIGZ1biwgb3B0cyk7XG4gIH1cblxuICBpZiAodHlwZW9mIGZ1biAhPT0gJ3N0cmluZycpIHtcbiAgICAvLyB0ZW1wX3ZpZXdcbiAgICBjaGVja1F1ZXJ5UGFyc2VFcnJvcihvcHRzLCBmdW4pO1xuXG4gICAgdmFyIGNyZWF0ZVZpZXdPcHRzID0ge1xuICAgICAgZGIgOiBkYixcbiAgICAgIHZpZXdOYW1lIDogJ3RlbXBfdmlldy90ZW1wX3ZpZXcnLFxuICAgICAgbWFwIDogZnVuLm1hcCxcbiAgICAgIHJlZHVjZSA6IGZ1bi5yZWR1Y2UsXG4gICAgICB0ZW1wb3JhcnkgOiB0cnVlXG4gICAgfTtcbiAgICB0ZW1wVmlld1F1ZXVlLmFkZChmdW5jdGlvbiAoKSB7XG4gICAgICByZXR1cm4gY3JlYXRlVmlldyhjcmVhdGVWaWV3T3B0cykudGhlbihmdW5jdGlvbiAodmlldykge1xuICAgICAgICBmdW5jdGlvbiBjbGVhbnVwKCkge1xuICAgICAgICAgIHJldHVybiB2aWV3LmRiLmRlc3Ryb3koKTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gdXRpbHMuZmluKHVwZGF0ZVZpZXcodmlldykudGhlbihmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgcmV0dXJuIHF1ZXJ5Vmlldyh2aWV3LCBvcHRzKTtcbiAgICAgICAgfSksIGNsZWFudXApO1xuICAgICAgfSk7XG4gICAgfSk7XG4gICAgcmV0dXJuIHRlbXBWaWV3UXVldWUuZmluaXNoKCk7XG4gIH0gZWxzZSB7XG4gICAgLy8gcGVyc2lzdGVudCB2aWV3XG4gICAgdmFyIGZ1bGxWaWV3TmFtZSA9IGZ1bjtcbiAgICB2YXIgcGFydHMgPSBwYXJzZVZpZXdOYW1lKGZ1bGxWaWV3TmFtZSk7XG4gICAgdmFyIGRlc2lnbkRvY05hbWUgPSBwYXJ0c1swXTtcbiAgICB2YXIgdmlld05hbWUgPSBwYXJ0c1sxXTtcbiAgICByZXR1cm4gZGIuZ2V0KCdfZGVzaWduLycgKyBkZXNpZ25Eb2NOYW1lKS50aGVuKGZ1bmN0aW9uIChkb2MpIHtcbiAgICAgIHZhciBmdW4gPSBkb2Mudmlld3MgJiYgZG9jLnZpZXdzW3ZpZXdOYW1lXTtcblxuICAgICAgaWYgKCFmdW4gfHwgdHlwZW9mIGZ1bi5tYXAgIT09ICdzdHJpbmcnKSB7XG4gICAgICAgIHRocm93IG5ldyBOb3RGb3VuZEVycm9yKCdkZG9jICcgKyBkZXNpZ25Eb2NOYW1lICsgJyBoYXMgbm8gdmlldyBuYW1lZCAnICtcbiAgICAgICAgICB2aWV3TmFtZSk7XG4gICAgICB9XG4gICAgICBjaGVja1F1ZXJ5UGFyc2VFcnJvcihvcHRzLCBmdW4pO1xuXG4gICAgICB2YXIgY3JlYXRlVmlld09wdHMgPSB7XG4gICAgICAgIGRiIDogZGIsXG4gICAgICAgIHZpZXdOYW1lIDogZnVsbFZpZXdOYW1lLFxuICAgICAgICBtYXAgOiBmdW4ubWFwLFxuICAgICAgICByZWR1Y2UgOiBmdW4ucmVkdWNlXG4gICAgICB9O1xuICAgICAgcmV0dXJuIGNyZWF0ZVZpZXcoY3JlYXRlVmlld09wdHMpLnRoZW4oZnVuY3Rpb24gKHZpZXcpIHtcbiAgICAgICAgaWYgKG9wdHMuc3RhbGUgPT09ICdvaycgfHwgb3B0cy5zdGFsZSA9PT0gJ3VwZGF0ZV9hZnRlcicpIHtcbiAgICAgICAgICBpZiAob3B0cy5zdGFsZSA9PT0gJ3VwZGF0ZV9hZnRlcicpIHtcbiAgICAgICAgICAgIHByb2Nlc3MubmV4dFRpY2soZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICB1cGRhdGVWaWV3KHZpZXcpO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgfVxuICAgICAgICAgIHJldHVybiBxdWVyeVZpZXcodmlldywgb3B0cyk7XG4gICAgICAgIH0gZWxzZSB7IC8vIHN0YWxlIG5vdCBva1xuICAgICAgICAgIHJldHVybiB1cGRhdGVWaWV3KHZpZXcpLnRoZW4oZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgcmV0dXJuIHF1ZXJ5Vmlldyh2aWV3LCBvcHRzKTtcbiAgICAgICAgICB9KTtcbiAgICAgICAgfVxuICAgICAgfSk7XG4gICAgfSk7XG4gIH1cbn1cblxuZXhwb3J0cy5xdWVyeSA9IGZ1bmN0aW9uIChmdW4sIG9wdHMsIGNhbGxiYWNrKSB7XG4gIGlmICh0eXBlb2Ygb3B0cyA9PT0gJ2Z1bmN0aW9uJykge1xuICAgIGNhbGxiYWNrID0gb3B0cztcbiAgICBvcHRzID0ge307XG4gIH1cbiAgb3B0cyA9IHV0aWxzLmV4dGVuZCh0cnVlLCB7fSwgb3B0cyk7XG5cbiAgaWYgKHR5cGVvZiBmdW4gPT09ICdmdW5jdGlvbicpIHtcbiAgICBmdW4gPSB7bWFwIDogZnVufTtcbiAgfVxuXG4gIHZhciBkYiA9IHRoaXM7XG4gIHZhciBwcm9taXNlID0gUHJvbWlzZS5yZXNvbHZlKCkudGhlbihmdW5jdGlvbiAoKSB7XG4gICAgcmV0dXJuIHF1ZXJ5UHJvbWlzZWQoZGIsIGZ1biwgb3B0cyk7XG4gIH0pO1xuICB1dGlscy5wcm9taXNlZENhbGxiYWNrKHByb21pc2UsIGNhbGxiYWNrKTtcbiAgcmV0dXJuIHByb21pc2U7XG59O1xuXG5mdW5jdGlvbiBRdWVyeVBhcnNlRXJyb3IobWVzc2FnZSkge1xuICB0aGlzLnN0YXR1cyA9IDQwMDtcbiAgdGhpcy5uYW1lID0gJ3F1ZXJ5X3BhcnNlX2Vycm9yJztcbiAgdGhpcy5tZXNzYWdlID0gbWVzc2FnZTtcbiAgdGhpcy5lcnJvciA9IHRydWU7XG4gIHRyeSB7XG4gICAgRXJyb3IuY2FwdHVyZVN0YWNrVHJhY2UodGhpcywgUXVlcnlQYXJzZUVycm9yKTtcbiAgfSBjYXRjaCAoZSkge31cbn1cblxudXRpbHMuaW5oZXJpdHMoUXVlcnlQYXJzZUVycm9yLCBFcnJvcik7XG5cbmZ1bmN0aW9uIE5vdEZvdW5kRXJyb3IobWVzc2FnZSkge1xuICB0aGlzLnN0YXR1cyA9IDQwNDtcbiAgdGhpcy5uYW1lID0gJ25vdF9mb3VuZCc7XG4gIHRoaXMubWVzc2FnZSA9IG1lc3NhZ2U7XG4gIHRoaXMuZXJyb3IgPSB0cnVlO1xuICB0cnkge1xuICAgIEVycm9yLmNhcHR1cmVTdGFja1RyYWNlKHRoaXMsIE5vdEZvdW5kRXJyb3IpO1xuICB9IGNhdGNoIChlKSB7fVxufVxuXG51dGlscy5pbmhlcml0cyhOb3RGb3VuZEVycm9yLCBFcnJvcik7XG5cbn0pLmNhbGwodGhpcyxfZGVyZXFfKFwiL1VzZXJzL25vbGFuL3dvcmtzcGFjZS9wb3VjaGRiL25vZGVfbW9kdWxlcy9icm93c2VyaWZ5L25vZGVfbW9kdWxlcy9pbnNlcnQtbW9kdWxlLWdsb2JhbHMvbm9kZV9tb2R1bGVzL3Byb2Nlc3MvYnJvd3Nlci5qc1wiKSlcbn0se1wiLi9jcmVhdGUtdmlld1wiOjQ5LFwiLi9ldmFsZnVuY1wiOjUwLFwiLi90YXNrcXVldWVcIjo1NCxcIi4vdXRpbHNcIjo1NixcIi9Vc2Vycy9ub2xhbi93b3Jrc3BhY2UvcG91Y2hkYi9ub2RlX21vZHVsZXMvYnJvd3NlcmlmeS9ub2RlX21vZHVsZXMvaW5zZXJ0LW1vZHVsZS1nbG9iYWxzL25vZGVfbW9kdWxlcy9wcm9jZXNzL2Jyb3dzZXIuanNcIjoyOCxcInBvdWNoZGItY29sbGF0ZVwiOjUyfV0sNTI6W2Z1bmN0aW9uKF9kZXJlcV8sbW9kdWxlLGV4cG9ydHMpe1xuJ3VzZSBzdHJpY3QnO1xuXG52YXIgTUlOX01BR05JVFVERSA9IC0zMjQ7IC8vIHZlcmlmaWVkIGJ5IC1OdW1iZXIuTUlOX1ZBTFVFXG52YXIgTUFHTklUVURFX0RJR0lUUyA9IDM7IC8vIGRpdHRvXG52YXIgU0VQID0gJyc7IC8vIHNldCB0byAnXycgZm9yIGVhc2llciBkZWJ1Z2dpbmcgXG5cbnZhciB1dGlscyA9IF9kZXJlcV8oJy4vdXRpbHMnKTtcblxuZXhwb3J0cy5jb2xsYXRlID0gZnVuY3Rpb24gKGEsIGIpIHtcblxuICBpZiAoYSA9PT0gYikge1xuICAgIHJldHVybiAwO1xuICB9XG5cbiAgYSA9IGV4cG9ydHMubm9ybWFsaXplS2V5KGEpO1xuICBiID0gZXhwb3J0cy5ub3JtYWxpemVLZXkoYik7XG5cbiAgdmFyIGFpID0gY29sbGF0aW9uSW5kZXgoYSk7XG4gIHZhciBiaSA9IGNvbGxhdGlvbkluZGV4KGIpO1xuICBpZiAoKGFpIC0gYmkpICE9PSAwKSB7XG4gICAgcmV0dXJuIGFpIC0gYmk7XG4gIH1cbiAgaWYgKGEgPT09IG51bGwpIHtcbiAgICByZXR1cm4gMDtcbiAgfVxuICBzd2l0Y2ggKHR5cGVvZiBhKSB7XG4gICAgY2FzZSAnbnVtYmVyJzpcbiAgICAgIHJldHVybiBhIC0gYjtcbiAgICBjYXNlICdib29sZWFuJzpcbiAgICAgIHJldHVybiBhID09PSBiID8gMCA6IChhIDwgYiA/IC0xIDogMSk7XG4gICAgY2FzZSAnc3RyaW5nJzpcbiAgICAgIHJldHVybiBzdHJpbmdDb2xsYXRlKGEsIGIpO1xuICB9XG4gIHJldHVybiBBcnJheS5pc0FycmF5KGEpID8gYXJyYXlDb2xsYXRlKGEsIGIpIDogb2JqZWN0Q29sbGF0ZShhLCBiKTtcbn07XG5cbi8vIGNvdWNoIGNvbnNpZGVycyBudWxsL05hTi9JbmZpbml0eS8tSW5maW5pdHkgPT09IHVuZGVmaW5lZCxcbi8vIGZvciB0aGUgcHVycG9zZXMgb2YgbWFwcmVkdWNlIGluZGV4ZXMuIGFsc28sIGRhdGVzIGdldCBzdHJpbmdpZmllZC5cbmV4cG9ydHMubm9ybWFsaXplS2V5ID0gZnVuY3Rpb24gKGtleSkge1xuICBzd2l0Y2ggKHR5cGVvZiBrZXkpIHtcbiAgICBjYXNlICd1bmRlZmluZWQnOlxuICAgICAgcmV0dXJuIG51bGw7XG4gICAgY2FzZSAnbnVtYmVyJzpcbiAgICAgIGlmIChrZXkgPT09IEluZmluaXR5IHx8IGtleSA9PT0gLUluZmluaXR5IHx8IGlzTmFOKGtleSkpIHtcbiAgICAgICAgcmV0dXJuIG51bGw7XG4gICAgICB9XG4gICAgICByZXR1cm4ga2V5O1xuICAgIGNhc2UgJ29iamVjdCc6XG4gICAgICB2YXIgb3JpZ0tleSA9IGtleTtcbiAgICAgIGlmIChBcnJheS5pc0FycmF5KGtleSkpIHtcbiAgICAgICAgdmFyIGxlbiA9IGtleS5sZW5ndGg7XG4gICAgICAgIGtleSA9IG5ldyBBcnJheShsZW4pO1xuICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IGxlbjsgaSsrKSB7XG4gICAgICAgICAga2V5W2ldID0gZXhwb3J0cy5ub3JtYWxpemVLZXkob3JpZ0tleVtpXSk7XG4gICAgICAgIH1cbiAgICAgIH0gZWxzZSBpZiAoa2V5IGluc3RhbmNlb2YgRGF0ZSkge1xuICAgICAgICByZXR1cm4ga2V5LnRvSlNPTigpO1xuICAgICAgfSBlbHNlIGlmIChrZXkgIT09IG51bGwpIHsgLy8gZ2VuZXJpYyBvYmplY3RcbiAgICAgICAga2V5ID0ge307XG4gICAgICAgIGZvciAodmFyIGsgaW4gb3JpZ0tleSkge1xuICAgICAgICAgIGlmIChvcmlnS2V5Lmhhc093blByb3BlcnR5KGspKSB7XG4gICAgICAgICAgICB2YXIgdmFsID0gb3JpZ0tleVtrXTtcbiAgICAgICAgICAgIGlmICh0eXBlb2YgdmFsICE9PSAndW5kZWZpbmVkJykge1xuICAgICAgICAgICAgICBrZXlba10gPSBleHBvcnRzLm5vcm1hbGl6ZUtleSh2YWwpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgfVxuICB9XG4gIHJldHVybiBrZXk7XG59O1xuXG5mdW5jdGlvbiBpbmRleGlmeShrZXkpIHtcbiAgaWYgKGtleSAhPT0gbnVsbCkge1xuICAgIHN3aXRjaCAodHlwZW9mIGtleSkge1xuICAgICAgY2FzZSAnYm9vbGVhbic6XG4gICAgICAgIHJldHVybiBrZXkgPyAxIDogMDtcbiAgICAgIGNhc2UgJ251bWJlcic6XG4gICAgICAgIHJldHVybiBudW1Ub0luZGV4YWJsZVN0cmluZyhrZXkpO1xuICAgICAgY2FzZSAnc3RyaW5nJzpcbiAgICAgICAgLy8gV2UndmUgdG8gYmUgc3VyZSB0aGF0IGtleSBkb2VzIG5vdCBjb250YWluIFxcdTAwMDBcbiAgICAgICAgLy8gRG8gb3JkZXItcHJlc2VydmluZyByZXBsYWNlbWVudHM6XG4gICAgICAgIC8vIDAgLT4gMSwgMVxuICAgICAgICAvLyAxIC0+IDEsIDJcbiAgICAgICAgLy8gMiAtPiAyLCAyXG4gICAgICAgIHJldHVybiBrZXlcbiAgICAgICAgICAucmVwbGFjZSgvXFx1MDAwMi9nLCAnXFx1MDAwMlxcdTAwMDInKVxuICAgICAgICAgIC5yZXBsYWNlKC9cXHUwMDAxL2csICdcXHUwMDAxXFx1MDAwMicpXG4gICAgICAgICAgLnJlcGxhY2UoL1xcdTAwMDAvZywgJ1xcdTAwMDFcXHUwMDAxJyk7XG4gICAgICBjYXNlICdvYmplY3QnOlxuICAgICAgICB2YXIgaXNBcnJheSA9IEFycmF5LmlzQXJyYXkoa2V5KTtcbiAgICAgICAgdmFyIGFyciA9IGlzQXJyYXkgPyBrZXkgOiBPYmplY3Qua2V5cyhrZXkpO1xuICAgICAgICB2YXIgaSA9IC0xO1xuICAgICAgICB2YXIgbGVuID0gYXJyLmxlbmd0aDtcbiAgICAgICAgdmFyIHJlc3VsdCA9ICcnO1xuICAgICAgICBpZiAoaXNBcnJheSkge1xuICAgICAgICAgIHdoaWxlICgrK2kgPCBsZW4pIHtcbiAgICAgICAgICAgIHJlc3VsdCArPSBleHBvcnRzLnRvSW5kZXhhYmxlU3RyaW5nKGFycltpXSk7XG4gICAgICAgICAgfVxuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgIHdoaWxlICgrK2kgPCBsZW4pIHtcbiAgICAgICAgICAgIHZhciBvYmpLZXkgPSBhcnJbaV07XG4gICAgICAgICAgICByZXN1bHQgKz0gZXhwb3J0cy50b0luZGV4YWJsZVN0cmluZyhvYmpLZXkpICtcbiAgICAgICAgICAgICAgICBleHBvcnRzLnRvSW5kZXhhYmxlU3RyaW5nKGtleVtvYmpLZXldKTtcbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHJlc3VsdDtcbiAgICB9XG4gIH1cbiAgcmV0dXJuICcnO1xufVxuXG4vLyBjb252ZXJ0IHRoZSBnaXZlbiBrZXkgdG8gYSBzdHJpbmcgdGhhdCB3b3VsZCBiZSBhcHByb3ByaWF0ZVxuLy8gZm9yIGxleGljYWwgc29ydGluZywgZS5nLiB3aXRoaW4gYSBkYXRhYmFzZSwgd2hlcmUgdGhlXG4vLyBzb3J0aW5nIGlzIHRoZSBzYW1lIGdpdmVuIGJ5IHRoZSBjb2xsYXRlKCkgZnVuY3Rpb24uXG5leHBvcnRzLnRvSW5kZXhhYmxlU3RyaW5nID0gZnVuY3Rpb24gKGtleSkge1xuICB2YXIgemVybyA9ICdcXHUwMDAwJztcbiAga2V5ID0gZXhwb3J0cy5ub3JtYWxpemVLZXkoa2V5KTtcbiAgcmV0dXJuIGNvbGxhdGlvbkluZGV4KGtleSkgKyBTRVAgKyBpbmRleGlmeShrZXkpICsgemVybztcbn07XG5cbmZ1bmN0aW9uIHBhcnNlTnVtYmVyKHN0ciwgaSkge1xuICB2YXIgb3JpZ2luYWxJZHggPSBpO1xuICB2YXIgbnVtO1xuICB2YXIgemVybyA9IHN0cltpXSA9PT0gJzEnO1xuICBpZiAoemVybykge1xuICAgIG51bSA9IDA7XG4gICAgaSsrO1xuICB9IGVsc2Uge1xuICAgIHZhciBuZWcgPSBzdHJbaV0gPT09ICcwJztcbiAgICBpKys7XG4gICAgdmFyIG51bUFzU3RyaW5nID0gJyc7XG4gICAgdmFyIG1hZ0FzU3RyaW5nID0gc3RyLnN1YnN0cmluZyhpLCBpICsgTUFHTklUVURFX0RJR0lUUyk7XG4gICAgdmFyIG1hZ25pdHVkZSA9IHBhcnNlSW50KG1hZ0FzU3RyaW5nLCAxMCkgKyBNSU5fTUFHTklUVURFO1xuICAgIGlmIChuZWcpIHtcbiAgICAgIG1hZ25pdHVkZSA9IC1tYWduaXR1ZGU7XG4gICAgfVxuICAgIGkgKz0gTUFHTklUVURFX0RJR0lUUztcbiAgICB3aGlsZSAodHJ1ZSkge1xuICAgICAgdmFyIGNoID0gc3RyW2ldO1xuICAgICAgaWYgKGNoID09PSAnXFx1MDAwMCcpIHtcbiAgICAgICAgYnJlYWs7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICBudW1Bc1N0cmluZyArPSBjaDtcbiAgICAgIH1cbiAgICAgIGkrKztcbiAgICB9XG4gICAgbnVtQXNTdHJpbmcgPSBudW1Bc1N0cmluZy5zcGxpdCgnLicpO1xuICAgIGlmIChudW1Bc1N0cmluZy5sZW5ndGggPT09IDEpIHtcbiAgICAgIG51bSA9IHBhcnNlSW50KG51bUFzU3RyaW5nLCAxMCk7XG4gICAgfSBlbHNlIHtcbiAgICAgIG51bSA9IHBhcnNlRmxvYXQobnVtQXNTdHJpbmdbMF0gKyAnLicgKyBudW1Bc1N0cmluZ1sxXSk7XG4gICAgfVxuICAgIGlmIChuZWcpIHtcbiAgICAgIG51bSA9IG51bSAtIDEwO1xuICAgIH1cbiAgICBpZiAobWFnbml0dWRlICE9PSAwKSB7XG4gICAgICAvLyBwYXJzZUZsb2F0IGlzIG1vcmUgcmVsaWFibGUgdGhhbiBwb3cgZHVlIHRvIHJvdW5kaW5nIGVycm9yc1xuICAgICAgLy8gZS5nLiBOdW1iZXIuTUFYX1ZBTFVFIHdvdWxkIHJldHVybiBJbmZpbml0eSBpZiB3ZSBkaWRcbiAgICAgIC8vIG51bSAqIE1hdGgucG93KDEwLCBtYWduaXR1ZGUpO1xuICAgICAgbnVtID0gcGFyc2VGbG9hdChudW0gKyAnZScgKyBtYWduaXR1ZGUpO1xuICAgIH1cbiAgfVxuICByZXR1cm4ge251bTogbnVtLCBsZW5ndGggOiBpIC0gb3JpZ2luYWxJZHh9O1xufVxuXG4vLyBtb3ZlIHVwIHRoZSBzdGFjayB3aGlsZSBwYXJzaW5nXG4vLyB0aGlzIGZ1bmN0aW9uIG1vdmVkIG91dHNpZGUgb2YgcGFyc2VJbmRleGFibGVTdHJpbmcgZm9yIHBlcmZvcm1hbmNlXG5mdW5jdGlvbiBwb3Aoc3RhY2ssIG1ldGFTdGFjaykge1xuICB2YXIgb2JqID0gc3RhY2sucG9wKCk7XG5cbiAgaWYgKG1ldGFTdGFjay5sZW5ndGgpIHtcbiAgICB2YXIgbGFzdE1ldGFFbGVtZW50ID0gbWV0YVN0YWNrW21ldGFTdGFjay5sZW5ndGggLSAxXTtcbiAgICBpZiAob2JqID09PSBsYXN0TWV0YUVsZW1lbnQuZWxlbWVudCkge1xuICAgICAgLy8gcG9wcGluZyBhIG1ldGEtZWxlbWVudCwgZS5nLiBhbiBvYmplY3Qgd2hvc2UgdmFsdWUgaXMgYW5vdGhlciBvYmplY3RcbiAgICAgIG1ldGFTdGFjay5wb3AoKTtcbiAgICAgIGxhc3RNZXRhRWxlbWVudCA9IG1ldGFTdGFja1ttZXRhU3RhY2subGVuZ3RoIC0gMV07XG4gICAgfVxuICAgIHZhciBlbGVtZW50ID0gbGFzdE1ldGFFbGVtZW50LmVsZW1lbnQ7XG4gICAgdmFyIGxhc3RFbGVtZW50SW5kZXggPSBsYXN0TWV0YUVsZW1lbnQuaW5kZXg7XG4gICAgaWYgKEFycmF5LmlzQXJyYXkoZWxlbWVudCkpIHtcbiAgICAgIGVsZW1lbnQucHVzaChvYmopO1xuICAgIH0gZWxzZSBpZiAobGFzdEVsZW1lbnRJbmRleCA9PT0gc3RhY2subGVuZ3RoIC0gMikgeyAvLyBvYmogd2l0aCBrZXkrdmFsdWVcbiAgICAgIHZhciBrZXkgPSBzdGFjay5wb3AoKTtcbiAgICAgIGVsZW1lbnRba2V5XSA9IG9iajtcbiAgICB9IGVsc2Uge1xuICAgICAgc3RhY2sucHVzaChvYmopOyAvLyBvYmogd2l0aCBrZXkgb25seVxuICAgIH1cbiAgfVxufVxuXG5leHBvcnRzLnBhcnNlSW5kZXhhYmxlU3RyaW5nID0gZnVuY3Rpb24gKHN0cikge1xuICB2YXIgc3RhY2sgPSBbXTtcbiAgdmFyIG1ldGFTdGFjayA9IFtdOyAvLyBzdGFjayBmb3IgYXJyYXlzIGFuZCBvYmplY3RzXG4gIHZhciBpID0gMDtcblxuICB3aGlsZSAodHJ1ZSkge1xuICAgIHZhciBjb2xsYXRpb25JbmRleCA9IHN0cltpKytdO1xuICAgIGlmIChjb2xsYXRpb25JbmRleCA9PT0gJ1xcdTAwMDAnKSB7XG4gICAgICBpZiAoc3RhY2subGVuZ3RoID09PSAxKSB7XG4gICAgICAgIHJldHVybiBzdGFjay5wb3AoKTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIHBvcChzdGFjaywgbWV0YVN0YWNrKTtcbiAgICAgICAgY29udGludWU7XG4gICAgICB9XG4gICAgfVxuICAgIHN3aXRjaCAoY29sbGF0aW9uSW5kZXgpIHtcbiAgICAgIGNhc2UgJzEnOlxuICAgICAgICBzdGFjay5wdXNoKG51bGwpO1xuICAgICAgICBicmVhaztcbiAgICAgIGNhc2UgJzInOlxuICAgICAgICBzdGFjay5wdXNoKHN0cltpXSA9PT0gJzEnKTtcbiAgICAgICAgaSsrO1xuICAgICAgICBicmVhaztcbiAgICAgIGNhc2UgJzMnOlxuICAgICAgICB2YXIgcGFyc2VkTnVtID0gcGFyc2VOdW1iZXIoc3RyLCBpKTtcbiAgICAgICAgc3RhY2sucHVzaChwYXJzZWROdW0ubnVtKTtcbiAgICAgICAgaSArPSBwYXJzZWROdW0ubGVuZ3RoO1xuICAgICAgICBicmVhaztcbiAgICAgIGNhc2UgJzQnOlxuICAgICAgICB2YXIgcGFyc2VkU3RyID0gJyc7XG4gICAgICAgIHdoaWxlICh0cnVlKSB7XG4gICAgICAgICAgdmFyIGNoID0gc3RyW2ldO1xuICAgICAgICAgIGlmIChjaCA9PT0gJ1xcdTAwMDAnKSB7XG4gICAgICAgICAgICBicmVhaztcbiAgICAgICAgICB9XG4gICAgICAgICAgcGFyc2VkU3RyICs9IGNoO1xuICAgICAgICAgIGkrKztcbiAgICAgICAgfVxuICAgICAgICAvLyBwZXJmb3JtIHRoZSByZXZlcnNlIG9mIHRoZSBvcmRlci1wcmVzZXJ2aW5nIHJlcGxhY2VtZW50XG4gICAgICAgIC8vIGFsZ29yaXRobSAoc2VlIGFib3ZlKVxuICAgICAgICBwYXJzZWRTdHIgPSBwYXJzZWRTdHIucmVwbGFjZSgvXFx1MDAwMVxcdTAwMDEvZywgJ1xcdTAwMDAnKVxuICAgICAgICAgIC5yZXBsYWNlKC9cXHUwMDAxXFx1MDAwMi9nLCAnXFx1MDAwMScpXG4gICAgICAgICAgLnJlcGxhY2UoL1xcdTAwMDJcXHUwMDAyL2csICdcXHUwMDAyJyk7XG4gICAgICAgIHN0YWNrLnB1c2gocGFyc2VkU3RyKTtcbiAgICAgICAgYnJlYWs7XG4gICAgICBjYXNlICc1JzpcbiAgICAgICAgdmFyIGFycmF5RWxlbWVudCA9IHsgZWxlbWVudDogW10sIGluZGV4OiBzdGFjay5sZW5ndGggfTtcbiAgICAgICAgc3RhY2sucHVzaChhcnJheUVsZW1lbnQuZWxlbWVudCk7XG4gICAgICAgIG1ldGFTdGFjay5wdXNoKGFycmF5RWxlbWVudCk7XG4gICAgICAgIGJyZWFrO1xuICAgICAgY2FzZSAnNic6XG4gICAgICAgIHZhciBvYmpFbGVtZW50ID0geyBlbGVtZW50OiB7fSwgaW5kZXg6IHN0YWNrLmxlbmd0aCB9O1xuICAgICAgICBzdGFjay5wdXNoKG9iakVsZW1lbnQuZWxlbWVudCk7XG4gICAgICAgIG1ldGFTdGFjay5wdXNoKG9iakVsZW1lbnQpO1xuICAgICAgICBicmVhaztcbiAgICAgIGRlZmF1bHQ6XG4gICAgICAgIHRocm93IG5ldyBFcnJvcihcbiAgICAgICAgICAnYmFkIGNvbGxhdGlvbkluZGV4IG9yIHVuZXhwZWN0ZWRseSByZWFjaGVkIGVuZCBvZiBpbnB1dDogJyArIGNvbGxhdGlvbkluZGV4KTtcbiAgICB9XG4gIH1cbn07XG5cbmZ1bmN0aW9uIGFycmF5Q29sbGF0ZShhLCBiKSB7XG4gIHZhciBsZW4gPSBNYXRoLm1pbihhLmxlbmd0aCwgYi5sZW5ndGgpO1xuICBmb3IgKHZhciBpID0gMDsgaSA8IGxlbjsgaSsrKSB7XG4gICAgdmFyIHNvcnQgPSBleHBvcnRzLmNvbGxhdGUoYVtpXSwgYltpXSk7XG4gICAgaWYgKHNvcnQgIT09IDApIHtcbiAgICAgIHJldHVybiBzb3J0O1xuICAgIH1cbiAgfVxuICByZXR1cm4gKGEubGVuZ3RoID09PSBiLmxlbmd0aCkgPyAwIDpcbiAgICAoYS5sZW5ndGggPiBiLmxlbmd0aCkgPyAxIDogLTE7XG59XG5mdW5jdGlvbiBzdHJpbmdDb2xsYXRlKGEsIGIpIHtcbiAgLy8gU2VlOiBodHRwczovL2dpdGh1Yi5jb20vZGFsZWhhcnZleS9wb3VjaGRiL2lzc3Vlcy80MFxuICAvLyBUaGlzIGlzIGluY29tcGF0aWJsZSB3aXRoIHRoZSBDb3VjaERCIGltcGxlbWVudGF0aW9uLCBidXQgaXRzIHRoZVxuICAvLyBiZXN0IHdlIGNhbiBkbyBmb3Igbm93XG4gIHJldHVybiAoYSA9PT0gYikgPyAwIDogKChhID4gYikgPyAxIDogLTEpO1xufVxuZnVuY3Rpb24gb2JqZWN0Q29sbGF0ZShhLCBiKSB7XG4gIHZhciBhayA9IE9iamVjdC5rZXlzKGEpLCBiayA9IE9iamVjdC5rZXlzKGIpO1xuICB2YXIgbGVuID0gTWF0aC5taW4oYWsubGVuZ3RoLCBiay5sZW5ndGgpO1xuICBmb3IgKHZhciBpID0gMDsgaSA8IGxlbjsgaSsrKSB7XG4gICAgLy8gRmlyc3Qgc29ydCB0aGUga2V5c1xuICAgIHZhciBzb3J0ID0gZXhwb3J0cy5jb2xsYXRlKGFrW2ldLCBia1tpXSk7XG4gICAgaWYgKHNvcnQgIT09IDApIHtcbiAgICAgIHJldHVybiBzb3J0O1xuICAgIH1cbiAgICAvLyBpZiB0aGUga2V5cyBhcmUgZXF1YWwgc29ydCB0aGUgdmFsdWVzXG4gICAgc29ydCA9IGV4cG9ydHMuY29sbGF0ZShhW2FrW2ldXSwgYltia1tpXV0pO1xuICAgIGlmIChzb3J0ICE9PSAwKSB7XG4gICAgICByZXR1cm4gc29ydDtcbiAgICB9XG5cbiAgfVxuICByZXR1cm4gKGFrLmxlbmd0aCA9PT0gYmsubGVuZ3RoKSA/IDAgOlxuICAgIChhay5sZW5ndGggPiBiay5sZW5ndGgpID8gMSA6IC0xO1xufVxuLy8gVGhlIGNvbGxhdGlvbiBpcyBkZWZpbmVkIGJ5IGVybGFuZ3Mgb3JkZXJlZCB0ZXJtc1xuLy8gdGhlIGF0b21zIG51bGwsIHRydWUsIGZhbHNlIGNvbWUgZmlyc3QsIHRoZW4gbnVtYmVycywgc3RyaW5ncyxcbi8vIGFycmF5cywgdGhlbiBvYmplY3RzXG4vLyBudWxsL3VuZGVmaW5lZC9OYU4vSW5maW5pdHkvLUluZmluaXR5IGFyZSBhbGwgY29uc2lkZXJlZCBudWxsXG5mdW5jdGlvbiBjb2xsYXRpb25JbmRleCh4KSB7XG4gIHZhciBpZCA9IFsnYm9vbGVhbicsICdudW1iZXInLCAnc3RyaW5nJywgJ29iamVjdCddO1xuICB2YXIgaWR4ID0gaWQuaW5kZXhPZih0eXBlb2YgeCk7XG4gIC8vZmFsc2UgaWYgLTEgb3RoZXJ3aXNlIHRydWUsIGJ1dCBmYXN0ISEhITFcbiAgaWYgKH5pZHgpIHtcbiAgICBpZiAoeCA9PT0gbnVsbCkge1xuICAgICAgcmV0dXJuIDE7XG4gICAgfVxuICAgIGlmIChBcnJheS5pc0FycmF5KHgpKSB7XG4gICAgICByZXR1cm4gNTtcbiAgICB9XG4gICAgcmV0dXJuIGlkeCA8IDMgPyAoaWR4ICsgMikgOiAoaWR4ICsgMyk7XG4gIH1cbiAgaWYgKEFycmF5LmlzQXJyYXkoeCkpIHtcbiAgICByZXR1cm4gNTtcbiAgfVxufVxuXG4vLyBjb252ZXJzaW9uOlxuLy8geCB5eXkgenouLi56elxuLy8geCA9IDAgZm9yIG5lZ2F0aXZlLCAxIGZvciAwLCAyIGZvciBwb3NpdGl2ZVxuLy8geSA9IGV4cG9uZW50IChmb3IgbmVnYXRpdmUgbnVtYmVycyBuZWdhdGVkKSBtb3ZlZCBzbyB0aGF0IGl0J3MgPj0gMFxuLy8geiA9IG1hbnRpc3NlXG5mdW5jdGlvbiBudW1Ub0luZGV4YWJsZVN0cmluZyhudW0pIHtcblxuICBpZiAobnVtID09PSAwKSB7XG4gICAgcmV0dXJuICcxJztcbiAgfVxuXG4gIC8vIGNvbnZlcnQgbnVtYmVyIHRvIGV4cG9uZW50aWFsIGZvcm1hdCBmb3IgZWFzaWVyIGFuZFxuICAvLyBtb3JlIHN1Y2NpbmN0IHN0cmluZyBzb3J0aW5nXG4gIHZhciBleHBGb3JtYXQgPSBudW0udG9FeHBvbmVudGlhbCgpLnNwbGl0KC9lXFwrPy8pO1xuICB2YXIgbWFnbml0dWRlID0gcGFyc2VJbnQoZXhwRm9ybWF0WzFdLCAxMCk7XG5cbiAgdmFyIG5lZyA9IG51bSA8IDA7XG5cbiAgdmFyIHJlc3VsdCA9IG5lZyA/ICcwJyA6ICcyJztcblxuICAvLyBmaXJzdCBzb3J0IGJ5IG1hZ25pdHVkZVxuICAvLyBpdCdzIGVhc2llciBpZiBhbGwgbWFnbml0dWRlcyBhcmUgcG9zaXRpdmVcbiAgdmFyIG1hZ0ZvckNvbXBhcmlzb24gPSAoKG5lZyA/IC1tYWduaXR1ZGUgOiBtYWduaXR1ZGUpIC0gTUlOX01BR05JVFVERSk7XG4gIHZhciBtYWdTdHJpbmcgPSB1dGlscy5wYWRMZWZ0KChtYWdGb3JDb21wYXJpc29uKS50b1N0cmluZygpLCAnMCcsIE1BR05JVFVERV9ESUdJVFMpO1xuXG4gIHJlc3VsdCArPSBTRVAgKyBtYWdTdHJpbmc7XG5cbiAgLy8gdGhlbiBzb3J0IGJ5IHRoZSBmYWN0b3JcbiAgdmFyIGZhY3RvciA9IE1hdGguYWJzKHBhcnNlRmxvYXQoZXhwRm9ybWF0WzBdKSk7IC8vIFsxLi4xMClcbiAgaWYgKG5lZykgeyAvLyBmb3IgbmVnYXRpdmUgcmV2ZXJzZSBvcmRlcmluZ1xuICAgIGZhY3RvciA9IDEwIC0gZmFjdG9yO1xuICB9XG5cbiAgdmFyIGZhY3RvclN0ciA9IGZhY3Rvci50b0ZpeGVkKDIwKTtcblxuICAvLyBzdHJpcCB6ZXJvcyBmcm9tIHRoZSBlbmRcbiAgZmFjdG9yU3RyID0gZmFjdG9yU3RyLnJlcGxhY2UoL1xcLj8wKyQvLCAnJyk7XG5cbiAgcmVzdWx0ICs9IFNFUCArIGZhY3RvclN0cjtcblxuICByZXR1cm4gcmVzdWx0O1xufVxuXG59LHtcIi4vdXRpbHNcIjo1M31dLDUzOltmdW5jdGlvbihfZGVyZXFfLG1vZHVsZSxleHBvcnRzKXtcbid1c2Ugc3RyaWN0JztcblxuZnVuY3Rpb24gcGFkKHN0ciwgcGFkV2l0aCwgdXBUb0xlbmd0aCkge1xuICB2YXIgcGFkZGluZyA9ICcnO1xuICB2YXIgdGFyZ2V0TGVuZ3RoID0gdXBUb0xlbmd0aCAtIHN0ci5sZW5ndGg7XG4gIHdoaWxlIChwYWRkaW5nLmxlbmd0aCA8IHRhcmdldExlbmd0aCkge1xuICAgIHBhZGRpbmcgKz0gcGFkV2l0aDtcbiAgfVxuICByZXR1cm4gcGFkZGluZztcbn1cblxuZXhwb3J0cy5wYWRMZWZ0ID0gZnVuY3Rpb24gKHN0ciwgcGFkV2l0aCwgdXBUb0xlbmd0aCkge1xuICB2YXIgcGFkZGluZyA9IHBhZChzdHIsIHBhZFdpdGgsIHVwVG9MZW5ndGgpO1xuICByZXR1cm4gcGFkZGluZyArIHN0cjtcbn07XG5cbmV4cG9ydHMucGFkUmlnaHQgPSBmdW5jdGlvbiAoc3RyLCBwYWRXaXRoLCB1cFRvTGVuZ3RoKSB7XG4gIHZhciBwYWRkaW5nID0gcGFkKHN0ciwgcGFkV2l0aCwgdXBUb0xlbmd0aCk7XG4gIHJldHVybiBzdHIgKyBwYWRkaW5nO1xufTtcblxuZXhwb3J0cy5zdHJpbmdMZXhDb21wYXJlID0gZnVuY3Rpb24gKGEsIGIpIHtcblxuICB2YXIgYUxlbiA9IGEubGVuZ3RoO1xuICB2YXIgYkxlbiA9IGIubGVuZ3RoO1xuXG4gIHZhciBpO1xuICBmb3IgKGkgPSAwOyBpIDwgYUxlbjsgaSsrKSB7XG4gICAgaWYgKGkgPT09IGJMZW4pIHtcbiAgICAgIC8vIGIgaXMgc2hvcnRlciBzdWJzdHJpbmcgb2YgYVxuICAgICAgcmV0dXJuIDE7XG4gICAgfVxuICAgIHZhciBhQ2hhciA9IGEuY2hhckF0KGkpO1xuICAgIHZhciBiQ2hhciA9IGIuY2hhckF0KGkpO1xuICAgIGlmIChhQ2hhciAhPT0gYkNoYXIpIHtcbiAgICAgIHJldHVybiBhQ2hhciA8IGJDaGFyID8gLTEgOiAxO1xuICAgIH1cbiAgfVxuXG4gIGlmIChhTGVuIDwgYkxlbikge1xuICAgIC8vIGEgaXMgc2hvcnRlciBzdWJzdHJpbmcgb2YgYlxuICAgIHJldHVybiAtMTtcbiAgfVxuXG4gIHJldHVybiAwO1xufTtcblxuLypcbiAqIHJldHVybnMgdGhlIGRlY2ltYWwgZm9ybSBmb3IgdGhlIGdpdmVuIGludGVnZXIsIGkuZS4gd3JpdGVzXG4gKiBvdXQgYWxsIHRoZSBkaWdpdHMgKGluIGJhc2UtMTApIGluc3RlYWQgb2YgdXNpbmcgc2NpZW50aWZpYyBub3RhdGlvblxuICovXG5leHBvcnRzLmludFRvRGVjaW1hbEZvcm0gPSBmdW5jdGlvbiAoaW50KSB7XG5cbiAgdmFyIGlzTmVnID0gaW50IDwgMDtcbiAgdmFyIHJlc3VsdCA9ICcnO1xuXG4gIGRvIHtcbiAgICB2YXIgcmVtYWluZGVyID0gaXNOZWcgPyAtTWF0aC5jZWlsKGludCAlIDEwKSA6IE1hdGguZmxvb3IoaW50ICUgMTApO1xuXG4gICAgcmVzdWx0ID0gcmVtYWluZGVyICsgcmVzdWx0O1xuICAgIGludCA9IGlzTmVnID8gTWF0aC5jZWlsKGludCAvIDEwKSA6IE1hdGguZmxvb3IoaW50IC8gMTApO1xuICB9IHdoaWxlIChpbnQpO1xuXG5cbiAgaWYgKGlzTmVnICYmIHJlc3VsdCAhPT0gJzAnKSB7XG4gICAgcmVzdWx0ID0gJy0nICsgcmVzdWx0O1xuICB9XG5cbiAgcmV0dXJuIHJlc3VsdDtcbn07XG59LHt9XSw1NDpbZnVuY3Rpb24oX2RlcmVxXyxtb2R1bGUsZXhwb3J0cyl7XG4ndXNlIHN0cmljdCc7XG4vKlxuICogU2ltcGxlIHRhc2sgcXVldWUgdG8gc2VxdWVudGlhbGl6ZSBhY3Rpb25zLiBBc3N1bWVzIGNhbGxiYWNrcyB3aWxsIGV2ZW50dWFsbHkgZmlyZSAob25jZSkuXG4gKi9cblxudmFyIFByb21pc2UgPSBfZGVyZXFfKCcuL3V0aWxzJykuUHJvbWlzZTtcblxuZnVuY3Rpb24gVGFza1F1ZXVlKCkge1xuICB0aGlzLnByb21pc2UgPSBuZXcgUHJvbWlzZShmdW5jdGlvbiAoZnVsZmlsbCkge2Z1bGZpbGwoKTsgfSk7XG59XG5UYXNrUXVldWUucHJvdG90eXBlLmFkZCA9IGZ1bmN0aW9uIChwcm9taXNlRmFjdG9yeSkge1xuICB0aGlzLnByb21pc2UgPSB0aGlzLnByb21pc2VbXCJjYXRjaFwiXShmdW5jdGlvbiAoKSB7XG4gICAgLy8ganVzdCByZWNvdmVyXG4gIH0pLnRoZW4oZnVuY3Rpb24gKCkge1xuICAgIHJldHVybiBwcm9taXNlRmFjdG9yeSgpO1xuICB9KTtcbiAgcmV0dXJuIHRoaXMucHJvbWlzZTtcbn07XG5UYXNrUXVldWUucHJvdG90eXBlLmZpbmlzaCA9IGZ1bmN0aW9uICgpIHtcbiAgcmV0dXJuIHRoaXMucHJvbWlzZTtcbn07XG5cbm1vZHVsZS5leHBvcnRzID0gVGFza1F1ZXVlO1xuXG59LHtcIi4vdXRpbHNcIjo1Nn1dLDU1OltmdW5jdGlvbihfZGVyZXFfLG1vZHVsZSxleHBvcnRzKXtcbid1c2Ugc3RyaWN0JztcbnZhciBQcm9taXNlID0gX2RlcmVxXygnLi91dGlscycpLlByb21pc2U7XG5cbi8vIHRoaXMgaXMgZXNzZW50aWFsbHkgdGhlIFwidXBkYXRlIHN1Z2FyXCIgZnVuY3Rpb24gZnJvbSBkYWxlaGFydmV5L3BvdWNoZGIjMTM4OFxuLy8gdGhlIGRpZmZGdW4gdGVsbHMgdXMgd2hhdCBkZWx0YSB0byBhcHBseSB0byB0aGUgZG9jLiAgaXQgZWl0aGVyIHJldHVybnNcbi8vIHRoZSBkb2MsIG9yIGZhbHNlIGlmIGl0IGRvZXNuJ3QgbmVlZCB0byBkbyBhbiB1cGRhdGUgYWZ0ZXIgYWxsXG5mdW5jdGlvbiB1cHNlcnQoZGIsIGRvY0lkLCBkaWZmRnVuKSB7XG4gIHJldHVybiBuZXcgUHJvbWlzZShmdW5jdGlvbiAoZnVsZmlsbCwgcmVqZWN0KSB7XG4gICAgaWYgKGRvY0lkICYmIHR5cGVvZiBkb2NJZCA9PT0gJ29iamVjdCcpIHtcbiAgICAgIGRvY0lkID0gZG9jSWQuX2lkO1xuICAgIH1cbiAgICBpZiAodHlwZW9mIGRvY0lkICE9PSAnc3RyaW5nJykge1xuICAgICAgcmV0dXJuIHJlamVjdChuZXcgRXJyb3IoJ2RvYyBpZCBpcyByZXF1aXJlZCcpKTtcbiAgICB9XG5cbiAgICBkYi5nZXQoZG9jSWQsIGZ1bmN0aW9uIChlcnIsIGRvYykge1xuICAgICAgaWYgKGVycikge1xuICAgICAgICBpZiAoZXJyLnN0YXR1cyAhPT0gNDA0KSB7XG4gICAgICAgICAgcmV0dXJuIHJlamVjdChlcnIpO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBmdWxmaWxsKHRyeUFuZFB1dChkYiwgZGlmZkZ1bih7X2lkIDogZG9jSWR9KSwgZGlmZkZ1bikpO1xuICAgICAgfVxuICAgICAgdmFyIG5ld0RvYyA9IGRpZmZGdW4oZG9jKTtcbiAgICAgIGlmICghbmV3RG9jKSB7XG4gICAgICAgIHJldHVybiBmdWxmaWxsKGRvYyk7XG4gICAgICB9XG4gICAgICBmdWxmaWxsKHRyeUFuZFB1dChkYiwgbmV3RG9jLCBkaWZmRnVuKSk7XG4gICAgfSk7XG4gIH0pO1xufVxuXG5mdW5jdGlvbiB0cnlBbmRQdXQoZGIsIGRvYywgZGlmZkZ1bikge1xuICByZXR1cm4gZGIucHV0KGRvYylbXCJjYXRjaFwiXShmdW5jdGlvbiAoZXJyKSB7XG4gICAgaWYgKGVyci5zdGF0dXMgIT09IDQwOSkge1xuICAgICAgdGhyb3cgZXJyO1xuICAgIH1cbiAgICByZXR1cm4gdXBzZXJ0KGRiLCBkb2MsIGRpZmZGdW4pO1xuICB9KTtcbn1cblxubW9kdWxlLmV4cG9ydHMgPSB1cHNlcnQ7XG5cbn0se1wiLi91dGlsc1wiOjU2fV0sNTY6W2Z1bmN0aW9uKF9kZXJlcV8sbW9kdWxlLGV4cG9ydHMpe1xuKGZ1bmN0aW9uIChwcm9jZXNzLGdsb2JhbCl7XG4ndXNlIHN0cmljdCc7XG4vKiBpc3RhbmJ1bCBpZ25vcmUgaWYgKi9cbmlmICh0eXBlb2YgZ2xvYmFsLlByb21pc2UgPT09ICdmdW5jdGlvbicpIHtcbiAgZXhwb3J0cy5Qcm9taXNlID0gZ2xvYmFsLlByb21pc2U7XG59IGVsc2Uge1xuICBleHBvcnRzLlByb21pc2UgPSBfZGVyZXFfKCdsaWUnKTtcbn1cbi8vIHVuaXF1aWZ5IGEgbGlzdCwgc2ltaWxhciB0byB1bmRlcnNjb3JlJ3MgXy51bmlxXG5leHBvcnRzLnVuaXEgPSBmdW5jdGlvbiAoYXJyKSB7XG4gIHZhciBtYXAgPSB7fTtcbiAgYXJyLmZvckVhY2goZnVuY3Rpb24gKGVsZW1lbnQpIHtcbiAgICBtYXBbZWxlbWVudF0gPSB0cnVlO1xuICB9KTtcbiAgcmV0dXJuIE9iamVjdC5rZXlzKG1hcCk7XG59O1xuXG5leHBvcnRzLmluaGVyaXRzID0gX2RlcmVxXygnaW5oZXJpdHMnKTtcbmV4cG9ydHMuZXh0ZW5kID0gX2RlcmVxXygncG91Y2hkYi1leHRlbmQnKTtcbnZhciBhcmdzYXJyYXkgPSBfZGVyZXFfKCdhcmdzYXJyYXknKTtcblxuZXhwb3J0cy5wcm9taXNlZENhbGxiYWNrID0gZnVuY3Rpb24gKHByb21pc2UsIGNhbGxiYWNrKSB7XG4gIGlmIChjYWxsYmFjaykge1xuICAgIHByb21pc2UudGhlbihmdW5jdGlvbiAocmVzKSB7XG4gICAgICBwcm9jZXNzLm5leHRUaWNrKGZ1bmN0aW9uICgpIHtcbiAgICAgICAgY2FsbGJhY2sobnVsbCwgcmVzKTtcbiAgICAgIH0pO1xuICAgIH0sIGZ1bmN0aW9uIChyZWFzb24pIHtcbiAgICAgIHByb2Nlc3MubmV4dFRpY2soZnVuY3Rpb24gKCkge1xuICAgICAgICBjYWxsYmFjayhyZWFzb24pO1xuICAgICAgfSk7XG4gICAgfSk7XG4gIH1cbiAgcmV0dXJuIHByb21pc2U7XG59O1xuXG5leHBvcnRzLmNhbGxiYWNraWZ5ID0gZnVuY3Rpb24gKGZ1bikge1xuICByZXR1cm4gYXJnc2FycmF5KGZ1bmN0aW9uIChhcmdzKSB7XG4gICAgdmFyIGNiID0gYXJncy5wb3AoKTtcbiAgICB2YXIgcHJvbWlzZSA9IGZ1bi5hcHBseSh0aGlzLCBhcmdzKTtcbiAgICBpZiAodHlwZW9mIGNiID09PSAnZnVuY3Rpb24nKSB7XG4gICAgICBleHBvcnRzLnByb21pc2VkQ2FsbGJhY2socHJvbWlzZSwgY2IpO1xuICAgIH1cbiAgICByZXR1cm4gcHJvbWlzZTtcbiAgfSk7XG59O1xuXG4vLyBQcm9taXNlIGZpbmFsbHkgdXRpbCBzaW1pbGFyIHRvIFEuZmluYWxseVxuZXhwb3J0cy5maW4gPSBmdW5jdGlvbiAocHJvbWlzZSwgY2IpIHtcbiAgcmV0dXJuIHByb21pc2UudGhlbihmdW5jdGlvbiAocmVzKSB7XG4gICAgdmFyIHByb21pc2UyID0gY2IoKTtcbiAgICBpZiAodHlwZW9mIHByb21pc2UyLnRoZW4gPT09ICdmdW5jdGlvbicpIHtcbiAgICAgIHJldHVybiBwcm9taXNlMi50aGVuKGZ1bmN0aW9uICgpIHtcbiAgICAgICAgcmV0dXJuIHJlcztcbiAgICAgIH0pO1xuICAgIH1cbiAgICByZXR1cm4gcmVzO1xuICB9LCBmdW5jdGlvbiAocmVhc29uKSB7XG4gICAgdmFyIHByb21pc2UyID0gY2IoKTtcbiAgICBpZiAodHlwZW9mIHByb21pc2UyLnRoZW4gPT09ICdmdW5jdGlvbicpIHtcbiAgICAgIHJldHVybiBwcm9taXNlMi50aGVuKGZ1bmN0aW9uICgpIHtcbiAgICAgICAgdGhyb3cgcmVhc29uO1xuICAgICAgfSk7XG4gICAgfVxuICAgIHRocm93IHJlYXNvbjtcbiAgfSk7XG59O1xuXG5leHBvcnRzLnNlcXVlbnRpYWxpemUgPSBmdW5jdGlvbiAocXVldWUsIHByb21pc2VGYWN0b3J5KSB7XG4gIHJldHVybiBmdW5jdGlvbiAoKSB7XG4gICAgdmFyIGFyZ3MgPSBhcmd1bWVudHM7XG4gICAgdmFyIHRoYXQgPSB0aGlzO1xuICAgIHJldHVybiBxdWV1ZS5hZGQoZnVuY3Rpb24gKCkge1xuICAgICAgcmV0dXJuIHByb21pc2VGYWN0b3J5LmFwcGx5KHRoYXQsIGFyZ3MpO1xuICAgIH0pO1xuICB9O1xufTtcblxudmFyIGNyeXB0byA9IF9kZXJlcV8oJ2NyeXB0bycpO1xudmFyIE1kNSA9IF9kZXJlcV8oJ3NwYXJrLW1kNScpO1xuXG5leHBvcnRzLk1ENSA9IGZ1bmN0aW9uIChzdHJpbmcpIHtcbiAgLyogaXN0YW5idWwgaWdub3JlIGVsc2UgKi9cbiAgaWYgKCFwcm9jZXNzLmJyb3dzZXIpIHtcbiAgICByZXR1cm4gY3J5cHRvLmNyZWF0ZUhhc2goJ21kNScpLnVwZGF0ZShzdHJpbmcpLmRpZ2VzdCgnaGV4Jyk7XG4gIH0gZWxzZSB7XG4gICAgcmV0dXJuIE1kNS5oYXNoKHN0cmluZyk7XG4gIH1cbn07XG59KS5jYWxsKHRoaXMsX2RlcmVxXyhcIi9Vc2Vycy9ub2xhbi93b3Jrc3BhY2UvcG91Y2hkYi9ub2RlX21vZHVsZXMvYnJvd3NlcmlmeS9ub2RlX21vZHVsZXMvaW5zZXJ0LW1vZHVsZS1nbG9iYWxzL25vZGVfbW9kdWxlcy9wcm9jZXNzL2Jyb3dzZXIuanNcIiksdHlwZW9mIHNlbGYgIT09IFwidW5kZWZpbmVkXCIgPyBzZWxmIDogdHlwZW9mIHdpbmRvdyAhPT0gXCJ1bmRlZmluZWRcIiA/IHdpbmRvdyA6IHt9KVxufSx7XCIvVXNlcnMvbm9sYW4vd29ya3NwYWNlL3BvdWNoZGIvbm9kZV9tb2R1bGVzL2Jyb3dzZXJpZnkvbm9kZV9tb2R1bGVzL2luc2VydC1tb2R1bGUtZ2xvYmFscy9ub2RlX21vZHVsZXMvcHJvY2Vzcy9icm93c2VyLmpzXCI6MjgsXCJhcmdzYXJyYXlcIjoyNSxcImNyeXB0b1wiOjI2LFwiaW5oZXJpdHNcIjoyOSxcImxpZVwiOjMzLFwicG91Y2hkYi1leHRlbmRcIjo0OCxcInNwYXJrLW1kNVwiOjU3fV0sNTc6W2Z1bmN0aW9uKF9kZXJlcV8sbW9kdWxlLGV4cG9ydHMpe1xuLypqc2hpbnQgYml0d2lzZTpmYWxzZSovXG4vKmdsb2JhbCB1bmVzY2FwZSovXG5cbihmdW5jdGlvbiAoZmFjdG9yeSkge1xuICAgIGlmICh0eXBlb2YgZXhwb3J0cyA9PT0gJ29iamVjdCcpIHtcbiAgICAgICAgLy8gTm9kZS9Db21tb25KU1xuICAgICAgICBtb2R1bGUuZXhwb3J0cyA9IGZhY3RvcnkoKTtcbiAgICB9IGVsc2UgaWYgKHR5cGVvZiBkZWZpbmUgPT09ICdmdW5jdGlvbicgJiYgZGVmaW5lLmFtZCkge1xuICAgICAgICAvLyBBTURcbiAgICAgICAgZGVmaW5lKGZhY3RvcnkpO1xuICAgIH0gZWxzZSB7XG4gICAgICAgIC8vIEJyb3dzZXIgZ2xvYmFscyAod2l0aCBzdXBwb3J0IGZvciB3ZWIgd29ya2VycylcbiAgICAgICAgdmFyIGdsb2I7XG4gICAgICAgIHRyeSB7XG4gICAgICAgICAgICBnbG9iID0gd2luZG93O1xuICAgICAgICB9IGNhdGNoIChlKSB7XG4gICAgICAgICAgICBnbG9iID0gc2VsZjtcbiAgICAgICAgfVxuXG4gICAgICAgIGdsb2IuU3BhcmtNRDUgPSBmYWN0b3J5KCk7XG4gICAgfVxufShmdW5jdGlvbiAodW5kZWZpbmVkKSB7XG5cbiAgICAndXNlIHN0cmljdCc7XG5cbiAgICAvLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vXG5cbiAgICAvKlxuICAgICAqIEZhc3Rlc3QgbWQ1IGltcGxlbWVudGF0aW9uIGFyb3VuZCAoSktNIG1kNSlcbiAgICAgKiBDcmVkaXRzOiBKb3NlcGggTXllcnNcbiAgICAgKlxuICAgICAqIEBzZWUgaHR0cDovL3d3dy5teWVyc2RhaWx5Lm9yZy9qb3NlcGgvamF2YXNjcmlwdC9tZDUtdGV4dC5odG1sXG4gICAgICogQHNlZSBodHRwOi8vanNwZXJmLmNvbS9tZDUtc2hvb3RvdXQvN1xuICAgICAqL1xuXG4gICAgLyogdGhpcyBmdW5jdGlvbiBpcyBtdWNoIGZhc3RlcixcbiAgICAgIHNvIGlmIHBvc3NpYmxlIHdlIHVzZSBpdC4gU29tZSBJRXNcbiAgICAgIGFyZSB0aGUgb25seSBvbmVzIEkga25vdyBvZiB0aGF0XG4gICAgICBuZWVkIHRoZSBpZGlvdGljIHNlY29uZCBmdW5jdGlvbixcbiAgICAgIGdlbmVyYXRlZCBieSBhbiBpZiBjbGF1c2UuICAqL1xuICAgIHZhciBhZGQzMiA9IGZ1bmN0aW9uIChhLCBiKSB7XG4gICAgICAgIHJldHVybiAoYSArIGIpICYgMHhGRkZGRkZGRjtcbiAgICB9LFxuXG4gICAgY21uID0gZnVuY3Rpb24gKHEsIGEsIGIsIHgsIHMsIHQpIHtcbiAgICAgICAgYSA9IGFkZDMyKGFkZDMyKGEsIHEpLCBhZGQzMih4LCB0KSk7XG4gICAgICAgIHJldHVybiBhZGQzMigoYSA8PCBzKSB8IChhID4+PiAoMzIgLSBzKSksIGIpO1xuICAgIH0sXG5cbiAgICBmZiA9IGZ1bmN0aW9uIChhLCBiLCBjLCBkLCB4LCBzLCB0KSB7XG4gICAgICAgIHJldHVybiBjbW4oKGIgJiBjKSB8ICgofmIpICYgZCksIGEsIGIsIHgsIHMsIHQpO1xuICAgIH0sXG5cbiAgICBnZyA9IGZ1bmN0aW9uIChhLCBiLCBjLCBkLCB4LCBzLCB0KSB7XG4gICAgICAgIHJldHVybiBjbW4oKGIgJiBkKSB8IChjICYgKH5kKSksIGEsIGIsIHgsIHMsIHQpO1xuICAgIH0sXG5cbiAgICBoaCA9IGZ1bmN0aW9uIChhLCBiLCBjLCBkLCB4LCBzLCB0KSB7XG4gICAgICAgIHJldHVybiBjbW4oYiBeIGMgXiBkLCBhLCBiLCB4LCBzLCB0KTtcbiAgICB9LFxuXG4gICAgaWkgPSBmdW5jdGlvbiAoYSwgYiwgYywgZCwgeCwgcywgdCkge1xuICAgICAgICByZXR1cm4gY21uKGMgXiAoYiB8ICh+ZCkpLCBhLCBiLCB4LCBzLCB0KTtcbiAgICB9LFxuXG4gICAgbWQ1Y3ljbGUgPSBmdW5jdGlvbiAoeCwgaykge1xuICAgICAgICB2YXIgYSA9IHhbMF0sXG4gICAgICAgICAgICBiID0geFsxXSxcbiAgICAgICAgICAgIGMgPSB4WzJdLFxuICAgICAgICAgICAgZCA9IHhbM107XG5cbiAgICAgICAgYSA9IGZmKGEsIGIsIGMsIGQsIGtbMF0sIDcsIC02ODA4NzY5MzYpO1xuICAgICAgICBkID0gZmYoZCwgYSwgYiwgYywga1sxXSwgMTIsIC0zODk1NjQ1ODYpO1xuICAgICAgICBjID0gZmYoYywgZCwgYSwgYiwga1syXSwgMTcsIDYwNjEwNTgxOSk7XG4gICAgICAgIGIgPSBmZihiLCBjLCBkLCBhLCBrWzNdLCAyMiwgLTEwNDQ1MjUzMzApO1xuICAgICAgICBhID0gZmYoYSwgYiwgYywgZCwga1s0XSwgNywgLTE3NjQxODg5Nyk7XG4gICAgICAgIGQgPSBmZihkLCBhLCBiLCBjLCBrWzVdLCAxMiwgMTIwMDA4MDQyNik7XG4gICAgICAgIGMgPSBmZihjLCBkLCBhLCBiLCBrWzZdLCAxNywgLTE0NzMyMzEzNDEpO1xuICAgICAgICBiID0gZmYoYiwgYywgZCwgYSwga1s3XSwgMjIsIC00NTcwNTk4Myk7XG4gICAgICAgIGEgPSBmZihhLCBiLCBjLCBkLCBrWzhdLCA3LCAxNzcwMDM1NDE2KTtcbiAgICAgICAgZCA9IGZmKGQsIGEsIGIsIGMsIGtbOV0sIDEyLCAtMTk1ODQxNDQxNyk7XG4gICAgICAgIGMgPSBmZihjLCBkLCBhLCBiLCBrWzEwXSwgMTcsIC00MjA2Myk7XG4gICAgICAgIGIgPSBmZihiLCBjLCBkLCBhLCBrWzExXSwgMjIsIC0xOTkwNDA0MTYyKTtcbiAgICAgICAgYSA9IGZmKGEsIGIsIGMsIGQsIGtbMTJdLCA3LCAxODA0NjAzNjgyKTtcbiAgICAgICAgZCA9IGZmKGQsIGEsIGIsIGMsIGtbMTNdLCAxMiwgLTQwMzQxMTAxKTtcbiAgICAgICAgYyA9IGZmKGMsIGQsIGEsIGIsIGtbMTRdLCAxNywgLTE1MDIwMDIyOTApO1xuICAgICAgICBiID0gZmYoYiwgYywgZCwgYSwga1sxNV0sIDIyLCAxMjM2NTM1MzI5KTtcblxuICAgICAgICBhID0gZ2coYSwgYiwgYywgZCwga1sxXSwgNSwgLTE2NTc5NjUxMCk7XG4gICAgICAgIGQgPSBnZyhkLCBhLCBiLCBjLCBrWzZdLCA5LCAtMTA2OTUwMTYzMik7XG4gICAgICAgIGMgPSBnZyhjLCBkLCBhLCBiLCBrWzExXSwgMTQsIDY0MzcxNzcxMyk7XG4gICAgICAgIGIgPSBnZyhiLCBjLCBkLCBhLCBrWzBdLCAyMCwgLTM3Mzg5NzMwMik7XG4gICAgICAgIGEgPSBnZyhhLCBiLCBjLCBkLCBrWzVdLCA1LCAtNzAxNTU4NjkxKTtcbiAgICAgICAgZCA9IGdnKGQsIGEsIGIsIGMsIGtbMTBdLCA5LCAzODAxNjA4Myk7XG4gICAgICAgIGMgPSBnZyhjLCBkLCBhLCBiLCBrWzE1XSwgMTQsIC02NjA0NzgzMzUpO1xuICAgICAgICBiID0gZ2coYiwgYywgZCwgYSwga1s0XSwgMjAsIC00MDU1Mzc4NDgpO1xuICAgICAgICBhID0gZ2coYSwgYiwgYywgZCwga1s5XSwgNSwgNTY4NDQ2NDM4KTtcbiAgICAgICAgZCA9IGdnKGQsIGEsIGIsIGMsIGtbMTRdLCA5LCAtMTAxOTgwMzY5MCk7XG4gICAgICAgIGMgPSBnZyhjLCBkLCBhLCBiLCBrWzNdLCAxNCwgLTE4NzM2Mzk2MSk7XG4gICAgICAgIGIgPSBnZyhiLCBjLCBkLCBhLCBrWzhdLCAyMCwgMTE2MzUzMTUwMSk7XG4gICAgICAgIGEgPSBnZyhhLCBiLCBjLCBkLCBrWzEzXSwgNSwgLTE0NDQ2ODE0NjcpO1xuICAgICAgICBkID0gZ2coZCwgYSwgYiwgYywga1syXSwgOSwgLTUxNDAzNzg0KTtcbiAgICAgICAgYyA9IGdnKGMsIGQsIGEsIGIsIGtbN10sIDE0LCAxNzM1MzI4NDczKTtcbiAgICAgICAgYiA9IGdnKGIsIGMsIGQsIGEsIGtbMTJdLCAyMCwgLTE5MjY2MDc3MzQpO1xuXG4gICAgICAgIGEgPSBoaChhLCBiLCBjLCBkLCBrWzVdLCA0LCAtMzc4NTU4KTtcbiAgICAgICAgZCA9IGhoKGQsIGEsIGIsIGMsIGtbOF0sIDExLCAtMjAyMjU3NDQ2Myk7XG4gICAgICAgIGMgPSBoaChjLCBkLCBhLCBiLCBrWzExXSwgMTYsIDE4MzkwMzA1NjIpO1xuICAgICAgICBiID0gaGgoYiwgYywgZCwgYSwga1sxNF0sIDIzLCAtMzUzMDk1NTYpO1xuICAgICAgICBhID0gaGgoYSwgYiwgYywgZCwga1sxXSwgNCwgLTE1MzA5OTIwNjApO1xuICAgICAgICBkID0gaGgoZCwgYSwgYiwgYywga1s0XSwgMTEsIDEyNzI4OTMzNTMpO1xuICAgICAgICBjID0gaGgoYywgZCwgYSwgYiwga1s3XSwgMTYsIC0xNTU0OTc2MzIpO1xuICAgICAgICBiID0gaGgoYiwgYywgZCwgYSwga1sxMF0sIDIzLCAtMTA5NDczMDY0MCk7XG4gICAgICAgIGEgPSBoaChhLCBiLCBjLCBkLCBrWzEzXSwgNCwgNjgxMjc5MTc0KTtcbiAgICAgICAgZCA9IGhoKGQsIGEsIGIsIGMsIGtbMF0sIDExLCAtMzU4NTM3MjIyKTtcbiAgICAgICAgYyA9IGhoKGMsIGQsIGEsIGIsIGtbM10sIDE2LCAtNzIyNTIxOTc5KTtcbiAgICAgICAgYiA9IGhoKGIsIGMsIGQsIGEsIGtbNl0sIDIzLCA3NjAyOTE4OSk7XG4gICAgICAgIGEgPSBoaChhLCBiLCBjLCBkLCBrWzldLCA0LCAtNjQwMzY0NDg3KTtcbiAgICAgICAgZCA9IGhoKGQsIGEsIGIsIGMsIGtbMTJdLCAxMSwgLTQyMTgxNTgzNSk7XG4gICAgICAgIGMgPSBoaChjLCBkLCBhLCBiLCBrWzE1XSwgMTYsIDUzMDc0MjUyMCk7XG4gICAgICAgIGIgPSBoaChiLCBjLCBkLCBhLCBrWzJdLCAyMywgLTk5NTMzODY1MSk7XG5cbiAgICAgICAgYSA9IGlpKGEsIGIsIGMsIGQsIGtbMF0sIDYsIC0xOTg2MzA4NDQpO1xuICAgICAgICBkID0gaWkoZCwgYSwgYiwgYywga1s3XSwgMTAsIDExMjY4OTE0MTUpO1xuICAgICAgICBjID0gaWkoYywgZCwgYSwgYiwga1sxNF0sIDE1LCAtMTQxNjM1NDkwNSk7XG4gICAgICAgIGIgPSBpaShiLCBjLCBkLCBhLCBrWzVdLCAyMSwgLTU3NDM0MDU1KTtcbiAgICAgICAgYSA9IGlpKGEsIGIsIGMsIGQsIGtbMTJdLCA2LCAxNzAwNDg1NTcxKTtcbiAgICAgICAgZCA9IGlpKGQsIGEsIGIsIGMsIGtbM10sIDEwLCAtMTg5NDk4NjYwNik7XG4gICAgICAgIGMgPSBpaShjLCBkLCBhLCBiLCBrWzEwXSwgMTUsIC0xMDUxNTIzKTtcbiAgICAgICAgYiA9IGlpKGIsIGMsIGQsIGEsIGtbMV0sIDIxLCAtMjA1NDkyMjc5OSk7XG4gICAgICAgIGEgPSBpaShhLCBiLCBjLCBkLCBrWzhdLCA2LCAxODczMzEzMzU5KTtcbiAgICAgICAgZCA9IGlpKGQsIGEsIGIsIGMsIGtbMTVdLCAxMCwgLTMwNjExNzQ0KTtcbiAgICAgICAgYyA9IGlpKGMsIGQsIGEsIGIsIGtbNl0sIDE1LCAtMTU2MDE5ODM4MCk7XG4gICAgICAgIGIgPSBpaShiLCBjLCBkLCBhLCBrWzEzXSwgMjEsIDEzMDkxNTE2NDkpO1xuICAgICAgICBhID0gaWkoYSwgYiwgYywgZCwga1s0XSwgNiwgLTE0NTUyMzA3MCk7XG4gICAgICAgIGQgPSBpaShkLCBhLCBiLCBjLCBrWzExXSwgMTAsIC0xMTIwMjEwMzc5KTtcbiAgICAgICAgYyA9IGlpKGMsIGQsIGEsIGIsIGtbMl0sIDE1LCA3MTg3ODcyNTkpO1xuICAgICAgICBiID0gaWkoYiwgYywgZCwgYSwga1s5XSwgMjEsIC0zNDM0ODU1NTEpO1xuXG4gICAgICAgIHhbMF0gPSBhZGQzMihhLCB4WzBdKTtcbiAgICAgICAgeFsxXSA9IGFkZDMyKGIsIHhbMV0pO1xuICAgICAgICB4WzJdID0gYWRkMzIoYywgeFsyXSk7XG4gICAgICAgIHhbM10gPSBhZGQzMihkLCB4WzNdKTtcbiAgICB9LFxuXG4gICAgLyogdGhlcmUgbmVlZHMgdG8gYmUgc3VwcG9ydCBmb3IgVW5pY29kZSBoZXJlLFxuICAgICAgICogdW5sZXNzIHdlIHByZXRlbmQgdGhhdCB3ZSBjYW4gcmVkZWZpbmUgdGhlIE1ELTVcbiAgICAgICAqIGFsZ29yaXRobSBmb3IgbXVsdGktYnl0ZSBjaGFyYWN0ZXJzIChwZXJoYXBzXG4gICAgICAgKiBieSBhZGRpbmcgZXZlcnkgZm91ciAxNi1iaXQgY2hhcmFjdGVycyBhbmRcbiAgICAgICAqIHNob3J0ZW5pbmcgdGhlIHN1bSB0byAzMiBiaXRzKS4gT3RoZXJ3aXNlXG4gICAgICAgKiBJIHN1Z2dlc3QgcGVyZm9ybWluZyBNRC01IGFzIGlmIGV2ZXJ5IGNoYXJhY3RlclxuICAgICAgICogd2FzIHR3byBieXRlcy0tZS5nLiwgMDA0MCAwMDI1ID0gQCUtLWJ1dCB0aGVuXG4gICAgICAgKiBob3cgd2lsbCBhbiBvcmRpbmFyeSBNRC01IHN1bSBiZSBtYXRjaGVkP1xuICAgICAgICogVGhlcmUgaXMgbm8gd2F5IHRvIHN0YW5kYXJkaXplIHRleHQgdG8gc29tZXRoaW5nXG4gICAgICAgKiBsaWtlIFVURi04IGJlZm9yZSB0cmFuc2Zvcm1hdGlvbjsgc3BlZWQgY29zdCBpc1xuICAgICAgICogdXR0ZXJseSBwcm9oaWJpdGl2ZS4gVGhlIEphdmFTY3JpcHQgc3RhbmRhcmRcbiAgICAgICAqIGl0c2VsZiBuZWVkcyB0byBsb29rIGF0IHRoaXM6IGl0IHNob3VsZCBzdGFydFxuICAgICAgICogcHJvdmlkaW5nIGFjY2VzcyB0byBzdHJpbmdzIGFzIHByZWZvcm1lZCBVVEYtOFxuICAgICAgICogOC1iaXQgdW5zaWduZWQgdmFsdWUgYXJyYXlzLlxuICAgICAgICovXG4gICAgbWQ1YmxrID0gZnVuY3Rpb24gKHMpIHtcbiAgICAgICAgdmFyIG1kNWJsa3MgPSBbXSxcbiAgICAgICAgICAgIGk7IC8qIEFuZHkgS2luZyBzYWlkIGRvIGl0IHRoaXMgd2F5LiAqL1xuXG4gICAgICAgIGZvciAoaSA9IDA7IGkgPCA2NDsgaSArPSA0KSB7XG4gICAgICAgICAgICBtZDVibGtzW2kgPj4gMl0gPSBzLmNoYXJDb2RlQXQoaSkgKyAocy5jaGFyQ29kZUF0KGkgKyAxKSA8PCA4KSArIChzLmNoYXJDb2RlQXQoaSArIDIpIDw8IDE2KSArIChzLmNoYXJDb2RlQXQoaSArIDMpIDw8IDI0KTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gbWQ1YmxrcztcbiAgICB9LFxuXG4gICAgbWQ1YmxrX2FycmF5ID0gZnVuY3Rpb24gKGEpIHtcbiAgICAgICAgdmFyIG1kNWJsa3MgPSBbXSxcbiAgICAgICAgICAgIGk7IC8qIEFuZHkgS2luZyBzYWlkIGRvIGl0IHRoaXMgd2F5LiAqL1xuXG4gICAgICAgIGZvciAoaSA9IDA7IGkgPCA2NDsgaSArPSA0KSB7XG4gICAgICAgICAgICBtZDVibGtzW2kgPj4gMl0gPSBhW2ldICsgKGFbaSArIDFdIDw8IDgpICsgKGFbaSArIDJdIDw8IDE2KSArIChhW2kgKyAzXSA8PCAyNCk7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIG1kNWJsa3M7XG4gICAgfSxcblxuICAgIG1kNTEgPSBmdW5jdGlvbiAocykge1xuICAgICAgICB2YXIgbiA9IHMubGVuZ3RoLFxuICAgICAgICAgICAgc3RhdGUgPSBbMTczMjU4NDE5MywgLTI3MTczMzg3OSwgLTE3MzI1ODQxOTQsIDI3MTczMzg3OF0sXG4gICAgICAgICAgICBpLFxuICAgICAgICAgICAgbGVuZ3RoLFxuICAgICAgICAgICAgdGFpbCxcbiAgICAgICAgICAgIHRtcCxcbiAgICAgICAgICAgIGxvLFxuICAgICAgICAgICAgaGk7XG5cbiAgICAgICAgZm9yIChpID0gNjQ7IGkgPD0gbjsgaSArPSA2NCkge1xuICAgICAgICAgICAgbWQ1Y3ljbGUoc3RhdGUsIG1kNWJsayhzLnN1YnN0cmluZyhpIC0gNjQsIGkpKSk7XG4gICAgICAgIH1cbiAgICAgICAgcyA9IHMuc3Vic3RyaW5nKGkgLSA2NCk7XG4gICAgICAgIGxlbmd0aCA9IHMubGVuZ3RoO1xuICAgICAgICB0YWlsID0gWzAsIDAsIDAsIDAsIDAsIDAsIDAsIDAsIDAsIDAsIDAsIDAsIDAsIDAsIDAsIDBdO1xuICAgICAgICBmb3IgKGkgPSAwOyBpIDwgbGVuZ3RoOyBpICs9IDEpIHtcbiAgICAgICAgICAgIHRhaWxbaSA+PiAyXSB8PSBzLmNoYXJDb2RlQXQoaSkgPDwgKChpICUgNCkgPDwgMyk7XG4gICAgICAgIH1cbiAgICAgICAgdGFpbFtpID4+IDJdIHw9IDB4ODAgPDwgKChpICUgNCkgPDwgMyk7XG4gICAgICAgIGlmIChpID4gNTUpIHtcbiAgICAgICAgICAgIG1kNWN5Y2xlKHN0YXRlLCB0YWlsKTtcbiAgICAgICAgICAgIGZvciAoaSA9IDA7IGkgPCAxNjsgaSArPSAxKSB7XG4gICAgICAgICAgICAgICAgdGFpbFtpXSA9IDA7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cblxuICAgICAgICAvLyBCZXdhcmUgdGhhdCB0aGUgZmluYWwgbGVuZ3RoIG1pZ2h0IG5vdCBmaXQgaW4gMzIgYml0cyBzbyB3ZSB0YWtlIGNhcmUgb2YgdGhhdFxuICAgICAgICB0bXAgPSBuICogODtcbiAgICAgICAgdG1wID0gdG1wLnRvU3RyaW5nKDE2KS5tYXRjaCgvKC4qPykoLnswLDh9KSQvKTtcbiAgICAgICAgbG8gPSBwYXJzZUludCh0bXBbMl0sIDE2KTtcbiAgICAgICAgaGkgPSBwYXJzZUludCh0bXBbMV0sIDE2KSB8fCAwO1xuXG4gICAgICAgIHRhaWxbMTRdID0gbG87XG4gICAgICAgIHRhaWxbMTVdID0gaGk7XG5cbiAgICAgICAgbWQ1Y3ljbGUoc3RhdGUsIHRhaWwpO1xuICAgICAgICByZXR1cm4gc3RhdGU7XG4gICAgfSxcblxuICAgIG1kNTFfYXJyYXkgPSBmdW5jdGlvbiAoYSkge1xuICAgICAgICB2YXIgbiA9IGEubGVuZ3RoLFxuICAgICAgICAgICAgc3RhdGUgPSBbMTczMjU4NDE5MywgLTI3MTczMzg3OSwgLTE3MzI1ODQxOTQsIDI3MTczMzg3OF0sXG4gICAgICAgICAgICBpLFxuICAgICAgICAgICAgbGVuZ3RoLFxuICAgICAgICAgICAgdGFpbCxcbiAgICAgICAgICAgIHRtcCxcbiAgICAgICAgICAgIGxvLFxuICAgICAgICAgICAgaGk7XG5cbiAgICAgICAgZm9yIChpID0gNjQ7IGkgPD0gbjsgaSArPSA2NCkge1xuICAgICAgICAgICAgbWQ1Y3ljbGUoc3RhdGUsIG1kNWJsa19hcnJheShhLnN1YmFycmF5KGkgLSA2NCwgaSkpKTtcbiAgICAgICAgfVxuXG4gICAgICAgIC8vIE5vdCBzdXJlIGlmIGl0IGlzIGEgYnVnLCBob3dldmVyIElFMTAgd2lsbCBhbHdheXMgcHJvZHVjZSBhIHN1YiBhcnJheSBvZiBsZW5ndGggMVxuICAgICAgICAvLyBjb250YWluaW5nIHRoZSBsYXN0IGVsZW1lbnQgb2YgdGhlIHBhcmVudCBhcnJheSBpZiB0aGUgc3ViIGFycmF5IHNwZWNpZmllZCBzdGFydHNcbiAgICAgICAgLy8gYmV5b25kIHRoZSBsZW5ndGggb2YgdGhlIHBhcmVudCBhcnJheSAtIHdlaXJkLlxuICAgICAgICAvLyBodHRwczovL2Nvbm5lY3QubWljcm9zb2Z0LmNvbS9JRS9mZWVkYmFjay9kZXRhaWxzLzc3MTQ1Mi90eXBlZC1hcnJheS1zdWJhcnJheS1pc3N1ZVxuICAgICAgICBhID0gKGkgLSA2NCkgPCBuID8gYS5zdWJhcnJheShpIC0gNjQpIDogbmV3IFVpbnQ4QXJyYXkoMCk7XG5cbiAgICAgICAgbGVuZ3RoID0gYS5sZW5ndGg7XG4gICAgICAgIHRhaWwgPSBbMCwgMCwgMCwgMCwgMCwgMCwgMCwgMCwgMCwgMCwgMCwgMCwgMCwgMCwgMCwgMF07XG4gICAgICAgIGZvciAoaSA9IDA7IGkgPCBsZW5ndGg7IGkgKz0gMSkge1xuICAgICAgICAgICAgdGFpbFtpID4+IDJdIHw9IGFbaV0gPDwgKChpICUgNCkgPDwgMyk7XG4gICAgICAgIH1cblxuICAgICAgICB0YWlsW2kgPj4gMl0gfD0gMHg4MCA8PCAoKGkgJSA0KSA8PCAzKTtcbiAgICAgICAgaWYgKGkgPiA1NSkge1xuICAgICAgICAgICAgbWQ1Y3ljbGUoc3RhdGUsIHRhaWwpO1xuICAgICAgICAgICAgZm9yIChpID0gMDsgaSA8IDE2OyBpICs9IDEpIHtcbiAgICAgICAgICAgICAgICB0YWlsW2ldID0gMDtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuXG4gICAgICAgIC8vIEJld2FyZSB0aGF0IHRoZSBmaW5hbCBsZW5ndGggbWlnaHQgbm90IGZpdCBpbiAzMiBiaXRzIHNvIHdlIHRha2UgY2FyZSBvZiB0aGF0XG4gICAgICAgIHRtcCA9IG4gKiA4O1xuICAgICAgICB0bXAgPSB0bXAudG9TdHJpbmcoMTYpLm1hdGNoKC8oLio/KSguezAsOH0pJC8pO1xuICAgICAgICBsbyA9IHBhcnNlSW50KHRtcFsyXSwgMTYpO1xuICAgICAgICBoaSA9IHBhcnNlSW50KHRtcFsxXSwgMTYpIHx8IDA7XG5cbiAgICAgICAgdGFpbFsxNF0gPSBsbztcbiAgICAgICAgdGFpbFsxNV0gPSBoaTtcblxuICAgICAgICBtZDVjeWNsZShzdGF0ZSwgdGFpbCk7XG5cbiAgICAgICAgcmV0dXJuIHN0YXRlO1xuICAgIH0sXG5cbiAgICBoZXhfY2hyID0gWycwJywgJzEnLCAnMicsICczJywgJzQnLCAnNScsICc2JywgJzcnLCAnOCcsICc5JywgJ2EnLCAnYicsICdjJywgJ2QnLCAnZScsICdmJ10sXG5cbiAgICByaGV4ID0gZnVuY3Rpb24gKG4pIHtcbiAgICAgICAgdmFyIHMgPSAnJyxcbiAgICAgICAgICAgIGo7XG4gICAgICAgIGZvciAoaiA9IDA7IGogPCA0OyBqICs9IDEpIHtcbiAgICAgICAgICAgIHMgKz0gaGV4X2NoclsobiA+PiAoaiAqIDggKyA0KSkgJiAweDBGXSArIGhleF9jaHJbKG4gPj4gKGogKiA4KSkgJiAweDBGXTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gcztcbiAgICB9LFxuXG4gICAgaGV4ID0gZnVuY3Rpb24gKHgpIHtcbiAgICAgICAgdmFyIGk7XG4gICAgICAgIGZvciAoaSA9IDA7IGkgPCB4Lmxlbmd0aDsgaSArPSAxKSB7XG4gICAgICAgICAgICB4W2ldID0gcmhleCh4W2ldKTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4geC5qb2luKCcnKTtcbiAgICB9LFxuXG4gICAgbWQ1ID0gZnVuY3Rpb24gKHMpIHtcbiAgICAgICAgcmV0dXJuIGhleChtZDUxKHMpKTtcbiAgICB9LFxuXG5cblxuICAgIC8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy9cblxuICAgIC8qKlxuICAgICAqIFNwYXJrTUQ1IE9PUCBpbXBsZW1lbnRhdGlvbi5cbiAgICAgKlxuICAgICAqIFVzZSB0aGlzIGNsYXNzIHRvIHBlcmZvcm0gYW4gaW5jcmVtZW50YWwgbWQ1LCBvdGhlcndpc2UgdXNlIHRoZVxuICAgICAqIHN0YXRpYyBtZXRob2RzIGluc3RlYWQuXG4gICAgICovXG4gICAgU3BhcmtNRDUgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIC8vIGNhbGwgcmVzZXQgdG8gaW5pdCB0aGUgaW5zdGFuY2VcbiAgICAgICAgdGhpcy5yZXNldCgpO1xuICAgIH07XG5cblxuICAgIC8vIEluIHNvbWUgY2FzZXMgdGhlIGZhc3QgYWRkMzIgZnVuY3Rpb24gY2Fubm90IGJlIHVzZWQuLlxuICAgIGlmIChtZDUoJ2hlbGxvJykgIT09ICc1ZDQxNDAyYWJjNGIyYTc2Yjk3MTlkOTExMDE3YzU5MicpIHtcbiAgICAgICAgYWRkMzIgPSBmdW5jdGlvbiAoeCwgeSkge1xuICAgICAgICAgICAgdmFyIGxzdyA9ICh4ICYgMHhGRkZGKSArICh5ICYgMHhGRkZGKSxcbiAgICAgICAgICAgICAgICBtc3cgPSAoeCA+PiAxNikgKyAoeSA+PiAxNikgKyAobHN3ID4+IDE2KTtcbiAgICAgICAgICAgIHJldHVybiAobXN3IDw8IDE2KSB8IChsc3cgJiAweEZGRkYpO1xuICAgICAgICB9O1xuICAgIH1cblxuXG4gICAgLyoqXG4gICAgICogQXBwZW5kcyBhIHN0cmluZy5cbiAgICAgKiBBIGNvbnZlcnNpb24gd2lsbCBiZSBhcHBsaWVkIGlmIGFuIHV0Zjggc3RyaW5nIGlzIGRldGVjdGVkLlxuICAgICAqXG4gICAgICogQHBhcmFtIHtTdHJpbmd9IHN0ciBUaGUgc3RyaW5nIHRvIGJlIGFwcGVuZGVkXG4gICAgICpcbiAgICAgKiBAcmV0dXJuIHtTcGFya01ENX0gVGhlIGluc3RhbmNlIGl0c2VsZlxuICAgICAqL1xuICAgIFNwYXJrTUQ1LnByb3RvdHlwZS5hcHBlbmQgPSBmdW5jdGlvbiAoc3RyKSB7XG4gICAgICAgIC8vIGNvbnZlcnRzIHRoZSBzdHJpbmcgdG8gdXRmOCBieXRlcyBpZiBuZWNlc3NhcnlcbiAgICAgICAgaWYgKC9bXFx1MDA4MC1cXHVGRkZGXS8udGVzdChzdHIpKSB7XG4gICAgICAgICAgICBzdHIgPSB1bmVzY2FwZShlbmNvZGVVUklDb21wb25lbnQoc3RyKSk7XG4gICAgICAgIH1cblxuICAgICAgICAvLyB0aGVuIGFwcGVuZCBhcyBiaW5hcnlcbiAgICAgICAgdGhpcy5hcHBlbmRCaW5hcnkoc3RyKTtcblxuICAgICAgICByZXR1cm4gdGhpcztcbiAgICB9O1xuXG4gICAgLyoqXG4gICAgICogQXBwZW5kcyBhIGJpbmFyeSBzdHJpbmcuXG4gICAgICpcbiAgICAgKiBAcGFyYW0ge1N0cmluZ30gY29udGVudHMgVGhlIGJpbmFyeSBzdHJpbmcgdG8gYmUgYXBwZW5kZWRcbiAgICAgKlxuICAgICAqIEByZXR1cm4ge1NwYXJrTUQ1fSBUaGUgaW5zdGFuY2UgaXRzZWxmXG4gICAgICovXG4gICAgU3BhcmtNRDUucHJvdG90eXBlLmFwcGVuZEJpbmFyeSA9IGZ1bmN0aW9uIChjb250ZW50cykge1xuICAgICAgICB0aGlzLl9idWZmICs9IGNvbnRlbnRzO1xuICAgICAgICB0aGlzLl9sZW5ndGggKz0gY29udGVudHMubGVuZ3RoO1xuXG4gICAgICAgIHZhciBsZW5ndGggPSB0aGlzLl9idWZmLmxlbmd0aCxcbiAgICAgICAgICAgIGk7XG5cbiAgICAgICAgZm9yIChpID0gNjQ7IGkgPD0gbGVuZ3RoOyBpICs9IDY0KSB7XG4gICAgICAgICAgICBtZDVjeWNsZSh0aGlzLl9zdGF0ZSwgbWQ1YmxrKHRoaXMuX2J1ZmYuc3Vic3RyaW5nKGkgLSA2NCwgaSkpKTtcbiAgICAgICAgfVxuXG4gICAgICAgIHRoaXMuX2J1ZmYgPSB0aGlzLl9idWZmLnN1YnN0cihpIC0gNjQpO1xuXG4gICAgICAgIHJldHVybiB0aGlzO1xuICAgIH07XG5cbiAgICAvKipcbiAgICAgKiBGaW5pc2hlcyB0aGUgaW5jcmVtZW50YWwgY29tcHV0YXRpb24sIHJlc2V0aW5nIHRoZSBpbnRlcm5hbCBzdGF0ZSBhbmRcbiAgICAgKiByZXR1cm5pbmcgdGhlIHJlc3VsdC5cbiAgICAgKiBVc2UgdGhlIHJhdyBwYXJhbWV0ZXIgdG8gb2J0YWluIHRoZSByYXcgcmVzdWx0IGluc3RlYWQgb2YgdGhlIGhleCBvbmUuXG4gICAgICpcbiAgICAgKiBAcGFyYW0ge0Jvb2xlYW59IHJhdyBUcnVlIHRvIGdldCB0aGUgcmF3IHJlc3VsdCwgZmFsc2UgdG8gZ2V0IHRoZSBoZXggcmVzdWx0XG4gICAgICpcbiAgICAgKiBAcmV0dXJuIHtTdHJpbmd8QXJyYXl9IFRoZSByZXN1bHRcbiAgICAgKi9cbiAgICBTcGFya01ENS5wcm90b3R5cGUuZW5kID0gZnVuY3Rpb24gKHJhdykge1xuICAgICAgICB2YXIgYnVmZiA9IHRoaXMuX2J1ZmYsXG4gICAgICAgICAgICBsZW5ndGggPSBidWZmLmxlbmd0aCxcbiAgICAgICAgICAgIGksXG4gICAgICAgICAgICB0YWlsID0gWzAsIDAsIDAsIDAsIDAsIDAsIDAsIDAsIDAsIDAsIDAsIDAsIDAsIDAsIDAsIDBdLFxuICAgICAgICAgICAgcmV0O1xuXG4gICAgICAgIGZvciAoaSA9IDA7IGkgPCBsZW5ndGg7IGkgKz0gMSkge1xuICAgICAgICAgICAgdGFpbFtpID4+IDJdIHw9IGJ1ZmYuY2hhckNvZGVBdChpKSA8PCAoKGkgJSA0KSA8PCAzKTtcbiAgICAgICAgfVxuXG4gICAgICAgIHRoaXMuX2ZpbmlzaCh0YWlsLCBsZW5ndGgpO1xuICAgICAgICByZXQgPSAhIXJhdyA/IHRoaXMuX3N0YXRlIDogaGV4KHRoaXMuX3N0YXRlKTtcblxuICAgICAgICB0aGlzLnJlc2V0KCk7XG5cbiAgICAgICAgcmV0dXJuIHJldDtcbiAgICB9O1xuXG4gICAgLyoqXG4gICAgICogRmluaXNoIHRoZSBmaW5hbCBjYWxjdWxhdGlvbiBiYXNlZCBvbiB0aGUgdGFpbC5cbiAgICAgKlxuICAgICAqIEBwYXJhbSB7QXJyYXl9ICB0YWlsICAgVGhlIHRhaWwgKHdpbGwgYmUgbW9kaWZpZWQpXG4gICAgICogQHBhcmFtIHtOdW1iZXJ9IGxlbmd0aCBUaGUgbGVuZ3RoIG9mIHRoZSByZW1haW5pbmcgYnVmZmVyXG4gICAgICovXG4gICAgU3BhcmtNRDUucHJvdG90eXBlLl9maW5pc2ggPSBmdW5jdGlvbiAodGFpbCwgbGVuZ3RoKSB7XG4gICAgICAgIHZhciBpID0gbGVuZ3RoLFxuICAgICAgICAgICAgdG1wLFxuICAgICAgICAgICAgbG8sXG4gICAgICAgICAgICBoaTtcblxuICAgICAgICB0YWlsW2kgPj4gMl0gfD0gMHg4MCA8PCAoKGkgJSA0KSA8PCAzKTtcbiAgICAgICAgaWYgKGkgPiA1NSkge1xuICAgICAgICAgICAgbWQ1Y3ljbGUodGhpcy5fc3RhdGUsIHRhaWwpO1xuICAgICAgICAgICAgZm9yIChpID0gMDsgaSA8IDE2OyBpICs9IDEpIHtcbiAgICAgICAgICAgICAgICB0YWlsW2ldID0gMDtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuXG4gICAgICAgIC8vIERvIHRoZSBmaW5hbCBjb21wdXRhdGlvbiBiYXNlZCBvbiB0aGUgdGFpbCBhbmQgbGVuZ3RoXG4gICAgICAgIC8vIEJld2FyZSB0aGF0IHRoZSBmaW5hbCBsZW5ndGggbWF5IG5vdCBmaXQgaW4gMzIgYml0cyBzbyB3ZSB0YWtlIGNhcmUgb2YgdGhhdFxuICAgICAgICB0bXAgPSB0aGlzLl9sZW5ndGggKiA4O1xuICAgICAgICB0bXAgPSB0bXAudG9TdHJpbmcoMTYpLm1hdGNoKC8oLio/KSguezAsOH0pJC8pO1xuICAgICAgICBsbyA9IHBhcnNlSW50KHRtcFsyXSwgMTYpO1xuICAgICAgICBoaSA9IHBhcnNlSW50KHRtcFsxXSwgMTYpIHx8IDA7XG5cbiAgICAgICAgdGFpbFsxNF0gPSBsbztcbiAgICAgICAgdGFpbFsxNV0gPSBoaTtcbiAgICAgICAgbWQ1Y3ljbGUodGhpcy5fc3RhdGUsIHRhaWwpO1xuICAgIH07XG5cbiAgICAvKipcbiAgICAgKiBSZXNldHMgdGhlIGludGVybmFsIHN0YXRlIG9mIHRoZSBjb21wdXRhdGlvbi5cbiAgICAgKlxuICAgICAqIEByZXR1cm4ge1NwYXJrTUQ1fSBUaGUgaW5zdGFuY2UgaXRzZWxmXG4gICAgICovXG4gICAgU3BhcmtNRDUucHJvdG90eXBlLnJlc2V0ID0gZnVuY3Rpb24gKCkge1xuICAgICAgICB0aGlzLl9idWZmID0gXCJcIjtcbiAgICAgICAgdGhpcy5fbGVuZ3RoID0gMDtcbiAgICAgICAgdGhpcy5fc3RhdGUgPSBbMTczMjU4NDE5MywgLTI3MTczMzg3OSwgLTE3MzI1ODQxOTQsIDI3MTczMzg3OF07XG5cbiAgICAgICAgcmV0dXJuIHRoaXM7XG4gICAgfTtcblxuICAgIC8qKlxuICAgICAqIFJlbGVhc2VzIG1lbW9yeSB1c2VkIGJ5IHRoZSBpbmNyZW1lbnRhbCBidWZmZXIgYW5kIG90aGVyIGFkaXRpb25hbFxuICAgICAqIHJlc291cmNlcy4gSWYgeW91IHBsYW4gdG8gdXNlIHRoZSBpbnN0YW5jZSBhZ2FpbiwgdXNlIHJlc2V0IGluc3RlYWQuXG4gICAgICovXG4gICAgU3BhcmtNRDUucHJvdG90eXBlLmRlc3Ryb3kgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIGRlbGV0ZSB0aGlzLl9zdGF0ZTtcbiAgICAgICAgZGVsZXRlIHRoaXMuX2J1ZmY7XG4gICAgICAgIGRlbGV0ZSB0aGlzLl9sZW5ndGg7XG4gICAgfTtcblxuXG4gICAgLyoqXG4gICAgICogUGVyZm9ybXMgdGhlIG1kNSBoYXNoIG9uIGEgc3RyaW5nLlxuICAgICAqIEEgY29udmVyc2lvbiB3aWxsIGJlIGFwcGxpZWQgaWYgdXRmOCBzdHJpbmcgaXMgZGV0ZWN0ZWQuXG4gICAgICpcbiAgICAgKiBAcGFyYW0ge1N0cmluZ30gIHN0ciBUaGUgc3RyaW5nXG4gICAgICogQHBhcmFtIHtCb29sZWFufSByYXcgVHJ1ZSB0byBnZXQgdGhlIHJhdyByZXN1bHQsIGZhbHNlIHRvIGdldCB0aGUgaGV4IHJlc3VsdFxuICAgICAqXG4gICAgICogQHJldHVybiB7U3RyaW5nfEFycmF5fSBUaGUgcmVzdWx0XG4gICAgICovXG4gICAgU3BhcmtNRDUuaGFzaCA9IGZ1bmN0aW9uIChzdHIsIHJhdykge1xuICAgICAgICAvLyBjb252ZXJ0cyB0aGUgc3RyaW5nIHRvIHV0ZjggYnl0ZXMgaWYgbmVjZXNzYXJ5XG4gICAgICAgIGlmICgvW1xcdTAwODAtXFx1RkZGRl0vLnRlc3Qoc3RyKSkge1xuICAgICAgICAgICAgc3RyID0gdW5lc2NhcGUoZW5jb2RlVVJJQ29tcG9uZW50KHN0cikpO1xuICAgICAgICB9XG5cbiAgICAgICAgdmFyIGhhc2ggPSBtZDUxKHN0cik7XG5cbiAgICAgICAgcmV0dXJuICEhcmF3ID8gaGFzaCA6IGhleChoYXNoKTtcbiAgICB9O1xuXG4gICAgLyoqXG4gICAgICogUGVyZm9ybXMgdGhlIG1kNSBoYXNoIG9uIGEgYmluYXJ5IHN0cmluZy5cbiAgICAgKlxuICAgICAqIEBwYXJhbSB7U3RyaW5nfSAgY29udGVudCBUaGUgYmluYXJ5IHN0cmluZ1xuICAgICAqIEBwYXJhbSB7Qm9vbGVhbn0gcmF3ICAgICBUcnVlIHRvIGdldCB0aGUgcmF3IHJlc3VsdCwgZmFsc2UgdG8gZ2V0IHRoZSBoZXggcmVzdWx0XG4gICAgICpcbiAgICAgKiBAcmV0dXJuIHtTdHJpbmd8QXJyYXl9IFRoZSByZXN1bHRcbiAgICAgKi9cbiAgICBTcGFya01ENS5oYXNoQmluYXJ5ID0gZnVuY3Rpb24gKGNvbnRlbnQsIHJhdykge1xuICAgICAgICB2YXIgaGFzaCA9IG1kNTEoY29udGVudCk7XG5cbiAgICAgICAgcmV0dXJuICEhcmF3ID8gaGFzaCA6IGhleChoYXNoKTtcbiAgICB9O1xuXG4gICAgLyoqXG4gICAgICogU3BhcmtNRDUgT09QIGltcGxlbWVudGF0aW9uIGZvciBhcnJheSBidWZmZXJzLlxuICAgICAqXG4gICAgICogVXNlIHRoaXMgY2xhc3MgdG8gcGVyZm9ybSBhbiBpbmNyZW1lbnRhbCBtZDUgT05MWSBmb3IgYXJyYXkgYnVmZmVycy5cbiAgICAgKi9cbiAgICBTcGFya01ENS5BcnJheUJ1ZmZlciA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgLy8gY2FsbCByZXNldCB0byBpbml0IHRoZSBpbnN0YW5jZVxuICAgICAgICB0aGlzLnJlc2V0KCk7XG4gICAgfTtcblxuICAgIC8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy9cblxuICAgIC8qKlxuICAgICAqIEFwcGVuZHMgYW4gYXJyYXkgYnVmZmVyLlxuICAgICAqXG4gICAgICogQHBhcmFtIHtBcnJheUJ1ZmZlcn0gYXJyIFRoZSBhcnJheSB0byBiZSBhcHBlbmRlZFxuICAgICAqXG4gICAgICogQHJldHVybiB7U3BhcmtNRDUuQXJyYXlCdWZmZXJ9IFRoZSBpbnN0YW5jZSBpdHNlbGZcbiAgICAgKi9cbiAgICBTcGFya01ENS5BcnJheUJ1ZmZlci5wcm90b3R5cGUuYXBwZW5kID0gZnVuY3Rpb24gKGFycikge1xuICAgICAgICAvLyBUT0RPOiB3ZSBjb3VsZCBhdm9pZCB0aGUgY29uY2F0ZW5hdGlvbiBoZXJlIGJ1dCB0aGUgYWxnb3JpdGhtIHdvdWxkIGJlIG1vcmUgY29tcGxleFxuICAgICAgICAvLyAgICAgICBpZiB5b3UgZmluZCB5b3Vyc2VsZiBuZWVkaW5nIGV4dHJhIHBlcmZvcm1hbmNlLCBwbGVhc2UgbWFrZSBhIFBSLlxuICAgICAgICB2YXIgYnVmZiA9IHRoaXMuX2NvbmNhdEFycmF5QnVmZmVyKHRoaXMuX2J1ZmYsIGFyciksXG4gICAgICAgICAgICBsZW5ndGggPSBidWZmLmxlbmd0aCxcbiAgICAgICAgICAgIGk7XG5cbiAgICAgICAgdGhpcy5fbGVuZ3RoICs9IGFyci5ieXRlTGVuZ3RoO1xuXG4gICAgICAgIGZvciAoaSA9IDY0OyBpIDw9IGxlbmd0aDsgaSArPSA2NCkge1xuICAgICAgICAgICAgbWQ1Y3ljbGUodGhpcy5fc3RhdGUsIG1kNWJsa19hcnJheShidWZmLnN1YmFycmF5KGkgLSA2NCwgaSkpKTtcbiAgICAgICAgfVxuXG4gICAgICAgIC8vIEF2b2lkcyBJRTEwIHdlaXJkbmVzcyAoZG9jdW1lbnRlZCBhYm92ZSlcbiAgICAgICAgdGhpcy5fYnVmZiA9IChpIC0gNjQpIDwgbGVuZ3RoID8gYnVmZi5zdWJhcnJheShpIC0gNjQpIDogbmV3IFVpbnQ4QXJyYXkoMCk7XG5cbiAgICAgICAgcmV0dXJuIHRoaXM7XG4gICAgfTtcblxuICAgIC8qKlxuICAgICAqIEZpbmlzaGVzIHRoZSBpbmNyZW1lbnRhbCBjb21wdXRhdGlvbiwgcmVzZXRpbmcgdGhlIGludGVybmFsIHN0YXRlIGFuZFxuICAgICAqIHJldHVybmluZyB0aGUgcmVzdWx0LlxuICAgICAqIFVzZSB0aGUgcmF3IHBhcmFtZXRlciB0byBvYnRhaW4gdGhlIHJhdyByZXN1bHQgaW5zdGVhZCBvZiB0aGUgaGV4IG9uZS5cbiAgICAgKlxuICAgICAqIEBwYXJhbSB7Qm9vbGVhbn0gcmF3IFRydWUgdG8gZ2V0IHRoZSByYXcgcmVzdWx0LCBmYWxzZSB0byBnZXQgdGhlIGhleCByZXN1bHRcbiAgICAgKlxuICAgICAqIEByZXR1cm4ge1N0cmluZ3xBcnJheX0gVGhlIHJlc3VsdFxuICAgICAqL1xuICAgIFNwYXJrTUQ1LkFycmF5QnVmZmVyLnByb3RvdHlwZS5lbmQgPSBmdW5jdGlvbiAocmF3KSB7XG4gICAgICAgIHZhciBidWZmID0gdGhpcy5fYnVmZixcbiAgICAgICAgICAgIGxlbmd0aCA9IGJ1ZmYubGVuZ3RoLFxuICAgICAgICAgICAgdGFpbCA9IFswLCAwLCAwLCAwLCAwLCAwLCAwLCAwLCAwLCAwLCAwLCAwLCAwLCAwLCAwLCAwXSxcbiAgICAgICAgICAgIGksXG4gICAgICAgICAgICByZXQ7XG5cbiAgICAgICAgZm9yIChpID0gMDsgaSA8IGxlbmd0aDsgaSArPSAxKSB7XG4gICAgICAgICAgICB0YWlsW2kgPj4gMl0gfD0gYnVmZltpXSA8PCAoKGkgJSA0KSA8PCAzKTtcbiAgICAgICAgfVxuXG4gICAgICAgIHRoaXMuX2ZpbmlzaCh0YWlsLCBsZW5ndGgpO1xuICAgICAgICByZXQgPSAhIXJhdyA/IHRoaXMuX3N0YXRlIDogaGV4KHRoaXMuX3N0YXRlKTtcblxuICAgICAgICB0aGlzLnJlc2V0KCk7XG5cbiAgICAgICAgcmV0dXJuIHJldDtcbiAgICB9O1xuXG4gICAgU3BhcmtNRDUuQXJyYXlCdWZmZXIucHJvdG90eXBlLl9maW5pc2ggPSBTcGFya01ENS5wcm90b3R5cGUuX2ZpbmlzaDtcblxuICAgIC8qKlxuICAgICAqIFJlc2V0cyB0aGUgaW50ZXJuYWwgc3RhdGUgb2YgdGhlIGNvbXB1dGF0aW9uLlxuICAgICAqXG4gICAgICogQHJldHVybiB7U3BhcmtNRDUuQXJyYXlCdWZmZXJ9IFRoZSBpbnN0YW5jZSBpdHNlbGZcbiAgICAgKi9cbiAgICBTcGFya01ENS5BcnJheUJ1ZmZlci5wcm90b3R5cGUucmVzZXQgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHRoaXMuX2J1ZmYgPSBuZXcgVWludDhBcnJheSgwKTtcbiAgICAgICAgdGhpcy5fbGVuZ3RoID0gMDtcbiAgICAgICAgdGhpcy5fc3RhdGUgPSBbMTczMjU4NDE5MywgLTI3MTczMzg3OSwgLTE3MzI1ODQxOTQsIDI3MTczMzg3OF07XG5cbiAgICAgICAgcmV0dXJuIHRoaXM7XG4gICAgfTtcblxuICAgIC8qKlxuICAgICAqIFJlbGVhc2VzIG1lbW9yeSB1c2VkIGJ5IHRoZSBpbmNyZW1lbnRhbCBidWZmZXIgYW5kIG90aGVyIGFkaXRpb25hbFxuICAgICAqIHJlc291cmNlcy4gSWYgeW91IHBsYW4gdG8gdXNlIHRoZSBpbnN0YW5jZSBhZ2FpbiwgdXNlIHJlc2V0IGluc3RlYWQuXG4gICAgICovXG4gICAgU3BhcmtNRDUuQXJyYXlCdWZmZXIucHJvdG90eXBlLmRlc3Ryb3kgPSBTcGFya01ENS5wcm90b3R5cGUuZGVzdHJveTtcblxuICAgIC8qKlxuICAgICAqIENvbmNhdHMgdHdvIGFycmF5IGJ1ZmZlcnMsIHJldHVybmluZyBhIG5ldyBvbmUuXG4gICAgICpcbiAgICAgKiBAcGFyYW0gIHtBcnJheUJ1ZmZlcn0gZmlyc3QgIFRoZSBmaXJzdCBhcnJheSBidWZmZXJcbiAgICAgKiBAcGFyYW0gIHtBcnJheUJ1ZmZlcn0gc2Vjb25kIFRoZSBzZWNvbmQgYXJyYXkgYnVmZmVyXG4gICAgICpcbiAgICAgKiBAcmV0dXJuIHtBcnJheUJ1ZmZlcn0gVGhlIG5ldyBhcnJheSBidWZmZXJcbiAgICAgKi9cbiAgICBTcGFya01ENS5BcnJheUJ1ZmZlci5wcm90b3R5cGUuX2NvbmNhdEFycmF5QnVmZmVyID0gZnVuY3Rpb24gKGZpcnN0LCBzZWNvbmQpIHtcbiAgICAgICAgdmFyIGZpcnN0TGVuZ3RoID0gZmlyc3QubGVuZ3RoLFxuICAgICAgICAgICAgcmVzdWx0ID0gbmV3IFVpbnQ4QXJyYXkoZmlyc3RMZW5ndGggKyBzZWNvbmQuYnl0ZUxlbmd0aCk7XG5cbiAgICAgICAgcmVzdWx0LnNldChmaXJzdCk7XG4gICAgICAgIHJlc3VsdC5zZXQobmV3IFVpbnQ4QXJyYXkoc2Vjb25kKSwgZmlyc3RMZW5ndGgpO1xuXG4gICAgICAgIHJldHVybiByZXN1bHQ7XG4gICAgfTtcblxuICAgIC8qKlxuICAgICAqIFBlcmZvcm1zIHRoZSBtZDUgaGFzaCBvbiBhbiBhcnJheSBidWZmZXIuXG4gICAgICpcbiAgICAgKiBAcGFyYW0ge0FycmF5QnVmZmVyfSBhcnIgVGhlIGFycmF5IGJ1ZmZlclxuICAgICAqIEBwYXJhbSB7Qm9vbGVhbn0gICAgIHJhdyBUcnVlIHRvIGdldCB0aGUgcmF3IHJlc3VsdCwgZmFsc2UgdG8gZ2V0IHRoZSBoZXggcmVzdWx0XG4gICAgICpcbiAgICAgKiBAcmV0dXJuIHtTdHJpbmd8QXJyYXl9IFRoZSByZXN1bHRcbiAgICAgKi9cbiAgICBTcGFya01ENS5BcnJheUJ1ZmZlci5oYXNoID0gZnVuY3Rpb24gKGFyciwgcmF3KSB7XG4gICAgICAgIHZhciBoYXNoID0gbWQ1MV9hcnJheShuZXcgVWludDhBcnJheShhcnIpKTtcblxuICAgICAgICByZXR1cm4gISFyYXcgPyBoYXNoIDogaGV4KGhhc2gpO1xuICAgIH07XG5cbiAgICByZXR1cm4gU3BhcmtNRDU7XG59KSk7XG5cbn0se31dLDU4OltmdW5jdGlvbihfZGVyZXFfLG1vZHVsZSxleHBvcnRzKXtcbid1c2Ugc3RyaWN0JztcblxuLyoqXG4gKiBTdHJpbmdpZnkvcGFyc2UgZnVuY3Rpb25zIHRoYXQgZG9uJ3Qgb3BlcmF0ZVxuICogcmVjdXJzaXZlbHksIHNvIHRoZXkgYXZvaWQgY2FsbCBzdGFjayBleGNlZWRlZFxuICogZXJyb3JzLlxuICovXG5leHBvcnRzLnN0cmluZ2lmeSA9IGZ1bmN0aW9uIHN0cmluZ2lmeShpbnB1dCkge1xuICB2YXIgcXVldWUgPSBbXTtcbiAgcXVldWUucHVzaCh7b2JqOiBpbnB1dH0pO1xuXG4gIHZhciByZXMgPSAnJztcbiAgdmFyIG5leHQsIG9iaiwgcHJlZml4LCB2YWwsIGksIGFycmF5UHJlZml4LCBrZXlzLCBrLCBrZXksIHZhbHVlLCBvYmpQcmVmaXg7XG4gIHdoaWxlICgobmV4dCA9IHF1ZXVlLnBvcCgpKSkge1xuICAgIG9iaiA9IG5leHQub2JqO1xuICAgIHByZWZpeCA9IG5leHQucHJlZml4IHx8ICcnO1xuICAgIHZhbCA9IG5leHQudmFsIHx8ICcnO1xuICAgIHJlcyArPSBwcmVmaXg7XG4gICAgaWYgKHZhbCkge1xuICAgICAgcmVzICs9IHZhbDtcbiAgICB9IGVsc2UgaWYgKHR5cGVvZiBvYmogIT09ICdvYmplY3QnKSB7XG4gICAgICByZXMgKz0gdHlwZW9mIG9iaiA9PT0gJ3VuZGVmaW5lZCcgPyBudWxsIDogSlNPTi5zdHJpbmdpZnkob2JqKTtcbiAgICB9IGVsc2UgaWYgKG9iaiA9PT0gbnVsbCkge1xuICAgICAgcmVzICs9ICdudWxsJztcbiAgICB9IGVsc2UgaWYgKEFycmF5LmlzQXJyYXkob2JqKSkge1xuICAgICAgcXVldWUucHVzaCh7dmFsOiAnXSd9KTtcbiAgICAgIGZvciAoaSA9IG9iai5sZW5ndGggLSAxOyBpID49IDA7IGktLSkge1xuICAgICAgICBhcnJheVByZWZpeCA9IGkgPT09IDAgPyAnJyA6ICcsJztcbiAgICAgICAgcXVldWUucHVzaCh7b2JqOiBvYmpbaV0sIHByZWZpeDogYXJyYXlQcmVmaXh9KTtcbiAgICAgIH1cbiAgICAgIHF1ZXVlLnB1c2goe3ZhbDogJ1snfSk7XG4gICAgfSBlbHNlIHsgLy8gb2JqZWN0XG4gICAgICBrZXlzID0gW107XG4gICAgICBmb3IgKGsgaW4gb2JqKSB7XG4gICAgICAgIGlmIChvYmouaGFzT3duUHJvcGVydHkoaykpIHtcbiAgICAgICAgICBrZXlzLnB1c2goayk7XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICAgIHF1ZXVlLnB1c2goe3ZhbDogJ30nfSk7XG4gICAgICBmb3IgKGkgPSBrZXlzLmxlbmd0aCAtIDE7IGkgPj0gMDsgaS0tKSB7XG4gICAgICAgIGtleSA9IGtleXNbaV07XG4gICAgICAgIHZhbHVlID0gb2JqW2tleV07XG4gICAgICAgIG9ialByZWZpeCA9IChpID4gMCA/ICcsJyA6ICcnKTtcbiAgICAgICAgb2JqUHJlZml4ICs9IEpTT04uc3RyaW5naWZ5KGtleSkgKyAnOic7XG4gICAgICAgIHF1ZXVlLnB1c2goe29iajogdmFsdWUsIHByZWZpeDogb2JqUHJlZml4fSk7XG4gICAgICB9XG4gICAgICBxdWV1ZS5wdXNoKHt2YWw6ICd7J30pO1xuICAgIH1cbiAgfVxuICByZXR1cm4gcmVzO1xufTtcblxuLy8gQ29udmVuaWVuY2UgZnVuY3Rpb24gZm9yIHRoZSBwYXJzZSBmdW5jdGlvbi5cbi8vIFRoaXMgcG9wIGZ1bmN0aW9uIGlzIGJhc2ljYWxseSBjb3BpZWQgZnJvbVxuLy8gcG91Y2hDb2xsYXRlLnBhcnNlSW5kZXhhYmxlU3RyaW5nXG5mdW5jdGlvbiBwb3Aob2JqLCBzdGFjaywgbWV0YVN0YWNrKSB7XG4gIHZhciBsYXN0TWV0YUVsZW1lbnQgPSBtZXRhU3RhY2tbbWV0YVN0YWNrLmxlbmd0aCAtIDFdO1xuICBpZiAob2JqID09PSBsYXN0TWV0YUVsZW1lbnQuZWxlbWVudCkge1xuICAgIC8vIHBvcHBpbmcgYSBtZXRhLWVsZW1lbnQsIGUuZy4gYW4gb2JqZWN0IHdob3NlIHZhbHVlIGlzIGFub3RoZXIgb2JqZWN0XG4gICAgbWV0YVN0YWNrLnBvcCgpO1xuICAgIGxhc3RNZXRhRWxlbWVudCA9IG1ldGFTdGFja1ttZXRhU3RhY2subGVuZ3RoIC0gMV07XG4gIH1cbiAgdmFyIGVsZW1lbnQgPSBsYXN0TWV0YUVsZW1lbnQuZWxlbWVudDtcbiAgdmFyIGxhc3RFbGVtZW50SW5kZXggPSBsYXN0TWV0YUVsZW1lbnQuaW5kZXg7XG4gIGlmIChBcnJheS5pc0FycmF5KGVsZW1lbnQpKSB7XG4gICAgZWxlbWVudC5wdXNoKG9iaik7XG4gIH0gZWxzZSBpZiAobGFzdEVsZW1lbnRJbmRleCA9PT0gc3RhY2subGVuZ3RoIC0gMikgeyAvLyBvYmogd2l0aCBrZXkrdmFsdWVcbiAgICB2YXIga2V5ID0gc3RhY2sucG9wKCk7XG4gICAgZWxlbWVudFtrZXldID0gb2JqO1xuICB9IGVsc2Uge1xuICAgIHN0YWNrLnB1c2gob2JqKTsgLy8gb2JqIHdpdGgga2V5IG9ubHlcbiAgfVxufVxuXG5leHBvcnRzLnBhcnNlID0gZnVuY3Rpb24gKHN0cikge1xuICB2YXIgc3RhY2sgPSBbXTtcbiAgdmFyIG1ldGFTdGFjayA9IFtdOyAvLyBzdGFjayBmb3IgYXJyYXlzIGFuZCBvYmplY3RzXG4gIHZhciBpID0gMDtcbiAgdmFyIGNvbGxhdGlvbkluZGV4LHBhcnNlZE51bSxudW1DaGFyO1xuICB2YXIgcGFyc2VkU3RyaW5nLGxhc3RDaCxudW1Db25zZWN1dGl2ZVNsYXNoZXMsY2g7XG4gIHZhciBhcnJheUVsZW1lbnQsIG9iakVsZW1lbnQ7XG4gIHdoaWxlICh0cnVlKSB7XG4gICAgY29sbGF0aW9uSW5kZXggPSBzdHJbaSsrXTtcbiAgICBpZiAoY29sbGF0aW9uSW5kZXggPT09ICd9JyB8fFxuICAgICAgICBjb2xsYXRpb25JbmRleCA9PT0gJ10nIHx8XG4gICAgICAgIHR5cGVvZiBjb2xsYXRpb25JbmRleCA9PT0gJ3VuZGVmaW5lZCcpIHtcbiAgICAgIGlmIChzdGFjay5sZW5ndGggPT09IDEpIHtcbiAgICAgICAgcmV0dXJuIHN0YWNrLnBvcCgpO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgcG9wKHN0YWNrLnBvcCgpLCBzdGFjaywgbWV0YVN0YWNrKTtcbiAgICAgICAgY29udGludWU7XG4gICAgICB9XG4gICAgfVxuICAgIHN3aXRjaCAoY29sbGF0aW9uSW5kZXgpIHtcbiAgICAgIGNhc2UgJyAnOlxuICAgICAgY2FzZSAnXFx0JzpcbiAgICAgIGNhc2UgJ1xcbic6XG4gICAgICBjYXNlICc6JzpcbiAgICAgIGNhc2UgJywnOlxuICAgICAgICBicmVhaztcbiAgICAgIGNhc2UgJ24nOlxuICAgICAgICBpICs9IDM7IC8vICd1bGwnXG4gICAgICAgIHBvcChudWxsLCBzdGFjaywgbWV0YVN0YWNrKTtcbiAgICAgICAgYnJlYWs7XG4gICAgICBjYXNlICd0JzpcbiAgICAgICAgaSArPSAzOyAvLyAncnVlJ1xuICAgICAgICBwb3AodHJ1ZSwgc3RhY2ssIG1ldGFTdGFjayk7XG4gICAgICAgIGJyZWFrO1xuICAgICAgY2FzZSAnZic6XG4gICAgICAgIGkgKz0gNDsgLy8gJ2Fsc2UnXG4gICAgICAgIHBvcChmYWxzZSwgc3RhY2ssIG1ldGFTdGFjayk7XG4gICAgICAgIGJyZWFrO1xuICAgICAgY2FzZSAnMCc6XG4gICAgICBjYXNlICcxJzpcbiAgICAgIGNhc2UgJzInOlxuICAgICAgY2FzZSAnMyc6XG4gICAgICBjYXNlICc0JzpcbiAgICAgIGNhc2UgJzUnOlxuICAgICAgY2FzZSAnNic6XG4gICAgICBjYXNlICc3JzpcbiAgICAgIGNhc2UgJzgnOlxuICAgICAgY2FzZSAnOSc6XG4gICAgICBjYXNlICctJzpcbiAgICAgICAgcGFyc2VkTnVtID0gJyc7XG4gICAgICAgIGktLTtcbiAgICAgICAgd2hpbGUgKHRydWUpIHtcbiAgICAgICAgICBudW1DaGFyID0gc3RyW2krK107XG4gICAgICAgICAgaWYgKC9bXFxkXFwuXFwtZVxcK10vLnRlc3QobnVtQ2hhcikpIHtcbiAgICAgICAgICAgIHBhcnNlZE51bSArPSBudW1DaGFyO1xuICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICBpLS07XG4gICAgICAgICAgICBicmVhaztcbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgcG9wKHBhcnNlRmxvYXQocGFyc2VkTnVtKSwgc3RhY2ssIG1ldGFTdGFjayk7XG4gICAgICAgIGJyZWFrO1xuICAgICAgY2FzZSAnXCInOlxuICAgICAgICBwYXJzZWRTdHJpbmcgPSAnJztcbiAgICAgICAgbGFzdENoID0gdm9pZCAwO1xuICAgICAgICBudW1Db25zZWN1dGl2ZVNsYXNoZXMgPSAwO1xuICAgICAgICB3aGlsZSAodHJ1ZSkge1xuICAgICAgICAgIGNoID0gc3RyW2krK107XG4gICAgICAgICAgaWYgKGNoICE9PSAnXCInIHx8IChsYXN0Q2ggPT09ICdcXFxcJyAmJlxuICAgICAgICAgICAgICBudW1Db25zZWN1dGl2ZVNsYXNoZXMgJSAyID09PSAxKSkge1xuICAgICAgICAgICAgcGFyc2VkU3RyaW5nICs9IGNoO1xuICAgICAgICAgICAgbGFzdENoID0gY2g7XG4gICAgICAgICAgICBpZiAobGFzdENoID09PSAnXFxcXCcpIHtcbiAgICAgICAgICAgICAgbnVtQ29uc2VjdXRpdmVTbGFzaGVzKys7XG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICBudW1Db25zZWN1dGl2ZVNsYXNoZXMgPSAwO1xuICAgICAgICAgICAgfVxuICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICBicmVhaztcbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgcG9wKEpTT04ucGFyc2UoJ1wiJyArIHBhcnNlZFN0cmluZyArICdcIicpLCBzdGFjaywgbWV0YVN0YWNrKTtcbiAgICAgICAgYnJlYWs7XG4gICAgICBjYXNlICdbJzpcbiAgICAgICAgYXJyYXlFbGVtZW50ID0geyBlbGVtZW50OiBbXSwgaW5kZXg6IHN0YWNrLmxlbmd0aCB9O1xuICAgICAgICBzdGFjay5wdXNoKGFycmF5RWxlbWVudC5lbGVtZW50KTtcbiAgICAgICAgbWV0YVN0YWNrLnB1c2goYXJyYXlFbGVtZW50KTtcbiAgICAgICAgYnJlYWs7XG4gICAgICBjYXNlICd7JzpcbiAgICAgICAgb2JqRWxlbWVudCA9IHsgZWxlbWVudDoge30sIGluZGV4OiBzdGFjay5sZW5ndGggfTtcbiAgICAgICAgc3RhY2sucHVzaChvYmpFbGVtZW50LmVsZW1lbnQpO1xuICAgICAgICBtZXRhU3RhY2sucHVzaChvYmpFbGVtZW50KTtcbiAgICAgICAgYnJlYWs7XG4gICAgICBkZWZhdWx0OlxuICAgICAgICB0aHJvdyBuZXcgRXJyb3IoXG4gICAgICAgICAgJ3VuZXhwZWN0ZWRseSByZWFjaGVkIGVuZCBvZiBpbnB1dDogJyArIGNvbGxhdGlvbkluZGV4KTtcbiAgICB9XG4gIH1cbn07XG5cbn0se31dfSx7fSxbMTddKVxuKDE3KVxufSk7XG59KS5jYWxsKHRoaXMsdHlwZW9mIGdsb2JhbCAhPT0gXCJ1bmRlZmluZWRcIiA/IGdsb2JhbCA6IHR5cGVvZiBzZWxmICE9PSBcInVuZGVmaW5lZFwiID8gc2VsZiA6IHR5cGVvZiB3aW5kb3cgIT09IFwidW5kZWZpbmVkXCIgPyB3aW5kb3cgOiB7fSkiXX0=
